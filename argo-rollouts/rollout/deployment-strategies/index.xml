<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>éƒ¨ç½²ç­–ç•¥ | äº‘åŸç”Ÿèµ„æ–™åº“</title>
    <link>https://lib.jimmysong.io/argo-rollouts/rollout/deployment-strategies/</link>
      <atom:link href="https://lib.jimmysong.io/argo-rollouts/rollout/deployment-strategies/index.xml" rel="self" type="application/rss+xml" />
    <description>éƒ¨ç½²ç­–ç•¥</description>
    <generator>Wowchemy (https://wowchemy.com)</generator><language>zh</language><lastBuildDate>Wed, 21 Jun 2023 16:00:00 +0800</lastBuildDate>
    <image>
      <url>https://lib.jimmysong.io/media/sharing.png</url>
      <title>éƒ¨ç½²ç­–ç•¥</title>
      <link>https://lib.jimmysong.io/argo-rollouts/rollout/deployment-strategies/</link>
    </image>
    
    <item>
      <title>è“ç»¿éƒ¨ç½²ç­–ç•¥</title>
      <link>https://lib.jimmysong.io/argo-rollouts/rollout/deployment-strategies/bluegreen/</link>
      <pubDate>Wed, 21 Jun 2023 16:00:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/argo-rollouts/rollout/deployment-strategies/bluegreen/</guid>
      <description>&lt;p&gt;è“ç»¿éƒ¨ç½²å…è®¸ç”¨æˆ·å‡å°‘åŒæ—¶è¿è¡Œå¤šä¸ªç‰ˆæœ¬çš„æ—¶é—´ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ¦‚è¿°&#34;&gt;æ¦‚è¿°&lt;/h2&gt;
&lt;p&gt;é™¤äº†ç®¡ç† ReplicaSet å¤–ï¼Œåœ¨ &lt;code&gt;BlueGreenUpdate&lt;/code&gt; ç­–ç•¥æœŸé—´ï¼ŒRollout æ§åˆ¶å™¨è¿˜å°†ä¿®æ”¹ Service èµ„æºã€‚Rollout è§„èŒƒè¦æ±‚ç”¨æˆ·åœ¨åŒä¸€å‘½åç©ºé—´ä¸­æŒ‡å®šå¯¹æ´»åŠ¨æœåŠ¡çš„å¼•ç”¨ä»¥åŠå¯é€‰çš„é¢„è§ˆæœåŠ¡ã€‚æ´»åŠ¨æœåŠ¡ç”¨äºå°†å¸¸è§„åº”ç”¨ç¨‹åºæµé‡å‘é€åˆ°æ—§ç‰ˆæœ¬ï¼Œè€Œé¢„è§ˆæœåŠ¡ç”¨äºå°†æµé‡æ¼æ–—åˆ°æ–°ç‰ˆæœ¬ã€‚Rollout æ§åˆ¶å™¨é€šè¿‡å‘è¿™äº›æœåŠ¡çš„é€‰æ‹©å™¨æ³¨å…¥ ReplicaSet çš„å”¯ä¸€å“ˆå¸Œæ¥ç¡®ä¿æ­£ç¡®çš„æµé‡è·¯ç”±ã€‚è¿™å…è®¸ Rollout å®šä¹‰ä¸€ä¸ªæ´»åŠ¨å’Œé¢„è§ˆå †æ ˆä»¥åŠä»é¢„è§ˆåˆ°æ´»åŠ¨çš„è¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;å½“ Rollout çš„ &lt;code&gt;.spec.template&lt;/code&gt; å­—æ®µå‘ç”Ÿæ›´æ”¹æ—¶ï¼Œæ§åˆ¶å™¨å°†åˆ›å»ºæ–°çš„ ReplicaSetã€‚å¦‚æœæ´»åŠ¨æœåŠ¡æ²¡æœ‰å°†æµé‡å‘é€åˆ° ReplicaSetï¼Œåˆ™æ§åˆ¶å™¨å°†ç«‹å³å¼€å§‹å°†æµé‡å‘é€åˆ° ReplicaSetã€‚å¦åˆ™ï¼Œæ´»åŠ¨æœåŠ¡å°†æŒ‡å‘æ—§ ReplicaSetï¼Œè€Œ ReplicaSet å˜å¾—å¯ç”¨ã€‚ä¸€æ—¦æ–°çš„ ReplicaSet å˜å¾—å¯ç”¨ï¼Œæ§åˆ¶å™¨å°†ä¿®æ”¹æ´»åŠ¨æœåŠ¡ä»¥æŒ‡å‘æ–°çš„ ReplicaSetã€‚åœ¨ç­‰å¾… &lt;code&gt;.spec.strategy.blueGreen.scaleDownDelaySeconds&lt;/code&gt; é…ç½®çš„ä¸€äº›æ—¶é—´ä¹‹åï¼Œæ§åˆ¶å™¨å°†ç¼©å°æ—§ ReplicaSetã€‚&lt;/p&gt;
&lt;p&gt;ğŸ”” é‡è¦ï¼šå½“ Rollout åœ¨æœåŠ¡ä¸Šæ›´æ”¹é€‰æ‹©å™¨æ—¶ï¼Œæ‰€æœ‰èŠ‚ç‚¹æ›´æ–°å…¶ IP è¡¨ä»¥å°†æµé‡å‘é€åˆ°æ–°çš„ Pod è€Œä¸æ˜¯æ—§çš„ Pod ä¹‹å‰å­˜åœ¨ä¼ æ’­å»¶è¿Ÿã€‚åœ¨æ­¤å»¶è¿ŸæœŸé—´ï¼Œå¦‚æœèŠ‚ç‚¹å°šæœªæ›´æ–°ï¼Œåˆ™æµé‡å°†è¢«å®šå‘åˆ°æ—§ Podã€‚ä¸ºäº†é˜²æ­¢å°†æ•°æ®åŒ…å‘é€åˆ°æ€æ­»æ—§ Pod çš„èŠ‚ç‚¹ï¼ŒRollout ä½¿ç”¨ &lt;code&gt;scaleDownDelaySeconds&lt;/code&gt; å­—æ®µä¸ºèŠ‚ç‚¹æä¾›è¶³å¤Ÿçš„æ—¶é—´æ¥å¹¿æ’­ IP è¡¨æ›´æ”¹ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç¤ºä¾‹&#34;&gt;ç¤ºä¾‹&lt;/h2&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;argoproj.io/v1alpha1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Rollout&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;rollout-bluegreen&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;replicas&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;revisionHistoryLimit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;selector&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;matchLabels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;rollout-bluegreen&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;template&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;labels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;rollout-bluegreen&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;containers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;rollouts-demo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;image&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;argoproj/rollouts-demo:blue&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;imagePullPolicy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Always&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;ports&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;containerPort&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;8080&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;strategy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;blueGreen&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# activeService æŒ‡å®šè¦åœ¨å‡çº§æ—¶ä½¿ç”¨æ–°æ¨¡æ¿å“ˆå¸Œæ›´æ–°çš„æœåŠ¡ã€‚&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# å¯¹äºè“ç»¿æ›´æ–°ç­–ç•¥ï¼Œæ­¤å­—æ®µä¸ºå¿…å¡«å­—æ®µã€‚&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;activeService&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;rollout-bluegreen-active&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# previewService æŒ‡å®šè¦åœ¨æ¨å¹¿ä¹‹å‰ä½¿ç”¨æ–°æ¨¡æ¿å“ˆå¸Œæ›´æ–°çš„æœåŠ¡ã€‚&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# è¿™ä½¿å¾—é¢„è§ˆæ ˆå¯ä»¥åœ¨ä¸æä¾›ç”Ÿäº§æµé‡çš„æƒ…å†µä¸‹å¯è¾¾ã€‚&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# æ­¤å­—æ®µä¸ºå¯é€‰å­—æ®µã€‚&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;previewService&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;rollout-bluegreen-preview&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# autoPromotionEnabled é€šè¿‡åœ¨æ¨å¹¿ä¹‹å‰ç«‹å³æš‚åœ Rollout æ¥ç¦ç”¨æ–°å †æ ˆçš„è‡ªåŠ¨æ¨å¹¿ã€‚&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# å¦‚æœçœç•¥ï¼Œé»˜è®¤è¡Œä¸ºæ˜¯åœ¨ ReplicaSet å®Œå…¨å‡†å¤‡/å¯ç”¨åç«‹å³æ¨å¹¿æ–°å †æ ˆã€‚&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¢å¤ Rolloutï¼š`kubectl argo rollouts promote ROLLOUT`&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;autoPromotionEnabled&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;å¯é…ç½®çš„ç‰¹æ€§&#34;&gt;å¯é…ç½®çš„ç‰¹æ€§&lt;/h2&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯å°†æ›´æ”¹ BlueGreen éƒ¨ç½²è¡Œä¸ºçš„å¯é€‰å­—æ®µï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;  spec:
    strategy:
      blueGreen:
        autoPromotionEnabled: boolean
        autoPromotionSeconds: *int32
        antiAffinity: object
        previewService: string
        prePromotionAnalysis: object
        postPromotionAnalysis: object
        previewReplicaCount: *int32
        scaleDownDelaySeconds: *int32
        scaleDownDelayRevisionLimit: *int32
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;äº‹ä»¶åºåˆ—&#34;&gt;äº‹ä»¶åºåˆ—&lt;/h2&gt;
&lt;p&gt;ä»¥ä¸‹æè¿°äº†è“ç»¿æ›´æ–°æœŸé—´å‘ç”Ÿçš„äº‹ä»¶åºåˆ—ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä»å®Œå…¨æ¨å¹¿çš„ç¨³å®šçŠ¶æ€å¼€å§‹ï¼Œä½¿ç”¨ä¿®è®¢ç‰ˆæœ¬ 1 çš„ ReplicaSet æŒ‡å‘ &lt;code&gt;activeService&lt;/code&gt; å’Œ &lt;code&gt;previewService&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ç”¨æˆ·é€šè¿‡ä¿®æ”¹ Pod æ¨¡æ¿ (&lt;code&gt;spec.template.spec&lt;/code&gt;) å¯åŠ¨æ›´æ–°ã€‚&lt;/li&gt;
&lt;li&gt;åˆ›å»ºå¤§å°ä¸º 0 çš„ä¿®è®¢ç‰ˆæœ¬ 2 ReplicaSetã€‚&lt;/li&gt;
&lt;li&gt;ä¿®æ”¹é¢„è§ˆæœåŠ¡ä»¥æŒ‡å‘ä¿®è®¢ç‰ˆæœ¬ 2 ReplicaSetã€‚&lt;code&gt;activeService&lt;/code&gt; ä»æŒ‡å‘ä¿®è®¢ç‰ˆæœ¬ 1ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœä½¿ç”¨äº† &lt;code&gt;previewReplicaCount&lt;/code&gt;ï¼Œåˆ™å°†ä¿®è®¢ç‰ˆæœ¬ 2 ReplicaSet ç¼©æ”¾åˆ° &lt;code&gt;spec.replicas&lt;/code&gt; æˆ– &lt;code&gt;previewReplicaCount&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;ä¸€æ—¦ä¿®è®¢ç‰ˆæœ¬ 2 ReplicaSet Pod å®Œå…¨å¯ç”¨ï¼Œ&lt;code&gt;prePromotionAnalysis&lt;/code&gt; å°±ä¼šå¼€å§‹ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨ &lt;code&gt;prePromotionAnalysis&lt;/code&gt; æˆåŠŸåï¼Œå¦‚æœ &lt;code&gt;autoPromotionEnabled&lt;/code&gt; ä¸º false æˆ– &lt;code&gt;autoPromotionSeconds&lt;/code&gt; ä¸ä¸ºé›¶ï¼Œåˆ™è“ç»¿è‰²æš‚åœã€‚&lt;/li&gt;
&lt;li&gt;é€šè¿‡æ‰‹åŠ¨æˆ–è‡ªåŠ¨è¶…è¿‡ &lt;code&gt;autoPromotionSeconds&lt;/code&gt; æ¥æ¢å¤ Rolloutã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœä½¿ç”¨äº† &lt;code&gt;previewReplicaCount&lt;/code&gt;ï¼Œåˆ™å°†ä¿®è®¢ç‰ˆæœ¬ 2 ReplicaSet ç¼©æ”¾åˆ° &lt;code&gt;spec.replicas&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;Rollout é€šè¿‡å°† &lt;code&gt;activeService&lt;/code&gt; æ›´æ–°ä¸ºæŒ‡å‘æ–°çš„ ReplicaSet æ¥â€œæ¨å¹¿â€ä¿®è®¢ç‰ˆæœ¬ 2 ReplicaSetã€‚æ­¤æ—¶ï¼Œæ²¡æœ‰æœåŠ¡æŒ‡å‘ä¿®è®¢ç‰ˆæœ¬ 1&lt;/li&gt;
&lt;li&gt;&lt;code&gt;postPromotionAnalysis&lt;/code&gt; åˆ†æå¼€å§‹&lt;/li&gt;
&lt;li&gt;ä¸€æ—¦ &lt;code&gt;postPromotionAnalysis&lt;/code&gt; æˆåŠŸå®Œæˆï¼Œæ›´æ–°æˆåŠŸï¼Œä¿®è®¢ç‰ˆæœ¬ 2 ReplicaSet è¢«æ ‡è®°ä¸ºç¨³å®šã€‚Rollout è¢«è®¤ä¸ºæ˜¯å®Œå…¨æ¨å¹¿ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨ç­‰å¾… &lt;code&gt;scaleDownDelaySeconds&lt;/code&gt;ï¼ˆé»˜è®¤ä¸º 30 ç§’ï¼‰ä¹‹åï¼Œä¿®è®¢ç‰ˆæœ¬ 1 ReplicaSet è¢«ç¼©å°ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;autopromotionenabled&#34;&gt;autoPromotionEnabled&lt;/h3&gt;
&lt;p&gt;AutoPromotionEnabled å°†ä½¿ Rollout åœ¨æ–°çš„ ReplicaSet å¥åº·åè‡ªåŠ¨å°†å…¶æ¨å¹¿åˆ°æ´»åŠ¨æœåŠ¡ã€‚å¦‚æœæœªæŒ‡å®šï¼Œè¯¥å­—æ®µçš„é»˜è®¤å€¼ä¸º trueã€‚&lt;/p&gt;
&lt;p&gt;é»˜è®¤ä¸º true&lt;/p&gt;
&lt;h3 id=&#34;autopromotionseconds&#34;&gt;autoPromotionSeconds&lt;/h3&gt;
&lt;p&gt;AutoPromotionSeconds å°†ä½¿ Rollout åœ¨è‡ªåŠ¨æš‚åœçŠ¶æ€ä¸‹è¿›å…¥ AutoPromotionSeconds æ—¶é—´åè‡ªåŠ¨å°†æ–°çš„ ReplicaSet æ¨å¹¿åˆ°æ´»åŠ¨æœåŠ¡ã€‚å¦‚æœ &lt;code&gt;AutoPromotionEnabled&lt;/code&gt; å­—æ®µè®¾ç½®ä¸º falseï¼Œåˆ™å°†å¿½ç•¥æ­¤å­—æ®µã€‚&lt;/p&gt;
&lt;p&gt;é»˜è®¤ä¸º nil&lt;/p&gt;
&lt;h3 id=&#34;antiaffinity&#34;&gt;antiAffinity&lt;/h3&gt;
&lt;p&gt;æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ Anti Affinity æ–‡æ¡£ã€‚&lt;/p&gt;
&lt;p&gt;é»˜è®¤ä¸º nil&lt;/p&gt;
&lt;h3 id=&#34;maxunavailable&#34;&gt;maxUnavailable&lt;/h3&gt;
&lt;p&gt;åœ¨æ›´æ–°æœŸé—´å¯ä»¥ä¸å¯ç”¨çš„ Pod çš„æœ€å¤§æ•°é‡ã€‚è¯¥å€¼å¯ä»¥æ˜¯ç»å¯¹æ•°å­—ï¼ˆä¾‹å¦‚ï¼š5ï¼‰æˆ–æ‰€éœ€ Pod çš„ç™¾åˆ†æ¯”ï¼ˆä¾‹å¦‚ï¼š10%ï¼‰ã€‚å¦‚æœ MaxSurge ä¸º 0ï¼Œåˆ™ä¸èƒ½ä¸º 0ã€‚&lt;/p&gt;
&lt;p&gt;é»˜è®¤ä¸º 0&lt;/p&gt;
&lt;h3 id=&#34;prepromotionanalysis&#34;&gt;prePromotionAnalysis&lt;/h3&gt;
&lt;p&gt;åœ¨å°†æµé‡åˆ‡æ¢åˆ°æ–°ç‰ˆæœ¬ä¹‹å‰ï¼Œé…ç½® Analysisã€‚AnalysisRun å¯ç”¨äºåœ¨ AnalysisRun æˆåŠŸå®Œæˆä¹‹å‰é˜»æ­¢ Service é€‰æ‹©å™¨åˆ‡æ¢ã€‚åˆ†æè¿è¡Œçš„æˆåŠŸæˆ–å¤±è´¥å†³å®š Rollout æ˜¯å¦åˆ‡æ¢æµé‡ï¼Œæˆ–å®Œå…¨ä¸­æ­¢ Rolloutã€‚&lt;/p&gt;
&lt;p&gt;é»˜è®¤ä¸º nil&lt;/p&gt;
&lt;h3 id=&#34;postpromotionanalysis&#34;&gt;postPromotionAnalysis&lt;/h3&gt;
&lt;p&gt;åœ¨å°†æµé‡åˆ‡æ¢åˆ°æ–°ç‰ˆæœ¬åé…ç½® Analysisã€‚å¦‚æœåˆ†æè¿è¡Œå¤±è´¥æˆ–å‡ºé”™ï¼Œåˆ™ Rollout è¿›å…¥ä¸­æ­¢çŠ¶æ€å¹¶å°†æµé‡åˆ‡æ¢å›ä»¥å‰çš„ç¨³å®š Replicasetã€‚å¦‚æœæŒ‡å®šäº† &lt;code&gt;scaleDownDelaySeconds&lt;/code&gt;ï¼Œæ§åˆ¶å™¨å°†åœ¨ &lt;code&gt;scaleDownDelay&lt;/code&gt; æ—¶å–æ¶ˆä»»ä½• AnalysisRuns ä»¥ç¼©å° ReplicaSetã€‚å¦‚æœçœç•¥å®ƒï¼Œå¹¶ä¸”æŒ‡å®šäº†åæœŸåˆ†æï¼Œåˆ™ä»…åœ¨ AnalysisRun å®Œæˆåç¼©å° ReplicaSetï¼ˆæœ€å°‘ä¸º 30 ç§’ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;é»˜è®¤ä¸º nil&lt;/p&gt;
&lt;h3 id=&#34;previewservice&#34;&gt;previewService&lt;/h3&gt;
&lt;p&gt;PreviewService å­—æ®µå¼•ç”¨å°†è¢«ä¿®æ”¹ä»¥åœ¨æ–° ReplicaSet ä¹‹å‰å‘é€æµé‡çš„ Serviceã€‚ä¸€æ—¦æ–° ReplicaSet å¼€å§‹æ¥æ”¶æ¥è‡ªæ´»åŠ¨æœåŠ¡çš„æµé‡ï¼Œé¢„è§ˆæœåŠ¡ä¹Ÿå°†è¢«ä¿®æ”¹ä»¥å°†æµé‡å‘é€åˆ°æ–° ReplicaSetã€‚Rollout å§‹ç»ˆç¡®ä¿é¢„è§ˆæœåŠ¡å°†æµé‡å‘é€åˆ°æœ€æ–°çš„ ReplicaSetã€‚å› æ­¤ï¼Œå¦‚æœåœ¨å°†æ—§ç‰ˆæœ¬æ¨å¹¿åˆ°æ´»åŠ¨æœåŠ¡ä¹‹å‰å¼•å…¥æ–°ç‰ˆæœ¬ï¼Œåˆ™æ§åˆ¶å™¨å°†ç«‹å³åˆ‡æ¢åˆ°å…¨æ–°çš„ç‰ˆæœ¬ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤åŠŸèƒ½ç”¨äºæä¾›å¯ä»¥ç”¨äºæµ‹è¯•åº”ç”¨ç¨‹åºçš„æ–°ç‰ˆæœ¬çš„ç»ˆç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;é»˜è®¤ä¸ºç©ºå­—ç¬¦ä¸²&lt;/p&gt;
&lt;h3 id=&#34;previewreplicacount&#34;&gt;previewReplicaCount&lt;/h3&gt;
&lt;p&gt;PreviewReplicaCount å­—æ®µå°†æŒ‡ç¤ºæ–°ç‰ˆæœ¬çš„åº”ç”¨ç¨‹åºåº”è¿è¡Œçš„å‰¯æœ¬æ•°ã€‚ä¸€æ—¦åº”ç”¨ç¨‹åºå‡†å¤‡å¥½æ¨å¹¿åˆ°æ´»åŠ¨æœåŠ¡ï¼Œæ§åˆ¶å™¨å°†æ‰©å±•æ–°çš„ ReplicaSet åˆ° &lt;code&gt;spec.replicas&lt;/code&gt; çš„å€¼ã€‚åœ¨æµ‹è¯•é˜¶æ®µæœŸé—´ï¼Œæ­¤åŠŸèƒ½çš„ä¸»è¦ç”¨é€”æ˜¯èŠ‚çœèµ„æºã€‚å¦‚æœåº”ç”¨ç¨‹åºä¸éœ€è¦å®Œå…¨ç¼©æ”¾åº”ç”¨ç¨‹åºè¿›è¡Œæµ‹è¯•ï¼Œåˆ™æ­¤åŠŸèƒ½å¯ä»¥å¸®åŠ©èŠ‚çœä¸€äº›èµ„æºã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœçœç•¥ï¼Œåˆ™é¢„è§ˆ ReplicaSet å †æ ˆå°†ç¼©æ”¾åˆ° 100% çš„å‰¯æœ¬ã€‚&lt;/p&gt;
&lt;h3 id=&#34;scaledowndelayseconds&#34;&gt;scaleDownDelaySeconds&lt;/h3&gt;
&lt;p&gt;ScaleDownDelaySeconds ç”¨äºåœ¨å°†æ´»åŠ¨æœåŠ¡åˆ‡æ¢åˆ°æ–° ReplicaSet åå»¶è¿Ÿç¼©å°æ—§ ReplicaSetã€‚&lt;/p&gt;
&lt;p&gt;é»˜è®¤ä¸º 30&lt;/p&gt;
&lt;h3 id=&#34;scaledowndelayrevisionlimit&#34;&gt;scaleDownDelayRevisionLimit&lt;/h3&gt;
&lt;p&gt;ScaleDownDelayRevisionLimit é™åˆ¶ä¿ç•™åœ¨æ´»åŠ¨æœåŠ¡ä¸­çš„æ—§ ReplicaSet æ•°é‡ï¼Œç›´åˆ°ä»æ´»åŠ¨æœåŠ¡ä¸­åˆ é™¤åçš„ scaleDownDelayã€‚å¦‚æœçœç•¥ï¼Œåˆ™å°†ä¿ç•™æ‰€æœ‰ ReplicaSets ä»¥ä¾›æŒ‡å®šçš„ scaleDownDelayã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>é‡‘ä¸é›€éƒ¨ç½²</title>
      <link>https://lib.jimmysong.io/argo-rollouts/rollout/deployment-strategies/canary/</link>
      <pubDate>Wed, 21 Jun 2023 16:00:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/argo-rollouts/rollout/deployment-strategies/canary/</guid>
      <description>&lt;p&gt;é‡‘ä¸é›€å‘å¸ƒæ˜¯ä¸€ç§éƒ¨ç½²ç­–ç•¥ï¼Œæ“ä½œå‘˜å°†æ–°ç‰ˆæœ¬çš„åº”ç”¨ç¨‹åºé‡Šæ”¾åˆ°ç”Ÿäº§æµé‡çš„ä¸€å°éƒ¨åˆ†ä¸­ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ¦‚è¿°&#34;&gt;æ¦‚è¿°&lt;/h2&gt;
&lt;p&gt;ç”±äºæ²¡æœ‰å…³äºé‡‘ä¸é›€éƒ¨ç½²çš„å…±è¯†æ ‡å‡†ï¼Œå› æ­¤ Rollouts Controller å…è®¸ç”¨æˆ·æ¦‚è¿°ä»–ä»¬æƒ³è¦è¿è¡Œå…¶é‡‘ä¸é›€éƒ¨ç½²çš„æ–¹å¼ã€‚ç”¨æˆ·å¯ä»¥å®šä¹‰ä¸€ä¸ªæ§åˆ¶å™¨ä½¿ç”¨çš„æ­¥éª¤åˆ—è¡¨ï¼Œä»¥åœ¨&lt;code&gt;.spec.template&lt;/code&gt;å‘ç”Ÿæ›´æ”¹æ—¶æ“ä½œ ReplicaSetsã€‚åœ¨æ–°çš„ ReplicaSet è¢«æå‡ä¸ºç¨³å®šç‰ˆæœ¬å¹¶ä¸”æ—§ç‰ˆæœ¬è¢«å®Œå…¨ç¼©å‡ä¹‹å‰ï¼Œæ¯ä¸ªæ­¥éª¤å°†è¢«è¯„ä¼°ã€‚&lt;/p&gt;
&lt;p&gt;æ¯ä¸ªæ­¥éª¤å¯ä»¥æœ‰ä¸¤ä¸ªå­—æ®µã€‚&lt;code&gt;setWeight&lt;/code&gt;å­—æ®µæŒ‡å®šåº”å‘é€åˆ°é‡‘ä¸é›€çš„æµé‡ç™¾åˆ†æ¯”ï¼Œ&lt;code&gt;pause&lt;/code&gt;ç»“æ„æŒ‡ç¤º Rollout æš‚åœã€‚å½“æ§åˆ¶å™¨åˆ°è¾¾ Rollout çš„&lt;code&gt;pause&lt;/code&gt;æ­¥éª¤æ—¶ï¼Œå®ƒå°†å‘&lt;code&gt;.status.PauseConditions&lt;/code&gt;å­—æ®µæ·»åŠ ä¸€ä¸ª&lt;code&gt;PauseCondition&lt;/code&gt;ç»“æ„ã€‚å¦‚æœ&lt;code&gt;pause&lt;/code&gt;ç»“æ„ä¸­çš„&lt;code&gt;duration&lt;/code&gt;å­—æ®µè®¾ç½®ï¼ŒRollout å°†åœ¨ç­‰å¾…&lt;code&gt;duration&lt;/code&gt;å­—æ®µçš„å€¼ä¹‹å‰ä¸ä¼šè¿›å…¥ä¸‹ä¸€ä¸ªæ­¥éª¤ã€‚å¦åˆ™ï¼ŒRollout å°†æ— é™æœŸç­‰å¾…è¯¥ Pause æ¡ä»¶è¢«åˆ é™¤ã€‚é€šè¿‡ä½¿ç”¨&lt;code&gt;setWeight&lt;/code&gt;å’Œ&lt;code&gt;pause&lt;/code&gt;å­—æ®µï¼Œç”¨æˆ·å¯ä»¥æè¿°ä»–ä»¬æƒ³è¦å¦‚ä½•è¿›å…¥æ–°ç‰ˆæœ¬ã€‚ä»¥ä¸‹æ˜¯é‡‘ä¸é›€ç­–ç•¥çš„ç¤ºä¾‹ã€‚&lt;/p&gt;
&lt;p&gt;ğŸ”” é‡è¦ï¼šå¦‚æœé‡‘ä¸é›€ Rollout æœªä½¿ç”¨&lt;a href=&#34;../traffic-management/&#34;&gt;æµé‡ç®¡ç†&lt;/a&gt;ï¼Œåˆ™ Rollout å°†å°½æœ€å¤§åŠªåŠ›åœ¨æ–°ç‰ˆæœ¬å’Œæ—§ç‰ˆæœ¬ä¹‹é—´å®ç°æœ€åä¸€ä¸ª&lt;code&gt;setWeight&lt;/code&gt;æ­¥éª¤ä¸­åˆ—å‡ºçš„ç™¾åˆ†æ¯”ã€‚ä¾‹å¦‚ï¼Œå¦‚æœ Rollout æœ‰ 10 ä¸ªå‰¯æœ¬å’Œ 10ï¼… çš„ç¬¬ä¸€ä¸ª&lt;code&gt;setWeight&lt;/code&gt;æ­¥éª¤ï¼Œåˆ™æ§åˆ¶å™¨å°†å°†æ–°çš„æœŸæœ› ReplicaSet ç¼©æ”¾ä¸º 1 ä¸ªå‰¯æœ¬ï¼Œå°†æ—§çš„ç¨³å®š ReplicaSet ç¼©æ”¾ä¸º 9 ä¸ªã€‚åœ¨ setWeight ä¸º 15ï¼…çš„æƒ…å†µä¸‹ï¼ŒRollout å°è¯•é€šè¿‡å‘ä¸Šèˆå…¥è®¡ç®—ï¼ˆå³ï¼Œæ–°çš„ ReplicaSet å…·æœ‰ 2 ä¸ª Podï¼Œå› ä¸º 10 çš„ 15ï¼…å‘ä¸Šèˆå…¥ä¸º 2ï¼Œæ—§çš„ ReplicaSet å…·æœ‰ 9 ä¸ª Podï¼Œå› ä¸º 10 çš„ 85ï¼…å‘ä¸Šèˆå…¥ä¸º 9ï¼‰è·å¾—æ›´ç²¾ç»†çš„æ§åˆ¶ç™¾åˆ†æ¯”è€Œä¸ä½¿ç”¨å¤§é‡å‰¯æœ¬ã€‚é‚£ä¸ªç”¨æˆ·åº”è¯¥ä½¿ç”¨æµé‡ç®¡ç†åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç¤ºä¾‹&#34;&gt;ç¤ºä¾‹&lt;/h2&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;argoproj.io/v1alpha1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Rollout&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;example-rollout&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;replicas&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;selector&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;     &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;matchLabels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;nginx&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;template&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;     &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;labels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;         &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;nginx&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;     &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;containers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;nginx&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;         &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;image&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;nginx:1.15.4&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;         &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;ports&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;         &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;containerPort&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;80&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;minReadySeconds&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;30&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;revisionHistoryLimit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;strategy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;     &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;canary&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;#è¡¨æ˜ Rollout åº”ä½¿ç”¨é‡‘ä¸é›€ç­–ç•¥&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;maxSurge&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;25%&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;maxUnavailable&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;steps&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;setWeight&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;pause&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;           &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;duration&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;1h&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# 1 å°æ—¶&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;setWeight&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;20&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;pause&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;{}&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# ç„¡é™æœŸæš‚åœ&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;æš‚åœæŒç»­æ—¶é—´&#34;&gt;æš‚åœæŒç»­æ—¶é—´&lt;/h2&gt;
&lt;p&gt;æš‚åœæŒç»­æ—¶é—´å¯ä»¥ç”¨å¯é€‰çš„æ—¶é—´å•ä½åç¼€æŒ‡å®šã€‚æœ‰æ•ˆçš„æ—¶é—´å•ä½ä¸ºâ€œsâ€ã€â€œmâ€ã€â€œhâ€ã€‚å¦‚æœæœªæŒ‡å®šï¼Œåˆ™é»˜è®¤ä¸ºâ€œsâ€ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;strategy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;     &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;canary&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;steps&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;         &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;pause&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;{&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;duration&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;}&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# 10 ç§’&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;         &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;pause&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;{&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;duration&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;10s }&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# 10 ç§’&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;         &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;pause&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;{&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;duration&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;10m }&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# 10 åˆ†é’Ÿ&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;         &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;pause&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;{&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;duration&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;10h }&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# 10 å°æ—¶&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;         &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;pause&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;{}&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# æ— é™æœŸæš‚åœ&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¦‚æœæš‚åœæ­¥éª¤æ²¡æœ‰æŒ‡å®š&lt;code&gt;duration&lt;/code&gt;ï¼Œåˆ™ Rollout å°†æ— é™æœŸæš‚åœã€‚è¦å–æ¶ˆæš‚åœï¼Œè¯·ä½¿ç”¨ argo kubectl æ’ä»¶&lt;code&gt;promote&lt;/code&gt;å‘½ä»¤ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;c1&#34;&gt;# æå‡åˆ°ä¸‹ä¸€æ­¥&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; kubectl argo rollouts promote &amp;lt;rollout&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;åŠ¨æ€é‡‘ä¸é›€è§„æ¨¡å¸¦æµé‡è·¯ç”±&#34;&gt;åŠ¨æ€é‡‘ä¸é›€è§„æ¨¡ï¼ˆå¸¦æµé‡è·¯ç”±ï¼‰&lt;/h2&gt;
&lt;p&gt;é»˜è®¤æƒ…å†µä¸‹ï¼ŒRollout æ§åˆ¶å™¨å°†æ ¹æ®å½“å‰æ­¥éª¤çš„&lt;code&gt;trafficWeight&lt;/code&gt;æ¥æ‰©å±•é‡‘ä¸é›€ï¼Œä»¥åŒ¹é…æµé‡æƒé‡ã€‚ä¾‹å¦‚ï¼Œå¦‚æœå½“å‰æƒé‡ä¸º 25ï¼…ï¼Œå¹¶ä¸”æœ‰å››ä¸ªå‰¯æœ¬ï¼Œåˆ™ä¸ºäº†åŒ¹é…æµé‡æƒé‡ï¼Œé‡‘ä¸é›€å°†è¢«ç¼©æ”¾ä¸º 1ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥æ§åˆ¶é‡‘ä¸é›€å‰¯æœ¬åœ¨æ­¥éª¤æœŸé—´çš„ç¼©æ”¾æ¯”ä¾‹ï¼Œä»¥ä¾¿å®ƒä¸å¿…å¿…é¡»åŒ¹é…æµé‡æƒé‡ã€‚ä»¥ä¸‹æ˜¯æ­¤ç±»ç”¨ä¾‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ–°ç‰ˆæœ¬ä¸åº”å…¬å¼€ï¼ˆ&lt;code&gt;setWeight: 0&lt;/code&gt;ï¼‰ï¼Œä½†ä½ å¸Œæœ›å°†é‡‘ä¸é›€æ‰©å±•åˆ°è¿›è¡Œæµ‹è¯•ã€‚&lt;/li&gt;
&lt;li&gt;ä½ å¸Œæœ›æœ€å°åŒ–é‡‘ä¸é›€å †æ ˆçš„è§„æ¨¡ï¼Œå¹¶ä½¿ç”¨ä¸€äº›åŸºäºæ ‡å¤´çš„æµé‡æ•´å½¢åˆ°é‡‘ä¸é›€ï¼Œè€Œ&lt;code&gt;setWeight&lt;/code&gt;ä»ç„¶è®¾ç½®ä¸º 0ã€‚&lt;/li&gt;
&lt;li&gt;ä½ å¸Œæœ›å°†é‡‘ä¸é›€æ‰©å±•åˆ° 100ï¼…ï¼Œä»¥ä¾¿è¿›è¡Œæµé‡é˜´å½±å¤„ç†ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ğŸ”” é‡è¦ï¼šä»…å½“ä½¿ç”¨å¸¦æœ‰æµé‡è·¯ç”±çš„é‡‘ä¸é›€ç­–ç•¥æ—¶ï¼Œæ‰å¯ä»¥è®¾ç½®é‡‘ä¸é›€æ¯”ä¾‹ã€‚&lt;/p&gt;
&lt;p&gt;è¦åœ¨æ­¥éª¤æœŸé—´æ§åˆ¶é‡‘ä¸é›€æ¯”ä¾‹å’Œæƒé‡ï¼Œè¯·ä½¿ç”¨&lt;code&gt;setCanaryScale&lt;/code&gt;æ­¥éª¤ï¼Œå¹¶æŒ‡ç¤ºé‡‘ä¸é›€åº”ä½¿ç”¨å“ªä¸ªæ¯”ä¾‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ˜¾å¼å‰¯æœ¬è®¡æ•°è€Œä¸æ›´æ”¹æµé‡æƒé‡ï¼ˆ&lt;code&gt;replicas&lt;/code&gt;ï¼‰&lt;/li&gt;
&lt;li&gt;spec.replicas ä¸­çš„æ˜ç¡®çš„æƒé‡ç™¾åˆ†æ¯”ï¼Œè€Œä¸æ›´æ”¹æµé‡æƒé‡ï¼ˆ&lt;code&gt;weight&lt;/code&gt;ï¼‰&lt;/li&gt;
&lt;li&gt;æ˜¯å¦åŒ¹é…å½“å‰é‡‘ä¸é›€çš„&lt;code&gt;setWeight&lt;/code&gt;æ­¥éª¤ï¼ˆ&lt;code&gt;matchTrafficWeightï¼štrueæˆ–false&lt;/code&gt;ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;strategy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;     &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;canary&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;steps&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# æ˜¾å¼è®¡æ•°&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;setCanaryScale&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;           &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;replicas&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# spec.replicas çš„ç™¾åˆ†æ¯”&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;setCanaryScale&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;           &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;weight&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;25&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# matchTrafficWeight è¿”å›ä¸ canary æµé‡æƒé‡åŒ¹é…çš„é»˜è®¤è¡Œä¸º&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;setCanaryScale&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;           &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;matchTrafficWeight&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åœ¨ä½¿ç”¨å…·æœ‰æ˜¾å¼å€¼çš„&lt;code&gt;setCanaryScale&lt;/code&gt;çš„æƒ…å†µä¸‹ï¼Œå¦‚æœä¸&lt;code&gt;setWeight&lt;/code&gt;æ­¥éª¤ä¸€èµ·ä½¿ç”¨æ—¶ä¸æ­£ç¡®ï¼Œåˆ™å¿…é¡»å°å¿ƒã€‚å¦‚æœä¸æ­£ç¡®åœ°å®Œæˆï¼Œåˆ™ä¼šå°†ä¸å¹³è¡¡çš„æµé‡æ¯”ä¾‹å®šå‘åˆ°é‡‘ä¸é›€ï¼ˆä¸ Rollout çš„æ¯”ä¾‹æˆæ¯”ä¾‹ï¼‰ã€‚ä¾‹å¦‚ï¼Œä»¥ä¸‹ä¸€ç»„æ­¥éª¤å°†å¯¼è‡´ 90ï¼…çš„æµé‡ä»…ç”± 10ï¼…çš„ Pod æä¾›æœåŠ¡ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;replicas&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;strategy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;     &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;canary&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;steps&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# 1 é‡‘ä¸é›€ Podï¼ˆspec.replicas çš„ 10ï¼…ï¼‰&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;setCanaryScale&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;           &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;weight&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# 90ï¼…çš„æµé‡åˆ° 1 ä¸ªé‡‘ä¸é›€ Pod&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;setWeight&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;90&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;pause&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;{}&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¸Šè¿°æƒ…å†µæ˜¯ç”±äº&lt;code&gt;setWeight&lt;/code&gt;åœ¨&lt;code&gt;setCanaryScale&lt;/code&gt;ä¹‹åçš„æ›´æ”¹è¡Œä¸ºå¼•èµ·çš„ã€‚è¦é‡ç½®ï¼Œè¯·è®¾ç½®&lt;code&gt;matchTrafficWeightï¼štrue&lt;/code&gt;ï¼Œå¹¶å°†æ¢å¤&lt;code&gt;setWeight&lt;/code&gt;è¡Œä¸ºï¼Œå³ï¼Œåç»­&lt;code&gt;setWeight&lt;/code&gt;å°†åˆ›å»ºä¸æµé‡æƒé‡åŒ¹é…çš„é‡‘ä¸é›€å‰¯æœ¬ã€‚&lt;/p&gt;
&lt;h2 id=&#34;åŠ¨æ€ç¨³å®šè§„æ¨¡å¸¦æµé‡è·¯ç”±&#34;&gt;åŠ¨æ€ç¨³å®šè§„æ¨¡ï¼ˆå¸¦æµé‡è·¯ç”±ï¼‰&lt;/h2&gt;
&lt;p&gt;ğŸ”” é‡è¦ï¼šä» v1.1 å¼€å§‹å¯ç”¨&lt;/p&gt;
&lt;p&gt;åœ¨ä½¿ç”¨æµé‡è·¯ç”±æ—¶ï¼Œé»˜è®¤æƒ…å†µä¸‹ç¨³å®šçš„ ReplicaSet åœ¨æ›´æ–°æœŸé—´ä¿æŒç¼©æ”¾ä¸º 100ï¼…ã€‚è¿™å…·æœ‰ä¸€ä¸ªä¼˜ç‚¹ï¼Œå³å¦‚æœå‘ç”Ÿä¸­æ­¢ï¼Œåˆ™å¯ä»¥ç«‹å³å°†æµé‡è½¬ç§»åˆ°ç¨³å®šçš„ ReplicaSet è€Œæ— éœ€å»¶è¿Ÿã€‚ä½†æ˜¯ï¼Œå®ƒçš„ç¼ºç‚¹æ˜¯åœ¨æ›´æ–°æœŸé—´ï¼Œå°†æœ€ç»ˆå­˜åœ¨åŒå€æ•°é‡çš„å‰¯æœ¬ Podï¼ˆç±»ä¼¼äºè“ç»¿è‰²éƒ¨ç½²ï¼‰ï¼Œå› ä¸ºç¨³å®šçš„ ReplicaSet åœ¨æ•´ä¸ªæ›´æ–°æœŸé—´éƒ½è¢«ç¼©æ”¾ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥é€šè¿‡åŠ¨æ€å‡å°‘ç¨³å®šçš„ ReplicaSet è§„æ¨¡æ¥å®ç°ï¼Œä»¥ä½¿å…¶åœ¨æµé‡æƒé‡å¢åŠ åˆ°é‡‘ä¸é›€æ—¶ç¼©å°ã€‚è¿™å¯¹äº Rollout å…·æœ‰é«˜å‰¯æœ¬è®¡æ•°å’Œèµ„æºæˆæœ¬æ˜¯ä¸€ä¸ªé—®é¢˜ï¼Œæˆ–è€…åœ¨è£¸æœºæƒ…å†µä¸‹ä¸å¯èƒ½åˆ›å»ºé¢å¤–çš„èŠ‚ç‚¹å®¹é‡ä»¥å®¹çº³åŒå€å‰¯æœ¬çš„æƒ…å†µä¸‹æ˜¯æœ‰ç”¨çš„ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥é€šè¿‡å°†&lt;code&gt;canary.dynamicStableScale&lt;/code&gt;æ ‡å¿—è®¾ç½®ä¸º true æ¥å¯ç”¨åŠ¨æ€ç¼©æ”¾ç¨³å®šçš„ ReplicaSetï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;strategy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;     &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;canary&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;dynamicStableScale&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¯·æ³¨æ„ï¼Œå¦‚æœè®¾ç½®äº†&lt;code&gt;dynamicStableScale&lt;/code&gt;å¹¶ä¸” Rollout ä¸­æ­¢äº†ï¼Œåˆ™é‡‘ä¸é›€ ReplicaSet å°†åŠ¨æ€ç¼©å°ï¼Œå› ä¸ºæµé‡è½¬ç§»åˆ°äº†ç¨³å®šçš„ ReplicaSetã€‚å¦‚æœä½ å¸Œæœ›åœ¨ä¸­æ­¢æ—¶ä¿ç•™é‡‘ä¸é›€ ReplicaSet çš„ç¼©æ”¾æ¯”ä¾‹ï¼Œåˆ™å¯ä»¥è®¾ç½®&lt;code&gt;abortScaleDownDelaySeconds&lt;/code&gt;çš„æ˜¾å¼å€¼ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;strategy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;     &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;canary&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;dynamicStableScale&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;abortScaleDownDelaySeconds&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;600&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;æ¨¡ä»¿æ»šåŠ¨æ›´æ–°&#34;&gt;æ¨¡ä»¿æ»šåŠ¨æ›´æ–°&lt;/h2&gt;
&lt;p&gt;å¦‚æœçœç•¥&lt;code&gt;steps&lt;/code&gt;å­—æ®µï¼Œåˆ™é‡‘ä¸é›€ç­–ç•¥å°†æ¨¡ä»¿æ»šåŠ¨æ›´æ–°è¡Œä¸ºã€‚ä¸éƒ¨ç½²ç±»ä¼¼ï¼Œé‡‘ä¸é›€ç­–ç•¥å…·æœ‰&lt;code&gt;maxSurge&lt;/code&gt;å’Œ&lt;code&gt;maxUnavailable&lt;/code&gt;å­—æ®µï¼Œä»¥é…ç½® Rollout åº”å¦‚ä½•å‘æ–°ç‰ˆæœ¬æ¨è¿›ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å…¶ä»–å¯é…ç½®ç‰¹æ€§&#34;&gt;å…¶ä»–å¯é…ç½®ç‰¹æ€§&lt;/h2&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯å°†ä¿®æ”¹é‡‘ä¸é›€ç­–ç•¥è¡Œä¸ºçš„å¯é€‰å­—æ®µï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;strategy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;     &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;canary&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;analysis&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;object&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;antiAffinity&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;object&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;canaryService&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;stableService&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;maxSurge&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;stringOrInt&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;maxUnavailable&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;stringOrInt&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;trafficRouting&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;object&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;analysis&#34;&gt;analysis&lt;/h3&gt;
&lt;p&gt;é…ç½®åœ¨ Rollout æœŸé—´æ‰§è¡Œçš„åå°åˆ†æã€‚å¦‚æœåˆ†æä¸æˆåŠŸï¼Œåˆ™ Rollout å°†ä¸­æ­¢ã€‚&lt;/p&gt;
&lt;p&gt;é»˜è®¤ä¸º nil&lt;/p&gt;
&lt;h3 id=&#34;antiaffinity&#34;&gt;antiAffinity&lt;/h3&gt;
&lt;p&gt;æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ Anti Affinity æ–‡æ¡£ã€‚&lt;/p&gt;
&lt;p&gt;é»˜è®¤ä¸º nil&lt;/p&gt;
&lt;h3 id=&#34;canaryservice&#34;&gt;canaryService&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;canaryService&lt;/code&gt;å¼•ç”¨å°†è¢«ä¿®æ”¹ä¸ºä»…å°†æµé‡å‘é€åˆ°é‡‘ä¸é›€ ReplicaSet çš„ Serviceã€‚è¿™ä½¿ç”¨æˆ·åªèƒ½å‡»ä¸­é‡‘ä¸é›€ ReplicaSetã€‚&lt;/p&gt;
&lt;p&gt;é»˜è®¤ä¸ºç©ºå­—ç¬¦ä¸²&lt;/p&gt;
&lt;h3 id=&#34;stableservice&#34;&gt;stableService&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;stableService&lt;/code&gt;æ˜¯ä¸€ä¸ªé€‰æ‹©å…·æœ‰ç¨³å®šç‰ˆæœ¬çš„ Podï¼Œå¹¶ä¸”ä¸ä¼šé€‰æ‹©ä»»ä½•å…·æœ‰é‡‘ä¸é›€ç‰ˆæœ¬çš„ Pod çš„ Service çš„åç§°ã€‚è¿™ä½¿ç”¨æˆ·åªèƒ½å‡»ä¸­ç¨³å®šçš„ ReplicaSetã€‚&lt;/p&gt;
&lt;p&gt;é»˜è®¤ä¸ºç©ºå­—ç¬¦ä¸²&lt;/p&gt;
&lt;h3 id=&#34;maxsurge&#34;&gt;maxSurge&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;maxSurge&lt;/code&gt; å®šä¹‰äº†å‡çº§è¿‡ç¨‹ä¸­å¯ä»¥åˆ›å»ºçš„æœ€å¤§å‰¯æœ¬æ•°ï¼Œä»¥è¾¾åˆ°æœ€åä¸€æ¬¡ setWeight è®¾ç½®çš„æ­£ç¡®æ¯”ä¾‹ã€‚Max Surge å¯ä»¥æ˜¯æ•´æ•°æˆ–ç™¾åˆ†æ¯”å­—ç¬¦ä¸²ï¼ˆä¾‹å¦‚ &amp;ldquo;20%&amp;quot;ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;é»˜è®¤ä¸º &amp;ldquo;25%&amp;quot;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;maxunavailable&#34;&gt;maxUnavailable&lt;/h3&gt;
&lt;p&gt;å‡çº§æœŸé—´å¯ä»¥ä¸å¯ç”¨çš„ Pod çš„æœ€å¤§æ•°é‡ã€‚å€¼å¯ä»¥æ˜¯ç»å¯¹æ•°ï¼ˆä¾‹å¦‚ï¼š5ï¼‰æˆ–æ‰€éœ€ Pod çš„ç™¾åˆ†æ¯”ï¼ˆä¾‹å¦‚ï¼š10%ï¼‰ã€‚å¦‚æœ MaxSurge ä¸º 0ï¼Œåˆ™ä¸èƒ½ä¸º 0ã€‚&lt;/p&gt;
&lt;p&gt;é»˜è®¤ä¸º &amp;ldquo;25%&amp;quot;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;trafficrouting&#34;&gt;trafficRouting&lt;/h3&gt;
&lt;p&gt;æµé‡ç®¡ç† è§„åˆ™ï¼Œç”¨äºæ§åˆ¶æ´»åŠ¨å’Œé‡‘ä¸é›€ç‰ˆæœ¬ä¹‹é—´çš„æµé‡ã€‚å¦‚æœæœªè®¾ç½®ï¼Œåˆ™å°†ä½¿ç”¨é»˜è®¤çš„åŸºäºåŠ æƒ Pod å‰¯æœ¬çš„è·¯ç”±ã€‚&lt;/p&gt;
&lt;p&gt;é»˜è®¤ä¸º nilã€‚&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>
