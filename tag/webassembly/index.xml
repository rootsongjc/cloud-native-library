<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>WebAssembly | äº‘åŸç”Ÿèµ„æ–™åº“</title>
    <link>https://lib.jimmysong.io/tag/webassembly/</link>
      <atom:link href="https://lib.jimmysong.io/tag/webassembly/index.xml" rel="self" type="application/rss+xml" />
    <description>WebAssembly</description>
    <generator>Wowchemy (https://wowchemy.com)</generator><language>zh</language><lastBuildDate>Tue, 24 Oct 2023 10:00:00 +0800</lastBuildDate>
    <image>
      <url>https://lib.jimmysong.io/media/sharing.png</url>
      <title>WebAssembly</title>
      <link>https://lib.jimmysong.io/tag/webassembly/</link>
    </image>
    
    <item>
      <title>åœ¨ UiPath Automation Suite ä¸­ä½¿ç”¨ Envoy å’Œ WASM ä¼˜åŒ–æµé‡è·¯ç”±</title>
      <link>https://lib.jimmysong.io/blog/optimizing-traffic-routing-uipath-automation-suite-envoy-wasm/</link>
      <pubDate>Tue, 24 Oct 2023 10:00:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/optimizing-traffic-routing-uipath-automation-suite-envoy-wasm/</guid>
      <description>&lt;p&gt;æœ¬æ–‡è¯‘è‡ªï¼š&lt;a href=&#34;https://www.uipath.com/inside-the-rocketship/tech-stories/optimizing-traffic-routing-uipath-automation-suite-envoy-wasm&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://www.uipath.com/inside-the-rocketship/tech-stories/optimizing-traffic-routing-uipath-automation-suite-envoy-wasm&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;åœ¨è¿™ç¯‡åšæ–‡ä¸­ï¼Œæˆ‘ä»¬å°†æ·±å…¥æ¢è®¨ UiPath Automation Suite çš„è·¯ç”±åŸºç¡€è®¾æ–½ï¼Œæ­ç¤ºå…³é”®è§è§£å’Œåˆ›æ–°æ–¹æ³•ä»¥æå‡æ€§èƒ½ã€‚&lt;/em&gt;&lt;/p&gt;
&lt;h3 id=&#34;uipath-automation-suite-å†…éƒ¨çš„æµé‡è·¯ç”±&#34;&gt;&lt;strong&gt;UiPath Automation Suite å†…éƒ¨çš„æµé‡è·¯ç”±&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.uipath.com/product/automation-suite&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;UiPath Automation Suite&lt;/a&gt;ä½¿æ‚¨èƒ½å¤Ÿåœ¨ Linux ä¸Šéƒ¨ç½²å®Œæ•´çš„&lt;a href=&#34;https://www.uipath.com/product&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;UiPath Business Automation Platform&lt;/a&gt;ï¼Œè¯¥å¹³å°ç”± 40 å¤šä¸ªå¾®æœåŠ¡ç»„æˆçš„ Kubernetes é›†ç¾¤ã€‚å®ƒæœ‰ä¸€ä¸ª API ç½‘å…³ä½äºæ‰€æœ‰å¾®æœåŠ¡ä¹‹å‰ï¼Œå…·æœ‰è‡ªå®šä¹‰çš„è·¯ç”±ä¸šåŠ¡é€»è¾‘ï¼Œä¾‹å¦‚æœåŠ¡å‘ç°ã€è¯·æ±‚æ‹¦æˆªã€è¯·æ±‚æ“ä½œå’Œé”™è¯¯å¤„ç†ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/optimizing-traffic-routing-uipath-automation-suite-envoy-wasm/1_hu254ba456d1126507c39ec17036fb0c7b_822098_9d5b3295b99e5cfaeaa750c4603fb78d.webp 400w,
               /blog/optimizing-traffic-routing-uipath-automation-suite-envoy-wasm/1_hu254ba456d1126507c39ec17036fb0c7b_822098_933dcd9e29422007fdd4ef79be804879.webp 760w,
               /blog/optimizing-traffic-routing-uipath-automation-suite-envoy-wasm/1_hu254ba456d1126507c39ec17036fb0c7b_822098_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/optimizing-traffic-routing-uipath-automation-suite-envoy-wasm/1_hu254ba456d1126507c39ec17036fb0c7b_822098_9d5b3295b99e5cfaeaa750c4603fb78d.webp&#34;
               width=&#34;760&#34;
               height=&#34;553&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ä½¿ç”¨ Istio å’Œ Envoy è¿™ä¸ªæµè¡Œçš„ç»„åˆä½œä¸ºè·¯ç”±åŸºç¡€è®¾æ–½ï¼Œè·¯ç”±ä¸šåŠ¡é€»è¾‘é€šè¿‡ Envoy è¿‡æ»¤å™¨å†…çš„ Lua è„šæœ¬å®ç°ã€‚é™¤äº†ä»¥ä¸‹å‡ ä¸ªç—›ç‚¹å¤–ï¼Œæ­¤è§£å†³æ–¹æ¡ˆè¿ä½œè‰¯å¥½ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ— æ³•ç›´æ¥è¿æ¥ Redisï¼š&lt;/strong&gt; æˆ‘ä»¬çš„è·¯ç”±å±‚å¤§é‡ä½¿ç”¨ Redis æ¥ç¼“å­˜å®Œæˆè¯·æ±‚è·¯ç”±æ‰€éœ€çš„ä¸šåŠ¡æ•°æ®ï¼Œä¾‹å¦‚æœåŠ¡å…ƒæ•°æ®å’Œç§Ÿæˆ·åˆ°åç«¯çš„æ˜ å°„ç­‰ã€‚ç„¶è€Œï¼ŒEnvoy è¿‡æ»¤å™¨ä¸æ”¯æŒç›´æ¥è¿æ¥åˆ° Redisã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬è®©è·¯ç”±å±‚é€šè¿‡ä¸€ä¸ªåç«¯æœåŠ¡ï¼ˆä¸Šå›¾ä¸­çš„ Routing Serviceï¼‰æ¥æ£€ç´¢æ‰€éœ€çš„æ•°æ®ï¼Œè¯¥æœåŠ¡ä¸ Redis è¿æ¥ã€‚é—®é¢˜åœ¨äºåœ¨è´Ÿè½½ä¸‹ï¼Œåç«¯ï¼ˆ&lt;a href=&#34;http://xn--3ds.net/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;åœ¨.Net&lt;/a&gt; Core ä¸­ï¼‰ä¼šæ¶ˆè€—ä¸å¿…è¦çš„èµ„æºï¼Œå¹¶å¢åŠ ä¸å¿…è¦çš„å»¶è¿Ÿå¼€é”€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éš¾ä»¥æ‰©å±•ã€æµ‹è¯•å’Œç»´æŠ¤ï¼š&lt;/strong&gt; ä½¿ç”¨ YAML æ–‡ä»¶å†…çš„ Lua è„šæœ¬å­˜åœ¨æ‰©å±•ã€ç»´æŠ¤å’Œæµ‹è¯•æ–¹é¢çš„æŒ‘æˆ˜ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;ç›®æ ‡&#34;&gt;&lt;strong&gt;ç›®æ ‡&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;æˆ‘ä»¬çš„ä¸»è¦ç›®æ ‡æ˜¯æœ€å°åŒ–å®Œæ•´è·¯ç”±å±‚çš„èµ„æºæ¶ˆè€—ï¼Œä»è€Œæå‡æ€§èƒ½å¹¶å¢åŠ å¯æ‰©å±•æ€§ã€‚&lt;/p&gt;
&lt;h3 id=&#34;è§£å†³æ–¹æ¡ˆ&#34;&gt;&lt;strong&gt;è§£å†³æ–¹æ¡ˆ&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;å›¢é˜Ÿå·²ç»è¯„ä¼°äº†å„ç§è§£å†³æ–¹æ¡ˆã€‚ç„¶è€Œï¼Œæ¯ä¸ªè§£å†³æ–¹æ¡ˆéƒ½å­˜åœ¨æ˜æ˜¾çš„ç¼ºç‚¹ï¼Œå› æ­¤æˆ‘ä»¬å†³å®šä¸ç»§ç»­è¿½æ±‚è¿™äº›é€‰é¡¹ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-è¡¨æ ¼æåˆ°äº†ææ¡ˆåŸå› å’Œç¼ºç‚¹&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;è¡¨æ ¼ï¼šæåˆ°äº†ææ¡ˆã€åŸå› å’Œç¼ºç‚¹&#34; srcset=&#34;
               /blog/optimizing-traffic-routing-uipath-automation-suite-envoy-wasm/2_huc896e7a3dd948680a2a44bf4c2941c59_1548891_0bede507dd7b84ce4453ff6d3af3376e.webp 400w,
               /blog/optimizing-traffic-routing-uipath-automation-suite-envoy-wasm/2_huc896e7a3dd948680a2a44bf4c2941c59_1548891_550af16a42a2821a6411e349952732aa.webp 760w,
               /blog/optimizing-traffic-routing-uipath-automation-suite-envoy-wasm/2_huc896e7a3dd948680a2a44bf4c2941c59_1548891_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/optimizing-traffic-routing-uipath-automation-suite-envoy-wasm/2_huc896e7a3dd948680a2a44bf4c2941c59_1548891_0bede507dd7b84ce4453ff6d3af3376e.webp&#34;
               width=&#34;760&#34;
               height=&#34;444&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      è¡¨æ ¼ï¼šæåˆ°äº†ææ¡ˆã€åŸå› å’Œç¼ºç‚¹
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;æœ€ç»ˆï¼Œæˆ‘ä»¬æ„æƒ³äº†åœ¨ Envoy ä¸­ä½¿ç”¨ WebAssemblyï¼ˆWASMï¼‰æ‰©å±•çš„æ¦‚å¿µï¼Œåˆ©ç”¨å…¶å…±äº«æ•°æ®åŠŸèƒ½æ¥å®ç°å†…å­˜ç¼“å­˜ç­–ç•¥ã€‚WASM çš„ä¼˜åŠ¿åœ¨äºä½¿æˆ‘ä»¬èƒ½å¤Ÿçµæ´»é€‰æ‹©ç¼–ç¨‹è¯­è¨€ï¼Œè¿™æœ‰åŠ©äºå¼€å‘å’Œæµ‹è¯•ï¼Œå¹¶ä¿æŒç±»ä¼¼äº Lua çš„æ€§èƒ½ç‰¹å¾ã€‚æ›´é‡è¦çš„æ˜¯ï¼ŒWASM åœ¨ Envoy ä¸­çš„ä½¿ç”¨ï¼ˆ&lt;a href=&#34;https://github.com/proxy-wasm&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;proxy-wasm&lt;/a&gt;ï¼‰å¼•å…¥äº†å¯ä¾›æ¯ä¸ª HTTP æµè®¿é—®çš„å…±äº«æ•°æ®ï¼ˆé”®å€¼å­˜å‚¨ï¼‰ã€‚è¿™ç§èƒ½åŠ›å¯¹äºå†…å­˜ç¼“å­˜ç­–ç•¥è‡³å…³é‡è¦ï¼Œå¯ä»¥æ˜¾è‘—å‡å°‘åç«¯è·¯ç”±æœåŠ¡çš„ CPU ä½¿ç”¨ç‡ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/optimizing-traffic-routing-uipath-automation-suite-envoy-wasm/3_hu3f5fe4fd1ddd84b80dbc484beb684edd_593771_9d3b4fb14c67aeed09f32471d3717df6.webp 400w,
               /blog/optimizing-traffic-routing-uipath-automation-suite-envoy-wasm/3_hu3f5fe4fd1ddd84b80dbc484beb684edd_593771_7c7c063e48692d200f571cc25e287298.webp 760w,
               /blog/optimizing-traffic-routing-uipath-automation-suite-envoy-wasm/3_hu3f5fe4fd1ddd84b80dbc484beb684edd_593771_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/optimizing-traffic-routing-uipath-automation-suite-envoy-wasm/3_hu3f5fe4fd1ddd84b80dbc484beb684edd_593771_9d3b4fb14c67aeed09f32471d3717df6.webp&#34;
               width=&#34;760&#34;
               height=&#34;586&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h3 id=&#34;å®æ–½ç»†èŠ‚&#34;&gt;&lt;strong&gt;å®æ–½ç»†èŠ‚&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;è·¯ç”±å±‚å†…éƒ¨æ²¡æœ‰è¿›è¡Œé‡å¤§çš„æ¶æ„ä¿®æ”¹ã€‚è½¬å˜ä¸»è¦æ¶‰åŠç”¨ WASM æ’ä»¶æ›¿æ¢åŸºäº Lua çš„ Envoy è¿‡æ»¤å™¨ã€‚è€ƒè™‘åˆ°ç¼“å­˜è·¯ç”±æ•°æ®çš„ç‰¹æ€§ï¼Œæˆ‘ä»¬è®¤è¯†åˆ°è¿™äº›æ•°æ®å¾ˆå°‘å‘ç”Ÿæ›´æ”¹ï¼Œè¿‡æ—¶çš„æ•°æ®ä¸ä¼šå¯¹å®¢æˆ·çš„ä¸»è¦å·¥ä½œæµç¨‹äº§ç”Ÿé‡å¤§å½±å“ã€‚å› æ­¤ï¼Œæˆ‘ä»¬é€‰æ‹©ä½¿ç”¨åŸºäºæ—¶é—´çš„ï¼ˆTTLï¼‰è¿‡æœŸæ¥ç®€åŒ–ç¼“å­˜å¤±æ•ˆç­–ç•¥ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/optimizing-traffic-routing-uipath-automation-suite-envoy-wasm/4_hud1a48e525deff2835be62c212317e490_826426_24abf789358125c7edf804ba066a770a.webp 400w,
               /blog/optimizing-traffic-routing-uipath-automation-suite-envoy-wasm/4_hud1a48e525deff2835be62c212317e490_826426_7322f6987a5452cc3a5c02b6c33ecba4.webp 760w,
               /blog/optimizing-traffic-routing-uipath-automation-suite-envoy-wasm/4_hud1a48e525deff2835be62c212317e490_826426_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/optimizing-traffic-routing-uipath-automation-suite-envoy-wasm/4_hud1a48e525deff2835be62c212317e490_826426_24abf789358125c7edf804ba066a770a.webp&#34;
               width=&#34;760&#34;
               height=&#34;453&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;WASM æ’ä»¶é¦–å…ˆä»å†…å­˜ç¼“å­˜ä¸­æŸ¥è¯¢è·¯ç”±æ•°æ®ã€‚å¦‚æœå‘ç”Ÿç¼“å­˜å‘½ä¸­ï¼Œåˆ™æ’ä»¶ä¼šç›¸åº”åœ°ä¿®æ”¹åŸå§‹è¯·æ±‚çš„è·¯å¾„å’Œæ ‡å¤´ï¼Œä»¥å°†å…¶è·¯ç”±åˆ°åç«¯æœåŠ¡ã€‚å¦‚æœå‘ç”Ÿç¼“å­˜æœªå‘½ä¸­ï¼Œåˆ™å®ƒä¼šä»è·¯ç”±æœåŠ¡ä¸­æŸ¥è¯¢è·¯ç”±æ•°æ®ï¼Œå°†è·¯ç”±æ•°æ®åŠ è½½åˆ°ç¼“å­˜ä¸­ï¼Œå¹¶æœ€ç»ˆä¿®æ”¹åŸå§‹è¯·æ±‚è¿›è¡Œè·¯ç”±ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ç»“æœ&#34;&gt;&lt;strong&gt;ç»“æœ&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;é€šè¿‡ä¸ proxy-WASM ç¤¾åŒºçš„åˆä½œåŠªåŠ›ï¼Œæˆ‘ä»¬å·²æˆåŠŸè§£å†³äº† TinyGo çš„åƒåœ¾å›æ”¶å¼•èµ·çš„å†…å­˜æ³„æ¼é—®é¢˜ã€‚è¿™äº›æ”¹è¿›å·²ç»çº³å…¥æœ€æ–°å‘å¸ƒç‰ˆä¸­ã€‚&lt;/p&gt;
&lt;h3 id=&#34;èµ„æºåˆ©ç”¨ç‡æ”¹å–„&#34;&gt;&lt;strong&gt;èµ„æºåˆ©ç”¨ç‡æ”¹å–„&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯æ¶µç›– 100K &lt;a href=&#34;https://www.uipath.com/product/robots&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;UiPath æœºå™¨äºº&lt;/a&gt;çš„ç¯å¢ƒä¸­çš„èµ„æºåˆ©ç”¨ç‡æ•°æ®ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/optimizing-traffic-routing-uipath-automation-suite-envoy-wasm/5_hu6cad75802f3240dd00c8a4d45721ed49_374207_ad219b7f30ed479263106b4c6c65194e.webp 400w,
               /blog/optimizing-traffic-routing-uipath-automation-suite-envoy-wasm/5_hu6cad75802f3240dd00c8a4d45721ed49_374207_1806a1bbda3207712eea615d44b1efa5.webp 760w,
               /blog/optimizing-traffic-routing-uipath-automation-suite-envoy-wasm/5_hu6cad75802f3240dd00c8a4d45721ed49_374207_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/optimizing-traffic-routing-uipath-automation-suite-envoy-wasm/5_hu6cad75802f3240dd00c8a4d45721ed49_374207_ad219b7f30ed479263106b4c6c65194e.webp&#34;
               width=&#34;760&#34;
               height=&#34;139&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;åœ¨è·¯ç”±æœåŠ¡ä¸­ï¼ŒCPU ä½¿ç”¨ç‡æ˜æ˜¾ä¸‹é™ï¼ŒIstio å…¥å£ç½‘å…³æ§åˆ¶å™¨çš„ CPU ä½¿ç”¨ç‡ç•¥å¾®é™ä½ã€‚è¿™ç§æƒè¡¡ä¼´éšç€ Istio å…¥å£ç½‘å…³æ§åˆ¶å™¨å†…å­˜æ¶ˆè€—çš„å¢åŠ ã€‚ç„¶è€Œï¼Œè¿™ç§ä¸Šå‡æ˜¯å¯ä»¥é¢„æ–™çš„ï¼Œå¹¶ä¸”åœ¨è€ƒè™‘ CPU èµ„æºçš„æƒ…å†µä¸‹ä»ç„¶å…·æœ‰æˆæœ¬æ•ˆç›Šã€‚&lt;/p&gt;
&lt;h3 id=&#34;å¯æµ‹è¯•æ€§æ”¹è¿›&#34;&gt;&lt;strong&gt;å¯æµ‹è¯•æ€§æ”¹è¿›&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;ä»¥å‰ï¼Œæˆ‘ä»¬çš„æµ‹è¯•è¦†ç›–èŒƒå›´ä»…é™äº Lua ä¸­çš„è¾…åŠ©å‡½æ•°ï¼Œå› ä¸ºåœ¨ Envoy è¿‡æ»¤å™¨çš„ YAML ä¸­æµ‹è¯• Lua è„šæœ¬æ˜¯ä¸å¯è¡Œçš„ã€‚ç„¶è€Œï¼Œç”±äº&lt;a href=&#34;https://github.com/tetratelabs/proxy-wasm-go-sdk&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;proxy-wasm-go-sdk&lt;/a&gt;æä¾›çš„&lt;a href=&#34;https://github.com/tetratelabs/proxy-wasm-go-sdk/tree/main/proxywasm/proxytest&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;proxytest&lt;/a&gt;æ¡†æ¶ï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥åˆ©ç”¨ Envoy ä¸»æœºæ¨¡æ‹Ÿå™¨å®ç°å…¨é¢çš„å•å…ƒæµ‹è¯•è¦†ç›–ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å»¶è¿Ÿ&#34;&gt;&lt;strong&gt;å»¶è¿Ÿ&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;åœ¨è¿›è¡Œæ€§èƒ½æµ‹è¯•åï¼Œæˆ‘ä»¬è§‚å¯Ÿåˆ°æ¯ä¸ªè¯·æ±‚çš„å»¶è¿Ÿä¿æŒä¸€è‡´ä¸”ä¸å˜ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä¸‹ä¸€æ­¥è®¡åˆ’&#34;&gt;&lt;strong&gt;ä¸‹ä¸€æ­¥è®¡åˆ’&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;å±•æœ›æœªæ¥ï¼Œæˆ‘ä»¬çš„ç›®æ ‡æ˜¯é€šè¿‡ä½¿ç”¨ WASM åœ¨&lt;a href=&#34;https://www.uipath.com/product/automation-suite&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;UiPath Automation Suite&lt;/a&gt;å’Œ&lt;a href=&#34;https://www.uipath.com/product/automation-cloud&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;UiPath Automation Cloud&lt;/a&gt;ä¹‹é—´å»ºç«‹ç»Ÿä¸€çš„è·¯ç”±å±‚ã€‚è¿™ç§æˆ˜ç•¥æ–¹æ³•æ—¨åœ¨æå‡æ€§èƒ½ï¼Œå¹¶é€šè¿‡æ¶ˆé™¤ç»´æŠ¤ä¸¤å¥—ç‹¬ç«‹è§£å†³æ–¹æ¡ˆå’Œä»£ç çš„éœ€æ±‚ï¼Œå‡è½»å·¥ç¨‹å¸ˆçš„è´Ÿæ‹…ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬æ‰“ç®—å®æ–½ä¸»åŠ¨çš„ç¼“å­˜å¤±æ•ˆæœºåˆ¶ï¼Œä»¥è§£å†³ç‰¹å®šè¾¹ç¼˜æƒ…å†µä¸­çš„è„æ•°æ®æŒ‘æˆ˜ã€‚è¿™ç§ä¸»åŠ¨çš„æ–¹æ³•æ—¨åœ¨æå‡ç”¨æˆ·ä½“éªŒå¹¶æä¾›æ›´æµç•…çš„äº¤äº’ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>WebAssemblyï¼šæ— éœ€å®¹å™¨å°±èƒ½è¿è¡Œ Dockerï¼</title>
      <link>https://lib.jimmysong.io/blog/docker-without-containers/</link>
      <pubDate>Thu, 27 Apr 2023 06:27:22 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/docker-without-containers/</guid>
      <description>&lt;p&gt;æœ€è¿‘ï¼ŒDocker å®£å¸ƒä¸ WasmEdge åˆä½œï¼Œåœ¨ Docker ç”Ÿæ€ç³»ç»Ÿä¸­æ”¯æŒ &lt;a href=&#34;https://docs.docker.com/desktop/wasm/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;WebAssembly&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡å°†ä»‹ç»ä»€ä¹ˆæ˜¯ WebAssemblyï¼Œä»¥åŠä¸ºä»€ä¹ˆå®ƒä¸ Docker ç”Ÿæ€ç³»ç»Ÿç›¸å…³ï¼Œå¹¶æä¾›ä¸€äº›å®è·µç¤ºä¾‹ã€‚æˆ‘ä»¬å‡è®¾æ‚¨ç†Ÿæ‚‰ Docker å·¥å…·é›†ã€‚æˆ‘ä»¬å°†ä½¿ç”¨æˆ‘ä»¬çš„ &lt;a href=&#34;https://wasmlabs.dev/articles/php-wasm32-wasi-port/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;WebAssembly PHP çš„ç«¯å£&lt;/a&gt; æ¥æ¼”ç¤ºå¦‚ä½•æ„å»º PHP è§£é‡Šå™¨ï¼Œå°†å…¶æ‰“åŒ…ä¸º OCI é•œåƒçš„ä¸€éƒ¨åˆ†ï¼Œå¹¶ä½¿ç”¨ Docker è¿è¡Œå®ƒã€‚&lt;/p&gt;
&lt;p&gt;è¯·æ³¨æ„ï¼Œæœ¬æ–‡çš„é‡ç‚¹æ˜¯è·å¾—å®è·µç»éªŒï¼Œè€Œä¸æ˜¯è®¨è®ºæŠ€æœ¯ç»†èŠ‚ã€‚æ‚¨å¯ä»¥å¤åˆ¶ä»¥ä¸‹ç¤ºä¾‹ï¼Œä¹Ÿå¯ä»¥åªè¯»åˆ°æœ€åï¼Œå› ä¸ºæˆ‘ä»¬è¿˜å°†æä¾›è¾“å‡ºã€‚&lt;/p&gt;
&lt;h2 id=&#34;webassembly---ä»€ä¹ˆä¸ºä»€ä¹ˆ&#34;&gt;WebAssembly - ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ&lt;/h2&gt;
&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªéå¸¸åŸºæœ¬çš„ä»‹ç»ã€‚å¦‚æœæ‚¨å·²ç»ç†Ÿæ‚‰è¯¥æŠ€æœ¯ï¼Œåˆ™å¯ä»¥è·³åˆ°åŠ¨æ‰‹ç¯èŠ‚ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä»€ä¹ˆæ˜¯-webassembly&#34;&gt;ä»€ä¹ˆæ˜¯ WebAssemblyï¼Ÿ&lt;/h3&gt;
&lt;p&gt;WebAssemblyï¼ˆæˆ– Wasmï¼‰æ˜¯ä¸€ä¸ªå¼€æ”¾æ ‡å‡†ï¼Œå®šä¹‰äº†ä¸€ç§äºŒè¿›åˆ¶æŒ‡ä»¤æ ¼å¼ï¼Œå¯ä»¥ä»ä¸åŒçš„æºè¯­è¨€åˆ›å»ºå¯ç§»æ¤çš„äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/docker-without-containers/1_hu9f2ff678deb0c6bb75e5edef2989001d_8504_7443fbab0b1c3dbf6b3518459e639ea5.webp 400w,
               /blog/docker-without-containers/1_hu9f2ff678deb0c6bb75e5edef2989001d_8504_c3ad77e21a39ed3c4d0c4f35d6a627f0.webp 760w,
               /blog/docker-without-containers/1_hu9f2ff678deb0c6bb75e5edef2989001d_8504_1200x1200_fit_q75_h2_lanczos_2.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/docker-without-containers/1_hu9f2ff678deb0c6bb75e5edef2989001d_8504_7443fbab0b1c3dbf6b3518459e639ea5.webp&#34;
               width=&#34;757&#34;
               height=&#34;181&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;è¿™äº›äºŒè¿›åˆ¶æ–‡ä»¶å¯ä»¥åœ¨å„ç§ç¯å¢ƒä¸­è¿è¡Œã€‚å®ƒèµ·æºäº webï¼Œå¹¶å¾—åˆ°æ‰€æœ‰ä¸»è¦æµè§ˆå™¨çš„æ”¯æŒã€‚&lt;/p&gt;
&lt;h3 id=&#34;wasm-åœ¨æµè§ˆå™¨ä¸­æ˜¯å¦‚ä½•å·¥ä½œçš„&#34;&gt;Wasm åœ¨æµè§ˆå™¨ä¸­æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ&lt;/h3&gt;
&lt;p&gt;æµè§ˆå™¨å¼•æ“é›†æˆäº†ä¸€ä¸ª Wasm è™šæ‹Ÿæœºï¼Œé€šå¸¸ç§°ä¸º Wasm è¿è¡Œæ—¶ï¼Œå®ƒå¯ä»¥è¿è¡Œ Wasm äºŒè¿›åˆ¶æŒ‡ä»¤ã€‚æœ‰ç¼–è¯‘å™¨å·¥å…·é“¾ï¼ˆå¦‚ Emscriptenï¼‰å¯ä»¥å°†æºä»£ç ç¼–è¯‘ä¸º Wasm ç›®æ ‡ã€‚è¿™å…è®¸å°†ä¼ ç»Ÿåº”ç”¨ç¨‹åºç§»æ¤åˆ°æµè§ˆå™¨ï¼Œå¹¶ç›´æ¥ä¸åœ¨å®¢æˆ·ç«¯ Web åº”ç”¨ç¨‹åºä¸­è¿è¡Œçš„ JS ä»£ç é€šä¿¡ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/docker-without-containers/2_hufcd9523e703b2890ed50bf80e0b5cf14_11104_f73936d5271f85b379a4f681382ec832.webp 400w,
               /blog/docker-without-containers/2_hufcd9523e703b2890ed50bf80e0b5cf14_11104_d1465a0108af12ea500f4705188478a2.webp 760w,
               /blog/docker-without-containers/2_hufcd9523e703b2890ed50bf80e0b5cf14_11104_1200x1200_fit_q75_h2_lanczos_2.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/docker-without-containers/2_hufcd9523e703b2890ed50bf80e0b5cf14_11104_f73936d5271f85b379a4f681382ec832.webp&#34;
               width=&#34;757&#34;
               height=&#34;312&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;è¿™äº›æŠ€æœ¯ä½¿ä¼ ç»Ÿæ¡Œé¢åº”ç”¨ç¨‹åºå¯ä»¥åœ¨æµè§ˆå™¨ä¸­è¿è¡Œã€‚ç°åœ¨å®ƒä»¬å¯ä»¥åœ¨ä»»ä½•æ‚¨æ‹¥æœ‰æµè§ˆå™¨çš„è®¾å¤‡ä¸Šè¿è¡Œã€‚ä¸€äº›è‘—åçš„ä¾‹å­æ˜¯ &lt;a href=&#34;https://earth.google.com/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Google Earth&lt;/a&gt; å’Œè®¡ç®—æœºè§†è§‰çš„ &lt;a href=&#34;https://opencv.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Open CV&lt;/a&gt; åº“ã€‚&lt;/p&gt;
&lt;h3 id=&#34;wasm-åœ¨æœåŠ¡å™¨ä¸Šæ˜¯å¦‚ä½•å·¥ä½œçš„&#34;&gt;Wasm åœ¨æœåŠ¡å™¨ä¸Šæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ&lt;/h3&gt;
&lt;p&gt;æœ‰ä¸€äº› Wasm è¿è¡Œæ—¶å¯ä»¥åœ¨æµè§ˆå™¨ä¹‹å¤–è¿è¡Œï¼ŒåŒ…æ‹¬ä¼ ç»Ÿæ“ä½œç³»ç»Ÿï¼Œå¦‚ Linuxã€Windows å’Œ macOSã€‚ç”±äºå®ƒä»¬ä¸èƒ½ä¾èµ–äº JavaScript å¼•æ“çš„å¯ç”¨æ€§ï¼Œå®ƒä»¬ä½¿ç”¨ä¸åŒçš„æ¥å£ï¼ˆä¾‹å¦‚ WASIï¼Œ&lt;a href=&#34;https://wasi.dev/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;WebAssembly ç³»ç»Ÿæ¥å£&lt;/a&gt;ï¼‰ä¸å¤–ç•Œé€šä¿¡ã€‚è¿™äº›è¿è¡Œæ—¶å…è®¸ Wasm åº”ç”¨ç¨‹åºä»¥ä¸ POSIX ç±»ä¼¼ï¼ˆä½†ä¸å®Œå…¨ç›¸åŒï¼‰çš„æ–¹å¼ä¸å…¶ä¸»æœºç³»ç»Ÿäº¤äº’ã€‚åƒ WASI SDK å’Œ wasi-libc è¿™æ ·çš„é¡¹ç›®å¯ä»¥å¸®åŠ©äººä»¬å°†ç°æœ‰çš„ POSIX å…¼å®¹åº”ç”¨ç¨‹åºç¼–è¯‘åˆ° WebAssemblyã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/docker-without-containers/3_hub847a4647ba520c473fa897afead2bca_12792_ef9be3b0ec16df39f23f570fb99a9496.webp 400w,
               /blog/docker-without-containers/3_hub847a4647ba520c473fa897afead2bca_12792_15f421a0d3b29d92aecd27d31b86635c.webp 760w,
               /blog/docker-without-containers/3_hub847a4647ba520c473fa897afead2bca_12792_1200x1200_fit_q75_h2_lanczos_2.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/docker-without-containers/3_hub847a4647ba520c473fa897afead2bca_12792_ef9be3b0ec16df39f23f570fb99a9496.webp&#34;
               width=&#34;757&#34;
               height=&#34;306&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;æ‚¨åªéœ€è¦å°†åº”ç”¨ç¨‹åºç¼–è¯‘ä¸º Wasm æ¨¡å—ä¸€æ¬¡ï¼Œç„¶åå°±å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹è¿è¡Œå®Œå…¨ç›¸åŒçš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä»€ä¹ˆä½¿-wasm-å¦‚æ­¤å‡ºè‰²&#34;&gt;ä»€ä¹ˆä½¿ Wasm å¦‚æ­¤å‡ºè‰²ï¼Ÿ&lt;/h3&gt;
&lt;p&gt;ä¸€äº›ä½¿ Wasm åœ¨æµè§ˆå™¨ä¸­å‡ºè‰²çš„åŠŸèƒ½ä¹Ÿä½¿å…¶å¯¹æœåŠ¡å™¨ç«¯å¼€å‘éå¸¸æœ‰å¸å¼•åŠ›ï¼š&lt;/p&gt;
&lt;p&gt;ğŸŒ å¼€æ”¾ - å®ƒæ˜¯è¡Œä¸šå¹¿æ³›é‡‡ç”¨çš„æ ‡å‡†ã€‚ä¸è¿‡å»çš„æµè§ˆå™¨ä¹‹äº‰ä¸åŒï¼Œä¸»è¦å…¬å¸æ­£åœ¨åä½œæ ‡å‡†åŒ– WASI å’Œ WebAssembly åº”ç”¨ç¨‹åºã€‚&lt;/p&gt;
&lt;p&gt;ğŸš€ å¿«é€Ÿ - å®ƒå¯ä»¥é€šè¿‡å¤§å¤šæ•°è¿è¡Œæ—¶çš„ JIT/AOT èƒ½åŠ›æä¾›ç±»ä¼¼æœ¬æœºçš„é€Ÿåº¦ã€‚ä¸åƒå¯åŠ¨ VM æˆ–å¯åŠ¨å®¹å™¨é‚£æ ·æœ‰å†·å¯åŠ¨ã€‚&lt;/p&gt;
&lt;p&gt;ğŸ”’ å®‰å…¨ - Wasm è¿è¡Œæ—¶é»˜è®¤æƒ…å†µä¸‹æ˜¯éš”ç¦»çš„ï¼Œå¹¶å…è®¸å®‰å…¨åœ°è®¿é—®å†…å­˜ã€‚åŸºäºèƒ½åŠ›çš„æ¨¡å‹ç¡®ä¿ Wasm åº”ç”¨ç¨‹åºä»…èƒ½è®¿é—®å…¶æ˜ç¡®å…è®¸çš„å†…å®¹ã€‚å®‰å…¨çš„ä¾›åº”é“¾ã€‚&lt;/p&gt;
&lt;p&gt;ğŸ’¼ å¯ç§»æ¤ - åœ¨å‡ ä¸ªä¸»è¦è¿è¡Œæ—¶ä¸­ï¼Œæ”¯æŒå¤§å¤šæ•° CPUï¼ˆx86ã€ARMã€RISC-Vï¼‰å’Œå¤§å¤šæ•°æ“ä½œç³»ç»Ÿï¼ŒåŒ…æ‹¬ Linuxã€Windowsã€macOSã€Androidã€ESXiï¼Œç”šè‡³é POSIX çš„æ“ä½œç³»ç»Ÿã€‚&lt;/p&gt;
&lt;p&gt;ğŸ”‹ é«˜æ•ˆ - Wasm åº”ç”¨ç¨‹åºå¯ä»¥é€šè¿‡æœ€å°çš„å†…å­˜å ç”¨å’Œ CPU è¦æ±‚è¿è¡Œã€‚&lt;/p&gt;
&lt;p&gt;ğŸ—£ï¸ å¤šè¯­è¨€æ”¯æŒ - 40 å¤šç§è¯­è¨€å¯ä»¥ç¼–è¯‘ä¸º Wasmï¼Œå¹¶å…·æœ‰ç°ä»£çš„ã€ä¸æ–­æ”¹è¿›çš„å·¥å…·é“¾ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æœåŠ¡å™¨å¹³å°æ¼”è¿›çš„ä¸‹ä¸€æ­¥&#34;&gt;æœåŠ¡å™¨å¹³å°æ¼”è¿›çš„ä¸‹ä¸€æ­¥ï¼Ÿ&lt;/h3&gt;
&lt;p&gt;æ‚¨å¯èƒ½å·²ç»çœ‹åˆ°è¿‡ Docker çš„å…±åŒåˆ›å§‹äººä¹‹ä¸€ Solomon Hykes çš„è¿™æ®µ &lt;a href=&#34;https://twitter.com/solomonstre/status/1111004913222324225&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¼•è¿°&lt;/a&gt;ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å¦‚æœ WASM+WASI åœ¨ 2008 å¹´å­˜åœ¨ï¼Œæˆ‘ä»¬å°±ä¸éœ€è¦åˆ›å»º Docker äº†ã€‚è¿™å°±æ˜¯å®ƒçš„é‡è¦æ€§ã€‚WebAssembly åœ¨æœåŠ¡å™¨ä¸Šæ˜¯è®¡ç®—çš„æœªæ¥ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç¡®å®ï¼ŒWASM+WASI ä¼¼ä¹æ˜¯æœåŠ¡å™¨ç«¯è½¯ä»¶åŸºç¡€æ¶æ„æ¼”è¿›çš„ä¸‹ä¸€æ­¥ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åœ¨è¿‡å»ï¼Œæˆ‘ä»¬æœ‰ç‰©ç†ç¡¬ä»¶å¯ç”¨ã€‚æˆ‘ä»¬ä¼šåœ¨æ¯ä¸ªç›’å­ä¸Šä»”ç»†å®‰è£…æ“ä½œç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºï¼Œå¹¶é€ä¸ªç»´æŠ¤å®ƒä»¬ã€‚&lt;/li&gt;
&lt;li&gt;ç„¶åï¼Œéšç€ç”± VMware å¼€åˆ›çš„ VM çš„é‡‡ç”¨ï¼Œäº‹æƒ…å˜å¾—æ›´å®¹æ˜“äº†ã€‚äººä»¬å¯ä»¥å¤åˆ¶ã€å…‹éš†å’Œç§»åŠ¨ VM è·¨ç¡¬ä»¶ç›’ã€‚ä½†è¿™ä»ç„¶éœ€è¦åœ¨ VM ä¸­å®‰è£…æ“ä½œç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºã€‚&lt;/li&gt;
&lt;li&gt;ç„¶åï¼Œå®¹å™¨å‡ºç°äº†ï¼Œç”± Docker æ¨å¹¿ï¼Œå®ƒä½¿å¾—åœ¨æç®€çš„åŒ…è£…ä¸Šä¸‹æ–‡ä¸­è¿è¡Œåº”ç”¨ç¨‹åºé…ç½®å˜å¾—æ›´åŠ å®¹æ˜“ï¼Œè€Œä¸ä¼šå½±å“ä¸»æœºæ“ä½œç³»ç»Ÿä¸Šçš„ä»»ä½•å…¶ä»–åº”ç”¨ç¨‹åºã€‚ç„¶è€Œï¼Œè¿™ä»ç„¶éœ€è¦åˆ†å‘åº”ç”¨ç¨‹åºä¸å…¶è¿è¡Œæ—¶å’Œå¿…è¦çš„åº“æ†ç»‘åœ¨ä¸€èµ·ã€‚å®‰å…¨è¾¹ç•Œç”± Linux å†…æ ¸æä¾›ã€‚&lt;/li&gt;
&lt;li&gt;æˆ‘ä»¬ç°åœ¨æœ‰äº† WebAssemblyã€‚å®ƒçš„æŠ€æœ¯ç‰¹ç‚¹å’Œå¯ç§»æ¤æ€§ä½¿å¾—åˆ†å‘åº”ç”¨ç¨‹åºå˜å¾—å¯èƒ½ï¼Œæ— éœ€è¿è¾“ OS çº§åˆ«çš„ä¾èµ–é¡¹ï¼Œå¹¶ä¸”å¯ä»¥åœ¨ä¸¥æ ¼çš„å®‰å…¨çº¦æŸä¸‹è¿è¡Œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è€ƒè™‘åˆ°æ‰€æœ‰è¿™äº›ï¼Œå¼€å‘äººå‘˜é€šå¸¸ä¼šå°† WebAssembly è§†ä¸ºå®¹å™¨çš„â€œç»§æ‰¿è€…â€å’ŒåŸºç¡€æ¶æ„éƒ¨ç½²çš„ä¸‹ä¸€ä¸ªé€»è¾‘æ­¥éª¤ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/docker-without-containers/4_hu9788ea4c0c901b7b2eb7d58fbe5dad83_10584_f43c822b68d570a7b5779e3c139e0dae.webp 400w,
               /blog/docker-without-containers/4_hu9788ea4c0c901b7b2eb7d58fbe5dad83_10584_4b074fec995ab7c24c2c089476791611.webp 760w,
               /blog/docker-without-containers/4_hu9788ea4c0c901b7b2eb7d58fbe5dad83_10584_1200x1200_fit_q75_h2_lanczos_2.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/docker-without-containers/4_hu9788ea4c0c901b7b2eb7d58fbe5dad83_10584_f43c822b68d570a7b5779e3c139e0dae.webp&#34;
               width=&#34;757&#34;
               height=&#34;212&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;ç„¶è€Œï¼Œå¦ä¸€ç§çœ‹å¾… WebAssembly çš„æ–¹å¼æ˜¯ä½œä¸º Docker å·¥å…·é“¾çš„æ›¿ä»£â€œåç«¯â€ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ç›¸åŒçš„å‘½ä»¤è¡Œå·¥å…·å’Œå·¥ä½œæµç¨‹ï¼Œä½†æ˜¯ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ Linux å®¹å™¨ï¼Œå®ƒæ˜¯ä½¿ç”¨åŸºäº WebAssembly çš„å®¹å™¨ç­‰ä»·ç‰©å®ç°çš„ã€‚æœ¬æ–‡çš„å…¶ä½™éƒ¨åˆ†æ¢è®¨äº†è¿™ä¸ªæ¦‚å¿µï¼Œè¿™å°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„â€œæ²¡æœ‰å®¹å™¨çš„ Dockerâ€æ ‡é¢˜ã€‚&lt;/p&gt;
&lt;h3 id=&#34;wasm-å¦‚ä½•ä¸-docker-é…åˆä½¿ç”¨&#34;&gt;Wasm å¦‚ä½•ä¸ Docker é…åˆä½¿ç”¨ï¼Ÿ&lt;/h3&gt;
&lt;p&gt;Docker Desktop ç°åœ¨åŒ…æ‹¬å¯¹ WebAssembly çš„æ”¯æŒã€‚å®ƒæ˜¯ä½¿ç”¨ä¸€ä¸ªç§°ä¸º &lt;a href=&#34;https://github.com/WasmEdge/Wasmedge&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;WasmEdge&lt;/a&gt; çš„ Wasm è¿è¡Œæ—¶è¿è¡Œ Wasm åº”ç”¨ç¨‹åºçš„ containerd shim å®ç°çš„ã€‚è¿™æ„å‘³ç€ï¼Œä¸è¿è¡Œå®¹å™¨é•œåƒä¸­çš„äºŒè¿›åˆ¶æ–‡ä»¶çš„å•ç‹¬è¿›ç¨‹ä¸åŒï¼Œæ‚¨ç°åœ¨å¯ä»¥åœ¨ WasmEdge è¿è¡Œæ—¶ä¸­è¿è¡Œ Wasm åº”ç”¨ç¨‹åºï¼Œæ¨¡æ‹Ÿå®¹å™¨ã€‚&lt;/p&gt;
&lt;p&gt;å› æ­¤ï¼Œå®¹å™¨é•œåƒä¸éœ€è¦åŒ…å«æ­£åœ¨è¿è¡Œçš„åº”ç”¨ç¨‹åºçš„ OS æˆ–è¿è¡Œæ—¶ä¸Šä¸‹æ–‡â€”â€”å•ä¸ª Wasm äºŒè¿›åˆ¶æ–‡ä»¶å°±è¶³å¤Ÿäº†ã€‚&lt;/p&gt;
&lt;p&gt;è¿™åœ¨ Docker çš„ &lt;a href=&#34;https://www.docker.com/blog/docker-wasm-technical-preview/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Wasm æŠ€æœ¯é¢„è§ˆæ–‡ç« &lt;/a&gt; ä¸­æœ‰è¯¦ç»†è¯´æ˜ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä»€ä¹ˆæ˜¯-wasmedge&#34;&gt;ä»€ä¹ˆæ˜¯ WasmEdgeï¼Ÿ&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/WasmEdge/Wasmedge&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;WasmEdge&lt;/a&gt; æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„ WebAssembly è¿è¡Œæ—¶ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ˜¯å¼€æºçš„ï¼Œæ˜¯ &lt;a href=&#34;https://cncf.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;CNCF&lt;/a&gt; çš„ä¸€éƒ¨åˆ†ã€‚&lt;/li&gt;
&lt;li&gt;æ”¯æŒæ‰€æœ‰ä¸»è¦çš„ CPU æ¶æ„ï¼ˆx86ã€ARMã€RISC-Vï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;æ”¯æŒæ‰€æœ‰ä¸»è¦çš„æ“ä½œç³»ç»Ÿï¼ˆLinuxã€Windowsã€macOSï¼‰ï¼Œä»¥åŠå…¶ä»–æ“ä½œç³»ç»Ÿï¼Œå¦‚ seL4 RTOSã€Androidã€‚&lt;/li&gt;
&lt;li&gt;ä¸ºäº‘åŸç”Ÿå’Œ Edge åº”ç”¨ç¨‹åºè¿›è¡Œäº†ä¼˜åŒ–ã€‚&lt;/li&gt;
&lt;li&gt;æ˜¯å¯æ‰©å±•çš„ï¼Œæ”¯æŒæ ‡å‡†å’Œæ–°å…´æŠ€æœ¯
&lt;ul&gt;
&lt;li&gt;ä¸ Tensorflowã€OpenVINOã€PyTorch ä¸€èµ·è¿›è¡Œ AI æ¨ç†&lt;/li&gt;
&lt;li&gt;æ”¯æŒä½¿ç”¨ Tokio è¿›è¡Œå¼‚æ­¥ç½‘ç»œã€‚æ”¯æŒå¾®æœåŠ¡ã€æ•°æ®åº“å®¢æˆ·ç«¯ã€æ¶ˆæ¯é˜Ÿåˆ—ç­‰ã€‚&lt;/li&gt;
&lt;li&gt;ä¸å®¹å™¨ç”Ÿæ€ç³»ç»Ÿã€Docker å’Œ Kubernetes å®Œç¾é›†æˆï¼ˆæ­£å¦‚æœ¬æ–‡æ‰€ç¤ºï¼ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;è§£é‡Šæ€§è¯­è¨€å‘¢&#34;&gt;è§£é‡Šæ€§è¯­è¨€å‘¢ï¼Ÿ&lt;/h3&gt;
&lt;p&gt;åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬åªæåˆ°äº†ç¼–è¯‘è¯­è¨€ï¼ˆå¦‚ C å’Œ Rustï¼‰å¯ä»¥é’ˆå¯¹ WebAssemblyã€‚å¯¹äºè§£é‡Šæ€§è¯­è¨€ï¼ˆå¦‚ Pythonã€Ruby å’Œ PHPï¼‰ï¼Œæ–¹æ³•æ˜¯ä¸åŒçš„ï¼šå®ƒä»¬çš„è§£é‡Šå™¨æ˜¯ç”¨ C ç¼–å†™çš„ï¼Œå¯ä»¥ç¼–è¯‘ä¸º WebAssemblyã€‚ç„¶åï¼Œè¿™ä¸ªè§£é‡Šå™¨ç¼–è¯‘ä¸º Wasmï¼Œå¯ä»¥ç”¨äºæ‰§è¡Œæºä»£ç æ–‡ä»¶ï¼Œé€šå¸¸ä»¥ .pyã€.rbã€.php ç­‰ç»“å°¾ã€‚ä¸€æ—¦ç¼–è¯‘ä¸º Wasmï¼Œä»»ä½•å…·æœ‰ Wasm è¿è¡Œæ—¶çš„å¹³å°éƒ½å°†èƒ½å¤Ÿè¿è¡Œé‚£äº›è§£é‡Šæ€§è¯­è¨€ï¼Œå³ä½¿å®é™…çš„è§£é‡Šå™¨ä»æœªåŸç”Ÿåœ°ç¼–è¯‘ä¸ºè¯¥å¹³å°ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/docker-without-containers/5_hu5a9157eb590a188a516bf31fcc5f6574_17576_7f5852950c743a00a2c16df966ee1ae5.webp 400w,
               /blog/docker-without-containers/5_hu5a9157eb590a188a516bf31fcc5f6574_17576_e9524f19de783d7048ab3fdd930fe98c.webp 760w,
               /blog/docker-without-containers/5_hu5a9157eb590a188a516bf31fcc5f6574_17576_1200x1200_fit_q75_h2_lanczos_2.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/docker-without-containers/5_hu5a9157eb590a188a516bf31fcc5f6574_17576_7f5852950c743a00a2c16df966ee1ae5.webp&#34;
               width=&#34;757&#34;
               height=&#34;332&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h2 id=&#34;å®é™…æ¼”ç¤º&#34;&gt;å®é™…æ¼”ç¤º&lt;/h2&gt;
&lt;p&gt;è®©æˆ‘ä»¬å¼€å§‹å§ï¼åœ¨å®é™…æ¼”ç¤ºä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ç¼–è¯‘ä¸º Wasm çš„ PHP è§£é‡Šå™¨ã€‚æˆ‘ä»¬å°†ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ„å»ºä¸€ä¸ª &lt;a href=&#34;https://wasmlabs.dev/articles/docker-without-containers/#building-a-wasm-container&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Wasm å®¹å™¨&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æ¯”è¾ƒ &lt;a href=&#34;https://wasmlabs.dev/articles/docker-without-containers/#native-vs-wasm&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Wasm å’Œæœ¬åœ°&lt;/a&gt; äºŒè¿›åˆ¶æ–‡ä»¶ã€‚&lt;/li&gt;
&lt;li&gt;æ¯”è¾ƒ &lt;a href=&#34;https://wasmlabs.dev/articles/docker-without-containers/#traditional-vs-wasm-containers&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä¼ ç»Ÿå’Œ Wasm&lt;/a&gt; å®¹å™¨ã€‚&lt;/li&gt;
&lt;li&gt;å±•ç¤ºäº† &lt;a href=&#34;https://wasmlabs.dev/articles/docker-without-containers/#wasm-portability&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Wasm çš„å¯ç§»æ¤æ€§&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;å…ˆå†³æ¡ä»¶&#34;&gt;å…ˆå†³æ¡ä»¶&lt;/h2&gt;
&lt;p&gt;å¦‚æœæ‚¨æƒ³åœ¨æœ¬åœ°å¤åˆ¶æ¼”ç¤ºï¼Œæ‚¨éœ€è¦å‡†å¤‡ä¸€äº›æˆ–å…¨éƒ¨ä»¥ä¸‹å†…å®¹çš„ç¯å¢ƒï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;WASI SDK - ä»æ—§ C ä»£ç æ„å»º WebAssembly åº”ç”¨ç¨‹åº&lt;/li&gt;
&lt;li&gt;PHP - ä¸ºäº†è¿›è¡Œæœ¬åœ° PHP äºŒè¿›åˆ¶æ–‡ä»¶æ¯”è¾ƒ&lt;/li&gt;
&lt;li&gt;WasmEdge è¿è¡Œæ—¶ - è¿è¡Œ WebAssembly åº”ç”¨ç¨‹åº&lt;/li&gt;
&lt;li&gt;Docker Desktop + Wasmï¼ˆåœ¨æ’°å†™æœ¬æ–‡æ—¶ï¼Œå¯åœ¨ &lt;a href=&#34;https://docs.docker.com/desktop/release-notes/#4150&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç‰ˆæœ¬ 4.15&lt;/a&gt; ä¸­ç¨³å®šæµ‹è¯•ç‰ˆä¸­ä½¿ç”¨ï¼‰ä»¥èƒ½å¤Ÿè¿è¡Œ Wasm å®¹å™¨&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æˆ‘ä»¬è¿˜åˆ©ç”¨äº†&lt;a href=&#34;https://github.com/vmware-labs/webassembly-language-runtimes&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;â€œWasm è¯­è¨€è¿è¡Œæ—¶â€&lt;/a&gt;å­˜å‚¨åº“ï¼Œè¯¥å­˜å‚¨åº“æä¾›äº†å°† PHP è§£é‡Šå™¨æ„å»ºä¸º WebAssembly åº”ç”¨ç¨‹åºçš„æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;æ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼å¼€å§‹æ£€æŸ¥æ¼”ç¤ºåˆ†æ”¯ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;git clone --depth&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; -b php-wasmedge-demo &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   &amp;lt;https://github.com/vmware-labs/webassembly-language-runtimes.git&amp;gt; wlr-demo
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; wlr-demo
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;æ„å»ºä¸€ä¸ª-wasm-å®¹å™¨&#34;&gt;æ„å»ºä¸€ä¸ª Wasm å®¹å™¨&lt;/h2&gt;
&lt;p&gt;é¦–å…ˆï¼Œæˆ‘ä»¬å°†å±•ç¤ºå¦‚ä½•æ„å»ºä¸€ä¸ªç±»ä¼¼äº PHP è§£é‡Šå™¨çš„åŸºäº C çš„åº”ç”¨ç¨‹åºã€‚&lt;/p&gt;
&lt;p&gt;æ„å»ºè¿‡ç¨‹ä½¿ç”¨ WASI-SDK å·¥å…·é›†ã€‚å®ƒåŒ…æ‹¬ä¸€ä¸ªå¯ä»¥æ„å»ºä¸º wasm32-wasi ç›®æ ‡çš„ clang ç¼–è¯‘å™¨ï¼Œä»¥åŠå®ç°åœ¨ WASI ä¸Šçš„åŸºæœ¬ POSIX ç³»ç»Ÿè°ƒç”¨æ¥å£çš„ wasi-libcã€‚ä½¿ç”¨ WASI SDKï¼Œæˆ‘ä»¬å¯ä»¥ä» PHP çš„ C ä»£ç åº“æ„å»º Wasm æ¨¡å—ã€‚ç„¶åï¼Œæˆ‘ä»¬åªéœ€è¦ä¸€ä¸ªåŸºäº scratch çš„éå¸¸ç®€å•çš„ Dockerfile å°±å¯ä»¥åˆ¶ä½œä¸€ä¸ª OCI é•œåƒï¼Œè¯¥é•œåƒå¯ä»¥ä½¿ç”¨ Docker+Wasm è¿è¡Œã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/docker-without-containers/6_hu09c3c81615d15c15b2c4990eab505366_7474_a770315ff19ee5fff595df258c944f44.webp 400w,
               /blog/docker-without-containers/6_hu09c3c81615d15c15b2c4990eab505366_7474_31643b73bf31a881706d6cab275b27f8.webp 760w,
               /blog/docker-without-containers/6_hu09c3c81615d15c15b2c4990eab505366_7474_1200x1200_fit_q75_h2_lanczos_2.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/docker-without-containers/6_hu09c3c81615d15c15b2c4990eab505366_7474_a770315ff19ee5fff595df258c944f44.webp&#34;
               width=&#34;757&#34;
               height=&#34;212&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h3 id=&#34;æ„å»º-wasm-äºŒè¿›åˆ¶æ–‡ä»¶&#34;&gt;æ„å»º WASM äºŒè¿›åˆ¶æ–‡ä»¶&lt;/h3&gt;
&lt;p&gt;å‡è®¾ä½ åœ¨ &lt;code&gt;wlr-demo&lt;/code&gt; æ–‡ä»¶å¤¹ä¸­ï¼Œä½ å¯ä»¥è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥æ„å»º Wasm äºŒè¿›åˆ¶æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;WASI_SDK_ROOT&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/opt/wasi-sdk/
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;WASMLABS_RUNTIME&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;wasmedge
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;./wl-make.sh php/php-7.4.32/ &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; tree build-output/php/php-7.4.32/bin/
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;... &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; a few minutes and hundreds of build log lines&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;build-output/php/php-7.4.32/bin/
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;â”œâ”€â”€ php-cgi-wasmedge
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;â””â”€â”€ php-wasmedge
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;PHP æ˜¯ä½¿ç”¨ &lt;em&gt;autoconf&lt;/em&gt; å’Œ &lt;em&gt;make&lt;/em&gt; æ„å»ºçš„ã€‚å› æ­¤ï¼Œå¦‚æœä½ æŸ¥çœ‹ &lt;code&gt;scripts/wl-build.sh&lt;/code&gt; è„šæœ¬ï¼Œä½ ä¼šæ³¨æ„åˆ°æˆ‘ä»¬è®¾ç½®äº†æ‰€æœ‰ç›¸å…³å˜é‡ï¼Œå¦‚ &lt;code&gt;CC&lt;/code&gt;ã€&lt;code&gt;LD&lt;/code&gt;ã€&lt;code&gt;CXX&lt;/code&gt; ç­‰ï¼Œä»¥ä½¿ç”¨æ¥è‡ª WASI_SDK çš„ç¼–è¯‘å™¨ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;WASI_SYSROOT&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;WASI_SDK_ROOT&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;/share/wasi-sysroot&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;CC&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;WASI_SDK_ROOT&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;/bin/clang
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;LD&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;WASI_SDK_ROOT&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;/bin/wasm-ld
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;CXX&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;WASI_SDK_ROOT&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;/bin/clang++
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;NM&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;WASI_SDK_ROOT&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;/bin/llvm-nm
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;AR&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;WASI_SDK_ROOT&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;/bin/llvm-ar
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;RANLIB&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;WASI_SDK_ROOT&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;/bin/llvm-ranlib
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç„¶åï¼Œè¿›ä¸€æ­¥ç ”ç©¶ &lt;code&gt;php/php-7.4.32/wl-build.sh&lt;/code&gt;ï¼Œä½ å¯ä»¥çœ‹åˆ°æˆ‘ä»¬åƒå¾€å¸¸ä¸€æ ·ä½¿ç”¨ &lt;em&gt;autoconf&lt;/em&gt; æ„å»ºè¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;./configure --host&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;wasm32-wasi &lt;span class=&#34;nv&#34;&gt;host_alias&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;wasm32-musl-wasi &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   --target&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;wasm32-wasi &lt;span class=&#34;nv&#34;&gt;target_alias&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;wasm32-musl-wasi &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   &lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;PHP_CONFIGURE&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;||&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;exit&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;...
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;make -j &lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;MAKE_TARGETS&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;||&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;exit&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;WASI è¿˜åœ¨ä¸æ–­å‘å±•ï¼Œè®¸å¤š POSIX è°ƒç”¨ä»ç„¶æ— æ³•åœ¨å…¶ä¸Šå®ç°ã€‚å› æ­¤ï¼Œä¸ºäº†æ„å»º PHPï¼Œæˆ‘ä»¬ä¸å¾—ä¸åœ¨åŸå§‹ä»£ç åº“çš„åŸºç¡€ä¸Šåº”ç”¨å‡ ä¸ªè¡¥ä¸ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬åœ¨ä¸Šé¢çœ‹åˆ°äº†è¾“å‡ºäºŒè¿›åˆ¶æ–‡ä»¶åˆ° &lt;code&gt;build-output/php/php-7.4.32&lt;/code&gt;ã€‚åœ¨æ¥ä¸‹æ¥çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸“é—¨ä¸º WasmEdge æ„å»ºçš„ &lt;code&gt;php-wasmedge&lt;/code&gt; äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå› ä¸ºå®ƒæä¾›äº†æœåŠ¡å™¨ç«¯å¥—æ¥å­—æ”¯æŒï¼Œè¿™è¿˜ä¸æ˜¯ WASI çš„ä¸€éƒ¨åˆ†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä¼˜åŒ–äºŒè¿›åˆ¶æ–‡ä»¶&#34;&gt;ä¼˜åŒ–äºŒè¿›åˆ¶æ–‡ä»¶&lt;/h3&gt;
&lt;p&gt;Wasm æ˜¯ä¸€ç§è™šæ‹ŸæŒ‡ä»¤é›†ï¼Œå› æ­¤ä»»ä½•è¿è¡Œæ—¶çš„é»˜è®¤è¡Œä¸ºéƒ½æ˜¯å®æ—¶è§£é‡Šè¿™äº›æŒ‡ä»¤ã€‚å½“ç„¶ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹è¿™å¯èƒ½ä¼šä½¿äº‹æƒ…å˜æ…¢ã€‚å› æ­¤ï¼Œä¸ºäº†åœ¨ WasmEdge ä¸­è·å¾—æœ€ä½³æ€§èƒ½ï¼Œæ‚¨å¯ä»¥åˆ›å»ºä¸€ä¸ª AOTï¼ˆahead-of-timeï¼‰ä¼˜åŒ–äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åœ¨å½“å‰æœºå™¨ä¸Šæœ¬åœ°è¿è¡Œï¼Œä½†ä»å¯ä»¥åœ¨å…¶ä»–æœºå™¨ä¸Šè§£é‡Šã€‚&lt;/p&gt;
&lt;p&gt;è¦åˆ›å»ºè¯¥ä¼˜åŒ–äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œè¯·è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;wasmedgec --enable-all --optimize &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   build-output/php/php-7.4.32/bin/php-wasmedge &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   build-output/php/php-7.4.32/bin/php-wasmedge-aot
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æˆ‘ä»¬å°†åœ¨ä»¥ä¸‹ç¤ºä¾‹ä¸­ä½¿ç”¨æ­¤ &lt;code&gt;build-output/php/php-7.4.32/bin/php-wasmedge-aot&lt;/code&gt; äºŒè¿›åˆ¶æ–‡ä»¶ã€‚è¦äº†è§£æœ‰å…³ WasmEdge AOT ä¼˜åŒ–äºŒè¿›åˆ¶æ–‡ä»¶çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ &lt;a href=&#34;https://wasmlabs.dev/articles/docker-without-containers/build-output/php/php-7.4.32/bin/php-wasmedge-aot&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ­¤å¤„&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ„å»º-oci-é•œåƒ&#34;&gt;æ„å»º OCI é•œåƒ&lt;/h3&gt;
&lt;p&gt;ç°åœ¨æˆ‘ä»¬æœ‰äº†äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶åŒ…è£…åœ¨ OCI é•œåƒä¸­ã€‚&lt;/p&gt;
&lt;p&gt;è®©æˆ‘ä»¬æ¥çœ‹çœ‹ &lt;code&gt;images/php/Dockerfile.cli&lt;/code&gt;ã€‚æˆ‘ä»¬åªéœ€è¦å¤åˆ¶ Wasm äºŒè¿›åˆ¶æ–‡ä»¶å¹¶å°†å…¶è®¾ç½®ä¸º &lt;code&gt;ENTRYPOINT&lt;/code&gt; å°±å¯ä»¥äº†ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-dockerfile&#34; data-lang=&#34;dockerfile&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;FROM&lt;/span&gt;&lt;span class=&#34;s&#34;&gt; scratch&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;ARG&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;PHP_TAG&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;php-7.4.32&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;ARG&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;PHP_BINARY&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;php
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;COPY&lt;/span&gt; build-output/php/&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;PHP_TAG&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;/bin/&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;PHP_BINARY&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt; /php.wasm&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;ENTRYPOINT&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;php.wasm&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æˆ‘ä»¬è¿˜å¯ä»¥å‘é•œåƒæ·»åŠ æ›´å¤šå†…å®¹ï¼Œå½“ Wasm äºŒè¿›åˆ¶æ–‡ä»¶åœ¨ Docker ä¸­è¿è¡Œæ—¶ï¼Œè¿™äº›å†…å®¹å°†å¯è®¿é—®ã€‚ä¾‹å¦‚ï¼Œåœ¨ &lt;code&gt;images/php/Dockerfile.server&lt;/code&gt; ä¸­ï¼Œæˆ‘ä»¬è¿˜æ·»åŠ äº†ä¸€äº› docroot å†…å®¹ï¼Œä»¥ä¾¿åœ¨å®¹å™¨å¯åŠ¨æ—¶ç”± &lt;code&gt;php.wasm&lt;/code&gt; æœåŠ¡ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-dockerfile&#34; data-lang=&#34;dockerfile&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;FROM&lt;/span&gt;&lt;span class=&#34;s&#34;&gt; scratch&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;ARG&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;PHP_TAG&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;php-7.4.32&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;ARG&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;PHP_BINARY&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;php
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;COPY&lt;/span&gt; build-output/php/&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;PHP_TAG&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;/bin/&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;PHP_BINARY&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt; /php.wasm&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;COPY&lt;/span&gt; images/php/docroot /docroot&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;ENTRYPOINT&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;php.wasm&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;-S&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;0.0.0.0:8080&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;-t&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;/docroot&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åŸºäºä¸Šè¿°æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾åœ°åœ¨æœ¬åœ°æ„å»ºæˆ‘ä»¬çš„ &lt;code&gt;php-wasm&lt;/code&gt; é•œåƒã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker build --build-arg &lt;span class=&#34;nv&#34;&gt;PHP_BINARY&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;php-wasmedge-aot -t ghcr.io/vmware-labs/php-wasm:7.4.32-cli-aot -f images/php/Dockerfile.cli .
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker build --build-arg &lt;span class=&#34;nv&#34;&gt;PHP_BINARY&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;php-wasmedge-aot -t ghcr.io/vmware-labs/php-wasm:7.4.32-server-aot -f images/php/Dockerfile.server .
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;åŸç”Ÿ-vs-wasm&#34;&gt;åŸç”Ÿ vs Wasm&lt;/h2&gt;
&lt;p&gt;ç°åœ¨è®©æˆ‘ä»¬å°†åŸç”Ÿ PHP äºŒè¿›åˆ¶æ–‡ä»¶ä¸ Wasm äºŒè¿›åˆ¶æ–‡ä»¶è¿›è¡Œæ¯”è¾ƒã€‚åœ¨æœ¬åœ°å’Œ Docker å®¹å™¨ä¸­éƒ½ä½¿ç”¨ç›¸åŒçš„ &lt;code&gt;index.php&lt;/code&gt; æ–‡ä»¶è¿è¡Œå®ƒï¼Œå¹¶æ¯”è¾ƒæˆ‘ä»¬è¿è¡Œå®ƒæ—¶å¾—åˆ°çš„ç»“æœï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;php&lt;/code&gt;,&lt;/li&gt;
&lt;li&gt;&lt;code&gt;php-wasmedge-aot&lt;/code&gt;,&lt;/li&gt;
&lt;li&gt;ä¼ ç»Ÿå®¹å™¨ä¸­çš„ &lt;code&gt;php&lt;/code&gt;,&lt;/li&gt;
&lt;li&gt;Wasm å®¹å™¨ä¸­çš„ &lt;code&gt;php-wasmedge-aot&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/docker-without-containers/7_huf174193c110986bd0ba7a4ddc91dc46e_15602_0537e3890ca0221fc322322dcfdb21fb.webp 400w,
               /blog/docker-without-containers/7_huf174193c110986bd0ba7a4ddc91dc46e_15602_ee61058e8d23d35fa7aa788a8b3d3bc4.webp 760w,
               /blog/docker-without-containers/7_huf174193c110986bd0ba7a4ddc91dc46e_15602_1200x1200_fit_q75_h2_lanczos_2.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/docker-without-containers/7_huf174193c110986bd0ba7a4ddc91dc46e_15602_0537e3890ca0221fc322322dcfdb21fb.webp&#34;
               width=&#34;757&#34;
               height=&#34;326&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;åœ¨ä»¥ä¸‹æ‰€æœ‰ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬éƒ½ä½¿ç”¨ç›¸åŒçš„ &lt;code&gt;images/php/docroot/index.php&lt;/code&gt; æ–‡ä»¶ï¼Œå› æ­¤è®©æˆ‘ä»¬æ¥çœ‹çœ‹ã€‚ç®€è€Œè¨€ä¹‹ï¼Œæ­¤è„šæœ¬å°†ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨ &lt;code&gt;phpversion&lt;/code&gt; å’Œ &lt;code&gt;php_uname&lt;/code&gt; æ˜¾ç¤ºè§£é‡Šå™¨ç‰ˆæœ¬å’Œæ­£åœ¨è¿è¡Œçš„å¹³å°&lt;/li&gt;
&lt;li&gt;æ‰“å°è„šæœ¬å¯ä»¥è®¿é—®çš„æ‰€æœ‰ç¯å¢ƒå˜é‡çš„åç§°&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨å½“å‰æ—¶é—´å’Œæ—¥æœŸæ‰“å°ä¸€ä¸ª hello æ¶ˆæ¯&lt;/li&gt;
&lt;li&gt;åˆ—å‡ºæ ¹ç›®å½• &lt;code&gt;/&lt;/code&gt; çš„å†…å®¹&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-html&#34; data-lang=&#34;html&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;html&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;h1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;Hello from PHP &lt;span class=&#34;cp&#34;&gt;&amp;lt;?php echo phpversion() ?&amp;gt;&lt;/span&gt; running on &amp;#34;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php echo php_uname()?&amp;gt;&lt;/span&gt;&amp;#34;&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;h1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;h2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;List env variable names&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;h2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;$php_env_vars_count = count(getenv());
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;echo &amp;#34;Running with $php_env_vars_count environment variables:\\n&amp;#34;;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;foreach (getenv() as $key =&amp;gt; $value) {
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;    echo  $key . &amp;#34; &amp;#34;;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;echo &amp;#34;\\n&amp;#34;;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;h2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;Hello&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;h2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;$date = getdate();
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;$message = &amp;#34;Today, &amp;#34; . $date[&amp;#39;weekday&amp;#39;] . &amp;#34;, &amp;#34; . $date[&amp;#39;year&amp;#39;] . &amp;#34;-&amp;#34; . $date[&amp;#39;mon&amp;#39;] . &amp;#34;-&amp;#34; . $date[&amp;#39;mday&amp;#39;];
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;$message .= &amp;#34;, at &amp;#34; . $date[&amp;#39;hours&amp;#39;] . &amp;#34;:&amp;#34; . $date[&amp;#39;minutes&amp;#39;] . &amp;#34;:&amp;#34; . $date[&amp;#39;seconds&amp;#39;];
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;$message .= &amp;#34; we greet you with this message!\\n&amp;#34;;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;echo $message;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;h2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;Contents of &amp;#39;/&amp;#39;&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;h2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;foreach (array_diff(scandir(&amp;#39;/&amp;#39;), array(&amp;#39;.&amp;#39;, &amp;#39;..&amp;#39;)) as $key =&amp;gt; $value) {
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;    echo  $value . &amp;#34; &amp;#34;;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;echo &amp;#34;\\n&amp;#34;;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;html&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;åŸç”Ÿè¿è¡Œ-indexphp-çš„-php&#34;&gt;åŸç”Ÿè¿è¡Œ index.php çš„ PHP&lt;/h3&gt;
&lt;p&gt;å½“æˆ‘ä»¬ä½¿ç”¨åŸç”Ÿçš„ &lt;code&gt;php&lt;/code&gt; äºŒè¿›åˆ¶æ–‡ä»¶æ—¶ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åŸºäº Linux çš„å¹³å°&lt;/li&gt;
&lt;li&gt;è„šæœ¬å¯ä»¥è®¿é—®çš„ 58 ä¸ªç¯å¢ƒå˜é‡åˆ—è¡¨ï¼ˆå¦‚æœéœ€è¦çš„è¯ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;code&gt;/&lt;/code&gt; ä¸­æ‰€æœ‰æ–‡ä»¶å’Œæ–‡ä»¶å¤¹çš„åˆ—è¡¨ï¼Œè¿™äº›éƒ½æ˜¯è„šæœ¬å¯ä»¥è®¿é—®çš„&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ php -f images/php/docroot/index.php
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;html&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;body&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;h1&amp;gt;Hello from PHP 7.4.3 running on &lt;span class=&#34;s2&#34;&gt;&amp;#34;Linux alexandrov-z01 5.15.79.1-microsoft-standard-WSL2 #1 SMP Wed Nov 23 01:01:46 UTC 2022 x86_64&amp;#34;&lt;/span&gt;&amp;lt;/h1&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;h2&amp;gt;List env variable names&amp;lt;/h2&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Running with &lt;span class=&#34;m&#34;&gt;58&lt;/span&gt; environment variables:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;SHELL NVM_INC WSL2_GUI_APPS_ENABLED rvm_prefix WSL_DISTRO_NAME TMUX rvm_stored_umask TMUX_PLUGIN_MANAGER_PATH MY_RUBY_HOME NAME RUBY_VERSION PWD NIX_PROFILES LOGNAME rvm_version rvm_user_install_flag MOTD_SHOWN HOME LANG WSL_INTEROP LS_COLORS WASMTIME_HOME WAYLAND_DISPLAY NIX_SSL_CERT_FILE PROMPT_COMMAND NVM_DIR rvm_bin_path GEM_PATH GEM_HOME LESSCLOSE TERM CPLUS_INCLUDE_PATH LESSOPEN USER TMUX_PANE LIBRARY_PATH rvm_loaded_flag DISPLAY SHLVL NVM_CD_FLAGS LD_LIBRARY_PATH XDG_RUNTIME_DIR PS1 WSLENV XDG_DATA_DIRS PATH DBUS_SESSION_BUS_ADDRESS C_INCLUDE_PATH NVM_BIN HOSTTYPE WASMER_CACHE_DIR IRBRC PULSE_SERVER rvm_path WASMER_DIR OLDPWD BASH_FUNC_cr-open%% _
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;h2&amp;gt;Hello&amp;lt;/h2&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Today, Wednesday, 2022-12-14, at 12:0:36 we greet you with this message!
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;h2&amp;gt;Contents of &lt;span class=&#34;s1&#34;&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&amp;lt;/h2&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;apps bin boot dev docroot etc home init lib lib32 lib64 libx32 lost+found media mnt nix opt path proc root run sbin snap srv sys tmp usr var wsl.localhost
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;/body&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;/html&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;php-aot-wasm-è¿è¡Œ-indexphp&#34;&gt;php-aot-wasm è¿è¡Œ index.php&lt;/h3&gt;
&lt;p&gt;å½“æˆ‘ä»¬ä½¿ç”¨&lt;code&gt;php-aot-wasm&lt;/code&gt;ä¸ Wasmedge ç»“åˆä½¿ç”¨æ—¶ï¼Œæˆ‘ä»¬å‘ç°&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;wasi/wasm32å¹³å°&lt;/li&gt;
&lt;li&gt;æ²¡æœ‰ç¯å¢ƒå˜é‡ï¼Œå› ä¸ºæ²¡æœ‰å°†ä»»ä½•ç¯å¢ƒå˜é‡æ˜¾å¼æš´éœ²ç»™ Wasm åº”ç”¨ç¨‹åº&lt;/li&gt;
&lt;li&gt;Wasm åº”ç”¨ç¨‹åºæ²¡æœ‰è¢«æ˜ç¡®æˆæƒè®¿é—®&lt;code&gt;/&lt;/code&gt;ï¼Œå› æ­¤å°è¯•åˆ—å‡ºå…¶å†…å®¹æ—¶ä¼šå‡ºç°é”™è¯¯&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å½“ç„¶ï¼Œè¦ä½¿&lt;code&gt;php-wasmedge-aot&lt;/code&gt;å¯ä»¥è®¿é—®è¯»å–&lt;code&gt;index.php&lt;/code&gt;æ–‡ä»¶ï¼Œæˆ‘ä»¬å¿…é¡»æ˜ç¡®è¯´æ˜æˆ‘ä»¬æƒ³è¦é¢„å…ˆæ‰“å¼€&lt;code&gt;images/php/docroot&lt;/code&gt;ä»¥ä¾¿ WasmEdge å¯ä»¥è®¿é—®å®ƒä½œä¸º Wasm åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡ä¸­çš„&lt;code&gt;/docroot&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¿™å¾ˆå®¹æ˜“æ˜¾ç¤ºäº† Wasm é™¤äº†å¯ç§»æ¤æ€§ä¹‹å¤–çš„æœ€å¤§ä¼˜ç‚¹ä¹‹ä¸€ã€‚æˆ‘ä»¬è·å¾—äº†æ›´å¥½çš„å®‰å…¨æ€§ï¼Œå› ä¸ºé™¤éæ˜ç¡®è¯´æ˜ï¼Œå¦åˆ™æ²¡æœ‰ä»»ä½•å†…å®¹æ˜¯å¯è®¿é—®çš„ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ wasmedge --dir /docroot:&lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;pwd&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;/images/php/docroot &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   build-output/php/php-7.4.32/bin/php-wasmedge-aot -f /docroot/index.php
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;html&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;body&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;h1&amp;gt;Hello from PHP 7.4.32 running on &lt;span class=&#34;s2&#34;&gt;&amp;#34;wasi (none) 0.0.0 0.0.0 wasm32&amp;#34;&lt;/span&gt;&amp;lt;/h1&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;h2&amp;gt;List env variable names&amp;lt;/h2&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Running with &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; environment variables:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;h2&amp;gt;Hello&amp;lt;/h2&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Today, Wednesday, 2022-12-14, at 10:8:46 we greet you with this message!
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;h2&amp;gt;Contents of &lt;span class=&#34;s1&#34;&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&amp;lt;/h2&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Warning: scandir&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;/&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;: failed to open dir: Capabilities insufficient in /docroot/index.php on line &lt;span class=&#34;m&#34;&gt;27&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Warning: scandir&lt;span class=&#34;o&#34;&gt;()&lt;/span&gt;: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;errno 76&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;: Capabilities insufficient in /docroot/index.php on line &lt;span class=&#34;m&#34;&gt;27&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Warning: array_diff&lt;span class=&#34;o&#34;&gt;()&lt;/span&gt;: Expected parameter &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; to be an array, bool given in /docroot/index.php on line &lt;span class=&#34;m&#34;&gt;27&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Warning: Invalid argument supplied &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; foreach&lt;span class=&#34;o&#34;&gt;()&lt;/span&gt; in /docroot/index.php on line &lt;span class=&#34;m&#34;&gt;27&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;/body&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;/html&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;å®¹å™¨ä¸­è¿è¡Œ-indexphp-çš„-php&#34;&gt;å®¹å™¨ä¸­è¿è¡Œ index.php çš„ PHP&lt;/h3&gt;
&lt;p&gt;å½“æˆ‘ä»¬ä½¿ç”¨ä¼ ç»Ÿå®¹å™¨ä¸­çš„â€œphpâ€æ—¶ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åŸºäº Linux çš„å¹³å°&lt;/li&gt;
&lt;li&gt;è„šæœ¬å…·æœ‰è®¿é—®æƒé™çš„ 14 ä¸ªç¯å¢ƒå˜é‡åˆ—è¡¨&lt;/li&gt;
&lt;li&gt;å¸¦æœ‰å½“å‰æ—¶é—´å’Œæ—¥æœŸçš„é—®å€™æ¶ˆæ¯&lt;/li&gt;
&lt;li&gt;æ ¹æ–‡ä»¶å¤¹&lt;code&gt;/&lt;/code&gt;çš„å†…å®¹åˆ—è¡¨&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸åœ¨ä¸»æœºä¸Šä½¿ç”¨â€œphpâ€çš„æƒ…å†µç›¸æ¯”ï¼Œè¿™å·²ç»æœ‰æ‰€æ”¹å–„ã€‚ç”±äºç¯å¢ƒå˜é‡å’Œ&lt;code&gt;/&lt;/code&gt;çš„å†…å®¹æ˜¯â€œè™šæ‹Ÿâ€çš„ï¼Œå› æ­¤ä»…å­˜åœ¨äºå®¹å™¨å†…ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker run --rm &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   -v &lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;pwd&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;/images/php/docroot:/docroot &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   php:7.4.32-cli &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   php -f /docroot/index.php
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;html&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;body&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;h1&amp;gt;Hello from PHP 7.4.32 running on &lt;span class=&#34;s2&#34;&gt;&amp;#34;Linux 227b2bc2f611 5.15.79.1-microsoft-standard-WSL2 #1 SMP Wed Nov 23 01:01:46 UTC 2022 x86_64&amp;#34;&lt;/span&gt;&amp;lt;/h1&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;h2&amp;gt;List env variable names&amp;lt;/h2&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Running with &lt;span class=&#34;m&#34;&gt;14&lt;/span&gt; environment variables:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;HOSTNAME PHP_INI_DIR HOME PHP_LDFLAGS PHP_CFLAGS PHP_VERSION GPG_KEYS PHP_CPPFLAGS PHP_ASC_URL PHP_URL PATH PHPIZE_DEPS PWD PHP_SHA256
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;h2&amp;gt;Hello&amp;lt;/h2&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Today, Wednesday, 2022-12-14, at 10:15:35 we greet you with this message!
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;h2&amp;gt;Contents of &lt;span class=&#34;s1&#34;&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&amp;lt;/h2&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;bin boot dev docroot etc home lib lib64 media mnt opt proc root run sbin srv sys tmp usr var
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;/body&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;/html&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;å®¹å™¨ä¸­è¿è¡Œ-indexphp-çš„-php-aot-wasm&#34;&gt;å®¹å™¨ä¸­è¿è¡Œ index.php çš„ php-aot-wasm&lt;/h3&gt;
&lt;p&gt;å½“æˆ‘ä»¬ä½¿ç”¨&lt;code&gt;php-aot-wasm&lt;/code&gt;ä¸ Wasmedge ç»“åˆä½¿ç”¨æ—¶ï¼Œæˆ‘ä»¬å‘ç°&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;wasi / wasm32 å¹³å°&lt;/li&gt;
&lt;li&gt;åªæœ‰ 2 ä¸ªåŸºç¡€æ¶æ„ç¯å¢ƒå˜é‡ï¼Œä½¿ç”¨è¿è¡Œåœ¨ containerd ä¸­çš„ WasmEdge shim é¢„è®¾&lt;/li&gt;
&lt;li&gt;æ˜¾ç¤ºäº†å®¹å™¨ä¸­&lt;code&gt;/&lt;/code&gt;ä¸­çš„æ‰€æœ‰æ–‡ä»¶å’Œæ–‡ä»¶å¤¹çš„åˆ—è¡¨ï¼Œè¿™æ˜¯ Wasm åº”ç”¨ç¨‹åºæ˜ç¡®é¢„å…ˆæ‰“å¼€ä»¥ä¾¿è®¿é—®çš„ï¼ˆWasmEdge shim ä¸­çš„é€»è¾‘çš„ä¸€éƒ¨åˆ†ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ³¨æ„ï¼šå¦‚æœæ‚¨æ›´åŠ ç»†å¿ƒï¼Œæ‚¨å°†ä¼šçœ‹åˆ°ä¸ºäº†ä»æ­¤é•œåƒè¿è¡Œå®¹å™¨ï¼Œæˆ‘ä»¬å¿…é¡»ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é€šè¿‡&lt;code&gt;runtime=io.containerd.wasmedge.v1&lt;/code&gt;æ˜ç¡®åœ°æŒ‡å®šè¿è¡Œæ—¶&lt;/li&gt;
&lt;li&gt;ç›´æ¥ä¼ é€’å‘½ä»¤è¡Œå‚æ•°åˆ°&lt;code&gt;php.wasm&lt;/code&gt;ï¼Œè€Œä¸åŒ…æ‹¬äºŒè¿›åˆ¶æ–‡ä»¶æœ¬èº«ã€‚å‘ä¸Šæ»šåŠ¨å¹¶æŸ¥çœ‹ä¼ ç»Ÿ PHP å®¹å™¨ï¼ŒåŒ…æ‹¬&lt;code&gt;php&lt;/code&gt;äºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆå¹¶ä¸æ˜¯å¿…è¦çš„ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æœ€åï¼Œå³ä½¿æ˜¯åœ¨ Docker ä¸­ï¼ŒWasm ä¹ŸåŠ å¼ºäº†è¿è¡Œ index.php çš„å®‰å…¨æ€§ï¼Œå› ä¸ºæš´éœ²ç»™å®ƒçš„ä¸œè¥¿è¦å°‘å¾—å¤šã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker run --rm &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   --runtime&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;io.containerd.wasmedge.v1 &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   -v &lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;pwd&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;/images/php/docroot:/docroot &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   ghcr.io/vmware-labs/php-wasm:7.4.32-cli-aot &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   -f /docroot/index.php
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;html&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;body&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;h1&amp;gt;Hello from PHP 7.4.32 running on &lt;span class=&#34;s2&#34;&gt;&amp;#34;wasi (none) 0.0.0 0.0.0 wasm32&amp;#34;&lt;/span&gt;&amp;lt;/h1&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;h2&amp;gt;List env variable names&amp;lt;/h2&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Running with &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; environment variables:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;PATH HOSTNAME
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;h2&amp;gt;Hello&amp;lt;/h2&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Today, Wednesday, 2022-12-14, at 11:33:10 we greet you with this message!
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;h2&amp;gt;Contents of &lt;span class=&#34;s1&#34;&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&amp;lt;/h2&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docroot etc php.wasm
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;/body&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;/html&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;ä¼ ç»Ÿå®¹å™¨ä¸-wasm-å®¹å™¨&#34;&gt;ä¼ ç»Ÿå®¹å™¨ä¸ wasm å®¹å™¨&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬æˆåŠŸåœ°æ„å»ºå’Œè¿è¡Œäº†ä¸€ä¸ª Wasm äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¹¶å°†å…¶ä½œä¸ºå®¹å™¨è¿è¡Œã€‚æˆ‘ä»¬çœ‹åˆ°äº† Wasm å®¹å™¨å’Œä¼ ç»Ÿå®¹å™¨ä¹‹é—´çš„è¾“å‡ºå·®å¼‚ä»¥åŠ Wasm å¸¦æ¥çš„é«˜çº§â€œæ²™ç›’â€æ€§èƒ½ã€‚è®©æˆ‘ä»¬çœ‹çœ‹æˆ‘ä»¬å¯ä»¥è½»æ¾çœ‹åˆ°çš„ä¸¤ç§å®¹å™¨ç±»å‹ä¹‹é—´çš„å…¶ä»–å·®å¼‚ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆï¼Œæˆ‘ä»¬å°†è¿è¡Œä¸¤ä¸ªå®ˆæŠ¤ç¨‹åºå®¹å™¨ï¼Œå¹¶æŸ¥çœ‹å¦‚ä½•è§£é‡Šæœ‰å…³å®ƒä»¬çš„ä¸€äº›ç»Ÿè®¡ä¿¡æ¯ã€‚ç„¶åï¼Œæˆ‘ä»¬å°†æ£€æŸ¥å®¹å™¨é•œåƒä¸­çš„å·®å¼‚ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/docker-without-containers/8_hua853562afea5ac88706362ca3bdf32f6_18506_f23dfaa3d922c2d1dab5e70606f287d5.webp 400w,
               /blog/docker-without-containers/8_hua853562afea5ac88706362ca3bdf32f6_18506_98aca8d6a0624071b11809e6800b3ca9.webp 760w,
               /blog/docker-without-containers/8_hua853562afea5ac88706362ca3bdf32f6_18506_1200x1200_fit_q75_h2_lanczos_2.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/docker-without-containers/8_hua853562afea5ac88706362ca3bdf32f6_18506_f23dfaa3d922c2d1dab5e70606f287d5.webp&#34;
               width=&#34;757&#34;
               height=&#34;465&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h3 id=&#34;å®¹å™¨ç»Ÿè®¡&#34;&gt;å®¹å™¨ç»Ÿè®¡&lt;/h3&gt;
&lt;p&gt;æˆ‘ä»¬å°†è¿è¡Œä¸¤ä¸ªå®ˆæŠ¤ç¨‹åºå®¹å™¨ - ä¸€ä¸ªæ¥è‡ªä¼ ç»Ÿçš„&lt;code&gt;php&lt;/code&gt;é•œåƒï¼Œå¦ä¸€ä¸ªæ¥è‡ª&lt;code&gt;php-wasm&lt;/code&gt;é•œåƒã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker run --rm -d &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   -p 8083:8080 -v &lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;pwd&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;/images/php/docroot:/docroot &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   php:7.4.32-cli &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   -S 0.0.0.0:8080 -t /docroot
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker run --rm -d &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   --runtime&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;io.containerd.wasmedge.v1 &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   -p 8082:8080 -v &lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;pwd&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;/images/php/docroot:/docroot &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   ghcr.io/vmware-labs/php-wasm:7.4.32-cli-aot
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   -S 0.0.0.0:8080 -t /docroot
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬æŸ¥çœ‹&lt;code&gt;docker stats&lt;/code&gt;ï¼Œæˆ‘ä»¬å°†åªçœ‹åˆ°ä¼ ç»Ÿå®¹å™¨çš„ç»Ÿè®¡ä¿¡æ¯ã€‚ç”±äº Docker+Wasm æ˜¯ beta åŠŸèƒ½ï¼Œè¿™å¯èƒ½ä¼šå‘ç”Ÿå˜åŒ–ã€‚å› æ­¤ï¼Œå¦‚æœæƒ³è¦æŸ¥çœ‹æ­£åœ¨å‘ç”Ÿçš„æƒ…å†µï¼Œå¯ä»¥ç›‘è§†æ§åˆ¶ç»„ã€‚æ¯ä¸ªä¼ ç»Ÿå®¹å™¨éƒ½æœ‰è‡ªå·±çš„æ§åˆ¶ç»„ï¼Œå¦‚&lt;code&gt;docker/ee44...&lt;/code&gt;æ‰€ç¤ºã€‚å¦ä¸€æ–¹é¢ï¼ŒWasm å®¹å™¨åŒ…å«åœ¨&lt;code&gt;podruntime/docker&lt;/code&gt;æ§åˆ¶ç»„ä¸­ï¼Œæ‚¨å¯ä»¥é—´æ¥è§‚å¯Ÿå®ƒä»¬çš„ CPU æˆ–å†…å­˜æ¶ˆè€—ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ systemd-cgtop -kP --depth&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;10&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Control Group           Tasks    %CPU     Memory
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;podruntime              &lt;span class=&#34;m&#34;&gt;145&lt;/span&gt;      0.1      636.3M
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;podruntime/docker       &lt;span class=&#34;m&#34;&gt;145&lt;/span&gt;      0.1      636.3M
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker                  &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;        0.0      39.7M
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker/ee444b...        &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;        0.0      6.7M
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;é•œåƒå¤§å°&#34;&gt;é•œåƒå¤§å°&lt;/h3&gt;
&lt;p&gt;é¦–å…ˆï¼Œæ¢ç´¢é•œåƒæ—¶ï¼Œæˆ‘ä»¬ä¼šå‘ç° Wasm å®¹å™¨é•œåƒæ¯”ä¼ ç»Ÿå®¹å™¨é•œåƒå°å¾—å¤šã€‚å³ä½¿æ˜¯â€œphpâ€å®¹å™¨çš„&lt;code&gt;alpine&lt;/code&gt;ç‰ˆæœ¬ä¹Ÿæ¯” Wasm å®¹å™¨å¤§ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ docker images
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;REPOSITORY                     TAG                 IMAGE ID       CREATED          SIZE
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;php                            7.4.32-cli          680c4ba36f1b   &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; hours ago      166MB
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;php                            7.4.32-cli-alpine   a785f7973660   &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; minutes ago    30.1MB
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ghcr.io/vmware-labs/php-wasm   7.4.32-cli-aot      63460740f6d5   &lt;span class=&#34;m&#34;&gt;44&lt;/span&gt; minutes ago   5.35MB
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™æ˜¯å› ä¸ºä½¿ç”¨ Wasm æ—¶ï¼Œæˆ‘ä»¬åªéœ€è¦å°†å¯æ‰§è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶æ”¾å…¥å®¹å™¨ä¸­ï¼Œè€Œä¼ ç»Ÿå®¹å™¨è¿˜éœ€è¦ä¸€äº›æ¥è‡ªæ“ä½œç³»ç»Ÿçš„åŸºæœ¬åº“å’Œæ–‡ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ç§å¤§å°ä¸Šçš„å·®å¼‚å¯¹ç¬¬ä¸€æ¬¡æ‹‰å–é•œåƒçš„é€Ÿåº¦ä»¥åŠé•œåƒåœ¨æœ¬åœ°ä»“åº“ä¸­æ‰€å ç”¨çš„ç©ºé—´éƒ½æœ‰å¾ˆå¤§çš„ç›Šå¤„ã€‚&lt;/p&gt;
&lt;h2 id=&#34;wasm-çš„å¯ç§»æ¤æ€§&#34;&gt;Wasm çš„å¯ç§»æ¤æ€§&lt;/h2&gt;
&lt;p&gt;Wasm æœ€å¥½çš„ä¸€ç‚¹å°±æ˜¯å¯ç§»æ¤æ€§ã€‚å½“æˆ‘ä»¬æƒ³è¦ä¸€ä¸ªå¯ç§»æ¤çš„åº”ç”¨ç¨‹åºæ—¶ï¼ŒDocker å·²ç»æˆä¸ºäº†ä¼ ç»Ÿå®¹å™¨çš„é¦–é€‰ã€‚ç„¶è€Œï¼Œé™¤äº†é•œåƒå¤§å°ä¹‹å¤–ï¼Œä¼ ç»Ÿå®¹å™¨è¿˜ç»‘å®šåœ¨å®ƒä»¬è¿è¡Œçš„å¹³å°çš„æ¶æ„ä¸Šã€‚æˆ‘ä»¬ä¸­çš„è®¸å¤šäººéƒ½ç»å†è¿‡ä¸ºæ”¯æŒä¸åŒæ¶æ„æ„å»ºè½¯ä»¶çš„ç‰ˆæœ¬å¹¶å°†å…¶æ‰“åŒ…åˆ°æ¯ä¸ªæ¶æ„çš„ä¸åŒé•œåƒä¸­çš„èµ·ä¼ã€‚&lt;/p&gt;
&lt;p&gt;WebAssembly å¸¦æ¥äº†çœŸæ­£çš„å¯ç§»æ¤æ€§ã€‚æ‚¨å¯ä»¥ç¼–è¯‘ä¸€æ¬¡äºŒè¿›åˆ¶æ–‡ä»¶å¹¶åœ¨ä»»ä½•åœ°æ–¹è¿è¡Œå®ƒã€‚ä¸ºäº†è¯æ˜è¿™ç§å¯ç§»æ¤æ€§ï¼Œæˆ‘ä»¬å‡†å¤‡äº†å‡ ä¸ªç¤ºä¾‹ï¼Œæ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡æˆ‘ä»¬ä¸º WebAssembly æ„å»ºçš„ PHP è§£é‡Šå™¨è¿è¡Œ WordPressã€‚&lt;/p&gt;
&lt;p&gt;å½“å®ƒä»¥ç‹¬ç«‹çš„ Wasm åº”ç”¨ç¨‹åºè¿è¡Œæ—¶ï¼ŒPHP å°†ä¸º WordPress æä¾›æœåŠ¡ã€‚åŒæ ·åœ°ï¼Œå®ƒä¹Ÿå¯ä»¥åœ¨ Docker+Wasm å®¹å™¨ä¸­è¿è¡Œã€‚å®ƒè¿˜å¯ä»¥åœ¨åµŒå…¥ Wasm è¿è¡Œæ—¶çš„ä»»ä½•åº”ç”¨ç¨‹åºä¸­è¿è¡Œã€‚åœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼Œè¿™æ˜¯ apache httpdï¼Œå®ƒé€šè¿‡ mod_wasm å¯ä»¥å°† Wasm åº”ç”¨ç¨‹åºç”¨ä½œå†…å®¹å¤„ç†ç¨‹åºã€‚æœ€åï¼ŒPHP.wasm ä¹Ÿå¯ä»¥åœ¨æµè§ˆå™¨ä¸­è¿è¡Œã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/docker-without-containers/9_huccfef052a73a2282fb41a9c8da0ded43_16880_012759d24c78f85dcb3ca47051f55c95.webp 400w,
               /blog/docker-without-containers/9_huccfef052a73a2282fb41a9c8da0ded43_16880_1118ab866415ad1a44cd869277461e8c.webp 760w,
               /blog/docker-without-containers/9_huccfef052a73a2282fb41a9c8da0ded43_16880_1200x1200_fit_q75_h2_lanczos_2.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/docker-without-containers/9_huccfef052a73a2282fb41a9c8da0ded43_16880_012759d24c78f85dcb3ca47051f55c95.webp&#34;
               width=&#34;757&#34;
               height=&#34;308&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h3 id=&#34;é€šè¿‡-wasmedge-æä¾›-wordpress&#34;&gt;é€šè¿‡ WasmEdge æä¾› WordPress&lt;/h3&gt;
&lt;p&gt;æˆ‘ä»¬ä¸ºæ­¤æ¼”ç¤ºå‡†å¤‡äº†ä¸€ä¸ªç´§å‡‘çš„ WordPress+Sqlite ç¤ºä¾‹ã€‚ç”±äºå®ƒæ˜¯ &lt;code&gt;ghcr.io/vmware-labs/php-wasm:7.4.32-server-wordpress&lt;/code&gt; å®¹å™¨æ˜ åƒçš„ä¸€éƒ¨åˆ†ï¼Œå› æ­¤è®©æˆ‘ä»¬é¦–å…ˆå°†å…¶ä¸‹è½½åˆ°æœ¬åœ°ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ¡å‘½ä»¤åªä¼šåˆ›å»ºä¸€ä¸ªä¸´æ—¶å®¹å™¨ï¼ˆæ‹‰å–é•œåƒï¼‰ï¼Œå°† WordPress æ–‡ä»¶å¤åˆ¶åˆ° &lt;code&gt;/tmp/wp/docroot&lt;/code&gt; ä¸­ï¼Œç„¶ååˆ é™¤å®¹å™¨ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;container_id&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;docker create ghcr.io/vmware-labs/php-wasm:7.4.32-server-wordpress&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   mkdir /tmp/wp &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   docker cp &lt;span class=&#34;nv&#34;&gt;$container_id&lt;/span&gt;:/docroot /tmp/wp/ &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   docker rm &lt;span class=&#34;nv&#34;&gt;$container_id&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç°åœ¨æˆ‘ä»¬æœ‰äº† WordPressï¼Œè®©æˆ‘ä»¬ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æä¾›æœåŠ¡ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;wasmedge --dir /docroot:/tmp/wp/docroot &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   build-output/php/php-7.4.32/bin/php-wasmedge-aot &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   -S 0.0.0.0:8085 -t /docroot
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ‚¨å¯ä»¥è½¬åˆ° &lt;a href=&#34;http://localhost:8085/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;http://localhost:8085&lt;/a&gt; å¹¶äº«å—ç”± PHP Wasm è§£é‡Šå™¨æä¾›çš„ WordPressã€‚&lt;/p&gt;
&lt;h3 id=&#34;é€šè¿‡-dockerwasm-æä¾›-wordpress&#34;&gt;é€šè¿‡ Docker+Wasm æä¾› WordPress&lt;/h3&gt;
&lt;p&gt;å½“ç„¶ï¼Œä½¿ç”¨ Dockerï¼Œäº‹æƒ…è¦ç®€å•å¾—å¤šã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker run --rm --runtime&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;io.containerd.wasmedge.v1 &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   -p 8086:8080 -v /tmp/wp/docroot/:/docroot/ &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   ghcr.io/vmware-labs/php-wasm:7.4.32-cli-aot
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   -S 0.0.0.0:8080 -t /docroot
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ‚¨å¯ä»¥è½¬åˆ° &lt;a href=&#34;http://localhost:8086/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;http://localhost:8086&lt;/a&gt; å¹¶äº«å—ç”± PHP Wasm è§£é‡Šå™¨æä¾›çš„ WordPressï¼Œè¿™ä¸€æ¬¡å®ƒåœ¨ Docker å®¹å™¨ä¸­è¿è¡Œã€‚&lt;/p&gt;
&lt;h3 id=&#34;é€šè¿‡-apache-httpd-ä¸­çš„-mod_wasm-æä¾›-wordpress&#34;&gt;é€šè¿‡ Apache HTTPD ä¸­çš„ mod_wasm æä¾› WordPress&lt;/h3&gt;
&lt;p&gt;Apache HTTPD æ˜¯æœ€å¹¿æ³›ä½¿ç”¨çš„ HTTP æœåŠ¡å™¨ä¹‹ä¸€ã€‚ç°åœ¨ï¼Œé€šè¿‡ mod_wasmï¼Œå®ƒä¹Ÿå¯ä»¥è¿è¡Œ WebAssembly åº”ç”¨ç¨‹åºã€‚ä¸ºäº†é¿å…åœ¨æœ¬åœ°å®‰è£…å’Œé…ç½®å®ƒï¼Œæˆ‘ä»¬å‡†å¤‡äº†ä¸€ä¸ªå®¹å™¨ï¼Œå…¶ä¸­åŒ…å« Apache HTTPDã€mod_wasm å’Œ WordPressã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker run -p 8087:8080 projects.registry.vmware.com/wasmlabs/containers/php-mod-wasm:wordpress
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ‚¨å¯ä»¥è½¬åˆ° &lt;a href=&#34;http://localhost:8087/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;http://localhost:8087&lt;/a&gt; å¹¶äº«å—ç”± Apache HTTPD ä¸­åŠ è½½çš„ mod_wasm æä¾›çš„ PHP Wasm è§£é‡Šå™¨æä¾›çš„ WordPressã€‚&lt;/p&gt;
&lt;h3 id=&#34;ç›´æ¥åœ¨æµè§ˆå™¨ä¸­æä¾›-wordpress&#34;&gt;ç›´æ¥åœ¨æµè§ˆå™¨ä¸­æä¾› WordPress&lt;/h3&gt;
&lt;p&gt;åªéœ€è½¬åˆ° [&lt;a href=&#34;https://wordpress.wasmlabs.dev/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://wordpress.wasmlabs.dev&lt;/a&gt;] æŸ¥çœ‹ç¤ºä¾‹ã€‚æ‚¨å°†çœ‹åˆ°ä¸€ä¸ªæ¡†æ¶ï¼Œå…¶ä¸­ PHP Wasm è§£é‡Šå™¨æ­£åœ¨ç°åœºæ¸²æŸ“ WordPressã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç»“è®º&#34;&gt;ç»“è®º&lt;/h2&gt;
&lt;p&gt;æ„Ÿè°¢æ‚¨é˜…è¯»æœ¬æ–‡ã€‚è¿™æ˜¯å¾ˆå¤šå†…å®¹è¦æ¶ˆåŒ–ï¼Œä½†æˆ‘ä»¬å¸Œæœ›å®ƒæœ‰åŠ©äºäº†è§£ WebAssembly çš„åŠŸèƒ½ä»¥åŠå®ƒå¦‚ä½•ä¸æ‚¨ç°æœ‰çš„ä»£ç åº“å’Œå·¥å…·ï¼ˆåŒ…æ‹¬ Dockerï¼‰ä¸€èµ·ä½¿ç”¨ã€‚æœŸå¾…çœ‹åˆ°æ‚¨ä½¿ç”¨ Wasm æ„å»ºçš„å†…å®¹ï¼&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>ç”¨ Docker å’Œ WebAssembly æ‰“é€ å®¹å™¨çš„æ–°æ—¶ä»£ï¼</title>
      <link>https://lib.jimmysong.io/blog/docker-wasm-quick-intro/</link>
      <pubDate>Mon, 17 Apr 2023 10:27:22 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/docker-wasm-quick-intro/</guid>
      <description>&lt;blockquote&gt;
&lt;p&gt;è¯‘è€…æ³¨ï¼šæœ¬æ–‡è¯‘è‡ª &lt;a href=&#34;https://medium.com/@guglielmino/docker-webassembly-a-quick-intro-730c38e8390c&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Docker + WebAssembly: a quick intro | by Fabrizio Guglielmino | Medium&lt;/a&gt;ï¼Œæœ¬æ–‡ä»‹ç»äº†ä½¿ç”¨ Docker å’Œ WebAssembly åˆ›å»ºå®¹å™¨çš„è¿‡ç¨‹ã€‚é€šè¿‡æ¯”è¾ƒæ ‡å‡† Docker å®¹å™¨å’Œ WebAssembly å®¹å™¨ï¼Œä½œè€…æŒ‡å‡º WebAssembly å®¹å™¨å…·æœ‰æ€§èƒ½ä¼˜åŠ¿ã€æ¶æ„ä¸­ç«‹ç­‰ä¼˜ç‚¹ï¼Œä½†ä¹Ÿå­˜åœ¨ä¸æˆç†Ÿçš„é—®é¢˜ã€‚WebAssembly å®¹å™¨æœ‰æœ›å½»åº•æ”¹å˜å®¹å™¨åŒ–åº”ç”¨ç¨‹åºçš„æ–¹å¼ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä»Šå¤©ï¼Œæˆ‘æƒ³å±•ç¤ºä¸€ç§å®ç”¨ä¸”æœ‰è¶£çš„ä½¿ç”¨ Docker çš„æ–¹å¼ï¼šåœ¨å®¹å™¨ä¸­ä½¿ç”¨ WebAssemblyã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘è¯´â€œå®ç”¨çš„æ–¹å¼â€ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘å‡è®¾æ‚¨æœ‰ä¸€äº›ç»éªŒï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Dockerï¼ˆå½“ç„¶ï¼‰&lt;/li&gt;
&lt;li&gt;Rustï¼ˆå®é™…ä¸Šï¼Œåªæ˜¯ä¸ºäº†ç†è§£â€œHello Worldâ€ï¼‰&lt;/li&gt;
&lt;li&gt;WebAssemblyï¼›åªéœ€è¦å¯¹å…¶æœ‰ä¸€ä¸ªåŸºæœ¬çš„äº†è§£ï¼ˆæ³¨æ„ï¼šæˆ‘å°†åœ¨è®¨è®ºä¸­äº¤æ›¿ä½¿ç”¨ WASM å’Œ WebAssembly è¿™ä¸¤ä¸ªæœ¯è¯­ï¼‰&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å…³äºæˆ‘å³å°†å±•ç¤ºçš„å†…å®¹ï¼Œç®€å•è¯´ä¸€ä¸‹ï¼šä¸€ä¸ª Docker å®¹å™¨æ˜¯ä¸€ä¸ªåŒ…å«è¿è¡Œç¯å¢ƒçš„æ˜ åƒçš„è¿è¡Œå®ä¾‹ã€‚è¿è¡Œç¯å¢ƒé€šå¸¸æ˜¯ä¸€ä¸ªæ“ä½œç³»ç»Ÿï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹æ˜¯ Linuxã€‚æ“ä½œç³»ç»Ÿæ˜¯è¿è¡Œåº”ç”¨ç¨‹åºçš„å¿…è¦æ¡ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæˆ‘ä»¬èƒ½å¤Ÿåœ¨æœ€å°åŒ–ä¾èµ–å…³ç³»çš„æƒ…å†µä¸‹è¿è¡Œåº”ç”¨ç¨‹åºï¼Œç”šè‡³ä¸éœ€è¦ä»»ä½•ä¾èµ–å…³ç³»ï¼Œä¼šæ€æ ·å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;è¿™å°±æ˜¯æˆ‘æƒ³è°ˆè®ºçš„æƒ³æ³•ï¼šä½¿ç”¨ WASMï¼Œä»¥åŠ Docker ä¸­ï¼ˆç›®å‰æµ‹è¯•ç‰ˆï¼‰çš„æ”¯æŒï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªä¸å«ä»»ä½•æ“ä½œç³»ç»ŸåŸºç¡€é•œåƒçš„å®¹å™¨ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä¸ºä»€ä¹ˆæ˜¯-webassembly-å®¹å™¨&#34;&gt;ä¸ºä»€ä¹ˆæ˜¯ WebAssembly å®¹å™¨ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;å¼•ç”¨ Docker çš„ä½œè€… Solomon Hykes çš„è¯ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;â€œå¦‚æœ WASM+WASI åœ¨ 2008 å¹´å°±å­˜åœ¨äº†ï¼Œæˆ‘ä»¬å°±ä¸éœ€è¦åˆ›é€  Docker äº†ã€‚â€&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿™å¯èƒ½è¶³å¤Ÿäº†ï¼Œä½†è®©æˆ‘ä»¬åˆ—ä¸¾ä¸€äº›å…·ä½“çš„å¥½å¤„ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®‰å…¨æ€§&lt;/strong&gt;ï¼šä»…éƒ¨ç½²æˆ‘ä»¬çš„ä»£ç å¯ä»¥å‡å°‘â€œæ”»å‡»é¢â€ï¼Œä»è€Œæé«˜æ•´ä½“å®‰å…¨æ€§&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤§å°&lt;/strong&gt;ï¼šæˆ‘ä»¬å¯ä»¥åˆ›å»ºæ¯”ç­‰æ•ˆäºå¸¦æœ‰æ“ä½œç³»ç»Ÿçš„åº”ç”¨ç¨‹åºæ›´å°å¾—å¤šçš„å®¹å™¨&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½&lt;/strong&gt;ï¼šå¦‚æ‚¨æ‰€æ–™ï¼Œæ²¡æœ‰æ“ä½œç³»ç»Ÿå±‚ï¼ŒWASM å®¹å™¨å¯ä»¥è¡¨ç°å‡ºæ›´å¥½çš„æ€§èƒ½ï¼ˆä¸æ€»æ˜¯æ­£ç¡®çš„ï¼Œä½†å¹³å‡è€Œè¨€æ˜¯æ­£ç¡®çš„ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¶æ„ä¸­ç«‹æ€§&lt;/strong&gt;ï¼šDocker å®¹å™¨æ˜¯ä¸ºç‰¹å®šç›®æ ‡æ¶æ„ï¼ˆarmã€x86 ç­‰ï¼‰ç¼–è¯‘çš„ï¼Œåªèƒ½åœ¨å…·æœ‰ç›¸åŒæ¶æ„çš„ä¸»æœºä¸Šè¿è¡Œã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒWebAssembly æ˜¯æ¶æ„ä¸­ç«‹çš„ï¼Œè¿™æ„å‘³ç€åªè¦è¿è¡Œæ—¶å¯ç”¨ï¼Œåº”ç”¨ç¨‹åºå°±å¯ä»¥åœ¨ä»»ä½•åº•å±‚æ¶æ„ä¸Šè¿è¡Œã€‚è¿™æä¾›äº†å‡ ä¸ªä¼˜ç‚¹ï¼Œä¾‹å¦‚åœ¨ä¸éœ€è¦é‡æ–°ç¼–è¯‘çš„æƒ…å†µä¸‹åœ¨å¤šä¸ªå¹³å°ä¸Šè¿è¡Œç›¸åŒçš„ä»£ç ä»¥åŠåœ¨ä»¥å‰ä¸å—æ”¯æŒçš„å¹³å°ä¸Šè¿è¡Œä»£ç çš„èƒ½åŠ›ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ€»ä¹‹ï¼Œä½¿ç”¨ WebAssembly å®¹å™¨æœ‰ä¸€äº›æœ‰è¶£çš„å¥½å¤„ï¼&lt;/p&gt;
&lt;h2 id=&#34;è®©æˆ‘ä»¬å¼€å§‹å§&#34;&gt;è®©æˆ‘ä»¬å¼€å§‹å§&lt;/h2&gt;
&lt;p&gt;æœ¬æ–‡å°†é«˜åº¦å®ç”¨ï¼Œåªæ¶‰åŠè¯¥ä¸»é¢˜çš„è¡¨é¢ï¼Œå¹¶ç•™ä¸‹è®¸å¤šç»†èŠ‚ã€‚è¿™äº›ç»†èŠ‚å°†åœ¨å°†æ¥çš„æ–‡ç« ä¸­æ·±å…¥æ¢è®¨ï¼Œå°½ç®¡å·²ç»æœ‰è®¸å¤šå¾ˆå¥½çš„èµ„æºå¯ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;è®©æˆ‘ä»¬ä»ä¸€ä¸ªåŸºæœ¬åº”ç”¨ç¨‹åºå¼€å§‹ã€‚å°½ç®¡åœ¨è¿™ä¸ªä¾‹å­ä¸­æ˜¯ç”¨ Rust ç¼–å†™çš„ï¼Œä½†ä½¿ç”¨çš„è¯­è¨€å¹¶ä¸é‡è¦ï¼Œåªè¦å®ƒæ”¯æŒ WebAssembly ä½œä¸ºç¼–è¯‘ç›®æ ‡å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;å‡è®¾åœ¨è®¡ç®—æœºä¸Šå·²ç»å®‰è£…äº† Rustï¼ˆ&lt;a href=&#34;https://www.rust-lang.org/tools/install&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¦‚æœæ²¡æœ‰&lt;/a&gt;ï¼‰ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨ &lt;code&gt;cargo new rust-wasm-docker&lt;/code&gt; åˆ›å»ºä¸€ä¸ªæ–°çš„ Rust åº”ç”¨ç¨‹åº&lt;/p&gt;
&lt;p&gt;è¿™å°†åˆ›å»ºæœ€å°åŒ–çš„ Rust åº”ç”¨ç¨‹åºç»“æ„ã€‚&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;total 8
drwxr-xr-x@ 3 fabrizio  staff   96 Jan 12 20:55 src
-rw-r--r--@ 1 fabrizio  staff  186 Jan 12 20:55 Cargo.toml
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æˆ‘ä»¬å¯ä»¥ä¿ç•™æä¾›çš„æœ€å°åº”ç”¨ç¨‹åºä»£ç ï¼Œè¿™æ˜¯ä¸€ä¸ªç›¸å½“å¸¸è§å’Œæ˜“è¯»çš„â€œHello Worldâ€ã€‚&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;# cat src/main.rs
fn main() {
    println!(&amp;#34;Hello, world!&amp;#34;);
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è®©æˆ‘ä»¬å°è¯•ä½¿ç”¨ &lt;code&gt;cargo run&lt;/code&gt; è¿è¡Œï¼Œè¾“å‡ºåº”è¯¥æ˜¯â€œHello, world!â€ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å¸¸è§çš„-docker-æ–¹å¼&#34;&gt;å¸¸è§çš„ Docker æ–¹å¼&lt;/h2&gt;
&lt;p&gt;å¦‚æœæ²¡æœ‰ WebAssembly çš„æ–¹æ³•ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ª Docker é•œåƒï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;FROM rust:latest

WORKDIR /usr/src/myapp
COPY . .

RUN cargo install --path .

CMD [&amp;#34;wasm-docker-hello&amp;#34;]
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„ &lt;code&gt;Dockerfile&lt;/code&gt; ï¼Œå®ƒä½¿ç”¨ Docker Hub çš„ &lt;code&gt;rust&lt;/code&gt; åŸºæœ¬é•œåƒï¼Œå°†æºä»å½“å‰ä¸»æœºç›®å½•å¤åˆ¶åˆ°é•œåƒä¸­çš„ &lt;code&gt;/usr/src/myapp&lt;/code&gt; ï¼Œè¿è¡Œ &lt;code&gt;cargo install&lt;/code&gt; æ¥ç¼–è¯‘åº”ç”¨ç¨‹åºï¼Œæœ€ç»ˆå°†åº”ç”¨ç¨‹åºäºŒè¿›åˆ¶æ–‡ä»¶å®šä¹‰ä¸ºå®¹å™¨å‘½ä»¤ã€‚&lt;/p&gt;
&lt;p&gt;å‡è®¾ Docker å·²ç»å®‰è£…åœ¨è®¡ç®—æœºä¸Šï¼ˆ&lt;a href=&#34;https://docs.docker.com/get-docker/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¦‚æœæ²¡æœ‰&lt;/a&gt;ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åˆ›å»ºä¸€ä¸ªé•œåƒï¼š &lt;code&gt;docker build -t hello-docker .&lt;/code&gt; è¯¥å‘½ä»¤ä½¿ç”¨å½“å‰ç›®å½•ä¸­çš„ Dockerfile æ„å»ºé•œåƒï¼Œå¹¶å°†å…¶æ ‡è®°ä¸ºâ€œhello-dockerâ€ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åï¼Œåœ¨æ„å»ºé•œåƒåï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ &lt;code&gt;docker run hello-world&lt;/code&gt; è¿è¡Œå®ƒã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# docker run hello-docker&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Hello, world!
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç°åœ¨ï¼Œè®©æˆ‘ä»¬å°è¯•è¿›è¡Œå¦ä¸€ä¸ªå¿«é€Ÿæµ‹è¯•ï¼Œç¨ååœ¨æœ¬æ–‡ä¸­æ›´æ¸…æ¥šåœ°è¯´æ˜ WebAssembly å®¹å™¨çš„åŒºåˆ«ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ &lt;code&gt;bash&lt;/code&gt; shell è¦†ç›–é»˜è®¤å‘½ä»¤æ¥è¿è¡Œæˆ‘ä»¬çš„é•œåƒã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker run -it hello-docker bash
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;root@be1902d5e9b6:/usr/src/myapp#
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¾“å‡ºå¯èƒ½ç•¥æœ‰ä¸åŒï¼Œå› ä¸ºå®¹å™¨ IDï¼ˆbe1902d5e9b6ï¼‰åœ¨æ¯æ¬¡è¿è¡Œå®¹å™¨æ—¶éƒ½æ˜¯éšæœºç”Ÿæˆçš„ã€‚æ— è®ºå¦‚ä½•ï¼Œè¿™é‡Œçš„é‡è¦ç‚¹æ˜¯ï¼Œæ‚¨å¯ä»¥è·å–ä¸€ä¸ª shell ä¸ä¹‹äº¤äº’ï¼Œå°±åƒåœ¨ä»»ä½•å¸¸è§çš„ Linux æœºå™¨ä¸Šä¸€æ ·ã€‚&lt;/p&gt;
&lt;h2 id=&#34;èµ°è¿›-webassembly&#34;&gt;èµ°è¿› WebAssembly&lt;/h2&gt;
&lt;p&gt;ç°åœ¨ï¼Œè®©æˆ‘å›é¡¾ä¸€ä¸‹æˆ‘ä»¬åˆ°ç›®å‰ä¸ºæ­¢æ‰€åšçš„äº‹æƒ…ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªéå¸¸ï¼ˆéå¸¸ï¼‰ç®€å•çš„ Rust åº”ç”¨ç¨‹åº&lt;/li&gt;
&lt;li&gt;æˆ‘ä»¬åœ¨ä¸»æœºæœºå™¨ä¸Šæ„å»ºå’Œè¿è¡Œäº†è¯¥åº”ç”¨ç¨‹åº&lt;/li&gt;
&lt;li&gt;æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª &lt;code&gt;Dockerfile&lt;/code&gt; æ¥æ„å»ºåº”ç”¨ç¨‹åºå’Œé•œåƒ&lt;/li&gt;
&lt;li&gt;æˆ‘ä»¬é€šè¿‡æˆåŠŸè¿è¡Œå®ƒæ¥æµ‹è¯•äº† Docker é•œåƒçš„åŠŸèƒ½&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ¥ä¸‹æ¥å‘¢ï¼Ÿç›®æ ‡æ˜¯ä»…ä½¿ç”¨æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºåˆ›å»ºä¸€ä¸ª docker é•œåƒã€‚è¦éå¸¸æ˜ç¡®ï¼šè¿™æ„å‘³ç€ä¸€ä¸ªä¸å«ä»»ä½•æ“ä½œç³»ç»Ÿçš„é•œåƒä½œä¸ºè¿è¡Œç¯å¢ƒã€‚å®é™…ä¸Šï¼Œæˆ‘è¿è¡Œäº† &lt;code&gt;docker run -it hello-docker bash&lt;/code&gt; æ¥å±•ç¤ºæˆ‘ä»¬åˆ›å»ºçš„é•œåƒå®é™…ä¸Šæ˜¯ä¸€ä¸ªå¸¦æœ‰æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºæ†ç»‘çš„ Linux è¿è¡Œç¯å¢ƒã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ç»§ç»­ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦é…ç½®ä¸€äº›å·¥å…·ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å¿…é¡»è®¾ç½®ç¼–è¯‘ WebAssembly + WASI çš„èƒ½åŠ›ï¼Œç„¶åå¯ç”¨å®éªŒæ€§çš„ Docker åŠŸèƒ½ä»¥è¿è¡Œ WASM å®¹å™¨ã€‚&lt;/p&gt;
&lt;p&gt;è®©æˆ‘ä»¬å¼€å§‹ä½¿ç”¨ &lt;code&gt;rustup target add wasm32-wasi&lt;/code&gt; å®‰è£… WASIã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;WASIï¼ˆWebAssembly ç³»ç»Ÿæ¥å£ï¼‰æ˜¯ä¸€ç»„è§„èŒƒå’Œ APIï¼Œæä¾›äº†æ‰§è¡Œ WebAssembly ä»£ç çš„æ ‡å‡†æ¥å£ï¼Œè¿™äº›ä»£ç ä¸åœ¨ Web æµè§ˆå™¨ä¸­è¿è¡Œï¼Œä¾‹å¦‚åœ¨æœåŠ¡å™¨æˆ–ç‹¬ç«‹åº”ç”¨ç¨‹åºä¸­è¿è¡Œã€‚å®ƒå…è®¸ WebAssembly æ¨¡å—è®¿é—®ç³»ç»Ÿèµ„æºï¼Œå¦‚æ–‡ä»¶ç³»ç»Ÿå’Œç½‘ç»œï¼Œå¹¶æä¾›å®‰å…¨çš„æ²™ç®±ç¯å¢ƒã€‚å®ƒæä¾›äº†ä½¿ WebAssembly æˆä¸ºç‹¬ç«‹å¯æ‰§è¡Œæ ¼å¼æ‰€éœ€çš„å…³é”®åŠŸèƒ½ï¼Œä½¿å…¶èƒ½å¤Ÿç”¨äºå„ç§è¶…è¶Š Web çš„åœºæ™¯ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åˆ°ç›®å‰ä¸ºæ­¢ä¸€åˆ‡é¡ºåˆ©ï¼ç°åœ¨å¯ä»¥è¿è¡Œ &lt;code&gt;cargo build --target wasm32-wasi&lt;/code&gt; ç¼–è¯‘ WebAssemblyã€‚å¦‚æœå°è¯•ï¼Œæˆ‘ä»¬å°†åœ¨ &lt;code&gt;target/wasm32-wasi/debug&lt;/code&gt; ç›®å½•ä¸­è·å¾—ä¸€ä¸ªåä¸º &lt;code&gt;wasm-docker-hello.wasm&lt;/code&gt; çš„æ–‡ä»¶ã€‚å¾ˆå¥½ï¼Œä½†æ˜¯æˆ‘ä»¬è¯¥å¦‚ä½•è¿è¡Œæ­¤äºŒè¿›åˆ¶æ–‡ä»¶ï¼Ÿå°è¯•åƒæ™®é€šå¯æ‰§è¡Œæ–‡ä»¶ä¸€æ ·æ‰§è¡Œå®ƒï¼Œå¦‚ &lt;code&gt;. ./target/wasm32-wasi/debug/wasm-docker-hello.wasm&lt;/code&gt;ï¼Œæˆ‘ä»¬ä¼šæ”¶åˆ°é”™è¯¯ï¼Œä¸ºä»€ä¹ˆï¼Ÿå®é™…ä¸Šï¼Œé”™è¯¯æ˜¯ä¸è¨€è‡ªæ˜çš„ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;zsh: &lt;span class=&#34;nb&#34;&gt;exec&lt;/span&gt; format error: ./target/wasm32-wasi/debug/wasm-docker-hello.wasm
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;wasm æ–‡ä»¶ä¸æ˜¯ä¸ºæˆ‘ä»¬ä¸»æœºçš„æœ¬æœºæ¶æ„ï¼ˆæ— è®ºæ˜¯ x86_64ã€arm è¿˜æ˜¯å…¶ä»–ï¼‰æ„å»ºçš„ã€‚æˆ‘ä»¬éœ€è¦ä¸€ä¸ª &lt;strong&gt;WebAssembly è¿è¡Œæ—¶&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;webassembly-è¿è¡Œæ—¶å°†-wasm-å¸¦åˆ°å„å¤„&#34;&gt;WebAssembly è¿è¡Œæ—¶ï¼šå°† WASM å¸¦åˆ°å„å¤„&lt;/h2&gt;
&lt;p&gt;æœ‰è®¸å¤š WASM è¿è¡Œæ—¶ã€‚WebAssembly æœ€åˆæ˜¯ä¸ºåœ¨ Web æµè§ˆå™¨ä¸­ä½¿ç”¨è€Œè®¾è®¡çš„ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¿è¡Œæ—¶ä¸éœ€è¦ï¼Œå› ä¸º &lt;strong&gt;æµè§ˆå™¨å……å½“è¿è¡Œæ—¶&lt;/strong&gt;ã€‚ä½†æ˜¯ï¼Œåœ¨åˆ›å»ºå‘½ä»¤è¡Œåº”ç”¨ç¨‹åºçš„æƒ…å†µä¸‹ï¼Œéœ€è¦è¿è¡Œæ—¶ï¼Œå¯¹äºå®Œæ•´çš„åº”ç”¨ç¨‹åºã€æœåŠ¡å™¨ç­‰ä¹Ÿæ˜¯å¦‚æ­¤ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å°†å®‰è£… &lt;strong&gt;WasmEdge&lt;/strong&gt;ï¼Œè¿™æ˜¯ Docker ç”¨äºæ‰§è¡Œæˆ‘ä»¬çš„ WASM é•œåƒçš„è¿è¡Œæ—¶ã€‚å¦‚æœæ‚¨åœ¨ Mac OS æˆ– Linux æœºå™¨ä¸Šï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿›è¡Œå®‰è£…ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;curl -sSf &amp;lt;https://raw.githubusercontent.com/WasmEdge/WasmEdge/master/utils/install.sh&amp;gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; bash
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¦‚éœ€å®Œæ•´çš„å®‰è£…è¯´æ˜ï¼ˆåŒ…æ‹¬ Windowsï¼‰ï¼Œè¯·åœ¨æ­¤å¤„æŸ¥çœ‹ &lt;a href=&#34;https://wasmedge.org/book/en/quick_start/install.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://wasmedge.org/book/en/quick_start/install.html&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å¯ç”¨-dockerwasm-é›†æˆ&#34;&gt;å¯ç”¨ Docker+WASM é›†æˆ&lt;/h2&gt;
&lt;p&gt;æœ€åä¸€æ­¥æ˜¯å¯ç”¨ Docker ä¸­çš„ WASM æ”¯æŒï¼Œè¿™æ˜¯ç›®å‰çš„å®éªŒæ€§åŠŸèƒ½ã€‚å¯ä»¥é€šè¿‡å¯ç”¨ containerd é•œåƒå­˜å‚¨åº“æ¥å®Œæˆæ­¤æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ Docker Desktopï¼Œåªéœ€åœ¨è®¾ç½®é¡µé¢ä¸­æ‰“å¼€è¯¥åŠŸèƒ½å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/docker-wasm-quick-intro/ui_huf50248a121f857a9401ba6bd403cd5b5_288921_1f5bcea6a397ca44a5fd4cb6d635d567.webp 400w,
               /blog/docker-wasm-quick-intro/ui_huf50248a121f857a9401ba6bd403cd5b5_288921_7a46c8ed22385a848fca2867156a844e.webp 760w,
               /blog/docker-wasm-quick-intro/ui_huf50248a121f857a9401ba6bd403cd5b5_288921_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/docker-wasm-quick-intro/ui_huf50248a121f857a9401ba6bd403cd5b5_288921_1f5bcea6a397ca44a5fd4cb6d635d567.webp&#34;
               width=&#34;760&#34;
               height=&#34;357&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;è¯¦ç»†è¯´æ˜å¯ä»¥åœ¨æ­¤å¤„æ‰¾åˆ° &lt;a href=&#34;https://docs.docker.com/desktop/wasm/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://docs.docker.com/desktop/wasm/&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å‡†å¤‡åˆ›å»ºæ— æ“ä½œç³»ç»Ÿçš„å®¹å™¨&#34;&gt;å‡†å¤‡åˆ›å»ºâ€œæ— æ“ä½œç³»ç»Ÿâ€œçš„å®¹å™¨&lt;/h2&gt;
&lt;p&gt;ç°åœ¨æˆ‘ä»¬å·²ç»å‡†å¤‡å¥½åˆ›å»ºä¸€ä¸ªæ–°çš„ Dockerfileï¼ˆæˆ‘ä»¬å°†å…¶å‘½åä¸º &lt;code&gt;Dockerfile.wasm&lt;/code&gt; ä»¥åŒºåˆ†å®ƒä¸ä»¥å‰çš„æ–‡ä»¶ï¼‰ï¼Œå†…å®¹å¦‚ä¸‹ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;FROM scratch
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;COPY target/wasm32-wasi/debug/wasm-docker-hello.wasm /app.wasm
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ENTRYPOINT &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;app.wasm&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å®ƒéå¸¸ç®€çŸ­å’Œæ˜“æ‡‚ï¼Œä½†æœ‰å‡ ä¸ªè¦ç‚¹éœ€è¦å¼ºè°ƒï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å®ƒä»¥â€œFROM scratchâ€å¼€å§‹ï¼Œè¡¨ç¤ºè¯¥é•œåƒæ˜¯ä»å¤´å¼€å§‹æ„å»ºçš„ï¼Œä¸ä¼šç»§æ‰¿ä»»ä½•æ“ä½œç³»ç»Ÿç¯å¢ƒ&lt;/li&gt;
&lt;li&gt;æˆ‘ä»¬å°†ç¼–è¯‘åçš„äºŒè¿›åˆ¶æ–‡ä»¶å¤åˆ¶åˆ°é•œåƒä¸­ï¼Œåœ¨å‰ä¸€ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å¤åˆ¶äº†æºæ–‡ä»¶å¹¶åœ¨æ„å»ºé•œåƒè¿‡ç¨‹ä¸­å¯¹å…¶è¿›è¡Œäº†ç¼–è¯‘ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨å·²ç»ç¼–è¯‘å¥½çš„ï¼ˆåœ¨ä¸»æœºä¸Šï¼‰wasm äºŒè¿›åˆ¶æ–‡ä»¶&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ENTRYPOINT&lt;/code&gt; æ˜¯äºŒè¿›åˆ¶æ–‡ä»¶æœ¬èº«ï¼Œè¿™é‡Œæ²¡æœ‰æŒ‡å®šè¿è¡Œæ—¶&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ„å»ºæˆ‘ä»¬çš„é•œåƒï¼Œæ–¹å¼ä¸æˆ‘ä»¬ä¸ºâ€œé€šç”¨â€é•œåƒæ‰€åšçš„æ–¹å¼ç›¸åŒã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker build -t wasm-docker -f Dockerfile.wasm .
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¹Ÿè®¸æœ‰äººå·²ç»æ³¨æ„åˆ°äº†ä¸€ä¸ªæœ‰è¶£çš„ç‚¹ï¼šDocker å¦‚ä½•çŸ¥é“åœ¨ ENTRYPOINT æŒ‡å‘.wasm äºŒè¿›åˆ¶æ–‡ä»¶çš„é•œåƒä¸­ä½¿ç”¨ &lt;strong&gt;WasmEdge&lt;/strong&gt; ä½œä¸ºè¿è¡Œæ—¶ï¼Ÿæˆ‘ä»¬å·²ç»æµ‹è¯•è¿‡ï¼Œç›´æ¥è¿è¡Œ.wasm æ–‡ä»¶ä¸èµ·ä½œç”¨ã€‚&lt;/p&gt;
&lt;p&gt;å®é™…ä¸Šæ²¡æœ‰ï¼Œæˆ‘ä»¬éœ€è¦åœ¨å¯åŠ¨å®¹å™¨æ—¶æŒ‡å®šè¿è¡Œæ—¶ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker run --runtime&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;io.containerd.wasmedge.v1 --platform&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;wasi/wasm32 b678ba11b941
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æˆ‘ä»¬æŒ‡å®š &lt;code&gt;--runtime&lt;/code&gt; å‘Šè¯‰ Docker ä½¿ç”¨ WasmEdge ä½œä¸ºè¿è¡Œæ—¶ï¼Œå¹¶æŒ‡å®š &lt;code&gt;--platform&lt;/code&gt; ä½¿ç”¨ WASI æ¥å£ä½œä¸ºå¹³å°ã€‚å°±è¿™æ ·ï¼Œå¦‚æœæ‚¨æŒ‰ç…§æ‰€æœ‰æ­¥éª¤æ“ä½œï¼Œæ‚¨åº”è¯¥çœ‹åˆ°ä¸€ä¸ªä»¤äººå…´å¥‹çš„â€œHello, world!â€ã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶ï¼Œæˆ‘æ˜¯å¼€ç©ç¬‘çš„ï¼Œæ¯”è¾ƒé•œåƒå¤§å°ä½¿ç”¨ &lt;code&gt;docker images&lt;/code&gt; å‘½ä»¤å¯ä»¥çœ‹åˆ°æ›´æœ‰è¶£çš„ç»“æœã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;REPOSITORY                  TAG       IMAGE ID       CREATED         SIZE
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;hello-docker                latest    e9ed5014b408   &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; seconds ago   544MB
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;wasm-docker                 latest    b678ba11b941   &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; seconds ago   507kB
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;hello-docker&lt;/code&gt; æ˜¯æˆ‘ä»¬åœ¨å¼€å§‹æ—¶æ„å»ºçš„é•œåƒï¼Œå°ºå¯¸å·®å¼‚å·¨å¤§ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç»“è®º&#34;&gt;&lt;strong&gt;ç»“è®º&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬æ¯”è¾ƒäº†æ ‡å‡† Docker å®¹å™¨å’Œ WASM å®¹å™¨ã€‚æ ‡å‡† Docker å®¹å™¨å’Œ WebAssembly å®¹å™¨éƒ½æœ‰å„è‡ªç‹¬ç‰¹çš„ä¼˜ç‚¹å’Œé™åˆ¶ï¼Œä½† WASM æ­£åœ¨å±•ç¤ºæˆä¸ºä¸€ç§é«˜åº¦æœ‰å‰é€”çš„å®¹å™¨åŒ–æŠ€æœ¯ï¼Œå°¤å…¶æ˜¯å¯¹äºæŸäº›ç”¨ä¾‹ã€‚ä¸æ ‡å‡† Docker å®¹å™¨ç›¸æ¯”ï¼ŒWebAssembly æä¾›äº†æ€§èƒ½ä¼˜åŠ¿ï¼Œä¾‹å¦‚æ›´å¿«çš„å¯åŠ¨æ—¶é—´ã€æ›´ä½çš„å†…å­˜ä½¿ç”¨ç‡ä»¥åŠä»£ç å’Œä¸»æœºç³»ç»Ÿä¹‹é—´æ›´å¥½çš„éš”ç¦»ã€‚æ­¤å¤–ï¼ŒWebAssembly æ˜¯æ¶æ„ä¸­ç«‹çš„ï¼Œè¿™æ„å‘³ç€åªè¦è¿è¡Œæ—¶å¯ç”¨ï¼Œåº”ç”¨ç¨‹åºå°±å¯ä»¥åœ¨ä»»ä½•åº•å±‚æ¶æ„ä¸Šè¿è¡Œã€‚è¿™æä¾›äº†å¤šç§ä¼˜åŠ¿ï¼Œä¾‹å¦‚åœ¨å¤šä¸ªå¹³å°ä¸Šè¿è¡Œç›¸åŒçš„ä»£ç è€Œæ— éœ€é‡æ–°ç¼–è¯‘ï¼Œå¹¶èƒ½åœ¨ä»¥å‰ä¸æ”¯æŒçš„å¹³å°ä¸Šè¿è¡Œä»£ç ã€‚ç”šè‡³å¯ä»¥åœ¨è¯¸å¦‚ç‰©è”ç½‘ã€è¾¹ç¼˜è®¡ç®—ç­‰å—é™è®¾å¤‡ä¸Šæ‰©å±•å®¹å™¨çš„ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶è€Œï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒWebAssembly ä»å¤„äºæ—©æœŸé˜¶æ®µï¼Œå°šä¸æˆç†Ÿï¼Œå°šä¸å…·å¤‡å¹¿æ³›é‡‡ç”¨çš„æ¡ä»¶ã€‚å°½ç®¡å¦‚æ­¤ï¼Œé‡è¦çš„æ˜¯è¦å…³æ³¨è¿™é¡¹æŠ€æœ¯ï¼Œå› ä¸ºå®ƒæœ‰æ½œåŠ›å½»åº•æ”¹å˜æˆ‘ä»¬å®¹å™¨åŒ–åº”ç”¨ç¨‹åºçš„æ–¹å¼ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>åˆåˆ›å…¬å¸ Fermyon å‘å¸ƒ Spin 1.0 ç”¨äº WebAssembly æ— æœåŠ¡å™¨åº”ç”¨</title>
      <link>https://lib.jimmysong.io/blog/spin-wasm-ga/</link>
      <pubDate>Thu, 13 Apr 2023 16:27:22 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/spin-wasm-ga/</guid>
      <description>&lt;p&gt;æœ¬æ–‡è¯‘è‡ªï¼š&lt;a href=&#34;https://www.infoq.com/news/2023/04/first-version-spin-wasm/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Startup Fermyon Releases Spin 1.0 for WebAssembly Serverless Applications&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.fermyon.com/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Fermyon&lt;/a&gt; æœ€è¿‘å®£å¸ƒæ¨å‡º &lt;a href=&#34;https://github.com/fermyon/spin/releases/tag/v1.0.0&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Spin 1.0&lt;/a&gt;ï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨äºä½¿ç”¨ &lt;a href=&#34;https://webassembly.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;WebAssembly&lt;/a&gt; (Wasm) å¼€å‘æ— æœåŠ¡å™¨åº”ç”¨çš„å¼€æºå¼€å‘è€…å·¥å…·å’Œæ¡†æ¶ã€‚&lt;/p&gt;
&lt;p&gt;Spin 1.0 æ˜¯å…¶å»å¹´æ¨å‡º &lt;a href=&#34;https://www.fermyon.com/blog/introducing-spin&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä»‹ç»&lt;/a&gt; åçš„é¦–ä¸ªç¨³å®šç‰ˆæœ¬ã€‚åœ¨ 1.0 ç‰ˆæœ¬ä¸­ï¼Œå…¬å¸å¢åŠ äº†å¯¹æ–°ç¼–ç¨‹è¯­è¨€ï¼ˆå¦‚ JavaScriptã€TypeScriptã€Python æˆ– C#ï¼Œé™¤äº† Rust å’Œ Go ä¹‹å¤–ï¼‰ã€è¿æ¥æ•°æ®åº“ï¼ˆ&lt;a href=&#34;https://developer.fermyon.com/spin/rdbms-storage&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å…³ç³»å‹&lt;/a&gt; æˆ– &lt;a href=&#34;https://developer.fermyon.com/spin/redis-outbound&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Redis&lt;/a&gt;ï¼‰ã€ä½¿ç”¨æµè¡Œçš„æ³¨å†Œè¡¨æœåŠ¡åˆ†å‘åº”ç”¨ç¨‹åºï¼ˆ&lt;a href=&#34;https://ghcr.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;GitHub Container Registry&lt;/a&gt;ã€&lt;a href=&#34;https://hub.docker.com/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Docker Hub&lt;/a&gt; æˆ– &lt;a href=&#34;https://aws.amazon.com/ecr/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;AWS ECR&lt;/a&gt;ï¼‰ã€å†…ç½®çš„ &lt;a href=&#34;https://developer.fermyon.com/spin/kv-store&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;é”®å€¼å­˜å‚¨&lt;/a&gt; ä»¥ä¿æŒçŠ¶æ€ã€åœ¨ Kubernetes ä¸Šè¿è¡Œåº”ç”¨ç¨‹åºä»¥åŠä¸ &lt;a href=&#34;https://www.hashicorp.com/products/vault&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;HashiCorp Vault&lt;/a&gt; é›†æˆä»¥ç®¡ç†è¿è¡Œæ—¶é…ç½®ç­‰æ–¹é¢çš„æ”¯æŒã€‚&lt;/p&gt;
&lt;p&gt;é€šè¿‡ Spinï¼Œè¯¥å…¬å¸ä¸ºåˆ›å»ºè¿è¡Œ Wasm çš„åº”ç”¨ç¨‹åºæä¾›äº†è½»æ¾çš„å¼€å‘ä½“éªŒï¼ŒåŒ…æ‹¬éƒ¨ç½²å’Œå®‰å…¨è¿è¡Œå®ƒä»¬çš„æ¡†æ¶ã€‚&lt;/p&gt;
&lt;p&gt;Fermyon çš„é¦–å¸­æŠ€æœ¯å®˜ &lt;a href=&#34;https://twitter.com/matei_radu&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Radu Matei&lt;/a&gt; åœ¨ä¸€ç¯‡ &lt;a href=&#34;https://www.fermyon.com/blog/introducing-spin-v1&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;åšå®¢æ–‡ç« &lt;/a&gt; ä¸­è§£é‡Šé“ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Spin æ˜¯ä¸€ä¸ªå¼€æºçš„å¼€å‘è€…å·¥å…·å’Œæ¡†æ¶ï¼Œå®ƒå¸®åŠ©ç”¨æˆ·é€šè¿‡åˆ›å»ºã€æ„å»ºã€åˆ†å‘å’Œè¿è¡Œ Wasm çš„æ— æœåŠ¡å™¨åº”ç”¨ç¨‹åºã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ spin new åŸºäºèµ·å§‹æ¨¡æ¿åˆ›å»ºæ–°çš„åº”ç”¨ç¨‹åºï¼Œä½¿ç”¨ spin build å°†æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºç¼–è¯‘ä¸º Wasmï¼Œä½¿ç”¨ spin up åœ¨æœ¬åœ°è¿è¡Œåº”ç”¨ç¨‹åºã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/spin-wasm-ga/spin_huefc6270495e645aa615bde9e63e74048_206543_ed0bf52344ca50087edcabec354fab5a.webp 400w,
               /blog/spin-wasm-ga/spin_huefc6270495e645aa615bde9e63e74048_206543_b6a30d18d4ac6db3d72d36b8e309c6b0.webp 760w,
               /blog/spin-wasm-ga/spin_huefc6270495e645aa615bde9e63e74048_206543_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/spin-wasm-ga/spin_huefc6270495e645aa615bde9e63e74048_206543_ed0bf52344ca50087edcabec354fab5a.webp&#34;
               width=&#34;760&#34;
               height=&#34;369&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;&lt;em&gt;æ¥æºï¼š&lt;a href=&#34;https://www.fermyon.com/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://www.fermyon.com/&lt;/a&gt;&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;é™¤äº†åœ¨æœ¬åœ°è¿è¡Œ spin åº”ç”¨ç¨‹åºå¤–ï¼Œå¼€å‘äººå‘˜è¿˜å¯ä»¥å°†åº”ç”¨ç¨‹åºéƒ¨ç½²åˆ° &lt;a href=&#34;https://www.fermyon.com/cloud&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Fermyon äº‘&lt;/a&gt;ï¼ˆ&lt;a href=&#34;https://www.infoq.com/news/2022/11/Fermyon-cloud-webassembly/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å»å¹´å…¬å¼€æµ‹è¯•ç‰ˆå‘å¸ƒ&lt;/a&gt;ï¼‰ã€‚åœ¨ç™»å½• Fermyon Cloud åï¼Œä»–ä»¬å¯ä»¥åœ¨å­˜æ”¾å…¶åº”ç”¨ç¨‹åºçš„ spin.&lt;a href=&#34;https://toml.io/en/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;toml æ–‡ä»¶&lt;/a&gt; æ‰€åœ¨ç›®å½•ä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥éƒ¨ç½²å…¶åº”ç”¨ç¨‹åºï¼š&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;$ spin deploy&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æ­¤å¤–ï¼Œå¼€å‘äººå‘˜è¿˜å¯ä»¥é€‰æ‹© &lt;a href=&#34;https://developer.fermyon.com/spin/distributing-apps&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å°†åº”ç”¨ç¨‹åºæ¨é€åˆ°å®¹å™¨æ³¨å†Œè¡¨&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;InfoQ çš„ä¸€ä¸ª &lt;a href=&#34;https://www.infoq.com/podcasts/cloud-computing-web-assembly/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ’­å®¢&lt;/a&gt; ä¸­æåˆ°çš„ä¸€ä¸ªå…³é”®ç‚¹æ˜¯ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Spin æ˜¯ Fermyon çš„ä¸€ä¸ªå¼€æºå¼€å‘è€…å·¥å…·ï¼Œä¸“æ³¨äºå¿«é€Ÿè¿­ä»£çš„æœ¬åœ°å¼€å‘å‘¨æœŸï¼Œå…è®¸æ‚¨å¿«é€Ÿæ„å»ºåŸºäº WebAssembly çš„åº”ç”¨ç¨‹åºï¼Œè€Œæ— éœ€æ‹…å¿ƒéƒ¨ç½²ã€‚Spin æœ‰ä¸€ä¸ª Visual Studio Code æ’ä»¶ï¼Œç±»ä¼¼äº AWS Lambda ç­‰æ— æœåŠ¡å™¨äº‹ä»¶ç›‘å¬å™¨æ¨¡å‹ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¯¥å…¬å¸è®¡åˆ’åœ¨ä¸ä¹…çš„å°†æ¥ä½¿ç”¨ &lt;a href=&#34;https://github.com/bytecodealliance/preview2-prototyping&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;WASI Preview 2&lt;/a&gt; å’Œ &lt;a href=&#34;https://www.fermyon.com/blog/webassembly-component-model&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Wasm ç»„ä»¶æ¨¡å‹&lt;/a&gt;ã€‚æ­¤å¤–ï¼Œåœ¨ Reddit çš„ä¸€ä¸ª &lt;a href=&#34;https://www.reddit.com/r/WebAssembly/comments/123m4md/introducing_spin_10_the_developer_tool_for/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¸–å­&lt;/a&gt; ä¸­ï¼ŒMatei å›ç­”äº†ä¸€ä¸ªå…³äº Web æ”¯æŒçš„é—®é¢˜ï¼Œå¹¶æä¾›äº†æœªæ¥å‘å±•çš„æ›´å¤šç»†èŠ‚ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;åœ¨æœªæ¥ï¼Œæˆ‘ä»¬å¸Œæœ›å…è®¸ä» Spin è°ƒç”¨ Wasm ç»„ä»¶ï¼Œå¯ä»¥åœ¨æµè§ˆå™¨å†…æˆ–æµè§ˆå™¨å¤–ä½¿ç”¨ï¼Œä½† Spin çš„åŠŸèƒ½æ—¨åœ¨ç”¨äºéæµè§ˆå™¨åœºæ™¯ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Fermyon æ˜¯ä¼—å¤šæŠ•èµ„ WASM æŠ€æœ¯çš„å…¬å¸ä¹‹ä¸€ã€‚ä¾‹å¦‚ï¼ŒDocker æœ€è¿‘ &lt;a href=&#34;https://www.docker.com/blog/announcing-dockerwasm-technical-preview-2/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å®£å¸ƒ&lt;/a&gt; æ¨å‡ºäº† Docker+Wasm çš„é¦–ä¸ª &lt;a href=&#34;https://www.docker.com/blog/docker-wasm-technical-preview/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æŠ€æœ¯é¢„è§ˆç‰ˆ&lt;/a&gt;ï¼Œè¿™æ˜¯ä¸€ç§ç‹¬ç‰¹çš„æ„å»ºï¼Œä½¿å¾—å¯ä»¥ç”¨ WasmEdge è¿è¡Œæ—¶ä½¿ç”¨ Docker è¿è¡Œ Wasm å®¹å™¨ã€‚ä»ç‰ˆæœ¬ 4.15 å¼€å§‹ï¼Œæ¯ä¸ªäººéƒ½å¯ä»¥é€šè¿‡æ¿€æ´» &lt;a href=&#34;https://docs.docker.com/desktop/wasm/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;containerd image store å®éªŒåŠŸèƒ½&lt;/a&gt; æ¥å°è¯•è¿™äº›åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤å¤–ï¼Œä¸€ä¸ªåä¸º &lt;a href=&#34;https://github.com/containerd/runwasi&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;runwasi é¡¹ç›®&lt;/a&gt; æ˜¯ CNCF çš„ containerd ç”Ÿæ€ç³»ç»Ÿçš„ä¸€éƒ¨åˆ†ï¼Œå…è®¸å¼€å‘äººå‘˜é€šè¿‡ Kubernetes å†…éƒ¨çš„ containerd shim è¿è¡Œ WebAssembly è¿è¡Œæ—¶ã€‚&lt;/p&gt;
&lt;p&gt;æœ€åï¼Œæœ‰å…³ Spin çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯å¯åœ¨ &lt;a href=&#34;https://developer.fermyon.com/spin/quickstart&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ–‡æ¡£é¡µé¢&lt;/a&gt; ä¸Šæ‰¾åˆ°ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>ä½¿ç”¨ OCI å®¹å™¨è¿è¡Œ WebAssembly å·¥ä½œè´Ÿè½½</title>
      <link>https://lib.jimmysong.io/blog/wasm-containers/</link>
      <pubDate>Mon, 03 Apr 2023 20:00:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/wasm-containers/</guid>
      <description>&lt;blockquote&gt;
&lt;p&gt;è¯‘è€…æ³¨ï¼šæœ¬æ–‡ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨ OCI å®¹å™¨æ¥è¿è¡Œ WebAssembly å·¥ä½œè´Ÿè½½ã€‚WebAssemblyï¼ˆä¹Ÿç§°ä¸º Wasmï¼‰æ˜¯ä¸€ç§å¯ç§»æ¤çš„äºŒè¿›åˆ¶æŒ‡ä»¤æ ¼å¼ï¼Œå…·æœ‰å¯åµŒå…¥å’Œéš”ç¦»çš„æ‰§è¡Œç¯å¢ƒï¼Œé€‚ç”¨äºå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨åº”ç”¨ã€‚WebAssembly å¯ä»¥çœ‹ä½œæ˜¯ä¸€ç§å°å·§ã€å¿«é€Ÿã€é«˜æ•ˆã€å®‰å…¨çš„åŸºäºæ ˆçš„è™šæ‹Ÿæœºï¼Œè®¾è®¡ç”¨äºæ‰§è¡Œä¸å…³å¿ƒ CPU æˆ–æ“ä½œç³»ç»Ÿçš„å¯ç§»æ¤å­—èŠ‚ç ã€‚WebAssembly æœ€åˆæ˜¯ä¸º web æµè§ˆå™¨è®¾è®¡çš„ï¼Œç”¨æ¥ä½œä¸ºå‡½æ•°çš„è½»é‡çº§ã€å¿«é€Ÿã€å®‰å…¨ã€å¤šè¯­è¨€çš„å®¹å™¨ï¼Œä½†å®ƒä¸å†å±€é™äº webã€‚åœ¨ web ä¸Šï¼ŒWebAssembly ä½¿ç”¨æµè§ˆå™¨æä¾›çš„ç°æœ‰ APIã€‚WebAssembly System Interfaceï¼ˆWASIï¼‰æ˜¯ä¸ºäº†å¡«è¡¥ WebAssembly å’Œæµè§ˆå™¨å¤–ç³»ç»Ÿä¹‹é—´çš„ç©ºç™½è€Œåˆ›å»ºçš„ã€‚è¿™ä½¿å¾—éæµè§ˆå™¨ç³»ç»Ÿå¯ä»¥åˆ©ç”¨ WebAssembly çš„å¯ç§»æ¤æ€§ï¼Œä½¿ WASI æˆä¸ºåˆ†å‘å’Œéš”ç¦»å·¥ä½œè´Ÿè½½æ—¶çš„ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ã€‚æ–‡ç« ä¸­ä»‹ç»äº†å¦‚ä½•é…ç½®å®¹å™¨è¿è¡Œæ—¶æ¥ä»è½»é‡çº§å®¹å™¨é•œåƒä¸­è¿è¡Œ Wasm å·¥ä½œè´Ÿè½½ï¼Œå¹¶ç»™å‡ºäº†ä¸€äº›ä½¿ç”¨ç¤ºä¾‹ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;WebAssemblyï¼ˆä¹Ÿç§°ä¸º Wasmï¼‰ä»¥å…¶å¯åµŒå…¥å’Œéš”ç¦»çš„æ‰§è¡Œç¯å¢ƒè€Œæˆä¸ºä¸€ç§æµè¡Œçš„ä¾¿æºå¼äºŒè¿›åˆ¶æŒ‡ä»¤æ ¼å¼ï¼Œç”¨äºå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨åº”ç”¨ç¨‹åºã€‚å°† WebAssembly è§†ä¸ºä¸€ç§å°å‹ã€å¿«é€Ÿã€é«˜æ•ˆä¸”éå¸¸å®‰å…¨çš„åŸºäºå †æ ˆçš„è™šæ‹Ÿæœºï¼Œä¸“é—¨ç”¨äºæ‰§è¡Œå¯ç§»æ¤çš„å­—èŠ‚ç ï¼Œä¸åœ¨ä¹å®ƒè¿è¡Œåœ¨å“ªä¸ª CPU æˆ–æ“ä½œç³»ç»Ÿä¸Šã€‚WebAssembly æœ€åˆæ˜¯ä¸º Web æµè§ˆå™¨è®¾è®¡çš„ï¼Œç”¨äºæˆä¸ºå‡½æ•°çš„è½»é‡çº§ã€å¿«é€Ÿã€å®‰å…¨å’Œå¤šè¯­è¨€å®¹å™¨ï¼Œä½†å®ƒä¸å†ä»…é™äº Webã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ Web ä¸Šï¼ŒWebAssembly ä½¿ç”¨æµè§ˆå™¨æä¾›çš„ç°æœ‰ APIã€‚WebAssembly ç³»ç»Ÿæ¥å£ï¼ˆWASIï¼‰çš„åˆ›å»ºå¡«è¡¥äº† WebAssembly å’Œè¿è¡Œåœ¨æµè§ˆå™¨å¤–éƒ¨çš„ç³»ç»Ÿä¹‹é—´çš„ç©ºç™½ã€‚è¿™ä½¿éæµè§ˆå™¨ç³»ç»Ÿèƒ½å¤Ÿåˆ©ç”¨ WebAssembly çš„å¯ç§»æ¤æ€§ï¼Œä½¿ WASI æˆä¸ºåœ¨åˆ†å‘æ—¶å…·æœ‰å¯ç§»æ¤æ€§å’Œåœ¨è¿è¡Œè´Ÿè½½æ—¶å…·æœ‰éš”ç¦»æ€§çš„è‰¯å¥½é€‰æ‹©ã€‚&lt;/p&gt;
&lt;p&gt;WebAssembly æä¾›äº†å‡ ä¸ªä¼˜ç‚¹ã€‚å› ä¸ºå®ƒæ˜¯å¹³å°ä¸­ç«‹çš„ï¼Œæ‰€ä»¥å¯ä»¥åœ¨å¤šä¸ªæ“ä½œç³»ç»Ÿå’Œæ¶æ„ä¸ŠåŒæ—¶ç¼–è¯‘å’Œæ‰§è¡Œä¸€ä¸ªå•ä¸€çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå…·æœ‰éå¸¸ä½çš„ç£ç›˜å ç”¨å’Œå¯åŠ¨æ—¶é—´ã€‚æœ‰ç”¨çš„å®‰å…¨åŠŸèƒ½åŒ…æ‹¬æ¨¡å—ç­¾åå’Œå¯ä»¥åœ¨è¿è¡Œæ—¶çº§åˆ«ä¸Šæ§åˆ¶çš„å®‰å…¨è°ƒèŠ‚å™¨ï¼Œè€Œä¸æ˜¯ä¾èµ–äºä¸»æœºæ“ä½œç³»ç»Ÿçš„ç”¨æˆ·æƒé™ã€‚å°é—­å¼å†…å­˜ä»ç„¶å¯ä»¥ç”±ç°æœ‰çš„å®¹å™¨å·¥å…·åŸºç¡€æ¶æ„è¿›è¡Œç®¡ç†ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†é€šè¿‡ä¸€ä¸ªé…ç½®å®¹å™¨è¿è¡Œæ—¶æ¥è¿è¡Œè½»é‡çº§å®¹å™¨é•œåƒä¸­çš„ Wasm å·¥ä½œè´Ÿè½½çš„æ–¹æ¡ˆæ¥è®²è§£ã€‚&lt;/p&gt;
&lt;h2 id=&#34;webassembly-åœ¨äº‘åŸºç¡€è®¾æ–½ä¸Šçš„é‡‡ç”¨å’Œé˜»ç¢&#34;&gt;WebAssembly åœ¨äº‘åŸºç¡€è®¾æ–½ä¸Šçš„é‡‡ç”¨å’Œé˜»ç¢&lt;/h2&gt;
&lt;p&gt;WebAssembly å’Œ WASI ç›¸å½“æ–°ï¼Œå› æ­¤å°šæœªè®¾ç½®åœ¨å®¹å™¨ç”Ÿæ€ç³»ç»Ÿä¸­æœ¬åœ°è¿è¡Œ Wasm å·¥ä½œè´Ÿè½½çš„æ ‡å‡†ã€‚æœ¬æ–‡ä»…ä»‹ç»ä¸€ç§è§£å†³æ–¹æ¡ˆï¼Œä½†è¿˜æœ‰å…¶ä»–å¯è¡Œçš„æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;å…¶ä¸­ä¸€äº›è§£å†³æ–¹æ¡ˆåŒ…æ‹¬ä½¿ç”¨å…¼å®¹ Wasm çš„ç»„ä»¶æ›¿æ¢æœ¬æœº Linux å®¹å™¨è¿è¡Œæ—¶ã€‚ä¾‹å¦‚ï¼ŒKrustlet v1.0.0-alpha1 å…è®¸ç”¨æˆ·å¼•å…¥ Kubernetes èŠ‚ç‚¹ï¼Œå…¶ä¸­ Krustlet ç”¨ä½œæ ‡å‡† kubelet çš„æ›¿ä»£å“ã€‚è¿™ç§æ–¹æ³•çš„å±€é™æ€§åœ¨äºç”¨æˆ·å¿…é¡»åœ¨ Linux å®¹å™¨è¿è¡Œæ—¶å’Œ Wasm è¿è¡Œæ—¶ä¹‹é—´è¿›è¡Œé€‰æ‹©ã€‚&lt;/p&gt;
&lt;p&gt;å¦ä¸€ç§è§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨å¸¦æœ‰ Wasm è¿è¡Œæ—¶çš„åŸºæœ¬é•œåƒï¼Œå¹¶æ‰‹åŠ¨è°ƒç”¨ç¼–è¯‘åçš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬åœ¨ä½äºå®¹å™¨è¿è¡Œæ—¶çš„ä¸€çº§åˆ«è°ƒç”¨ Wasm è¿è¡Œæ—¶ï¼Œè¿™ç§æ–¹æ³•ä¼šä½¿å®¹å™¨é•œåƒè†¨èƒ€ï¼Œè¿™ä¸ä¸€å®šæ˜¯å¿…éœ€çš„ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘å°†æè¿°å¦‚ä½•é€šè¿‡åˆ›å»ºä¸€ä¸ªæ··åˆè®¾ç½®æ¥é¿å…è¿™ç§æƒ…å†µï¼Œå…¶ä¸­ç°æœ‰çš„ Open Containers Initiativeï¼ˆOCIï¼‰è¿è¡Œæ—¶å¯ä»¥è¿è¡Œæœ¬åœ° Linux å®¹å™¨å’Œä¸ WASI å…¼å®¹çš„å·¥ä½œè´Ÿè½½ã€‚&lt;/p&gt;
&lt;h2 id=&#34;åœ¨æ··åˆè®¾ç½®ä¸­ä½¿ç”¨-crun-è¿è¡Œ-wasm-å’Œ-linux-å®¹å™¨&#34;&gt;åœ¨æ··åˆè®¾ç½®ä¸­ä½¿ç”¨ crun è¿è¡Œ Wasm å’Œ Linux å®¹å™¨&lt;/h2&gt;
&lt;p&gt;ä¸€äº›ä¸Šè¿°é—®é¢˜å¯ä»¥é€šè¿‡å…è®¸ç°æœ‰çš„ OCI è¿è¡Œæ—¶åœ¨è¾ƒä½çº§åˆ«ä¸Šè°ƒç”¨ Linux å®¹å™¨å’Œ Wasm å®¹å™¨æ¥è½»æ¾è§£å†³ã€‚è¿™é¿å…äº†ä¾èµ–å®¹å™¨é•œåƒæºå¸¦ Wasm è¿è¡Œæ—¶æˆ–å¼•å…¥ä»…æ”¯æŒ Wasm å®¹å™¨çš„åŸºç¡€æ¶æ„æ–°å±‚çš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥å¤„ç†æ­¤ä»»åŠ¡çš„ä¸€ä¸ªå®¹å™¨è¿è¡Œæ—¶æ˜¯ crunã€‚&lt;/p&gt;
&lt;p&gt;Crun å¿«é€Ÿï¼Œå ç”¨å†…å­˜ä½ï¼Œæ˜¯ä¸€ä¸ªå®Œå…¨ç¬¦åˆ OCI çš„å®¹å™¨è¿è¡Œæ—¶ï¼Œå¯ä»¥ç”¨ä½œç°æœ‰å®¹å™¨è¿è¡Œæ—¶çš„æ›¿ä»£å“ã€‚Crun æœ€åˆæ˜¯ç¼–å†™ç”¨äºè¿è¡Œ Linux å®¹å™¨çš„ï¼Œä½†å®ƒè¿˜æä¾›äº†èƒ½å¤Ÿåœ¨æœ¬åœ°æ–¹å¼ä¸‹åœ¨å®¹å™¨æ²™ç›’ä¸­è¿è¡Œä»»æ„æ‰©å±•çš„å¤„ç†ç¨‹åºã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯ç”¨ crun æ›¿æ¢ç°æœ‰è¿è¡Œæ—¶çš„ä¸€ç§éæ­£å¼æ–¹å¼ï¼Œä»…ç”¨äºå±•ç¤º crun æ˜¯æ‚¨ç°æœ‰ OCI è¿è¡Œæ—¶çš„å®Œæ•´æ›¿ä»£å“ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ mv /path/to/exisiting-runtime /path/to/existing-runtime.backup
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ cp /path/to/crun /path/to/existing-runtime
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å…¶ä¸­ä¹‹ä¸€å¤„ç†ç¨‹åºæ˜¯ &lt;code&gt;crun-wasm-handler&lt;/code&gt;ï¼Œå®ƒå°†ç‰¹åˆ«é…ç½®çš„å®¹å™¨é•œåƒï¼ˆ&lt;em&gt;Wasm å…¼å®¹é•œåƒ&lt;/em&gt;ï¼‰å§”æ´¾ç»™ç°æœ‰ Wasm è¿è¡Œæ—¶çš„éƒ¨åˆ†ï¼Œä»¥æœ¬åœ°æ–¹å¼åœ¨ crun æ²™ç›’å†…è¿è¡Œã€‚è¿™æ ·ï¼Œç»ˆç«¯ç”¨æˆ·æ— éœ€è‡ªå·±ç»´æŠ¤ Wasm è¿è¡Œæ—¶ã€‚&lt;/p&gt;
&lt;p&gt;Crun ä¸ &lt;a href=&#34;https://wasmedge.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;wasmedge&lt;/a&gt;ã€&lt;a href=&#34;https://wasmtime.dev/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;wasmtime&lt;/a&gt; å’Œ &lt;a href=&#34;https://wasmer.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;wasmer&lt;/a&gt; å…·æœ‰æœ¬åœ°é›†æˆï¼Œä»¥æ”¯æŒæ­¤åŠŸèƒ½ã€‚å®ƒåœ¨ crun æ£€æµ‹åˆ°é…ç½®çš„é•œåƒæ˜¯å¦åŒ…å«ä»»ä½• Wasm/WASI å·¥ä½œè´Ÿè½½æ—¶åŠ¨æ€åœ°è°ƒç”¨è¿™äº›è¿è¡Œæ—¶çš„éƒ¨åˆ†ï¼ŒåŒæ—¶ä»æ”¯æŒæœ¬åœ° Linux å®¹å™¨ã€‚&lt;/p&gt;
&lt;p&gt;æœ‰å…³ä½¿ç”¨ Wasm/WASI æ”¯æŒæ„å»º crun çš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§ &lt;a href=&#34;https://github.com/containers/crun/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;GitHub ä¸Šçš„ crun å­˜å‚¨åº“&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;åœ¨-podman-å’Œ-kubernetes-ä¸Šä½¿ç”¨-buildah-æ„å»ºå’Œè¿è¡Œ-wasm-é•œåƒ&#34;&gt;åœ¨ Podman å’Œ Kubernetes ä¸Šä½¿ç”¨ Buildah æ„å»ºå’Œè¿è¡Œ Wasm é•œåƒ&lt;/h2&gt;
&lt;p&gt;ç”¨æˆ·å¯ä»¥åœ¨ Podman å’Œ Kubernetes ä¸Šä½¿ç”¨ crun ä½œä¸º OCI è¿è¡Œæ—¶æ¥åˆ›å»ºå’Œè¿è¡Œå¹³å°æ— å…³çš„ Wasm é•œåƒã€‚ä»¥ä¸‹æ˜¯æ•™ç¨‹ï¼š&lt;/p&gt;
&lt;h3 id=&#34;ä½¿ç”¨-buildah-åˆ›å»º-wasm-å…¼å®¹é•œåƒ&#34;&gt;ä½¿ç”¨ Buildah åˆ›å»º Wasm å…¼å®¹é•œåƒ&lt;/h3&gt;
&lt;p&gt;Wasm/WASI å…¼å®¹é•œåƒå¾ˆç‰¹åˆ«ã€‚å®ƒä»¬åŒ…å«ä¸€ä¸ªé­”æœ¯æ³¨é‡Šï¼Œå¯å¸®åŠ©åƒ crun è¿™æ ·çš„ OCI è¿è¡Œæ—¶åˆ†ç±»åˆ«å®ƒæ˜¯ Linux æœ¬æœºé•œåƒè¿˜æ˜¯å¸¦æœ‰ Wasm/WASI å·¥ä½œè´Ÿè½½çš„é•œåƒã€‚ç„¶åï¼Œå¦‚æœéœ€è¦ï¼Œå®ƒå¯ä»¥è°ƒç”¨å¤„ç†ç¨‹åºã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ä»»ä½•å®¹å™¨é•œåƒæ„å»ºå·¥å…·éƒ½å¯ä»¥éå¸¸è½»æ¾åœ°åˆ›å»ºè¿™äº› Wasm å…¼å®¹é•œåƒï¼Œä½†æ˜¯å¯¹äºæœ¬æ–‡ï¼Œæˆ‘å°†æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨ &lt;a href=&#34;https://opensource.com/article/22/2/build-your-own-container-linux-buildah&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Buildah&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ç¼–è¯‘æ‚¨çš„ &lt;code&gt;.wasm&lt;/code&gt; æ¨¡å—ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨æ‚¨çš„ &lt;code&gt;.wasm&lt;/code&gt; æ¨¡å—å‡†å¤‡ä¸€ä¸ª Containerfileã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-dockerfile&#34; data-lang=&#34;dockerfile&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;FROM&lt;/span&gt;&lt;span class=&#34;s&#34;&gt; scratch&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;COPY&lt;/span&gt; hello.wasm /&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;CMD&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/hello.wasm&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;ä½¿ç”¨ Buildah ä½¿ç”¨æ³¨é‡Š &lt;code&gt;module.wasm.image/variant=compat&lt;/code&gt; æ„å»º Wasm é•œåƒã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ buildah build --annotation &lt;span class=&#34;s2&#34;&gt;&amp;#34;module.wasm.image/variant=compat&amp;#34;&lt;/span&gt; -t mywasm-image
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ„å»ºå®Œé•œåƒå¹¶ä¸”å®¹å™¨å¼•æ“å·²é…ç½®ä¸ºä½¿ç”¨ crunï¼Œcrun å°†è‡ªåŠ¨å®Œæˆå·¥ä½œå¹¶é€šè¿‡é…ç½®çš„ Wasm å¤„ç†ç¨‹åºè¿è¡Œæä¾›çš„å·¥ä½œè´Ÿè½½ã€‚&lt;/p&gt;
&lt;h3 id=&#34;åœ¨-podman-ä¸­è¿è¡Œ-wasm-å·¥ä½œè´Ÿè½½&#34;&gt;åœ¨ Podman ä¸­è¿è¡Œ WASM å·¥ä½œè´Ÿè½½&lt;/h3&gt;
&lt;p&gt;Crun æ˜¯ Podman çš„é»˜è®¤ OCI è¿è¡Œæ—¶ã€‚Podman åŒ…å«æ—‹é’®å’Œå¤„ç†ç¨‹åºï¼Œå¯åˆ©ç”¨å¤§å¤šæ•° crun åŠŸèƒ½ï¼ŒåŒ…æ‹¬ crun Wasm å¤„ç†ç¨‹åºã€‚æ„å»º Wasm å…¼å®¹é•œåƒåï¼Œå®ƒå¯ä»¥åƒä»»ä½•å…¶ä»–å®¹å™¨é•œåƒä¸€æ ·ç”± Podman ä½¿ç”¨ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ podman run mywasm-image:latest
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Podman ä½¿ç”¨ crun çš„ Wasm å¤„ç†ç¨‹åºè¿è¡Œè¯·æ±‚çš„ Wasm å…¼å®¹é•œåƒ &lt;code&gt;mywasm-image:latest&lt;/code&gt;ï¼Œå¹¶è¿”å›ç¡®è®¤æˆ‘ä»¬çš„å·¥ä½œè´Ÿè½½å·²æ‰§è¡Œçš„è¾“å‡ºã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ hello world from the webassembly module !!!!
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;kubernetes-æ”¯æŒå’Œæµ‹è¯•çš„å®¹å™¨è¿è¡Œæ—¶æ¥å£criå®ç°&#34;&gt;Kubernetes æ”¯æŒå’Œæµ‹è¯•çš„å®¹å™¨è¿è¡Œæ—¶æ¥å£ï¼ˆCRIï¼‰å®ç°&lt;/h3&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯é…ç½®ä¸¤ä¸ªæµè¡Œçš„å®¹å™¨è¿è¡Œæ—¶çš„æ–¹æ³•ï¼š&lt;/p&gt;
&lt;h3 id=&#34;cri-o&#34;&gt;CRI-O&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;é€šè¿‡ç¼–è¾‘ &lt;code&gt;/etc/crio/crio.conf&lt;/code&gt; ä¸Šçš„é…ç½®å°† CRI-O é…ç½®ä¸ºä½¿ç”¨ crun è€Œä¸æ˜¯ runcã€‚Red Hat OpenShift æ–‡æ¡£åŒ…å«æœ‰å…³ &lt;a href=&#34;https://docs.openshift.com/container-platform/3.11/crio/crio_runtime.html#configure-crio-use-crio-engine&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;é…ç½® CRI-O&lt;/a&gt; çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ &lt;code&gt;sudo systemctl restart crio&lt;/code&gt; é‡æ–°å¯åŠ¨ CRI-Oã€‚&lt;/li&gt;
&lt;li&gt;CRI-O è‡ªåŠ¨å°† pod æ³¨é‡Šä¼ æ’­åˆ°å®¹å™¨è§„èŒƒã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;containerd&#34;&gt;Containerd&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Containerd æ”¯æŒé€šè¿‡è‡ªå®šä¹‰é…ç½®å®šä¹‰åœ¨ &lt;code&gt;/etc/containerd/config.toml&lt;/code&gt; ä¸­åˆ‡æ¢å®¹å™¨è¿è¡Œæ—¶ã€‚&lt;/li&gt;
&lt;li&gt;é€šè¿‡ç¡®ä¿è¿è¡Œæ—¶äºŒè¿›åˆ¶æ–‡ä»¶æŒ‡å‘ crunï¼Œå°† containerd é…ç½®ä¸ºä½¿ç”¨ crunã€‚æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§ &lt;a href=&#34;https://github.com/containerd/containerd/blob/main/docs/cri/config.md&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;containerd æ–‡æ¡£&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;é€šè¿‡è®¾ç½® &lt;code&gt;pod_annotations = [&amp;quot;module.wasm.image/variant.*&amp;quot;]&lt;/code&gt; åœ¨é…ç½®ä¸­å…è®¸åˆ—å‡º Wasm æ³¨é‡Šï¼Œä»¥ä¾¿å°†å®ƒä»¬ä¼ æ’­åˆ° OCI è§„èŒƒã€‚ç„¶åä½¿ç”¨ &lt;code&gt;sudo systemctl start containerd&lt;/code&gt; é‡æ–°å¯åŠ¨ containerdã€‚&lt;/li&gt;
&lt;li&gt;ç°åœ¨ï¼Œcontainerd åº”è¯¥å°† Wasm pod æ³¨é‡Šä¼ æ’­åˆ°å®¹å™¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯ä¸ CRI-O å’Œ containerd å…¼å®¹çš„ Kubernetes pod è§„èŒƒç¤ºä¾‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;v1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Pod&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;pod-with-wasm-workload&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;mynamespace&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;annotations&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;module.wasm.image/variant&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;compat&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;containers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;wasm-container&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;image&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;myrepo/mywasmimage:latest&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;å·²çŸ¥é—®é¢˜å’Œè§£å†³æ–¹æ³•&#34;&gt;å·²çŸ¥é—®é¢˜å’Œè§£å†³æ–¹æ³•&lt;/h2&gt;
&lt;p&gt;å¤æ‚çš„ Kubernetes åŸºç¡€æ¶æ„åŒ…å« podï¼Œè€Œä¸”åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œè¿™äº› pod è¿˜åŒ…æ‹¬ sidecarã€‚è¿™æ„å‘³ç€å½“éƒ¨ç½²åŒ…å« sidecar å¹¶ä¸” sidecar å®¹å™¨ä¸åŒ…å« Wasm å…¥å£ç‚¹ï¼ˆä¾‹å¦‚åƒ Linkerdã€Gloo å’Œ Istio è¿™æ ·çš„æœåŠ¡ç½‘æ ¼æˆ– Envoy è¿™æ ·çš„ä»£ç†çš„åŸºç¡€æ¶æ„è®¾ç½®ï¼‰æ—¶ï¼Œcrun çš„ Wasm é›†æˆå°†æ— ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;æ‚¨å¯ä»¥é€šè¿‡æ·»åŠ ä¸¤ä¸ªæ™ºèƒ½æ³¨é‡Šæ¥è§£å†³æ­¤é—®é¢˜ï¼Œç”¨äº Wasm å¤„ç†ç¨‹åºï¼š&lt;code&gt;compat-smart&lt;/code&gt; å’Œ &lt;code&gt;wasm-smart&lt;/code&gt;ã€‚è¿™äº›æ³¨é‡Šå……å½“æ™ºèƒ½å¼€å…³ï¼Œä»…åœ¨å®¹å™¨éœ€è¦æ—¶åˆ‡æ¢ Wasm è¿è¡Œæ—¶ã€‚å› æ­¤ï¼Œåœ¨è¿è¡Œå¸¦æœ‰ sidecar çš„éƒ¨ç½²æ—¶ï¼Œåªæœ‰åŒ…å«æœ‰æ•ˆ Wasm å·¥ä½œè´Ÿè½½çš„å®¹å™¨æ‰ç”± Wasm å¤„ç†ç¨‹åºæ‰§è¡Œã€‚å¸¸è§„å®¹å™¨åƒå¾€å¸¸ä¸€æ ·è¢«å§”æ´¾ç»™æœ¬æœº Linux å®¹å™¨è¿è¡Œæ—¶ã€‚&lt;/p&gt;
&lt;p&gt;å› æ­¤ï¼Œåœ¨ä¸ºè¿™ç§ç”¨ä¾‹æ„å»ºé•œåƒæ—¶ï¼Œè¯·ä½¿ç”¨æ³¨é‡Š &lt;code&gt;module.wasm.image/variant=compat-smart&lt;/code&gt;ï¼Œè€Œä¸æ˜¯ &lt;code&gt;module.wasm.image/variant=compat&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ‚¨å¯ä»¥åœ¨ &lt;a href=&#34;https://github.com/containers/crun/blob/main/docs/wasm-wasi-on-kubernetes.md#known-issues&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;GitHub ä¸Šçš„ crun æ–‡æ¡£&lt;/a&gt; ä¸­æ‰¾åˆ°å…¶ä»–å·²çŸ¥é—®é¢˜ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Tetrate å¼€æºé¡¹ç›® Wazero ç®€ä»‹</title>
      <link>https://lib.jimmysong.io/blog/introducing-wazero-from-tetrate/</link>
      <pubDate>Mon, 20 Mar 2023 12:00:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/introducing-wazero-from-tetrate/</guid>
      <description>&lt;blockquote&gt;
&lt;p&gt;è¯‘è€…æ³¨ï¼šæœ¬æ–‡è¯‘è‡ª &lt;a href=&#34;https://tetrate.io/blog/introducing-wazero-from-tetrate/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tetrate åšå®¢&lt;/a&gt;ã€‚è¿™ç¯‡æ–‡ç« ä»‹ç»äº† wazeroï¼Œä¸€ä¸ªç”± Tetrate å¼€å‘çš„ç”¨ Go è¯­è¨€ç¼–å†™çš„ WebAssembly è¿è¡Œæ—¶ã€‚wazero å¯ä»¥è®©å¼€å‘è€…ç”¨ä¸åŒçš„ç¼–ç¨‹è¯­è¨€ç¼–å†™ä»£ç ï¼Œå¹¶åœ¨å®‰å…¨çš„æ²™ç®±ç¯å¢ƒä¸­è¿è¡Œã€‚wazero æœ‰ä»¥ä¸‹å‡ ä¸ªç‰¹ç‚¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;çº¯ Goï¼Œæ— ä¾èµ–ï¼Œæ”¯æŒè·¨å¹³å°å’Œè·¨æ¶æ„&lt;/li&gt;
&lt;li&gt;éµå¾ª WebAssembly æ ¸å¿ƒè§„èŒƒ 1.0 å’Œ 2.0&lt;/li&gt;
&lt;li&gt;æ”¯æŒ Go çš„ç‰¹æ€§ï¼Œå¦‚å¹¶å‘å®‰å…¨å’Œä¸Šä¸‹æ–‡ä¼ é€’&lt;/li&gt;
&lt;li&gt;æä¾›äº†ä¸°å¯Œçš„ç¼–ç¨‹æ¥å£å’Œå‘½ä»¤è¡Œå·¥å…·&lt;/li&gt;
&lt;li&gt;æ€§èƒ½ä¼˜å¼‚ï¼Œè¶…è¿‡äº†å…¶ä»–åŒç±»è¿è¡Œæ—¶&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;WebAssemblyï¼Œä¹Ÿç§°ä¸º Wasmï¼Œæ˜¯ä¸€ç§ç¼–è¯‘ç”¨ä¸€ç§ç¼–ç¨‹è¯­è¨€ï¼ˆä¾‹å¦‚ C æˆ– Rustï¼‰ç¼–å†™çš„ä»£ç å¹¶åœ¨ä¸åŒçš„è¿è¡Œæ—¶ï¼ˆä¾‹å¦‚ Web æµè§ˆå™¨æˆ–å¾®æœåŠ¡ï¼‰ä¸Šè¿è¡Œå®ƒçš„æ–¹æ³•ã€‚è¿™ä½¿å¾—å®ƒæˆä¸ºç¼–å†™æ’ä»¶ã€æ‰©å±•ä»¥åŠåœ¨å®‰å…¨æ²™ç®±ç¯å¢ƒä¸­è¿è¡Œä»»æ„ç”¨æˆ·å®šä¹‰ä»£ç çš„ç»ä½³é€‰æ‹©ã€‚&lt;/p&gt;
&lt;p&gt;WebAssembly ç»å¸¸è¢«è¯¯è®¤ä¸ºæ˜¯ä¸€ç§ä»…é™æµè§ˆå™¨çš„æŠ€æœ¯ï¼Œè€Œå®é™…ä¸Š Wasm æ˜¯ä¸€ç§è·¨å¹³å°çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¯ä»¥ç”±ä»»ä½• WebAssembly è¿è¡Œæ—¶æ‰§è¡Œã€‚ä»å†å²ä¸Šçœ‹ï¼ŒGo ç¨‹åºå‘˜æ²¡æœ‰å¤ªå¤šå¥½çš„é€‰æ‹©ï¼Œä½†è¿™ç§æƒ…å†µå·²ç»æ”¹å˜ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡ä»‹ç»äº† &lt;a href=&#34;https://wazero.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;wazero&lt;/a&gt;ï¼Œå®ƒåœ¨ç”¨ Go ç¼–ç¨‹è¯­è¨€ç¼–å†™çš„åŸºç¡€è®¾æ–½ä¸­å¾ˆé‡è¦ï¼Œå¹¶æ¶µç›–äº†å…¶æœ€å¼•äººæ³¨ç›®çš„åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;h2 id=&#34;åœ¨-go-ä¸­è¿è¡Œ-webassembly-çš„ç®€å²&#34;&gt;åœ¨ Go ä¸­è¿è¡Œ WebAssembly çš„ç®€å²&lt;/h2&gt;
&lt;p&gt;æœ€åˆï¼Œå¤§å¤šæ•° WebAssembly è¿è¡Œæ—¶æ˜¯ç”¨ C/C++ å’Œ Rust ç¼–ç¨‹è¯­è¨€ç¼–å†™çš„ã€‚è®¸å¤šäº‘åŸç”Ÿé¡¹ç›®ï¼ŒåŒ…æ‹¬ Dockerã€Istio å’Œ Kubernetes éƒ½æ˜¯ç”¨ Go ç¼–å†™çš„ã€‚ä¸æ˜¯ç”¨ Go ç¼–å†™çš„è¿è¡Œæ—¶å¯é€šè¿‡ç§°ä¸º CGO çš„æœºåˆ¶è·å¾—ã€‚ç„¶è€Œï¼ŒCGO ä¸æ˜¯ Goï¼Œé€šè¿‡é€‰æ‹© CGOï¼Œæ‚¨å°±æ”¾å¼ƒäº† Go è¿è¡Œæ—¶çš„è®¸å¤šæ€æ‰‹çº§åŠŸèƒ½ï¼Œä¾‹å¦‚å¯¹å¹¿æ³›å¹³å°äº¤å‰ç¼–è¯‘çš„ä¸€æµæ”¯æŒã€‚å›´ç»• CGO çš„å¤æ‚æ€§ï¼Œå°¤å…¶æ˜¯éšå«çš„æœ¬æœºåº“ï¼Œæ˜¯å°† wasm æ‰©å±•åˆ° Kubernetes è°ƒåº¦ç¨‹åºçš„è¯·æ±‚è¢«æ‹’ç»çš„åŸå› ã€‚æ€»ä¹‹ï¼ŒGo ç¼ºä¹åŸç”Ÿè¿è¡Œæ—¶å»¶è¿Ÿæˆ–é™åˆ¶äº†å°† WebAssembly å¼•å…¥æ ¸å¿ƒåŸºç¡€è®¾æ–½ã€‚&lt;/p&gt;
&lt;h2 id=&#34;wazero-æ˜¯ä¸º-go-å¼€å‘äººå‘˜ç¼–å†™çš„&#34;&gt;wazero æ˜¯ä¸º Go å¼€å‘äººå‘˜ç¼–å†™çš„&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://wazero.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;wazero&lt;/a&gt; æ˜¯å”¯ä¸€ç”¨ Go ç¼–å†™çš„&lt;strong&gt;é›¶ä¾èµ– WebAssembly è¿è¡Œæ—¶&lt;/strong&gt;ã€‚è¿™ä¸ªå¼€æºé¡¹ç›®æœ€åˆæ˜¯ç”± &lt;strong&gt;Takeshi Yoneda&lt;/strong&gt; ä½œä¸ºçˆ±å¥½å¼€å§‹çš„ã€‚2021 å¹´åº•ï¼ŒTetrate è®¤è¯†åˆ°å…¶æˆ˜ç•¥ä»·å€¼å¹¶æŠ•å…¥äº†å‡ åå…¨èŒå‘˜å·¥ï¼Œä»¥æœŸæœ‰æœä¸€æ—¥å‘å¸ƒ 1.0 ç‰ˆã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿‡å»çš„å‡ ä¸ªæœˆé‡Œï¼Œè¯¥å›¢é˜Ÿå­œå­œä¸å€¦åœ°å·¥ä½œä»¥æ”¯æŒå¤šç§å¹³å°ã€æ¶æ„å’Œç¼–ç¨‹æ¥å£ã€‚æˆ‘ä»¬å¾ˆé«˜å…´åœ°å®£å¸ƒ wazero 1.0 å‘å¸ƒï¼&lt;/p&gt;
&lt;p&gt;Wazero æ˜¯ä¸€ä¸ªåŠŸèƒ½é½å…¨ã€ç¬¦åˆæ ‡å‡†ã€ä¸°å¯Œä¸”ç»è¿‡å®æˆ˜æ£€éªŒçš„ WebAssembly è¿è¡Œæ—¶ï¼Œå®ƒä¸ Go è¿è¡Œæ—¶çš„æœ€ä½³ç‰¹æ€§æ— ç¼é›†æˆï¼Œä¾‹å¦‚å®‰å…¨å¹¶å‘å’Œä¸Šä¸‹æ–‡ä¼ æ’­ã€‚å®ƒåŒ…æ‹¬ä¸€ä¸ªé¢å‘ Go å¼€å‘äººå‘˜çš„ç¼–ç¨‹æ¥å£å’Œä¸€ä¸ªé¢å‘é‚£äº›åªæƒ³è¿è¡Œ Wasm çš„äººçš„ CLIã€‚&lt;/p&gt;
&lt;h2 id=&#34;wazero-æœ‰ä»€ä¹ˆä¸åŒä¹‹å¤„&#34;&gt;Wazero æœ‰ä»€ä¹ˆä¸åŒä¹‹å¤„ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;ä½ å¯èƒ½æƒ³çŸ¥é“ wazero çš„ä¼˜åŠ¿åœ¨å“ªé‡Œï¼Œè€ƒè™‘åˆ° Go ä¸å…¶ä»–è¯­è¨€å…·æœ‰è‰¯å¥½çš„äº’æ“ä½œæ€§ã€‚è¿™å…è®¸æ‚¨é€šè¿‡ CGO é€‰æ‹©å¤šä¸ªä¸æ˜¯ç”¨ Go ç¼–å†™çš„è¿è¡Œæ—¶ã€‚ä»¥ä¸‹æ˜¯è€ƒè™‘ Wazero çš„äº”ä¸ªç†ç”±ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æœ€ä½³ Go æ”¯æŒ&lt;/strong&gt;ã€‚Wazero æ˜¯çº¯ Go è¯­è¨€ï¼Œä¸å¼•å…¥ä»»ä½•ä¾èµ–ï¼Œä½†æ”¯æŒæ›´è¿›ä¸€æ­¥ã€‚Wazero åŒ…æ‹¬æƒ¯ç”¨çš„ Go å‡½æ•°ï¼Œä¾‹å¦‚ä¸Šä¸‹æ–‡é›†æˆã€‚è¿™å…è®¸æ‚¨é‡ç”¨ä¼ å…¥çš„æˆªæ­¢æ—¥æœŸï¼Œä¾‹å¦‚æ¥è‡ª gRPC è¯·æ±‚ä»¥é™åˆ¶åœ¨ wasm å‡½æ•°ä¸­èŠ±è´¹çš„æ—¶é—´ã€‚è¿è¡Œæ—¶æ˜¯ä¸“é—¨ä¸º Go è®¾è®¡çš„ï¼Œå› æ­¤åœ¨ Go å¼€å‘äººå‘˜å…³æ³¨çš„é—®é¢˜ï¼ˆä¾‹å¦‚ goroutine security /wazeroï¼‰æ–¹é¢&lt;a href=&#34;https://pkg.go.dev/github.com/tetratelabs&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è®°å½•å¾ˆå¥½&lt;/a&gt;ã€‚æ¯”å¦‚å¾ˆå¤šåº“å¯ä»¥åŒæ—¶ä½¿ç”¨ wazero è€Œä¸äº’ç›¸å†²çªï¼Œè¿™äº›éƒ½æ˜¯åœ¨ Go ä¸­æµ‹è¯•è¿‡çš„ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;API å…¼å®¹æ€§&lt;/strong&gt;ã€‚WebAssembly è¿è¡Œæ—¶åµŒå…¥åœ¨é¡¹ç›®çš„åº•å±‚ä½ç½®ï¼Œå› æ­¤å…¼å®¹æ€§çš„å˜åŒ–å¯èƒ½ä¼šå¯¼è‡´ç‰ˆæœ¬é”å®šï¼Œå°¤å…¶æ˜¯åœ¨ä¸­é—´ä»¶ä¸­ã€‚Wazero æ˜¯å”¯ä¸€å·²çŸ¥çš„æä¾›è¯­ä¹‰ç‰ˆæœ¬æ§åˆ¶çš„è¿è¡Œæ—¶ã€‚å‡½æ•°å¯ä»¥åˆ¶ä½œæˆ 1.1 ç‰ˆæœ¬ï¼Œå®ƒä»¬ä¸ä¼šç ´å 1.0 ç”¨æˆ·ã€‚Wazero æ‰¿è¯ºä¿æŒé›¶ä¾èµ–å¹¶ä¸ Go çš„å‰ä¸¤ä¸ªç‰ˆæœ¬ä¸€èµ·å·¥ä½œã€‚æ€»ä¹‹ï¼Œwazero çš„å…¼å®¹æ€§æ–¹æ³•æ˜¯æ¨¡ä»¿ Go æœ¬èº«ï¼Œä¸ºå…¶ç”¨æˆ·å¼•å…¥æœ€å°‘çš„ç»´æŠ¤é—®é¢˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¹³å°å…¼å®¹æ€§&lt;/strong&gt;ã€‚wazero å®Œå…¨æ”¯æŒ amd64ã€arm64ã€FreeBSDã€Linuxã€macOS å’Œ Windows åœ¨æœ€æ–°ä¸‰ä¸ªç‰ˆæœ¬çš„ Go ä¸Šçš„ä»»æ„ç»„åˆã€‚å®ƒè¿˜é€šè¿‡å…¶â€œè§£é‡Šå™¨è¿è¡Œæ—¶â€å°†å¯¹ Go çš„æ”¯æŒæ‰©å±•åˆ°å…¶ä»–å¹³å°ï¼Œå®ƒçš„æ‰§è¡Œé€Ÿåº¦æ¯”æœ¬æœºâ€œç¼–è¯‘å™¨è¿è¡Œæ—¶â€æ…¢ã€‚wazero åœ¨ Windows ä¸Šéå¸¸æ£’ï¼Œå› ä¸ºå®ƒä¸ä»…æ˜¯ä¸€æµçš„å¹³å°ï¼Œè€Œä¸”æˆ‘ä»¬è¿˜åœ¨å‘å¸ƒæ—¶ç”Ÿæˆç­¾åçš„ MSI å®‰è£…ç¨‹åºã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åšå¦‚ç£çŸ³çš„æµ‹è¯•æ–¹æ³•&lt;/strong&gt;ã€‚Wazero é€šè¿‡å¤šé¡¹è§„èŒƒæµ‹è¯•æ¥æµ‹è¯•å¹³å°æ”¯æŒï¼ŒåŒ…æ‹¬ WebAssembly æ ¸å¿ƒè§„èŒƒçš„ 1.0 å’Œ 2.0 è‰æ¡ˆç‰ˆæœ¬ä»¥åŠç”¨äºæµ‹è¯• I/O åŠŸèƒ½çš„ WASI æµ‹è¯•å¥—ä»¶ã€‚æˆ‘ä»¬è¿˜è¿è¡Œç”± Zig å’Œ TinyGo ç¼–å†™çš„æ ‡å‡†åº“æµ‹è¯•ã€‚æœ€åï¼Œæˆ‘ä»¬è¿è¡ŒåŸºå‡†æµ‹è¯•å¹¶å¯¹æ¯ä¸ªæ›´æ”¹è¿›è¡Œâ€œæ¨¡ç³Šæµ‹è¯•â€ã€‚æ‰€æœ‰è¿™äº›éƒ½ä½¿å¾— wazero çš„é”™è¯¯æ˜“äºè¯†åˆ«å’Œä¿®å¤ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ´»è·ƒçš„ç»ˆç«¯ç”¨æˆ·ç¤¾åŒºã€‚&lt;/strong&gt; wazero çš„ç¤¾åŒºåŒ…æ‹¬è®¸å¤šå…¬å¸çš„æå¼ºçš„å¼€å‘äººå‘˜ã€‚æˆ‘ä»¬æ¶‰åŠä¸€äº›ä¸ Go æ”¯æŒ WebAssembly æœ‰å…³çš„æ–¹é¢ï¼Œå¹¶ä¸º Go å’Œ TinyGo ç¼–è¯‘å™¨åšå‡ºè´¡çŒ®ã€‚è¯·æŸ¥çœ‹æˆ‘ä»¬çš„&lt;a href=&#34;https://wazero.io/community/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç¤¾åŒº&lt;/a&gt;å’Œ&lt;a href=&#34;https://wazero.io/community/users/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç”¨æˆ·&lt;/a&gt;é¡µé¢ï¼Œäº†è§£æ›´å¤šå…³äºæˆ‘ä»¬ä»¥åŠæ‚¨å¦‚ä½•èå…¥å…¶ä¸­çš„ä¿¡æ¯ï¼&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;å°†-wazero-åµŒå…¥æ‚¨çš„é¡¹ç›®ä¸­&#34;&gt;å°† wazero åµŒå…¥æ‚¨çš„é¡¹ç›®ä¸­&lt;/h2&gt;
&lt;p&gt;Wazero æ˜¾ç„¶ä¹Ÿæ˜¯ä¸€ä¸ª Go åº“ï¼Œå…¶ä¸»è¦ç›®æ ‡æ˜¯è®©æ‚¨ä¸è¿è¡Œæ—¶ç¯å¢ƒæ— ç¼é›†æˆï¼Œå¹¶ä½¿ç”¨ WebAssembly æ‰©å±•æ‚¨çš„ Go åº”ç”¨ç¨‹åºã€‚ä¾‹å¦‚ï¼Œå‡è®¾æ‚¨æƒ³è¿è¡Œ&lt;a href=&#34;https://en.wikipedia.org/wiki/Cowsay&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç»å…¸çš„ Unix ç¨‹åº cowsay&lt;/a&gt;ï¼ˆæœ€åˆæ˜¯ç”¨ Perl ç¼–å†™çš„ï¼‰ã€‚é‚£ä¹ˆæ‚¨å¯ä»¥è¾“å…¥ï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;// Download the executable from:
// https://github.com/evacchi/cowsay/releases/download/0.1.0/cowsay.wasm
//go:embed &amp;#34;cowsay.wasm&amp;#34;
var cowsay []byte

func main() {
	ctx := context.Background()
	r := wazero.NewRuntime(ctx)
	wasi_snapshot_preview1.MustInstantiate(ctx, r)
	r.InstantiateWithConfig(ctx, cowsay,
		wazero.NewModuleConfig().
			WithArgs(&amp;#34;cowsay&amp;#34;, // first arg is usually the executable name
				&amp;#34;wazero is awesome!&amp;#34;).
			WithStdout(os.Stdout))
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¿è¡Œå®ƒä¼šæ˜¾ç¤ºï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt; ____________________
&amp;lt; wazero is awesome! &amp;gt;
 --------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
               ||----w |
                ||     ||
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;ä½¿ç”¨-wazero-cli-å…¥é—¨&#34;&gt;ä½¿ç”¨ wazero CLI å…¥é—¨&lt;/h2&gt;
&lt;p&gt;è¯¥é¡¹ç›®ç°åœ¨åŒ…æ‹¬ä¸€ä¸ª CLIï¼Œç”¨äºè¿è¡Œ WebAssembly äºŒè¿›åˆ¶æ–‡ä»¶ã€‚æˆ‘ä»¬å‘ç°è®¸å¤šç”¨æˆ·æ— è®ºä½¿ç”¨å“ªç§ç¼–ç¨‹è¯­è¨€éƒ½é€‰æ‹©å®ƒï¼Œå› æ­¤æˆ‘ä»¬å†³å®šä½¿ç”¨è¿™ä¸ªä¾‹å­ã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä¸€ä¸ªç®€å•çš„å‘½ä»¤ä¸‹è½½å’Œå®‰è£… wazero CLIï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;$ curl https://wazero.io/install.sh | sh
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æˆ–è€…åœ¨ Windows ä¸Šï¼Œæ‚¨å¯ä»¥&lt;a href=&#34;https://github.com/tetratelabs/wazero/releases/download/v1.0.0-rc.2/wazero_1.0.0-rc.2_windows_amd64.msi&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä¸‹è½½æœ‰ MSI ç­¾åçš„&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿è¡Œæ‚¨çš„ WebAssembly äºŒè¿›åˆ¶æ–‡ä»¶ï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;$ ./bin/wazero run someApp.wasm
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ä¾‹å¦‚ï¼Œå‡è®¾æ‚¨æƒ³åœ¨ CLI ä¸Šè¿è¡Œ cowsayï¼Œé‚£ä¹ˆåªéœ€é”®å…¥&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;$ curl -LO https://github.com/evacchi/cowsay/releases/download/0.1.0/cowsay.wasm
$ wazero run cowsay.wasm wazero is awesome!
 ____________________
&amp;lt; wazero is awesome! &amp;gt;
 --------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
               ||----w |
                ||     ||
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æˆ–è€…ï¼Œä¹Ÿè®¸ä½ æ›´æƒ³ç© 1977 å¹´çš„ Infocom æ–‡æœ¬å†’é™©æ¸¸æˆ Zorkã€‚&lt;/p&gt;
&lt;p&gt;ä½ å¯ä»¥ä» &lt;a href=&#34;https://github.com/evacchi/zork-1/releases/tag/v0.0.1&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://github.com/evacchi/zork-1/releases/tag/v0.0.1&lt;/a&gt; è·å–ä¸€ä¸ª Wasm äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œç„¶åä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è°ƒç”¨ï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;$ curl -L https://github.com/evacchi/zork-1/releases/download/v0.0.1/zork-wasm-wasi.tgz | tar xzf -
$ wazero run -mount=.:/ zork.wasm
Welcome to Dungeon.			This version created 11-MAR-91.
You are in an open field west of a big white house with a boarded
front door.
There is a small mailbox here.
&amp;gt;open mailbox
Opening the mailbox reveals:
  A leaflet.
&amp;gt;read leaflet
Taken.
		    Welcome to Dungeon!

   Dungeon is a game of adventure, danger, and low cunning.  In it
you will explore some of the most amazing territory ever seen by mortal
man.  Hardened adventurers have run screaming from the terrors contained
within.

   In Dungeon, the intrepid explorer delves into the forgotten secrets
of a lost labyrinth deep in the bowels of the earth, searching for
vast treasures long hidden from prying eyes, treasures guarded by
fearsome monsters and diabolical traps!

   No DECsystem should be without one!
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å°½æƒ…ç©å§ï¼&lt;/p&gt;
&lt;h2 id=&#34;æœ€åçš„è¯&#34;&gt;æœ€åçš„è¯&lt;/h2&gt;
&lt;p&gt;è¿™æ˜¯æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªé‡å¤§å‘å¸ƒï¼Œä½†æˆ‘ä»¬æ‰åˆšåˆšå¼€å§‹ï¼&lt;strong&gt;æœ‰è®¸å¤šå€¼å¾—æœŸå¾…çš„äº‹æƒ…&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;WebAssembly è§„èŒƒæ­£åœ¨ä¸æ–­æ›´æ–°ï¼Œæˆ‘ä»¬å°†å¯†åˆ‡å…³æ³¨å®ƒï¼šä¾‹å¦‚ï¼Œ&lt;a href=&#34;https://github.com/WebAssembly/tail-call/blob/main/README.md&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;tail call proposal&lt;/a&gt; åˆšåˆšè¿›å…¥ç¬¬ 4 é˜¶æ®µï¼Œ&lt;a href=&#34;https://github.com/WebAssembly/gc/blob/master/proposals/gc/Overview.md&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;GC proposal&lt;/a&gt; åˆ™æ˜¯è®¸å¤šç¼–ç¨‹è¯­è¨€ï¼ˆå¦‚ Javaï¼‰çš„æ”¯æŒè€…ï¼Œæœ€è¿‘è¿›å…¥äº†ç¬¬ 3 é˜¶æ®µã€‚Wazero å°†ç»§ç»­é€šè¿‡æ‰€æœ‰æµ‹è¯•ï¼Œéšç€ WebAssembly çš„å‘å±•è€Œå‘å±•ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬è¿˜å¸Œæœ›ä½œä¸ºæ‚¨ WebAssembly è¿è¡Œæ—¶çš„æˆ˜ç•¥æ€§é€‰æ‹©ã€‚æ‚¨å¯ä»¥æœŸå¾…æŒç»­è‡´åŠ›äºæ€§èƒ½ï¼Œå¯è§‚æµ‹æ€§å’Œå¯æ‰©å±•æ€§ã€‚ä¸€ä¸ªä¾‹å­æ˜¯æˆ‘ä»¬å³å°†æ¨å‡ºçš„ä½çº§æ–‡ä»¶ç³»ç»Ÿæ’ä»¶ã€‚å®ƒæ”¯æŒæ¯” Go çš„ fs.FS æ›´å¤šçš„åŠŸèƒ½ï¼Œç°åœ¨å°±å¯ä»¥ä½¿ç”¨ï¼Œä¾‹å¦‚åˆ›å»ºç›®å½•å’Œæ–‡ä»¶ã€‚è¯¥è®¾è®¡æ”¯æŒè‡ªå®šä¹‰å®¡è®¡å’Œè®¿é—®æ§åˆ¶ï¼Œå¹¶å¯ç”¨äºç¬¬ä¸‰æ–¹ä¸»æœºå‡½æ•°ã€‚&lt;/p&gt;
&lt;p&gt;æœ€åï¼Œå¦‚æœæ‚¨åœ¨ 3 æœˆ 23 æ—¥å’Œ 24 æ—¥å‚åŠ å·´å¡ç½—é‚£çš„ Wasm I/O æ´»åŠ¨ï¼Œå°±æœ‰æœºä¼šè®¤è¯†æˆ‘ä»¬å›¢é˜Ÿçš„ä¸€éƒ¨åˆ†ï¼&lt;/p&gt;
&lt;p&gt;å¦‚æœæ‚¨åœ¨ä¼šè®®ç»“æŸåç•™åœ¨é‚£é‡Œï¼Œæˆ–è€…æ‚¨åªæ˜¯åœ¨é‚£ä¸ªæ™šä¸Šåœ¨åŸå¸‚é‡Œï¼Œ&lt;strong&gt;åœ¨ 3 æœˆ 24 æ—¥æ˜ŸæœŸäº”&lt;/strong&gt;ï¼Œæˆ‘ä»¬ä¹Ÿå¾ˆé«˜å…´&lt;a href=&#34;https://www.eventbrite.com/e/wazero-10-launch-party-tickets-585204150367&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;é‚€è¯·æ‚¨å‚åŠ  wazero 1.0 è‡ªå·±çš„å®˜æ–¹å‘å¸ƒæ´¾å¯¹&lt;/a&gt;ã€‚æˆ‘ä»¬å°†æä¾›å°åƒï¼Œé¥®æ–™å’Œè®¸å¤šç¤¾åŒºè´¡çŒ®è€…ï¼Œä»–ä»¬å°†å±•ç¤ºä»–ä»¬å¦‚ä½•ä½¿ç”¨æˆ‘ä»¬æ‰€é’Ÿçˆ±çš„ WebAssembly è¿è¡Œæ—¶ï¼ä¸€ä½å¹¸è¿çš„å‚ä¼šè€…å°†æœ‰æœºä¼šæŒ‰ä¸‹ 1.0 çš„å‘å¸ƒæŒ‰é’®ï¼&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¾ˆå…´å¥‹åœ°çœ‹åˆ°æ‚¨å°†å¦‚ä½•ä½¿ç”¨ Wazero æ„å»ºé¡¹ç›®ã€‚&lt;a href=&#34;https://wazero.io/community/users/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;åŠ å…¥æˆ‘ä»¬ä¸æ–­å¢é•¿çš„ç¤¾åŒºç”¨æˆ·åˆ—è¡¨&lt;/a&gt;ï¼Œå¹¶è®©æˆ‘ä»¬çŸ¥é“æ‚¨æ­£åœ¨åˆ›é€ ä»€ä¹ˆï¼&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>WebAssembly çœŸçš„ä»£è¡¨ç€æœªæ¥å—ï¼Ÿ</title>
      <link>https://lib.jimmysong.io/blog/is-webassembly-really-the-future/</link>
      <pubDate>Tue, 07 Mar 2023 11:00:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/is-webassembly-really-the-future/</guid>
      <description>&lt;blockquote&gt;
&lt;p&gt;è¯‘è€…æ³¨ï¼šè¿™ç¯‡æ–‡ç« ä»å¤šä¸ªè§’åº¦æ¢è®¨äº† WebAssemblyï¼ˆWasmï¼‰çš„ç°çŠ¶å’Œæœªæ¥ã€‚é¦–å…ˆï¼Œæ–‡ç« å¼•ç”¨äº† Cloud Native Computing Foundationï¼ˆCNCFï¼‰çš„æŠ¥å‘Šï¼ŒæŒ‡å‡º WebAssembly åœ¨ç½‘é¡µã€æ— æœåŠ¡å™¨ã€æ¸¸æˆå’Œå®¹å™¨åŒ–åº”ç”¨ä¸­çš„åº”ç”¨è¶Šæ¥è¶Šå¹¿æ³›ï¼Œå¹¶é¢„æµ‹ WebAssembly å°†æ˜¾è‘—å½±å“è¿™äº›åº”ç”¨ã€‚å…¶æ¬¡ï¼Œæ–‡ç« è®¨è®ºäº† WebAssembly åœ¨å®¹å™¨ã€è¾¹ç¼˜è®¡ç®—ã€ç¼–ç¨‹è¯­è¨€å’Œæ— æœåŠ¡å™¨åº”ç”¨ç­‰æ–¹é¢çš„åº”ç”¨ã€‚è™½ç„¶ WebAssembly å·²ç»æˆç†Ÿåœ°åº”ç”¨äºæµè§ˆå™¨ï¼Œä½†æ˜¯åœ¨åç«¯åº”ç”¨æ–¹é¢ï¼Œå¦‚è¾¹ç¼˜è®¾å¤‡çš„åº”ç”¨å’Œéƒ¨ç½²ï¼Œä»éœ€è¦æ›´å¤šçš„å·¥ä½œã€‚WASI å·²ç»æˆä¸ºå°† WebAssembly æ‰©å±•åˆ°æµè§ˆå™¨ä¹‹å¤–çš„æœ€ä½³é€‰æ‹©ï¼Œå¯ä»¥å¸®åŠ©è§£å†³åœ¨ä»»ä½•é…ç½®æ­£ç¡®çš„ CPU ä¸Šè¿è¡Œ WebAssembly è¿è¡Œæ—¶çš„å¤æ‚æ€§ã€‚WebAssembly å’Œå®¹å™¨çš„åº”ç”¨é¢„è®¡å°†å…±åŒå¢é•¿ï¼Œå°½ç®¡ WebAssembly åœ¨æŸäº›ç”¨ä¾‹ä¸­å¯ä»¥å–ä»£å®¹å™¨ï¼Œä½†æ€»ä½“æ¥è¯´ï¼Œä¸¤è€…æ˜¯äº’è¡¥çš„äº§å“ã€‚WebAssembly çš„æœªæ¥çœ‹èµ·æ¥éå¸¸å…‰æ˜ï¼Œä½†æ˜¯åœ¨å¯é å’Œé«˜æ•ˆåœ°æ”¯æŒ WebAssembly åœ¨æµè§ˆå™¨ä¹‹å¤–çš„ç”Ÿäº§ç”¨ä¾‹æ–¹é¢ï¼Œä»æœ‰å¾ˆå¤šå·¥ä½œè¦åšã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;a href=&#34;https://cncf.io/?utm_content=inline-mention&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;äº‘åŸç”Ÿè®¡ç®—åŸºé‡‘ä¼š (CNCF)&lt;/a&gt; æœ€è¿‘çš„&lt;a href=&#34;https://www.cncf.io/reports/cncf-annual-survey-2022/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¹´åº¦è°ƒæŸ¥åŒ…æ‹¬&lt;/a&gt;&lt;a href=&#34;https://thenewstack.io/how-webassembly-could-streamline-cloud-native-computing/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;WebAssembly (Wasm)&lt;/a&gt; å¤§èƒ†å£°æ˜ï¼šâ€œå®¹å™¨æ˜¯æ–°å¸¸æ€ï¼ŒWebAssembly æ˜¯æœªæ¥â€ã€‚&lt;/p&gt;
&lt;p&gt;è¿™å¥è¯é¢„ç¤ºäº†å¾ˆå¤šäº‹æƒ…ï¼Œä¸ä»…æ˜¯å…³äº WebAssembly çš„è·¯çº¿å›¾å’Œå‘å±•ï¼Œè¿˜æœ‰å®ƒç›®å‰åœ¨è®¡ç®—é¢†åŸŸçš„åœ°ä½ã€‚æ® CNCF ç§°ï¼Œ37% çš„æœ€ç»ˆç”¨æˆ·ç»„ç»‡å·²ç»å…·æœ‰ä½¿ç”¨ WebAssembly éƒ¨ç½²åº”ç”¨ç¨‹åºçš„ç»éªŒã€‚æ ¹æ® CNCF æŠ¥å‘Šï¼Œè™½ç„¶å…¶ä¸­è®¸å¤šç”¨é€”æ˜¯ä¸ºäº†æµ‹è¯• Wasm çš„ä¼˜ç‚¹ï¼Œä½† &lt;a href=&#34;https://wasmedge.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;WasmEdge&lt;/a&gt; å’Œ &lt;a href=&#34;https://github.com/bytecodealliance/wasm-micro-runtime&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;WAMR&lt;/a&gt; æ˜¯æœ€å¸¸ç”¨çš„è¿è¡Œæ—¶ã€‚&lt;/p&gt;
&lt;p&gt;CNCF ç”Ÿæ€ç³»ç»Ÿè´Ÿè´£äºº Taylor Dolezal åœ¨å¯¹ TheNewStack ç”µå­é‚®ä»¶å›å¤ä¸­è¯´ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ WebAssembly çš„é‡‡ç”¨å°†èµ°å‘ä½•æ–¹ï¼Œå®ƒçš„è·¯çº¿å›¾å’Œæœªæ¥åœ¨è®¡ç®—ä¸­çš„ä½ç½®æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿè®©æˆ‘ä»¬çœ‹çœ‹ Wasm åœ¨&lt;a href=&#34;https://thenewstack.io/containers/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å®¹å™¨&lt;/a&gt;ã€&lt;a href=&#34;https://thenewstack.io/edge-computing/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è¾¹ç¼˜&lt;/a&gt;å’Œå…¶ä»–åº”ç”¨ç¨‹åºã€&lt;a href=&#34;https://thenewstack.io/25-most-popular-programming-languages-used-by-devops-pros/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç¼–ç¨‹è¯­è¨€&lt;/a&gt; å’Œæ— æœåŠ¡å™¨é›†æˆåŠå…¶æœªæ¥ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æœªæ¥&#34;&gt;æœªæ¥&lt;/h2&gt;
&lt;p&gt;å¯ä»¥è¯´ï¼Œæ‚¨å¯èƒ½ä¼šäº‰è¾©è¯´ Wasm ä¸æœªæ¥æ— å…³ï¼Œä½†å®ƒåœ¨æœ€åˆåˆ›å»ºçš„æ‰€æœ‰ä¸»è¦ç½‘ç»œæµè§ˆå™¨ä¸­çš„ä½¿ç”¨å·²ç»å¾ˆé‡è¦äº†ã€‚ä½†æ˜¯ï¼Œè™½ç„¶ Wasm åœ¨æµè§ˆå™¨ä¸­å·²ç»æˆç†Ÿï¼Œä½†åœ¨å®ƒæˆä¸ºæœªæ¥çš„ä¸€éƒ¨åˆ†ç”¨äºåç«¯åº”ç”¨ç¨‹åºä¹‹å‰ï¼Œè¿˜éœ€è¦åšæ›´å¤šçš„å·¥ä½œï¼Œä¾‹å¦‚å®ƒåœ¨è¾¹ç¼˜è®¾å¤‡ä¸­çš„ä½¿ç”¨å’Œéƒ¨ç½²ã€‚&lt;/p&gt;
&lt;p&gt;äº‹å®ä¸Šï¼Œå®ƒå¹¶ä¸åƒå°† &lt;a href=&#34;https://thenewstack.io/an-introduction-to-python-for-non-programmers/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Python&lt;/a&gt; æ·»åŠ åˆ° Wasm ç„¶åé€šè¿‡æ‰˜ç®¡ Wasm è¿è¡Œæ—¶çš„ Wasi è¿è¡ŒåŒ…é‚£ä¹ˆç®€å•ã€‚ &lt;a href=&#34;https://thenewstack.io/machine-learning/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç”¨äºæœºå™¨å­¦ä¹ &lt;/a&gt;å’Œ Python ä¸“é—¨é€‚é…çš„æ•°æ®åˆ†æç­‰åç«¯åº”ç”¨ï¼Œå…¶åœ¨åˆšåˆšå¼€å‘ç¼–è¯‘çš„å¤§é‡ç¬¬ä¸‰æ–¹ä¾èµ–çš„ Wasm ä¸­çš„åº”ç”¨å¯†åˆ‡ç›¸å…³ã€‚&lt;/p&gt;
&lt;p&gt;Wasm &lt;a href=&#34;https://thenewstack.io/pipelines-paas-continuously-delivering-continuous-delivery/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¹³å°å³æœåŠ¡ (PaaS)&lt;/a&gt; äº§å“æˆ–å¹³å°å°šä¸å­˜åœ¨ï¼Œå¯è½»æ¾ç”¨äºå°† WebAssembly å€Ÿç»™åç«¯åº”ç”¨ç¨‹åºã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒWasm åœ¨æµè§ˆå™¨ä¹‹å¤–çš„åº”ç”¨æ‰åˆšåˆšå…´èµ·ã€‚&lt;/p&gt;
&lt;p&gt;Enterprise Management Associates çš„åˆ†æå¸ˆ &lt;a href=&#34;https://www.linkedin.com/in/torstenvolk&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Torsten Volk&lt;/a&gt;  å‘Šè¯‰ The New Stackã€‚ç¼ºå°‘ä»€ä¹ˆï¼Œæˆ‘ä»¬ä¼šä¸€è·¯æ‰¾åˆ°ã€‚å±Šæ—¶ï¼Œå¼€æºé¡¹ç›®å’Œå•†ä¸šä¾›åº”å•†å°†ä»‹å…¥ä»¥å¡«è¡¥è¿™äº›ç©ºç™½ï¼Œå¹¶æä¾›æœ€ä½³çš„å¼€å‘äººå‘˜å’Œ &lt;a href=&#34;https://thenewstack.io/the-what-why-and-how-of-devops/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;DevOps&lt;/a&gt; ä½“éªŒã€‚ â€&lt;/p&gt;
&lt;p&gt;å°†æœåŠ¡å™¨ç«¯ï¼ˆss-Wasmï¼‰WebAssembly ä¸ç”¨äºæµè§ˆå™¨åº”ç”¨ç¨‹åºçš„ Wasm åŒºåˆ†å¼€æ¥ï¼Œss-Wasm æœ‰ç€å…‰æ˜çš„æœªæ¥ï¼Œè€Œé‡‡ç”¨ ss-Wasm çš„é“è·¯å¾ˆé•¿ï¼Œè€Œä¸”â€œå…¶ä¸­å¾ˆå¤šä»ç„¶éœ€è¦æ˜ å°„â€ï¼Œ&lt;a href=&#34;https://www.linkedin.com/in/wiqar?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAACh3tYBq_83ujeBLYcODDpkucuxdpr-KhU&amp;amp;lipi=urn%3Ali%3Apage%3Ad_flagship3_detail_base1H2B1rTin6PqQia%3D&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Wiqar Chaudry&lt;/a&gt;ï¼ŒXmbia é¡¹ç›®åä½œå¹³å°çš„åˆ›å§‹äººå’Œ CEOï¼Œå‘Šè¯‰ The New Stackã€‚&lt;/p&gt;
&lt;p&gt;â€œæœ‰ä¸¤ä¸ªéå¸¸ç®€å•çš„æŒ‡æ ‡ï¼šWasm åœ¨åˆ›å»ºè½¯ä»¶æ—¶æ˜¯å¦æœ‰æ˜ç¡®çš„ç»æµä»·å€¼ä¸»å¼ ï¼Ÿå®ƒä¼šé™ä½æˆæœ¬ï¼Œå¸®åŠ©å…¬å¸å’Œå¼€å‘å•†èµšæ›´å¤šé’±ï¼Œè¿˜æ˜¯å¸®åŠ©é‡Šæ”¾å…¶ä»–ç±»å‹çš„æœªå®ç°ä»·å€¼ï¼Ÿâ€Chaudry è¯´ï¼Œä»–ä¹Ÿå‚ä¸äº† &lt;a href=&#34;https://wasmer.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Wasmer&lt;/a&gt; é¡¹ç›®ï¼Œç›®å‰æ‹…ä»»é¡¾é—®ã€‚&lt;/p&gt;
&lt;p&gt;â€œç¬¬äºŒä¸ªæ˜¯å®ƒçš„æŠ€æœ¯ä»·å€¼ä¸»å¼ ã€‚å®ƒæ˜¯å¦å¸å¼•äº†è¶³å¤Ÿå¤šçš„å¼€å‘äººå‘˜å¹¶è§£å†³äº†è¶³å¤Ÿå¤šçš„æŠ€æœ¯éš¾é¢˜ï¼Œä½¿ä»–ä»¬èƒ½å¤Ÿè´Ÿæ‹…å¾—èµ·ä½¿ç”¨ Wasm ä½œä¸ºå…¶æŠ€æœ¯æ ˆçš„ä¸€éƒ¨åˆ†ï¼Ÿâ€&lt;/p&gt;
&lt;h2 id=&#34;wasi&#34;&gt;WASI&lt;/h2&gt;
&lt;p&gt;å°±ç›®å‰è€Œè¨€ï¼ŒWASI å·²æˆä¸ºå°† Wasm èŒƒå›´æ‰©å±•åˆ°æµè§ˆå™¨ä¹‹å¤–çš„æœ€ä½³é€‰æ‹©ã€‚è¢«æè¿°ä¸º WebAssembly çš„&lt;a href=&#34;https://wasi.dev/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ¨¡å—åŒ–ç³»ç»Ÿæ¥å£&lt;/a&gt;ï¼Œå®ƒå·²è¢«è¯æ˜æœ‰åŠ©äºè§£å†³åœ¨ä»»ä½•æœ‰æ­£ç¡®é…ç½®çš„ CPU çš„åœ°æ–¹è¿è¡Œ Wasm è¿è¡Œæ—¶çš„å¤æ‚æ€§â€”â€”è¿™ä¸€ç›´æ˜¯ WebAssembly è‡ªåˆ›å»ºä»¥æ¥çš„ä¸»è¦å–ç‚¹ä¹‹ä¸€ã€‚&lt;/p&gt;
&lt;p&gt;Fermyon Technologies çš„è”åˆåˆ›å§‹äººå…¼é¦–å¸­æ‰§è¡Œå®˜ &lt;a href=&#34;https://www.linkedin.com/in/mattbutcher/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Matt Butcher&lt;/a&gt; å‘Šè¯‰ The New Stackï¼šâ€œæˆ‘ç›¸ä¿¡ WebAssembly ä½œä¸ºä¸€ç§é€šç”¨æŠ€æœ¯çš„å…³é”®ç‰¹æ€§æ˜¯ä¸ºäº†æ”¯æŒ &lt;a href=&#34;https://thenewstack.io/mozilla-extends-webassembly-beyond-the-browser-with-wasi/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;WebAssembly ç³»ç»Ÿæ¥å£ (WASI)&lt;/a&gt;â€ã€‚ â€œWASI å…è®¸å¼€å‘äººå‘˜åœ¨ä»–ä»¬çš„ä»£ç ä¸­ä½¿ç”¨ç†Ÿæ‚‰çš„ç³»ç»Ÿä¹ æƒ¯ç”¨æ³•ï¼Œä¾‹å¦‚æ‰“å¼€æ–‡ä»¶å’Œè¯»å–ç¯å¢ƒå˜é‡ï¼Œè€Œä¸ä¼šç ´å WebAssembly å®‰å…¨æ¨¡å‹ã€‚éšç€ WASI æ”¯æŒå˜å¾—æ›´åŠ å¹¿æ³›ï¼Œæˆ‘ä»¬å°†çœ‹åˆ° WebAssembly ç”¨ä¾‹çš„çˆ†ç‚¸å¼å¢é•¿ã€‚â€&lt;/p&gt;
&lt;p&gt;ç„¶è€Œï¼ŒWASI ä»åœ¨èµ°å‘æˆç†Ÿã€‚ â€œWASI çš„ç¬¬ä¸€ä¸ªç‰ˆæœ¬å‘æˆ‘ä»¬å±•ç¤ºäº† WebAssembly çš„æ½œåŠ›ã€‚ç¬¬äºŒä¸ªç‰ˆæœ¬ Preview 2 å°†åœ¨å‡ ä¸ªæœˆåå‘å¸ƒï¼Œâ€Butcher è¯´ã€‚ â€œPreview 2 ä¸­æ·»åŠ çš„ç½‘ç»œåŠŸèƒ½å°†å¼€è¾Ÿå¤§é‡æ–°ç”¨é€”ã€‚â€&lt;/p&gt;
&lt;p&gt;Cosmonic é¦–å¸­æ‰§è¡Œå®˜å…¼è”åˆåˆ›å§‹äºº &lt;a href=&#34;https://www.linkedin.com/in/hectaman&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Liam Randall&lt;/a&gt; è¡¨ç¤ºï¼ŒWebAssembly å°†åˆ©ç”¨ç»„ä»¶å’Œ WASI å°†é€šç”¨åº”ç”¨ç¨‹åºåº“æŠ½è±¡ä¸ºé€šç”¨å¯æ‹”æ’ç»„ä»¶ã€‚ä»–è¯´ï¼Œå‘å¸ƒ - è®¢é˜…æ¶ˆæ¯ä¼ é€’æˆ–ç‰¹å®š SQL æœåŠ¡å™¨ç­‰ç»„ä»¶ä½œä¸ºæŠ½è±¡è€Œä¸æ˜¯ä¸ç‰¹å®šåº“çš„ç´§å¯†è€¦åˆäº¤ä»˜ç»™åº”ç”¨ç¨‹åºã€‚&lt;/p&gt;
&lt;p&gt;â€œå½“å®¹å™¨å‡ºç°æ—¶ï¼Œå®ƒä»¬æ›´å°ï¼Œå¯åŠ¨é€Ÿåº¦æ›´å¿«ï¼Œå¹¶ä¸ºå¼€å‘äººå‘˜æä¾›äº†æ¯”è™šæ‹Ÿæœºæ›´å°çš„è¡¨é¢åŒºåŸŸæ¥é…ç½®å’Œç»´æŠ¤ï¼Œâ€Randall è¯´ã€‚ â€œWebAssembly æ¨¡å—å»¶ç»­äº†è¿™ä¸€è¶‹åŠ¿ï¼Œä½“ç§¯æ›´å°ï¼Œå¯åŠ¨é€Ÿåº¦æ›´å¿«ï¼Œå¹¶åˆ©ç”¨ç»„ä»¶æ¥å‡å°‘å¼€å‘äººå‘˜ç¼–å†™å’Œç»´æŠ¤çš„ä»£ç é‡ã€‚â€&lt;/p&gt;
&lt;p&gt;â€œæ›´é‡è¦çš„æ˜¯ï¼Œç»„ä»¶æ¨¡å‹æ˜¯ä¸€ç§æ–°çš„åº”ç”¨ç¨‹åºæ–¹æ³•ï¼Œå®ƒå…è®¸é¢å‘èƒ½åŠ›çš„å®‰å…¨æ€§ï¼Œå¹¶ä½¿å¹³å°è¿è¥å•†æ›´å®¹æ˜“å®‰å…¨åœ°è¿è¡Œåº”ç”¨ç¨‹åºã€‚â€&lt;/p&gt;
&lt;p&gt;Wasm ä½¿ç”¨ WASI è¿›è¡Œç³»ç»Ÿçº§é›†æˆ API è¿›ä¸€æ­¥æé«˜äº†å®ƒä½œä¸ºé€šç”¨è¿è¡Œæ—¶çš„å¯è¡Œæ€§ï¼ŒDolezal è¯´ï¼šâ€œWebAssembly åœ¨å®‰å…¨ç¯å¢ƒä¸­æ‰˜ç®¡ä¸å—ä¿¡ä»»ä»£ç çš„èƒ½åŠ›ä¹Ÿæ˜¯ä¸€ä¸ªé‡è¦çš„å¥½å¤„ã€‚â€&lt;/p&gt;
&lt;h2 id=&#34;ä¸å®¹å™¨çš„å…³ç³»&#34;&gt;ä¸å®¹å™¨çš„å…³ç³»&lt;/h2&gt;
&lt;p&gt;æ­£å¦‚ CNCF æŠ¥å‘Šæ‰€è¿°ï¼Œ&lt;a href=&#34;https://thenewstack.io/containers/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å®¹å™¨&lt;/a&gt; ç¡®å®æ˜¯â€œæ–°å¸¸æ€â€ï¼Œå°¤å…¶æ˜¯åœ¨äº‘åŸç”Ÿé¢†åŸŸã€‚åœ¨æŸäº›ç”¨ä¾‹ä¸­ï¼ŒWasm å¯ä»¥å–ä»£å®¹å™¨ï¼Œä½†æ€»çš„æ¥è¯´ï¼ŒWebAssembly å’Œå®¹å™¨çš„é‡‡ç”¨å°†åŒæ­¥å¢é•¿ã€‚&lt;/p&gt;
&lt;p&gt;â€œæˆ‘ç»å¯¹ç›¸ä¿¡ Kubernetes å’Œ Wasm æ˜¯äº’è¡¥çš„äº§å“ï¼ŒKubernetes è´Ÿè´£é…ç½®å’Œæ‰©å±•åŸºç¡€è®¾æ–½ï¼Œè€Œ Wasm åœ¨è¯¥åŸºç¡€è®¾æ–½ä¹‹ä¸Šæä¾›åº”ç”¨ç¨‹åºï¼ŒåŒ…æ‹¬å…¶è¿è¡Œæ—¶ï¼Œâ€Volk è¯´ã€‚&lt;/p&gt;
&lt;p&gt;Kubernetes é‡‡ç”¨çš„è·¯å¾„å¯ä»¥ä½œä¸º Wasm å¦‚ä½•ä»¥åŠä½•æ—¶å¤§è§„æ¨¡é‡‡ç”¨çš„å¯èƒ½æ¨¡å‹ã€‚ â€œç”±äº Kubernetes çš„å¹¿æ³›å¯ç”¨æ€§ä»¥åŠä½¿ç”¨ã€æ‰©å±•å’Œæ”¯æŒå®ƒçš„å·¥å…·ï¼ŒKubernetes è¢«å¹¿æ³›é‡‡ç”¨ï¼Œâ€Chaudry è¯´ã€‚ â€œå¦‚æœ Kubernetes ä¸åƒ AKSã€EKS æˆ– GKE é‚£æ ·å®¹æ˜“è·å¾—ï¼Œæˆ‘ä»¬å°±ä¼šçœ‹åˆ°æ›´å°‘çš„é‡‡ç”¨å’Œä½¿ç”¨ã€‚WebAssembly ä¹Ÿä¼šèµ°åŒæ ·çš„è·¯ã€‚â€&lt;/p&gt;
&lt;p&gt;Wasm ä¹Ÿåªè§£å†³äº†å®¹å™¨æ‰€åšçš„ä¸€äº›é—®é¢˜ï¼Œä»–è¯´ï¼šâ€œå®¹å™¨æ›´å¤æ‚ï¼Œè¿è¥å¼€é”€æ›´é«˜ã€‚ä¸¤è€…ä¹‹é—´çš„æƒè¡¡ä½¿å¾—ä¸¤è€…åŒæ­¥å¢é•¿æ˜¯åˆç†çš„ã€‚â€&lt;/p&gt;
&lt;p&gt;Butcher è¡¨ç¤ºï¼Œå½“ DockerHub å¼€å§‹æ”¯æŒæ–°çš„å·¥ä»¶å­˜å‚¨è§„èŒƒæ—¶ï¼ŒWasm ç¤¾åŒºæ„è¯†åˆ°ï¼Œä¸å…¶é‡æ–°å‘æ˜è½®å­ï¼Œä¸å¦‚å°† Wasm è¿è¡Œæ—¶å­˜å‚¨åœ¨ Docker Hub ç­‰ &lt;a href=&#34;https://thenewstack.io/oci-reveals-governance-structure-amid-debate-focus/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Open Container Initiative registries&lt;/a&gt; ä¸­ä¼šæ›´å¥½ã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œæœ¬æœˆ Fermyon çš„ Spin 0.8 å¼€å§‹æ”¯æŒ OCI æ³¨å†Œè¡¨ã€‚ â€œè™½ç„¶æˆ‘ä»¬æœ€åˆä¸ç¡®å®š OCI æ³¨å†Œè¡¨æ˜¯å¦æ˜¯æ­£ç¡®çš„åˆ†å‘æœºåˆ¶ï¼Œä½†æ ‡å‡†çš„æ¼”å˜åŠ ä¸Š Docker Hub çš„æ”¯æŒæ”¹å˜äº†æˆ‘ä»¬çš„æƒ³æ³•ï¼Œâ€Butcher è¯´ã€‚ â€œæˆ‘ä»¬è‡´åŠ›äºä½¿ç”¨ OCI æ³¨å†Œè¡¨åˆ†å‘ WebAssembly åº”ç”¨ç¨‹åºï¼Œå¹¶ä¸”ä»Šå¤©å·²ç»å®ç°äº†ã€‚â€&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Rust ç¼–è¯‘ WebAssembly æŒ‡å—</title>
      <link>https://lib.jimmysong.io/blog/rust-to-wasm/</link>
      <pubDate>Fri, 24 Feb 2023 11:00:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/rust-to-wasm/</guid>
      <description>&lt;p&gt;ä¸‹é¢æ˜¯æˆ‘æ‰€çŸ¥é“çš„å…³äºå°† Rust ç¼–è¯‘ä¸º WebAssembly çš„æ‰€æœ‰çŸ¥è¯†ã€‚&lt;/p&gt;
&lt;p&gt;å‰ä¸€æ®µæ—¶é—´ï¼Œæˆ‘å†™äº†ä¸€ç¯‡&lt;a href=&#34;https://surma.dev/things/c-to-webassembly&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¦‚ä½•åœ¨æ²¡æœ‰ Emscripten çš„æƒ…å†µä¸‹å°† C ç¼–è¯‘ä¸º WebAssembly&lt;/a&gt; çš„åšå®¢æ–‡ç« ï¼Œå³ä¸é»˜è®¤å·¥å…·æ¥ç®€åŒ–è¿™ä¸ªè¿‡ç¨‹ã€‚åœ¨ Rust ä¸­ï¼Œä½¿ WebAssembly å˜å¾—ç®€å•çš„å·¥å…·ç§°ä¸º &lt;a href=&#34;https://rustwasm.github.io/wasm-bindgen/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;wasm-bindgen&lt;/a&gt;ï¼Œæˆ‘ä»¬æ­£åœ¨æ”¾å¼ƒå®ƒï¼åŒæ—¶ï¼ŒRust æœ‰ç‚¹ä¸åŒï¼Œå› ä¸º WebAssembly é•¿æœŸä»¥æ¥ä¸€ç›´æ˜¯ä¸€æµçš„ç›®æ ‡ï¼Œå¹¶ä¸”å¼€ç®±å³ç”¨åœ°æä¾›äº†æ ‡å‡†åº“å¸ƒå±€ã€‚&lt;/p&gt;
&lt;h2 id=&#34;rust-ç¼–è¯‘-webassembly-å…¥é—¨&#34;&gt;Rust ç¼–è¯‘ WebAssembly å…¥é—¨&lt;/h2&gt;
&lt;p&gt;è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•è®© Rust ä»¥å°½å¯èƒ½å°‘çš„åç¦»æ ‡å‡† Rust å·¥ä½œæµç¨‹çš„æ–¹å¼ç¼–è¯‘æˆ WebAssemblyã€‚å¦‚æœä½ æµè§ˆäº’è”ç½‘ï¼Œè®¸å¤šæ–‡ç« å’ŒæŒ‡å—éƒ½ä¼šå‘Šè¯‰ä½ ä½¿ç”¨ &lt;code&gt;cargo init --lib&lt;/code&gt; åˆ›å»ºä¸€ä¸ª Rust åº“é¡¹ç›®ï¼Œç„¶åå°† &lt;code&gt;crate-type = [&amp;quot;cdylib&amp;quot;]&lt;/code&gt; æ·»åŠ åˆ°ä½ çš„ &lt;code&gt;cargo.toml&lt;/code&gt;ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-ini&#34; data-lang=&#34;ini&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;[package]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;na&#34;&gt;name&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;my_project&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;na&#34;&gt;version&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;0.1.0&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;na&#34;&gt;edition&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;2021&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;[lib]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;na&#34;&gt;crate-type&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;[&amp;#34;cdylib&amp;#34;]
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;   &lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;[dependencies]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¦‚æœä½ ä¸å°† crate ç±»å‹è®¾ç½®ä¸º &lt;code&gt;cdylib&lt;/code&gt;ï¼ŒRust ç¼–è¯‘å™¨å°†ç”Ÿæˆä¸€ä¸ª &lt;code&gt;.rlib&lt;/code&gt; æ–‡ä»¶ï¼Œè¿™æ˜¯ Rust è‡ªå·±çš„åº“æ ¼å¼ã€‚è™½ç„¶ &lt;code&gt;cdylib&lt;/code&gt; è¿™ä¸ªåå­—æš—ç¤ºäº†ä¸€ä¸ªä¸ C å…¼å®¹çš„åŠ¨æ€åº“ï¼Œä½†æˆ‘æ€€ç–‘å®ƒçœŸçš„åªæ˜¯ä»£è¡¨â€œä½¿ç”¨å¯äº’æ“ä½œçš„æ ¼å¼â€æˆ–ç±»ä¼¼çš„ä¸œè¥¿ã€‚&lt;/p&gt;
&lt;div class=&#34;alert-note-title&#34;&gt;
    &lt;p&gt;ä»€ä¹ˆæ˜¯ crate?&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;alert alert-note&#34;&gt;
    &lt;p&gt;åœ¨ Rust ç¼–ç¨‹ä¸­ï¼ŒCrateï¼ˆä¸­æ–‡æ„æ€æ˜¯ &amp;ldquo;æ¿æ¡ç®±&amp;rdquo;ï¼‰æŒ‡çš„æ˜¯ Rust è¯­è¨€ä¸­çš„åŒ…ï¼ˆPackageï¼‰ï¼Œæ˜¯ Rust ä»£ç çš„ä¸€ä¸ªå•å…ƒï¼Œç”¨äºç»„ç»‡ã€æ„å»ºå’Œå…±äº« Rust ä»£ç ã€‚ä¸€ä¸ª Crate å¯ä»¥åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªæ¨¡å—ï¼ˆModuleï¼‰ï¼Œå¹¶ä¸”å¯ä»¥è¢«å…¶ä»– Crate å¼•ç”¨å’Œä½¿ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;æ¯ä¸ª Crate éƒ½éœ€è¦æœ‰ä¸€ä¸ª Cargo.toml æ–‡ä»¶ä½œä¸ºå…¶é…ç½®æ–‡ä»¶ã€‚Cargo.toml ä¸­åŒ…å«äº† Crate çš„å…ƒä¿¡æ¯ï¼Œå¦‚åç§°ã€ç‰ˆæœ¬ã€ä½œè€…ã€ä¾èµ–ç­‰ä¿¡æ¯ã€‚åŒæ—¶ï¼ŒCargo.toml ä¸­è¿˜å¯ä»¥å®šä¹‰ç¼–è¯‘å™¨é€‰é¡¹ã€ç¯å¢ƒå˜é‡ç­‰é…ç½®ä¿¡æ¯ï¼Œç”¨äºæ„å»ºå’Œå‘å¸ƒ Crateã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ Rust ç¤¾åŒºä¸­ï¼Œæœ‰å¾ˆå¤šä¼˜ç§€çš„ Crate å¯ä»¥ä¾›ä½¿ç”¨ã€‚é€šè¿‡å¼•ç”¨è¿™äº› Crateï¼Œå¯ä»¥å¿«é€Ÿã€ç®€ä¾¿åœ°å¼€å‘é«˜è´¨é‡çš„ Rust åº”ç”¨ç¨‹åºã€‚åŒæ—¶ï¼ŒRust ç¤¾åŒºä¹Ÿé¼“åŠ±å¼€å‘è€…è´¡çŒ®è‡ªå·±çš„ Crateï¼Œä»¥ä¾¿å…¶ä»–å¼€å‘è€…ä½¿ç”¨å’Œè´¡çŒ®ã€‚&lt;/p&gt;
&lt;p&gt;cdylib ä¹Ÿå¯ä»¥è¢«ç§°ä¸º &amp;ldquo;C-compatible Dynamic Library&amp;rdquo;ã€‚cdylib Crate å¯ä»¥é€šè¿‡ Rust è¯­è¨€ç¼–å†™åŠ¨æ€é“¾æ¥åº“ï¼Œå¹¶å°†å…¶å¯¼å‡ºä¸º C ABIï¼ˆApplication Binary Interfaceï¼‰ã€‚è¿™ä½¿å¾—å…¶ä»–è¯­è¨€ï¼ˆå¦‚ Cã€C++ã€Pythonã€Java ç­‰ï¼‰å¯ä»¥é€šè¿‡ C ABI æ¥å£è°ƒç”¨ Rust åŠ¨æ€é“¾æ¥åº“ä¸­çš„å‡½æ•°å’Œå˜é‡ã€‚è¿™å¯¹äº Rust ä¸å…¶ä»–è¯­è¨€çš„äº’æ“ä½œæ€§éå¸¸é‡è¦ï¼Œç‰¹åˆ«æ˜¯åœ¨éœ€è¦ä¸ç°æœ‰ä»£ç è¿›è¡Œé›†æˆçš„æƒ…å†µä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ cdylib Crate å¯ä»¥æ–¹ä¾¿åœ°åˆ›å»ºå’Œå‘å¸ƒ Rust åŠ¨æ€é“¾æ¥åº“ï¼Œå¹¶å°†å…¶ä¸å…¶ä»–è¯­è¨€è¿›è¡Œé›†æˆã€‚åŒæ—¶ï¼Œcdylib Crate ä¹Ÿæä¾›äº†ä¸€äº›ä¸åŠ¨æ€é“¾æ¥åº“ç›¸å…³çš„å·¥å…·å’Œ APIï¼Œå¦‚åŠ¨æ€é“¾æ¥åº“ç‰ˆæœ¬ç®¡ç†ã€ç¬¦å·å¯¼å‡ºç­‰ã€‚è¿™äº›å·¥å…·å’Œ API å¯ä»¥æ–¹ä¾¿åœ°å°† Rust åŠ¨æ€é“¾æ¥åº“çš„å¼€å‘å’Œé›†æˆè¿‡ç¨‹å˜å¾—æ›´åŠ ç®€å•ã€å¯é å’Œé«˜æ•ˆã€‚&lt;/p&gt;

&lt;/div&gt;

&lt;p&gt;ç°åœ¨ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ Cargo åœ¨åˆ›å»ºæ–°åº“æ—¶ç”Ÿæˆçš„é»˜è®¤/ç¤ºä¾‹å‡½æ•°ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;left&lt;/span&gt;: &lt;span class=&#34;kt&#34;&gt;usize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;right&lt;/span&gt;: &lt;span class=&#34;kt&#34;&gt;usize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;kt&#34;&gt;usize&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;left&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;right&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¸€åˆ‡å°±ç»ªåï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥å°†è¿™ä¸ªåº“ç¼–è¯‘ä¸º WebAssemblyï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cargo build --target&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;wasm32-unknown-unknown --release
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä½ ä¼šåœ¨ &lt;code&gt;target/wasm32-unknown-unknown/release/my_project.wasm&lt;/code&gt; æ‰¾åˆ°å®ƒã€‚åœ¨æ•´ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†ç»§ç»­ä½¿ç”¨ &lt;code&gt;--release&lt;/code&gt; è¿›è¡Œæ„å»ºï¼Œå› ä¸ºå®ƒä½¿ WebAssembly æ¨¡å—åœ¨æˆ‘ä»¬åæ±‡ç¼–æ—¶æ›´å…·å¯è¯»æ€§ã€‚&lt;/p&gt;
&lt;div class=&#34;alert-note-title&#34;&gt;
    &lt;p&gt;ä»€ä¹ˆæ˜¯ Cargoï¼Ÿ&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;alert alert-note&#34;&gt;
    &lt;p&gt;Cargo æ˜¯ä¸€ä¸ª Rust é¡¹ç›®ç®¡ç†å·¥å…·ï¼Œç”¨äºæ„å»ºã€æµ‹è¯•ã€å‘å¸ƒ Rust åº”ç”¨ç¨‹åºå’Œåº“ã€‚Cargo æä¾›äº†ä¸€ä¸ªå‘½ä»¤è¡Œç•Œé¢å’Œä¸€ç»„ Rust APIï¼Œç”¨äºç®¡ç†é¡¹ç›®ä¾èµ–ã€ç¼–è¯‘ã€æµ‹è¯•å’Œå‘å¸ƒè¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯ Cargo æä¾›çš„ä¸»è¦åŠŸèƒ½ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä¾èµ–ç®¡ç†ï¼šCargo å¯ä»¥é€šè¿‡ Cargo.toml æ–‡ä»¶ç®¡ç† Rust é¡¹ç›®çš„ä¾èµ–ã€‚å½“æ·»åŠ ã€æ›´æ–°æˆ–åˆ é™¤ä¾èµ–æ—¶ï¼ŒCargo ä¼šè‡ªåŠ¨å¤„ç†ä¾èµ–çš„ç‰ˆæœ¬æ§åˆ¶ã€ä¾èµ–è§£å†³å’Œä¾èµ–ç¼–è¯‘ç­‰é—®é¢˜ã€‚&lt;/li&gt;
&lt;li&gt;æ„å»ºå’Œæµ‹è¯•ï¼šCargo å¯ä»¥ä½¿ç”¨ rustc ç¼–è¯‘å™¨æ„å»º Rust é¡¹ç›®ï¼Œå¹¶è‡ªåŠ¨è§£å†³ä¾èµ–å…³ç³»ã€‚åŒæ—¶ï¼ŒCargo è¿˜æ”¯æŒé¡¹ç›®æµ‹è¯•å’Œæ–‡æ¡£ç”Ÿæˆç­‰åŠŸèƒ½ã€‚&lt;/li&gt;
&lt;li&gt;å‘å¸ƒå’Œåˆ†å‘ï¼šCargo å¯ä»¥å°† Rust é¡¹ç›®æ‰“åŒ…ä¸º Crate å¹¶å‘å¸ƒåˆ° crates.io ä¸Šï¼Œä¹Ÿå¯ä»¥å°†äºŒè¿›åˆ¶æ–‡ä»¶æ‰“åŒ…ä¸ºå¯æ‰§è¡Œæ–‡ä»¶å¹¶å‘å¸ƒåˆ°å…¶ä»–å¹³å°ä¸Šã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;é€šè¿‡ä½¿ç”¨ Cargoï¼Œå¼€å‘è€…å¯ä»¥æ–¹ä¾¿åœ°åˆ›å»ºã€æ„å»ºã€æµ‹è¯•å’Œå‘å¸ƒ Rust åº”ç”¨ç¨‹åºå’Œåº“ã€‚åŒæ—¶ï¼ŒCargo è¿˜æä¾›äº†ä¸€äº›æœ‰ç”¨çš„å·¥å…·å’Œå‘½ä»¤è¡Œé€‰é¡¹ï¼Œå¦‚æ¸…ç†é¡¹ç›®ã€æŸ¥è¯¢ä¾èµ–ã€æŸ¥çœ‹æ„å»ºæ—¥å¿—ç­‰ï¼Œç”¨äºæé«˜ Rust é¡¹ç›®çš„å¼€å‘æ•ˆç‡å’Œè´¨é‡ã€‚&lt;/p&gt;

&lt;/div&gt;

&lt;h3 id=&#34;å¯æ‰§è¡Œæ–‡ä»¶ä¸åº“&#34;&gt;å¯æ‰§è¡Œæ–‡ä»¶ä¸åº“&lt;/h3&gt;
&lt;p&gt;ä½ å¯ä»¥åˆ›å»ºä¸€ä¸ª Rust å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆé€šè¿‡ &lt;code&gt;cargo init --bin&lt;/code&gt;ï¼‰ï¼Œè€Œä¸æ˜¯åˆ›å»ºä¸€ä¸ªåº“ã€‚ä½†æ˜¯è¯·æ³¨æ„ï¼Œä½ è¦ä¹ˆå¿…é¡»è®© &lt;code&gt;main()&lt;/code&gt; å‡½æ•°å…·æœ‰å®Œå–„çš„ç­¾åï¼Œè¦ä¹ˆä½¿ç”¨ &lt;code&gt;#![no_main]&lt;/code&gt; å…³é—­ç¼–è¯‘å™¨ä»¥è®©å®ƒçŸ¥é“ç¼ºå°‘ &lt;code&gt;main()&lt;/code&gt; æ˜¯æ•…æ„çš„ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¸ªæ›´å¥½å—ï¼Ÿè¿™å¯¹æˆ‘æ¥è¯´ä¼¼ä¹æ˜¯ä¸€ä¸ªå“å‘³é—®é¢˜ï¼Œå› ä¸ºè¿™ä¸¤ç§æ–¹æ³•åœ¨åŠŸèƒ½ä¸Šä¼¼ä¹æ˜¯ç­‰åŒçš„å¹¶ä¸”ç”Ÿæˆç›¸åŒçš„ WebAssembly ä»£ç ã€‚å¤§å¤šæ•°æ—¶å€™ï¼ŒWebAssembly æ¨¡å—ä¼¼ä¹æ‰®æ¼”äº†ä¸€ä¸ªåº“çš„è§’è‰²ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼ˆé™¤äº†åœ¨ &lt;a href=&#34;https://wasi.dev/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;WASI&lt;/a&gt; çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œç¨åä¼šè¯¦ç»†ä»‹ç»ï¼ï¼‰ï¼Œæ‰€ä»¥åœ¨æˆ‘çœ‹æ¥ï¼Œåº“æ–¹æ³•åœ¨è¯­ä¹‰ä¸Šä¼¼ä¹æ›´å¯å–ã€‚é™¤éå¦æœ‰è¯´æ˜ï¼Œå¦åˆ™æˆ‘å°†åœ¨æœ¬æ–‡çš„å…¶ä½™éƒ¨åˆ†ä½¿ç”¨åº“è®¾ç½®ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å¯¼å‡º&#34;&gt;å¯¼å‡º&lt;/h3&gt;
&lt;p&gt;ç»§ç»­åº“æ ·å¼çš„è®¾ç½®ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹ç¼–è¯‘å™¨ç”Ÿæˆçš„ WebAssembly ä»£ç ã€‚ä¸ºæ­¤ï¼Œæˆ‘æ¨è &lt;a href=&#34;https://github.com/WebAssembly/wabt&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;WebAssembly Binary Toolkit&lt;/a&gt;ï¼ˆç®€ç§°â€œwabtâ€ï¼‰ï¼Œå®ƒæä¾›äº†æœ‰ç”¨çš„å·¥å…·ï¼Œå¦‚ wasm2watã€‚å¦å¤–ï¼Œè¯·ç¡®ä¿å®‰è£…äº† &lt;a href=&#34;https://github.com/WebAssembly/binaryen&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Binarygen&lt;/a&gt;ï¼Œå› ä¸ºæœ¬æ–‡åé¢æˆ‘ä»¬å°†éœ€è¦ wasm-optã€‚Binaryen è¿˜æä¾›äº† &lt;code&gt;wasm-dis&lt;/code&gt;ï¼Œå…¶å·¥ä½œæ–¹å¼ä¸ wasm2wat ç±»ä¼¼ï¼Œä½†ä¸äº§ç”Ÿ WebAssembly æ–‡æœ¬æ ¼å¼ (WAT)ã€‚å®ƒç”Ÿæˆæ ‡å‡†åŒ–ç¨‹åº¦è¾ƒä½çš„ WebAssembly S-Expression æ–‡æœ¬æ ¼å¼ (WAST)ã€‚æœ€åï¼ŒByteCodeAlliance çš„ &lt;a href=&#34;https://github.com/bytecodealliance/wasm-tools&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;wasm-tools&lt;/a&gt; æä¾›äº† &lt;code&gt;wasm-tools print&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;wasm2wat ./target/wasm32-unknown-unknown/release/my_project.wasm
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ­¤å‘½ä»¤ä¼šå°† WebAssembly äºŒè¿›åˆ¶æ–‡ä»¶è½¬æ¢ä¸º WATï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;module&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;table&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(;&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;)&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;funcref&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;memory&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(;&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;)&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;16&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;global&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;$&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;__stack_pointer&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mut&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1048576&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;global&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(;&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;)&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;i32&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1048576&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;global&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(;&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;)&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;i32&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1048576&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;memory&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;memory&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;__data_end&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;global&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;__heap_base&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;global&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä»¤äººå‘æŒ‡çš„æ˜¯ï¼Œæˆ‘ä»¬å‘ç°æˆ‘ä»¬çš„ add å‡½æ•°å·²ä»äºŒè¿›åˆ¶æ–‡ä»¶ä¸­å®Œå…¨åˆ é™¤ã€‚æˆ‘ä»¬åªå‰©ä¸‹ä¸€ä¸ªå †æ ˆæŒ‡é’ˆå’Œä¸¤ä¸ªå…¨å±€å˜é‡ï¼Œå®ƒä»¬æŒ‡å®šæ•°æ®éƒ¨åˆ†çš„ç»“æŸä½ç½®å’Œå †çš„å¼€å§‹ä½ç½®ã€‚äº‹å®è¯æ˜ï¼Œå°†å‡½æ•°å£°æ˜ä¸º &lt;code&gt;pub&lt;/code&gt; ä¸è¶³ä»¥è®©å®ƒå‡ºç°åœ¨æˆ‘ä»¬æœ€ç»ˆçš„ WebAssembly æ¨¡å—ä¸­ã€‚æˆ‘å…¶å®å¸Œæœ›è¿™å°±è¶³å¤Ÿäº†ï¼Œä½†æˆ‘æ€€ç–‘ Rust æ¨¡å—å¯è§æ€§æ˜¯å”¯ä¸€çš„ï¼Œè€Œä¸æ˜¯é“¾æ¥å™¨çº§åˆ«çš„ç¬¦å·å¯è§æ€§ã€‚&lt;/p&gt;
&lt;p&gt;ç¡®ä¿ç¼–è¯‘å™¨ä¸ä¼šåˆ é™¤æˆ‘ä»¬å…³å¿ƒçš„å‡½æ•°çš„æœ€å¿«æ–¹æ³•æ˜¯æ·»åŠ å±æ€§ &lt;code&gt;#[no_mangle]&lt;/code&gt;ï¼Œå°½ç®¡æˆ‘ä¸å–œæ¬¢è¿™ä¸ªå‘½åã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;#[no_mangle]
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pub&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nl&#34;&gt;left&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;usize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nl&#34;&gt;right&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;usize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;usize&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;left&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;right&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¾ˆå°‘éœ€è¦ï¼Œä½†æ˜¯ä½ å¯ä»¥é€šè¿‡ä½¿ç”¨  &lt;code&gt;#[export_name = &amp;quot;...&amp;quot;]&lt;/code&gt; å¯¼å‡ºä¸€ä¸ªåç§°ä¸å…¶ Rust å†…éƒ¨åç§°ä¸åŒçš„å‡½æ•°ã€‚&lt;/p&gt;
&lt;p&gt;å°†æˆ‘ä»¬çš„ &lt;code&gt;add&lt;/code&gt; å‡½æ•°æ ‡è®°ä¸ºå¯¼å‡ºåï¼Œæˆ‘ä»¬å¯ä»¥å†æ¬¡ç¼–è¯‘é¡¹ç›®å¹¶æ£€æŸ¥ç”Ÿæˆçš„ WebAssembly æ–‡ä»¶ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;module&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(;&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;param&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i32&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;result&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;$&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;add&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;param&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i32&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;result&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;local&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;local&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;i32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;table&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(;&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;)&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;funcref&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;memory&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(;&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;)&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;16&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;global&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;$&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;__stack_pointer&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mut&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1048576&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;global&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(;&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;)&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;i32&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1048576&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;global&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(;&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;)&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;i32&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1048576&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;memory&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;memory&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;add&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;$&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;__data_end&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;global&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;__heap_base&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;global&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™ä¸ªæ¨¡å—å¯ä»¥ç”¨æ™®é€šçš„ WebAssembly API å®ä¾‹åŒ–ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-js&#34; data-lang=&#34;js&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;importObj&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{};&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// Node
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;require&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;fs&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;readFileSync&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;./my_project.wasm&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;instance&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kr&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;WebAssembly&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;instantiate&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;importObj&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// Deno
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kr&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Deno&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;readFile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;./my_project.wasm&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;instance&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kr&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;WebAssembly&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;instantiate&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;importObj&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// For Web, itâ€™s advisable to use `instantiateStreaming` whenever possible:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;response&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kr&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;fetch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;./my_project.wasm&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;instance&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;kr&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;WebAssembly&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;instantiateStreaming&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;response&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;importObj&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;instance&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;exports&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;40&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// returns 42
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;çªç„¶ä¹‹é—´ï¼Œæˆ‘ä»¬å‡ ä¹å¯ä»¥ä½¿ç”¨ Rust çš„æ‰€æœ‰åŠŸèƒ½æ¥ç¼–å†™ WebAssemblyã€‚&lt;/p&gt;
&lt;p&gt;éœ€è¦ç‰¹åˆ«æ³¨æ„æ¨¡å—è¾¹ç•Œå¤„çš„å‡½æ•°ï¼ˆå³ä½ ä» JavaScript è°ƒç”¨çš„å‡½æ•°ï¼‰ã€‚è‡³å°‘å°±ç›®å‰è€Œè¨€ï¼Œæœ€å¥½åšæŒä½¿ç”¨&lt;a href=&#34;https://webassembly.github.io/spec/core/syntax/types.html#number-types&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;èƒ½å¤Ÿæ¸…æ™°æ˜ å°„åˆ° WebAssembly çš„ç±»å‹&lt;/a&gt;ï¼ˆå¦‚&lt;code&gt;i32&lt;/code&gt;æˆ–&lt;code&gt;f64&lt;/code&gt;ï¼‰ã€‚å¦‚æœä½ ä½¿ç”¨æ›´é«˜çº§åˆ«çš„ç±»å‹ï¼Œå¦‚æ•°ç»„ã€åˆ‡ç‰‡ï¼Œç”šè‡³ &lt;code&gt;String&lt;/code&gt;ï¼Œè¯¥å‡½æ•°æœ€ç»ˆå¯èƒ½ä¼šä½¿ç”¨æ¯”å®ƒä»¬åœ¨ Rust ä¸­æ›´å¤šçš„å‚æ•°ï¼Œå¹¶ä¸”é€šå¸¸éœ€è¦å¯¹å†…å­˜å¸ƒå±€å’Œç±»ä¼¼åŸåˆ™æœ‰æ›´æ·±å…¥çš„äº†è§£ã€‚&lt;/p&gt;
&lt;h3 id=&#34;abi&#34;&gt;ABI&lt;/h3&gt;
&lt;p&gt;è¯·æ³¨æ„ï¼šæ˜¯çš„ï¼Œæˆ‘ä»¬æ­£åœ¨æˆåŠŸåœ°å°† Rust ç¼–è¯‘ä¸º WebAssemblyã€‚ç„¶è€Œï¼Œåœ¨ Rust ç‰ˆæœ¬ä¸­ï¼Œå¯èƒ½ä¼šç”Ÿæˆä¸€ä¸ªå…·æœ‰å®Œå…¨ä¸åŒå‡½æ•°ç­¾åçš„ WebAssembly æ¨¡å—ã€‚å‡½æ•°å‚æ•°ä»è°ƒç”¨è€…ä¼ é€’åˆ°è¢«è°ƒç”¨è€…çš„æ–¹å¼ï¼ˆä¾‹å¦‚ä½œä¸ºæŒ‡å‘å†…å­˜çš„æŒ‡é’ˆæˆ–ä½œä¸ºç«‹å³å€¼ï¼‰æ˜¯åº”ç”¨ç¨‹åºäºŒè¿›åˆ¶æ¥å£å®šä¹‰æˆ–ç®€ç§°â€œABIâ€çš„ä¸€éƒ¨åˆ†ã€‚&lt;code&gt;rustc&lt;/code&gt; é»˜è®¤ä½¿ç”¨ Rust çš„ ABIï¼Œå®ƒä¸ç¨³å®šï¼Œä¸»è¦è€ƒè™‘ Rust å†…éƒ¨ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;rustc&lt;/code&gt; ä¸ºäº†ç¨³å®šè¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥æ˜¾å¼å®šä¹‰è¦ä¸ºå‡½æ•°ä½¿ç”¨å“ªä¸ª ABIã€‚è¿™æ˜¯é€šè¿‡ä½¿ç”¨ &lt;a href=&#34;https://doc.rust-lang.org/reference/items/functions.html#extern-function-qualifier&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;code&gt;extern&lt;/code&gt;&lt;/a&gt; å…³é”®å­—æ¥å®Œæˆçš„ã€‚è·¨è¯­è¨€å‡½æ•°è°ƒç”¨çš„ä¸€ä¸ªé•¿æœŸé€‰æ‹©æ˜¯ &lt;a href=&#34;https://github.com/WebAssembly/tool-conventions/blob/main/BasicCABI.md&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;C ABI&lt;/a&gt;ï¼Œæˆ‘ä»¬å°†åœ¨æ­¤å¤„ä½¿ç”¨å®ƒã€‚C ABI ä¸ä¼šæ”¹å˜ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç¡®å®šæˆ‘ä»¬çš„ WebAssembly æ¨¡å—æ¥å£ä¹Ÿä¸ä¼šæ”¹å˜ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;#[no_mangle]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;left&lt;/span&gt;: &lt;span class=&#34;kt&#34;&gt;usize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;right&lt;/span&gt;: &lt;span class=&#34;kt&#34;&gt;usize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;kt&#34;&gt;usize&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;extern&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;C&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;left&lt;/span&gt;: &lt;span class=&#34;kt&#34;&gt;usize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;right&lt;/span&gt;: &lt;span class=&#34;kt&#34;&gt;usize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;kt&#34;&gt;usize&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;left&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;right&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æˆ‘ä»¬ç”šè‡³å¯ä»¥çœç•¥ &lt;code&gt;&amp;quot;C&amp;quot;&lt;/code&gt; è€Œåªä½¿ç”¨ &lt;code&gt;extern&lt;/code&gt;ï¼Œå› ä¸º C ABI æ˜¯é»˜è®¤çš„æ›¿ä»£ ABIã€‚&lt;/p&gt;
&lt;h3 id=&#34;å¯¼å…¥&#34;&gt;å¯¼å…¥&lt;/h3&gt;
&lt;p&gt;WebAssembly çš„ä¸€ä¸ªé‡è¦éƒ¨åˆ†æ˜¯å®ƒçš„æ²™ç®±ã€‚å®ƒç¡®ä¿åœ¨ WebAssembly VM ä¸­è¿è¡Œçš„ä»£ç æ— æ³•è®¿é—®ä¸»æœºç¯å¢ƒä¸­çš„ä»»ä½•å†…å®¹ï¼Œé™¤äº†é€šè¿‡ imports å¯¹è±¡æ˜¾å¼ä¼ é€’åˆ°æ²™ç®±ä¸­çš„å‡½æ•°ã€‚&lt;/p&gt;
&lt;p&gt;å‡è®¾æˆ‘ä»¬æƒ³åœ¨æˆ‘ä»¬çš„ Rust ä»£ç ä¸­ç”Ÿæˆéšæœºæ•°ã€‚æˆ‘ä»¬å¯ä»¥å¼•å…¥ &lt;code&gt;rand&lt;/code&gt; Rust æ²™ç®±ï¼Œä½†å¦‚æœä¸»æœºç¯å¢ƒä¸­å·²ç»æœ‰ä¸œè¥¿ï¼Œä¸ºä»€ä¹ˆè¿˜è¦å‘å¸ƒä»£ç ã€‚ä½œä¸ºç¬¬ä¸€æ­¥ï¼Œæˆ‘ä»¬éœ€è¦å£°æ˜æˆ‘ä»¬çš„ WebAssembly æ¨¡å—éœ€è¦å¯¼å…¥ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;#[link(wasm_import_module = &lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Math&amp;#34;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;)]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;extern&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;C&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;random&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;kt&#34;&gt;f64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;#[export_name = &lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;add&amp;#34;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;left&lt;/span&gt;: &lt;span class=&#34;kt&#34;&gt;f64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;right&lt;/span&gt;: &lt;span class=&#34;kt&#34;&gt;f64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;kt&#34;&gt;f64&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;left&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;right&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;left&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;right&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;random&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;extern &amp;quot;C&amp;quot;&lt;/code&gt; å—ï¼ˆä¸è¦ä¸ä¸Šé¢çš„ &lt;code&gt;extern &amp;quot;C&amp;quot;&lt;/code&gt; å‡½æ•°æ··æ·†ï¼‰å£°æ˜ç¼–è¯‘å™¨å¸Œæœ›åœ¨é“¾æ¥æ—¶ç”±â€œå…¶ä»–äººâ€æä¾›çš„å‡½æ•°ã€‚è¿™é€šå¸¸æ˜¯ä½ åœ¨ Rust ä¸­é“¾æ¥ C åº“çš„æ–¹å¼ï¼Œä½†è¯¥æœºåˆ¶ä¹Ÿé€‚ç”¨äº WebAssemblyã€‚ä½†æ˜¯ï¼Œå¤–éƒ¨å‡½æ•°æ€»æ˜¯éšå¼ä¸å®‰å…¨çš„ï¼Œå› ä¸ºç¼–è¯‘å™¨æ— æ³•ä¸ºé Rust å‡½æ•°æä¾›ä»»ä½•å®‰å…¨ä¿è¯ã€‚å› æ­¤ï¼Œé™¤éæˆ‘ä»¬å°†è°ƒç”¨åŒ…è£…åœ¨ &lt;code&gt;unsafe { ... }&lt;/code&gt; å—ä¸­ï¼Œå¦åˆ™æˆ‘ä»¬æ— æ³•è°ƒç”¨å®ƒä»¬ã€‚&lt;/p&gt;
&lt;p&gt;ä¸Šé¢çš„ä»£ç å¯ä»¥ç¼–è¯‘ï¼Œä½†ä¸ä¼šè¿è¡Œã€‚æˆ‘ä»¬çš„ JavaScript ä»£ç æŠ›å‡ºé”™è¯¯ï¼Œéœ€è¦æ›´æ–°ä»¥æ»¡è¶³æˆ‘ä»¬æŒ‡å®šçš„å¯¼å…¥ã€‚å¯¼å…¥å¯¹è±¡æ˜¯å¯¼å…¥æ¨¡å—çš„å­—å…¸ï¼Œæ¯ä¸ªæ¨¡å—éƒ½æ˜¯å¯¼å…¥é¡¹çš„å­—å…¸ã€‚åœ¨æˆ‘ä»¬çš„ Rust ä»£ç ä¸­ï¼Œæˆ‘ä»¬å£°æ˜äº†ä¸€ä¸ªå¯¼å…¥æ¨¡å—&amp;quot;Math&amp;quot;ï¼Œå¹¶æœŸæœ›ä¸€ä¸ªè¢«è°ƒç”¨çš„å‡½æ•°&amp;quot;random&amp;quot;å‡ºç°åœ¨è¯¥æ¨¡å—ä¸­ã€‚è¿™äº›å€¼å½“ç„¶æ˜¯ç»è¿‡ä»”ç»†é€‰æ‹©çš„ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä¼ å…¥æ•´ä¸ª Math å¯¹è±¡ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-javascript&#34; data-lang=&#34;javascript&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;importObj&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nb&#34;&gt;Math&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;nx&#34;&gt;random&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Math&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;random&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;};&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;c1&#34;&gt;// or
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;  
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;importObj&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Math&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;};&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¸ºäº†é¿å…åˆ°å¤„æ³¨å…¥ &lt;code&gt;unsafe { ... }&lt;/code&gt;ï¼Œé€šå¸¸éœ€è¦ç¼–å†™åŒ…è£…å‡½æ•°æ¥æ¢å¤ Rust çš„å®‰å…¨ä¸å˜é‡ã€‚è¿™æ˜¯ Rust å†…è”æ¨¡å—çš„ä¸€ä¸ªå¾ˆå¥½çš„ç”¨ä¾‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;mod&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;math&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;mod&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;math_js&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;#[link(wasm_import_module = &lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Math&amp;#34;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;)]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;extern&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;C&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;random&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;kt&#34;&gt;f64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;random&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;kt&#34;&gt;f64&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;math_js&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;random&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;#[export_name = &lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;add&amp;#34;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;extern&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;C&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;left&lt;/span&gt;: &lt;span class=&#34;kt&#34;&gt;f64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;right&lt;/span&gt;: &lt;span class=&#34;kt&#34;&gt;f64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;kt&#34;&gt;f64&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;left&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;right&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;math&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;random&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;é¡ºä¾¿è¯´ä¸€å¥ï¼Œå¦‚æœæˆ‘ä»¬æ²¡æœ‰æŒ‡å®š &lt;code&gt;#[link(wasm_import_module = ...)]&lt;/code&gt;å±æ€§ï¼Œåˆ™å‡½æ•°å°†åœ¨é»˜è®¤ &lt;code&gt;env&lt;/code&gt; æ¨¡å—ä¸Šè¿è¡Œã€‚æ­¤å¤–ï¼Œå°±åƒä½ å¯ä»¥ä½¿ç”¨ &lt;code&gt;#[export_name = &amp;quot;...&amp;quot;]&lt;/code&gt; æ›´æ”¹å¯¼å‡ºçš„å‡½æ•°çš„åç§°ä¸€æ ·ï¼Œä½ å¯ä»¥ä½¿ç”¨ &lt;code&gt;#[link_name = &amp;quot;...&amp;quot;]&lt;/code&gt; æ›´æ”¹å¯¼å…¥çš„å‡½æ•°çš„åç§°ã€‚&lt;/p&gt;
&lt;h3 id=&#34;é«˜çº§ç±»å‹&#34;&gt;é«˜çº§ç±»å‹&lt;/h3&gt;
&lt;p&gt;æˆ‘ä¹‹å‰è¯´è¿‡ï¼Œåœ¨æ¨¡å—è¾¹ç•Œå¤„ç†å‡½æ•°çš„æœ€æœ‰æ•ˆæ–¹æ³•æ˜¯ä½¿ç”¨é€æ˜æ˜ å°„åˆ° WebAssembly æ”¯æŒçš„æ•°æ®ç±»å‹çš„å€¼ç±»å‹ã€‚å½“ç„¶ï¼Œç¼–è¯‘å™¨å…è®¸ä½ ä½¿ç”¨æ›´å¤æ‚çš„ç±»å‹ä½œä¸ºå‡½æ•°çš„å‚æ•°å’Œå€¼ã€‚åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œç¼–è¯‘å™¨ç”Ÿæˆ &lt;a href=&#34;https://github.com/WebAssembly/tool-conventions/blob/main/BasicCABI.md&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;C ABI&lt;/a&gt; ä¸­æŒ‡å®šçš„ä»£ç ï¼ˆé™¤äº† rustc ç›®å‰ä¸å®Œå…¨ç¬¦åˆ C ABI çš„&lt;a href=&#34;https://github.com/rustwasm/team/issues/291&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä¸è¶³&lt;/a&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;æ— éœ€èµ˜è¿°ï¼Œç±»å‹å¤§å°ï¼ˆä¾‹å¦‚ï¼Œstructã€enum ç­‰ï¼‰å°±å˜æˆäº†ä¸€ä¸ªç®€å•çš„æŒ‡é’ˆã€‚æ•°ç»„å’Œå…ƒç»„æ˜¯æœ‰å¤§å°çš„ç±»å‹ï¼Œå¦‚æœå®ƒä»¬ä½¿ç”¨å°‘äº 32 ä½ï¼Œå®ƒä»¬å°†è¢«è½¬æ¢ä¸ºç«‹å³å€¼ã€‚æ›´å¤æ‚çš„æƒ…å†µæ˜¯å‡½æ•°è¿”å›å¤§äº 32 ä½çš„æ•°ç»„ç±»å‹çš„å€¼ï¼šå¦‚æœæ˜¯è¿™ç§æƒ…å†µï¼Œå‡½æ•°å°†ä¸ä¼šæ”¶åˆ°è¿”å›å€¼ï¼Œè€Œæ˜¯ä¼šæ”¶åˆ°ä¸€ä¸ªé™„åŠ ç±»å‹çš„å‚æ•° i32ï¼Œè¯¥å‡½æ•°å°†åˆ©ç”¨æŒ‡å‘æ­¤å‚æ•°çš„æŒ‡é’ˆæ¥å­˜å‚¨ç»“æœã€‚å¦‚æœä¸€ä¸ªå‡½æ•°è¿”å›ä¸€ä¸ªå…ƒç»„ï¼Œæ— è®ºå…ƒç»„çš„å¤§å°å¦‚ä½•ï¼Œå®ƒæ€»æ˜¯è¢«è®¤ä¸ºæ˜¯å‡½æ•°çš„å‚æ•°ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;(?Sized)&lt;/code&gt; å…·æœ‰æœªæŒ‡å®šç±»å‹çš„å‡½æ•°å‚æ•°ï¼Œä¾‹å¦‚ &lt;code&gt;str&lt;/code&gt;ã€&lt;code&gt;[u8]&lt;/code&gt; æˆ– &lt;code&gt;dyn MyTrait&lt;/code&gt;ï¼Œç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼šç¬¬ä¸€éƒ¨åˆ†æ˜¯æŒ‡å‘æ•°æ®çš„æŒ‡é’ˆï¼Œç¬¬äºŒéƒ¨åˆ†æ˜¯æŒ‡å‘å…ƒæ•°æ®çš„æŒ‡é’ˆã€‚å¦‚æœæ˜¯ str çš„ä¸€ä¸ªæˆ–ä¸€éƒ¨åˆ†ï¼Œåˆ™å…ƒæ•°æ®æ˜¯æ•°æ®çš„é•¿åº¦ã€‚åœ¨ç‰¹å¾å¯¹è±¡çš„å®ä¾‹ä¸­ï¼Œå®ƒæ˜¯ä¸€ä¸ªè™šæ‹Ÿè¡¨ï¼ˆæˆ– vtableï¼‰ï¼Œå®ƒæ˜¯æŒ‡å‘å„ä¸ªç‰¹å¾å‡½æ•°å®ç°çš„å‡½æ•°æŒ‡é’ˆåˆ—è¡¨ã€‚å¦‚æœä½ æƒ³äº†è§£æ›´å¤šæœ‰å…³ Rust ä¸­çš„ VTable çš„ä¿¡æ¯ï¼Œæˆ‘å¯ä»¥æ¨è Thomas BÃ¤chler çš„&lt;a href=&#34;https://articles.bchlr.de/traits-dynamic-dispatch-upcasting&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è¿™ç¯‡æ–‡ç« &lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘åœ¨è¿™é‡Œçœç•¥äº†é‡è¦çš„ç»†èŠ‚ï¼Œå› ä¸ºå»ºè®®ä½ ä¸è¦ç¼–å†™ä¸‹ä¸€ä¸ª wasm-bindgenï¼Œé™¤éä½ éè¦è¿™æ ·åšã€‚æˆ‘å»ºè®®ä¾é ç°æœ‰å·¥å…·è€Œä¸æ˜¯åˆ›å»ºæ–°å·¥å…·ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ¨¡å—å¤§å°&#34;&gt;æ¨¡å—å¤§å°&lt;/h2&gt;
&lt;p&gt;å½“ WebAssembly éƒ¨ç½²åœ¨ web ä¸Šæ—¶ï¼Œå®ƒçš„äºŒè¿›åˆ¶æ–‡ä»¶çš„å¤§å°éå¸¸é‡è¦ã€‚æ¯ä¸€ç‚¹éƒ½å¿…é¡»é€šè¿‡ç½‘ç»œä¼ è¾“å¹¶é€šè¿‡æµè§ˆå™¨çš„ WebAssembly ç¼–è¯‘å™¨ï¼Œå› æ­¤ï¼Œè¾ƒå°çš„äºŒè¿›åˆ¶å¤§å°æ„å‘³ç€åœ¨ WebAssembly å¼€å§‹è¿è¡Œä¹‹å‰ç”¨æˆ·ç­‰å¾…çš„æ—¶é—´æ›´å°‘ã€‚å¦‚æœæˆ‘ä»¬å°†é»˜è®¤é¡¹ç›®æ„é€ ä¸ºå‘å¸ƒç‰ˆæœ¬ï¼Œæˆ‘ä»¬å°†ç”Ÿæˆ 1.7MB çš„ WebAssemblyã€‚è¿™å¯¹äºä¸¤ä¸ªæ•°å­—ç›¸åŠ çš„åŠŸèƒ½ä¼¼ä¹å¤ªå¤§äº†ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æ•°æ®éƒ¨åˆ†ï¼šWebAssembly æ¨¡å—çš„å¤§éƒ¨åˆ†ç”±æ•°æ®ç»„æˆã€‚å³æ•°æ®åœ¨ç‰¹å®šç‚¹ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œç„¶åå¤åˆ¶åˆ°çº¿æ€§å†…å­˜ã€‚è¿™äº›éƒ¨åˆ†çš„ç¼–è¯‘æˆæœ¬å¾ˆä½ï¼Œå› ä¸ºç¼–è¯‘å™¨ä¼šè·³è¿‡å®ƒä»¬ï¼Œåœ¨åˆ†æå’Œå‡å°‘æ¨¡å—çš„å¯åŠ¨æ—¶é—´æ—¶è¯·è®°ä½è¿™ä¸€ç‚¹ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ£€æŸ¥ WebAssembly æ¨¡å—å†…éƒ¨ç»“æ„çš„ä¸€ç§ç®€å•æ–¹æ³•æ˜¯ &lt;code&gt;llvm-objdump&lt;/code&gt;ï¼Œè¿™åº”è¯¥å¯ä»¥åœ¨ä½ çš„ç³»ç»Ÿä¸Šè®¿é—®ã€‚æˆ–è€…ï¼Œä½ å¯ä»¥ä½¿ç”¨ &lt;code&gt;wasm-objdump&lt;/code&gt;ï¼Œå®ƒæ˜¯ wabt çš„ä¸€éƒ¨åˆ†ï¼Œé€šå¸¸æä¾›ç›¸åŒçš„æ¥å£ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ llvm-objdump -h target/wasm32-unknown-unknown/release/my_project.wasm
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;target/wasm32-unknown-unknown/release/my_project.wasm: file format wasm
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Sections:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Idx Name            Size     VMA      Type
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; TYPE            &lt;span class=&#34;m&#34;&gt;00000007&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;00000000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; FUNCTION        &lt;span class=&#34;m&#34;&gt;00000002&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;00000000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; TABLE           &lt;span class=&#34;m&#34;&gt;00000005&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;00000000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; MEMORY          &lt;span class=&#34;m&#34;&gt;00000003&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;00000000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; GLOBAL          &lt;span class=&#34;m&#34;&gt;00000019&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;00000000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; EXPORT          0000002b &lt;span class=&#34;m&#34;&gt;00000000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt; CODE            &lt;span class=&#34;m&#34;&gt;00000009&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;00000000&lt;/span&gt; TEXT
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; .debug_info     00062c72 &lt;span class=&#34;m&#34;&gt;00000000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;m&#34;&gt;8&lt;/span&gt; .debug_pubtypes &lt;span class=&#34;m&#34;&gt;00000144&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;00000000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;m&#34;&gt;9&lt;/span&gt; .debug_ranges   0002af80 &lt;span class=&#34;m&#34;&gt;00000000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; .debug_abbrev   &lt;span class=&#34;m&#34;&gt;00001055&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;00000000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;m&#34;&gt;11&lt;/span&gt; .debug_line     00045d24 &lt;span class=&#34;m&#34;&gt;00000000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;m&#34;&gt;12&lt;/span&gt; .debug_str      0009f40c &lt;span class=&#34;m&#34;&gt;00000000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;m&#34;&gt;13&lt;/span&gt; .debug_pubnames 0003e3f2 &lt;span class=&#34;m&#34;&gt;00000000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;m&#34;&gt;14&lt;/span&gt; name            0000001c &lt;span class=&#34;m&#34;&gt;00000000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt; producers       &lt;span class=&#34;m&#34;&gt;00000043&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;00000000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;llvm-objdump&lt;/code&gt; è¿‡äºç¬¼ç»Ÿï¼Œä¸ºé‚£äº›æœ‰ä½¿ç”¨å…¶ä»–è¯­è¨€æ±‡ç¼–ç»éªŒçš„äººæä¾›ç†Ÿæ‚‰çš„å‘½ä»¤è¡Œã€‚ç„¶è€Œï¼Œä¸“é—¨ç”¨äºè°ƒè¯•äºŒè¿›åˆ¶å­—ç¬¦ä¸²çš„å¤§å°ï¼Œå®ƒç¼ºå°‘ç®€å•çš„å·¥å…·ï¼Œå¦‚æŒ‰å¤§å°æ’åºéƒ¨åˆ†æˆ–æŒ‰åŠŸèƒ½åˆ†è§£éƒ¨åˆ†ã€‚å¹¸è¿çš„æ˜¯ï¼Œæœ‰ä¸“é—¨ä¸ºæ­¤è®¾è®¡çš„ WebAssembly ä¸“ç”¨å·¥å…· &lt;a href=&#34;https://rustwasm.github.io/twiggy/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Twiggy&lt;/a&gt;ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ twiggy top target/wasm32-unknown-unknown/release/my_project.wasm
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; Shallow Bytes â”‚ Shallow % â”‚ Item
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;m&#34;&gt;652300&lt;/span&gt; â”Š    36.67% â”Š custom section &lt;span class=&#34;s1&#34;&gt;&amp;#39;.debug_str&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;m&#34;&gt;404594&lt;/span&gt; â”Š    22.75% â”Š custom section &lt;span class=&#34;s1&#34;&gt;&amp;#39;.debug_info&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;m&#34;&gt;285988&lt;/span&gt; â”Š    16.08% â”Š custom section &lt;span class=&#34;s1&#34;&gt;&amp;#39;.debug_line&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;m&#34;&gt;254962&lt;/span&gt; â”Š    14.33% â”Š custom section &lt;span class=&#34;s1&#34;&gt;&amp;#39;.debug_pubnames&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;m&#34;&gt;176000&lt;/span&gt; â”Š     9.89% â”Š custom section &lt;span class=&#34;s1&#34;&gt;&amp;#39;.debug_ranges&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &lt;span class=&#34;m&#34;&gt;4181&lt;/span&gt; â”Š     0.24% â”Š custom section &lt;span class=&#34;s1&#34;&gt;&amp;#39;.debug_abbrev&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;           &lt;span class=&#34;m&#34;&gt;324&lt;/span&gt; â”Š     0.02% â”Š custom section &lt;span class=&#34;s1&#34;&gt;&amp;#39;.debug_pubtypes&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;m&#34;&gt;67&lt;/span&gt; â”Š     0.00% â”Š custom section &lt;span class=&#34;s1&#34;&gt;&amp;#39;producers&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; â”Š     0.00% â”Š custom section &lt;span class=&#34;s1&#34;&gt;&amp;#39;name&amp;#39;&lt;/span&gt; headers
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt; â”Š     0.00% â”Š custom section &lt;span class=&#34;s1&#34;&gt;&amp;#39;.debug_pubnames&amp;#39;&lt;/span&gt; headers
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;m&#34;&gt;19&lt;/span&gt; â”Š     0.00% â”Š custom section &lt;span class=&#34;s1&#34;&gt;&amp;#39;.debug_pubtypes&amp;#39;&lt;/span&gt; headers
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; â”Š     0.00% â”Š custom section &lt;span class=&#34;s1&#34;&gt;&amp;#39;.debug_ranges&amp;#39;&lt;/span&gt; headers
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;m&#34;&gt;17&lt;/span&gt; â”Š     0.00% â”Š custom section &lt;span class=&#34;s1&#34;&gt;&amp;#39;.debug_abbrev&amp;#39;&lt;/span&gt; headers
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; â”Š     0.00% â”Š custom section &lt;span class=&#34;s1&#34;&gt;&amp;#39;.debug_info&amp;#39;&lt;/span&gt; headers
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; â”Š     0.00% â”Š custom section &lt;span class=&#34;s1&#34;&gt;&amp;#39;.debug_line&amp;#39;&lt;/span&gt; headers
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt; â”Š     0.00% â”Š custom section &lt;span class=&#34;s1&#34;&gt;&amp;#39;.debug_str&amp;#39;&lt;/span&gt; headers
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;m&#34;&gt;14&lt;/span&gt; â”Š     0.00% â”Š &lt;span class=&#34;nb&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;__heap_base&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;m&#34;&gt;13&lt;/span&gt; â”Š     0.00% â”Š &lt;span class=&#34;nb&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;__data_end&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;m&#34;&gt;12&lt;/span&gt; â”Š     0.00% â”Š custom section &lt;span class=&#34;s1&#34;&gt;&amp;#39;producers&amp;#39;&lt;/span&gt; headers
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;             &lt;span class=&#34;m&#34;&gt;9&lt;/span&gt; â”Š     0.00% â”Š &lt;span class=&#34;nb&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;memory&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;             &lt;span class=&#34;m&#34;&gt;9&lt;/span&gt; â”Š     0.00% â”Š add
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;...
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç°åœ¨å¾ˆæ˜æ˜¾ï¼Œæ¨¡å—å¤§å°çš„æ‰€æœ‰ä¸»è¦è´¡çŒ®è€…éƒ½æ˜¯ä¸æ¨¡å—ç”¨é€”æ— å…³çš„è‡ªå®šä¹‰ç»„ä»¶ã€‚å®ƒä»¬çš„æ ‡é¢˜æš—ç¤ºå®ƒä»¬åŒ…å«ç”¨äºæ•…éšœæ’é™¤çš„ä¿¡æ¯ï¼Œå› æ­¤è¿™äº›éƒ¨åˆ†æ˜¯ä¸ºæ„å»ºå’Œå‘å¸ƒè€Œå‘å‡ºçš„è¿™ä¸€äº‹å®æœ‰äº›ä¸åˆå¸¸è§„ã€‚è¿™ä¼¼ä¹ä¸æˆ‘ä»¬ä»£ç çš„ä¸€ä¸ªé•¿æœŸå­˜åœ¨çš„é—®é¢˜æœ‰å…³ï¼Œè¯¥é—®é¢˜å¯¼è‡´å®ƒåœ¨ç¼–è¯‘æ—¶æ²¡æœ‰è°ƒè¯•ç¬¦å·ï¼Œä½†åœ¨æˆ‘ä»¬çš„æœºå™¨ä¸Šé¢„ç¼–è¯‘çš„æ ‡å‡†åº“ä»ç„¶æœ‰è°ƒè¯•ç¬¦å·ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬åœ¨ &lt;code&gt;Cargo.toml&lt;/code&gt; ä¸­æ·»åŠ äº†ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-toml&#34; data-lang=&#34;toml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;profile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;release&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;strip&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™å°†å¯¼è‡´ &lt;code&gt;rustc&lt;/code&gt; åˆ é™¤æ‰€æœ‰è‡ªå®šä¹‰éƒ¨åˆ†ï¼ŒåŒ…æ‹¬ä¸ºå‡½æ•°åˆ†é…åç§°çš„éƒ¨åˆ†ã€‚è¿™å¯èƒ½ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼Œå› ä¸º twiggy çš„è¾“å‡ºå°†åªåŒ…å« &lt;code&gt;saycode[0]&lt;/code&gt; æˆ–ç±»ä¼¼çš„å‡½æ•°ã€‚å¦‚æœä½ æƒ³ç»´æŠ¤å‡½æ•°åç§°ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç‰¹å®šçš„æ¨¡å¼æ¥åˆ é™¤ä¿¡æ¯ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-toml&#34; data-lang=&#34;toml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;profile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;release&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;strip&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;strip&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;debuginfo&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¦‚æœä½ æƒ³å®Œå…¨ç»†ç²’åº¦æ§åˆ¶ï¼Œä½ å¯ä»¥æ¢å¤å¹¶å®Œå…¨ç¦ç”¨ &lt;code&gt;rustc&lt;/code&gt; çš„ strip æ–¹æ³•ï¼Œè€Œæ˜¯ä½¿ç”¨ &lt;code&gt;llvm-strip&lt;/code&gt; æˆ– &lt;code&gt;wasm-strip&lt;/code&gt;ã€‚è¿™ä½¿ä½ èƒ½å¤Ÿå†³å®šåº”ä¿ç•™å“ªäº›è‡ªå®šä¹‰éƒ¨ä»¶ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;llvm-strip --keep-section&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;name target/wasm32-unknown-unknown/release/my_project.wasm
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç§»é™¤å¤–å±‚åï¼Œæˆ‘ä»¬å‰©ä¸‹ä¸€ä¸ªä¸ 116B ä¸€æ ·å¤§æˆ–å¤§äº 116B çš„å—ã€‚æ‹†è§£å®ƒä¼šå‘ç°è¯¥æ¨¡å—çš„å”¯ä¸€ç›®çš„æ˜¯è°ƒç”¨ add å¹¶æ‰§è¡Œ &lt;code&gt;(f64.add (local.get 0) (local.get 1))&lt;/code&gt;ï¼Œè¿™æ„å‘³ç€ Rust ç¼–è¯‘å™¨èƒ½å¤Ÿç”Ÿæˆæœ€ä½³ä»£ç ã€‚å½“ç„¶ï¼Œä»£ç åº“çš„å¤§å°å¢åŠ äº†ï¼Œè¿™ä½¿å¾—æŒæ¡äºŒè¿›åˆ¶å¤§å°å˜å¾—æ›´åŠ å›°éš¾ã€‚&lt;/p&gt;
&lt;h3 id=&#34;è‡ªå®šä¹‰éƒ¨åˆ†&#34;&gt;è‡ªå®šä¹‰éƒ¨åˆ†&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;æœ‰è¶£çš„äº‹å®ï¼šæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Rust å°†æˆ‘ä»¬çš„è‡ªå®šä¹‰éƒ¨åˆ†æ·»åŠ åˆ° WebAssembly æ¨¡å—ä¸­ã€‚å¦‚æœæˆ‘ä»¬å£°æ˜ä¸€ä¸ªå­—èŠ‚æ•°ç»„ï¼ˆä¸æ˜¯åˆ‡ç‰‡ï¼ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥æ·»åŠ ä¸€ä¸ª &lt;code&gt;#[link_section=...]&lt;/code&gt; å±æ€§æ¥å°†è¿™äº›å­—èŠ‚æ‰“åŒ…åˆ°å®ƒè‡ªå·±çš„éƒ¨åˆ†ä¸­ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;const&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;_&lt;/span&gt;: &lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;#[link_section = &lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;surmsection&amp;#34;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;static&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;no&#34;&gt;SECTION_CONTENT&lt;/span&gt;: &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;u8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;11&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;sa&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;hello world&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;};&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ &lt;a href=&#34;https://developer.mozilla.org/en-US/docs/WebAssembly/JavaScript_interface/Module/customSections&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;code&gt;WebAssembly.Module.customSection()&lt;/code&gt; AP&lt;/a&gt;I æˆ–ä½¿ç”¨ &lt;code&gt;llvm-objdump&lt;/code&gt; æå–è¿™äº›æ•°æ®ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ llvm-objdump -s -j surmsection target/wasm32-unknown-unknown/release/my_project.wasm
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;target/wasm32-unknown-unknown/release/my_project.wasm: file format wasm
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Contents of section surmsection:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;m&#34;&gt;0000&lt;/span&gt; 68656c6c 6f20776f 726c64             hello world
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;å·å·æ‘¸æ‘¸çš„è†¨èƒ€&#34;&gt;å·å·æ‘¸æ‘¸çš„è†¨èƒ€&lt;/h3&gt;
&lt;p&gt;æˆ‘åœ¨ç½‘ä¸Šçœ‹åˆ°ä¸€äº›å…³äº Rust ä¸ºçœ‹ä¼¼å¾ˆå°çš„å·¥ä½œåˆ›å»º WebAssembly æ¨¡å—çš„æŠ±æ€¨ã€‚æ ¹æ®æˆ‘çš„ç»éªŒï¼ŒRust åˆ›å»ºçš„ WebAssembly äºŒè¿›åˆ¶æ–‡ä»¶å¯èƒ½å¾ˆå¤§çš„åŸå› æœ‰ä»¥ä¸‹ä¸‰ä¸ªï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è°ƒè¯•æ„å»ºï¼ˆå³å¿˜è®°å°† &lt;code&gt;--release&lt;/code&gt; ä¼ é€’ç»™ Cargoï¼‰&lt;/li&gt;
&lt;li&gt;è°ƒè¯•ç¬¦å·ï¼ˆå³å¿˜è®°è¿è¡Œ &lt;code&gt;llvm-strip&lt;/code&gt;ï¼‰&lt;/li&gt;
&lt;li&gt;æ„å¤–çš„å­—ç¬¦ä¸²æ ¼å¼å’Œææ…Œ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æˆ‘ä»¬å·²ç»çœ‹åˆ°äº†å‰ä¸¤ä¸ªã€‚è®©æˆ‘ä»¬ä»”ç»†çœ‹çœ‹æœ€åä¸€ä¸ªã€‚è¿™ä¸ªæ— å®³çš„ç¨‹åºç¼–è¯‘æˆ 18KB çš„ WebAssemblyï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;static&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;no&#34;&gt;PRIMES&lt;/span&gt;: &lt;span class=&#34;kp&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;i32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;11&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;13&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;17&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;19&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;23&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;#[no_mangle]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;extern&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;C&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;nth_prime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;: &lt;span class=&#34;kt&#34;&gt;usize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;kt&#34;&gt;i32&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;no&#34;&gt;PRIMES&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¥½å§ï¼Œä¹Ÿè®¸å®ƒæ¯•ç«Ÿä¸æ˜¯é‚£ä¹ˆæ— å®³ã€‚ä½ å¯èƒ½å·²ç»çŸ¥é“æˆ‘è¦å¹²å˜›äº†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ææ…Œ&#34;&gt;ææ…Œ&lt;/h3&gt;
&lt;p&gt;å¿«é€Ÿæµè§ˆä¸€ä¸‹ twiggy å°±ä¼šå‘ç°ï¼Œå½±å“ Wasm æ¨¡å—å¤§å°çš„ä¸»è¦å› ç´ æ˜¯ä¸å­—ç¬¦ä¸²æ ¼å¼åŒ–ã€ææ…Œå’Œå†…å­˜åˆ†é…ç›¸å…³çš„å‡½æ•°ã€‚è¿™è¯´å¾—é€šï¼å‚æ•° n æœªæ¸…ç†å¹¶ç”¨äºç´¢å¼•æ•°ç»„ã€‚Rust åˆ«æ— é€‰æ‹©ï¼Œåªèƒ½æ³¨å…¥è¾¹ç•Œæ£€æŸ¥ã€‚å¦‚æœè¾¹ç•Œæ£€æŸ¥å¤±è´¥ï¼ŒRust ä¼šå´©æºƒï¼Œè¿™æ˜¯åˆ›å»ºæ ¼å¼æ­£ç¡®çš„é”™è¯¯æ¶ˆæ¯å’Œå †æ ˆè·Ÿè¸ªæ‰€å¿…éœ€çš„ã€‚&lt;/p&gt;
&lt;p&gt;è§£å†³è¿™ä¸ªé—®é¢˜çš„ä¸€ç§æ–¹æ³•æ˜¯è‡ªå·±è¿›è¡Œè¾¹ç•Œæ£€æŸ¥ã€‚Rust çš„ç¼–è¯‘å™¨éå¸¸æ“…é•¿ä»…åœ¨éœ€è¦æ—¶æ³¨å…¥æ£€æŸ¥ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;nth_prime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;: &lt;span class=&#34;kt&#34;&gt;usize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;kt&#34;&gt;i32&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;||&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;no&#34;&gt;PRIMES&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;no&#34;&gt;PRIMES&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¯ä»¥è¯´æ›´æƒ¯ç”¨çš„æ–¹æ³•æ˜¯ä¾é &lt;code&gt;Option&amp;lt;T&amp;gt;&lt;/code&gt;API æ¥æ§åˆ¶é”™è¯¯æƒ…å†µçš„å¤„ç†æ–¹å¼ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;nth_prime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;: &lt;span class=&#34;kt&#34;&gt;usize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;kt&#34;&gt;i32&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;no&#34;&gt;PRIMES&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;no&#34;&gt;PRIMES&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;copied&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unwrap_or&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç¬¬ä¸‰ç§æ–¹æ³•æ˜¯ä½¿ç”¨ &lt;code&gt;unchecked&lt;/code&gt; Rust æ˜ç¡®æä¾›çš„ä¸€äº›æ–¹æ³•ã€‚è¿™äº›ä¸ºæœªå®šä¹‰çš„è¡Œä¸ºæ‰“å¼€äº†å¤§é—¨ï¼Œå› æ­¤æ˜¯ &lt;code&gt;unsafe&lt;/code&gt;ï¼Œä½†å¦‚æœä½ èƒ½å¤Ÿæ‰¿æ‹…èµ·å®‰å…¨çš„é‡æ‹…ï¼Œæ€§èƒ½ï¼ˆæˆ–æ–‡ä»¶å¤§å°ï¼‰çš„æé«˜å°†æ˜¯æ˜¾ç€çš„ï¼&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;nth_prime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;: &lt;span class=&#34;kt&#34;&gt;usize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;kt&#34;&gt;i32&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;no&#34;&gt;PRIMES&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;no&#34;&gt;PRIMES&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get_unchecked&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æˆ‘ä»¬å¯ä»¥å°è¯•å¤„ç†ææ…Œå¯èƒ½å‘ç”Ÿçš„ä½ç½®ï¼Œå¹¶å°è¯•æ‰‹åŠ¨å¤„ç†è¿™äº›è·¯å¾„ã€‚ç„¶è€Œï¼Œä¸€æ—¦æˆ‘ä»¬å¼€å§‹ä¾èµ–ç¬¬ä¸‰æ–¹ crateï¼ŒæˆåŠŸçš„æœºä¼šå°±ä¼šå‡å°‘ï¼Œå› ä¸ºæˆ‘ä»¬æ— æ³•è½»æ˜“æ”¹å˜åº“å†…éƒ¨å¤„ç†é”™è¯¯çš„æ–¹å¼ã€‚&lt;/p&gt;
&lt;h3 id=&#34;lto&#34;&gt;LTO&lt;/h3&gt;
&lt;p&gt;æˆ‘ä»¬å¯èƒ½ä¸å¾—ä¸æ¥å—è¿™æ ·ä¸€ä¸ªäº‹å®ï¼Œå³æˆ‘ä»¬æ— æ³•é¿å…ä»£ç åº“ä¸­å‡ºç° panic çš„ä»£ç è·¯å¾„ã€‚è™½ç„¶æˆ‘ä»¬å¯ä»¥å°è¯•å‡è½»ææ…Œçš„å½±å“ï¼ˆæˆ‘ä»¬ä¼šçš„ï¼ï¼‰ï¼Œä½†æœ‰ä¸€ä¸ªç›¸å½“å¼ºå¤§çš„ä¼˜åŒ–é€šå¸¸å¯ä»¥èŠ‚çœä¸€äº›é‡è¦çš„ä»£ç ã€‚è¿™ä¸ªä¼˜åŒ–è¿‡ç¨‹ç”± LLVM æä¾›ï¼Œç§°ä¸º &lt;a href=&#34;https://llvm.org/docs/LinkTimeOptimization.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;LTOï¼ˆLink Time Optimizationï¼Œé“¾æ¥æ—¶ä¼˜åŒ–ï¼‰&lt;/a&gt;ã€‚ &lt;code&gt;rustc&lt;/code&gt; åœ¨å°†æ‰€æœ‰å†…å®¹é“¾æ¥åˆ°æœ€ç»ˆäºŒè¿›åˆ¶æ–‡ä»¶ä¹‹å‰ç¼–è¯‘å’Œä¼˜åŒ–æ¯ä¸ª crateã€‚ç„¶è€Œï¼Œä¸€äº›ä¼˜åŒ–åªæœ‰åœ¨é“¾æ¥åæ‰ä¼šå˜å¾—æ˜æ˜¾ã€‚ä¾‹å¦‚ï¼Œè®¸å¤šå‡½æ•°æ ¹æ®è¾“å…¥æœ‰ä¸åŒçš„åˆ†æ”¯ã€‚åœ¨ç¼–è¯‘æœŸé—´ï¼Œä½ åªä¼šçœ‹åˆ°æ¥è‡ªåŒä¸€ä¸ª crate çš„å‡½æ•°è°ƒç”¨ã€‚åœ¨é“¾æ¥æ—¶ï¼Œä½ çŸ¥é“å¯¹ä»»ä½•ç»™å®šå‡½æ•°çš„æ‰€æœ‰å¯èƒ½è°ƒç”¨ï¼Œè¿™æ„å‘³ç€ç°åœ¨å¯ä»¥æ¶ˆé™¤å…¶ä¸­ä¸€äº›ä»£ç åˆ†æ”¯ã€‚&lt;/p&gt;
&lt;p&gt;LTO é»˜è®¤å¤„äºå…³é—­çŠ¶æ€ï¼Œå› ä¸ºå®ƒæ˜¯ä¸€é¡¹ä»£ä»·é«˜æ˜‚çš„ä¼˜åŒ–ï¼Œä¼šæ˜¾ç€å‡æ…¢ç¼–è¯‘æ—¶é—´ï¼Œå°¤å…¶æ˜¯åœ¨è¾ƒå¤§çš„ crate ä¸­ã€‚ä½ å¯ä»¥é€šè¿‡åœ¨ Cargo.toml ä¸­é…ç½® &lt;code&gt;rustc&lt;/code&gt; çš„è®¸å¤šä»£ç ç”Ÿæˆé€‰é¡¹å¯ç”¨ã€‚å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬éœ€è¦å°†è¿™ä¸€è¡Œæ·»åŠ åˆ°æˆ‘ä»¬çš„ &lt;code&gt;Cargo.toml&lt;/code&gt; ä¸­ä»¥åœ¨å‘å¸ƒç‰ˆæœ¬ä¸­å¯ç”¨ LTOï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-toml&#34; data-lang=&#34;toml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;package&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;name&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;my_project&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;version&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;0.1.0&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;edition&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;2021&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;lib&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;crate-type&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;cdylib&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;profile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;release&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;lto&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¯ç”¨ LTO åï¼Œå‰¥ç¦»çš„äºŒè¿›åˆ¶æ–‡ä»¶å‡å°‘åˆ° 2.3Kï¼Œè¿™ä»¤äººå°è±¡æ·±åˆ»ã€‚LTO çš„å”¯ä¸€æˆæœ¬æ˜¯æ›´é•¿çš„é“¾æ¥æ—¶é—´ï¼Œä½†å¦‚æœäºŒè¿›åˆ¶å¤§å°æ˜¯ä¸€ä¸ªé—®é¢˜ï¼ŒLTO å°†æˆä¸ºä¸€é¡¹åˆ©å™¨ï¼Œå› ä¸ºå®ƒâ€œä»…â€èŠ±è´¹æ„å»ºæ—¶é—´å¹¶ä¸”ä¸éœ€è¦æ›´æ”¹ä»£ç ã€‚&lt;/p&gt;
&lt;h3 id=&#34;wasm-opt&#34;&gt;wasm-opt&lt;/h3&gt;
&lt;p&gt;å¦ä¸€ä¸ªå‡ ä¹åº”è¯¥æˆä¸ºæ„å»ºç®¡é“ä¸€éƒ¨åˆ†çš„å·¥å…·æ˜¯æ¥è‡ª &lt;a href=&#34;https://github.com/WebAssembly/binaryen&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;binaryen&lt;/a&gt; çš„ &lt;code&gt;wasm-opt&lt;/code&gt;ã€‚å®ƒæ˜¯å¦ä¸€ä¸ªä¼˜åŒ–è¿‡ç¨‹çš„é›†åˆï¼Œå®Œå…¨åœ¨ WebAssembly VM æŒ‡ä»¤ä¸Šå·¥ä½œï¼Œç‹¬ç«‹äºç”Ÿæˆå®ƒä»¬çš„æºè¯­è¨€ã€‚åƒ Rust è¿™æ ·çš„é«˜çº§è¯­è¨€æœ‰æ›´å¤šçš„ä¿¡æ¯å¯ä»¥ç”¨æ¥åº”ç”¨æ›´å¤æ‚çš„ä¼˜åŒ–ï¼Œæ‰€ä»¥ &lt;code&gt;wasm-opt&lt;/code&gt; ä¸èƒ½æ›¿ä»£ä½ çš„è¯­è¨€ç¼–è¯‘å™¨çš„ä¼˜åŒ–ã€‚ä½†æ˜¯ï¼Œå®ƒé€šå¸¸è®¾æ³•å°†æ¨¡å—å¤§å°å‡å°‘å‡ ä¸ªé¢å¤–çš„å­—èŠ‚ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;wasm-opt -O3 -o output.wasm target/wasm32-unknown-unknown/my_project.wasm
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œ&lt;code&gt;wasm-opt&lt;/code&gt; è¿›ä¸€æ­¥ç¼©å°äº† Rust çš„ 2.3K WebAssembly äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæœ€åæ˜¯ 2.0Kã€‚å¥½çš„ï¼ä½†åˆ«æ‹…å¿ƒï¼Œæˆ‘ä¸ä¼šå°±æ­¤æ‰“ä½ã€‚è¿™å¯¹äºæ•°ç»„ä¸­çš„æŸ¥æ‰¾æ¥è¯´ä»ç„¶å¤ªå¤§äº†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;éæ ‡å‡†&#34;&gt;éæ ‡å‡†&lt;/h2&gt;
&lt;p&gt;Rust æœ‰ä¸€ä¸ª&lt;a href=&#34;https://docs.rs/std&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ ‡å‡†åº“&lt;/a&gt;ï¼Œå…¶ä¸­åŒ…å«ä½ æ¯å¤©è¿›è¡Œç³»ç»Ÿç¼–ç¨‹æ—¶æ‰€éœ€çš„è®¸å¤šæŠ½è±¡å’Œå®ç”¨ç¨‹åºï¼šè®¿é—®æ–‡ä»¶ã€è·å–å½“å‰æ—¶é—´æˆ–æ‰“å¼€ç½‘ç»œå¥—æ¥å­—ã€‚ä¸€åˆ‡éƒ½åœ¨é‚£é‡Œä¾›ä½ ä½¿ç”¨ï¼Œæ— éœ€å» &lt;a href=&#34;https://crates.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;crates.io&lt;/a&gt; æˆ–ç±»ä¼¼ç½‘ç«™ä¸Šæœç´¢ã€‚ç„¶è€Œï¼Œè®¸å¤šæ•°æ®ç»“æ„å’Œå‡½æ•°å¯¹å®ƒä»¬çš„ä½¿ç”¨ç¯å¢ƒåšå‡ºäº†å‡è®¾ï¼šå®ƒä»¬å‡è®¾ç¡¬ä»¶çš„ç»†èŠ‚è¢«æŠ½è±¡æˆä¸€ä¸ªç»Ÿä¸€çš„ APIï¼Œå¹¶ä¸”å®ƒä»¬å‡è®¾å®ƒä»¬å¯ä»¥ä»¥æŸç§æ–¹å¼åˆ†é…ï¼ˆå’Œé‡Šæ”¾ï¼‰ä»»æ„å¤§å°çš„å†…å­˜å—ã€‚é€šå¸¸ï¼Œè¿™ä¸¤é¡¹å·¥ä½œéƒ½æ˜¯ç”±æ“ä½œç³»ç»Ÿå®Œæˆçš„ï¼Œæˆ‘ä»¬å¤§å¤šæ•°äººæ¯å¤©éƒ½åœ¨æ“ä½œç³»ç»Ÿä¸Šå·¥ä½œã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ï¼Œå½“ä½ é€šè¿‡åŸå§‹ API å®ä¾‹åŒ– WebAssembly æ¨¡å—æ—¶ï¼Œæƒ…å†µå°±ä¸åŒäº†ï¼šæ²™ç®±ï¼ˆWebAssembly çš„å®šä¹‰å®‰å…¨åŠŸèƒ½ä¹‹ä¸€ï¼‰å°† WebAssembly ä»£ç ä¸ä¸»æœºéš”ç¦»å¼€æ¥ï¼Œä»è€Œä¸æ“ä½œç³»ç»Ÿéš”ç¦»å¼€æ¥ã€‚ä½ çš„ä»£ç åªèƒ½è®¿é—®ä¸€å¤§å—çº¿æ€§å†…å­˜ï¼Œå®ƒç”šè‡³æ— æ³•å¼„æ¸…æ¥šå“ªäº›éƒ¨åˆ†æ­£åœ¨ä½¿ç”¨ï¼Œå“ªäº›éƒ¨åˆ†å¯ä»¥ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;WASIï¼šè¿™ä¸æ˜¯æœ¬æ–‡çš„ä¸€éƒ¨åˆ†ï¼Œä½†å°±åƒ WebAssembly æ˜¯å¯¹è¿è¡Œä»£ç çš„å¤„ç†å™¨çš„æŠ½è±¡ä¸€æ ·ï¼Œ&lt;a href=&#34;https://wasi.dev/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;WASI&lt;/a&gt;ï¼ˆWebAssembly ç³»ç»Ÿæ¥å£ï¼‰æ—¨åœ¨æˆä¸ºå¯¹è¿è¡Œä»£ç çš„æ“ä½œç³»ç»Ÿçš„æŠ½è±¡ï¼Œå¹¶ä¸ºä½ æä¾›å¯ä»¥ä½¿ç”¨å•ä¸€ã€ç»Ÿä¸€çš„ APIã€‚Rust æ”¯æŒ WASIï¼Œå°½ç®¡ WASI æœ¬èº«ä»åœ¨å‘å±•ä¸­ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿™æ„å‘³ç€ Rust ç»™äº†æˆ‘ä»¬ä¸€ç§è™šå‡çš„å®‰å…¨æ„Ÿï¼å®ƒä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªæ²¡æœ‰æ“ä½œç³»ç»Ÿæ”¯æŒçš„å®Œæ•´æ ‡å‡†åº“ã€‚äº‹å®ä¸Šï¼Œè®¸å¤š stdlib æ¨¡å—åªæ˜¯åˆ«åæˆ–è€…å¤±è´¥äº†ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒä»¬åœ¨æ²¡æœ‰æ“ä½œç³»ç»Ÿæ”¯æŒçš„æƒ…å†µä¸‹ä¸èƒ½æ­£å¸¸å·¥ä½œã€‚åœ¨æ²¡æœ‰æ“ä½œç³»ç»Ÿæ”¯æŒçš„æƒ…å†µä¸‹ï¼Œè®¸å¤šè¿”å› &lt;code&gt;Result &amp;lt;T&amp;gt;&lt;/code&gt; ç±»å‹çš„å‡½æ•°å¯èƒ½ä¼šå› ä¸ºæ— æ³•æ­£å¸¸å·¥ä½œè€Œå§‹ç»ˆè¿”å› Errï¼Œè¿™æ„å‘³ç€æ— æ³•å¾—åˆ°æ­£ç¡®çš„æ“ä½œç»“æœã€‚åŒæ ·ï¼Œå…¶ä»–ä¸€äº›å‡½æ•°å¯èƒ½ä¼šå› ä¸ºæ— æ³•æ­£å¸¸å·¥ä½œè€Œå¯¼è‡´ç¨‹åºå´©æºƒã€‚&lt;/p&gt;
&lt;h3 id=&#34;å‘æ— æ“ä½œç³»ç»Ÿè®¾å¤‡å­¦ä¹ &#34;&gt;å‘æ— æ“ä½œç³»ç»Ÿè®¾å¤‡å­¦ä¹ &lt;/h3&gt;
&lt;p&gt;åªæ˜¯ä¸€ä¸ªçº¿æ€§å†…å­˜å—ã€‚æ²¡æœ‰ç®¡ç†å†…å­˜æˆ–å¤–å›´è®¾å¤‡çš„ä¸­å¤®å®ä½“ã€‚åªæ˜¯ç®—æœ¯ã€‚å¦‚æœä½ æ›¾ç»ä½¿ç”¨è¿‡åµŒå…¥å¼ç³»ç»Ÿï¼Œè¿™å¬èµ·æ¥å¯èƒ½å¾ˆç†Ÿæ‚‰ã€‚è™½ç„¶ç°ä»£åµŒå…¥å¼ç³»ç»Ÿè¿è¡Œ Linuxï¼Œä½†è¾ƒå°çš„å¾®å¤„ç†å™¨æ²¡æœ‰èµ„æºæ¥è¿™æ ·åšã€‚ &lt;a href=&#34;https://www.rust-lang.org/what/embedded&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Rust è¿˜é’ˆå¯¹é‚£äº›è¶…å—é™ç¯å¢ƒ&lt;/a&gt;ï¼Œ&lt;a href=&#34;https://docs.rust-embedded.org/book/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Embedded Rust Book&lt;/a&gt; å’Œ &lt;a href=&#34;https://docs.rust-embedded.org/embedonomicon/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Embedomicon&lt;/a&gt; è§£é‡Šäº†å¦‚ä½•ä¸ºè¿™äº›ç¯å¢ƒæ­£ç¡®ç¼–å†™ Rustã€‚&lt;/p&gt;
&lt;p&gt;è¦è¿›å…¥è£¸æœºä¸–ç•ŒğŸ¤˜ï¼Œæˆ‘ä»¬å¿…é¡»åœ¨ä»£ç ä¸­æ·»åŠ ä¸€è¡Œï¼š&lt;code&gt;#![no_std]&lt;/code&gt;ã€‚è¿™ä¸ª crate å®å‘Šè¯‰ Rust ä¸è¦é“¾æ¥åˆ°æ ‡å‡†åº“ã€‚ç›¸åï¼Œå®ƒåªé“¾æ¥åˆ° &lt;a href=&#34;https://docs.rs/core&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;core&lt;/a&gt;ã€‚Embedonomicon éå¸¸ç®€æ´åœ°&lt;a href=&#34;https://docs.rust-embedded.org/embedonomicon/smallest-no-std.html#what-does-no_std-mean&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è§£é‡Š&lt;/a&gt;äº†è¿™æ„å‘³ç€ä»€ä¹ˆï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;core&lt;/code&gt; crate æ˜¯ &lt;code&gt;std&lt;/code&gt; crate çš„å­é›†ï¼Œå®ƒå¯¹ç¨‹åºå°†åœ¨å…¶ä¸Šè¿è¡Œçš„ç³»ç»Ÿåšå‡ºé›¶å‡è®¾ã€‚å› æ­¤ï¼Œå®ƒä¸ºè¯­è¨€åŸè¯­ï¼ˆå¦‚æµ®ç‚¹æ•°ã€å­—ç¬¦ä¸²å’Œåˆ‡ç‰‡ï¼‰æä¾› APIï¼Œä»¥åŠå…¬å¼€å¤„ç†å™¨åŠŸèƒ½ï¼ˆå¦‚åŸå­æ“ä½œå’Œ SIMD æŒ‡ä»¤ï¼‰çš„ APIã€‚ä½†æ˜¯ï¼Œå®ƒç¼ºå°‘ä»»ä½•å¤„ç†å †å†…å­˜åˆ†é…å’Œ I/O çš„ APIã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºåº”ç”¨ç¨‹åºï¼Œstd ä¸ä»…ä»…æ˜¯æä¾›ä¸€ç§è®¿é—®æ“ä½œç³»ç»ŸæŠ½è±¡çš„æ–¹æ³•ã€‚std è¿˜è´Ÿè´£è®¾ç½®å †æ ˆæº¢å‡ºä¿æŠ¤ã€å¤„ç†å‘½ä»¤è¡Œå‚æ•°ä»¥åŠåœ¨è°ƒç”¨ç¨‹åºçš„ä¸»å‡½æ•°ä¹‹å‰ç”Ÿæˆä¸»çº¿ç¨‹ã€‚ &lt;code&gt;#![no_std]&lt;/code&gt; åº”ç”¨ç¨‹åºç¼ºå°‘æ‰€æœ‰æ ‡å‡†è¿è¡Œæ—¶ï¼Œå› æ­¤å¦‚æœéœ€è¦å®ƒå¿…é¡»åˆå§‹åŒ–è‡ªå·±çš„è¿è¡Œæ—¶ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿™å¬èµ·æ¥æœ‰ç‚¹å¯æ€•ï¼Œä½†è®©æˆ‘ä»¬ä¸€æ­¥ä¸€æ­¥æ¥ã€‚æˆ‘ä»¬é¦–å…ˆå°†ä¸Šé¢çš„ panic-y ç´ æ•°ç¨‹åºå£°æ˜ä¸º &lt;code&gt;no_std&lt;/code&gt;ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;#![no_std]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;static&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;no&#34;&gt;PRIMES&lt;/span&gt;: &lt;span class=&#34;kp&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;i32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;11&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;13&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;17&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;19&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;23&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;#[no_mangle]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;extern&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;C&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;nth_prime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;: &lt;span class=&#34;kt&#34;&gt;usize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;kt&#34;&gt;i32&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;no&#34;&gt;PRIMES&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¾ˆé—æ†¾ï¼ŒEmbedonomicon æ®µè½é¢„ç¤ºäº†è¿™ä¸€ç‚¹ã€‚å› ä¸ºæˆ‘ä»¬æ²¡æœ‰æä¾›æ ¸å¿ƒä¾èµ–é¡¹çš„ä¸€äº›åŸºç¡€çŸ¥è¯†ã€‚åœ¨åˆ—è¡¨çš„æœ€é¡¶éƒ¨ï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰åœ¨è¿™ç§ç¯å¢ƒä¸­å‘ç”Ÿææ…Œæ—¶åº”è¯¥å‘ç”Ÿä»€ä¹ˆã€‚è¿™æ˜¯ç”±æ°å½“å‘½åçš„ææ…Œå¤„ç†ç¨‹åºå®Œæˆçš„ï¼ŒEmbedonomicon ç»™å‡ºäº†ä¸€ä¸ªä¾‹å­ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;#[panic_handler]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;panic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;_panic&lt;/span&gt;: &lt;span class=&#34;kp&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;core&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;panic&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;PanicInfo&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;&amp;#39;_&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;loop&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™å¯¹äºåµŒå…¥å¼ç³»ç»Ÿæ¥è¯´æ˜¯éå¸¸å…¸å‹çš„ï¼Œæœ‰æ•ˆåœ°é˜»æ­¢äº†å¤„ç†å™¨åœ¨å´©æºƒå‘ç”Ÿåè¿›è¡Œä»»ä½•è¿›ä¸€æ­¥çš„å¤„ç†ã€‚ç„¶è€Œï¼Œè¿™åœ¨ web ä¸Šä¸æ˜¯å¥½çš„è¡Œä¸ºï¼Œæ‰€ä»¥å¯¹äº WebAssemblyï¼Œæˆ‘é€šå¸¸é€‰æ‹©æ‰‹åŠ¨å‘å‡ºæ— æ³•è®¿é—®çš„æŒ‡ä»¤æ¥é˜»æ­¢ä»»ä½• Wasm VM è¿è¡Œï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;#[panic_handler]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;panic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;_panic&lt;/span&gt;: &lt;span class=&#34;kp&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;core&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;panic&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;PanicInfo&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;&amp;#39;_&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;loop&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;core&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;arch&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;wasm32&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;unreachable&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æœ‰äº†è¿™ä¸ªï¼Œæˆ‘ä»¬çš„ç¨‹åºå†æ¬¡ç¼–è¯‘ã€‚å‰¥ç¦»å’Œ &lt;code&gt;wasm-opt&lt;/code&gt; åï¼ŒäºŒè¿›åˆ¶æ–‡ä»¶å¤§å°ä¸º 168Bã€‚æç®€ä¸»ä¹‰å†æ¬¡è·èƒœï¼&lt;/p&gt;
&lt;h2 id=&#34;å†…å­˜ç®¡ç†&#34;&gt;å†…å­˜ç®¡ç†&lt;/h2&gt;
&lt;p&gt;å½“ç„¶ï¼Œæˆ‘ä»¬å› éæ ‡å‡†è€Œæ”¾å¼ƒäº†å¾ˆå¤šã€‚æ²¡æœ‰å †åˆ†é…ï¼Œå°±æ²¡æœ‰ &lt;code&gt;Box&lt;/code&gt;ï¼Œæ²¡æœ‰ &lt;code&gt;Vec&lt;/code&gt;ï¼Œæ²¡æœ‰ &lt;code&gt;String&lt;/code&gt; å’Œè®¸å¤šå…¶ä»–æœ‰ç”¨çš„ä¸œè¥¿ã€‚å¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸æ”¾å¼ƒæ•´ä¸ªæ“ä½œç³»ç»Ÿçš„æƒ…å†µä¸‹å–å›è¿™äº›ä¸œè¥¿ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;std&lt;/code&gt; æä¾›çš„å¾ˆå¤šä¸œè¥¿å®é™…ä¸Šåªæ˜¯æ¥è‡ª &lt;code&gt;core&lt;/code&gt; çš„å¦ä¸€ä¸ªç§°ä¸º &lt;code&gt;alloc&lt;/code&gt; çš„ä¸œè¥¿ã€‚ &lt;code&gt;alloc&lt;/code&gt; åŒ…å«æœ‰å…³å†…å­˜åˆ†é…å’Œä¾èµ–äºå®ƒçš„æ•°æ®ç»“æ„çš„æ‰€æœ‰å†…å®¹ã€‚é€šè¿‡å¯¼å…¥å®ƒï¼Œæˆ‘ä»¬å¯ä»¥é‡æ–°è·å¾—æˆ‘ä»¬ä¿¡ä»»çš„ &lt;code&gt;Vec&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;#![no_std]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// One of the few occastions where we have to use `extern crate`
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// even in Rust Edition 2021.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;extern&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;crate&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;alloc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;use&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;alloc&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;vec&lt;/span&gt;::&lt;span class=&#34;nb&#34;&gt;Vec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;#[no_mangle]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;extern&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;C&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;nth_prime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;: &lt;span class=&#34;kt&#34;&gt;usize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;kt&#34;&gt;usize&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// Please enjoy this horrible implementation of
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// The Sieve of Eratosthenes.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;mut&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;primes&lt;/span&gt;: &lt;span class=&#34;nb&#34;&gt;Vec&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;usize&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Vec&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;new&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;mut&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;current&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;while&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;primes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;primes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;iter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;any&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;prime&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;current&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;%&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;prime&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;primes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;push&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;current&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;current&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;primes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;into_iter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;last&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unwrap_or&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;#[panic_handler]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;panic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;_panic&lt;/span&gt;: &lt;span class=&#34;kp&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;core&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;panic&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;PanicInfo&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;&amp;#39;_&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;core&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;arch&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;wasm32&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;unreachable&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å½“ç„¶ï¼Œå°è¯•ç¼–è¯‘å®ƒä¼šå¤±è´¥â€”â€”æˆ‘ä»¬å®é™…ä¸Šå¹¶æ²¡æœ‰å‘Šè¯‰ Rust æˆ‘ä»¬çš„å†…å­˜ç®¡ç†æ˜¯ä»€ä¹ˆæ ·çš„ï¼ŒVec éœ€è¦çŸ¥é“å®ƒæ‰èƒ½è¿è¡Œã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ cargo build --target&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;wasm32-unknown-unknown --release
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;error: no global memory allocator found but one is required&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  link to std or add &lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;#[global_allocator]` to a static item that implements &lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  the GlobalAlloc trait
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;error: &lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;#[alloc_error_handler]` function required, but not found&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;note: use &lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;#![feature(default_alloc_error_handler)]` for a default error handler&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åœ¨æ’°å†™æœ¬æ–‡æ—¶ï¼Œåœ¨ Rust 1.67 ä¸­ï¼Œä½ éœ€è¦æä¾›ä¸€ä¸ªåœ¨åˆ†é…å¤±è´¥æ—¶è°ƒç”¨çš„é”™è¯¯å¤„ç†ç¨‹åºã€‚åœ¨ä¸‹ä¸€ä¸ªç‰ˆæœ¬ä¸­ï¼ŒRust 1.68 &lt;code&gt;default_alloc_error_handler&lt;/code&gt; å·²ç»ç¨³å®šä¸‹æ¥ï¼Œè¿™æ„å‘³ç€æ¯ä¸ªéæ ‡å‡†çš„ Rust ç¨‹åºéƒ½å°†å¸¦æœ‰è¿™ä¸ªé”™è¯¯å¤„ç†ç¨‹åºçš„é»˜è®¤å®ç°ã€‚å¦‚æœä½ ä»æƒ³æä¾›è‡ªå·±çš„é”™è¯¯å¤„ç†ç¨‹åºï¼Œä½ å¯ä»¥ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;#[alloc_error_handler]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;alloc_error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;_&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;core&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;alloc&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;Layout&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;core&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;arch&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;wasm32&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;unreachable&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æœ‰äº†è¿™ä¸ªå¤æ‚çš„é”™è¯¯å¤„ç†ç¨‹åºï¼Œæˆ‘ä»¬æœ€ç»ˆåº”è¯¥æä¾›ä¸€ç§æ–¹æ³•æ¥è¿›è¡Œå®é™…çš„å†…å­˜åˆ†é…ã€‚å°±åƒæˆ‘åœ¨ &lt;a href=&#34;https://surma.dev/things/c-to-webassembly&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;C åˆ° WebAssembly&lt;/a&gt; çš„æ–‡ç« ä¸­ä¸€æ ·ï¼Œæˆ‘çš„è‡ªå®šä¹‰åˆ†é…å™¨å°†æ˜¯ä¸€ä¸ªæœ€å°çš„ bump åˆ†é…å™¨ï¼Œå®ƒå¾€å¾€åˆå¿«åˆå°ï¼Œä½†ä¸ä¼šé‡Šæ”¾å†…å­˜ã€‚æˆ‘ä»¬é™æ€åˆ†é…ä¸€ä¸ª arena ä½œä¸ºæˆ‘ä»¬çš„å †ï¼Œå¹¶è·Ÿè¸ªâ€œç©ºé—²åŒºåŸŸâ€çš„å¼€å§‹ä½ç½®ã€‚ç”±äºæˆ‘ä»¬ä¸ä½¿ç”¨ Wasm çº¿ç¨‹ï¼Œå› æ­¤æˆ‘ä¹Ÿä¼šå¿½ç•¥çº¿ç¨‹å®‰å…¨ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;use&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;core&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;cell&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;UnsafeCell&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;const&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;no&#34;&gt;ARENA_SIZE&lt;/span&gt;: &lt;span class=&#34;kt&#34;&gt;usize&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;128&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1024&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;#[repr(C, align(32))]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;SimpleAllocator&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arena&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;UnsafeCell&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;u8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;no&#34;&gt;ARENA_SIZE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;head&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;UnsafeCell&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;usize&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;impl&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SimpleAllocator&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;const&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;new&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;nc&#34;&gt;Self&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SimpleAllocator&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arena&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;UnsafeCell&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;new&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;no&#34;&gt;ARENA_SIZE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;head&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;UnsafeCell&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;new&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;impl&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Sync&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SimpleAllocator&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;#[global_allocator]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;static&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;no&#34;&gt;ALLOCATOR&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;SimpleAllocator&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SimpleAllocator&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;new&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å°† &lt;code&gt;#[global_allocator]&lt;/code&gt; å…¨å±€å˜é‡æ ‡è®°ä¸ºç®¡ç†å †çš„å®ä½“ã€‚æ­¤å˜é‡çš„ç±»å‹å¿…é¡»å®ç° GlobalAlloc ç‰¹æ€§ã€‚ç‰¹æ€§ä¸Šçš„ GlobalAlloc æ–¹æ³•éƒ½ä½¿ç”¨ &amp;amp;selfï¼Œæ‰€ä»¥å¦‚æœä½ æƒ³ä¿®æ”¹æ•°æ®ç±»å‹ä¸­çš„ä»»ä½•å€¼ï¼Œä½ å¿…é¡»ä½¿ç”¨å†…éƒ¨å¯å˜æ€§ã€‚æˆ‘è¿™é‡Œé€‰æ‹©äº† UnsafeCellã€‚ä½¿ç”¨ UnsafeCell ä½¿æˆ‘ä»¬çš„ç»“æ„éšå¼ !Syncï¼ŒRust ä¸å…è®¸å…¨å±€é™æ€å˜é‡ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬è¿˜å¿…é¡»æ‰‹åŠ¨å®ç° Synctrait æ¥å‘Šè¯‰ Rust æˆ‘ä»¬çŸ¥é“æˆ‘ä»¬æœ‰è´£ä»»ä½¿è¿™ç§æ•°æ®ç±»å‹æˆä¸ºçº¿ç¨‹å®‰å…¨çš„ï¼ˆè€Œæˆ‘ä»¬å®Œå…¨å¿½ç•¥äº†è¿™ä¸€ç‚¹ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;è¯¥ç»“æ„è¢«æ ‡è®°ä¸º &lt;code&gt;#[repr(C)]&lt;/code&gt; çš„åŸå› å¾ˆç®€å•ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨æŒ‡å®šå¯¹é½æ–¹å¼ã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ç¡®ä¿å³ä½¿æ˜¯ arena ä¸­çš„ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼ˆä»¥åŠæˆ‘ä»¬è¿”å›çš„ç¬¬ä¸€ä¸ªæŒ‡é’ˆçš„æ‰©å±•ï¼‰ä¹Ÿå…·æœ‰ 32 ä½å¯¹é½ï¼Œè¿™åº”è¯¥å¯ä»¥æ»¡è¶³å¤§å¤šæ•°æ•°æ®ç»“æ„ã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨ä¸ºç‰¹å¾çš„ GlobalAlloc çš„å®é™…å®ç°ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;impl&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;GlobalAlloc&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SimpleAllocator&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;alloc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;layout&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;Layout&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;mut&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;u8&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;layout&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;align&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;layout&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;align&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// Find the next address that has the right alignment.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;idx&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;head&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()).&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;next_multiple_of&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;align&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// Bump the head to the next free byte
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;head&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;idx&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arena&lt;/span&gt;: &lt;span class=&#34;kp&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;mut&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;u8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;no&#34;&gt;ARENA_SIZE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;mut&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arena&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;());&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// If we ran out of arena space, we return a null pointer, which
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// signals a failed allocation.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;match&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arena&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get_mut&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;idx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Some&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;item&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;item&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;mut&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;u8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;_&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;core&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;ptr&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;null_mut&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;dealloc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;_ptr&lt;/span&gt;: &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;mut&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;u8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;_layout&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;Layout&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;/* lol */&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;#[global_allocator]&lt;/code&gt; ä¸ä»…ä»…æ˜¯ &lt;code&gt;#[no_std]&lt;/code&gt;ï¼ä½ è¿˜å¯ä»¥ä½¿ç”¨å®ƒæ¥è¦†ç›– Rust çš„é»˜è®¤åˆ†é…å™¨å¹¶å°†å…¶æ›¿æ¢ä¸ºä½ è‡ªå·±çš„åˆ†é…å™¨ï¼Œå› ä¸º Rust çš„é»˜è®¤åˆ†é…å™¨æ¶ˆè€—å¤§çº¦ 10K Wasm ç©ºé—´ã€‚&lt;/p&gt;
&lt;h3 id=&#34;wee_alloc&#34;&gt;wee_alloc&lt;/h3&gt;
&lt;p&gt;å½“ç„¶ï¼Œä½ ä¸å¿…è‡ªå·±å®ç°åˆ†é…å™¨ã€‚äº‹å®ä¸Šï¼Œä¾é ç»è¿‡è‰¯å¥½æµ‹è¯•çš„å®æ–½å¯èƒ½æ˜¯æ˜æ™ºçš„ã€‚å¤„ç†åˆ†é…å™¨ä¸­çš„é”™è¯¯å’Œå¾®å¦™çš„å†…å­˜æŸåå¹¶ä¸å¥½ç©ã€‚&lt;/p&gt;
&lt;p&gt;è®¸å¤šæŒ‡å—æ¨è &lt;code&gt;wee_alloc&lt;/code&gt;ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸å°çš„ (&amp;lt;1KB) åˆ†é…å™¨ï¼Œç”± Rust WebAssembly å›¢é˜Ÿç¼–å†™ï¼Œä¹Ÿå¯ä»¥é‡Šæ”¾å†…å­˜ã€‚å¯æ‚²çš„æ˜¯ï¼Œå®ƒä¼¼ä¹æ²¡æœ‰å¾—åˆ°ç»´æŠ¤ï¼Œå¹¶ä¸”æœ‰ä¸€ä¸ª&lt;a href=&#34;https://github.com/rustwasm/wee_alloc/issues/105&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å…³äºå†…å­˜æŸåå’Œå†…å­˜æ³„æ¼çš„æœªè§£å†³é—®é¢˜&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ä»»ä½•ç›¸å½“å¤æ‚çš„ WebAssembly æ¨¡å—ä¸­ï¼ŒRust çš„é»˜è®¤åˆ†é…å™¨æ¶ˆè€—çš„ 10KB åªæ˜¯æ•´ä¸ªæ¨¡å—å¤§å°çš„ä¸€å°éƒ¨åˆ†ï¼Œæ‰€ä»¥æˆ‘å»ºè®®åšæŒä½¿ç”¨å®ƒå¹¶çŸ¥é“åˆ†é…å™¨ç»è¿‡è‰¯å¥½æµ‹è¯•å’Œæ€§èƒ½ã€‚&lt;/p&gt;
&lt;h2 id=&#34;wasm-bindgen&#34;&gt;wasm-bindgen&lt;/h2&gt;
&lt;p&gt;ç°åœ¨æˆ‘ä»¬å·²ç»å®Œæˆäº†å‡ ä¹æ‰€æœ‰å›°éš¾çš„äº‹æƒ…ï¼Œæˆ‘ä»¬å·²ç»çœ‹åˆ°äº†ä½¿ç”¨ &lt;a href=&#34;https://rustwasm.github.io/wasm-bindgen/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;wasm-bindgen&lt;/a&gt; ä¸º WebAssembly ç¼–å†™ Rust çš„ä¾¿æ·æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;wasm-bindgen çš„å…³é”®ç‰¹æ€§æ˜¯ &lt;code&gt;#[wasm_bindgen]&lt;/code&gt; å®ï¼Œæˆ‘ä»¬å¯ä»¥å°†å®ƒæ”¾åœ¨æˆ‘ä»¬æƒ³è¦å¯¼å‡ºçš„æ¯ä¸ªå‡½æ•°ä¸Šã€‚è¿™ä¸ªå®æ·»åŠ äº†æˆ‘ä»¬åœ¨æœ¬æ–‡å‰é¢æ‰‹åŠ¨æ·»åŠ çš„ç›¸åŒç¼–è¯‘å™¨æŒ‡ä»¤ï¼Œä½†å®ƒè¿˜åšäº†ä¸€äº›æ›´æœ‰ç”¨çš„äº‹æƒ…ã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬å°†ä¸Šé¢çš„å®æ·»åŠ åˆ°æˆ‘ä»¬çš„ &lt;code&gt;add&lt;/code&gt; å‡½æ•°ä¸­ï¼Œå®ƒä¼šå‘å‡ºå¦ä¸€ä¸ªä»¥&lt;a href=&#34;https://github.com/rustwasm/wasm-bindgen/blob/main/crates/cli-support/src/descriptor.rs&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ•°å­—æ ¼å¼&lt;/a&gt;è¿”å›æˆ‘ä»¬çš„å‡½æ•° &lt;code&gt;__wbindgen_describe_add&lt;/code&gt; çš„æè¿°ã€‚å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬å‡½æ•°çš„æè¿°ç¬¦å¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Function&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Function&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arguments&lt;/span&gt;: &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;U32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;U32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shim_idx&lt;/span&gt;: &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ret&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;U32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;inner_ret&lt;/span&gt;: &lt;span class=&#34;nb&#34;&gt;Some&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;U32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„å‡½æ•°ï¼Œä½†æ˜¯ wasm-bindgen ä¸­çš„æè¿°ç¬¦èƒ½å¤Ÿè¡¨ç¤ºéå¸¸å¤æ‚çš„å‡½æ•°ç­¾åã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;å±•å¼€ï¼š&lt;/strong&gt; å¦‚æœä½ æƒ³æŸ¥çœ‹å®å‘å‡ºçš„ä»£ç  &lt;code&gt;#[wasm_bindgen]&lt;/code&gt;ï¼Œè¯·ä½¿ç”¨ rust-analyzer çš„â€œé€’å½’æ‰©å±•å®â€åŠŸèƒ½ã€‚ä½ å¯ä»¥é€šè¿‡å‘½ä»¤é¢æ¿åœ¨ VS Code è¿è¡Œå®ƒã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿™äº›æè¿°ç¬¦æœ‰ä»€ä¹ˆç”¨ï¼Ÿwasm-bindgen ä¸ä»…æä¾›äº†ä¸€ä¸ªå®ï¼Œå®ƒè¿˜é™„å¸¦äº†ä¸€ä¸ª CLIï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®ƒæ¥å¯¹æˆ‘ä»¬çš„ Wasm äºŒè¿›åˆ¶æ–‡ä»¶è¿›è¡Œåå¤„ç†ã€‚CLI æå–è¿™äº›æè¿°ç¬¦å¹¶ä½¿ç”¨æ­¤ä¿¡æ¯ç”Ÿæˆè‡ªå®šä¹‰ JavaScript ç»‘å®šï¼ˆç„¶ååˆ é™¤æ‰€æœ‰ä¸å†éœ€è¦çš„æè¿°ç¬¦å‡½æ•°ï¼‰ã€‚ç”Ÿæˆçš„ JavaScript å…·æœ‰å¤„ç†æ›´é«˜çº§åˆ«ç±»å‹çš„æ‰€æœ‰ä¾‹ç¨‹ï¼Œå…è®¸ä½ æ— ç¼ä¼ é€’ç±»å‹ï¼Œä¾‹å¦‚å­—ç¬¦ä¸²ã€&lt;code&gt;ArrayBuffer&lt;/code&gt; ç”šè‡³é—­åŒ…ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ æƒ³ä¸º WebAssembly ç¼–å†™ Rustï¼Œæˆ‘æ¨è wasm-bindgenã€‚wasm-bindgen ä¸é€‚ç”¨äº &lt;code&gt;#![no_std]&lt;/code&gt;ï¼Œä½†å®é™…ä¸Šè¿™å¾ˆå°‘æˆä¸ºé—®é¢˜ã€‚&lt;/p&gt;
&lt;h2 id=&#34;wasm-pack&#34;&gt;wasm-pack&lt;/h2&gt;
&lt;p&gt;æˆ‘è¿˜æƒ³æä¸€ä¸‹ &lt;a href=&#34;https://rustwasm.github.io/wasm-pack/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;wasm-pack&lt;/a&gt;ï¼Œè¿™æ˜¯å¦ä¸€ä¸ªç”¨äº WebAssembly çš„ Rust å·¥å…·ã€‚æˆ‘ä»¬ä½¿ç”¨å…¨å¥—å·¥å…·æ¥ç¼–è¯‘å’Œå¤„ç†æˆ‘ä»¬çš„ WebAssembly ä»¥ä¼˜åŒ–æœ€ç»ˆç»“æœã€‚&lt;code&gt;wasm-pack&lt;/code&gt; æ˜¯ä¸€ç§å¯¹å¤§å¤šæ•°è¿™äº›è¿‡ç¨‹è¿›è¡Œç¼–ç çš„å·¥å…·ã€‚å®ƒå¯ä»¥ä½¿ç”¨é’ˆå¯¹ WebAssembly ä¼˜åŒ–çš„æ‰€æœ‰è®¾ç½®å¼•å¯¼ä¸€ä¸ªæ–°çš„ Rust é¡¹ç›®ã€‚å®ƒæ„å»ºé¡¹ç›®å¹¶ä½¿ç”¨æ‰€æœ‰æ­£ç¡®çš„æ ‡å¿—è°ƒç”¨ &lt;code&gt;cargo&lt;/code&gt;ï¼Œç„¶åå®ƒè°ƒç”¨ &lt;code&gt;wasm-bindgen&lt;/code&gt; CLI æ¥ç”Ÿæˆç»‘å®šï¼Œæœ€åå®ƒè¿è¡Œ &lt;code&gt;wasm-opt&lt;/code&gt; ä»¥ç¡®ä¿æˆ‘ä»¬ä¸ä¼šç•™ä¸‹ä»»ä½•æ€§èƒ½é—®é¢˜ã€‚&lt;code&gt;wasm-pack&lt;/code&gt; è¿˜èƒ½å¤Ÿå‡†å¤‡ä½ çš„ WebAssembly æ¨¡å—ä»¥å‘å¸ƒåˆ° npmï¼Œä½†æˆ‘ä¸ªäººä»æœªä½¿ç”¨è¿‡è¯¥åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;Rust æ˜¯ä¸€ç§ç”¨äº WebAssembly çš„ä¼˜ç§€è¯­è¨€ã€‚å¯ç”¨ LTO åï¼Œä½ å°†è·å¾—éå¸¸å°çš„æ¨¡å—ã€‚Rust çš„ WebAssembly å·¥å…·éå¸¸å‡ºè‰²ï¼Œè‡ªä»æˆ‘ç¬¬ä¸€æ¬¡åœ¨ &lt;a href=&#34;https://squoosh.app/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Squoosh&lt;/a&gt; ä¸­ä½¿ç”¨å®ƒä»¥æ¥ï¼Œå®ƒå˜å¾—æ›´å¥½äº†ã€‚å‘å‡ºçš„èƒ¶æ°´ä»£ç  &lt;code&gt;wasm-bindgen&lt;/code&gt; æ—¢ç°ä»£åˆ tree-shakenã€‚çœ‹åˆ°å®ƒåœ¨å¹•åæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œæˆ‘ä»ä¸­è·å¾—äº†å¾ˆå¤šä¹è¶£ï¼Œå®ƒå¸®åŠ©æˆ‘ç†è§£å’Œæ¬£èµæ‰€æœ‰å·¥å…·ä¸ºæˆ‘æ‰€åšçš„äº‹æƒ…ã€‚æˆ‘å¸Œæœ›ä½ ä¹Ÿæœ‰åŒæ„Ÿã€‚éå¸¸æ„Ÿè°¢ &lt;a href=&#34;https://twitter.com/opinionatedpie&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Ingrid&lt;/a&gt;ã€&lt;a href=&#34;https://twitter.com/rreverser&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Ingvar&lt;/a&gt; å’Œ &lt;a href=&#34;https://twitter.com/saulecabrera/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Saul&lt;/a&gt; å®¡é˜…è¿™ç¯‡æ–‡ç« ã€‚&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>
