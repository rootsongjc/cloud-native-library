<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Nginx | äº‘åŸç”Ÿèµ„æ–™åº“</title>
    <link>https://lib.jimmysong.io/tag/nginx/</link>
      <atom:link href="https://lib.jimmysong.io/tag/nginx/index.xml" rel="self" type="application/rss+xml" />
    <description>Nginx</description>
    <generator>Wowchemy (https://wowchemy.com)</generator><language>zh</language><lastBuildDate>Wed, 21 Jun 2023 16:00:00 +0800</lastBuildDate>
    <image>
      <url>https://lib.jimmysong.io/media/sharing.png</url>
      <title>Nginx</title>
      <link>https://lib.jimmysong.io/tag/nginx/</link>
    </image>
    
    <item>
      <title>Nginx Ingress å¿«é€Ÿå¼€å§‹</title>
      <link>https://lib.jimmysong.io/argo-rollouts/getting-started/nginx/</link>
      <pubDate>Wed, 21 Jun 2023 16:00:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/argo-rollouts/getting-started/nginx/</guid>
      <description>&lt;p&gt;æœ¬æŒ‡å—ä»‹ç»äº† Argo Rollouts å¦‚ä½•ä¸ &lt;a href=&#34;https://github.com/kubernetes/ingress-nginx&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;NGINX Ingress Controller&lt;/a&gt; é›†æˆè¿›è¡Œæµé‡æ•´å½¢ã€‚æœ¬æŒ‡å—åŸºäº &lt;a href=&#34;../basic-usage/&#34;&gt;åŸºæœ¬å…¥é—¨æŒ‡å—&lt;/a&gt; çš„æ¦‚å¿µã€‚&lt;/p&gt;
&lt;h2 id=&#34;è¦æ±‚&#34;&gt;è¦æ±‚&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;å®‰è£…äº† NGINX Ingress æ§åˆ¶å™¨çš„ Kubernetes ç¾¤é›†&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ğŸ”” æç¤ºï¼šè¯·å‚é˜… &lt;a href=&#34;https://argo-rollouts.readthedocs.io/en/stable/getting-started/setup/#nginx-ingress-controller-setup&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;NGINX ç¯å¢ƒè®¾ç½®æŒ‡å—&lt;/a&gt; ä»¥äº†è§£å¦‚ä½•ä½¿ç”¨ nginx è®¾ç½®æœ¬åœ° minikube ç¯å¢ƒã€‚&lt;/p&gt;
&lt;h2 id=&#34;1-éƒ¨ç½²-rolloutæœåŠ¡å’Œ-ingress&#34;&gt;1. éƒ¨ç½² Rolloutã€æœåŠ¡å’Œ Ingress&lt;/h2&gt;
&lt;p&gt;å½“ä½¿ç”¨ NGINX Ingress ä½œä¸ºæµé‡è·¯ç”±å™¨æ—¶ï¼ŒRollout é‡‘ä¸é›€ç­–ç•¥å¿…é¡»å®šä¹‰ä»¥ä¸‹å¼ºåˆ¶å­—æ®µï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;argoproj.io/v1alpha1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Rollout&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;rollouts-demo&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;strategy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;     &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;canary&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# å¼•ç”¨æ§åˆ¶å™¨å°†æ›´æ–°å¹¶æŒ‡å‘é‡‘ä¸é›€ ReplicaSet çš„æœåŠ¡&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;canaryService&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;rollouts-demo-canary&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# å¼•ç”¨æ§åˆ¶å™¨å°†æ›´æ–°å¹¶æŒ‡å‘ç¨³å®š ReplicaSet çš„æœåŠ¡&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;stableService&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;rollouts-demo-stable&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;trafficRouting&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;         &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;nginx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;           &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# å¼•ç”¨ä¸€ä¸ª Ingressï¼Œè¯¥ Ingress å…·æœ‰æŒ‡å‘ç¨³å®šæœåŠ¡ï¼ˆä¾‹å¦‚ rollouts-demo-stableï¼‰çš„è§„åˆ™&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;           &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# ä¸ºäº†å®ç° NGINX æµé‡åˆ†å‰²ï¼Œæ­¤ ingress å°†è¢«å…‹éš†ä¸ºä¸€ä¸ªæ–°åç§°ã€‚&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;           &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;stableIngress&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;rollouts-demo-stable&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åœ¨ &lt;code&gt;canary.trafficRouting.nginx.stableIngress&lt;/code&gt; ä¸­å¼•ç”¨çš„ Ingress å¿…é¡»å…·æœ‰åç«¯ï¼Œè¯¥åç«¯æŒ‡å‘ &lt;code&gt;canary.stableService&lt;/code&gt; ä¸‹å¼•ç”¨çš„æœåŠ¡ã€‚åœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼Œè¯¥ç¨³å®šæœåŠ¡çš„åç§°ä¸º &lt;code&gt;rollouts-demo-stable&lt;/code&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt; apiVersion: networking.k8s.io/v1beta1
 kind: Ingress
 metadata:
   name: rollouts-demo-stable
   annotations:
     kubernetes.io/ingress.class: nginx
 spec:
   rules:
   - host: rollouts-demo.local
     http:
       paths:
       - path: /
         backend:
           # å¼•ç”¨ä¸€ä¸ªæœåŠ¡åç§°ï¼Œä¹Ÿåœ¨ Rollout è§„èŒƒçš„ `strategy.canary.stableService` ä¸­æŒ‡å®š
           serviceName: rollouts-demo-stable
           servicePort: 80
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¿è¡Œä»¥ä¸‹å‘½ä»¤ä»¥éƒ¨ç½²ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸€ä¸ª Rollout&lt;/li&gt;
&lt;li&gt;ä¸¤ä¸ªæœåŠ¡ï¼ˆç¨³å®šå’Œé‡‘ä¸é›€ï¼‰&lt;/li&gt;
&lt;li&gt;ä¸€ä¸ª Ingress&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl apply -f https://raw.githubusercontent.com/argoproj/argo-rollouts/master/docs/getting-started/nginx/rollout.yaml
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl apply -f https://raw.githubusercontent.com/argoproj/argo-rollouts/master/docs/getting-started/nginx/services.yaml
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl apply -f https://raw.githubusercontent.com/argoproj/argo-rollouts/master/docs/getting-started/nginx/ingress.yaml
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åº”ç”¨æ¸…å•åï¼Œä½ åº”è¯¥åœ¨ç¾¤é›†ä¸­çœ‹åˆ°ä»¥ä¸‹æ»šåŠ¨ã€æœåŠ¡å’Œ Ingress èµ„æºï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ kubectl get ro
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;NAME            DESIRED   CURRENT   UP-TO-DATE   AVAILABLE
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;rollouts-demo   &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;         &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;         &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;            &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ kubectl get svc
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;NAME                   TYPE        CLUSTER-IP      EXTERNAL-IP   PORT&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;S&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;   AGE
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;rollouts-demo-canary   ClusterIP   10.96.6.241     &amp;lt;none&amp;gt;        80/TCP    33s
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;rollouts-demo-stable   ClusterIP   10.102.229.83   &amp;lt;none&amp;gt;        80/TCP    33s
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ kubectl get ing
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;NAME                                        CLASS    HOSTS                 ADDRESS        PORTS   AGE
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;rollouts-demo-stable                        &amp;lt;none&amp;gt;   rollouts-demo.local   192.168.64.2   &lt;span class=&#34;m&#34;&gt;80&lt;/span&gt;      36s
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;rollouts-demo-rollouts-demo-stable-canary   &amp;lt;none&amp;gt;   rollouts-demo.local   192.168.64.2   &lt;span class=&#34;m&#34;&gt;80&lt;/span&gt;      35s
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä½ è¿˜åº”è¯¥æ³¨æ„åˆ°ç”± rollouts æ§åˆ¶å™¨åˆ›å»ºçš„ç¬¬äºŒä¸ª Ingressï¼Œ&lt;code&gt;rollouts-demo-rollouts-demo-stable-canary&lt;/code&gt;ã€‚è¿™ä¸ª Ingress æ˜¯â€œé‡‘ä¸é›€ Ingressâ€ï¼Œæ˜¯ç”¨æˆ·ç®¡ç†çš„ Ingress çš„å…‹éš†ï¼Œå…¶å¼•ç”¨åœ¨ &lt;code&gt;nginx.stableIngress&lt;/code&gt; ä¸‹ã€‚å®ƒç”± nginx ingress æ§åˆ¶å™¨ç”¨äºå®ç°é‡‘ä¸é›€æµé‡åˆ†å‰²ã€‚ç”Ÿæˆçš„ ingress åç§°ä½¿ç”¨ &lt;code&gt;&amp;lt;ROLLOUT-NAME&amp;gt;-&amp;lt;INGRESS-NAME&amp;gt;-canary&lt;/code&gt; è¿›è¡Œå…¬å¼åŒ–ã€‚æœ‰å…³ç¬¬äºŒä¸ª Ingress çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯åœ¨ä¸‹ä¸€èŠ‚ä¸­è®¨è®ºã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl argo rollouts get rollout rollouts-demo
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;















&lt;figure  id=&#34;figure-rollout-nginx&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Rollout Nginx&#34; srcset=&#34;
               /argo-rollouts/getting-started/nginx/images/rollout-nginx_hu7fcf573354653835275469788061165a_115599_bead1b84f6cffb99b8368584712e2b93.webp 400w,
               /argo-rollouts/getting-started/nginx/images/rollout-nginx_hu7fcf573354653835275469788061165a_115599_6bc66780b4c1b76b697e2d4dedd19308.webp 760w,
               /argo-rollouts/getting-started/nginx/images/rollout-nginx_hu7fcf573354653835275469788061165a_115599_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/argo-rollouts/getting-started/nginx/images/rollout-nginx_hu7fcf573354653835275469788061165a_115599_bead1b84f6cffb99b8368584712e2b93.webp&#34;
               width=&#34;760&#34;
               height=&#34;401&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      Rollout Nginx
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h2 id=&#34;2-æ‰§è¡Œæ›´æ–°&#34;&gt;2. æ‰§è¡Œæ›´æ–°&lt;/h2&gt;
&lt;p&gt;é€šè¿‡æ›´æ”¹é•œåƒæ¥æ›´æ–° rolloutï¼Œå¹¶ç­‰å¾…å…¶è¾¾åˆ°æš‚åœçŠ¶æ€ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl argo rollouts &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt; image rollouts-demo rollouts-demo&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;argoproj/rollouts-demo:yellow
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl argo rollouts get rollout rollouts-demo
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;















&lt;figure  id=&#34;figure-rollout-nginx-å·²æš‚åœ&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Rollout Nginx å·²æš‚åœ&#34; srcset=&#34;
               /argo-rollouts/getting-started/nginx/images/paused-rollout-nginx_hu0612d377ddf3e2d1bf24db904b588dcf_371192_ac65e0d246cabe13ba36854bb6c8366f.webp 400w,
               /argo-rollouts/getting-started/nginx/images/paused-rollout-nginx_hu0612d377ddf3e2d1bf24db904b588dcf_371192_54bfa53e70573bffbb4b75b90af3332c.webp 760w,
               /argo-rollouts/getting-started/nginx/images/paused-rollout-nginx_hu0612d377ddf3e2d1bf24db904b588dcf_371192_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/argo-rollouts/getting-started/nginx/images/paused-rollout-nginx_hu0612d377ddf3e2d1bf24db904b588dcf_371192_ac65e0d246cabe13ba36854bb6c8366f.webp&#34;
               width=&#34;760&#34;
               height=&#34;474&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      Rollout Nginx å·²æš‚åœ
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;æ­¤æ—¶ï¼ŒRollout çš„é‡‘ä¸é›€å’Œç¨³å®šç‰ˆæœ¬éƒ½æ­£åœ¨è¿è¡Œï¼Œå…¶ä¸­ 5% çš„æµé‡å®šå‘åˆ°é‡‘ä¸é›€ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå°½ç®¡åªè¿è¡Œäº†ä¸¤ä¸ª podï¼Œä½†æ˜¯ Rollout èƒ½å¤Ÿå®ç° 5% çš„é‡‘ä¸é›€æƒé‡ã€‚è¿™å¯ä»¥é€šè¿‡åœ¨ ingress æ§åˆ¶å™¨ä¸­å‘ç”Ÿæµé‡åˆ†å‰²ï¼ˆè€Œä¸æ˜¯åŠ æƒå‰¯æœ¬è®¡æ•°å’Œ kube-proxyï¼‰æ¥å®ç°ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æ£€æŸ¥ Rollout æ§åˆ¶å™¨ç”Ÿæˆçš„ Ingress å‰¯æœ¬æ—¶ï¼Œæˆ‘ä»¬å‘ç°å®ƒä¸åŸå§‹ Ingress ç›¸æ¯”å…·æœ‰ä»¥ä¸‹æ›´æ”¹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ·»åŠ äº†ä¸¤ä¸ªé™„åŠ çš„ &lt;a href=&#34;https://kubernetes.github.io/ingress-nginx/user-guide/nginx-configuration/annotations/#canary&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;NGINX ç‰¹å®šçš„é‡‘ä¸é›€æ³¨é‡Š&lt;/a&gt; åˆ°æ³¨é‡Šä¸­ã€‚&lt;/li&gt;
&lt;li&gt;Ingress è§„åˆ™å°†å…·æœ‰æŒ‡å‘ &lt;em&gt;é‡‘ä¸é›€&lt;/em&gt; æœåŠ¡çš„è§„åˆ™ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;extensions/v1beta1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Ingress&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;rollouts-demo-rollouts-demo-stable-canary&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;annotations&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kubernetes.io/ingress.class&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;nginx&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;nginx.ingress.kubernetes.io/canary&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;true&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;nginx.ingress.kubernetes.io/canary-weight&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;5&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;rules&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;host&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;rollouts-demo.local&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;http&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;paths&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;backend&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;serviceName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;rollouts-demo-canary&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;servicePort&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;80&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;éšç€ Rollout é€šè¿‡æ­¥éª¤è¿›è¡Œï¼Œ&lt;code&gt;canary-weight&lt;/code&gt; æ³¨é‡Šå°†æ ¹æ®æ­¥éª¤çš„ &lt;code&gt;setWeight&lt;/code&gt; è°ƒæ•´ã€‚NGINX Ingress æ§åˆ¶å™¨æ£€æŸ¥åŸå§‹ Ingressã€é‡‘ä¸é›€ Ingress å’Œ &lt;code&gt;canary-weight&lt;/code&gt; æ³¨é‡Šï¼Œä»¥ç¡®å®šåœ¨ä¸¤ä¸ª Ingress ä¹‹é—´æ‹†åˆ†å¤šå°‘æµé‡ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Nginx</title>
      <link>https://lib.jimmysong.io/argo-rollouts/traffic-management/nginx/</link>
      <pubDate>Wed, 21 Jun 2023 16:00:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/argo-rollouts/traffic-management/nginx/</guid>
      <description>&lt;p&gt;&lt;a href=&#34;https://kubernetes.github.io/ingress-nginx/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Nginx Ingress Controller&lt;/a&gt; å…è®¸é€šè¿‡ä¸€ä¸ªæˆ–å¤šä¸ª Ingress å¯¹è±¡è¿›è¡Œæµé‡ç®¡ç†ï¼Œä»¥é…ç½®ç›´æ¥å°†æµé‡è·¯ç”±åˆ° Pod çš„ Nginx éƒ¨ç½²ã€‚æ¯ä¸ª Nginx Ingress éƒ½åŒ…å«å¤šä¸ªæ³¨é‡Šï¼Œå¯ä»¥ä¿®æ”¹ Nginx éƒ¨ç½²çš„è¡Œä¸ºã€‚å¯¹äºåº”ç”¨ç¨‹åºä¸åŒç‰ˆæœ¬ä¹‹é—´çš„æµé‡ç®¡ç†ï¼ŒNginx Ingress æ§åˆ¶å™¨æä¾›äº†é€šè¿‡å¼•å…¥ç¬¬äºŒä¸ª Ingress å¯¹è±¡ï¼ˆç§°ä¸ºé‡‘ä¸é›€ Ingressï¼‰è¿›è¡Œæµé‡æ‹†åˆ†çš„åŠŸèƒ½ã€‚ä½ å¯ä»¥åœ¨å®˜æ–¹çš„ &lt;a href=&#34;https://kubernetes.github.io/ingress-nginx/user-guide/nginx-configuration/annotations/#canary&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;é‡‘ä¸é›€æ³¨é‡Šæ–‡æ¡£é¡µé¢&lt;/a&gt; ä¸Šé˜…è¯»æ›´å¤šå…³äºè¿™äº›é‡‘ä¸é›€æ³¨é‡Šçš„ä¿¡æ¯ã€‚é‡‘ä¸é›€ Ingress å¿½ç•¥ä»»ä½•å…¶ä»–éé‡‘ä¸é›€ nginx æ³¨é‡Šã€‚å–è€Œä»£ä¹‹ï¼Œå®ƒåˆ©ç”¨æ¥è‡ªä¸»è¦ Ingress çš„æ³¨é‡Šè®¾ç½®ã€‚&lt;/p&gt;
&lt;p&gt;Rollout æ§åˆ¶å™¨å§‹ç»ˆä¼šåœ¨é‡‘ä¸é›€ Ingress ä¸Šè®¾ç½®ä»¥ä¸‹ä¸¤ä¸ªæ³¨é‡Šï¼ˆä½¿ç”¨ä½ é…ç½®çš„æˆ–é»˜è®¤çš„ &lt;code&gt;nginx.ingress.kubernetes.io&lt;/code&gt; å‰ç¼€ï¼‰ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;canary: true&lt;/code&gt; è¡¨ç¤ºè¿™æ˜¯é‡‘ä¸é›€ Ingress&lt;/li&gt;
&lt;li&gt;&lt;code&gt;canary-weight: &amp;lt;num&amp;gt;&lt;/code&gt; è¡¨ç¤ºå°†å‘é€åˆ°é‡‘ä¸é›€çš„æµé‡ç™¾åˆ†æ¯”ã€‚å¦‚æœæ‰€æœ‰æµé‡éƒ½è·¯ç”±åˆ°ç¨³å®šæœåŠ¡ï¼Œåˆ™è®¾ç½®ä¸º &lt;code&gt;0&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä½ å¯ä»¥é€šè¿‡ &lt;code&gt;additionalIngressAnnotations&lt;/code&gt; å­—æ®µæä¾›å…¶ä»–æ³¨é‡Šä»¥æ·»åŠ åˆ°é‡‘ä¸é›€ Ingressï¼Œä»¥å¯ç”¨æŒ‰æ ‡å¤´æˆ– cookie è¿›è¡Œè·¯ç”±ç­‰åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä¸-argo-rollouts-é›†æˆ&#34;&gt;ä¸ Argo Rollouts é›†æˆ&lt;/h2&gt;
&lt;p&gt;ä½¿ç”¨ Nginx å‘é€ç‰ˆæœ¬é—´çš„åˆ†å‰²æµé‡éœ€è¦åœ¨ Rollout ä¸­æœ‰å‡ ä¸ªå¿…éœ€å­—æ®µã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªå¸¦æœ‰è¿™äº›å­—æ®µçš„ Rollout ç¤ºä¾‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;argoproj.io/v1alpha1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Rollout&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;strategy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;     &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;canary&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;canaryService&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;canary-service &lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# å¿…éœ€&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;stableService&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;stable-service &lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# å¿…éœ€&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;       &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;trafficRouting&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;         &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;nginx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;           &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# å¿…é¡»é…ç½® stableIngress æˆ– stableIngress ä¸­çš„ä¸€ä¸ªï¼Œä½†ä¸èƒ½åŒæ—¶é…ç½®ã€‚&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;           &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;stableIngress&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;primary-ingress&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;           &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;stableIngresses&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;             &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;primary-ingress&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;             &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;secondary-ingress&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;             &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;tertiary-ingress&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;           &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;annotationPrefix&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;customingress.nginx.ingress.kubernetes.io&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# å¯é€‰çš„&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;           &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;additionalIngressAnnotations&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# å¯é€‰çš„&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;             &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;canary-by-header&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;X-Canary&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;             &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;canary-by-header-value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;iwantsit&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç¨³å®š Ingress å­—æ®µæ˜¯å¯¹ Rollout åŒä¸€å‘½åç©ºé—´ä¸­çš„ Ingress çš„å¼•ç”¨ã€‚Rollout éœ€è¦ä¸»è¦ Ingress å°†æµé‡è·¯ç”±åˆ°ç¨³å®šæœåŠ¡ã€‚Rollout é€šè¿‡ç¡®è®¤ Ingress æ˜¯å¦å…·æœ‰ä¸ Rollout çš„ stableService åŒ¹é…çš„åç«¯æ¥æ£€æŸ¥è¯¥æ¡ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;æ§åˆ¶å™¨é€šè¿‡åˆ›å»ºå…·æœ‰é‡‘ä¸é›€æ³¨é‡Šçš„ç¬¬äºŒä¸ª Ingress æ¥å°†æµé‡è·¯ç”±åˆ°é‡‘ä¸é›€æœåŠ¡ã€‚éšç€ Rollout ç»è¿‡é‡‘ä¸é›€æ­¥éª¤ï¼Œæ§åˆ¶å™¨æ›´æ–°é‡‘ä¸é›€ Ingress çš„é‡‘ä¸é›€æ³¨é‡Šï¼Œä»¥åæ˜  Rollout çš„æ‰€éœ€çŠ¶æ€ï¼Œä»è€Œå®ç°ä¸¤ä¸ªä¸åŒç‰ˆæœ¬ä¹‹é—´çš„æµé‡åˆ†é…ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äº Nginx Ingress æ§åˆ¶å™¨å…è®¸ç”¨æˆ·é…ç½®ç”¨äº Ingress æ§åˆ¶å™¨çš„æ³¨é‡Šå‰ç¼€ï¼Œå› æ­¤ Rollout å¯ä»¥æŒ‡å®šå¯é€‰çš„ &lt;code&gt;annotationPrefix&lt;/code&gt; å­—æ®µã€‚å¦‚æœè®¾ç½®äº†è¯¥å­—æ®µï¼Œåˆ™é‡‘ä¸é›€ Ingress å°†ä½¿ç”¨è¯¥å‰ç¼€è€Œä¸æ˜¯é»˜è®¤çš„ &lt;code&gt;nginx.ingress.kubernetes.io&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;åœ¨ä¸€ä¸ªæœåŠ¡ä¸­ä½¿ç”¨å¤šä¸ª-nginx-ingress-æ§åˆ¶å™¨ä¸-argo-rollouts&#34;&gt;åœ¨ä¸€ä¸ªæœåŠ¡ä¸­ä½¿ç”¨å¤šä¸ª NGINX Ingress æ§åˆ¶å™¨ä¸ Argo Rollouts&lt;/h2&gt;
&lt;p&gt;ä» v1.5 å¼€å§‹ï¼Œargo rollouts æ”¯æŒå¤šä¸ª Nginx Ingress æ§åˆ¶å™¨æŒ‡å‘å…·æœ‰é‡‘ä¸é›€éƒ¨ç½²çš„ä¸€ä¸ªæœåŠ¡ã€‚å¦‚æœåªéœ€è¦ä¸€ä¸ª Ingress æ§åˆ¶å™¨ï¼Œè¯·ä½¿ç”¨ç°æœ‰çš„é”® &lt;code&gt;stableIngress&lt;/code&gt;ã€‚å¦‚æœéœ€è¦å¤šä¸ª Ingress æ§åˆ¶å™¨ï¼ˆä¾‹å¦‚ï¼Œåˆ†ç¦»å†…éƒ¨å’Œå¤–éƒ¨æµé‡ï¼‰ï¼Œè¯·æ”¹ç”¨é”® &lt;code&gt;stableIngresses&lt;/code&gt;ã€‚å®ƒæ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²å€¼æ•°ç»„ï¼Œè¿™äº›å­—ç¬¦ä¸²å€¼æ˜¯ Ingress æ§åˆ¶å™¨çš„åç§°ã€‚é‡‘ä¸é›€æ­¥éª¤åœ¨æ‰€æœ‰ Ingress æ§åˆ¶å™¨ä¸Šåº”ç”¨ç›¸åŒçš„æ–¹å¼ã€‚&lt;/p&gt;
&lt;h2 id=&#34;åœ¨è‡ªå®šä¹‰-nginx-ingress-æ§åˆ¶å™¨åç§°ä¸­ä½¿ç”¨-argo-rollouts&#34;&gt;åœ¨è‡ªå®šä¹‰ NGINX ingress æ§åˆ¶å™¨åç§°ä¸­ä½¿ç”¨ Argo Rollouts&lt;/h2&gt;
&lt;p&gt;é»˜è®¤æƒ…å†µä¸‹ï¼ŒArgo Rollouts æ§åˆ¶å™¨ä»…åœ¨å…·æœ‰ &lt;code&gt;kubernetes.io/ingress.class&lt;/code&gt; æ³¨é‡Šæˆ– &lt;code&gt;spec.ingressClassName&lt;/code&gt; è®¾ç½®ä¸º &lt;code&gt;nginx&lt;/code&gt; çš„ Ingress ä¸Šè¿è¡Œã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡æŒ‡å®š &lt;code&gt;--nginx-ingress-classes&lt;/code&gt; æ ‡å¿—å°†æ§åˆ¶å™¨é…ç½®ä¸ºåœ¨å…·æœ‰ä¸åŒç±»åçš„ Ingress ä¸Šè¿è¡Œã€‚å¦‚æœ Argo Rollouts æ§åˆ¶å™¨åº”è¯¥åœ¨å¤šä¸ªå€¼ä¸Šè¿è¡Œï¼Œåˆ™ç”¨æˆ·å¯ä»¥å¤šæ¬¡åˆ—å‡º &lt;code&gt;--nginx-ingress-classes&lt;/code&gt; æ ‡å¿—ã€‚è¿™è§£å†³äº†é›†ç¾¤å…·æœ‰åœ¨ä¸åŒç±»å€¼ä¸Šè¿è¡Œçš„å¤šä¸ª Ingress æ§åˆ¶å™¨çš„æƒ…å†µã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœç”¨æˆ·å¸Œæœ›æ§åˆ¶å™¨åœ¨æ²¡æœ‰ &lt;code&gt;kubernetes.io/ingress.class&lt;/code&gt; æ³¨é‡Šæˆ– &lt;code&gt;spec.ingressClassName&lt;/code&gt; çš„ä»»ä½• Ingress ä¸Šè¿è¡Œï¼Œåˆ™ç”¨æˆ·åº”æ·»åŠ ä»¥ä¸‹å†…å®¹ &lt;code&gt;--nginx-ingress-classes &#39;&#39;&lt;/code&gt;ã€‚&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>
