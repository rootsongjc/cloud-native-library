<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>è¯‘æ–‡ | äº‘åŸç”Ÿèµ„æ–™åº“</title>
    <link>https://lib.jimmysong.io/blog/</link>
      <atom:link href="https://lib.jimmysong.io/blog/index.xml" rel="self" type="application/rss+xml" />
    <description>è¯‘æ–‡</description>
    <generator>Wowchemy (https://wowchemy.com)</generator><language>zh</language>
    <image>
      <url>https://lib.jimmysong.io/media/sharing.png</url>
      <title>è¯‘æ–‡</title>
      <link>https://lib.jimmysong.io/blog/</link>
    </image>
    
    <item>
      <title>WebAssemblyï¼šæ— éœ€å®¹å™¨å°±èƒ½è¿è¡Œ Dockerï¼</title>
      <link>https://lib.jimmysong.io/blog/docker-without-containers/</link>
      <pubDate>Thu, 27 Apr 2023 06:27:22 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/docker-without-containers/</guid>
      <description>&lt;p&gt;æœ€è¿‘ï¼ŒDocker å®£å¸ƒä¸ WasmEdge åˆä½œï¼Œåœ¨ Docker ç”Ÿæ€ç³»ç»Ÿä¸­æ”¯æŒ &lt;a href=&#34;https://docs.docker.com/desktop/wasm/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;WebAssembly&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡å°†ä»‹ç»ä»€ä¹ˆæ˜¯ WebAssemblyï¼Œä»¥åŠä¸ºä»€ä¹ˆå®ƒä¸ Docker ç”Ÿæ€ç³»ç»Ÿç›¸å…³ï¼Œå¹¶æä¾›ä¸€äº›å®è·µç¤ºä¾‹ã€‚æˆ‘ä»¬å‡è®¾æ‚¨ç†Ÿæ‚‰ Docker å·¥å…·é›†ã€‚æˆ‘ä»¬å°†ä½¿ç”¨æˆ‘ä»¬çš„ &lt;a href=&#34;https://wasmlabs.dev/articles/php-wasm32-wasi-port/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;WebAssembly PHP çš„ç«¯å£&lt;/a&gt; æ¥æ¼”ç¤ºå¦‚ä½•æ„å»º PHP è§£é‡Šå™¨ï¼Œå°†å…¶æ‰“åŒ…ä¸º OCI é•œåƒçš„ä¸€éƒ¨åˆ†ï¼Œå¹¶ä½¿ç”¨ Docker è¿è¡Œå®ƒã€‚&lt;/p&gt;
&lt;p&gt;è¯·æ³¨æ„ï¼Œæœ¬æ–‡çš„é‡ç‚¹æ˜¯è·å¾—å®è·µç»éªŒï¼Œè€Œä¸æ˜¯è®¨è®ºæŠ€æœ¯ç»†èŠ‚ã€‚æ‚¨å¯ä»¥å¤åˆ¶ä»¥ä¸‹ç¤ºä¾‹ï¼Œä¹Ÿå¯ä»¥åªè¯»åˆ°æœ€åï¼Œå› ä¸ºæˆ‘ä»¬è¿˜å°†æä¾›è¾“å‡ºã€‚&lt;/p&gt;
&lt;h2 id=&#34;webassembly---ä»€ä¹ˆä¸ºä»€ä¹ˆ&#34;&gt;WebAssembly - ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ&lt;/h2&gt;
&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªéå¸¸åŸºæœ¬çš„ä»‹ç»ã€‚å¦‚æœæ‚¨å·²ç»ç†Ÿæ‚‰è¯¥æŠ€æœ¯ï¼Œåˆ™å¯ä»¥è·³åˆ°åŠ¨æ‰‹ç¯èŠ‚ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä»€ä¹ˆæ˜¯-webassembly&#34;&gt;ä»€ä¹ˆæ˜¯ WebAssemblyï¼Ÿ&lt;/h3&gt;
&lt;p&gt;WebAssemblyï¼ˆæˆ– Wasmï¼‰æ˜¯ä¸€ä¸ªå¼€æ”¾æ ‡å‡†ï¼Œå®šä¹‰äº†ä¸€ç§äºŒè¿›åˆ¶æŒ‡ä»¤æ ¼å¼ï¼Œå¯ä»¥ä»ä¸åŒçš„æºè¯­è¨€åˆ›å»ºå¯ç§»æ¤çš„äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/docker-without-containers/1_hu9f2ff678deb0c6bb75e5edef2989001d_8504_7443fbab0b1c3dbf6b3518459e639ea5.webp 400w,
               /blog/docker-without-containers/1_hu9f2ff678deb0c6bb75e5edef2989001d_8504_c3ad77e21a39ed3c4d0c4f35d6a627f0.webp 760w,
               /blog/docker-without-containers/1_hu9f2ff678deb0c6bb75e5edef2989001d_8504_1200x1200_fit_q75_h2_lanczos_2.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/docker-without-containers/1_hu9f2ff678deb0c6bb75e5edef2989001d_8504_7443fbab0b1c3dbf6b3518459e639ea5.webp&#34;
               width=&#34;757&#34;
               height=&#34;181&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;è¿™äº›äºŒè¿›åˆ¶æ–‡ä»¶å¯ä»¥åœ¨å„ç§ç¯å¢ƒä¸­è¿è¡Œã€‚å®ƒèµ·æºäº webï¼Œå¹¶å¾—åˆ°æ‰€æœ‰ä¸»è¦æµè§ˆå™¨çš„æ”¯æŒã€‚&lt;/p&gt;
&lt;h3 id=&#34;wasm-åœ¨æµè§ˆå™¨ä¸­æ˜¯å¦‚ä½•å·¥ä½œçš„&#34;&gt;Wasm åœ¨æµè§ˆå™¨ä¸­æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ&lt;/h3&gt;
&lt;p&gt;æµè§ˆå™¨å¼•æ“é›†æˆäº†ä¸€ä¸ª Wasm è™šæ‹Ÿæœºï¼Œé€šå¸¸ç§°ä¸º Wasm è¿è¡Œæ—¶ï¼Œå®ƒå¯ä»¥è¿è¡Œ Wasm äºŒè¿›åˆ¶æŒ‡ä»¤ã€‚æœ‰ç¼–è¯‘å™¨å·¥å…·é“¾ï¼ˆå¦‚ Emscriptenï¼‰å¯ä»¥å°†æºä»£ç ç¼–è¯‘ä¸º Wasm ç›®æ ‡ã€‚è¿™å…è®¸å°†ä¼ ç»Ÿåº”ç”¨ç¨‹åºç§»æ¤åˆ°æµè§ˆå™¨ï¼Œå¹¶ç›´æ¥ä¸åœ¨å®¢æˆ·ç«¯ Web åº”ç”¨ç¨‹åºä¸­è¿è¡Œçš„ JS ä»£ç é€šä¿¡ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/docker-without-containers/2_hufcd9523e703b2890ed50bf80e0b5cf14_11104_f73936d5271f85b379a4f681382ec832.webp 400w,
               /blog/docker-without-containers/2_hufcd9523e703b2890ed50bf80e0b5cf14_11104_d1465a0108af12ea500f4705188478a2.webp 760w,
               /blog/docker-without-containers/2_hufcd9523e703b2890ed50bf80e0b5cf14_11104_1200x1200_fit_q75_h2_lanczos_2.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/docker-without-containers/2_hufcd9523e703b2890ed50bf80e0b5cf14_11104_f73936d5271f85b379a4f681382ec832.webp&#34;
               width=&#34;757&#34;
               height=&#34;312&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;è¿™äº›æŠ€æœ¯ä½¿ä¼ ç»Ÿæ¡Œé¢åº”ç”¨ç¨‹åºå¯ä»¥åœ¨æµè§ˆå™¨ä¸­è¿è¡Œã€‚ç°åœ¨å®ƒä»¬å¯ä»¥åœ¨ä»»ä½•æ‚¨æ‹¥æœ‰æµè§ˆå™¨çš„è®¾å¤‡ä¸Šè¿è¡Œã€‚ä¸€äº›è‘—åçš„ä¾‹å­æ˜¯ &lt;a href=&#34;https://earth.google.com/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Google Earth&lt;/a&gt; å’Œè®¡ç®—æœºè§†è§‰çš„ &lt;a href=&#34;https://opencv.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Open CV&lt;/a&gt; åº“ã€‚&lt;/p&gt;
&lt;h3 id=&#34;wasm-åœ¨æœåŠ¡å™¨ä¸Šæ˜¯å¦‚ä½•å·¥ä½œçš„&#34;&gt;Wasm åœ¨æœåŠ¡å™¨ä¸Šæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ&lt;/h3&gt;
&lt;p&gt;æœ‰ä¸€äº› Wasm è¿è¡Œæ—¶å¯ä»¥åœ¨æµè§ˆå™¨ä¹‹å¤–è¿è¡Œï¼ŒåŒ…æ‹¬ä¼ ç»Ÿæ“ä½œç³»ç»Ÿï¼Œå¦‚ Linuxã€Windows å’Œ macOSã€‚ç”±äºå®ƒä»¬ä¸èƒ½ä¾èµ–äº JavaScript å¼•æ“çš„å¯ç”¨æ€§ï¼Œå®ƒä»¬ä½¿ç”¨ä¸åŒçš„æ¥å£ï¼ˆä¾‹å¦‚ WASIï¼Œ&lt;a href=&#34;https://wasi.dev/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;WebAssembly ç³»ç»Ÿæ¥å£&lt;/a&gt;ï¼‰ä¸å¤–ç•Œé€šä¿¡ã€‚è¿™äº›è¿è¡Œæ—¶å…è®¸ Wasm åº”ç”¨ç¨‹åºä»¥ä¸ POSIX ç±»ä¼¼ï¼ˆä½†ä¸å®Œå…¨ç›¸åŒï¼‰çš„æ–¹å¼ä¸å…¶ä¸»æœºç³»ç»Ÿäº¤äº’ã€‚åƒ WASI SDK å’Œ wasi-libc è¿™æ ·çš„é¡¹ç›®å¯ä»¥å¸®åŠ©äººä»¬å°†ç°æœ‰çš„ POSIX å…¼å®¹åº”ç”¨ç¨‹åºç¼–è¯‘åˆ° WebAssemblyã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/docker-without-containers/3_hub847a4647ba520c473fa897afead2bca_12792_ef9be3b0ec16df39f23f570fb99a9496.webp 400w,
               /blog/docker-without-containers/3_hub847a4647ba520c473fa897afead2bca_12792_15f421a0d3b29d92aecd27d31b86635c.webp 760w,
               /blog/docker-without-containers/3_hub847a4647ba520c473fa897afead2bca_12792_1200x1200_fit_q75_h2_lanczos_2.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/docker-without-containers/3_hub847a4647ba520c473fa897afead2bca_12792_ef9be3b0ec16df39f23f570fb99a9496.webp&#34;
               width=&#34;757&#34;
               height=&#34;306&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;æ‚¨åªéœ€è¦å°†åº”ç”¨ç¨‹åºç¼–è¯‘ä¸º Wasm æ¨¡å—ä¸€æ¬¡ï¼Œç„¶åå°±å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹è¿è¡Œå®Œå…¨ç›¸åŒçš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä»€ä¹ˆä½¿-wasm-å¦‚æ­¤å‡ºè‰²&#34;&gt;ä»€ä¹ˆä½¿ Wasm å¦‚æ­¤å‡ºè‰²ï¼Ÿ&lt;/h3&gt;
&lt;p&gt;ä¸€äº›ä½¿ Wasm åœ¨æµè§ˆå™¨ä¸­å‡ºè‰²çš„åŠŸèƒ½ä¹Ÿä½¿å…¶å¯¹æœåŠ¡å™¨ç«¯å¼€å‘éå¸¸æœ‰å¸å¼•åŠ›ï¼š&lt;/p&gt;
&lt;p&gt;ğŸŒ å¼€æ”¾ - å®ƒæ˜¯è¡Œä¸šå¹¿æ³›é‡‡ç”¨çš„æ ‡å‡†ã€‚ä¸è¿‡å»çš„æµè§ˆå™¨ä¹‹äº‰ä¸åŒï¼Œä¸»è¦å…¬å¸æ­£åœ¨åä½œæ ‡å‡†åŒ– WASI å’Œ WebAssembly åº”ç”¨ç¨‹åºã€‚&lt;/p&gt;
&lt;p&gt;ğŸš€ å¿«é€Ÿ - å®ƒå¯ä»¥é€šè¿‡å¤§å¤šæ•°è¿è¡Œæ—¶çš„ JIT/AOT èƒ½åŠ›æä¾›ç±»ä¼¼æœ¬æœºçš„é€Ÿåº¦ã€‚ä¸åƒå¯åŠ¨ VM æˆ–å¯åŠ¨å®¹å™¨é‚£æ ·æœ‰å†·å¯åŠ¨ã€‚&lt;/p&gt;
&lt;p&gt;ğŸ”’ å®‰å…¨ - Wasm è¿è¡Œæ—¶é»˜è®¤æƒ…å†µä¸‹æ˜¯éš”ç¦»çš„ï¼Œå¹¶å…è®¸å®‰å…¨åœ°è®¿é—®å†…å­˜ã€‚åŸºäºèƒ½åŠ›çš„æ¨¡å‹ç¡®ä¿ Wasm åº”ç”¨ç¨‹åºä»…èƒ½è®¿é—®å…¶æ˜ç¡®å…è®¸çš„å†…å®¹ã€‚å®‰å…¨çš„ä¾›åº”é“¾ã€‚&lt;/p&gt;
&lt;p&gt;ğŸ’¼ å¯ç§»æ¤ - åœ¨å‡ ä¸ªä¸»è¦è¿è¡Œæ—¶ä¸­ï¼Œæ”¯æŒå¤§å¤šæ•° CPUï¼ˆx86ã€ARMã€RISC-Vï¼‰å’Œå¤§å¤šæ•°æ“ä½œç³»ç»Ÿï¼ŒåŒ…æ‹¬ Linuxã€Windowsã€macOSã€Androidã€ESXiï¼Œç”šè‡³é POSIX çš„æ“ä½œç³»ç»Ÿã€‚&lt;/p&gt;
&lt;p&gt;ğŸ”‹ é«˜æ•ˆ - Wasm åº”ç”¨ç¨‹åºå¯ä»¥é€šè¿‡æœ€å°çš„å†…å­˜å ç”¨å’Œ CPU è¦æ±‚è¿è¡Œã€‚&lt;/p&gt;
&lt;p&gt;ğŸ—£ï¸ å¤šè¯­è¨€æ”¯æŒ - 40 å¤šç§è¯­è¨€å¯ä»¥ç¼–è¯‘ä¸º Wasmï¼Œå¹¶å…·æœ‰ç°ä»£çš„ã€ä¸æ–­æ”¹è¿›çš„å·¥å…·é“¾ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æœåŠ¡å™¨å¹³å°æ¼”è¿›çš„ä¸‹ä¸€æ­¥&#34;&gt;æœåŠ¡å™¨å¹³å°æ¼”è¿›çš„ä¸‹ä¸€æ­¥ï¼Ÿ&lt;/h3&gt;
&lt;p&gt;æ‚¨å¯èƒ½å·²ç»çœ‹åˆ°è¿‡ Docker çš„å…±åŒåˆ›å§‹äººä¹‹ä¸€ Solomon Hykes çš„è¿™æ®µ &lt;a href=&#34;https://twitter.com/solomonstre/status/1111004913222324225&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¼•è¿°&lt;/a&gt;ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å¦‚æœ WASM+WASI åœ¨ 2008 å¹´å­˜åœ¨ï¼Œæˆ‘ä»¬å°±ä¸éœ€è¦åˆ›å»º Docker äº†ã€‚è¿™å°±æ˜¯å®ƒçš„é‡è¦æ€§ã€‚WebAssembly åœ¨æœåŠ¡å™¨ä¸Šæ˜¯è®¡ç®—çš„æœªæ¥ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç¡®å®ï¼ŒWASM+WASI ä¼¼ä¹æ˜¯æœåŠ¡å™¨ç«¯è½¯ä»¶åŸºç¡€æ¶æ„æ¼”è¿›çš„ä¸‹ä¸€æ­¥ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åœ¨è¿‡å»ï¼Œæˆ‘ä»¬æœ‰ç‰©ç†ç¡¬ä»¶å¯ç”¨ã€‚æˆ‘ä»¬ä¼šåœ¨æ¯ä¸ªç›’å­ä¸Šä»”ç»†å®‰è£…æ“ä½œç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºï¼Œå¹¶é€ä¸ªç»´æŠ¤å®ƒä»¬ã€‚&lt;/li&gt;
&lt;li&gt;ç„¶åï¼Œéšç€ç”± VMware å¼€åˆ›çš„ VM çš„é‡‡ç”¨ï¼Œäº‹æƒ…å˜å¾—æ›´å®¹æ˜“äº†ã€‚äººä»¬å¯ä»¥å¤åˆ¶ã€å…‹éš†å’Œç§»åŠ¨ VM è·¨ç¡¬ä»¶ç›’ã€‚ä½†è¿™ä»ç„¶éœ€è¦åœ¨ VM ä¸­å®‰è£…æ“ä½œç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºã€‚&lt;/li&gt;
&lt;li&gt;ç„¶åï¼Œå®¹å™¨å‡ºç°äº†ï¼Œç”± Docker æ¨å¹¿ï¼Œå®ƒä½¿å¾—åœ¨æç®€çš„åŒ…è£…ä¸Šä¸‹æ–‡ä¸­è¿è¡Œåº”ç”¨ç¨‹åºé…ç½®å˜å¾—æ›´åŠ å®¹æ˜“ï¼Œè€Œä¸ä¼šå½±å“ä¸»æœºæ“ä½œç³»ç»Ÿä¸Šçš„ä»»ä½•å…¶ä»–åº”ç”¨ç¨‹åºã€‚ç„¶è€Œï¼Œè¿™ä»ç„¶éœ€è¦åˆ†å‘åº”ç”¨ç¨‹åºä¸å…¶è¿è¡Œæ—¶å’Œå¿…è¦çš„åº“æ†ç»‘åœ¨ä¸€èµ·ã€‚å®‰å…¨è¾¹ç•Œç”± Linux å†…æ ¸æä¾›ã€‚&lt;/li&gt;
&lt;li&gt;æˆ‘ä»¬ç°åœ¨æœ‰äº† WebAssemblyã€‚å®ƒçš„æŠ€æœ¯ç‰¹ç‚¹å’Œå¯ç§»æ¤æ€§ä½¿å¾—åˆ†å‘åº”ç”¨ç¨‹åºå˜å¾—å¯èƒ½ï¼Œæ— éœ€è¿è¾“ OS çº§åˆ«çš„ä¾èµ–é¡¹ï¼Œå¹¶ä¸”å¯ä»¥åœ¨ä¸¥æ ¼çš„å®‰å…¨çº¦æŸä¸‹è¿è¡Œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è€ƒè™‘åˆ°æ‰€æœ‰è¿™äº›ï¼Œå¼€å‘äººå‘˜é€šå¸¸ä¼šå°† WebAssembly è§†ä¸ºå®¹å™¨çš„â€œç»§æ‰¿è€…â€å’ŒåŸºç¡€æ¶æ„éƒ¨ç½²çš„ä¸‹ä¸€ä¸ªé€»è¾‘æ­¥éª¤ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/docker-without-containers/4_hu9788ea4c0c901b7b2eb7d58fbe5dad83_10584_f43c822b68d570a7b5779e3c139e0dae.webp 400w,
               /blog/docker-without-containers/4_hu9788ea4c0c901b7b2eb7d58fbe5dad83_10584_4b074fec995ab7c24c2c089476791611.webp 760w,
               /blog/docker-without-containers/4_hu9788ea4c0c901b7b2eb7d58fbe5dad83_10584_1200x1200_fit_q75_h2_lanczos_2.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/docker-without-containers/4_hu9788ea4c0c901b7b2eb7d58fbe5dad83_10584_f43c822b68d570a7b5779e3c139e0dae.webp&#34;
               width=&#34;757&#34;
               height=&#34;212&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;ç„¶è€Œï¼Œå¦ä¸€ç§çœ‹å¾… WebAssembly çš„æ–¹å¼æ˜¯ä½œä¸º Docker å·¥å…·é“¾çš„æ›¿ä»£â€œåç«¯â€ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ç›¸åŒçš„å‘½ä»¤è¡Œå·¥å…·å’Œå·¥ä½œæµç¨‹ï¼Œä½†æ˜¯ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ Linux å®¹å™¨ï¼Œå®ƒæ˜¯ä½¿ç”¨åŸºäº WebAssembly çš„å®¹å™¨ç­‰ä»·ç‰©å®ç°çš„ã€‚æœ¬æ–‡çš„å…¶ä½™éƒ¨åˆ†æ¢è®¨äº†è¿™ä¸ªæ¦‚å¿µï¼Œè¿™å°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„â€œæ²¡æœ‰å®¹å™¨çš„ Dockerâ€æ ‡é¢˜ã€‚&lt;/p&gt;
&lt;h3 id=&#34;wasm-å¦‚ä½•ä¸-docker-é…åˆä½¿ç”¨&#34;&gt;Wasm å¦‚ä½•ä¸ Docker é…åˆä½¿ç”¨ï¼Ÿ&lt;/h3&gt;
&lt;p&gt;Docker Desktop ç°åœ¨åŒ…æ‹¬å¯¹ WebAssembly çš„æ”¯æŒã€‚å®ƒæ˜¯ä½¿ç”¨ä¸€ä¸ªç§°ä¸º &lt;a href=&#34;https://github.com/WasmEdge/Wasmedge&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;WasmEdge&lt;/a&gt; çš„ Wasm è¿è¡Œæ—¶è¿è¡Œ Wasm åº”ç”¨ç¨‹åºçš„ containerd shim å®ç°çš„ã€‚è¿™æ„å‘³ç€ï¼Œä¸è¿è¡Œå®¹å™¨é•œåƒä¸­çš„äºŒè¿›åˆ¶æ–‡ä»¶çš„å•ç‹¬è¿›ç¨‹ä¸åŒï¼Œæ‚¨ç°åœ¨å¯ä»¥åœ¨ WasmEdge è¿è¡Œæ—¶ä¸­è¿è¡Œ Wasm åº”ç”¨ç¨‹åºï¼Œæ¨¡æ‹Ÿå®¹å™¨ã€‚&lt;/p&gt;
&lt;p&gt;å› æ­¤ï¼Œå®¹å™¨é•œåƒä¸éœ€è¦åŒ…å«æ­£åœ¨è¿è¡Œçš„åº”ç”¨ç¨‹åºçš„ OS æˆ–è¿è¡Œæ—¶ä¸Šä¸‹æ–‡â€”â€”å•ä¸ª Wasm äºŒè¿›åˆ¶æ–‡ä»¶å°±è¶³å¤Ÿäº†ã€‚&lt;/p&gt;
&lt;p&gt;è¿™åœ¨ Docker çš„ &lt;a href=&#34;https://www.docker.com/blog/docker-wasm-technical-preview/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Wasm æŠ€æœ¯é¢„è§ˆæ–‡ç« &lt;/a&gt; ä¸­æœ‰è¯¦ç»†è¯´æ˜ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä»€ä¹ˆæ˜¯-wasmedge&#34;&gt;ä»€ä¹ˆæ˜¯ WasmEdgeï¼Ÿ&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/WasmEdge/Wasmedge&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;WasmEdge&lt;/a&gt; æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„ WebAssembly è¿è¡Œæ—¶ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ˜¯å¼€æºçš„ï¼Œæ˜¯ &lt;a href=&#34;https://cncf.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;CNCF&lt;/a&gt; çš„ä¸€éƒ¨åˆ†ã€‚&lt;/li&gt;
&lt;li&gt;æ”¯æŒæ‰€æœ‰ä¸»è¦çš„ CPU æ¶æ„ï¼ˆx86ã€ARMã€RISC-Vï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;æ”¯æŒæ‰€æœ‰ä¸»è¦çš„æ“ä½œç³»ç»Ÿï¼ˆLinuxã€Windowsã€macOSï¼‰ï¼Œä»¥åŠå…¶ä»–æ“ä½œç³»ç»Ÿï¼Œå¦‚ seL4 RTOSã€Androidã€‚&lt;/li&gt;
&lt;li&gt;ä¸ºäº‘åŸç”Ÿå’Œ Edge åº”ç”¨ç¨‹åºè¿›è¡Œäº†ä¼˜åŒ–ã€‚&lt;/li&gt;
&lt;li&gt;æ˜¯å¯æ‰©å±•çš„ï¼Œæ”¯æŒæ ‡å‡†å’Œæ–°å…´æŠ€æœ¯
&lt;ul&gt;
&lt;li&gt;ä¸ Tensorflowã€OpenVINOã€PyTorch ä¸€èµ·è¿›è¡Œ AI æ¨ç†&lt;/li&gt;
&lt;li&gt;æ”¯æŒä½¿ç”¨ Tokio è¿›è¡Œå¼‚æ­¥ç½‘ç»œã€‚æ”¯æŒå¾®æœåŠ¡ã€æ•°æ®åº“å®¢æˆ·ç«¯ã€æ¶ˆæ¯é˜Ÿåˆ—ç­‰ã€‚&lt;/li&gt;
&lt;li&gt;ä¸å®¹å™¨ç”Ÿæ€ç³»ç»Ÿã€Docker å’Œ Kubernetes å®Œç¾é›†æˆï¼ˆæ­£å¦‚æœ¬æ–‡æ‰€ç¤ºï¼ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;è§£é‡Šæ€§è¯­è¨€å‘¢&#34;&gt;è§£é‡Šæ€§è¯­è¨€å‘¢ï¼Ÿ&lt;/h3&gt;
&lt;p&gt;åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬åªæåˆ°äº†ç¼–è¯‘è¯­è¨€ï¼ˆå¦‚ C å’Œ Rustï¼‰å¯ä»¥é’ˆå¯¹ WebAssemblyã€‚å¯¹äºè§£é‡Šæ€§è¯­è¨€ï¼ˆå¦‚ Pythonã€Ruby å’Œ PHPï¼‰ï¼Œæ–¹æ³•æ˜¯ä¸åŒçš„ï¼šå®ƒä»¬çš„è§£é‡Šå™¨æ˜¯ç”¨ C ç¼–å†™çš„ï¼Œå¯ä»¥ç¼–è¯‘ä¸º WebAssemblyã€‚ç„¶åï¼Œè¿™ä¸ªè§£é‡Šå™¨ç¼–è¯‘ä¸º Wasmï¼Œå¯ä»¥ç”¨äºæ‰§è¡Œæºä»£ç æ–‡ä»¶ï¼Œé€šå¸¸ä»¥ .pyã€.rbã€.php ç­‰ç»“å°¾ã€‚ä¸€æ—¦ç¼–è¯‘ä¸º Wasmï¼Œä»»ä½•å…·æœ‰ Wasm è¿è¡Œæ—¶çš„å¹³å°éƒ½å°†èƒ½å¤Ÿè¿è¡Œé‚£äº›è§£é‡Šæ€§è¯­è¨€ï¼Œå³ä½¿å®é™…çš„è§£é‡Šå™¨ä»æœªåŸç”Ÿåœ°ç¼–è¯‘ä¸ºè¯¥å¹³å°ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/docker-without-containers/5_hu5a9157eb590a188a516bf31fcc5f6574_17576_7f5852950c743a00a2c16df966ee1ae5.webp 400w,
               /blog/docker-without-containers/5_hu5a9157eb590a188a516bf31fcc5f6574_17576_e9524f19de783d7048ab3fdd930fe98c.webp 760w,
               /blog/docker-without-containers/5_hu5a9157eb590a188a516bf31fcc5f6574_17576_1200x1200_fit_q75_h2_lanczos_2.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/docker-without-containers/5_hu5a9157eb590a188a516bf31fcc5f6574_17576_7f5852950c743a00a2c16df966ee1ae5.webp&#34;
               width=&#34;757&#34;
               height=&#34;332&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h2 id=&#34;å®é™…æ¼”ç¤º&#34;&gt;å®é™…æ¼”ç¤º&lt;/h2&gt;
&lt;p&gt;è®©æˆ‘ä»¬å¼€å§‹å§ï¼åœ¨å®é™…æ¼”ç¤ºä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ç¼–è¯‘ä¸º Wasm çš„ PHP è§£é‡Šå™¨ã€‚æˆ‘ä»¬å°†ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ„å»ºä¸€ä¸ª &lt;a href=&#34;https://wasmlabs.dev/articles/docker-without-containers/#building-a-wasm-container&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Wasm å®¹å™¨&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æ¯”è¾ƒ &lt;a href=&#34;https://wasmlabs.dev/articles/docker-without-containers/#native-vs-wasm&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Wasm å’Œæœ¬åœ°&lt;/a&gt; äºŒè¿›åˆ¶æ–‡ä»¶ã€‚&lt;/li&gt;
&lt;li&gt;æ¯”è¾ƒ &lt;a href=&#34;https://wasmlabs.dev/articles/docker-without-containers/#traditional-vs-wasm-containers&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä¼ ç»Ÿå’Œ Wasm&lt;/a&gt; å®¹å™¨ã€‚&lt;/li&gt;
&lt;li&gt;å±•ç¤ºäº† &lt;a href=&#34;https://wasmlabs.dev/articles/docker-without-containers/#wasm-portability&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Wasm çš„å¯ç§»æ¤æ€§&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;å…ˆå†³æ¡ä»¶&#34;&gt;å…ˆå†³æ¡ä»¶&lt;/h2&gt;
&lt;p&gt;å¦‚æœæ‚¨æƒ³åœ¨æœ¬åœ°å¤åˆ¶æ¼”ç¤ºï¼Œæ‚¨éœ€è¦å‡†å¤‡ä¸€äº›æˆ–å…¨éƒ¨ä»¥ä¸‹å†…å®¹çš„ç¯å¢ƒï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;WASI SDK - ä»æ—§ C ä»£ç æ„å»º WebAssembly åº”ç”¨ç¨‹åº&lt;/li&gt;
&lt;li&gt;PHP - ä¸ºäº†è¿›è¡Œæœ¬åœ° PHP äºŒè¿›åˆ¶æ–‡ä»¶æ¯”è¾ƒ&lt;/li&gt;
&lt;li&gt;WasmEdge è¿è¡Œæ—¶ - è¿è¡Œ WebAssembly åº”ç”¨ç¨‹åº&lt;/li&gt;
&lt;li&gt;Docker Desktop + Wasmï¼ˆåœ¨æ’°å†™æœ¬æ–‡æ—¶ï¼Œå¯åœ¨ &lt;a href=&#34;https://docs.docker.com/desktop/release-notes/#4150&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç‰ˆæœ¬ 4.15&lt;/a&gt; ä¸­ç¨³å®šæµ‹è¯•ç‰ˆä¸­ä½¿ç”¨ï¼‰ä»¥èƒ½å¤Ÿè¿è¡Œ Wasm å®¹å™¨&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æˆ‘ä»¬è¿˜åˆ©ç”¨äº†&lt;a href=&#34;https://github.com/vmware-labs/webassembly-language-runtimes&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;â€œWasm è¯­è¨€è¿è¡Œæ—¶â€&lt;/a&gt;å­˜å‚¨åº“ï¼Œè¯¥å­˜å‚¨åº“æä¾›äº†å°† PHP è§£é‡Šå™¨æ„å»ºä¸º WebAssembly åº”ç”¨ç¨‹åºçš„æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;æ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼å¼€å§‹æ£€æŸ¥æ¼”ç¤ºåˆ†æ”¯ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;git clone --depth&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; -b php-wasmedge-demo &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   &amp;lt;https://github.com/vmware-labs/webassembly-language-runtimes.git&amp;gt; wlr-demo
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; wlr-demo
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;æ„å»ºä¸€ä¸ª-wasm-å®¹å™¨&#34;&gt;æ„å»ºä¸€ä¸ª Wasm å®¹å™¨&lt;/h2&gt;
&lt;p&gt;é¦–å…ˆï¼Œæˆ‘ä»¬å°†å±•ç¤ºå¦‚ä½•æ„å»ºä¸€ä¸ªç±»ä¼¼äº PHP è§£é‡Šå™¨çš„åŸºäº C çš„åº”ç”¨ç¨‹åºã€‚&lt;/p&gt;
&lt;p&gt;æ„å»ºè¿‡ç¨‹ä½¿ç”¨ WASI-SDK å·¥å…·é›†ã€‚å®ƒåŒ…æ‹¬ä¸€ä¸ªå¯ä»¥æ„å»ºä¸º wasm32-wasi ç›®æ ‡çš„ clang ç¼–è¯‘å™¨ï¼Œä»¥åŠå®ç°åœ¨ WASI ä¸Šçš„åŸºæœ¬ POSIX ç³»ç»Ÿè°ƒç”¨æ¥å£çš„ wasi-libcã€‚ä½¿ç”¨ WASI SDKï¼Œæˆ‘ä»¬å¯ä»¥ä» PHP çš„ C ä»£ç åº“æ„å»º Wasm æ¨¡å—ã€‚ç„¶åï¼Œæˆ‘ä»¬åªéœ€è¦ä¸€ä¸ªåŸºäº scratch çš„éå¸¸ç®€å•çš„ Dockerfile å°±å¯ä»¥åˆ¶ä½œä¸€ä¸ª OCI é•œåƒï¼Œè¯¥é•œåƒå¯ä»¥ä½¿ç”¨ Docker+Wasm è¿è¡Œã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/docker-without-containers/6_hu09c3c81615d15c15b2c4990eab505366_7474_a770315ff19ee5fff595df258c944f44.webp 400w,
               /blog/docker-without-containers/6_hu09c3c81615d15c15b2c4990eab505366_7474_31643b73bf31a881706d6cab275b27f8.webp 760w,
               /blog/docker-without-containers/6_hu09c3c81615d15c15b2c4990eab505366_7474_1200x1200_fit_q75_h2_lanczos_2.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/docker-without-containers/6_hu09c3c81615d15c15b2c4990eab505366_7474_a770315ff19ee5fff595df258c944f44.webp&#34;
               width=&#34;757&#34;
               height=&#34;212&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h3 id=&#34;æ„å»º-wasm-äºŒè¿›åˆ¶æ–‡ä»¶&#34;&gt;æ„å»º WASM äºŒè¿›åˆ¶æ–‡ä»¶&lt;/h3&gt;
&lt;p&gt;å‡è®¾ä½ åœ¨ &lt;code&gt;wlr-demo&lt;/code&gt; æ–‡ä»¶å¤¹ä¸­ï¼Œä½ å¯ä»¥è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥æ„å»º Wasm äºŒè¿›åˆ¶æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;WASI_SDK_ROOT&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;/opt/wasi-sdk/
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;WASMLABS_RUNTIME&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;wasmedge
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;./wl-make.sh php/php-7.4.32/ &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; tree build-output/php/php-7.4.32/bin/
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;... &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; a few minutes and hundreds of build log lines&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;build-output/php/php-7.4.32/bin/
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;â”œâ”€â”€ php-cgi-wasmedge
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;â””â”€â”€ php-wasmedge
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;PHP æ˜¯ä½¿ç”¨ &lt;em&gt;autoconf&lt;/em&gt; å’Œ &lt;em&gt;make&lt;/em&gt; æ„å»ºçš„ã€‚å› æ­¤ï¼Œå¦‚æœä½ æŸ¥çœ‹ &lt;code&gt;scripts/wl-build.sh&lt;/code&gt; è„šæœ¬ï¼Œä½ ä¼šæ³¨æ„åˆ°æˆ‘ä»¬è®¾ç½®äº†æ‰€æœ‰ç›¸å…³å˜é‡ï¼Œå¦‚ &lt;code&gt;CC&lt;/code&gt;ã€&lt;code&gt;LD&lt;/code&gt;ã€&lt;code&gt;CXX&lt;/code&gt; ç­‰ï¼Œä»¥ä½¿ç”¨æ¥è‡ª WASI_SDK çš„ç¼–è¯‘å™¨ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;WASI_SYSROOT&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;WASI_SDK_ROOT&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;/share/wasi-sysroot&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;CC&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;WASI_SDK_ROOT&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;/bin/clang
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;LD&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;WASI_SDK_ROOT&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;/bin/wasm-ld
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;CXX&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;WASI_SDK_ROOT&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;/bin/clang++
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;NM&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;WASI_SDK_ROOT&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;/bin/llvm-nm
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;AR&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;WASI_SDK_ROOT&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;/bin/llvm-ar
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;RANLIB&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;WASI_SDK_ROOT&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;/bin/llvm-ranlib
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç„¶åï¼Œè¿›ä¸€æ­¥ç ”ç©¶ &lt;code&gt;php/php-7.4.32/wl-build.sh&lt;/code&gt;ï¼Œä½ å¯ä»¥çœ‹åˆ°æˆ‘ä»¬åƒå¾€å¸¸ä¸€æ ·ä½¿ç”¨ &lt;em&gt;autoconf&lt;/em&gt; æ„å»ºè¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;./configure --host&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;wasm32-wasi &lt;span class=&#34;nv&#34;&gt;host_alias&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;wasm32-musl-wasi &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   --target&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;wasm32-wasi &lt;span class=&#34;nv&#34;&gt;target_alias&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;wasm32-musl-wasi &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   &lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;PHP_CONFIGURE&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;||&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;exit&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;...
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;make -j &lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;MAKE_TARGETS&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;||&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;exit&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;WASI è¿˜åœ¨ä¸æ–­å‘å±•ï¼Œè®¸å¤š POSIX è°ƒç”¨ä»ç„¶æ— æ³•åœ¨å…¶ä¸Šå®ç°ã€‚å› æ­¤ï¼Œä¸ºäº†æ„å»º PHPï¼Œæˆ‘ä»¬ä¸å¾—ä¸åœ¨åŸå§‹ä»£ç åº“çš„åŸºç¡€ä¸Šåº”ç”¨å‡ ä¸ªè¡¥ä¸ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬åœ¨ä¸Šé¢çœ‹åˆ°äº†è¾“å‡ºäºŒè¿›åˆ¶æ–‡ä»¶åˆ° &lt;code&gt;build-output/php/php-7.4.32&lt;/code&gt;ã€‚åœ¨æ¥ä¸‹æ¥çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸“é—¨ä¸º WasmEdge æ„å»ºçš„ &lt;code&gt;php-wasmedge&lt;/code&gt; äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå› ä¸ºå®ƒæä¾›äº†æœåŠ¡å™¨ç«¯å¥—æ¥å­—æ”¯æŒï¼Œè¿™è¿˜ä¸æ˜¯ WASI çš„ä¸€éƒ¨åˆ†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä¼˜åŒ–äºŒè¿›åˆ¶æ–‡ä»¶&#34;&gt;ä¼˜åŒ–äºŒè¿›åˆ¶æ–‡ä»¶&lt;/h3&gt;
&lt;p&gt;Wasm æ˜¯ä¸€ç§è™šæ‹ŸæŒ‡ä»¤é›†ï¼Œå› æ­¤ä»»ä½•è¿è¡Œæ—¶çš„é»˜è®¤è¡Œä¸ºéƒ½æ˜¯å®æ—¶è§£é‡Šè¿™äº›æŒ‡ä»¤ã€‚å½“ç„¶ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹è¿™å¯èƒ½ä¼šä½¿äº‹æƒ…å˜æ…¢ã€‚å› æ­¤ï¼Œä¸ºäº†åœ¨ WasmEdge ä¸­è·å¾—æœ€ä½³æ€§èƒ½ï¼Œæ‚¨å¯ä»¥åˆ›å»ºä¸€ä¸ª AOTï¼ˆahead-of-timeï¼‰ä¼˜åŒ–äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åœ¨å½“å‰æœºå™¨ä¸Šæœ¬åœ°è¿è¡Œï¼Œä½†ä»å¯ä»¥åœ¨å…¶ä»–æœºå™¨ä¸Šè§£é‡Šã€‚&lt;/p&gt;
&lt;p&gt;è¦åˆ›å»ºè¯¥ä¼˜åŒ–äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œè¯·è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;wasmedgec --enable-all --optimize &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   build-output/php/php-7.4.32/bin/php-wasmedge &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   build-output/php/php-7.4.32/bin/php-wasmedge-aot
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æˆ‘ä»¬å°†åœ¨ä»¥ä¸‹ç¤ºä¾‹ä¸­ä½¿ç”¨æ­¤ &lt;code&gt;build-output/php/php-7.4.32/bin/php-wasmedge-aot&lt;/code&gt; äºŒè¿›åˆ¶æ–‡ä»¶ã€‚è¦äº†è§£æœ‰å…³ WasmEdge AOT ä¼˜åŒ–äºŒè¿›åˆ¶æ–‡ä»¶çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹ &lt;a href=&#34;https://wasmlabs.dev/articles/docker-without-containers/build-output/php/php-7.4.32/bin/php-wasmedge-aot&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ­¤å¤„&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ„å»º-oci-é•œåƒ&#34;&gt;æ„å»º OCI é•œåƒ&lt;/h3&gt;
&lt;p&gt;ç°åœ¨æˆ‘ä»¬æœ‰äº†äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶åŒ…è£…åœ¨ OCI é•œåƒä¸­ã€‚&lt;/p&gt;
&lt;p&gt;è®©æˆ‘ä»¬æ¥çœ‹çœ‹ &lt;code&gt;images/php/Dockerfile.cli&lt;/code&gt;ã€‚æˆ‘ä»¬åªéœ€è¦å¤åˆ¶ Wasm äºŒè¿›åˆ¶æ–‡ä»¶å¹¶å°†å…¶è®¾ç½®ä¸º &lt;code&gt;ENTRYPOINT&lt;/code&gt; å°±å¯ä»¥äº†ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-dockerfile&#34; data-lang=&#34;dockerfile&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;FROM&lt;/span&gt;&lt;span class=&#34;s&#34;&gt; scratch&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;ARG&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;PHP_TAG&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;php-7.4.32&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;ARG&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;PHP_BINARY&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;php
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;COPY&lt;/span&gt; build-output/php/&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;PHP_TAG&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;/bin/&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;PHP_BINARY&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt; /php.wasm&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;ENTRYPOINT&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;php.wasm&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æˆ‘ä»¬è¿˜å¯ä»¥å‘é•œåƒæ·»åŠ æ›´å¤šå†…å®¹ï¼Œå½“ Wasm äºŒè¿›åˆ¶æ–‡ä»¶åœ¨ Docker ä¸­è¿è¡Œæ—¶ï¼Œè¿™äº›å†…å®¹å°†å¯è®¿é—®ã€‚ä¾‹å¦‚ï¼Œåœ¨ &lt;code&gt;images/php/Dockerfile.server&lt;/code&gt; ä¸­ï¼Œæˆ‘ä»¬è¿˜æ·»åŠ äº†ä¸€äº› docroot å†…å®¹ï¼Œä»¥ä¾¿åœ¨å®¹å™¨å¯åŠ¨æ—¶ç”± &lt;code&gt;php.wasm&lt;/code&gt; æœåŠ¡ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-dockerfile&#34; data-lang=&#34;dockerfile&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;FROM&lt;/span&gt;&lt;span class=&#34;s&#34;&gt; scratch&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;ARG&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;PHP_TAG&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;php-7.4.32&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;ARG&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;PHP_BINARY&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;php
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;COPY&lt;/span&gt; build-output/php/&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;PHP_TAG&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;/bin/&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;PHP_BINARY&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt; /php.wasm&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;COPY&lt;/span&gt; images/php/docroot /docroot&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;ENTRYPOINT&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;php.wasm&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;-S&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;0.0.0.0:8080&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;-t&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;/docroot&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åŸºäºä¸Šè¿°æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾åœ°åœ¨æœ¬åœ°æ„å»ºæˆ‘ä»¬çš„ &lt;code&gt;php-wasm&lt;/code&gt; é•œåƒã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker build --build-arg &lt;span class=&#34;nv&#34;&gt;PHP_BINARY&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;php-wasmedge-aot -t ghcr.io/vmware-labs/php-wasm:7.4.32-cli-aot -f images/php/Dockerfile.cli .
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker build --build-arg &lt;span class=&#34;nv&#34;&gt;PHP_BINARY&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;php-wasmedge-aot -t ghcr.io/vmware-labs/php-wasm:7.4.32-server-aot -f images/php/Dockerfile.server .
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;åŸç”Ÿ-vs-wasm&#34;&gt;åŸç”Ÿ vs Wasm&lt;/h2&gt;
&lt;p&gt;ç°åœ¨è®©æˆ‘ä»¬å°†åŸç”Ÿ PHP äºŒè¿›åˆ¶æ–‡ä»¶ä¸ Wasm äºŒè¿›åˆ¶æ–‡ä»¶è¿›è¡Œæ¯”è¾ƒã€‚åœ¨æœ¬åœ°å’Œ Docker å®¹å™¨ä¸­éƒ½ä½¿ç”¨ç›¸åŒçš„ &lt;code&gt;index.php&lt;/code&gt; æ–‡ä»¶è¿è¡Œå®ƒï¼Œå¹¶æ¯”è¾ƒæˆ‘ä»¬è¿è¡Œå®ƒæ—¶å¾—åˆ°çš„ç»“æœï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;php&lt;/code&gt;,&lt;/li&gt;
&lt;li&gt;&lt;code&gt;php-wasmedge-aot&lt;/code&gt;,&lt;/li&gt;
&lt;li&gt;ä¼ ç»Ÿå®¹å™¨ä¸­çš„ &lt;code&gt;php&lt;/code&gt;,&lt;/li&gt;
&lt;li&gt;Wasm å®¹å™¨ä¸­çš„ &lt;code&gt;php-wasmedge-aot&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/docker-without-containers/7_huf174193c110986bd0ba7a4ddc91dc46e_15602_0537e3890ca0221fc322322dcfdb21fb.webp 400w,
               /blog/docker-without-containers/7_huf174193c110986bd0ba7a4ddc91dc46e_15602_ee61058e8d23d35fa7aa788a8b3d3bc4.webp 760w,
               /blog/docker-without-containers/7_huf174193c110986bd0ba7a4ddc91dc46e_15602_1200x1200_fit_q75_h2_lanczos_2.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/docker-without-containers/7_huf174193c110986bd0ba7a4ddc91dc46e_15602_0537e3890ca0221fc322322dcfdb21fb.webp&#34;
               width=&#34;757&#34;
               height=&#34;326&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;åœ¨ä»¥ä¸‹æ‰€æœ‰ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬éƒ½ä½¿ç”¨ç›¸åŒçš„ &lt;code&gt;images/php/docroot/index.php&lt;/code&gt; æ–‡ä»¶ï¼Œå› æ­¤è®©æˆ‘ä»¬æ¥çœ‹çœ‹ã€‚ç®€è€Œè¨€ä¹‹ï¼Œæ­¤è„šæœ¬å°†ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨ &lt;code&gt;phpversion&lt;/code&gt; å’Œ &lt;code&gt;php_uname&lt;/code&gt; æ˜¾ç¤ºè§£é‡Šå™¨ç‰ˆæœ¬å’Œæ­£åœ¨è¿è¡Œçš„å¹³å°&lt;/li&gt;
&lt;li&gt;æ‰“å°è„šæœ¬å¯ä»¥è®¿é—®çš„æ‰€æœ‰ç¯å¢ƒå˜é‡çš„åç§°&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨å½“å‰æ—¶é—´å’Œæ—¥æœŸæ‰“å°ä¸€ä¸ª hello æ¶ˆæ¯&lt;/li&gt;
&lt;li&gt;åˆ—å‡ºæ ¹ç›®å½• &lt;code&gt;/&lt;/code&gt; çš„å†…å®¹&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-html&#34; data-lang=&#34;html&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;html&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;h1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;Hello from PHP &lt;span class=&#34;cp&#34;&gt;&amp;lt;?php echo phpversion() ?&amp;gt;&lt;/span&gt; running on &amp;#34;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php echo php_uname()?&amp;gt;&lt;/span&gt;&amp;#34;&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;h1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;h2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;List env variable names&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;h2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;$php_env_vars_count = count(getenv());
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;echo &amp;#34;Running with $php_env_vars_count environment variables:\\n&amp;#34;;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;foreach (getenv() as $key =&amp;gt; $value) {
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;    echo  $key . &amp;#34; &amp;#34;;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;echo &amp;#34;\\n&amp;#34;;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;h2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;Hello&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;h2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;$date = getdate();
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;$message = &amp;#34;Today, &amp;#34; . $date[&amp;#39;weekday&amp;#39;] . &amp;#34;, &amp;#34; . $date[&amp;#39;year&amp;#39;] . &amp;#34;-&amp;#34; . $date[&amp;#39;mon&amp;#39;] . &amp;#34;-&amp;#34; . $date[&amp;#39;mday&amp;#39;];
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;$message .= &amp;#34;, at &amp;#34; . $date[&amp;#39;hours&amp;#39;] . &amp;#34;:&amp;#34; . $date[&amp;#39;minutes&amp;#39;] . &amp;#34;:&amp;#34; . $date[&amp;#39;seconds&amp;#39;];
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;$message .= &amp;#34; we greet you with this message!\\n&amp;#34;;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;echo $message;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;h2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;Contents of &amp;#39;/&amp;#39;&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;h2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;&amp;lt;?php
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;foreach (array_diff(scandir(&amp;#39;/&amp;#39;), array(&amp;#39;.&amp;#39;, &amp;#39;..&amp;#39;)) as $key =&amp;gt; $value) {
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;    echo  $value . &amp;#34; &amp;#34;;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;echo &amp;#34;\\n&amp;#34;;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;html&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;åŸç”Ÿè¿è¡Œ-indexphp-çš„-php&#34;&gt;åŸç”Ÿè¿è¡Œ index.php çš„ PHP&lt;/h3&gt;
&lt;p&gt;å½“æˆ‘ä»¬ä½¿ç”¨åŸç”Ÿçš„ &lt;code&gt;php&lt;/code&gt; äºŒè¿›åˆ¶æ–‡ä»¶æ—¶ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åŸºäº Linux çš„å¹³å°&lt;/li&gt;
&lt;li&gt;è„šæœ¬å¯ä»¥è®¿é—®çš„ 58 ä¸ªç¯å¢ƒå˜é‡åˆ—è¡¨ï¼ˆå¦‚æœéœ€è¦çš„è¯ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;code&gt;/&lt;/code&gt; ä¸­æ‰€æœ‰æ–‡ä»¶å’Œæ–‡ä»¶å¤¹çš„åˆ—è¡¨ï¼Œè¿™äº›éƒ½æ˜¯è„šæœ¬å¯ä»¥è®¿é—®çš„&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ php -f images/php/docroot/index.php
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;html&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;body&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;h1&amp;gt;Hello from PHP 7.4.3 running on &lt;span class=&#34;s2&#34;&gt;&amp;#34;Linux alexandrov-z01 5.15.79.1-microsoft-standard-WSL2 #1 SMP Wed Nov 23 01:01:46 UTC 2022 x86_64&amp;#34;&lt;/span&gt;&amp;lt;/h1&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;h2&amp;gt;List env variable names&amp;lt;/h2&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Running with &lt;span class=&#34;m&#34;&gt;58&lt;/span&gt; environment variables:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;SHELL NVM_INC WSL2_GUI_APPS_ENABLED rvm_prefix WSL_DISTRO_NAME TMUX rvm_stored_umask TMUX_PLUGIN_MANAGER_PATH MY_RUBY_HOME NAME RUBY_VERSION PWD NIX_PROFILES LOGNAME rvm_version rvm_user_install_flag MOTD_SHOWN HOME LANG WSL_INTEROP LS_COLORS WASMTIME_HOME WAYLAND_DISPLAY NIX_SSL_CERT_FILE PROMPT_COMMAND NVM_DIR rvm_bin_path GEM_PATH GEM_HOME LESSCLOSE TERM CPLUS_INCLUDE_PATH LESSOPEN USER TMUX_PANE LIBRARY_PATH rvm_loaded_flag DISPLAY SHLVL NVM_CD_FLAGS LD_LIBRARY_PATH XDG_RUNTIME_DIR PS1 WSLENV XDG_DATA_DIRS PATH DBUS_SESSION_BUS_ADDRESS C_INCLUDE_PATH NVM_BIN HOSTTYPE WASMER_CACHE_DIR IRBRC PULSE_SERVER rvm_path WASMER_DIR OLDPWD BASH_FUNC_cr-open%% _
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;h2&amp;gt;Hello&amp;lt;/h2&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Today, Wednesday, 2022-12-14, at 12:0:36 we greet you with this message!
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;h2&amp;gt;Contents of &lt;span class=&#34;s1&#34;&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&amp;lt;/h2&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;apps bin boot dev docroot etc home init lib lib32 lib64 libx32 lost+found media mnt nix opt path proc root run sbin snap srv sys tmp usr var wsl.localhost
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;/body&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;/html&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;php-aot-wasm-è¿è¡Œ-indexphp&#34;&gt;php-aot-wasm è¿è¡Œ index.php&lt;/h3&gt;
&lt;p&gt;å½“æˆ‘ä»¬ä½¿ç”¨&lt;code&gt;php-aot-wasm&lt;/code&gt;ä¸Wasmedgeç»“åˆä½¿ç”¨æ—¶ï¼Œæˆ‘ä»¬å‘ç°&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;wasi/wasm32å¹³å°&lt;/li&gt;
&lt;li&gt;æ²¡æœ‰ç¯å¢ƒå˜é‡ï¼Œå› ä¸ºæ²¡æœ‰å°†ä»»ä½•ç¯å¢ƒå˜é‡æ˜¾å¼æš´éœ²ç»™ Wasm åº”ç”¨ç¨‹åº&lt;/li&gt;
&lt;li&gt;Wasm åº”ç”¨ç¨‹åºæ²¡æœ‰è¢«æ˜ç¡®æˆæƒè®¿é—®&lt;code&gt;/&lt;/code&gt;ï¼Œå› æ­¤å°è¯•åˆ—å‡ºå…¶å†…å®¹æ—¶ä¼šå‡ºç°é”™è¯¯&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å½“ç„¶ï¼Œè¦ä½¿&lt;code&gt;php-wasmedge-aot&lt;/code&gt;å¯ä»¥è®¿é—®è¯»å–&lt;code&gt;index.php&lt;/code&gt;æ–‡ä»¶ï¼Œæˆ‘ä»¬å¿…é¡»æ˜ç¡®è¯´æ˜æˆ‘ä»¬æƒ³è¦é¢„å…ˆæ‰“å¼€&lt;code&gt;images/php/docroot&lt;/code&gt;ä»¥ä¾¿WasmEdgeå¯ä»¥è®¿é—®å®ƒä½œä¸ºWasmåº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡ä¸­çš„&lt;code&gt;/docroot&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¿™å¾ˆå®¹æ˜“æ˜¾ç¤ºäº†Wasmé™¤äº†å¯ç§»æ¤æ€§ä¹‹å¤–çš„æœ€å¤§ä¼˜ç‚¹ä¹‹ä¸€ã€‚æˆ‘ä»¬è·å¾—äº†æ›´å¥½çš„å®‰å…¨æ€§ï¼Œå› ä¸ºé™¤éæ˜ç¡®è¯´æ˜ï¼Œå¦åˆ™æ²¡æœ‰ä»»ä½•å†…å®¹æ˜¯å¯è®¿é—®çš„ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ wasmedge --dir /docroot:&lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;pwd&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;/images/php/docroot &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   build-output/php/php-7.4.32/bin/php-wasmedge-aot -f /docroot/index.php
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;html&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;body&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;h1&amp;gt;Hello from PHP 7.4.32 running on &lt;span class=&#34;s2&#34;&gt;&amp;#34;wasi (none) 0.0.0 0.0.0 wasm32&amp;#34;&lt;/span&gt;&amp;lt;/h1&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;h2&amp;gt;List env variable names&amp;lt;/h2&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Running with &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; environment variables:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;h2&amp;gt;Hello&amp;lt;/h2&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Today, Wednesday, 2022-12-14, at 10:8:46 we greet you with this message!
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;h2&amp;gt;Contents of &lt;span class=&#34;s1&#34;&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&amp;lt;/h2&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Warning: scandir&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;/&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;: failed to open dir: Capabilities insufficient in /docroot/index.php on line &lt;span class=&#34;m&#34;&gt;27&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Warning: scandir&lt;span class=&#34;o&#34;&gt;()&lt;/span&gt;: &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;errno 76&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;: Capabilities insufficient in /docroot/index.php on line &lt;span class=&#34;m&#34;&gt;27&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Warning: array_diff&lt;span class=&#34;o&#34;&gt;()&lt;/span&gt;: Expected parameter &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; to be an array, bool given in /docroot/index.php on line &lt;span class=&#34;m&#34;&gt;27&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Warning: Invalid argument supplied &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; foreach&lt;span class=&#34;o&#34;&gt;()&lt;/span&gt; in /docroot/index.php on line &lt;span class=&#34;m&#34;&gt;27&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;/body&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;/html&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;å®¹å™¨ä¸­è¿è¡Œ-indexphp-çš„-php&#34;&gt;å®¹å™¨ä¸­è¿è¡Œ index.php çš„ PHP&lt;/h3&gt;
&lt;p&gt;å½“æˆ‘ä»¬ä½¿ç”¨ä¼ ç»Ÿå®¹å™¨ä¸­çš„â€œphpâ€æ—¶ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åŸºäºLinuxçš„å¹³å°&lt;/li&gt;
&lt;li&gt;è„šæœ¬å…·æœ‰è®¿é—®æƒé™çš„14ä¸ªç¯å¢ƒå˜é‡åˆ—è¡¨&lt;/li&gt;
&lt;li&gt;å¸¦æœ‰å½“å‰æ—¶é—´å’Œæ—¥æœŸçš„é—®å€™æ¶ˆæ¯&lt;/li&gt;
&lt;li&gt;æ ¹æ–‡ä»¶å¤¹&lt;code&gt;/&lt;/code&gt;çš„å†…å®¹åˆ—è¡¨&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸åœ¨ä¸»æœºä¸Šä½¿ç”¨â€œphpâ€çš„æƒ…å†µç›¸æ¯”ï¼Œè¿™å·²ç»æœ‰æ‰€æ”¹å–„ã€‚ç”±äºç¯å¢ƒå˜é‡å’Œ&lt;code&gt;/&lt;/code&gt;çš„å†…å®¹æ˜¯â€œè™šæ‹Ÿâ€çš„ï¼Œå› æ­¤ä»…å­˜åœ¨äºå®¹å™¨å†…ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker run --rm &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   -v &lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;pwd&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;/images/php/docroot:/docroot &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   php:7.4.32-cli &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   php -f /docroot/index.php
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;html&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;body&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;h1&amp;gt;Hello from PHP 7.4.32 running on &lt;span class=&#34;s2&#34;&gt;&amp;#34;Linux 227b2bc2f611 5.15.79.1-microsoft-standard-WSL2 #1 SMP Wed Nov 23 01:01:46 UTC 2022 x86_64&amp;#34;&lt;/span&gt;&amp;lt;/h1&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;h2&amp;gt;List env variable names&amp;lt;/h2&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Running with &lt;span class=&#34;m&#34;&gt;14&lt;/span&gt; environment variables:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;HOSTNAME PHP_INI_DIR HOME PHP_LDFLAGS PHP_CFLAGS PHP_VERSION GPG_KEYS PHP_CPPFLAGS PHP_ASC_URL PHP_URL PATH PHPIZE_DEPS PWD PHP_SHA256
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;h2&amp;gt;Hello&amp;lt;/h2&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Today, Wednesday, 2022-12-14, at 10:15:35 we greet you with this message!
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;h2&amp;gt;Contents of &lt;span class=&#34;s1&#34;&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&amp;lt;/h2&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;bin boot dev docroot etc home lib lib64 media mnt opt proc root run sbin srv sys tmp usr var
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;/body&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;/html&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;å®¹å™¨ä¸­è¿è¡Œ-indexphp-çš„-php-aot-wasm&#34;&gt;å®¹å™¨ä¸­è¿è¡Œ index.php çš„ php-aot-wasm&lt;/h3&gt;
&lt;p&gt;å½“æˆ‘ä»¬ä½¿ç”¨&lt;code&gt;php-aot-wasm&lt;/code&gt;ä¸Wasmedgeç»“åˆä½¿ç”¨æ—¶ï¼Œæˆ‘ä»¬å‘ç°&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;wasi / wasm32å¹³å°&lt;/li&gt;
&lt;li&gt;åªæœ‰2ä¸ªåŸºç¡€æ¶æ„ç¯å¢ƒå˜é‡ï¼Œä½¿ç”¨è¿è¡Œåœ¨containerdä¸­çš„WasmEdge shimé¢„è®¾&lt;/li&gt;
&lt;li&gt;æ˜¾ç¤ºäº†å®¹å™¨ä¸­&lt;code&gt;/&lt;/code&gt;ä¸­çš„æ‰€æœ‰æ–‡ä»¶å’Œæ–‡ä»¶å¤¹çš„åˆ—è¡¨ï¼Œè¿™æ˜¯Wasmåº”ç”¨ç¨‹åºæ˜ç¡®é¢„å…ˆæ‰“å¼€ä»¥ä¾¿è®¿é—®çš„ï¼ˆWasmEdge shimä¸­çš„é€»è¾‘çš„ä¸€éƒ¨åˆ†ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ³¨æ„ï¼šå¦‚æœæ‚¨æ›´åŠ ç»†å¿ƒï¼Œæ‚¨å°†ä¼šçœ‹åˆ°ä¸ºäº†ä»æ­¤é•œåƒè¿è¡Œå®¹å™¨ï¼Œæˆ‘ä»¬å¿…é¡»ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é€šè¿‡&lt;code&gt;runtime=io.containerd.wasmedge.v1&lt;/code&gt;æ˜ç¡®åœ°æŒ‡å®šè¿è¡Œæ—¶&lt;/li&gt;
&lt;li&gt;ç›´æ¥ä¼ é€’å‘½ä»¤è¡Œå‚æ•°åˆ°&lt;code&gt;php.wasm&lt;/code&gt;ï¼Œè€Œä¸åŒ…æ‹¬äºŒè¿›åˆ¶æ–‡ä»¶æœ¬èº«ã€‚å‘ä¸Šæ»šåŠ¨å¹¶æŸ¥çœ‹ä¼ ç»ŸPHPå®¹å™¨ï¼ŒåŒ…æ‹¬&lt;code&gt;php&lt;/code&gt;äºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆå¹¶ä¸æ˜¯å¿…è¦çš„ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æœ€åï¼Œå³ä½¿æ˜¯åœ¨Dockerä¸­ï¼ŒWasmä¹ŸåŠ å¼ºäº†è¿è¡Œindex.phpçš„å®‰å…¨æ€§ï¼Œå› ä¸ºæš´éœ²ç»™å®ƒçš„ä¸œè¥¿è¦å°‘å¾—å¤šã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker run --rm &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   --runtime&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;io.containerd.wasmedge.v1 &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   -v &lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;pwd&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;/images/php/docroot:/docroot &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   ghcr.io/vmware-labs/php-wasm:7.4.32-cli-aot &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   -f /docroot/index.php
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;html&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;body&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;h1&amp;gt;Hello from PHP 7.4.32 running on &lt;span class=&#34;s2&#34;&gt;&amp;#34;wasi (none) 0.0.0 0.0.0 wasm32&amp;#34;&lt;/span&gt;&amp;lt;/h1&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;h2&amp;gt;List env variable names&amp;lt;/h2&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Running with &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; environment variables:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;PATH HOSTNAME
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;h2&amp;gt;Hello&amp;lt;/h2&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Today, Wednesday, 2022-12-14, at 11:33:10 we greet you with this message!
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;h2&amp;gt;Contents of &lt;span class=&#34;s1&#34;&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&amp;lt;/h2&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docroot etc php.wasm
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;/body&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;/html&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;ä¼ ç»Ÿå®¹å™¨ä¸wasmå®¹å™¨&#34;&gt;ä¼ ç»Ÿå®¹å™¨ä¸wasmå®¹å™¨&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬æˆåŠŸåœ°æ„å»ºå’Œè¿è¡Œäº†ä¸€ä¸ªWasmäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¹¶å°†å…¶ä½œä¸ºå®¹å™¨è¿è¡Œã€‚æˆ‘ä»¬çœ‹åˆ°äº†Wasmå®¹å™¨å’Œä¼ ç»Ÿå®¹å™¨ä¹‹é—´çš„è¾“å‡ºå·®å¼‚ä»¥åŠWasmå¸¦æ¥çš„é«˜çº§â€œæ²™ç›’â€æ€§èƒ½ã€‚è®©æˆ‘ä»¬çœ‹çœ‹æˆ‘ä»¬å¯ä»¥è½»æ¾çœ‹åˆ°çš„ä¸¤ç§å®¹å™¨ç±»å‹ä¹‹é—´çš„å…¶ä»–å·®å¼‚ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆï¼Œæˆ‘ä»¬å°†è¿è¡Œä¸¤ä¸ªå®ˆæŠ¤ç¨‹åºå®¹å™¨ï¼Œå¹¶æŸ¥çœ‹å¦‚ä½•è§£é‡Šæœ‰å…³å®ƒä»¬çš„ä¸€äº›ç»Ÿè®¡ä¿¡æ¯ã€‚ç„¶åï¼Œæˆ‘ä»¬å°†æ£€æŸ¥å®¹å™¨é•œåƒä¸­çš„å·®å¼‚ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/docker-without-containers/8_hua853562afea5ac88706362ca3bdf32f6_18506_f23dfaa3d922c2d1dab5e70606f287d5.webp 400w,
               /blog/docker-without-containers/8_hua853562afea5ac88706362ca3bdf32f6_18506_98aca8d6a0624071b11809e6800b3ca9.webp 760w,
               /blog/docker-without-containers/8_hua853562afea5ac88706362ca3bdf32f6_18506_1200x1200_fit_q75_h2_lanczos_2.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/docker-without-containers/8_hua853562afea5ac88706362ca3bdf32f6_18506_f23dfaa3d922c2d1dab5e70606f287d5.webp&#34;
               width=&#34;757&#34;
               height=&#34;465&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h3 id=&#34;å®¹å™¨ç»Ÿè®¡&#34;&gt;å®¹å™¨ç»Ÿè®¡&lt;/h3&gt;
&lt;p&gt;æˆ‘ä»¬å°†è¿è¡Œä¸¤ä¸ªå®ˆæŠ¤ç¨‹åºå®¹å™¨-ä¸€ä¸ªæ¥è‡ªä¼ ç»Ÿçš„&lt;code&gt;php&lt;/code&gt;é•œåƒï¼Œå¦ä¸€ä¸ªæ¥è‡ª&lt;code&gt;php-wasm&lt;/code&gt;é•œåƒã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker run --rm -d &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   -p 8083:8080 -v &lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;pwd&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;/images/php/docroot:/docroot &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   php:7.4.32-cli &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   -S 0.0.0.0:8080 -t /docroot
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker run --rm -d &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   --runtime&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;io.containerd.wasmedge.v1 &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   -p 8082:8080 -v &lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;pwd&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;/images/php/docroot:/docroot &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   ghcr.io/vmware-labs/php-wasm:7.4.32-cli-aot
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   -S 0.0.0.0:8080 -t /docroot
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬æŸ¥çœ‹&lt;code&gt;docker stats&lt;/code&gt;ï¼Œæˆ‘ä»¬å°†åªçœ‹åˆ°ä¼ ç»Ÿå®¹å™¨çš„ç»Ÿè®¡ä¿¡æ¯ã€‚ç”±äºDocker+Wasmæ˜¯betaåŠŸèƒ½ï¼Œè¿™å¯èƒ½ä¼šå‘ç”Ÿå˜åŒ–ã€‚å› æ­¤ï¼Œå¦‚æœæƒ³è¦æŸ¥çœ‹æ­£åœ¨å‘ç”Ÿçš„æƒ…å†µï¼Œå¯ä»¥ç›‘è§†æ§åˆ¶ç»„ã€‚æ¯ä¸ªä¼ ç»Ÿå®¹å™¨éƒ½æœ‰è‡ªå·±çš„æ§åˆ¶ç»„ï¼Œå¦‚&lt;code&gt;docker/ee44...&lt;/code&gt;æ‰€ç¤ºã€‚å¦ä¸€æ–¹é¢ï¼ŒWasmå®¹å™¨åŒ…å«åœ¨&lt;code&gt;podruntime/docker&lt;/code&gt;æ§åˆ¶ç»„ä¸­ï¼Œæ‚¨å¯ä»¥é—´æ¥è§‚å¯Ÿå®ƒä»¬çš„CPUæˆ–å†…å­˜æ¶ˆè€—ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ systemd-cgtop -kP --depth&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;10&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Control Group           Tasks    %CPU     Memory
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;podruntime              &lt;span class=&#34;m&#34;&gt;145&lt;/span&gt;      0.1      636.3M
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;podruntime/docker       &lt;span class=&#34;m&#34;&gt;145&lt;/span&gt;      0.1      636.3M
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker                  &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;        0.0      39.7M
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker/ee444b...        &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;        0.0      6.7M
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;é•œåƒå¤§å°&#34;&gt;é•œåƒå¤§å°&lt;/h3&gt;
&lt;p&gt;é¦–å…ˆï¼Œæ¢ç´¢é•œåƒæ—¶ï¼Œæˆ‘ä»¬ä¼šå‘ç°Wasmå®¹å™¨é•œåƒæ¯”ä¼ ç»Ÿå®¹å™¨é•œåƒå°å¾—å¤šã€‚å³ä½¿æ˜¯â€œphpâ€å®¹å™¨çš„&lt;code&gt;alpine&lt;/code&gt;ç‰ˆæœ¬ä¹Ÿæ¯”Wasmå®¹å™¨å¤§ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ docker images
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;REPOSITORY                     TAG                 IMAGE ID       CREATED          SIZE
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;php                            7.4.32-cli          680c4ba36f1b   &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; hours ago      166MB
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;php                            7.4.32-cli-alpine   a785f7973660   &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; minutes ago    30.1MB
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ghcr.io/vmware-labs/php-wasm   7.4.32-cli-aot      63460740f6d5   &lt;span class=&#34;m&#34;&gt;44&lt;/span&gt; minutes ago   5.35MB
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™æ˜¯å› ä¸ºä½¿ç”¨ Wasm æ—¶ï¼Œæˆ‘ä»¬åªéœ€è¦å°†å¯æ‰§è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶æ”¾å…¥å®¹å™¨ä¸­ï¼Œè€Œä¼ ç»Ÿå®¹å™¨è¿˜éœ€è¦ä¸€äº›æ¥è‡ªæ“ä½œç³»ç»Ÿçš„åŸºæœ¬åº“å’Œæ–‡ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ç§å¤§å°ä¸Šçš„å·®å¼‚å¯¹ç¬¬ä¸€æ¬¡æ‹‰å–é•œåƒçš„é€Ÿåº¦ä»¥åŠé•œåƒåœ¨æœ¬åœ°ä»“åº“ä¸­æ‰€å ç”¨çš„ç©ºé—´éƒ½æœ‰å¾ˆå¤§çš„ç›Šå¤„ã€‚&lt;/p&gt;
&lt;h2 id=&#34;wasm-çš„å¯ç§»æ¤æ€§&#34;&gt;Wasm çš„å¯ç§»æ¤æ€§&lt;/h2&gt;
&lt;p&gt;Wasm æœ€å¥½çš„ä¸€ç‚¹å°±æ˜¯å¯ç§»æ¤æ€§ã€‚å½“æˆ‘ä»¬æƒ³è¦ä¸€ä¸ªå¯ç§»æ¤çš„åº”ç”¨ç¨‹åºæ—¶ï¼ŒDocker å·²ç»æˆä¸ºäº†ä¼ ç»Ÿå®¹å™¨çš„é¦–é€‰ã€‚ç„¶è€Œï¼Œé™¤äº†é•œåƒå¤§å°ä¹‹å¤–ï¼Œä¼ ç»Ÿå®¹å™¨è¿˜ç»‘å®šåœ¨å®ƒä»¬è¿è¡Œçš„å¹³å°çš„æ¶æ„ä¸Šã€‚æˆ‘ä»¬ä¸­çš„è®¸å¤šäººéƒ½ç»å†è¿‡ä¸ºæ”¯æŒä¸åŒæ¶æ„æ„å»ºè½¯ä»¶çš„ç‰ˆæœ¬å¹¶å°†å…¶æ‰“åŒ…åˆ°æ¯ä¸ªæ¶æ„çš„ä¸åŒé•œåƒä¸­çš„èµ·ä¼ã€‚&lt;/p&gt;
&lt;p&gt;WebAssembly å¸¦æ¥äº†çœŸæ­£çš„å¯ç§»æ¤æ€§ã€‚æ‚¨å¯ä»¥ç¼–è¯‘ä¸€æ¬¡äºŒè¿›åˆ¶æ–‡ä»¶å¹¶åœ¨ä»»ä½•åœ°æ–¹è¿è¡Œå®ƒã€‚ä¸ºäº†è¯æ˜è¿™ç§å¯ç§»æ¤æ€§ï¼Œæˆ‘ä»¬å‡†å¤‡äº†å‡ ä¸ªç¤ºä¾‹ï¼Œæ¼”ç¤ºäº†å¦‚ä½•é€šè¿‡æˆ‘ä»¬ä¸º WebAssembly æ„å»ºçš„ PHP è§£é‡Šå™¨è¿è¡Œ WordPressã€‚&lt;/p&gt;
&lt;p&gt;å½“å®ƒä»¥ç‹¬ç«‹çš„ Wasm åº”ç”¨ç¨‹åºè¿è¡Œæ—¶ï¼ŒPHP å°†ä¸º WordPress æä¾›æœåŠ¡ã€‚åŒæ ·åœ°ï¼Œå®ƒä¹Ÿå¯ä»¥åœ¨ Docker+Wasm å®¹å™¨ä¸­è¿è¡Œã€‚å®ƒè¿˜å¯ä»¥åœ¨åµŒå…¥ Wasm è¿è¡Œæ—¶çš„ä»»ä½•åº”ç”¨ç¨‹åºä¸­è¿è¡Œã€‚åœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼Œè¿™æ˜¯ apache httpdï¼Œå®ƒé€šè¿‡ mod_wasm å¯ä»¥å°† Wasm åº”ç”¨ç¨‹åºç”¨ä½œå†…å®¹å¤„ç†ç¨‹åºã€‚æœ€åï¼ŒPHP.wasm ä¹Ÿå¯ä»¥åœ¨æµè§ˆå™¨ä¸­è¿è¡Œã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/docker-without-containers/9_huccfef052a73a2282fb41a9c8da0ded43_16880_012759d24c78f85dcb3ca47051f55c95.webp 400w,
               /blog/docker-without-containers/9_huccfef052a73a2282fb41a9c8da0ded43_16880_1118ab866415ad1a44cd869277461e8c.webp 760w,
               /blog/docker-without-containers/9_huccfef052a73a2282fb41a9c8da0ded43_16880_1200x1200_fit_q75_h2_lanczos_2.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/docker-without-containers/9_huccfef052a73a2282fb41a9c8da0ded43_16880_012759d24c78f85dcb3ca47051f55c95.webp&#34;
               width=&#34;757&#34;
               height=&#34;308&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h3 id=&#34;é€šè¿‡-wasmedge-æä¾›-wordpress&#34;&gt;é€šè¿‡ WasmEdge æä¾› WordPress&lt;/h3&gt;
&lt;p&gt;æˆ‘ä»¬ä¸ºæ­¤æ¼”ç¤ºå‡†å¤‡äº†ä¸€ä¸ªç´§å‡‘çš„ WordPress+Sqlite ç¤ºä¾‹ã€‚ç”±äºå®ƒæ˜¯ &lt;code&gt;ghcr.io/vmware-labs/php-wasm:7.4.32-server-wordpress&lt;/code&gt; å®¹å™¨æ˜ åƒçš„ä¸€éƒ¨åˆ†ï¼Œå› æ­¤è®©æˆ‘ä»¬é¦–å…ˆå°†å…¶ä¸‹è½½åˆ°æœ¬åœ°ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ¡å‘½ä»¤åªä¼šåˆ›å»ºä¸€ä¸ªä¸´æ—¶å®¹å™¨ï¼ˆæ‹‰å–é•œåƒï¼‰ï¼Œå°† WordPress æ–‡ä»¶å¤åˆ¶åˆ° &lt;code&gt;/tmp/wp/docroot&lt;/code&gt; ä¸­ï¼Œç„¶ååˆ é™¤å®¹å™¨ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;container_id&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;docker create ghcr.io/vmware-labs/php-wasm:7.4.32-server-wordpress&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   mkdir /tmp/wp &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   docker cp &lt;span class=&#34;nv&#34;&gt;$container_id&lt;/span&gt;:/docroot /tmp/wp/ &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   docker rm &lt;span class=&#34;nv&#34;&gt;$container_id&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç°åœ¨æˆ‘ä»¬æœ‰äº† WordPressï¼Œè®©æˆ‘ä»¬ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æä¾›æœåŠ¡ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;wasmedge --dir /docroot:/tmp/wp/docroot &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   build-output/php/php-7.4.32/bin/php-wasmedge-aot &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   -S 0.0.0.0:8085 -t /docroot
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ‚¨å¯ä»¥è½¬åˆ° &lt;a href=&#34;http://localhost:8085/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;http://localhost:8085&lt;/a&gt; å¹¶äº«å—ç”± PHP Wasm è§£é‡Šå™¨æä¾›çš„ WordPressã€‚&lt;/p&gt;
&lt;h3 id=&#34;é€šè¿‡-dockerwasm-æä¾›-wordpress&#34;&gt;é€šè¿‡ Docker+Wasm æä¾› WordPress&lt;/h3&gt;
&lt;p&gt;å½“ç„¶ï¼Œä½¿ç”¨ Dockerï¼Œäº‹æƒ…è¦ç®€å•å¾—å¤šã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker run --rm --runtime&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;io.containerd.wasmedge.v1 &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   -p 8086:8080 -v /tmp/wp/docroot/:/docroot/ &lt;span class=&#34;se&#34;&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   ghcr.io/vmware-labs/php-wasm:7.4.32-cli-aot
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   -S 0.0.0.0:8080 -t /docroot
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ‚¨å¯ä»¥è½¬åˆ° &lt;a href=&#34;http://localhost:8086/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;http://localhost:8086&lt;/a&gt; å¹¶äº«å—ç”± PHP Wasm è§£é‡Šå™¨æä¾›çš„ WordPressï¼Œè¿™ä¸€æ¬¡å®ƒåœ¨ Docker å®¹å™¨ä¸­è¿è¡Œã€‚&lt;/p&gt;
&lt;h3 id=&#34;é€šè¿‡-apache-httpd-ä¸­çš„-mod_wasm-æä¾›-wordpress&#34;&gt;é€šè¿‡ Apache HTTPD ä¸­çš„ mod_wasm æä¾› WordPress&lt;/h3&gt;
&lt;p&gt;Apache HTTPD æ˜¯æœ€å¹¿æ³›ä½¿ç”¨çš„ HTTP æœåŠ¡å™¨ä¹‹ä¸€ã€‚ç°åœ¨ï¼Œé€šè¿‡ mod_wasmï¼Œå®ƒä¹Ÿå¯ä»¥è¿è¡Œ WebAssembly åº”ç”¨ç¨‹åºã€‚ä¸ºäº†é¿å…åœ¨æœ¬åœ°å®‰è£…å’Œé…ç½®å®ƒï¼Œæˆ‘ä»¬å‡†å¤‡äº†ä¸€ä¸ªå®¹å™¨ï¼Œå…¶ä¸­åŒ…å« Apache HTTPDã€mod_wasm å’Œ WordPressã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker run -p 8087:8080 projects.registry.vmware.com/wasmlabs/containers/php-mod-wasm:wordpress
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ‚¨å¯ä»¥è½¬åˆ° &lt;a href=&#34;http://localhost:8087/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;http://localhost:8087&lt;/a&gt; å¹¶äº«å—ç”± Apache HTTPD ä¸­åŠ è½½çš„ mod_wasm æä¾›çš„ PHP Wasm è§£é‡Šå™¨æä¾›çš„ WordPressã€‚&lt;/p&gt;
&lt;h3 id=&#34;ç›´æ¥åœ¨æµè§ˆå™¨ä¸­æä¾›-wordpress&#34;&gt;ç›´æ¥åœ¨æµè§ˆå™¨ä¸­æä¾› WordPress&lt;/h3&gt;
&lt;p&gt;åªéœ€è½¬åˆ° [&lt;a href=&#34;https://wordpress.wasmlabs.dev/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://wordpress.wasmlabs.dev&lt;/a&gt;] æŸ¥çœ‹ç¤ºä¾‹ã€‚æ‚¨å°†çœ‹åˆ°ä¸€ä¸ªæ¡†æ¶ï¼Œå…¶ä¸­ PHP Wasm è§£é‡Šå™¨æ­£åœ¨ç°åœºæ¸²æŸ“ WordPressã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç»“è®º&#34;&gt;ç»“è®º&lt;/h2&gt;
&lt;p&gt;æ„Ÿè°¢æ‚¨é˜…è¯»æœ¬æ–‡ã€‚è¿™æ˜¯å¾ˆå¤šå†…å®¹è¦æ¶ˆåŒ–ï¼Œä½†æˆ‘ä»¬å¸Œæœ›å®ƒæœ‰åŠ©äºäº†è§£ WebAssembly çš„åŠŸèƒ½ä»¥åŠå®ƒå¦‚ä½•ä¸æ‚¨ç°æœ‰çš„ä»£ç åº“å’Œå·¥å…·ï¼ˆåŒ…æ‹¬ Dockerï¼‰ä¸€èµ·ä½¿ç”¨ã€‚æœŸå¾…çœ‹åˆ°æ‚¨ä½¿ç”¨ Wasm æ„å»ºçš„å†…å®¹ï¼&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>ç”¨Dockerå’ŒWebAssemblyæ‰“é€ å®¹å™¨çš„æ–°æ—¶ä»£ï¼</title>
      <link>https://lib.jimmysong.io/blog/docker-wasm-quick-intro/</link>
      <pubDate>Mon, 17 Apr 2023 10:27:22 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/docker-wasm-quick-intro/</guid>
      <description>&lt;blockquote&gt;
&lt;p&gt;è¯‘è€…æ³¨ï¼šæœ¬æ–‡è¯‘è‡ª &lt;a href=&#34;https://medium.com/@guglielmino/docker-webassembly-a-quick-intro-730c38e8390c&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Docker + WebAssembly: a quick intro | by Fabrizio Guglielmino | Medium&lt;/a&gt;ï¼Œæœ¬æ–‡ä»‹ç»äº†ä½¿ç”¨ Docker å’Œ WebAssembly åˆ›å»ºå®¹å™¨çš„è¿‡ç¨‹ã€‚é€šè¿‡æ¯”è¾ƒæ ‡å‡† Docker å®¹å™¨å’Œ WebAssembly å®¹å™¨ï¼Œä½œè€…æŒ‡å‡º WebAssembly å®¹å™¨å…·æœ‰æ€§èƒ½ä¼˜åŠ¿ã€æ¶æ„ä¸­ç«‹ç­‰ä¼˜ç‚¹ï¼Œä½†ä¹Ÿå­˜åœ¨ä¸æˆç†Ÿçš„é—®é¢˜ã€‚WebAssembly å®¹å™¨æœ‰æœ›å½»åº•æ”¹å˜å®¹å™¨åŒ–åº”ç”¨ç¨‹åºçš„æ–¹å¼ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä»Šå¤©ï¼Œæˆ‘æƒ³å±•ç¤ºä¸€ç§å®ç”¨ä¸”æœ‰è¶£çš„ä½¿ç”¨ Docker çš„æ–¹å¼ï¼šåœ¨å®¹å™¨ä¸­ä½¿ç”¨ WebAssemblyã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘è¯´ â€œå®ç”¨çš„æ–¹å¼â€ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘å‡è®¾æ‚¨æœ‰ä¸€äº›ç»éªŒï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Dockerï¼ˆå½“ç„¶ï¼‰&lt;/li&gt;
&lt;li&gt;Rustï¼ˆå®é™…ä¸Šï¼Œåªæ˜¯ä¸ºäº†ç†è§£ â€œHello Worldâ€ï¼‰&lt;/li&gt;
&lt;li&gt;WebAssemblyï¼›åªéœ€è¦å¯¹å…¶æœ‰ä¸€ä¸ªåŸºæœ¬çš„äº†è§£ï¼ˆæ³¨æ„ï¼šæˆ‘å°†åœ¨è®¨è®ºä¸­äº¤æ›¿ä½¿ç”¨ WASM å’Œ WebAssembly è¿™ä¸¤ä¸ªæœ¯è¯­ï¼‰&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å…³äºæˆ‘å³å°†å±•ç¤ºçš„å†…å®¹ï¼Œç®€å•è¯´ä¸€ä¸‹ï¼šä¸€ä¸ª Docker å®¹å™¨æ˜¯ä¸€ä¸ªåŒ…å«è¿è¡Œç¯å¢ƒçš„æ˜ åƒçš„è¿è¡Œå®ä¾‹ã€‚è¿è¡Œç¯å¢ƒé€šå¸¸æ˜¯ä¸€ä¸ªæ“ä½œç³»ç»Ÿï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹æ˜¯ Linuxã€‚æ“ä½œç³»ç»Ÿæ˜¯è¿è¡Œåº”ç”¨ç¨‹åºçš„å¿…è¦æ¡ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæˆ‘ä»¬èƒ½å¤Ÿåœ¨æœ€å°åŒ–ä¾èµ–å…³ç³»çš„æƒ…å†µä¸‹è¿è¡Œåº”ç”¨ç¨‹åºï¼Œç”šè‡³ä¸éœ€è¦ä»»ä½•ä¾èµ–å…³ç³»ï¼Œä¼šæ€æ ·å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;è¿™å°±æ˜¯æˆ‘æƒ³è°ˆè®ºçš„æƒ³æ³•ï¼šä½¿ç”¨ WASMï¼Œä»¥åŠ Docker ä¸­ï¼ˆç›®å‰æµ‹è¯•ç‰ˆï¼‰çš„æ”¯æŒï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªä¸å«ä»»ä½•æ“ä½œç³»ç»ŸåŸºç¡€é•œåƒçš„å®¹å™¨ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä¸ºä»€ä¹ˆæ˜¯-webassembly-å®¹å™¨&#34;&gt;ä¸ºä»€ä¹ˆæ˜¯ WebAssembly å®¹å™¨ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;å¼•ç”¨ Docker çš„ä½œè€… Solomon Hykes çš„è¯ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;â€œå¦‚æœ WASM+WASI åœ¨ 2008 å¹´å°±å­˜åœ¨äº†ï¼Œæˆ‘ä»¬å°±ä¸éœ€è¦åˆ›é€  Docker äº†ã€‚â€&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿™å¯èƒ½è¶³å¤Ÿäº†ï¼Œä½†è®©æˆ‘ä»¬åˆ—ä¸¾ä¸€äº›å…·ä½“çš„å¥½å¤„ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å®‰å…¨æ€§&lt;/strong&gt;ï¼šä»…éƒ¨ç½²æˆ‘ä»¬çš„ä»£ç å¯ä»¥å‡å°‘ â€œæ”»å‡»é¢â€ï¼Œä»è€Œæé«˜æ•´ä½“å®‰å…¨æ€§&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¤§å°&lt;/strong&gt;ï¼šæˆ‘ä»¬å¯ä»¥åˆ›å»ºæ¯”ç­‰æ•ˆäºå¸¦æœ‰æ“ä½œç³»ç»Ÿçš„åº”ç”¨ç¨‹åºæ›´å°å¾—å¤šçš„å®¹å™¨&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§èƒ½&lt;/strong&gt;ï¼šå¦‚æ‚¨æ‰€æ–™ï¼Œæ²¡æœ‰æ“ä½œç³»ç»Ÿå±‚ï¼ŒWASM å®¹å™¨å¯ä»¥è¡¨ç°å‡ºæ›´å¥½çš„æ€§èƒ½ï¼ˆä¸æ€»æ˜¯æ­£ç¡®çš„ï¼Œä½†å¹³å‡è€Œè¨€æ˜¯æ­£ç¡®çš„ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ¶æ„ä¸­ç«‹æ€§&lt;/strong&gt;ï¼šDocker å®¹å™¨æ˜¯ä¸ºç‰¹å®šç›®æ ‡æ¶æ„ï¼ˆarmã€x86 ç­‰ï¼‰ç¼–è¯‘çš„ï¼Œåªèƒ½åœ¨å…·æœ‰ç›¸åŒæ¶æ„çš„ä¸»æœºä¸Šè¿è¡Œã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒWebAssembly æ˜¯æ¶æ„ä¸­ç«‹çš„ï¼Œè¿™æ„å‘³ç€åªè¦è¿è¡Œæ—¶å¯ç”¨ï¼Œåº”ç”¨ç¨‹åºå°±å¯ä»¥åœ¨ä»»ä½•åº•å±‚æ¶æ„ä¸Šè¿è¡Œã€‚è¿™æä¾›äº†å‡ ä¸ªä¼˜ç‚¹ï¼Œä¾‹å¦‚åœ¨ä¸éœ€è¦é‡æ–°ç¼–è¯‘çš„æƒ…å†µä¸‹åœ¨å¤šä¸ªå¹³å°ä¸Šè¿è¡Œç›¸åŒçš„ä»£ç ä»¥åŠåœ¨ä»¥å‰ä¸å—æ”¯æŒçš„å¹³å°ä¸Šè¿è¡Œä»£ç çš„èƒ½åŠ›ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ€»ä¹‹ï¼Œä½¿ç”¨ WebAssembly å®¹å™¨æœ‰ä¸€äº›æœ‰è¶£çš„å¥½å¤„ï¼&lt;/p&gt;
&lt;h2 id=&#34;è®©æˆ‘ä»¬å¼€å§‹å§&#34;&gt;è®©æˆ‘ä»¬å¼€å§‹å§&lt;/h2&gt;
&lt;p&gt;æœ¬æ–‡å°†é«˜åº¦å®ç”¨ï¼Œåªæ¶‰åŠè¯¥ä¸»é¢˜çš„è¡¨é¢ï¼Œå¹¶ç•™ä¸‹è®¸å¤šç»†èŠ‚ã€‚è¿™äº›ç»†èŠ‚å°†åœ¨å°†æ¥çš„æ–‡ç« ä¸­æ·±å…¥æ¢è®¨ï¼Œå°½ç®¡å·²ç»æœ‰è®¸å¤šå¾ˆå¥½çš„èµ„æºå¯ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;è®©æˆ‘ä»¬ä»ä¸€ä¸ªåŸºæœ¬åº”ç”¨ç¨‹åºå¼€å§‹ã€‚å°½ç®¡åœ¨è¿™ä¸ªä¾‹å­ä¸­æ˜¯ç”¨ Rust ç¼–å†™çš„ï¼Œä½†ä½¿ç”¨çš„è¯­è¨€å¹¶ä¸é‡è¦ï¼Œåªè¦å®ƒæ”¯æŒ WebAssembly ä½œä¸ºç¼–è¯‘ç›®æ ‡å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;å‡è®¾åœ¨è®¡ç®—æœºä¸Šå·²ç»å®‰è£…äº† Rustï¼ˆ&lt;a href=&#34;https://www.rust-lang.org/tools/install&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¦‚æœæ²¡æœ‰&lt;/a&gt;ï¼‰ï¼Œè®©æˆ‘ä»¬ä½¿ç”¨ &lt;code&gt;cargo new rust-wasm-docker&lt;/code&gt; åˆ›å»ºä¸€ä¸ªæ–°çš„ Rust åº”ç”¨ç¨‹åº&lt;/p&gt;
&lt;p&gt;è¿™å°†åˆ›å»ºæœ€å°åŒ–çš„ Rust åº”ç”¨ç¨‹åºç»“æ„ã€‚&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;total 8
drwxr-xr-x@ 3 fabrizio  staff   96 Jan 12 20:55 src
-rw-r--r--@ 1 fabrizio  staff  186 Jan 12 20:55 Cargo.toml
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æˆ‘ä»¬å¯ä»¥ä¿ç•™æä¾›çš„æœ€å°åº”ç”¨ç¨‹åºä»£ç ï¼Œè¿™æ˜¯ä¸€ä¸ªç›¸å½“å¸¸è§å’Œæ˜“è¯»çš„ â€œHello Worldâ€ã€‚&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;# cat src/main.rs
fn main() {
    println!(&amp;#34;Hello, world!&amp;#34;);
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è®©æˆ‘ä»¬å°è¯•ä½¿ç”¨ &lt;code&gt;cargo run&lt;/code&gt; è¿è¡Œï¼Œè¾“å‡ºåº”è¯¥æ˜¯ â€œHello, world!â€ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å¸¸è§çš„-docker-æ–¹å¼&#34;&gt;å¸¸è§çš„ Docker æ–¹å¼&lt;/h2&gt;
&lt;p&gt;å¦‚æœæ²¡æœ‰ WebAssembly çš„æ–¹æ³•ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ª Docker é•œåƒï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;FROM rust:latest

WORKDIR /usr/src/myapp
COPY . .

RUN cargo install --path .

CMD [&amp;#34;wasm-docker-hello&amp;#34;]
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„ &lt;code&gt;Dockerfile&lt;/code&gt; ï¼Œå®ƒä½¿ç”¨ Docker Hub çš„ &lt;code&gt;rust&lt;/code&gt; åŸºæœ¬é•œåƒï¼Œå°†æºä»å½“å‰ä¸»æœºç›®å½•å¤åˆ¶åˆ°é•œåƒä¸­çš„ &lt;code&gt;/usr/src/myapp&lt;/code&gt; ï¼Œè¿è¡Œ &lt;code&gt;cargo install&lt;/code&gt; æ¥ç¼–è¯‘åº”ç”¨ç¨‹åºï¼Œæœ€ç»ˆå°†åº”ç”¨ç¨‹åºäºŒè¿›åˆ¶æ–‡ä»¶å®šä¹‰ä¸ºå®¹å™¨å‘½ä»¤ã€‚&lt;/p&gt;
&lt;p&gt;å‡è®¾ Docker å·²ç»å®‰è£…åœ¨è®¡ç®—æœºä¸Šï¼ˆ&lt;a href=&#34;https://docs.docker.com/get-docker/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¦‚æœæ²¡æœ‰&lt;/a&gt;ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åˆ›å»ºä¸€ä¸ªé•œåƒï¼š &lt;code&gt;docker build -t hello-docker .&lt;/code&gt; è¯¥å‘½ä»¤ä½¿ç”¨å½“å‰ç›®å½•ä¸­çš„ Dockerfile æ„å»ºé•œåƒï¼Œå¹¶å°†å…¶æ ‡è®°ä¸º â€œhello-dockerâ€ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åï¼Œåœ¨æ„å»ºé•œåƒåï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ &lt;code&gt;docker run hello-world&lt;/code&gt; è¿è¡Œå®ƒã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;# docker run hello-docker&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Hello, world!
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç°åœ¨ï¼Œè®©æˆ‘ä»¬å°è¯•è¿›è¡Œå¦ä¸€ä¸ªå¿«é€Ÿæµ‹è¯•ï¼Œç¨ååœ¨æœ¬æ–‡ä¸­æ›´æ¸…æ¥šåœ°è¯´æ˜ WebAssembly å®¹å™¨çš„åŒºåˆ«ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ &lt;code&gt;bash&lt;/code&gt; shell è¦†ç›–é»˜è®¤å‘½ä»¤æ¥è¿è¡Œæˆ‘ä»¬çš„é•œåƒã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker run -it hello-docker bash
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;root@be1902d5e9b6:/usr/src/myapp#
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¾“å‡ºå¯èƒ½ç•¥æœ‰ä¸åŒï¼Œå› ä¸ºå®¹å™¨ IDï¼ˆbe1902d5e9b6ï¼‰åœ¨æ¯æ¬¡è¿è¡Œå®¹å™¨æ—¶éƒ½æ˜¯éšæœºç”Ÿæˆçš„ã€‚æ— è®ºå¦‚ä½•ï¼Œè¿™é‡Œçš„é‡è¦ç‚¹æ˜¯ï¼Œæ‚¨å¯ä»¥è·å–ä¸€ä¸ª shell ä¸ä¹‹äº¤äº’ï¼Œå°±åƒåœ¨ä»»ä½•å¸¸è§çš„ Linux æœºå™¨ä¸Šä¸€æ ·ã€‚&lt;/p&gt;
&lt;h2 id=&#34;èµ°è¿›-webassembly&#34;&gt;èµ°è¿› WebAssembly&lt;/h2&gt;
&lt;p&gt;ç°åœ¨ï¼Œè®©æˆ‘å›é¡¾ä¸€ä¸‹æˆ‘ä»¬åˆ°ç›®å‰ä¸ºæ­¢æ‰€åšçš„äº‹æƒ…ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªéå¸¸ï¼ˆéå¸¸ï¼‰ç®€å•çš„ Rust åº”ç”¨ç¨‹åº&lt;/li&gt;
&lt;li&gt;æˆ‘ä»¬åœ¨ä¸»æœºæœºå™¨ä¸Šæ„å»ºå’Œè¿è¡Œäº†è¯¥åº”ç”¨ç¨‹åº&lt;/li&gt;
&lt;li&gt;æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª &lt;code&gt;Dockerfile&lt;/code&gt; æ¥æ„å»ºåº”ç”¨ç¨‹åºå’Œé•œåƒ&lt;/li&gt;
&lt;li&gt;æˆ‘ä»¬é€šè¿‡æˆåŠŸè¿è¡Œå®ƒæ¥æµ‹è¯•äº† Docker é•œåƒçš„åŠŸèƒ½&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ¥ä¸‹æ¥å‘¢ï¼Ÿç›®æ ‡æ˜¯ä»…ä½¿ç”¨æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºåˆ›å»ºä¸€ä¸ª docker é•œåƒã€‚è¦éå¸¸æ˜ç¡®ï¼šè¿™æ„å‘³ç€ä¸€ä¸ªä¸å«ä»»ä½•æ“ä½œç³»ç»Ÿçš„é•œåƒä½œä¸ºè¿è¡Œç¯å¢ƒã€‚å®é™…ä¸Šï¼Œæˆ‘è¿è¡Œäº† &lt;code&gt;docker run -it hello-docker bash&lt;/code&gt; æ¥å±•ç¤ºæˆ‘ä»¬åˆ›å»ºçš„é•œåƒå®é™…ä¸Šæ˜¯ä¸€ä¸ªå¸¦æœ‰æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºæ†ç»‘çš„ Linux è¿è¡Œç¯å¢ƒã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ç»§ç»­ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦é…ç½®ä¸€äº›å·¥å…·ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å¿…é¡»è®¾ç½®ç¼–è¯‘ WebAssembly + WASI çš„èƒ½åŠ›ï¼Œç„¶åå¯ç”¨å®éªŒæ€§çš„ Docker åŠŸèƒ½ä»¥è¿è¡Œ WASM å®¹å™¨ã€‚&lt;/p&gt;
&lt;p&gt;è®©æˆ‘ä»¬å¼€å§‹ä½¿ç”¨ &lt;code&gt;rustup target add wasm32-wasi&lt;/code&gt; å®‰è£… WASIã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;WASIï¼ˆWebAssembly ç³»ç»Ÿæ¥å£ï¼‰æ˜¯ä¸€ç»„è§„èŒƒå’Œ APIï¼Œæä¾›äº†æ‰§è¡Œ WebAssembly ä»£ç çš„æ ‡å‡†æ¥å£ï¼Œè¿™äº›ä»£ç ä¸åœ¨ Web æµè§ˆå™¨ä¸­è¿è¡Œï¼Œä¾‹å¦‚åœ¨æœåŠ¡å™¨æˆ–ç‹¬ç«‹åº”ç”¨ç¨‹åºä¸­è¿è¡Œã€‚å®ƒå…è®¸ WebAssembly æ¨¡å—è®¿é—®ç³»ç»Ÿèµ„æºï¼Œå¦‚æ–‡ä»¶ç³»ç»Ÿå’Œç½‘ç»œï¼Œå¹¶æä¾›å®‰å…¨çš„æ²™ç®±ç¯å¢ƒã€‚å®ƒæä¾›äº†ä½¿ WebAssembly æˆä¸ºç‹¬ç«‹å¯æ‰§è¡Œæ ¼å¼æ‰€éœ€çš„å…³é”®åŠŸèƒ½ï¼Œä½¿å…¶èƒ½å¤Ÿç”¨äºå„ç§è¶…è¶Š Web çš„åœºæ™¯ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åˆ°ç›®å‰ä¸ºæ­¢ä¸€åˆ‡é¡ºåˆ©ï¼ç°åœ¨å¯ä»¥è¿è¡Œ &lt;code&gt;cargo build --target wasm32-wasi&lt;/code&gt; ç¼–è¯‘ WebAssemblyã€‚å¦‚æœå°è¯•ï¼Œæˆ‘ä»¬å°†åœ¨ &lt;code&gt;target/wasm32-wasi/debug&lt;/code&gt; ç›®å½•ä¸­è·å¾—ä¸€ä¸ªåä¸º &lt;code&gt;wasm-docker-hello.wasm&lt;/code&gt; çš„æ–‡ä»¶ã€‚å¾ˆå¥½ï¼Œä½†æ˜¯æˆ‘ä»¬è¯¥å¦‚ä½•è¿è¡Œæ­¤äºŒè¿›åˆ¶æ–‡ä»¶ï¼Ÿå°è¯•åƒæ™®é€šå¯æ‰§è¡Œæ–‡ä»¶ä¸€æ ·æ‰§è¡Œå®ƒï¼Œå¦‚ &lt;code&gt;. ./target/wasm32-wasi/debug/wasm-docker-hello.wasm&lt;/code&gt;ï¼Œæˆ‘ä»¬ä¼šæ”¶åˆ°é”™è¯¯ï¼Œä¸ºä»€ä¹ˆï¼Ÿå®é™…ä¸Šï¼Œé”™è¯¯æ˜¯ä¸è¨€è‡ªæ˜çš„ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;zsh: &lt;span class=&#34;nb&#34;&gt;exec&lt;/span&gt; format error: ./target/wasm32-wasi/debug/wasm-docker-hello.wasm
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;wasm æ–‡ä»¶ä¸æ˜¯ä¸ºæˆ‘ä»¬ä¸»æœºçš„æœ¬æœºæ¶æ„ï¼ˆæ— è®ºæ˜¯ x86_64ã€arm è¿˜æ˜¯å…¶ä»–ï¼‰æ„å»ºçš„ã€‚æˆ‘ä»¬éœ€è¦ä¸€ä¸ª &lt;strong&gt;WebAssembly è¿è¡Œæ—¶&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;webassembly-è¿è¡Œæ—¶å°†-wasm-å¸¦åˆ°å„å¤„&#34;&gt;WebAssembly è¿è¡Œæ—¶ï¼šå°† WASM å¸¦åˆ°å„å¤„&lt;/h2&gt;
&lt;p&gt;æœ‰è®¸å¤š WASM è¿è¡Œæ—¶ã€‚WebAssembly æœ€åˆæ˜¯ä¸ºåœ¨ Web æµè§ˆå™¨ä¸­ä½¿ç”¨è€Œè®¾è®¡çš„ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¿è¡Œæ—¶ä¸éœ€è¦ï¼Œå› ä¸º &lt;strong&gt;æµè§ˆå™¨å……å½“è¿è¡Œæ—¶&lt;/strong&gt;ã€‚ä½†æ˜¯ï¼Œåœ¨åˆ›å»ºå‘½ä»¤è¡Œåº”ç”¨ç¨‹åºçš„æƒ…å†µä¸‹ï¼Œéœ€è¦è¿è¡Œæ—¶ï¼Œå¯¹äºå®Œæ•´çš„åº”ç”¨ç¨‹åºã€æœåŠ¡å™¨ç­‰ä¹Ÿæ˜¯å¦‚æ­¤ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å°†å®‰è£… &lt;strong&gt;WasmEdge&lt;/strong&gt;ï¼Œè¿™æ˜¯ Docker ç”¨äºæ‰§è¡Œæˆ‘ä»¬çš„ WASM é•œåƒçš„è¿è¡Œæ—¶ã€‚å¦‚æœæ‚¨åœ¨ Mac OS æˆ– Linux æœºå™¨ä¸Šï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿›è¡Œå®‰è£…ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;curl -sSf &amp;lt;https://raw.githubusercontent.com/WasmEdge/WasmEdge/master/utils/install.sh&amp;gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; bash
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¦‚éœ€å®Œæ•´çš„å®‰è£…è¯´æ˜ï¼ˆåŒ…æ‹¬ Windowsï¼‰ï¼Œè¯·åœ¨æ­¤å¤„æŸ¥çœ‹ &lt;a href=&#34;https://wasmedge.org/book/en/quick_start/install.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://wasmedge.org/book/en/quick_start/install.html&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å¯ç”¨-dockerwasm-é›†æˆ&#34;&gt;å¯ç”¨ Docker+WASM é›†æˆ&lt;/h2&gt;
&lt;p&gt;æœ€åä¸€æ­¥æ˜¯å¯ç”¨ Docker ä¸­çš„ WASM æ”¯æŒï¼Œè¿™æ˜¯ç›®å‰çš„å®éªŒæ€§åŠŸèƒ½ã€‚å¯ä»¥é€šè¿‡å¯ç”¨ containerd é•œåƒå­˜å‚¨åº“æ¥å®Œæˆæ­¤æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ Docker Desktopï¼Œåªéœ€åœ¨è®¾ç½®é¡µé¢ä¸­æ‰“å¼€è¯¥åŠŸèƒ½å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/docker-wasm-quick-intro/ui_huf50248a121f857a9401ba6bd403cd5b5_288921_1f5bcea6a397ca44a5fd4cb6d635d567.webp 400w,
               /blog/docker-wasm-quick-intro/ui_huf50248a121f857a9401ba6bd403cd5b5_288921_7a46c8ed22385a848fca2867156a844e.webp 760w,
               /blog/docker-wasm-quick-intro/ui_huf50248a121f857a9401ba6bd403cd5b5_288921_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/docker-wasm-quick-intro/ui_huf50248a121f857a9401ba6bd403cd5b5_288921_1f5bcea6a397ca44a5fd4cb6d635d567.webp&#34;
               width=&#34;760&#34;
               height=&#34;357&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;è¯¦ç»†è¯´æ˜å¯ä»¥åœ¨æ­¤å¤„æ‰¾åˆ° &lt;a href=&#34;https://docs.docker.com/desktop/wasm/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://docs.docker.com/desktop/wasm/&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å‡†å¤‡åˆ›å»º-æ— æ“ä½œç³»ç»Ÿ-çš„å®¹å™¨&#34;&gt;å‡†å¤‡åˆ›å»º â€œæ— æ“ä½œç³»ç»Ÿ â€œçš„å®¹å™¨&lt;/h2&gt;
&lt;p&gt;ç°åœ¨æˆ‘ä»¬å·²ç»å‡†å¤‡å¥½åˆ›å»ºä¸€ä¸ªæ–°çš„ Dockerfileï¼ˆæˆ‘ä»¬å°†å…¶å‘½åä¸º &lt;code&gt;Dockerfile.wasm&lt;/code&gt; ä»¥åŒºåˆ†å®ƒä¸ä»¥å‰çš„æ–‡ä»¶ï¼‰ï¼Œå†…å®¹å¦‚ä¸‹ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;FROM scratch
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;COPY target/wasm32-wasi/debug/wasm-docker-hello.wasm /app.wasm
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ENTRYPOINT &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;app.wasm&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å®ƒéå¸¸ç®€çŸ­å’Œæ˜“æ‡‚ï¼Œä½†æœ‰å‡ ä¸ªè¦ç‚¹éœ€è¦å¼ºè°ƒï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å®ƒä»¥ â€œFROM scratchâ€ å¼€å§‹ï¼Œè¡¨ç¤ºè¯¥é•œåƒæ˜¯ä»å¤´å¼€å§‹æ„å»ºçš„ï¼Œä¸ä¼šç»§æ‰¿ä»»ä½•æ“ä½œç³»ç»Ÿç¯å¢ƒ&lt;/li&gt;
&lt;li&gt;æˆ‘ä»¬å°†ç¼–è¯‘åçš„äºŒè¿›åˆ¶æ–‡ä»¶å¤åˆ¶åˆ°é•œåƒä¸­ï¼Œåœ¨å‰ä¸€ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å¤åˆ¶äº†æºæ–‡ä»¶å¹¶åœ¨æ„å»ºé•œåƒè¿‡ç¨‹ä¸­å¯¹å…¶è¿›è¡Œäº†ç¼–è¯‘ï¼Œè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨å·²ç»ç¼–è¯‘å¥½çš„ï¼ˆåœ¨ä¸»æœºä¸Šï¼‰wasm äºŒè¿›åˆ¶æ–‡ä»¶&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ENTRYPOINT&lt;/code&gt; æ˜¯äºŒè¿›åˆ¶æ–‡ä»¶æœ¬èº«ï¼Œè¿™é‡Œæ²¡æœ‰æŒ‡å®šè¿è¡Œæ—¶&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ„å»ºæˆ‘ä»¬çš„é•œåƒï¼Œæ–¹å¼ä¸æˆ‘ä»¬ä¸º â€œé€šç”¨â€ é•œåƒæ‰€åšçš„æ–¹å¼ç›¸åŒã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker build -t wasm-docker -f Dockerfile.wasm .
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¹Ÿè®¸æœ‰äººå·²ç»æ³¨æ„åˆ°äº†ä¸€ä¸ªæœ‰è¶£çš„ç‚¹ï¼šDocker å¦‚ä½•çŸ¥é“åœ¨ ENTRYPOINT æŒ‡å‘.wasm äºŒè¿›åˆ¶æ–‡ä»¶çš„é•œåƒä¸­ä½¿ç”¨ &lt;strong&gt;WasmEdge&lt;/strong&gt; ä½œä¸ºè¿è¡Œæ—¶ï¼Ÿæˆ‘ä»¬å·²ç»æµ‹è¯•è¿‡ï¼Œç›´æ¥è¿è¡Œ.wasm æ–‡ä»¶ä¸èµ·ä½œç”¨ã€‚&lt;/p&gt;
&lt;p&gt;å®é™…ä¸Šæ²¡æœ‰ï¼Œæˆ‘ä»¬éœ€è¦åœ¨å¯åŠ¨å®¹å™¨æ—¶æŒ‡å®šè¿è¡Œæ—¶ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker run --runtime&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;io.containerd.wasmedge.v1 --platform&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;wasi/wasm32 b678ba11b941
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æˆ‘ä»¬æŒ‡å®š &lt;code&gt;--runtime&lt;/code&gt; å‘Šè¯‰ Docker ä½¿ç”¨ WasmEdge ä½œä¸ºè¿è¡Œæ—¶ï¼Œå¹¶æŒ‡å®š &lt;code&gt;--platform&lt;/code&gt; ä½¿ç”¨ WASI æ¥å£ä½œä¸ºå¹³å°ã€‚å°±è¿™æ ·ï¼Œå¦‚æœæ‚¨æŒ‰ç…§æ‰€æœ‰æ­¥éª¤æ“ä½œï¼Œæ‚¨åº”è¯¥çœ‹åˆ°ä¸€ä¸ªä»¤äººå…´å¥‹çš„ â€œHello, world!â€ã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶ï¼Œæˆ‘æ˜¯å¼€ç©ç¬‘çš„ï¼Œæ¯”è¾ƒé•œåƒå¤§å°ä½¿ç”¨ &lt;code&gt;docker images&lt;/code&gt; å‘½ä»¤å¯ä»¥çœ‹åˆ°æ›´æœ‰è¶£çš„ç»“æœã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;REPOSITORY                  TAG       IMAGE ID       CREATED         SIZE
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;hello-docker                latest    e9ed5014b408   &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; seconds ago   544MB
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;wasm-docker                 latest    b678ba11b941   &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; seconds ago   507kB
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;hello-docker&lt;/code&gt; æ˜¯æˆ‘ä»¬åœ¨å¼€å§‹æ—¶æ„å»ºçš„é•œåƒï¼Œå°ºå¯¸å·®å¼‚å·¨å¤§ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç»“è®º&#34;&gt;&lt;strong&gt;ç»“è®º&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬æ¯”è¾ƒäº†æ ‡å‡† Docker å®¹å™¨å’Œ WASM å®¹å™¨ã€‚æ ‡å‡† Docker å®¹å™¨å’Œ WebAssembly å®¹å™¨éƒ½æœ‰å„è‡ªç‹¬ç‰¹çš„ä¼˜ç‚¹å’Œé™åˆ¶ï¼Œä½† WASM æ­£åœ¨å±•ç¤ºæˆä¸ºä¸€ç§é«˜åº¦æœ‰å‰é€”çš„å®¹å™¨åŒ–æŠ€æœ¯ï¼Œå°¤å…¶æ˜¯å¯¹äºæŸäº›ç”¨ä¾‹ã€‚ä¸æ ‡å‡† Docker å®¹å™¨ç›¸æ¯”ï¼ŒWebAssembly æä¾›äº†æ€§èƒ½ä¼˜åŠ¿ï¼Œä¾‹å¦‚æ›´å¿«çš„å¯åŠ¨æ—¶é—´ã€æ›´ä½çš„å†…å­˜ä½¿ç”¨ç‡ä»¥åŠä»£ç å’Œä¸»æœºç³»ç»Ÿä¹‹é—´æ›´å¥½çš„éš”ç¦»ã€‚æ­¤å¤–ï¼ŒWebAssembly æ˜¯æ¶æ„ä¸­ç«‹çš„ï¼Œè¿™æ„å‘³ç€åªè¦è¿è¡Œæ—¶å¯ç”¨ï¼Œåº”ç”¨ç¨‹åºå°±å¯ä»¥åœ¨ä»»ä½•åº•å±‚æ¶æ„ä¸Šè¿è¡Œã€‚è¿™æä¾›äº†å¤šç§ä¼˜åŠ¿ï¼Œä¾‹å¦‚åœ¨å¤šä¸ªå¹³å°ä¸Šè¿è¡Œç›¸åŒçš„ä»£ç è€Œæ— éœ€é‡æ–°ç¼–è¯‘ï¼Œå¹¶èƒ½åœ¨ä»¥å‰ä¸æ”¯æŒçš„å¹³å°ä¸Šè¿è¡Œä»£ç ã€‚ç”šè‡³å¯ä»¥åœ¨è¯¸å¦‚ç‰©è”ç½‘ã€è¾¹ç¼˜è®¡ç®—ç­‰å—é™è®¾å¤‡ä¸Šæ‰©å±•å®¹å™¨çš„ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶è€Œï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒWebAssembly ä»å¤„äºæ—©æœŸé˜¶æ®µï¼Œå°šä¸æˆç†Ÿï¼Œå°šä¸å…·å¤‡å¹¿æ³›é‡‡ç”¨çš„æ¡ä»¶ã€‚å°½ç®¡å¦‚æ­¤ï¼Œé‡è¦çš„æ˜¯è¦å…³æ³¨è¿™é¡¹æŠ€æœ¯ï¼Œå› ä¸ºå®ƒæœ‰æ½œåŠ›å½»åº•æ”¹å˜æˆ‘ä»¬å®¹å™¨åŒ–åº”ç”¨ç¨‹åºçš„æ–¹å¼ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title> CNCF å¹³å°ç™½çš®ä¹¦</title>
      <link>https://lib.jimmysong.io/blog/cncf-platforms-white-paper/</link>
      <pubDate>Fri, 14 Apr 2023 11:17:22 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/cncf-platforms-white-paper/</guid>
      <description>&lt;blockquote&gt;
&lt;p&gt;è¯‘è€…æ³¨ï¼šæœ¬æ–‡è¯‘è‡ª &lt;a href=&#34;https://tag-app-delivery.cncf.io/whitepapers/platforms/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;CNCF å¹³å°ç™½çš®ä¹¦&lt;/a&gt;ï¼Œä»‹ç»äº†å¦‚ä½•æ„å»ºäº‘åŸç”Ÿè®¡ç®—å¹³å°ä»¥åŠå¹³å°å¯èƒ½æä¾›çš„èƒ½åŠ›ã€‚è¿™äº›èƒ½åŠ›åŒ…æ‹¬ Web é—¨æˆ·ã€APIã€é»„é‡‘è·¯å¾„æ¨¡æ¿ã€è‡ªåŠ¨åŒ–ã€å¼€å‘ç¯å¢ƒã€å¯è§‚æµ‹æ€§ã€åŸºç¡€è®¾æ–½æœåŠ¡ã€æ•°æ®æœåŠ¡ã€æ¶ˆæ¯å’Œäº‹ä»¶æœåŠ¡ã€èº«ä»½å’Œå¯†ç ç®¡ç†æœåŠ¡ã€å®‰å…¨æœåŠ¡å’Œå·¥ä»¶å­˜å‚¨ã€‚æ­¤å¤–ï¼Œè¯¥æ–‡æ¡£è¿˜ä»‹ç»äº†ä¸å¹³å°ç›¸å…³çš„æœ¯è¯­ï¼Œå¦‚å¹³å°ã€å¹³å°èƒ½åŠ›æä¾›è€…ã€å¹³å°å·¥ç¨‹å¸ˆã€å¹³å°äº§å“ç»ç†ã€å¹³å°å›¢é˜Ÿå’Œå¹³å°ç”¨æˆ·ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;ä»‹ç»&#34;&gt;ä»‹ç»&lt;/h2&gt;
&lt;p&gt;å— DevOps æ‰€æ‰¿è¯ºçš„è·¨èŒèƒ½åˆä½œçš„å¯å‘ï¼Œå¹³å°å·¥ç¨‹æ­£åœ¨ä¼ä¸šä¸­ä½œä¸ºä¸€ç§æ˜ç¡®çš„åˆä½œå½¢å¼å‡ºç°ã€‚å¹³å°ç­–åˆ’å’Œå‘ˆç°åŸºç¡€åŠŸèƒ½ã€æ¡†æ¶å’Œä½“éªŒï¼Œä»¥ä¿ƒè¿›å’ŒåŠ é€Ÿåº”ç”¨ç¨‹åºå¼€å‘äººå‘˜ã€æ•°æ®ç§‘å­¦å®¶å’Œä¿¡æ¯å·¥ä½œè€…ç­‰å†…éƒ¨å®¢æˆ·çš„å·¥ä½œã€‚ç‰¹åˆ«æ˜¯åœ¨äº‘è®¡ç®—é¢†åŸŸï¼Œå¹³å°å·²ç»å¸®åŠ©ä¼ä¸šå®ç°äº†äº‘è®¡ç®—é•¿æœŸæ‰¿è¯ºçš„ä»·å€¼ï¼Œä¾‹å¦‚å¿«é€Ÿçš„äº§å“å‘å¸ƒã€è·¨åŸºç¡€æ¶æ„çš„å¯ç§»æ¤æ€§ã€æ›´å®‰å…¨å’Œæ›´å¼¹æ€§çš„äº§å“ä»¥åŠæ›´é«˜çš„å¼€å‘è€…ç”Ÿäº§åŠ›ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡æ—¨åœ¨æ”¯æŒä¼ä¸šé¢†å¯¼ã€ä¼ä¸šæ¶æ„å¸ˆå’Œå¹³å°å›¢é˜Ÿé¢†å¯¼è€…æå€¡ã€è°ƒæŸ¥å’Œè®¡åˆ’äº‘è®¡ç®—å†…éƒ¨å¹³å°ã€‚æˆ‘ä»¬ç›¸ä¿¡å¹³å°å¯¹ä¼ä¸šçš„å®é™…ä»·å€¼æµæœ‰é‡å¤§å½±å“ï¼Œä½†åªæ˜¯é—´æ¥çš„ï¼Œå› æ­¤é¢†å¯¼å…±è¯†å’Œæ”¯æŒå¯¹å¹³å°å›¢é˜Ÿçš„é•¿æœŸå¯æŒç»­æ€§å’ŒæˆåŠŸè‡³å…³é‡è¦ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†é€šè¿‡è®¨è®ºå¹³å°çš„ä»·å€¼ã€å¦‚ä½•è¡¡é‡è¯¥ä»·å€¼ä»¥åŠå¦‚ä½•å®æ–½æœ€å¤§åŒ–è¯¥ä»·å€¼çš„å¹³å°å›¢é˜Ÿæ¥å®ç°è¿™ç§æ”¯æŒã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç›®å½•&#34;&gt;ç›®å½•&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;ä¸ºä»€ä¹ˆéœ€è¦å¹³å°ï¼Ÿ&lt;/li&gt;
&lt;li&gt;ä»€ä¹ˆæ˜¯å¹³å°ï¼Ÿ&lt;/li&gt;
&lt;li&gt;æˆåŠŸå¹³å°çš„å±æ€§&lt;/li&gt;
&lt;li&gt;æˆåŠŸå¹³å°å›¢é˜Ÿçš„å±æ€§&lt;/li&gt;
&lt;li&gt;å®æ–½å¹³å°æ—¶çš„æŒ‘æˆ˜&lt;/li&gt;
&lt;li&gt;å¦‚ä½•è¡¡é‡å¹³å°çš„æˆåŠŸ&lt;/li&gt;
&lt;li&gt;å¹³å°çš„åŠŸèƒ½&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;ä¸ºä»€ä¹ˆéœ€è¦å¹³å°&#34;&gt;ä¸ºä»€ä¹ˆéœ€è¦å¹³å°ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;äº‘å¹³å°å’Œå¹³å°å·¥ç¨‹æ˜¯å½“å‰çƒ­é—¨è¯é¢˜ã€‚åœ¨æ·±å…¥æ¢è®¨å¹³å°æ„å»ºçš„å®šä¹‰ã€æŠ€æœ¯å’Œæµ‹é‡ä¹‹å‰ï¼Œå…ˆæ¢è®¨ä¸€ä¸‹é©±åŠ¨å¹³å°æä¾›çš„ä»·å€¼ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿‡å» 20-30 å¹´çš„æµç¨‹æ”¹è¿›ä¸­ï¼Œè½¯ä»¶åº”ç”¨ç¨‹åºå’Œäº§å“å›¢é˜Ÿçš„æ•æ·æ€§æ˜¾è‘—æé«˜ï¼Œä¸ºå®ƒä»¬æä¾›äº†åŸºç¡€è®¾æ–½ï¼ˆå¦‚è®¡ç®—ã€ç½‘ç»œå’Œå­˜å‚¨ï¼‰å’Œå¼€å‘äººå‘˜æœåŠ¡ï¼ˆå¦‚æ„å»ºã€æµ‹è¯•ã€äº¤ä»˜å’Œå¯è§‚æµ‹æ€§ï¼‰çš„çµæ´»æœåŠ¡ã€‚è¿™ç§è‡ªä¸»æƒå’Œæµç¨‹æ”¹è¿›ä¹Ÿé€æ¸ä½¿è¶Šæ¥è¶Šå¤šçš„æ”¯æŒæœåŠ¡è´£ä»»è½¬ç§»åˆ°äº§å“å›¢é˜Ÿï¼Œè¿«ä½¿ä»–ä»¬èŠ±è´¹è¶Šæ¥è¶Šå¤šçš„æ—¶é—´å’Œè®¤çŸ¥ç²¾åŠ›å¤„ç†åŸºç¡€è®¾æ–½é—®é¢˜ï¼Œä»è€Œå‡å°‘äº†ä»–ä»¬ä¸ºç»„ç»‡åˆ›é€ ä»·å€¼çš„æ—¶é—´ã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›é‡æ–°èšç„¦äº¤ä»˜å›¢é˜Ÿçš„æ ¸å¿ƒä»»åŠ¡å¹¶å‡å°‘ç»„ç»‡å†…é‡å¤çš„å·¥ä½œï¼Œä¿ƒä½¿ä¼ä¸šå®æ–½äº‘åŸç”Ÿè®¡ç®—å¹³å°ã€‚é€šè¿‡æŠ•èµ„å¹³å°ï¼Œä¼ä¸šå¯ä»¥ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å‡è½»äº§å“å›¢é˜Ÿçš„è®¤çŸ¥è´Ÿè·ï¼Œä»è€ŒåŠ é€Ÿäº§å“å¼€å‘å’Œäº¤ä»˜&lt;/li&gt;
&lt;li&gt;é€šè¿‡ä¸“å®¶çš„é…ç½®å’Œç®¡ç†æ”¹è¿›ä¾èµ–äºå¹³å°èƒ½åŠ›çš„äº§å“çš„å¯é æ€§å’Œå¼¹æ€§&lt;/li&gt;
&lt;li&gt;é€šè¿‡åœ¨ä¼ä¸šå†…çš„å¤šä¸ªå›¢é˜Ÿä¹‹é—´é‡ç”¨å’Œå…±äº«å¹³å°å·¥å…·å’ŒçŸ¥è¯†ï¼ŒåŠ é€Ÿäº§å“å¼€å‘å’Œäº¤ä»˜&lt;/li&gt;
&lt;li&gt;é€šè¿‡ç®¡ç†å¹³å°èƒ½åŠ›åŠå…¶å‘¨å›´çš„ç”¨æˆ·ã€å·¥å…·å’Œæµç¨‹ï¼Œå‡å°‘äº§å“å’ŒæœåŠ¡çš„å®‰å…¨ã€æ³•è§„å’ŒåŠŸèƒ½é—®é¢˜çš„é£é™©&lt;/li&gt;
&lt;li&gt;é€šè¿‡ä½¿å…¬å…±äº‘æœåŠ¡å’Œå…¶ä»–æ‰˜ç®¡æä¾›å•†çš„æœåŠ¡å…·æœ‰æˆæœ¬æ•ˆç›Šå’Œç”Ÿäº§åŠ›ï¼Œä½¿å…¶èƒ½å¤Ÿä»£è¡¨ä»–ä»¬å®æ–½å®ç°è€Œä¿æŒå¯¹ç”¨æˆ·ä½“éªŒçš„æ§åˆ¶&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è¿™äº›å¥½å¤„éƒ¨åˆ†å¾—ç›Šäºå°‘é‡çš„å¹³å°å›¢é˜ŸæœåŠ¡äºä¼—å¤šçš„äº§å“å›¢é˜Ÿï¼Œä»è€Œæ‰©å¤§äº†å…¶å½±å“åŠ›ï¼›éƒ¨åˆ†å¾—ç›Šäºå¹³å°å›¢é˜Ÿé›†ä¸­ç®¡ç†å…±åŒçš„åŠŸèƒ½ï¼Œä¿ƒè¿›äº†æ²»ç†ï¼›éƒ¨åˆ†å¾—ç›Šäºå¹³å°å›¢é˜Ÿå°†ç”¨æˆ·ç•Œé¢å’Œä½“éªŒç½®äºé¦–ä½ã€‚&lt;/p&gt;
&lt;p&gt;å¹³å°ä¸“å®¶å›¢é˜Ÿä¸ä»…å‡è½»äº†å¯¹äº§å“å›¢é˜Ÿçš„å…±åŒå·¥ä½œè´Ÿæ‹…ï¼Œè¿˜ä¼˜åŒ–äº†è¿™äº›äº§å“ä¸­ä½¿ç”¨çš„å¹³å°èƒ½åŠ›ã€‚å¹³å°å›¢é˜Ÿè¿˜ç»´æŠ¤äº†ä¸€ç»„ä¼ ç»Ÿçš„æ¨¡å¼ã€çŸ¥è¯†å’Œå·¥å…·ï¼Œè¿™äº›éƒ½åœ¨ä¼ä¸šä¸­å¹¿æ³›ä½¿ç”¨ï¼Œä½¿å¼€å‘äººå‘˜èƒ½å¤Ÿå¿«é€Ÿä¸ºåŸºäºåŒä¸€åŸºç¡€æ„å»ºçš„å…¶ä»–å›¢é˜Ÿå’Œäº§å“åšå‡ºè´¡çŒ®ã€‚å…±äº«çš„å¹³å°æ¨¡å¼ä¹Ÿå…è®¸åœ¨æ¨¡æ¿ã€æ¨¡å¼å’Œèƒ½åŠ›ä¸­åµŒå…¥æ²»ç†å’Œæ§ä»¶ã€‚æœ€åï¼Œå› ä¸ºå¹³å°å›¢é˜Ÿç®¡ç†æä¾›è€…å¹¶ä¸ºå…¶æä¾›ä¸€è‡´çš„ä½“éªŒï¼Œå®ƒä»¬å¯ä»¥ä¸ºåŸºç¡€ä½†æ— å·®å¼‚åŒ–çš„èƒ½åŠ›ï¼ˆä¾‹å¦‚æ•°æ®åº“ã€èº«ä»½è®¿é—®ã€åŸºç¡€æ¶æ„è¿è¥å’Œåº”ç”¨ç¨‹åºç”Ÿå‘½å‘¨æœŸï¼‰çš„æœ‰æ•ˆä½¿ç”¨æä¾›æ”¯æŒã€‚&lt;/p&gt;
&lt;h2 id=&#34;å¹³å°æ˜¯ä»€ä¹ˆ&#34;&gt;å¹³å°æ˜¯ä»€ä¹ˆ&lt;/h2&gt;
&lt;p&gt;äº‘åŸç”Ÿè®¡ç®—çš„å¹³å°æ˜¯æ ¹æ®å¹³å°çš„ç”¨æˆ·éœ€æ±‚å®šä¹‰å’Œå‘ˆç°çš„ä¸€ç»„é›†æˆåŠŸèƒ½ã€‚å®ƒæ˜¯ä¸€ä¸ªè·¨åº”ç”¨ç¨‹åºå’Œç”¨ä¾‹é›†åˆçš„æ¨ªå‘å±‚ï¼Œç¡®ä¿ä¸ºå¹¿æ³›çš„åº”ç”¨ç¨‹åºå’Œç”¨ä¾‹ç»„ç»‡æä¾›å…¸å‹çš„åŠŸèƒ½å’ŒæœåŠ¡çš„ä¸€è‡´ä½“éªŒã€‚ä¸€ä¸ªå¥½çš„å¹³å°æä¾›äº†ä¸€è‡´çš„ç”¨æˆ·ä½“éªŒï¼Œç”¨äºä½¿ç”¨å’Œç®¡ç†å…¶åŠŸèƒ½å’ŒæœåŠ¡ï¼Œä¾‹å¦‚ Web é—¨æˆ·ã€é¡¹ç›®æ¨¡æ¿å’Œè‡ªåŠ©å¼ APIã€‚&lt;/p&gt;
&lt;p&gt;æ ¹æ® Atlassian [ &lt;a href=&#34;https://www.atlassian.com/devops/frameworks/team-topologies&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;1&lt;/a&gt;] çš„è¯´æ³•ï¼Œâ€œå¹³å°å›¢é˜Ÿåˆ›å»ºå¯ä»¥ç”±ä¼—å¤šæµç¨‹å¯¹é½çš„ [äº§å“] å›¢é˜Ÿä½¿ç”¨çš„åŠŸèƒ½ï¼Œå‡å°‘äº†æµç¨‹å¯¹é½ [äº§å“] å›¢é˜Ÿçš„èµ„æºå’Œè®¤çŸ¥è´Ÿè·â€¦â€¦ å¹³å°å›¢é˜Ÿå¯ä»¥åˆ›å»ºè·¨ä¸åŒç”¨æˆ·ä½“éªŒæˆ–äº§å“çš„è¿è´¯ä½“éªŒã€‚â€&lt;/p&gt;
&lt;p&gt;æ ¹æ® Martin Fowler å’Œ Evan Bottcher [ &lt;a href=&#34;https://martinfowler.com/articles/talk-about-platforms.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;2&lt;/a&gt;] çš„è¯´æ³•ï¼Œâ€œæ•°å­—å¹³å°æ˜¯ä¸€ä¸ªè‡ªåŠ©å¼ APIã€å·¥å…·ã€æœåŠ¡ã€çŸ¥è¯†å’Œæ”¯æŒåŸºç¡€ï¼ŒæŒ‰ç…§ä¸€ä¸ªå¼•äººæ³¨ç›®çš„å†…éƒ¨äº§å“çš„æ–¹å¼ç»„ç»‡ã€‚è‡ªæ²»äº¤ä»˜å›¢é˜Ÿå¯ä»¥åˆ©ç”¨è¯¥å¹³å°ä»¥æ›´é«˜çš„é€Ÿåº¦äº¤ä»˜äº§å“åŠŸèƒ½ï¼Œå¹¶å‡å°‘åè°ƒã€‚â€&lt;/p&gt;
&lt;p&gt;å¹³å°åº”æ”¯æŒçš„å…·ä½“åŠŸèƒ½å’Œåœºæ™¯åº”ç”±åˆ©ç›Šç›¸å…³è€…å’Œç”¨æˆ·ç¡®å®šã€‚è™½ç„¶å¹³å°ä¸ºè¿™äº›æ‰€éœ€çš„åŠŸèƒ½æä¾›æ”¯æŒï¼Œä½†å…³é”®æ˜¯è¦æ³¨æ„ï¼Œå¹³å°å›¢é˜Ÿå¹¶ä¸æ€»æ˜¯å¿…é¡»è‡ªå·± &lt;em&gt;å®ç°&lt;/em&gt; å®ƒä»¬ã€‚æ‰˜ç®¡æœåŠ¡æä¾›å•†æˆ–ä¸“ç”¨çš„å†…éƒ¨å›¢é˜Ÿå¯ä»¥ç»´æŠ¤æ”¯æŒå®ç°ï¼Œè€Œå¹³å°æ˜¯æä¾›ä¸€è‡´æ€§çš„æœ€è–„åˆç†å±‚ï¼Œèƒ½å¤Ÿè·¨æä¾›çš„å®ç°æä¾›ä¸€è‡´æ€§å¹¶æ»¡è¶³ç»„ç»‡çš„è¦æ±‚ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªéå¸¸ç®€å•çš„ â€œå¹³å°â€ å¯ä»¥æ˜¯ä¸€ä¸ª wiki é¡µé¢ï¼Œå…¶ä¸­åŒ…å«é“¾æ¥åˆ°æ ‡å‡†æ“ä½œç¨‹åºï¼Œä»¥ä»æä¾›è€…é‚£é‡Œè§„å®šèƒ½åŠ›ï¼Œå¦‚ [ &lt;a href=&#34;https://teamtopologies.com/key-concepts-content/what-is-a-thinnest-viable-platform-tvp&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;3&lt;/a&gt;] æ‰€è¿°ã€‚&lt;/p&gt;
&lt;p&gt;å› ä¸ºè¿™äº›å¹³å°åªé’ˆå¯¹ä¼ä¸šçš„å†…éƒ¨ç”¨æˆ·ï¼Œæ‰€ä»¥æˆ‘ä»¬é€šå¸¸å°†å®ƒä»¬ç§°ä¸º &lt;em&gt;å†…éƒ¨&lt;/em&gt; å¹³å°ã€‚&lt;/p&gt;
&lt;p&gt;å¹³å°å¯¹äºäº‘åŸç”Ÿæ¶æ„å°¤ä¸ºé‡è¦ï¼Œå› ä¸ºå®ƒä»¬æ¯”ä»¥å‰çš„èŒƒå¼æ›´å¥½åœ°å°†æ”¯æŒåŠŸèƒ½ä¸ç‰¹å®šäºåº”ç”¨ç¨‹åºçš„é€»è¾‘åˆ†ç¦»ã€‚åœ¨ç±»ä¼¼äº‘çš„ç¯å¢ƒä¸­ï¼Œèµ„æºå’ŒåŠŸèƒ½é€šå¸¸ç‹¬ç«‹ç®¡ç†ï¼Œå¹¶ä¸è‡ªå®šä¹‰ä¸šåŠ¡ç»„ä»¶é›†æˆï¼›è¿™äº›èµ„æºå¯èƒ½åŒ…æ‹¬æ•°æ®åº“å’Œå¯¹è±¡å­˜å‚¨ã€æ¶ˆæ¯é˜Ÿåˆ—å’Œä»£ç†ã€å¯è§‚æµ‹æ€§æ”¶é›†å™¨å’Œä»ªè¡¨æ¿ã€ç”¨æˆ·ç›®å½•å’Œè®¤è¯ç³»ç»Ÿã€ä»»åŠ¡è¿è¡Œç¨‹åºå’Œåè°ƒå™¨ç­‰ã€‚å†…éƒ¨å¹³å°ä»¥ä½¿å®ƒä»¬æ˜“äºé›†æˆåˆ°å…¶åº”ç”¨ç¨‹åºå’Œç³»ç»Ÿä¸­çš„æ–¹å¼å‘ä¼ä¸šå›¢é˜Ÿæä¾›è¿™äº›èµ„æºã€‚&lt;/p&gt;
&lt;h3 id=&#34;å¹³å°æˆç†Ÿåº¦&#34;&gt;å¹³å°æˆç†Ÿåº¦&lt;/h3&gt;
&lt;p&gt;åœ¨æœ€åŸºæœ¬çš„å±‚é¢ä¸Šï¼Œå†…éƒ¨å¹³å°ä¸ºè·å–å’Œä½¿ç”¨è¯¸å¦‚ç®¡é“è¿è¡Œå™¨ã€æ•°æ®åº“ç³»ç»Ÿæˆ–å¯†é’¥å­˜å‚¨ç­‰å•ä¸ªæœåŠ¡æä¾›äº†ä¸€è‡´çš„ä½“éªŒã€‚éšç€å†…éƒ¨å¹³å°çš„æˆç†Ÿï¼Œå®ƒä»¬ä¹Ÿæä¾›äº†æ­¤ç±»æœåŠ¡çš„&lt;em&gt;ç»„åˆ&lt;/em&gt;ï¼Œä¾‹å¦‚é’ˆå¯¹å…³é”®åœºæ™¯ï¼ˆå¦‚ Web åº”ç”¨ç¨‹åºå¼€å‘æˆ–æ•°æ®åˆ†æï¼Œå³ MLOpsï¼‰çš„è‡ªåŠ©æ¨¡æ¿ã€‚&lt;/p&gt;
&lt;p&gt;ä¼ä¸šå¯é€šè¿‡å¹³å°å®ç°çš„ç”¨ä¾‹å¯èƒ½æŒ‰ä»¥ä¸‹é¡ºåºå‘å±•ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;äº§å“å¼€å‘äººå‘˜å¯ä»¥æŒ‰éœ€æä¾›èƒ½åŠ›å¹¶ç«‹å³ä½¿ç”¨å®ƒä»¬æ¥è¿è¡Œç³»ç»Ÿï¼Œä¾‹å¦‚è®¡ç®—ã€å­˜å‚¨ã€æ•°æ®åº“æˆ–èº«ä»½éªŒè¯ã€‚&lt;/li&gt;
&lt;li&gt;äº§å“å¼€å‘äººå‘˜å¯ä»¥æŒ‰éœ€æä¾›æœåŠ¡ç©ºé—´å¹¶ä½¿ç”¨å®ƒä»¬æ¥è¿è¡Œç®¡é“å’Œä»»åŠ¡ï¼Œå­˜å‚¨å·¥ä»¶å’Œé…ç½®ï¼Œå¹¶ / æˆ–æ”¶é›†é¥æµ‹ã€‚&lt;/li&gt;
&lt;li&gt;ç¬¬ä¸‰æ–¹è½¯ä»¶çš„ç®¡ç†å‘˜å¯ä»¥æŒ‰éœ€æä¾›æ‰€éœ€çš„ä¾èµ–é¡¹ï¼Œä¾‹å¦‚æ•°æ®åº“ï¼Œå¹¶è½»æ¾å®‰è£…å’Œè¿è¡Œè¯¥è½¯ä»¶ã€‚&lt;/li&gt;
&lt;li&gt;äº§å“å¼€å‘äººå‘˜å¯ä»¥ä»æ¨¡æ¿ä¸­æä¾›å®Œæ•´çš„ç¯å¢ƒï¼Œç»„åˆè¿è¡Œæ—¶å’Œå¼€å‘æ—¶æ‰€éœ€çš„æœåŠ¡ï¼Œä»¥æ»¡è¶³ç‰¹å®šåœºæ™¯çš„éœ€æ±‚ï¼Œä¾‹å¦‚ Web å¼€å‘æˆ– MLOpsã€‚&lt;/li&gt;
&lt;li&gt;äº§å“å¼€å‘äººå‘˜å’Œç»ç†å¯ä»¥é€šè¿‡è‡ªåŠ¨ä»ªè¡¨åŒ–å’Œæ ‡å‡†ä»ªè¡¨æ¿è§‚å¯Ÿå·²éƒ¨ç½²æœåŠ¡çš„åŠŸèƒ½ã€æ€§èƒ½å’Œæˆæœ¬ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;é€šè¿‡ä¸ºå•ä¸ªèƒ½åŠ›æˆ–å®ƒä»¬çš„é›†åˆæä¾›ä¸€è‡´ã€åˆè§„çš„ä½“éªŒï¼Œå†…éƒ¨å¹³å°æœ€ç»ˆä½¿ç”¨æˆ·æ›´è½»æ¾ã€æ›´æœ‰æ•ˆåœ°äº¤ä»˜æœ‰ä»·å€¼çš„äº§å“ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å¹³å°çš„å±æ€§&#34;&gt;å¹³å°çš„å±æ€§&lt;/h2&gt;
&lt;p&gt;åœ¨å®šä¹‰å¹³å°æ˜¯ä»€ä¹ˆä»¥åŠç»„ç»‡ä¸ºä»€ä¹ˆè¦å»ºç«‹ä¸€ä¸ªå¹³å°ä¹‹åï¼Œè®©æˆ‘ä»¬è¯†åˆ«ä¸€äº›å½±å“å¹³å°æˆåŠŸçš„å…³é”®å±æ€§ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å¹³å°ä½œä¸ºäº§å“&lt;/strong&gt;ã€‚å¹³å°å­˜åœ¨æ˜¯ä¸ºäº†æœåŠ¡äºå…¶ç”¨æˆ·çš„è¦æ±‚ï¼Œå®ƒåº”è¯¥åŸºäºè¿™äº›è¦æ±‚è¿›è¡Œè®¾è®¡å’Œæ¼”è¿›ï¼Œç±»ä¼¼äºä»»ä½•å…¶ä»–è½¯ä»¶äº§å“ã€‚å¹³å°åº”è¯¥æä¾›å¿…è¦çš„èƒ½åŠ›ï¼Œä»¥æ”¯æŒäº§å“å›¢é˜Ÿä¸­æœ€å¸¸è§çš„ç”¨ä¾‹ï¼Œå¹¶ä¼˜å…ˆè€ƒè™‘é‚£äº›åªè¢«å•ä¸ªå›¢é˜Ÿä½¿ç”¨çš„æ›´å…·ä½“çš„èƒ½åŠ›ï¼Œä»¥æœ€å¤§åŒ–æä¾›çš„ä»·å€¼ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç”¨æˆ·ä½“éªŒ&lt;/strong&gt;ã€‚å¹³å°åº”è¯¥é€šè¿‡ä¸€è‡´çš„æ¥å£æä¾›å…¶åŠŸèƒ½ï¼Œå¹¶ä¸“æ³¨äºç”¨æˆ·ä½“éªŒã€‚å¹³å°åº”è¯¥å°½åŠ›æ»¡è¶³å…¶ç”¨æˆ·çš„éœ€æ±‚ï¼Œè¿™å¯èƒ½æ„å‘³ç€ä½¿ç”¨ GUIã€APIã€å‘½ä»¤è¡Œå·¥å…·ã€IDE å’Œé—¨æˆ·çš„ç»„åˆã€‚ä¾‹å¦‚ï¼Œå¹³å°é€šå¸¸æä¾›éƒ¨ç½²åº”ç”¨ç¨‹åºçš„åŠŸèƒ½ã€‚å¼€å‘äººå‘˜å¯èƒ½ä¼šé€šè¿‡ IDE æ¶ˆè´¹è¿™æ ·çš„åŠŸèƒ½ï¼Œæµ‹è¯•äººå‘˜å¯èƒ½ä¼šä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·ï¼Œè€Œäº§å“æ‰€æœ‰è€…å¯èƒ½ä¼šä½¿ç”¨åŸºäº GUI çš„ Web é—¨æˆ·ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ–‡æ¡£å’Œå…¥é—¨&lt;/strong&gt;ã€‚æ–‡æ¡£æ˜¯æˆåŠŸè½¯ä»¶äº§å“çš„å…³é”®æ–¹é¢ä¹‹ä¸€ã€‚ä¸ºäº†èƒ½å¤Ÿä½¿ç”¨å¹³å°çš„åŠŸèƒ½ï¼Œç”¨æˆ·éœ€è¦æ–‡æ¡£å’Œç¤ºä¾‹ã€‚å¹³å°åº”è¯¥éšç€é€‚å½“çš„æ–‡æ¡£äº¤ä»˜ï¼Œä»¥æ»¡è¶³å…¶ç”¨æˆ·çš„éœ€æ±‚ã€‚å®ƒè¿˜åº”è¯¥æä¾›å·¥å…·æ¥åŠ é€Ÿæ–°é¡¹ç›®çš„å…¥é—¨ï¼Œä»¥å¸®åŠ©ç”¨æˆ·ä»¥å¿«é€Ÿç®€å•çš„æ–¹å¼æ¶ˆè´¹å¿…è¦çš„å¹³å°æœåŠ¡ã€‚ä¾‹å¦‚ï¼Œå¹³å°å¯ä»¥æä¾›ç”¨äºåœ¨ Kubernetes ä¸Šæ„å»ºã€æ‰«æã€æµ‹è¯•ã€éƒ¨ç½²å’Œè§‚å¯Ÿ Web åº”ç”¨ç¨‹åºçš„å¯é‡ç”¨çš„ä¾›åº”é“¾å·¥ä½œæµã€‚è¿™æ ·çš„å·¥ä½œæµå¯ä»¥ä¸ä¸€ä¸ªåˆå§‹çš„é¡¹ç›®æ¨¡æ¿å’Œæ–‡æ¡£æ†ç»‘åœ¨ä¸€èµ·ï¼Œé€šå¸¸è¢«æè¿°ä¸º&lt;em&gt;é»„é‡‘è·¯å¾„&lt;/em&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è‡ªæœåŠ¡&lt;/strong&gt;ã€‚å¹³å°åº”è¯¥æ˜¯è‡ªæœåŠ¡çš„ã€‚ç”¨æˆ·å¿…é¡»èƒ½å¤Ÿè‡ªä¸»å’Œè‡ªåŠ¨åœ°è¯·æ±‚å’Œæ¥æ”¶åŠŸèƒ½ã€‚è¿™ä¸ªå±æ€§å¯¹äºå¹³å°å›¢é˜Ÿèƒ½å¤Ÿå¯ç”¨å¤šä¸ªäº§å“å›¢é˜Ÿå¹¶æ ¹æ®éœ€è¦è¿›è¡Œæ‰©å±•æ˜¯å…³é”®çš„ã€‚å¹³å°çš„èƒ½åŠ›åº”è¯¥éšæ—¶å¯ç”¨ï¼Œå¹¶ä¸”é€šè¿‡ä¸Šè¿°æ¥å£è¿›è¡Œæœ€å°çš„æ‰‹åŠ¨å¹²é¢„ã€‚ä¾‹å¦‚ï¼Œç”¨æˆ·åº”è¯¥èƒ½å¤Ÿé€šè¿‡è¿è¡Œå‘½ä»¤è¡Œå·¥å…·æˆ–åœ¨ Web é—¨æˆ·ä¸Šå¡«å†™è¡¨å•æ¥è¯·æ±‚æ•°æ®åº“å¹¶æ¥æ”¶å…¶å®šä½å™¨å’Œå‡­æ®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‡å°‘ç”¨æˆ·çš„è®¤çŸ¥è´Ÿè·&lt;/strong&gt;ã€‚å¹³å°çš„ä¸€ä¸ªé‡è¦ç›®æ ‡æ˜¯å‡å°‘äº§å“å›¢é˜Ÿçš„è®¤çŸ¥è´Ÿè·ã€‚å¹³å°åº”è¯¥å°è£…å®ç°ç»†èŠ‚ï¼Œå¹¶éšè—ç”±å…¶æ¶æ„å¼•èµ·çš„ä»»ä½•å¤æ‚æ€§ã€‚ä¾‹å¦‚ï¼Œå¹³å°å¯èƒ½å°†æŸäº›æœåŠ¡å§”æ‰˜ç»™äº‘æä¾›å•†ï¼Œä½†ç”¨æˆ·ä¸åº”è¯¥æ¥è§¦åˆ°è¿™äº›ç»†èŠ‚ã€‚åŒæ—¶ï¼Œå¹³å°è¿˜åº”è¯¥å…è®¸ç”¨æˆ·æ ¹æ®éœ€è¦é…ç½®å’Œè§‚å¯ŸæŸäº›æœåŠ¡ã€‚ç”¨æˆ·ä¸åº”è¯¥è´Ÿè´£æ“ä½œå¹³å°æä¾›çš„æœåŠ¡ã€‚ä¾‹å¦‚ï¼Œç”¨æˆ·ç»å¸¸éœ€è¦æ•°æ®åº“ï¼Œä½†ä»–ä»¬ä¸åº”è¯¥ç®¡ç†æ•°æ®åº“æœåŠ¡å™¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯é€‰å’Œå¯ç»„åˆ&lt;/strong&gt;ã€‚å¹³å°æ—¨åœ¨ä½¿äº§å“å¼€å‘æ›´åŠ é«˜æ•ˆï¼Œå› æ­¤å®ƒä»¬ä¸èƒ½æˆä¸ºéšœç¢ã€‚å¹³å°åº”è¯¥æ˜¯å¯ç»„åˆçš„ï¼Œå¹¶ä½¿äº§å“å›¢é˜Ÿä»…ä½¿ç”¨å…¶æä¾›çš„éƒ¨åˆ†åŠŸèƒ½ã€‚å½“å¿…è¦æ—¶ï¼Œå®ƒè¿˜åº”è¯¥ä½¿äº§å“å›¢é˜Ÿåœ¨å¹³å°çš„æä¾›èŒƒå›´ä¹‹å¤–æä¾›å’Œç®¡ç†è‡ªå·±çš„èƒ½åŠ›ã€‚ä¾‹å¦‚ï¼Œå¦‚æœå¹³å°ä¸æä¾›å›¾å½¢æ•°æ®åº“ï¼Œè€Œäº§å“éœ€è¦å®ƒï¼Œé‚£ä¹ˆäº§å“å›¢é˜Ÿåº”è¯¥èƒ½å¤Ÿè‡ªè¡Œæä¾›å’Œæ“ä½œå›¾å½¢æ•°æ®åº“ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é»˜è®¤å®‰å…¨&lt;/strong&gt;ã€‚å¹³å°åº”è¯¥é»˜è®¤å®‰å…¨ï¼Œå¹¶æä¾›åŸºäºç»„ç»‡è§„åˆ™å’Œæ ‡å‡†çš„åˆè§„æ€§å’ŒéªŒè¯èƒ½åŠ›ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;å¹³å°å›¢é˜Ÿçš„å±æ€§&#34;&gt;å¹³å°å›¢é˜Ÿçš„å±æ€§&lt;/h2&gt;
&lt;p&gt;å¹³å°å›¢é˜Ÿè´Ÿè´£å¹³å°èƒ½åŠ›çš„æ¥å£å’Œä½“éªŒï¼Œå¦‚ Web é—¨æˆ·ã€è‡ªå®šä¹‰ API å’Œé»„é‡‘è·¯å¾„æ¨¡æ¿ã€‚ä¸€æ–¹é¢ï¼Œå¹³å°å›¢é˜Ÿä¸å®æ–½åŸºç¡€è®¾æ–½å’Œæ”¯æŒæœåŠ¡çš„å›¢é˜Ÿåˆä½œï¼Œä»¥å®šä¹‰ä¸€è‡´çš„ä½“éªŒï¼›å¦ä¸€æ–¹é¢ï¼Œä»–ä»¬ä¸äº§å“å’Œç”¨æˆ·å›¢é˜Ÿåˆä½œï¼Œæ”¶é›†åé¦ˆå¹¶ç¡®ä¿è¿™äº›ä½“éªŒæ»¡è¶³è¦æ±‚ã€‚&lt;/p&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯å¹³å°å›¢é˜Ÿåº”è´Ÿè´£çš„å·¥ä½œï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ç ”ç©¶å¹³å°ç”¨æˆ·éœ€æ±‚å¹¶è®¡åˆ’åŠŸèƒ½è·¯çº¿å›¾&lt;/li&gt;
&lt;li&gt;æ¨å¹¿å’Œå€¡å¯¼å¹³å°æè®®çš„ä»·å€¼&lt;/li&gt;
&lt;li&gt;ç®¡ç†å’Œå¼€å‘ç”¨äºä½¿ç”¨å’Œè§‚å¯Ÿèƒ½åŠ›å’ŒæœåŠ¡çš„æ¥å£ï¼ŒåŒ…æ‹¬é—¨æˆ·ã€APIã€æ–‡æ¡£å’Œæ¨¡æ¿ä»¥åŠ CLI å·¥å…·&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æœ€é‡è¦çš„æ˜¯ï¼Œå¹³å°å›¢é˜Ÿå¿…é¡»äº†è§£å¹³å°ç”¨æˆ·çš„éœ€æ±‚ï¼Œä»¥ä¾¿ä¸ºä»–ä»¬çš„å¹³å°æä¾›èƒ½åŠ›å’Œæ¥å£ï¼Œå¹¶æŒç»­æ”¹è¿›ã€‚äº†è§£ç”¨æˆ·éœ€æ±‚çš„æ–¹å¼åŒ…æ‹¬ç”¨æˆ·è®¿è°ˆã€äº¤äº’å¼é»‘å®¢é©¬æ‹‰æ¾ã€é—®é¢˜è·Ÿè¸ªå™¨å’Œè°ƒæŸ¥ä»¥åŠé€šè¿‡å¯è§‚æµ‹æ€§å·¥å…·ç›´æ¥è§‚å¯Ÿä½¿ç”¨æƒ…å†µã€‚ä¾‹å¦‚ï¼Œå¹³å°å›¢é˜Ÿå¯ä»¥å‘å¸ƒä¸€ä¸ªè¡¨å•ï¼Œä¾›ç”¨æˆ·æäº¤åŠŸèƒ½è¯·æ±‚ï¼Œä¸»æŒè·¯çº¿å›¾ä¼šè®®ä»¥å…±äº«å³å°†æ¨å‡ºçš„åŠŸèƒ½å¹¶å®¡æŸ¥ç”¨æˆ·çš„ä½¿ç”¨æ¨¡å¼ä»¥è®¾ç½®ä¼˜å…ˆçº§ã€‚&lt;/p&gt;
&lt;p&gt;å…¥ç«™åé¦ˆå’Œå‘¨åˆ°çš„è®¾è®¡æ˜¯äº§å“äº¤ä»˜çš„ä¸€é¢ï¼›å¦ä¸€é¢æ˜¯å‡ºç«™å¸‚åœºè¥é”€å’Œå€¡å¯¼ã€‚å¦‚æœå¹³å°ç¡®å®æ˜¯åŸºäºç”¨æˆ·éœ€æ±‚æ„å»ºçš„ï¼Œé‚£ä¹ˆè¿™äº›ç”¨æˆ·å°†ä¼šå¾ˆé«˜å…´ä½¿ç”¨æä¾›çš„èƒ½åŠ›ã€‚å¹³å°å›¢é˜Ÿå¯ä»¥é€šè¿‡å†…éƒ¨è¥é”€æ´»åŠ¨æ¥ä¿ƒè¿›ç”¨æˆ·é‡‡ç”¨ï¼ŒåŒ…æ‹¬å¹¿æ³›çš„å…¬å‘Šã€å¼•äººå…¥èƒœçš„æ¼”ç¤ºå’Œå®šæœŸçš„åé¦ˆå’Œæ²Ÿé€šä¼šè®®ã€‚å…³é”®åœ¨äºæ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚å¹¶å¸¦é¢†ä»–ä»¬è¸ä¸Šæ—…ç¨‹ï¼Œä¸å¹³å°äº’åŠ¨å¹¶ä»ä¸­å—ç›Šã€‚&lt;/p&gt;
&lt;p&gt;å¹³å°å›¢é˜Ÿä¸ä¸€å®šè¿è¡Œè®¡ç®—ã€ç½‘ç»œã€å­˜å‚¨æˆ–å…¶ä»–æœåŠ¡ã€‚äº‹å®ä¸Šï¼Œå†…éƒ¨å¹³å°åº”å°½å¯èƒ½ä¾èµ–äº&lt;em&gt;å¤–éƒ¨&lt;/em&gt;æä¾›çš„æœåŠ¡å’ŒåŠŸèƒ½ï¼›å¹³å°å›¢é˜Ÿåº”ä»…åœ¨ä»å—ç®¡ç†ä¾›åº”å•†æˆ–å†…éƒ¨åŸºç¡€æ¶æ„å›¢é˜Ÿå¤„æ— æ³•è·å¾—è¿™äº›æœåŠ¡å’ŒåŠŸèƒ½æ—¶æ‰æ„å»ºå’Œç»´æŠ¤è‡ªå·±çš„æœåŠ¡ã€‚å› æ­¤ï¼Œå¹³å°å›¢é˜Ÿæœ€è´Ÿè´£çš„æ˜¯æœåŠ¡å’ŒåŠŸèƒ½çš„&lt;em&gt;æ¥å£&lt;/em&gt;ï¼ˆå³ GUIã€CLI å’Œ APIï¼‰ä»¥åŠå¹³å°æä¾›çš„æœåŠ¡å’ŒåŠŸèƒ½çš„ç”¨æˆ·ä½“éªŒã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œå¹³å°ä¸­çš„ä¸€ä¸ª Web é¡µé¢å¯èƒ½æè¿°å¹¶ç”šè‡³æä¾›ä¸€ä¸ªæŒ‰é’®æ¥ä¸ºåº”ç”¨ç¨‹åºè¿›è¡Œèº«ä»½éªŒè¯ï¼›è€Œè¯¥åŠŸèƒ½çš„å®ç°å¯èƒ½é€šè¿‡äº‘æ‰˜ç®¡çš„èº«ä»½éªŒè¯æœåŠ¡ã€‚å†…éƒ¨å¹³å°å›¢é˜Ÿå¯èƒ½ç®¡ç†ç½‘é¡µå’Œ APIï¼Œä½†ä¸ç®¡ç†å®é™…çš„æœåŠ¡å®ç°ã€‚å¹³å°å›¢é˜Ÿé€šå¸¸åº”åœ¨æ‰€éœ€çš„åŠŸèƒ½ä¸å¯åœ¨å…¶ä»–åœ°æ–¹è·å¾—æ—¶è€ƒè™‘åˆ›å»ºå’Œç»´æŠ¤è‡ªå·±çš„åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å¹³å°çš„æŒ‘æˆ˜&#34;&gt;å¹³å°çš„æŒ‘æˆ˜&lt;/h2&gt;
&lt;p&gt;è™½ç„¶å¹³å°æ‰¿è¯ºäº†å¾ˆå¤šä»·å€¼ï¼Œä½†ä¹Ÿå¸¦æ¥äº†ä»¥ä¸‹æŒ‘æˆ˜ï¼Œå®æ–½è€…åº”è¯¥æ³¨æ„è¿™äº›æŒ‘æˆ˜ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å¹³å°å›¢é˜Ÿå¿…é¡»åƒäº§å“ä¸€æ ·å¯¹å¾…ä»–ä»¬çš„å¹³å°ï¼Œå¹¶ä¸ç”¨æˆ·ä¸€èµ·å¼€å‘å®ƒä»¬ã€‚&lt;/li&gt;
&lt;li&gt;å¹³å°å›¢é˜Ÿå¿…é¡»ä»”ç»†é€‰æ‹©å…¶ä¼˜å…ˆäº‹é¡¹å’Œåˆå§‹åˆä½œä¼™ä¼´åº”ç”¨ç¨‹åºå›¢é˜Ÿã€‚&lt;/li&gt;
&lt;li&gt;å¹³å°å›¢é˜Ÿå¿…é¡»å¯»æ±‚ä¼ä¸šé¢†å¯¼çš„æ”¯æŒï¼Œå¹¶å±•ç¤ºå…¶å¯¹ä»·å€¼æµçš„å½±å“ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä¹Ÿè®¸æœ€é‡è¦çš„æ˜¯å°†å¹³å°ä½œä¸ºé¢å‘å®¢æˆ·çš„äº§å“ï¼Œå¹¶è®¤è¯†åˆ°å…¶æˆåŠŸç›´æ¥å–å†³äºå…¶ç”¨æˆ·å’Œäº§å“çš„æˆåŠŸï¼›å› æ­¤ï¼Œå¹³å°å›¢é˜Ÿä¸åº”ç”¨ç¨‹åºå›¢é˜Ÿå’Œå…¶ä»–ç”¨æˆ·åˆä½œä»¥ä¼˜å…ˆè€ƒè™‘ã€è§„åˆ’ã€å®æ–½å’Œè¿­ä»£å¹³å°çš„åŠŸèƒ½å’Œç”¨æˆ·ä½“éªŒæ˜¯è‡³å…³é‡è¦çš„ã€‚å‘å¸ƒåŠŸèƒ½å’Œä½“éªŒè€Œä¸è€ƒè™‘åé¦ˆæˆ–ä¾èµ–è‡ªä¸Šè€Œä¸‹çš„å‘½ä»¤æ¥å®ç°é‡‡ç”¨çš„å¹³å°å›¢é˜Ÿå‡ ä¹è‚¯å®šä¼šé‡åˆ°ç”¨æˆ·çš„é˜»åŠ›å’Œä¸æ»¡ï¼Œå¹¶é”™è¿‡äº†å¾ˆå¤šæ‰¿è¯ºçš„ä»·å€¼ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¹³å°å›¢é˜Ÿåº”è¯¥ä»ä¸€å¼€å§‹å°±åŒ…æ‹¬äº§å“ç»ç†ï¼Œåˆ†äº«è·¯çº¿å›¾ï¼Œæ”¶é›†åé¦ˆï¼Œå¹¶å…¨é¢äº†è§£å’Œä»£è¡¨å¹³å°ç”¨æˆ·çš„éœ€æ±‚ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨é‡‡ç”¨å¹³å°æ—¶ï¼Œé€‰æ‹©è¦å¯ç”¨çš„æ­£ç¡®èƒ½åŠ›å’Œä½“éªŒå¯èƒ½è‡³å…³é‡è¦ã€‚é€šå¸¸éœ€è¦ä¸”æ— å·®å¼‚çš„èƒ½åŠ›ï¼Œå¦‚ç®¡é“ã€æ•°æ®åº“å’Œå¯è§‚æµ‹æ€§ç­‰ï¼Œå¯èƒ½æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„èµ·ç‚¹ã€‚å¹³å°å›¢é˜Ÿè¿˜å¯ä»¥é€‰æ‹©é¦–å…ˆå…³æ³¨æœ‰é™æ•°é‡çš„å‚ä¸åº¦é«˜ä¸”æŠ€èƒ½å¨´ç†Ÿçš„åº”ç”¨ç¨‹åºå›¢é˜Ÿã€‚è¿™äº›å›¢é˜Ÿçš„è¯¦ç»†åé¦ˆå°†æ”¹å–„ç¬¬ä¸€ä¸ªå¹³å°ä½“éªŒï¼›è€Œè¿™äº›å›¢é˜Ÿçš„æˆå‘˜å°†å¸®åŠ©å®£ä¼ å’Œæ¨å¹¿å¹³å°ï¼Œä»¥å¸å¼•åç»­çš„é‡‡ç”¨è€…ã€‚&lt;/p&gt;
&lt;p&gt;æœ€åï¼Œåœ¨å¤§å‹ä¼ä¸šä¸­ï¼Œå¿«é€Ÿè·å¾—é¢†å¯¼æ”¯æŒå¯¹äºå¹³å°å›¢é˜Ÿè‡³å…³é‡è¦ã€‚è®¸å¤šä¼ä¸šé¢†å¯¼äººè®¤ä¸º IT åŸºç¡€è®¾æ–½æ˜¯ä¸å…¶ä¸»è¦ä»·å€¼æµä¸ç›¸å…³çš„å¼€æ”¯ï¼Œå¹¶å¯èƒ½è¯•å›¾é™åˆ¶åˆ†é…ç»™ IT å¹³å°çš„æˆæœ¬å’Œèµ„æºï¼Œå¯¼è‡´å®ç°æ•ˆæœä¸ä½³ã€æ‰¿è¯ºæœªå®ç°å’Œæ²®ä¸§ã€‚ä¸ºäº†å‡è½»è¿™ç§æƒ…å†µï¼Œå¹³å°å›¢é˜Ÿéœ€è¦å±•ç¤ºå…¶å¯¹äº§å“å’Œä»·å€¼æµå›¢é˜Ÿçš„ç›´æ¥å½±å“å’Œè”ç³»ï¼ˆå‚è§å‰ä¸¤æ®µï¼‰ï¼Œå°†å¹³å°å›¢é˜Ÿå‘ˆç°ä¸ºäº§å“å›¢é˜Ÿåœ¨å‘å®¢æˆ·æä¾›ä»·å€¼æ–¹é¢çš„æˆ˜ç•¥åˆä½œä¼™ä¼´ã€‚&lt;/p&gt;
&lt;h3 id=&#34;èµ‹èƒ½å¹³å°å›¢é˜Ÿ&#34;&gt;èµ‹èƒ½å¹³å°å›¢é˜Ÿ&lt;/h3&gt;
&lt;p&gt;ä»è¿™äº›æŒ‘æˆ˜ä¸­å¯ä»¥æ¸…æ¥šåœ°çœ‹å‡ºï¼Œå¹³å°å›¢é˜Ÿé¢ä¸´ç€è®¸å¤šä¸åŒçš„è´£ä»»ï¼Œè¿™äº›è´£ä»»å¯¼è‡´è®¤çŸ¥è´Ÿè·ã€‚ä¸åº”ç”¨ç¨‹åºå›¢é˜Ÿçš„åŒäº‹ä¸€æ ·ï¼Œé‡ç‚¹æ˜¯å°†å¹³å°å›¢é˜Ÿçš„ç²¾åŠ›é›†ä¸­åœ¨ä¸å…¶ç‰¹å®šä¸šåŠ¡ç›¸å…³çš„ä½“éªŒå’ŒåŠŸèƒ½ä¸Šã€‚å‡è½»å¹³å°å›¢é˜Ÿè´Ÿæ‹…çš„æ–¹æ³•åŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å¯»æ±‚å»ºç«‹æœ€è–„çš„å¯è¡Œå¹³å°å±‚ï¼Œä»¥è¦†ç›–æ¥è‡ªå—ç®¡ç†ä¾›åº”å•†çš„å®ç°&lt;/li&gt;
&lt;li&gt;åˆ©ç”¨å¼€æºæ¡†æ¶å’Œå·¥å…·åŒ…ï¼Œä¸ºåº”ç”¨ç¨‹åºå›¢é˜Ÿä½¿ç”¨åˆ›å»ºæ–‡æ¡£ã€æ¨¡æ¿å’Œç»„åˆ&lt;/li&gt;
&lt;li&gt;ç¡®ä¿å¹³å°å›¢é˜Ÿåœ¨å…¶é¢†åŸŸå’Œå®¢æˆ·æ•°é‡æ–¹é¢å¾—åˆ°é€‚å½“çš„äººå‘˜é…å¤‡&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;å¦‚ä½•è¡¡é‡å¹³å°çš„æˆåŠŸ&#34;&gt;å¦‚ä½•è¡¡é‡å¹³å°çš„æˆåŠŸ&lt;/h2&gt;
&lt;p&gt;ä¼ä¸šå°†å¸Œæœ›è¡¡é‡å…¶å¹³å°è®¡åˆ’æ˜¯å¦æä¾›äº†ä¸Šè¿°ä»·å€¼å’Œå±æ€§ã€‚æ­¤å¤–ï¼Œåœ¨æœ¬æ–‡ä¸­æˆ‘ä»¬å¼ºè°ƒå°†å†…éƒ¨å¹³å°è§†ä¸ºäº§å“çš„é‡è¦æ€§ï¼Œè€Œè‰¯å¥½çš„äº§å“ç®¡ç†å–å†³äºå®šé‡å’Œå®šæ€§æµ‹é‡äº§å“çš„æ€§èƒ½ã€‚ä¸ºäº†æ»¡è¶³è¿™äº›è¦æ±‚ï¼Œå†…éƒ¨å¹³å°å›¢é˜Ÿåº”ä¸æ–­æ”¶é›†ç”¨æˆ·åé¦ˆå’Œæµ‹é‡ç”¨æˆ·æ´»åŠ¨ã€‚&lt;/p&gt;
&lt;p&gt;ä¸å†…éƒ¨å¹³å°çš„å…¶ä»–æ–¹é¢ä¸€æ ·ï¼Œå¹³å°å›¢é˜Ÿåº”ä½¿ç”¨æœ€å°å¯è¡Œçš„å·¥ä½œé‡æ¥æ”¶é›†ä»–ä»¬éœ€è¦çš„åé¦ˆã€‚æˆ‘ä»¬å°†åœ¨è¿™é‡Œå»ºè®®åº¦é‡æ ‡å‡†ï¼Œä½†æœ€åˆç®€å•çš„è°ƒæŸ¥å’Œç”¨æˆ·è¡Œä¸ºåˆ†æå¯èƒ½æœ€æœ‰ä»·å€¼ã€‚&lt;/p&gt;
&lt;p&gt;æœ‰åŠ©äºä¼ä¸šå’Œå¹³å°å›¢é˜Ÿäº†è§£å…¶å¹³å°å½±å“çš„ç±»åˆ«åŒ…æ‹¬ä»¥ä¸‹å†…å®¹ï¼š&lt;/p&gt;
&lt;h3 id=&#34;ç”¨æˆ·æ»¡æ„åº¦å’Œç”Ÿäº§ç‡&#34;&gt;ç”¨æˆ·æ»¡æ„åº¦å’Œç”Ÿäº§ç‡&lt;/h3&gt;
&lt;p&gt;è®¸å¤šå¹³å°æ‰€å¯»æ±‚çš„ç¬¬ä¸€ä¸ªå“è´¨æ˜¯æé«˜ç”¨æˆ·ä½“éªŒï¼Œä»¥å¢åŠ ç”Ÿäº§åŠ›ã€‚åæ˜ ç”¨æˆ·æ»¡æ„åº¦å’Œç”Ÿäº§ç‡çš„æŒ‡æ ‡åŒ…æ‹¬ä»¥ä¸‹å†…å®¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ´»è·ƒç”¨æˆ·å’Œä¿ç•™ï¼šåŒ…æ‹¬æ‰€æä¾›çš„åŠŸèƒ½æ•°é‡å’Œç”¨æˆ·å¢é•¿ / æµå¤±&lt;/li&gt;
&lt;li&gt;â€œå‡€æ¨èå€¼â€ï¼ˆNPSï¼‰æˆ–å…¶ä»–è°ƒæŸ¥ï¼Œè¡¡é‡ç”¨æˆ·å¯¹äº§å“çš„æ»¡æ„åº¦&lt;/li&gt;
&lt;li&gt;å¼€å‘äººå‘˜ç”Ÿäº§åŠ›çš„åº¦é‡ï¼Œå¦‚ SPACE æ¡†æ¶ä¸­è®¨è®ºçš„é‚£äº›åº¦é‡ [ &lt;a href=&#34;https://queue.acm.org/detail.cfm?id=3454124&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;4&lt;/a&gt;]&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;ç»„ç»‡æ•ˆç‡&#34;&gt;ç»„ç»‡æ•ˆç‡&lt;/h3&gt;
&lt;p&gt;è®¸å¤šå¹³å°æ‰€å¯»æ±‚çš„å¦ä¸€ä¸ªå¥½å¤„æ˜¯ä¸ºå¤§é‡ç”¨æˆ·æä¾›å¸¸è§éœ€æ±‚çš„é«˜æ•ˆæ–¹æ³•ã€‚è¿™é€šå¸¸é€šè¿‡å¯ç”¨ç”¨æˆ·è‡ªåŠ©æœåŠ¡å’Œå‡å°‘æ‰‹åŠ¨æ­¥éª¤å’Œå¿…è¦çš„äººç±»å¹²é¢„æ¥å®ç°ï¼ŒåŒæ—¶å®æ–½ä¿éšœå®‰å…¨å’Œåˆè§„æ€§çš„æ”¿ç­–ã€‚ä¸ºäº†è¡¡é‡å¹³å°åœ¨å‡å°‘å¸¸è§å·¥ä½œæ–¹é¢çš„æ•ˆç‡ï¼Œè¯·è€ƒè™‘ä»¥ä¸‹æªæ–½ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä»è¯·æ±‚åˆ°æœåŠ¡æˆ–åŠŸèƒ½ï¼ˆå¦‚æ•°æ®åº“æˆ–æµ‹è¯•ç¯å¢ƒï¼‰çš„å±¥è¡Œçš„å»¶è¿Ÿ&lt;/li&gt;
&lt;li&gt;å°†å…¨æ–°çš„æœåŠ¡æ„å»ºå¹¶éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒæ‰€éœ€çš„å»¶è¿Ÿ&lt;/li&gt;
&lt;li&gt;æ–°ç”¨æˆ·æäº¤ç¬¬ä¸€æ¬¡ä»£ç æ›´æ”¹åˆ°å…¶äº§å“çš„æ—¶é—´&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;äº§å“å’ŒåŠŸèƒ½äº¤ä»˜&#34;&gt;äº§å“å’ŒåŠŸèƒ½äº¤ä»˜&lt;/h3&gt;
&lt;p&gt;å†…éƒ¨å¹³å°çš„æœ€ç»ˆç›®æ ‡æ˜¯æ›´å¿«åœ°å‘ä¸šåŠ¡å®¢æˆ·æä¾›ä¸šåŠ¡ä»·å€¼ï¼Œå› æ­¤è¡¡é‡å¯¹ä¼ä¸šè‡ªèº«äº§å“å’ŒåŠŸèƒ½å‘å¸ƒçš„å½±å“ï¼Œå¯ä»¥è¯æ˜å¹³å°çš„ç›®æ ‡å·²å¾—åˆ°å®ç°ã€‚Google çš„ DevOps ç ”ç©¶å’Œè¯„ä¼°ï¼ˆDORAï¼‰ç ”ç©¶æ‰€å»ºè®® [ &lt;a href=&#34;https://cloud.google.com/blog/products/devops-sre/the-2019-accelerate-state-of-devops-elite-performance-productivity-and-scaling&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;5&lt;/a&gt;] è·Ÿè¸ªä»¥ä¸‹åº¦é‡æ ‡å‡†ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;éƒ¨ç½²é¢‘ç‡&lt;/li&gt;
&lt;li&gt;å˜æ›´çš„é¢†å…ˆæ—¶é—´&lt;/li&gt;
&lt;li&gt;æœåŠ¡æ•…éšœåæ¢å¤æœåŠ¡çš„æ—¶é—´&lt;/li&gt;
&lt;li&gt;å˜æ›´çš„å¤±è´¥ç‡&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é€šå¸¸ï¼Œå¹³å°å›¢é˜Ÿçš„å…³é”®ç›®æ ‡æ˜¯å°†åŸºç¡€æ¶æ„å’Œå…¶ä»– IT èƒ½åŠ›ä¸ä¼ä¸šçš„ä»·å€¼æµ - å…¶äº§å“ - å¯¹é½ã€‚å› æ­¤ï¼Œç»„ç»‡çš„äº§å“å’Œåº”ç”¨ç¨‹åºçš„æˆåŠŸæ‰æ˜¯è¡¡é‡å¹³å°æˆåŠŸçš„çœŸæ­£æ ‡å‡†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å¹³å°çš„åŠŸèƒ½&#34;&gt;å¹³å°çš„åŠŸèƒ½&lt;/h2&gt;
&lt;p&gt;æ­£å¦‚æˆ‘ä»¬æ‰€æè¿°çš„ï¼Œç”¨äºäº‘åŸç”Ÿè®¡ç®—çš„å¹³å°æä¾›å’Œç»„åˆæ¥è‡ªè®¸å¤šæ”¯æŒæä¾›è€…çš„åŠŸèƒ½å’ŒæœåŠ¡ã€‚è¿™äº›æä¾›è€…å¯ä»¥æ˜¯åŒä¸€ä¼ä¸šå†…çš„å…¶ä»–å›¢é˜Ÿï¼Œä¹Ÿå¯ä»¥æ˜¯äº‘æœåŠ¡æä¾›å•†ç­‰ç¬¬ä¸‰æ–¹ã€‚ç®€è€Œè¨€ä¹‹ï¼Œå¹³å°ä»åŸºç¡€ &lt;em&gt;èƒ½åŠ›æä¾›è€…&lt;/em&gt; åˆ°å¹³å°ç”¨æˆ·ï¼ˆå¦‚åº”ç”¨ç¨‹åºå¼€å‘äººå‘˜ï¼‰çš„ä¸­é—´æ¡¥æ¢ï¼›åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œå®ç°å’Œæ‰§è¡Œæ‰€éœ€çš„å®‰å…¨æ€§ã€æ€§èƒ½ã€æˆæœ¬æ²»ç†å’Œä¸€è‡´çš„ä½“éªŒã€‚ä»¥ä¸‹å›¾å½¢è¯´æ˜äº†äº§å“ã€å¹³å°å’Œèƒ½åŠ›æä¾›è€…ä¹‹é—´çš„å…³ç³»ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-äº§å“å¹³å°å’Œèƒ½åŠ›æä¾›è€…ä¹‹é—´çš„å…³ç³»&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;äº§å“ã€å¹³å°å’Œèƒ½åŠ›æä¾›è€…ä¹‹é—´çš„å…³ç³»&#34; srcset=&#34;
               /blog/cncf-platforms-white-paper/platform_components_hue837dc598798d393310eb163b229102d_136246_aceae2f4a2b6670cf3a863651c7ff5da.webp 400w,
               /blog/cncf-platforms-white-paper/platform_components_hue837dc598798d393310eb163b229102d_136246_6b4dfe71a79ffe68e0f58c9a80d29733.webp 760w,
               /blog/cncf-platforms-white-paper/platform_components_hue837dc598798d393310eb163b229102d_136246_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/cncf-platforms-white-paper/platform_components_hue837dc598798d393310eb163b229102d_136246_aceae2f4a2b6670cf3a863651c7ff5da.webp&#34;
               width=&#34;760&#34;
               height=&#34;561&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      äº§å“ã€å¹³å°å’Œèƒ½åŠ›æä¾›è€…ä¹‹é—´çš„å…³ç³»
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬åœ¨æœ¬æ–‡ä¸­ç€é‡è®¨è®ºäº†å¦‚ä½•æ„å»ºè‰¯å¥½çš„å¹³å°å’Œå¹³å°å›¢é˜Ÿï¼›ç°åœ¨åœ¨æœ€åä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†æè¿°å¹³å°å®é™…ä¸Šå¯èƒ½æä¾›çš„èƒ½åŠ›ã€‚è¿™ä¸ªåˆ—è¡¨æ—¨åœ¨æŒ‡å¯¼å¹³å°æ„å»ºè€…ï¼Œå¹¶åŒ…æ‹¬å…¸å‹çš„äº‘åŸç”Ÿåº”ç”¨ç¨‹åºæ‰€éœ€çš„åŠŸèƒ½ã€‚æ­£å¦‚æˆ‘ä»¬ä¸€ç›´åœ¨å¼ºè°ƒçš„ï¼Œè‰¯å¥½çš„å¹³å°åæ˜ äº†å…¶ç”¨æˆ·çš„éœ€æ±‚ï¼Œå› æ­¤æœ€ç»ˆå¹³å°å›¢é˜Ÿåº”è¯¥ä¸å…¶ç”¨æˆ·ä¸€èµ·é€‰æ‹©å’Œä¼˜å…ˆè€ƒè™‘å¹³å°æ‰€æä¾›çš„åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;p&gt;èƒ½åŠ›å¯ä»¥åŒ…æ‹¬å‡ ä¸ª&lt;em&gt;ç‰¹æ€§&lt;/em&gt;ï¼Œæ„å‘³ç€çˆ¶èƒ½åŠ›åŸŸçš„æ–¹é¢æˆ–å±æ€§ã€‚ä¾‹å¦‚ï¼Œå¯è§‚æµ‹æ€§å¯èƒ½åŒ…æ‹¬ç”¨äºæ”¶é›†å’Œå‘å¸ƒåº¦é‡ã€è·Ÿè¸ªå’Œæ—¥å¿—ä»¥åŠè§‚å¯Ÿæˆæœ¬å’Œèƒ½æºæ¶ˆè€—çš„ç‰¹æ€§ã€‚åœ¨æ‚¨çš„ç»„ç»‡ä¸­è€ƒè™‘æ¯ä¸ªç‰¹æ€§æˆ–æ–¹é¢çš„éœ€æ±‚å’Œä¼˜å…ˆçº§ã€‚éšåçš„ CNCF å‡ºç‰ˆç‰©å¯èƒ½ä¼šè¿›ä¸€æ­¥æ‰©å±•æ¯ä¸ªåŸŸã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æ„å»ºäº‘åŸç”Ÿè®¡ç®—å¹³å°æ—¶è¦è€ƒè™‘ä»¥ä¸‹èƒ½åŠ›é¢†åŸŸï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ç”¨äºè§‚å¯Ÿå’Œé…ç½®äº§å“å’Œèƒ½åŠ›çš„ &lt;strong&gt;Web é—¨æˆ·&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;ç”¨äºè‡ªåŠ¨é…ç½®äº§å“å’Œèƒ½åŠ›çš„ &lt;strong&gt;APIs&lt;/strong&gt;ï¼ˆå’Œ CLIsï¼‰&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;â€œé»„é‡‘è·¯å¾„â€ æ¨¡æ¿å’Œæ–‡æ¡£&lt;/strong&gt;ï¼Œä»¥ä¾¿åœ¨äº§å“ä¸­å®ç°æœ€ä½³ä½¿ç”¨&lt;/li&gt;
&lt;li&gt;ç”¨äºæ„å»ºå’Œæµ‹è¯•æœåŠ¡å’Œäº§å“çš„&lt;strong&gt;è‡ªåŠ¨åŒ–&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;ç”¨äºäº¤ä»˜å’ŒéªŒè¯æœåŠ¡å’Œäº§å“çš„&lt;strong&gt;è‡ªåŠ¨åŒ–&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¼€å‘ç¯å¢ƒ&lt;/strong&gt;ï¼Œå¦‚æ‰˜ç®¡çš„ IDE å’Œè¿œç¨‹è¿æ¥å·¥å…·&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ä»ªå™¨å’Œä»ªè¡¨æ¿çš„æœåŠ¡å’Œäº§å“çš„&lt;strong&gt;å¯è§‚æµ‹æ€§&lt;/strong&gt;ï¼ŒåŒ…æ‹¬åŠŸèƒ½ã€æ€§èƒ½å’Œæˆæœ¬çš„è§‚å¯Ÿ&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŸºç¡€è®¾æ–½&lt;/strong&gt;æœåŠ¡ï¼ŒåŒ…æ‹¬è®¡ç®—è¿è¡Œæ—¶ã€å¯ç¼–ç¨‹ç½‘ç»œä»¥åŠå—å’Œå·å­˜å‚¨&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®&lt;/strong&gt;æœåŠ¡ï¼ŒåŒ…æ‹¬æ•°æ®åº“ã€ç¼“å­˜å’Œå¯¹è±¡å­˜å‚¨&lt;/li&gt;
&lt;li&gt;åŒ…æ‹¬ä»£ç†ã€é˜Ÿåˆ—å’Œäº‹ä»¶ç»‡ç‰©çš„&lt;strong&gt;æ¶ˆæ¯&lt;/strong&gt;å’Œäº‹ä»¶æœåŠ¡&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;èº«ä»½å’Œå¯†ç &lt;/strong&gt;ç®¡ç†æœåŠ¡ï¼Œä¾‹å¦‚æœåŠ¡å’Œç”¨æˆ·èº«ä»½å’Œæˆæƒã€è¯ä¹¦å’Œå¯†é’¥å‘è¡Œä»¥åŠé™æ€å¯†ç å­˜å‚¨&lt;/li&gt;
&lt;li&gt;åŒ…æ‹¬ä»£ç å’Œå·¥ä»¶çš„é™æ€åˆ†æã€è¿è¡Œæ—¶åˆ†æå’Œç­–ç•¥æ‰§è¡Œçš„&lt;strong&gt;å®‰å…¨&lt;/strong&gt;æœåŠ¡&lt;/li&gt;
&lt;li&gt;åŒ…æ‹¬å®¹å™¨é•œåƒå’Œç‰¹å®šè¯­è¨€åŒ…ã€è‡ªå®šä¹‰äºŒè¿›åˆ¶æ–‡ä»¶å’Œåº“ä»¥åŠæºä»£ç çš„&lt;strong&gt;å·¥ä»¶å­˜å‚¨&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä»¥ä¸‹è¡¨æ ¼æ—¨åœ¨å¸®åŠ©è¯»è€…é€šè¿‡æ¾æ•£ç›¸å…³ç°æœ‰ CNCF æˆ– CDF é¡¹ç›®æ¥ç†è§£æ¯ç§èƒ½åŠ›ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left&#34;&gt;èƒ½åŠ›&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;æè¿°&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;ç¤ºä¾‹ CNCF/CDF é¡¹ç›®&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ç”¨äºé…ç½®å’Œè§‚å¯Ÿèƒ½åŠ›çš„ Web é—¨æˆ·&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å‘å¸ƒæ–‡æ¡£ã€æœåŠ¡ç›®å½•å’Œé¡¹ç›®æ¨¡æ¿ã€‚å‘å¸ƒæœ‰å…³ç³»ç»Ÿå’Œèƒ½åŠ›çš„é¥æµ‹æ•°æ®ã€‚&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Backstageã€Skoonerã€Ortelius&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;è‡ªåŠ¨é…ç½®èƒ½åŠ›çš„ API&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ç”¨äºè‡ªåŠ¨åˆ›å»ºã€æ›´æ–°ã€åˆ é™¤å’Œè§‚å¯Ÿèƒ½åŠ›çš„ç»“æ„åŒ–æ ¼å¼ã€‚&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Kubernetesã€Crossplaneã€Operator Frameworkã€Helmã€KubeVela&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;é»„é‡‘è·¯å¾„æ¨¡æ¿å’Œæ–‡æ¡£&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ç”¨äºå¿«é€Ÿé¡¹ç›®å¼€å‘çš„è‰¯å¥½é›†æˆä»£ç å’Œèƒ½åŠ›çš„æ¨¡æ¿åŒ–ç»„åˆã€‚&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ArtifactHub&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ç”¨äºæ„å»ºå’Œæµ‹è¯•äº§å“çš„è‡ªåŠ¨åŒ–&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;è‡ªåŠ¨æ„å»ºå’Œæµ‹è¯•æ•°å­—äº§å“å’ŒæœåŠ¡ã€‚&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Tektonã€Jenkinsã€Buildpacksã€koã€Carvel&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ç”¨äºäº¤ä»˜å’ŒéªŒè¯æœåŠ¡çš„è‡ªåŠ¨åŒ–&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;è‡ªåŠ¨åŒ–å’Œè§‚å¯ŸæœåŠ¡çš„äº¤ä»˜ã€‚&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Argoã€Fluxã€Keptnã€Flaggerã€OpenFeature&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å¼€å‘ç¯å¢ƒ&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å¯ç”¨åº”ç”¨ç¨‹åºå’Œç³»ç»Ÿçš„ç ”ç©¶å’Œå¼€å‘ã€‚&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Devfileã€Nocalhostã€Telepresenceã€DevSpace&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;åº”ç”¨ç¨‹åºå¯è§‚æµ‹æ€§&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ä»ªè¡¨åº”ç”¨ç¨‹åºï¼Œæ”¶é›†å’Œåˆ†æé¥æµ‹æ•°æ®ï¼Œå¹¶å°†ä¿¡æ¯å‘å¸ƒç»™åˆ©ç›Šç›¸å…³è€…ã€‚&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;OpenTelemetryã€Jaegerã€Prometheusã€Thanosã€Fluentdã€Grafanaã€OpenCost&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;åŸºç¡€è®¾æ–½æœåŠ¡&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;è¿è¡Œåº”ç”¨ç¨‹åºä»£ç ã€è¿æ¥åº”ç”¨ç¨‹åºç»„ä»¶å¹¶ä¸ºåº”ç”¨ç¨‹åºæŒä¹…åŒ–æ•°æ®&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Kubernetesã€Kubevirtã€Knativeã€WasmEdgeCNIã€Istioã€Ciliumã€Envoyã€Linkerdã€CoreDNSRookã€Longhornã€Etcd&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æ•°æ®æœåŠ¡&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æŒä¹…åŒ–åº”ç”¨ç¨‹åºçš„ç»“æ„åŒ–æ•°æ®&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;TiKVã€Vitessã€SchemaHero&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æ¶ˆæ¯å’Œäº‹ä»¶æœåŠ¡&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ä½¿åº”ç”¨ç¨‹åºå¼‚æ­¥é€šä¿¡&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Strimziã€NATSã€gRPCã€Knativeã€Dapr&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;èº«ä»½å’Œå¯†ç æœåŠ¡&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ç¡®ä¿å·¥ä½œè´Ÿè½½å…·æœ‰å®šä½å™¨å’Œå¯†ç æ¥ä½¿ç”¨èµ„æºå’Œèƒ½åŠ›ã€‚ä½¿æœåŠ¡èƒ½å¤Ÿå‘å…¶ä»–æœåŠ¡è¯†åˆ«è‡ªå·±&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Dexã€External Secretsã€SPIFFE/SPIREã€Tellerã€cert-manager&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å®‰å…¨æœåŠ¡&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;è§‚å¯Ÿè¿è¡Œæ—¶è¡Œä¸ºå¹¶æŠ¥å‘Š / çº æ­£å¼‚å¸¸ã€‚éªŒè¯æ„å»ºå’Œå·¥ä»¶ä¸åŒ…å«æ¼æ´ã€‚æ ¹æ®ä¼ä¸šè¦æ±‚é™åˆ¶å¹³å°ä¸Šçš„æ´»åŠ¨ï¼›é€šçŸ¥å’Œ / æˆ–çº æ­£å¼‚å¸¸&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;Falcoã€In-totoã€KubeArmorã€OPAã€Kyvernoã€Cloud Custodian&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å·¥ä»¶å­˜å‚¨&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;å­˜å‚¨ã€å‘å¸ƒå’Œä¿æŠ¤ç”¨äºç”Ÿäº§çš„å†…ç½®å·¥ä»¶ã€‚ç¼“å­˜å’Œåˆ†æç¬¬ä¸‰æ–¹å·¥ä»¶ã€‚å­˜å‚¨æºä»£ç ã€‚&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ArtifactHubã€Harborã€Distributionã€Porter&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;æœ¯è¯­è¡¨&#34;&gt;æœ¯è¯­è¡¨&lt;/h2&gt;
&lt;p&gt;è¯·å‚è§ &lt;a href=&#34;https://glossary.cncf.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://glossary.cncf.io/&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å¹³å°&lt;/strong&gt;èšåˆèƒ½åŠ›ï¼Œä¸ºå¼€å‘äººå‘˜å’Œè¿è¥å•†å¼€å‘å’Œäº¤ä»˜äº§å“ã€æœåŠ¡å’Œåº”ç”¨ç¨‹åºæä¾›æœåŠ¡ã€‚å…³äºå®ƒæ—¨åœ¨æ”¯æŒçš„åœºæ™¯ï¼Œå¹³å°å¯èƒ½è¢«å‘½åä¸º â€œå¼€å‘äººå‘˜å¹³å°â€ã€â€œäº¤ä»˜å¹³å°â€ã€â€œåº”ç”¨ç¨‹åºå¹³å°â€ ç”šè‡³æ˜¯ â€œäº‘å¹³å°â€ã€‚è¾ƒæ—§çš„æœ¯è¯­ â€œå¹³å°å³æœåŠ¡â€ æˆ– PaaS çš„å†…æ¶µä¹Ÿå…·æœ‰å½±å“åŠ›ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å¹³å°&lt;/strong&gt;é€šè¿‡æä¾›å’Œç®¡ç†å…±åŒçš„èƒ½åŠ›ï¼Œä½¿å¼€å‘äººå‘˜å’Œè¿è¥äººå‘˜èƒ½å¤Ÿæ›´å¿«åœ°äº¤ä»˜åº”ç”¨ç¨‹åºå’ŒæœåŠ¡ã€‚å¹³å°æ˜¯å¹³å°ç”¨æˆ·å’Œå¹³å°èƒ½åŠ›æä¾›è€…ä¹‹é—´çš„æ¡¥æ¢ï¼Œå¹¶ç”±å¹³å°å›¢é˜Ÿæ„å»ºå’Œç»´æŠ¤ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å¹³å°èƒ½åŠ›æä¾›è€…&lt;/strong&gt;å¼€å‘å’Œç»´æŠ¤å¹³å°æä¾›çš„èƒ½åŠ›ã€‚æä¾›è€…å¯ä»¥æ˜¯å¤–éƒ¨ç»„ç»‡æˆ–å†…éƒ¨å›¢é˜Ÿï¼Œèƒ½åŠ›å¯ä»¥æ˜¯åŸºç¡€è®¾æ–½ã€è¿è¡Œæ—¶æˆ–å…¶ä»–æ”¯æŒæœåŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å¹³å°å·¥ç¨‹å¸ˆ&lt;/strong&gt;è´Ÿè´£å¼€å‘å’Œç»´æŠ¤ç•Œé¢å’Œå·¥å…·ï¼Œä»¥ä¾¿æ ¹æ®å¹³å°äº§å“ç»ç†æä¾›çš„è¦æ±‚å’Œè¯´æ˜ï¼Œåœ¨åº”ç”¨ç¨‹åºä¸­å¯ç”¨å¹³å°èƒ½åŠ›çš„é…ç½®å’Œé›†æˆã€‚å¹³å°å¼€å‘äººå‘˜é€šå¸¸åˆ†ç»„åœ¨å¹³å°å›¢é˜Ÿä¸­ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å¹³å°äº§å“ç»ç†&lt;/strong&gt;è´Ÿè´£äº†è§£å¹³å°ç”¨æˆ·çš„ä½“éªŒï¼Œå»ºç«‹æ¶µç›–å¹³å°äº§å“å·®è·ã€éœ€æ±‚å’Œæœºä¼šçš„è·¯çº¿å›¾ï¼Œå¹¶ç®¡ç†å¹³å°å›¢é˜Ÿçš„æ—¥å¸¸å·¥ä½œã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å¹³å°å›¢é˜Ÿ&lt;/strong&gt;è´Ÿè´£å¼€å‘å’Œç»´æŠ¤ä¸å¹³å°èƒ½åŠ›çš„æ¥å£å’Œä½“éªŒï¼Œå¦‚ Web é—¨æˆ·ã€è‡ªå®šä¹‰ API å’Œé»„é‡‘è·¯å¾„æ¨¡æ¿ã€‚å¹³å°å›¢é˜Ÿç”±å¹³å°äº§å“ç»ç†ç®¡ç†ï¼Œå¹¶æ¶‰åŠå¹³å°å¼€å‘äººå‘˜ã€‚éšç€å¹³å°çš„å‘å±•å’Œè¶Šæ¥è¶Šå…ˆè¿›ï¼Œå…¶ä»–è§’è‰²ä¹Ÿå¯ä»¥æˆä¸ºå¹³å°å›¢é˜Ÿçš„ä¸€éƒ¨åˆ†ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºè¿è¥å•†ã€QA åˆ†æå¸ˆã€UI/UX è®¾è®¡å¸ˆã€æŠ€æœ¯ä½œå®¶ã€å¼€å‘äººå‘˜å€¡å¯¼è€…ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å¹³å°ç”¨æˆ·&lt;/strong&gt;åŒ…æ‹¬ä½†ä¸é™äºåº”ç”¨ç¨‹åºå¼€å‘äººå‘˜å’Œè¿è¥äººå‘˜ã€æ•°æ®ç§‘å­¦å®¶ã€COTS è½¯ä»¶æ“ä½œå‘˜å’Œä¿¡æ¯å·¥ä½œè€… - åœ¨å¹³å°ä¸Šè¿è¡Œè½¯ä»¶æˆ–ä½¿ç”¨å¹³å°æä¾›çš„èƒ½åŠ›çš„ä»»ä½•äººã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æœ€è–„å¯è¡Œå¹³å°ï¼ˆTVPï¼‰&lt;/strong&gt; æ˜¯ç”± Matthew Skelton å’Œ Manuel Pais åœ¨ä¹¦ç± &lt;em&gt;Team Topologies&lt;/em&gt; ä¸­æœ€åˆå®šä¹‰çš„ä¸€ä¸ªæ¦‚å¿µã€‚å®šä¹‰è¯´ï¼šâ€œTVP æ˜¯åœ¨ä¿æŒå¹³å°å°çš„åŒæ—¶ç¡®ä¿å¹³å°æœ‰åŠ©äºåŠ é€Ÿå’Œç®€åŒ–å›¢é˜Ÿæ„å»ºå¹³å°çš„è½¯ä»¶äº¤ä»˜çš„è°¨æ…å¹³è¡¡ã€‚â€ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>å¦‚ä½•é™ä½å¯è§‚æµ‹æ€§å¸¦æ¥çš„è®¤çŸ¥è´Ÿè·</title>
      <link>https://lib.jimmysong.io/blog/reducing-the-cognitive-load-associated-with-observability/</link>
      <pubDate>Thu, 13 Apr 2023 17:32:17 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/reducing-the-cognitive-load-associated-with-observability/</guid>
      <description>&lt;p&gt;æœ¬æ–‡è¯‘è‡ªï¼š&lt;a href=&#34;https://thenewstack.io/reducing-the-cognitive-load-associated-with-observability/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Reducing the Cognitive Load Associated with Observability - The New Stack&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;è¯‘è€…æ³¨ï¼šæœ¬æ–‡è®¨è®ºäº†é™ä½å¯è§‚æµ‹æ€§å¯¹è®¤çŸ¥è´Ÿè·çš„å½±å“ã€‚åœ¨å¤„ç†å¤§é‡æ•°æ®æ—¶ï¼Œæˆ‘ä»¬éœ€è¦è¿‡æ»¤å’Œè½¬æ¢æ•°æ®ç‚¹ä»¥ç”Ÿæˆé€‚å½“çš„ä¿¡å·ï¼Œå¹¶ä¾èµ–è­¦æŠ¥ç³»ç»Ÿæ¥è¿›è¡Œäººç±»å¹²é¢„ã€‚æ¸¸æˆæ—¥æ˜¯æµ‹è¯•å“åº”èƒ½åŠ›çš„å¥½æœºä¼šã€‚åœ¨å›¢é˜Ÿä¸­åŸ¹å…»åä½œæ–‡åŒ–å¯¹æ¯ä¸ªäººçš„ç¦ç¥‰è‡³å…³é‡è¦ã€‚é€šè¿‡å®æ–½è¿™äº›ç­–ç•¥ï¼Œè½¯ä»¶å·¥ç¨‹å›¢é˜Ÿå¯ä»¥ç¡®ä¿ä»–ä»¬å…·å¤‡ä½¿ç”¨å’Œæœ‰æ•ˆç†è§£å¯è§‚æµ‹æ€§ä¿¡å·æ‰€éœ€çš„çŸ¥è¯†å’ŒæŠ€èƒ½ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;p&gt;ä½ èƒ½æƒ³è±¡åœ¨æ²¡æœ‰ç°ä»£å¯è§‚æµ‹å·¥å…·çš„æƒ…å†µä¸‹å¼€å‘æˆ–æ“ä½œåˆ†å¸ƒå¼ç³»ç»Ÿå—ï¼Ÿæˆ‘ä»¬çŸ¥é“å¯è§‚æµ‹æ€§æ˜¯ä¸€é¡¹å…³é”®çš„å®è·µï¼Œå¯ä»¥è®©æˆ‘ä»¬æé«˜ç³»ç»Ÿçš„å¯é æ€§ï¼Œå‡å°‘æœåŠ¡åœæœºæ—¶é—´ï¼Œå¯è§†åŒ–ä½¿ç”¨æ¨¡å¼ï¼Œæä¾›æ€§èƒ½è§è§£å¹¶ä¿ƒè¿›é—®é¢˜è§£å†³ã€‚&lt;/p&gt;
&lt;p&gt;éšç€è¿‡å»åå¹´å¾®æœåŠ¡æ¶æ„å’Œå…¨çƒâ€œshift leftâ€çš„æ„å›¾çš„å¹¿æ³›é‡‡ç”¨ï¼Œå·¥ç¨‹å¸ˆçš„è§’è‰²â€”â€”ä»å¼€å‘äººå‘˜å’Œè¿ç»´äººå‘˜åˆ°DevOpsã€ç«™ç‚¹å¯é æ€§å·¥ç¨‹å’Œå¹³å°å·¥ç¨‹â€”â€”å‘ç”Ÿäº†å·¨å¤§å˜åŒ–ã€‚è®¸å¤šäººè¢«èµ‹äºˆæ›´å¤šçš„è´£ä»»ï¼Œå¹¶å¢åŠ äº†å·¥ä½œé‡ã€‚&lt;/p&gt;
&lt;div class=&#34;alert-note-title&#34;&gt;
    &lt;p&gt;ä»€ä¹ˆæ˜¯ Shift leftï¼Ÿ&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;alert alert-note&#34;&gt;
    &lt;p&gt;&amp;ldquo;Shift left&amp;rdquo; æ˜¯ä¸€ç§è½¯ä»¶å¼€å‘æœ¯è¯­ï¼Œå®ƒæŒ‡çš„æ˜¯åœ¨å¼€å‘ç”Ÿå‘½å‘¨æœŸçš„æ—©æœŸé˜¶æ®µå¼•å…¥æµ‹è¯•å’Œå®‰å…¨æ€§æªæ–½ï¼Œä»¥ä¾¿æ›´æ—©åœ°å‘ç°å’Œä¿®å¤æ½œåœ¨é—®é¢˜ï¼Œä»è€Œå‡å°‘å¼€å‘æˆæœ¬å’Œå¢å¼ºäº§å“è´¨é‡ã€‚&lt;/p&gt;
&lt;p&gt;ä¼ ç»Ÿçš„è½¯ä»¶å¼€å‘è¿‡ç¨‹ä¸­ï¼Œæµ‹è¯•å’Œå®‰å…¨æ€§é€šå¸¸æ˜¯åœ¨å¼€å‘å‘¨æœŸçš„åæœŸæ‰è¢«è€ƒè™‘ï¼Œè¿™æ„å‘³ç€æ½œåœ¨çš„é—®é¢˜å¯èƒ½å·²ç»å­˜åœ¨äºç³»ç»Ÿä¸­å¹¶ä¸”éœ€è¦æ›´å¤šæ—¶é—´å’Œæˆæœ¬æ¥ä¿®å¤ã€‚è€Œâ€œShift leftâ€ æ„å‘³ç€åœ¨å¼€å‘è¿‡ç¨‹çš„æ—©æœŸå¼•å…¥è¿™äº›æ­¥éª¤ï¼Œä»¥ä¾¿æ›´å¿«åœ°å‘ç°å¹¶è§£å†³æ½œåœ¨çš„é—®é¢˜ã€‚&lt;/p&gt;

&lt;/div&gt;

&lt;p&gt;ä½œä¸ºè½¯ä»¶å·¥ç¨‹ç»„ç»‡ï¼Œæˆ‘ä»¬çš„å·¥ä½œæ˜¯æ„å»ºæ»¡è¶³ç‰¹å®šä¸šåŠ¡éœ€æ±‚çš„é«˜è´¨é‡ç³»ç»Ÿã€‚ä¸ºäº†å®ç°è¿™ä¸€ç›®æ ‡ï¼Œæˆ‘ä»¬å·²ç»å¯¹æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºè¿›è¡Œäº†ä»ªå™¨åŒ–ï¼Œè®¾ç½®äº†åˆ†å¸ƒå¼è·Ÿè¸ªä»¥åŠé›†ä¸­å¼æ—¥å¿—æ”¶é›†ï¼Œå¹¶ä¸æ–­ç›‘è§†å»¶è¿Ÿã€é”™è¯¯ç‡å’Œååé‡ï¼Œå¹¶åœ¨æ­¤ä¹‹ä¸Šè®¾ç½®äº†è­¦æŠ¥ã€‚ç°åœ¨å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥ä¾èµ–æˆ‘ä»¬ç»„ç»‡ä¸­çš„ä¸€ä¸ªè‹±é›„ä¸“å®¶æ¥å¤„ç†è­¦æŠ¥ï¼Œè¯Šæ–­ç³»ç»Ÿæ•…éšœå¹¶é˜²æ­¢åœæœºã€‚æˆ–è€…æˆ‘ä»¬å¯ä»¥å°†è¿™ç§çŸ¥è¯†ä¼ æ’­ç»™æ‰€æœ‰å·¥ç¨‹å¸ˆå¹¶åˆ†äº«å·¥ä½œè´Ÿè½½ã€‚&lt;/p&gt;
&lt;p&gt;è¦æ±‚æ¯ä¸ªäººéƒ½èƒ½ç†Ÿç»ƒæŒæ¡ç°æœ‰çš„å·¥å…·å’Œç†è§£ç”Ÿæˆçš„å¤§é‡æ•°æ®ä¸å¯é¿å…åœ°ä¼šå¯¼è‡´ç„¦è™‘ã€æ²®ä¸§å’Œç–²åŠ³ã€‚æˆ‘ä»¬èƒ½å¦ä»¥æŸç§æ–¹å¼é™ä½ä¸å¯è§‚æµ‹æ€§ç›¸å…³çš„è®¤çŸ¥è´Ÿè·ï¼Ÿ&lt;/p&gt;
&lt;h2 id=&#34;ç†è§£å¯è§‚æµ‹æ€§æ•°æ®&#34;&gt;ç†è§£å¯è§‚æµ‹æ€§æ•°æ®&lt;/h2&gt;
&lt;p&gt;å¯è§‚æµ‹æ€§æœ‰ä¸€äº›ç¡¬æŠ€èƒ½ã€‚å·¥ç¨‹å¸ˆéœ€è¦æ¥å—è®­ç»ƒä»¥è§£å¯†åŸºæœ¬æ•°æ®ç±»å‹ã€‚å¸Œæœ›å·¥å…·èƒ½åœ¨è¿™é¡¹ä»»åŠ¡ä¸­ååŠ©äººç±»ã€‚éš¾æ€ªæˆ‘ä»¬çœ‹åˆ°äº†å¤§é‡çš„ä¾›åº”å•†å·¥å…·æ¶Œç°ï¼Œæ—¨åœ¨æä¾›æœ€ä½³çš„è§£é‡Šå’Œå¯è§†åŒ–åˆ†å¸ƒå¼è·Ÿè¸ªã€æŒ‡æ ‡å’Œæ—¥å¿—ä½“éªŒã€‚è¿™æ˜¯ä¸€é¡¹å¤æ‚çš„ä»»åŠ¡ï¼åˆ†å¸ƒå¼è·Ÿè¸ªåªæ˜¯ä¸€å¤§å—é“¾æ¥æ—¶é—´æˆ³å’Œå…ƒæ•°æ®ï¼›æŒ‡æ ‡å¯ä»¥æ˜¯æµ‹é‡ä»ªã€è®¡æ•°å™¨æˆ–ç›´æ–¹å›¾ï¼›æ—¥å¿—è¯­å¥å¯ä»¥æ ¹æ®å—ä¼—å’Œä½¿ç”¨è€…è€Œæ˜¯ç»“æ„åŒ–æˆ–éç»“æ„åŒ–çš„ã€‚å³ä½¿æ˜¯æœ€å¸¸è§çš„æ—¥å¿—è¯­å¥åœ¨æ²¡æœ‰å—è¿‡åŸ¹è®­çš„äººçš„çœ¼ä¸­ä¹Ÿå¯èƒ½çœ‹èµ·æ¥å¾ˆé™Œç”Ÿã€‚åªè¦é—®é—®Javaå¼€å‘äººå‘˜å¦‚ä½•è§£å¼€Pythonå †æ ˆè·Ÿè¸ªï¼&lt;/p&gt;
&lt;p&gt;ç„¶åæˆ‘ä»¬é¢ä¸´â€œå¤ªå¤šæ•°æ®â€çš„é—®é¢˜ã€‚æˆ‘ä»¬ä¾èµ–å·¥å…·æ¥åœ¨å¤§æµ·æé’ˆå¹¶è¿‡æ»¤å™ªå£°ï¼Œå¹¶ä½¿å…¶æ¸…æ™°æ˜äº†ï¼Œå³åœ¨ä»»ä½•æ—¶å€™ï¼Œæ”¶é›†ä½†æœªåœ¨ä»»ä½•å¯è§†åŒ–ä¸­å…¬å¼€æˆ–ç”±ä»»ä½•è­¦æŠ¥ä½¿ç”¨çš„ä¿¡å·éƒ½æ˜¯åˆ é™¤çš„å€™é€‰ä¿¡å·ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä¿¡å·åœ¨å¤§æµ·ä¸­æ‰¾åˆ°è§¦å‘äº‹ä»¶çš„é’ˆå¤´&#34;&gt;ä¿¡å·ï¼šåœ¨å¤§æµ·ä¸­æ‰¾åˆ°è§¦å‘äº‹ä»¶çš„é’ˆå¤´&lt;/h3&gt;
&lt;p&gt;éœ€è¦è¿‡æ»¤å’Œè½¬æ¢æ•°æ®ç‚¹æ‰èƒ½ç”Ÿæˆé€‚å½“çš„ä¿¡å·ã€‚æ²¡æœ‰äººæƒ³æ¯å¤©24x7å°æ—¶ç›¯ç€ä»ªè¡¨æ¿æˆ–æ—¥å¿—ï¼Œå› æ­¤æˆ‘ä»¬ä¾èµ–è­¦æŠ¥ç³»ç»Ÿã€‚å½“è­¦æŠ¥è§¦å‘æ—¶ï¼Œå®ƒæ—¨åœ¨è¿›è¡Œäººç±»å¹²é¢„ï¼Œè¿™æ„å‘³ç€å°†åŸå§‹ä¿¡å·è½¬æ¢ä¸ºå¸¦æœ‰ä¸Šä¸‹æ–‡æ•°æ®çš„å¯æ“ä½œäº‹ä»¶ï¼šè­¦æŠ¥çš„é‡è¦æ€§ã€ç¯å¢ƒã€æè¿°ã€æ³¨é‡Šã€é“¾æ¥ç­‰ã€‚å¿…é¡»æä¾›è¶³å¤Ÿçš„ä¿¡æ¯æ¥å¼•èµ·å¯¹é—®é¢˜çš„å…³æ³¨ï¼Œä½†ä¸è¦æä¾›å¤ªå¤šçš„ä¿¡æ¯ä»¥é¿å…è¢«æ·¹æ²¡åœ¨å™ªéŸ³ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;é¡µé¢è­¦æŠ¥éœ€è¦äººå·¥å“åº”ã€‚å¦åˆ™ï¼Œå·¥ç¨‹å¸ˆå¦‚ä½•è¯æ˜ä»–ä»¬å·²ç»ä¸­æ–­äº†ä»–ä»¬çš„æµç¨‹ï¼Ÿ&lt;/p&gt;
&lt;p&gt;å½“è­¦æŠ¥è§¦å‘æ—¶ï¼Œåˆ†æå¼€å§‹äº†ã€‚è™½ç„¶æˆ‘ä»¬çƒ­åˆ‡åœ°å¸Œæœ›é€šè¿‡äººå·¥æ™ºèƒ½çš„å‡ºç°å®ç°å¼‚å¸¸æ£€æµ‹å’Œè‡ªåŠ¨åŒ–åˆ†æï¼Œä»è€Œå®Œå…¨æ¶ˆé™¤äººä¸ºå› ç´ ï¼Œä½†æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€äº›æŠ€å·§æ¥å¸®åŠ©æˆ‘ä»¬çš„å¤§è„‘å¿«é€Ÿè¯†åˆ«é—®é¢˜æ‰€åœ¨ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å¯è§†åŒ–ä¸è¦ä½ä¼°å¹³å°-äººç±»äº¤äº’çš„ä»·å€¼&#34;&gt;å¯è§†åŒ–ï¼šä¸è¦ä½ä¼°å¹³å°-äººç±»äº¤äº’çš„ä»·å€¼&lt;/h3&gt;
&lt;p&gt;éœ€è¦è­¦æŠ¥ä¿¡å·è§¦å‘çš„é˜ˆå€¼ã€‚åœ¨å¯è§†åŒ–æ–¹é¢ï¼Œè°ƒæŸ¥å’Œæ£€æµ‹å¼‚å¸¸çš„äººå‘˜ä¹Ÿéœ€è¦è€ƒè™‘è¿™äº›é˜ˆå€¼ã€‚è¿™ä¸ªæ•°æ®å€¼æ˜¯å¦è¿‡ä½æˆ–è€…å‡ºä¹æ„æ–™åœ°é«˜å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;åœ¨è¿™ä¸ªéå¸¸æ™®éçš„å›¾è¡¨ä¸­ï¼Œå›¾è¡¨æ ‡é¢˜ã€è½´æ ‡ç­¾å’Œæè¿°è¢«æ•…æ„åˆ é™¤äº†ã€‚æˆ‘ä»¬ç¼ºä¹ä¸Šä¸‹æ–‡ï¼Œä½†æˆ‘ä»¬çš„å¤§è„‘å¯ä»¥ç«‹å³å‘ç°å¼‚å¸¸ã€‚å¯¼è‡´å›¾è¡¨çš„è­¦æŠ¥åº”è¯¥å§‹ç»ˆåŒ…å«ä¸€ä¸ªè§†è§‰æŒ‡ç¤ºå™¨ã€‚å®ƒä»¬å¯¹äºçªå‡ºè¶‹åŠ¿å’Œå¼‚å¸¸æ¨¡å¼æ˜¯è‡³å…³é‡è¦çš„ï¼Œå³ä½¿å¯¹äºæœªå—è¿‡è®­ç»ƒçš„äººã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç§¯æå­¦ä¹ é¿å…è‹±é›„æ–‡åŒ–è®­ç»ƒä½ çš„å›¢é˜Ÿ&#34;&gt;ç§¯æå­¦ä¹ ï¼šé¿å…è‹±é›„æ–‡åŒ–ï¼›è®­ç»ƒä½ çš„å›¢é˜Ÿ&lt;/h2&gt;
&lt;p&gt;åœ¨å‡ºé—®é¢˜æ—¶ï¼Œä½ çš„å›¢é˜Ÿä¸­çš„è°æ˜¯äº‹å®ä¸Šçš„ç¬¬ä¸€å“åº”è€…å’Œå¯è§‚æµ‹æ€§ä¸“å®¶ï¼Œå½“äº‹æƒ…å˜å¾—ä¸å¥½æ—¶ä¼šæŒºèº«è€Œå‡ºå‘¢ï¼Ÿä¹Ÿè®¸æ˜¯ä½ ã€‚è¦æ±‚ä»–é€€ç¼©ï¼Œå°½ç®¡è¶Šæ¥è¶Šæ¸´æœ›æ¢å¤æœåŠ¡çš„æ­£å¸¸è¿è¡Œæ—¶é—´å¹¶æŒ½æ•‘å±€é¢ã€‚é—®é—®è‡ªå·±è¿™äº›é—®é¢˜ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æœ€åçš„æƒ…å†µæ˜¯ä»€ä¹ˆï¼Ÿ&lt;/li&gt;
&lt;li&gt;æ˜¯å¦ä¼šæœ‰å…¶ä»–äººæŒºèº«è€Œå‡ºï¼Ÿ&lt;/li&gt;
&lt;li&gt;è¿™å¯¹å›¢é˜Ÿä¸­å…¶ä»–äººæ¥è¯´æ˜¯ä¸ªå­¦ä¹ æœºä¼šå—ï¼Ÿ&lt;/li&gt;
&lt;li&gt;è¿™æ˜¯ä¸€ä¸ªæ•™å­¦æœºä¼šå—ï¼Ÿåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè·Ÿéšç»éªŒä¸°å¯Œçš„å›¢é˜Ÿæˆå‘˜çš„é˜´å½±å·¥ä½œæ˜¯å¦å¯è¡Œï¼Ÿ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è®©å…¶ä»–äººå˜å¾—æ“…é•¿å·¥ä½œã€‚è°ƒæ•´æœŸæœ›å¹¶ç»™è‡ªå·±å’Œå›¢é˜Ÿè°ƒæŸ¥çš„ç©ºé—´æ˜¯å‡è½»å‹åŠ›å’Œåº”å¯¹ç´§æ€¥æƒ…å†µçš„å…³é”®ã€‚åœ¨æ§åˆ¶çš„æ— å‹åŠ›ç¯å¢ƒä¸­å®æ—¶å“åº”çœŸå®äº‹ä»¶å’Œç”Ÿäº§ç³»ç»Ÿä¸­çš„æ•°æ®æ˜¯æœ€ç»ˆçš„è®­ç»ƒã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬æœ‰Game Daysã€‚&lt;/p&gt;
&lt;h3 id=&#34;game-days&#34;&gt;Game Days&lt;/h3&gt;
&lt;p&gt;æ¸¸æˆæ—¥æ˜¯æ¶ˆé˜²æ¼”ä¹ ã€‚æˆ‘ä»¬éœ€è¦æ¥å—æ•…éšœå’Œæ•…éšœå°†å‘ç”Ÿçš„äº‹å®ã€‚æ¸¸æˆæ—¥çš„ç›®æ ‡æ˜¯é€šè¿‡æå‰ç»ƒä¹ æˆ‘ä»¬çš„å“åº”èƒ½åŠ›æ¥å‡å°‘å®é™…äº‹ä»¶çš„å‹åŠ›ã€‚æˆ‘ä»¬å¸Œæœ›åœ¨å±æœºæ—¶èƒ½å¤Ÿå¿«é€Ÿè‡ªä¿¡åœ°è¡ŒåŠ¨ï¼Œå¹¶å»ºç«‹ä¸€äº›ç›´è§‰å’Œååº”èƒ½åŠ›ï¼Œè¿™äº›èƒ½åŠ›åœ¨å‡Œæ™¨4ç‚¹éå¸¸æœ‰ç”¨ã€‚ç»ƒä¹ ä½¿äººå®Œç¾ï¼&lt;/p&gt;
&lt;p&gt;é¦–å…ˆé€‰æ‹©ä¸€ä¸ªæ¸¸æˆå¤§å¸ˆå’Œå¿…è¦çš„åŒè°‹ã€‚é€šå¸¸ï¼Œè¿™äº›æ˜¯åŸŸæˆ–ç³»ç»Ÿçš„ä¸»é¢˜ä¸“å®¶ã€‚ä»–ä»¬éœ€è¦ä»”ç»†é€‰æ‹©åœ¨æ¸¸æˆæ—¥æ´»åŠ¨æœŸé—´å°†æ¥å—æµ‹è¯•çš„ç³»ç»Ÿå’Œåœºæ™¯ã€‚ä»¥ä¸‹æƒ…å†µéå¸¸æ™®éï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;é‡æ’­ä»¥å‰çš„äº‹ä»¶åœºæ™¯ã€‚è¿™ä¼šæµ‹è¯•äº‹ä»¶å“åº”è¿‡ç¨‹æ˜¯å¦å¾—åˆ°æ”¹è¿›ï¼Œäººä»¬æ˜¯å¦çŸ¥é“è¦å…³æ³¨å“ªäº›å¯è§‚æµ‹æ€§ä¿¡å·å¹¶äº†è§£å¦‚ä½•ç›¸å…³æ•°æ®ç‚¹ã€‚è¿™ä¹Ÿæ˜¯æµ‹è¯•åæœŸå­¦ä¹ å’Œçº æ­£è¡ŒåŠ¨åç³»ç»Ÿæ›´å…·å¼¹æ€§çš„å¥½æœºä¼šã€‚&lt;/li&gt;
&lt;li&gt;ç¡®ä¿ä¸€ä¸ªæ–°çš„ç³»ç»Ÿæˆ–æœåŠ¡åœ¨è¿›å…¥ç”Ÿäº§ä¹‹å‰å…·æœ‰æ­£ç¡®çš„ç›‘æ§ã€è­¦æŠ¥å’Œåº¦é‡è¡¡ã€‚è¿™ä¼šæµ‹è¯•æ‚¨æ˜¯å¦å‡†å¤‡å¥½æ“ä½œç³»ç»Ÿï¼Œä»¥åŠäººä»¬æ˜¯å¦çŸ¥é“å¦‚ä½•å‘ç°å¯è§‚æµ‹æ€§æ•°æ®å¹¶çŸ¥é“å¦‚ä½•å“åº”è­¦æŠ¥ã€‚&lt;/li&gt;
&lt;li&gt;æ ¡å‡†å®‰å…¨ã€ä¼˜é›…é™çº§ã€é«˜å¯ç”¨ç³»ç»Ÿç­‰æ–¹é¢çš„è¿‡åº¦è‡ªä¿¡åè§ã€‚è¿™ä¼šæµ‹è¯•æ‚¨æ˜¯å¦å®é™…äº†è§£ç³»ç»Ÿçš„æ•…éšœæ¨¡å¼ï¼Œä»¥åŠå·¥ç¨‹å¸ˆæ˜¯å¦æœ‰èƒ½åŠ›è¯Šæ–­æœªçŸ¥é—®é¢˜ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç„¶åè¦æ±‚æ¸¸æˆå¤§å¸ˆæå‡ºä¸€ç»„å‡è®¾å¹¶é¢„æµ‹æ¼”ä¹ çš„é¢„æœŸæ”¶ç›Šã€‚è¯„ä¼°æ¼”ä¹ å¯¹ä¸šåŠ¡çš„å½±å“ï¼ˆçˆ†ç‚¸åŠå¾„ï¼‰ï¼Œå¹¶ç¡®å®šå¦‚æœ/éœ€è¦é‡‡å–çš„æ­¥éª¤ä»¥å°†å…¶æœ€å°åŒ–ï¼ˆä¾‹å¦‚ï¼Œé€šè¿‡å°†æ¼”ä¹ é™åˆ¶åœ¨æ—¶é—´æ¡†ä¸­ï¼Œå¦‚æœå‘ç”Ÿæ„å¤–æƒ…å†µåˆ™ä¸­æ­¢å®ƒç­‰ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åå¼€å§‹æ¸¸æˆï¼æ•…æ„ç ´åå¹¶å¼•å…¥ä¸€äº›æ··ä¹±ã€‚æˆ‘ä»¬å¸Œæœ›äººä»¬åœ¨å¤„ç†äº‹ä»¶æ—¶ä¾é ç†æ€§ã€ä¸“æ³¨å’Œæ·±æ€ç†Ÿè™‘çš„è®¤çŸ¥åŠŸèƒ½ã€‚å‹åŠ›å’Œææƒ§ä¼šå½±å“è®¤çŸ¥åŠŸèƒ½å’Œå†³ç­–èƒ½åŠ›ã€‚&lt;/p&gt;
&lt;p&gt;è§‚å¯Ÿäººç±»äº’åŠ¨åœ¨è¿™ä¸ªè§£å†³é—®é¢˜çš„ç»ƒä¹ ä¸­å¦‚ä½•å‘æŒ¥ä½œç”¨ã€‚è¿™ä¸ªç»ƒä¹ æ˜¯å¦ä¿ƒè¿›äº†åä½œæ–‡åŒ–ï¼Ÿå›¢é˜Ÿæˆå‘˜æ˜¯å¦äº’ç›¸æ”¯æŒï¼Ÿ&lt;/p&gt;
&lt;h2 id=&#34;åä½œæ–‡åŒ–ä¸å†ä¿ç•™æ•°æ®&#34;&gt;åä½œæ–‡åŒ–ï¼šä¸å†ä¿ç•™æ•°æ®&lt;/h2&gt;
&lt;p&gt;åœ¨å›¢é˜Ÿä¸­åŸ¹å…»åä½œæ–‡åŒ–å¯¹æ¯ä¸ªäººçš„ç¦ç¥‰è‡³å…³é‡è¦ã€‚åˆ†äº«æ•°æ®ã€è§è§£å’Œé—®é¢˜å°†ä»å›¢é˜Ÿæˆå‘˜ä¸­è·å¾—æ›´å¤šçš„å‚ä¸ã€å¥½å¥‡å¿ƒå’Œä¿¡ä»»ã€‚ä¿¡æ¯åº”è¯¥è¢«å…±äº«ï¼Œåº”é¿å…ä¿å¯†ã€‚è¿™äº›æ˜¯ç®€å•çš„åŸåˆ™ï¼Œä½†å¾ˆå°‘æœ‰ç»„ç»‡ç¬¦åˆè¿™ä¸ªæ ‡å‡†ï¼Œå½“ä»äº‹äº‹æ•…å­¦ä¹ æ—¶ã€‚é€æ˜çš„åæœŸæ£€æŸ¥å¯ä»¥æ¨åŠ¨æœ‰æ„ä¹‰çš„å˜é©ï¼Œæˆ‘ä»¬åº”è¯¥åº†ç¥å¤±è´¥ï¼æŒ‡è´£å’ŒæŒ‡è´£çš„æ–‡åŒ–åªä¼šåŠ é€Ÿç„¦è™‘å’Œæ„å¤–çš„æ¶æ€§å¾ªç¯ã€‚&lt;/p&gt;
&lt;p&gt;æ¯ä¸ªäº‹ä»¶å“åº”è¿‡ç¨‹éƒ½åº”åŒ…æ‹¬äº‹åæ£€æŸ¥ã€‚æœ‰æ•ˆçš„æ— æŒ‡è´£äº‹åæ£€æŸ¥å°†ç¡®ä¿å›¢é˜Ÿæˆå‘˜æœ‰æƒæå‡ºå¯¹è¿‡ç¨‹ã€å·¥å…·æˆ–ç³»ç»Ÿçš„æ›´æ”¹ã€‚è¿™é¡¹æ´»åŠ¨é€šè¿‡çº æ­£æªæ–½å’Œè´¨é‡æ”¹è¿›ä½¿äººä»¬æœ‰èƒ½åŠ›åšå‡ºæ”¹å˜ã€‚åæœŸæ£€æŸ¥è¿˜åº”å—ç›Šäºç»„ç»‡ä¸­å¯èƒ½æ²¡æœ‰ç›´æ¥æ¶‰åŠé¢†å…ˆäº‹ä»¶çš„å…¶ä»–æˆå‘˜ï¼Œå› ä¸ºä¹¦é¢è®°å½•åº”è¯¥å¹¿æ³›å…±äº«å¹¶ä½œä¸ºå­¦ä¹ ææ–™ã€‚&lt;/p&gt;
&lt;h2 id=&#34;åœ¨å€¼ç­æ—¶&#34;&gt;åœ¨å€¼ç­æ—¶&lt;/h2&gt;
&lt;p&gt;å·¥ç¨‹å¸ˆæœ‰èƒ½åŠ›ç†è§£å¯è§‚æµ‹æ€§æ•°æ®ã€‚åœ¨å›¢é˜Ÿçš„æ¯ä¸ªæˆå‘˜éƒ½ç§¯æå­¦ä¹ å¦‚ä½•åº”å¯¹æ¸¸æˆæ—¥äº‹æ•…çš„æƒ…å†µä¸‹ï¼Œåˆ†äº«æ•´ä¸ªå·¥ç¨‹ç»„ç»‡çš„å€¼ç­ä»»åŠ¡éå¸¸é‡è¦ï¼Œè€Œä¸æ˜¯åªç”±å°‘æ•°ç²¾é€‰äººå‘˜è´Ÿè´£ã€‚è¿™ä¹Ÿæœ‰åŠ©äºå‡è½»å¯èƒ½éšæ—¶åˆ°æ¥çš„é‡è´Ÿå’Œå‹åŠ›ã€‚å½“å€¼ç­æ—¶ï¼Œä¸åº”è®©ä»»ä½•ä¸€åå·¥ç¨‹å¸ˆç‹¬è‡ªé¢å¯¹ã€‚è§’è‰²å’Œå‡çº§è·¯å¾„éœ€è¦æ˜ç¡®å®šä¹‰å’Œç†è§£ã€‚ä»ç¬¬ä¸€å“åº”è€…ï¼ˆ911è°ƒåº¦å‘˜ï¼‰åˆ°äº‹æ•…æŒ‡æŒ¥å®˜ï¼ˆä¸“ä¸šäººå£«ï¼‰å’Œå‡çº§ç»ç†ï¼ˆé€šå¸¸æ˜¯è´Ÿè´£æ²Ÿé€šçš„å·¥ç¨‹ç»ç†ï¼‰ï¼Œéƒ½ä¸åº”è¦æ±‚ä»–ä»¬æˆä¸ºè‹±é›„ï¼Œè€Œåº”è¦æ±‚ä»–ä»¬åè°ƒå’Œç»„è£…æœ€é€‚åˆè§£å†³é—®é¢˜çš„å›¢é˜Ÿã€‚&lt;/p&gt;
&lt;p&gt;åœ¨å€¼ç­æ—¶ï¼Œæ£€æŸ¥æ¸…å•å¯ä»¥è¢«ç§°ä¸ºâ€œè¿è¡Œç°¿â€æˆ–å…¶ä»–åç§°ã€‚è¿™äº›æ¸…å•å¯ä»¥ä½œä¸ºè®¤çŸ¥æ´åŠ©ï¼Œå¸è½½å®Œæˆå¤æ‚æ•™å­¦ä»»åŠ¡çš„æ€ç»´è¿‡ç¨‹ã€‚æ¸¸æˆæ—¥æ˜¯æµ‹è¯•è¿™äº›æ¸…å•çš„å®Œç¾åœºæ‰€ã€‚&lt;/p&gt;
&lt;p&gt;å› ä¸ºæˆ‘ä»¬å·²ç»é€šè¿‡æ¶ˆé™¤ä¿¡å·å™ªå£°æ¥ç¡®ä¿å‡å°‘è™šå‡è­¦æŠ¥ï¼Œå¹¶ä¸”æ¯ä¸ªäººéƒ½äº†è§£è‡ªå·±åœ¨å€¼ç­è½®æ¢ä¸­çš„è§’è‰²ï¼Œæ‰€ä»¥è­¦æŠ¥ç–²åŠ³åº”è¯¥æˆä¸ºè¿‡å»å¼ã€‚&lt;/p&gt;
&lt;h2 id=&#34;äººä»ç„¶æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿçš„æ ¸å¿ƒ&#34;&gt;äººä»ç„¶æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿçš„æ ¸å¿ƒ&lt;/h2&gt;
&lt;p&gt;é€šè¿‡å®æ–½è¿™äº›ç­–ç•¥ï¼Œè½¯ä»¶å·¥ç¨‹å›¢é˜Ÿå¯ä»¥ç¡®ä¿ä»–ä»¬å…·å¤‡ä½¿ç”¨å’Œæœ‰æ•ˆç†è§£å¯è§‚æµ‹æ€§ä¿¡å·æ‰€éœ€çš„çŸ¥è¯†å’ŒæŠ€èƒ½ã€‚å……åˆ†åˆ©ç”¨æ”¶é›†çš„æ•°æ®å¯¹äºæé«˜åˆ†å¸ƒå¼ç³»ç»Ÿçš„æ•´ä½“æ€§èƒ½å’Œå¯é æ€§è‡³å…³é‡è¦ã€‚æ•™å­¦å’Œå­¦ä¹ å°†ä½¿äººå› ç´ è¶…è¶Šå•ä¸ªä¸ªä½“ã€‚è™½ç„¶æˆ‘ä»¬ä»ç„¶å¿…é¡»ä¾é äººç±»å¤§è„‘æ¥è¯Šæ–­å’Œè§£å†³é—®é¢˜ï¼Œä½†è®©æˆ‘ä»¬ç¡®ä¿æˆ‘ä»¬å¯ä»¥å¯æŒç»­åœ°è¿™æ ·åšã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>åˆåˆ›å…¬å¸ Fermyon å‘å¸ƒ Spin 1.0 ç”¨äº WebAssembly æ— æœåŠ¡å™¨åº”ç”¨</title>
      <link>https://lib.jimmysong.io/blog/spin-wasm-ga/</link>
      <pubDate>Thu, 13 Apr 2023 16:27:22 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/spin-wasm-ga/</guid>
      <description>&lt;p&gt;æœ¬æ–‡è¯‘è‡ªï¼š&lt;a href=&#34;https://www.infoq.com/news/2023/04/first-version-spin-wasm/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Startup Fermyon Releases Spin 1.0 for WebAssembly Serverless Applications&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.fermyon.com/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Fermyon&lt;/a&gt; æœ€è¿‘å®£å¸ƒæ¨å‡º &lt;a href=&#34;https://github.com/fermyon/spin/releases/tag/v1.0.0&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Spin 1.0&lt;/a&gt;ï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨äºä½¿ç”¨ &lt;a href=&#34;https://webassembly.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;WebAssembly&lt;/a&gt; (Wasm) å¼€å‘æ— æœåŠ¡å™¨åº”ç”¨çš„å¼€æºå¼€å‘è€…å·¥å…·å’Œæ¡†æ¶ã€‚&lt;/p&gt;
&lt;p&gt;Spin 1.0 æ˜¯å…¶å»å¹´æ¨å‡º &lt;a href=&#34;https://www.fermyon.com/blog/introducing-spin&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä»‹ç»&lt;/a&gt; åçš„é¦–ä¸ªç¨³å®šç‰ˆæœ¬ã€‚åœ¨ 1.0 ç‰ˆæœ¬ä¸­ï¼Œå…¬å¸å¢åŠ äº†å¯¹æ–°ç¼–ç¨‹è¯­è¨€ï¼ˆå¦‚ JavaScriptã€TypeScriptã€Python æˆ– C#ï¼Œé™¤äº† Rust å’Œ Go ä¹‹å¤–ï¼‰ã€è¿æ¥æ•°æ®åº“ï¼ˆ&lt;a href=&#34;https://developer.fermyon.com/spin/rdbms-storage&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å…³ç³»å‹&lt;/a&gt; æˆ– &lt;a href=&#34;https://developer.fermyon.com/spin/redis-outbound&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Redis&lt;/a&gt;ï¼‰ã€ä½¿ç”¨æµè¡Œçš„æ³¨å†Œè¡¨æœåŠ¡åˆ†å‘åº”ç”¨ç¨‹åºï¼ˆ&lt;a href=&#34;https://ghcr.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;GitHub Container Registry&lt;/a&gt;ã€&lt;a href=&#34;https://hub.docker.com/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Docker Hub&lt;/a&gt; æˆ– &lt;a href=&#34;https://aws.amazon.com/ecr/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;AWS ECR&lt;/a&gt;ï¼‰ã€å†…ç½®çš„ &lt;a href=&#34;https://developer.fermyon.com/spin/kv-store&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;é”®å€¼å­˜å‚¨&lt;/a&gt; ä»¥ä¿æŒçŠ¶æ€ã€åœ¨ Kubernetes ä¸Šè¿è¡Œåº”ç”¨ç¨‹åºä»¥åŠä¸ &lt;a href=&#34;https://www.hashicorp.com/products/vault&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;HashiCorp Vault&lt;/a&gt; é›†æˆä»¥ç®¡ç†è¿è¡Œæ—¶é…ç½®ç­‰æ–¹é¢çš„æ”¯æŒã€‚&lt;/p&gt;
&lt;p&gt;é€šè¿‡ Spinï¼Œè¯¥å…¬å¸ä¸ºåˆ›å»ºè¿è¡Œ Wasm çš„åº”ç”¨ç¨‹åºæä¾›äº†è½»æ¾çš„å¼€å‘ä½“éªŒï¼ŒåŒ…æ‹¬éƒ¨ç½²å’Œå®‰å…¨è¿è¡Œå®ƒä»¬çš„æ¡†æ¶ã€‚&lt;/p&gt;
&lt;p&gt;Fermyon çš„é¦–å¸­æŠ€æœ¯å®˜ &lt;a href=&#34;https://twitter.com/matei_radu&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Radu Matei&lt;/a&gt; åœ¨ä¸€ç¯‡ &lt;a href=&#34;https://www.fermyon.com/blog/introducing-spin-v1&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;åšå®¢æ–‡ç« &lt;/a&gt; ä¸­è§£é‡Šé“ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Spin æ˜¯ä¸€ä¸ªå¼€æºçš„å¼€å‘è€…å·¥å…·å’Œæ¡†æ¶ï¼Œå®ƒå¸®åŠ©ç”¨æˆ·é€šè¿‡åˆ›å»ºã€æ„å»ºã€åˆ†å‘å’Œè¿è¡Œ Wasm çš„æ— æœåŠ¡å™¨åº”ç”¨ç¨‹åºã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ spin new åŸºäºèµ·å§‹æ¨¡æ¿åˆ›å»ºæ–°çš„åº”ç”¨ç¨‹åºï¼Œä½¿ç”¨ spin build å°†æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºç¼–è¯‘ä¸º Wasmï¼Œä½¿ç”¨ spin up åœ¨æœ¬åœ°è¿è¡Œåº”ç”¨ç¨‹åºã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/spin-wasm-ga/spin_huefc6270495e645aa615bde9e63e74048_206543_ed0bf52344ca50087edcabec354fab5a.webp 400w,
               /blog/spin-wasm-ga/spin_huefc6270495e645aa615bde9e63e74048_206543_b6a30d18d4ac6db3d72d36b8e309c6b0.webp 760w,
               /blog/spin-wasm-ga/spin_huefc6270495e645aa615bde9e63e74048_206543_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/spin-wasm-ga/spin_huefc6270495e645aa615bde9e63e74048_206543_ed0bf52344ca50087edcabec354fab5a.webp&#34;
               width=&#34;760&#34;
               height=&#34;369&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;&lt;em&gt;æ¥æºï¼š&lt;a href=&#34;https://www.fermyon.com/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://www.fermyon.com/&lt;/a&gt;&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;é™¤äº†åœ¨æœ¬åœ°è¿è¡Œ spin åº”ç”¨ç¨‹åºå¤–ï¼Œå¼€å‘äººå‘˜è¿˜å¯ä»¥å°†åº”ç”¨ç¨‹åºéƒ¨ç½²åˆ° &lt;a href=&#34;https://www.fermyon.com/cloud&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Fermyon äº‘&lt;/a&gt;ï¼ˆ&lt;a href=&#34;https://www.infoq.com/news/2022/11/Fermyon-cloud-webassembly/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å»å¹´å…¬å¼€æµ‹è¯•ç‰ˆå‘å¸ƒ&lt;/a&gt;ï¼‰ã€‚åœ¨ç™»å½• Fermyon Cloud åï¼Œä»–ä»¬å¯ä»¥åœ¨å­˜æ”¾å…¶åº”ç”¨ç¨‹åºçš„ spin.&lt;a href=&#34;https://toml.io/en/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;toml æ–‡ä»¶&lt;/a&gt; æ‰€åœ¨ç›®å½•ä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥éƒ¨ç½²å…¶åº”ç”¨ç¨‹åºï¼š&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;$ spin deploy&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æ­¤å¤–ï¼Œå¼€å‘äººå‘˜è¿˜å¯ä»¥é€‰æ‹© &lt;a href=&#34;https://developer.fermyon.com/spin/distributing-apps&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å°†åº”ç”¨ç¨‹åºæ¨é€åˆ°å®¹å™¨æ³¨å†Œè¡¨&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;InfoQ çš„ä¸€ä¸ª &lt;a href=&#34;https://www.infoq.com/podcasts/cloud-computing-web-assembly/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ’­å®¢&lt;/a&gt; ä¸­æåˆ°çš„ä¸€ä¸ªå…³é”®ç‚¹æ˜¯ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Spin æ˜¯ Fermyon çš„ä¸€ä¸ªå¼€æºå¼€å‘è€…å·¥å…·ï¼Œä¸“æ³¨äºå¿«é€Ÿè¿­ä»£çš„æœ¬åœ°å¼€å‘å‘¨æœŸï¼Œå…è®¸æ‚¨å¿«é€Ÿæ„å»ºåŸºäº WebAssembly çš„åº”ç”¨ç¨‹åºï¼Œè€Œæ— éœ€æ‹…å¿ƒéƒ¨ç½²ã€‚Spin æœ‰ä¸€ä¸ª Visual Studio Code æ’ä»¶ï¼Œç±»ä¼¼äº AWS Lambda ç­‰æ— æœåŠ¡å™¨äº‹ä»¶ç›‘å¬å™¨æ¨¡å‹ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¯¥å…¬å¸è®¡åˆ’åœ¨ä¸ä¹…çš„å°†æ¥ä½¿ç”¨ &lt;a href=&#34;https://github.com/bytecodealliance/preview2-prototyping&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;WASI Preview 2&lt;/a&gt; å’Œ &lt;a href=&#34;https://www.fermyon.com/blog/webassembly-component-model&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Wasm ç»„ä»¶æ¨¡å‹&lt;/a&gt;ã€‚æ­¤å¤–ï¼Œåœ¨ Reddit çš„ä¸€ä¸ª &lt;a href=&#34;https://www.reddit.com/r/WebAssembly/comments/123m4md/introducing_spin_10_the_developer_tool_for/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¸–å­&lt;/a&gt; ä¸­ï¼ŒMatei å›ç­”äº†ä¸€ä¸ªå…³äº Web æ”¯æŒçš„é—®é¢˜ï¼Œå¹¶æä¾›äº†æœªæ¥å‘å±•çš„æ›´å¤šç»†èŠ‚ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;åœ¨æœªæ¥ï¼Œæˆ‘ä»¬å¸Œæœ›å…è®¸ä» Spin è°ƒç”¨ Wasm ç»„ä»¶ï¼Œå¯ä»¥åœ¨æµè§ˆå™¨å†…æˆ–æµè§ˆå™¨å¤–ä½¿ç”¨ï¼Œä½† Spin çš„åŠŸèƒ½æ—¨åœ¨ç”¨äºéæµè§ˆå™¨åœºæ™¯ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Fermyon æ˜¯ä¼—å¤šæŠ•èµ„ WASM æŠ€æœ¯çš„å…¬å¸ä¹‹ä¸€ã€‚ä¾‹å¦‚ï¼ŒDocker æœ€è¿‘ &lt;a href=&#34;https://www.docker.com/blog/announcing-dockerwasm-technical-preview-2/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å®£å¸ƒ&lt;/a&gt; æ¨å‡ºäº† Docker+Wasm çš„é¦–ä¸ª &lt;a href=&#34;https://www.docker.com/blog/docker-wasm-technical-preview/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æŠ€æœ¯é¢„è§ˆç‰ˆ&lt;/a&gt;ï¼Œè¿™æ˜¯ä¸€ç§ç‹¬ç‰¹çš„æ„å»ºï¼Œä½¿å¾—å¯ä»¥ç”¨ WasmEdge è¿è¡Œæ—¶ä½¿ç”¨ Docker è¿è¡Œ Wasm å®¹å™¨ã€‚ä»ç‰ˆæœ¬ 4.15 å¼€å§‹ï¼Œæ¯ä¸ªäººéƒ½å¯ä»¥é€šè¿‡æ¿€æ´» &lt;a href=&#34;https://docs.docker.com/desktop/wasm/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;containerd image store å®éªŒåŠŸèƒ½&lt;/a&gt; æ¥å°è¯•è¿™äº›åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤å¤–ï¼Œä¸€ä¸ªåä¸º &lt;a href=&#34;https://github.com/containerd/runwasi&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;runwasi é¡¹ç›®&lt;/a&gt; æ˜¯ CNCF çš„ containerd ç”Ÿæ€ç³»ç»Ÿçš„ä¸€éƒ¨åˆ†ï¼Œå…è®¸å¼€å‘äººå‘˜é€šè¿‡ Kubernetes å†…éƒ¨çš„ containerd shim è¿è¡Œ WebAssembly è¿è¡Œæ—¶ã€‚&lt;/p&gt;
&lt;p&gt;æœ€åï¼Œæœ‰å…³ Spin çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯å¯åœ¨ &lt;a href=&#34;https://developer.fermyon.com/spin/quickstart&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ–‡æ¡£é¡µé¢&lt;/a&gt; ä¸Šæ‰¾åˆ°ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Tetrateæ¨å‡ºé’ˆå¯¹ Amazon EKS è®¾è®¡çš„æœåŠ¡ç½‘æ ¼è§£å†³æ–¹æ¡ˆTSE</title>
      <link>https://lib.jimmysong.io/blog/introducing-tetrate-service-express/</link>
      <pubDate>Thu, 13 Apr 2023 16:13:33 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/introducing-tetrate-service-express/</guid>
      <description>&lt;p&gt;Tetrate Service Express (TSE)æ˜¯ä¸€æ¬¾åŸºäºå¼€æºè½¯ä»¶çš„æœåŠ¡è¿æ¥ã€å®‰å…¨å’Œå¼¹æ€§è‡ªåŠ¨åŒ–è§£å†³æ–¹æ¡ˆï¼Œä¸“ä¸ºAmazon EKSè®¾è®¡ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡è¯‘è‡ªï¼š&lt;a href=&#34;https://tetrate.io/blog/introducing-tetrate-service-express/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tetrate Service Expressä»‹ç»&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;å¿«é€Ÿå®ç°amazon-eksä¸Šå®‰å…¨å’Œå¼¹æ€§çš„æœåŠ¡ç½‘æ ¼&#34;&gt;å¿«é€Ÿå®ç°Amazon EKSä¸Šå®‰å…¨å’Œå¼¹æ€§çš„æœåŠ¡ç½‘æ ¼&lt;/h2&gt;
&lt;p&gt;ä»Šå¤©æˆ‘ä»¬å¾ˆé«˜å…´åœ°å®£å¸ƒTetrate Service Express (TSE)ï¼Œè¿™æ˜¯ä¸€æ¬¾é’ˆå¯¹Amazon EKSçš„æœåŠ¡è¿æ¥ã€å®‰å…¨å’Œå¼¹æ€§è‡ªåŠ¨åŒ–è§£å†³æ–¹æ¡ˆã€‚æˆ‘ä»¬åŸºäºIstioå’ŒEnvoyç­‰å¼€æºæœåŠ¡ç½‘æ ¼ç»„ä»¶æ„å»ºäº†TSEï¼Œå¹¶é’ˆå¯¹AWSå¯¹TSEè¿›è¡Œäº†ç®€åŒ–å®‰è£…ã€é…ç½®å’Œæ“ä½œçš„ä¼˜åŒ–ã€‚å¦‚æœæ‚¨çš„å›¢é˜Ÿæ­£åœ¨AWSä¸Šè¿›è¡ŒæœåŠ¡ç½‘æ ¼å®éªŒï¼Œå¹¶ä¸”éœ€è¦å¿«é€Ÿè¯æ˜æŠ•èµ„å›æŠ¥ç‡ï¼Œè€Œæ— éœ€æŒæ¡å¤æ‚çš„Istioå’ŒAWSåŸºå…ƒï¼Œé‚£ä¹ˆTSEå°±æ˜¯é€‚åˆæ‚¨çš„é€‰æ‹©ï¼å¦‚æœæ‚¨çš„å›¢é˜Ÿå·²ç»åœ¨å•ä¸ªé›†ç¾¤ä¸Šæ‹¥æœ‰äº†æœåŠ¡ç½‘æ ¼ï¼Œä½†å¸Œæœ›å°†ç½‘æ ¼æ‰©å±•åˆ°å¤šä¸ªé›†ç¾¤ç”šè‡³åŒºåŸŸï¼Œé‚£ä¹ˆTSEä¹Ÿå¯ä»¥å¸®åŠ©æ‚¨ã€‚äº‹å®ä¸Šï¼ŒTSEæ˜¯å”¯ä¸€ä¸€æ¬¾åŸºäºå¼€æºè½¯ä»¶å¹¶é’ˆå¯¹AWSè¿›è¡Œä¼˜åŒ–çš„äº§å“ï¼Œé¢„å…ˆé›†æˆäº†æœ€å—æ¬¢è¿çš„AWSæœåŠ¡ï¼Œå¯åœ¨å‡ åˆ†é’Ÿå†…è®©æ‚¨ä¸Šæ‰‹ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæ‚¨æƒ³å¿«é€Ÿäº†è§£Tetrate Service Expressçš„åŠŸèƒ½ï¼Œåœ¨&lt;a href=&#34;https://tetr8.io/tse&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ­¤å¤„&lt;/a&gt;åŠ å…¥ç­‰å¾…åˆ—è¡¨ä»¥è·å–æ‚¨çš„è¯„ä¼°å‰¯æœ¬ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæ‚¨æƒ³æ·±å…¥äº†è§£Tetrate Service Expressçš„æ–°åŠŸèƒ½ï¼Œè¯·ç»§ç»­é˜…è¯»ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä¸ºä»€ä¹ˆé€‰æ‹©tetrate-service-express&#34;&gt;ä¸ºä»€ä¹ˆé€‰æ‹©Tetrate Service Express&lt;/h2&gt;
&lt;p&gt;å¦‚æœæ‚¨çš„ç»„ç»‡æƒ³è¦åˆ›é€ æ›´å¥½çš„å®¢æˆ·ä½“éªŒã€æé«˜è¿è¥æ•ˆç‡æˆ–ä¿æŠ¤çŸ¥è¯†äº§æƒï¼Œé‚£ä¹ˆå¾ˆå¯èƒ½å¿…é¡»æ„å»ºå’Œè¿è¡Œè½¯ä»¶â€”â€”æ›´é«˜è´¨é‡ã€æ›´å¿«é€Ÿçš„å‘å¸ƒã€æ›´å¥½çš„æ­£å¸¸è¿è¡Œæ—¶é—´ã€‚è€Œä¸”å¾ˆå¯èƒ½ï¼Œåº”ç”¨ç¨‹åºå¼€å‘å›¢é˜Ÿã€è¿è¥å›¢é˜Ÿå’Œå¹³å°å›¢é˜Ÿæ­£åœ¨å€ŸåŠ©ä¸¤ç§åˆ›æ–°è¶‹åŠ¿æ¥å®ç°è¿™äº›ç›®æ ‡ï¼šäº‘åŸºç¡€è®¾æ–½çš„çµæ´»æ€§å’Œå¾®æœåŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨äº‘ä¸­æ„å»ºå¾®æœåŠ¡æ—¶ï¼Œè®¸å¤šå›¢é˜Ÿé€‰æ‹©Amazon EKSçš„ä¾¿åˆ©æ€§ã€‚ç„¶è€Œï¼Œéšç€ä»–ä»¬æ‰©å±•EKSå·¥ä½œè´Ÿè½½ï¼Œä»–ä»¬ä¼šå‘ç°è‡ªå·±é¢ä¸´ä»¥ä¸‹é—®é¢˜ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚ä½•ä¿æŠ¤åˆ†å¸ƒåœ¨AWSä¸Šçš„å¾®æœåŠ¡ç»„ä»¶ï¼Ÿ&lt;/li&gt;
&lt;li&gt;å¦‚ä½•åœ¨æ›´æ–°æˆ–è´Ÿè½½ä¸‹å•ä¸ªç»„ä»¶å¤±è´¥æ—¶ä¿æŒå¯é æ€§ï¼Ÿ&lt;/li&gt;
&lt;li&gt;å½“ä¸€åˆ‡éƒ½æ˜¯åŠ¨æ€çš„ï¼Œæ‰‹åŠ¨é…ç½®ä¸å†èµ·ä½œç”¨æ—¶ï¼Œå¦‚ä½•ç®¡ç†æœåŠ¡ä¹‹é—´çš„æµé‡ï¼Ÿ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¶Šæ¥è¶Šå¤šçš„å¹³å°è¿è¥å›¢é˜Ÿä¼šåœ¨å¾®æœåŠ¡ä¹‹ä¸Šåˆ›å»ºä¸€ä¸ªä¸“ç”¨çš„åŸºç¡€è®¾æ–½å±‚â€”â€”æœåŠ¡ç½‘æ ¼â€”â€”å®ƒæä¾›äº†è·¨å¾®æœåŠ¡ç»„ä»¶çš„æœåŠ¡å‘ç°ã€å®‰å…¨æ€§ã€è®¤è¯å’Œå¯è§‚æµ‹æ€§ã€‚Istioå’ŒEnvoyæ˜¯æœåŠ¡ç½‘æ ¼æ§åˆ¶å¹³é¢å’Œæ•°æ®å¹³é¢çš„å¼€æºæ ‡å‡†ï¼Œä½†Istioå’ŒEnvoyåªæ˜¯éƒ¨åˆ†è§£å†³æ–¹æ¡ˆï¼Œå› ä¸ºå®ƒä»¬ä¸ºè¿è¡ŒAmazon EKSçš„å›¢é˜Ÿæ·»åŠ äº†æ–°çš„æ“ä½œå¤æ‚æ€§ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-amazon-eksä¸Šçš„æœåŠ¡ç½‘æ ¼æŒ‘æˆ˜&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Amazon EKSä¸Šçš„æœåŠ¡ç½‘æ ¼æŒ‘æˆ˜&#34; srcset=&#34;
               /blog/introducing-tetrate-service-express/image_hu5b2f4aea65b7ebe1bd5b4f5c12ade8c5_60235_c0d24116fa6490aecb425addd3959531.webp 400w,
               /blog/introducing-tetrate-service-express/image_hu5b2f4aea65b7ebe1bd5b4f5c12ade8c5_60235_b44a4e8d09cb9d4caa6181f64928ab8a.webp 760w,
               /blog/introducing-tetrate-service-express/image_hu5b2f4aea65b7ebe1bd5b4f5c12ade8c5_60235_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/introducing-tetrate-service-express/image_hu5b2f4aea65b7ebe1bd5b4f5c12ade8c5_60235_c0d24116fa6490aecb425addd3959531.webp&#34;
               width=&#34;760&#34;
               height=&#34;452&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      Amazon EKSä¸Šçš„æœåŠ¡ç½‘æ ¼æŒ‘æˆ˜
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;Tetrate Service Expressä¸ºå¹³å°å›¢é˜Ÿæä¾›äº†Istioå’ŒEnvoyä¹‹ä¸Šçš„æœåŠ¡ç½‘æ ¼è‡ªåŠ¨åŒ–ã€‚å®ƒå¤„ç†åœ¨Amazon EKSä¸Šå®‰è£…å’Œé…ç½®å¼€æºç»„ä»¶ï¼Œä¸AWSæœåŠ¡é›†æˆï¼Œå¹¶ä¸ºå¹³å°è¿è¥å•†æä¾›ç®¡ç†æ§åˆ¶å°ï¼Œä»¥å¿«é€Ÿé…ç½®æœåŠ¡ç½‘æ ¼ä»¥å®ç°å®‰å…¨ã€å¼¹æ€§å’Œå¯è§‚å¯Ÿæ€§ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-tetrate-service-expressæä¾›äº†ä¸€ç§ä¸€è‡´çš„å¯è‡ªåŠ¨åŒ–çš„æ–¹æ³•ç”¨äºåœ¨amazon-ekså†…éƒ¨å’Œè·¨amazon-eksè¿æ¥ä¿æŠ¤å’Œè§‚å¯ŸæœåŠ¡&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Tetrate Service Expressæä¾›äº†ä¸€ç§ä¸€è‡´çš„ã€å¯è‡ªåŠ¨åŒ–çš„æ–¹æ³•ï¼Œç”¨äºåœ¨Amazon EKSå†…éƒ¨å’Œè·¨Amazon EKSè¿æ¥ã€ä¿æŠ¤å’Œè§‚å¯ŸæœåŠ¡&#34; srcset=&#34;
               /blog/introducing-tetrate-service-express/image-1_hud387f18fb204c9034a906d87e98fddd1_351772_2d226316f988a0be5bd59d9ad5d9a0e9.webp 400w,
               /blog/introducing-tetrate-service-express/image-1_hud387f18fb204c9034a906d87e98fddd1_351772_89a458dee3ec3bfaaac97a83b11166be.webp 760w,
               /blog/introducing-tetrate-service-express/image-1_hud387f18fb204c9034a906d87e98fddd1_351772_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/introducing-tetrate-service-express/image-1_hud387f18fb204c9034a906d87e98fddd1_351772_2d226316f988a0be5bd59d9ad5d9a0e9.webp&#34;
               width=&#34;760&#34;
               height=&#34;427&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      Tetrate Service Expressæä¾›äº†ä¸€ç§ä¸€è‡´çš„ã€å¯è‡ªåŠ¨åŒ–çš„æ–¹æ³•ï¼Œç”¨äºåœ¨Amazon EKSå†…éƒ¨å’Œè·¨Amazon EKSè¿æ¥ã€ä¿æŠ¤å’Œè§‚å¯ŸæœåŠ¡
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h2 id=&#34;å¿«é€Ÿå®‰è£…amazon-ekså’Œé›†æˆawsæœåŠ¡&#34;&gt;å¿«é€Ÿå®‰è£…Amazon EKSå’Œé›†æˆAWSæœåŠ¡&lt;/h2&gt;
&lt;p&gt;è®©Istioåœ¨EKSä¸Šè¿è¡Œå¯èƒ½å˜å¾—æ›´åŠ å®¹æ˜“ï¼ˆä¾‹å¦‚ä½¿ç”¨&lt;a href=&#34;https://tetrate.io/blog/tid-add-on-for-eks/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tetrate Istio Distro EKS add-on&lt;/a&gt;ï¼‰ï¼Œä½†åœ¨æ‚¨å¯ä»¥æ“ä½œåŠŸèƒ½æ€§æœåŠ¡ç½‘æ ¼ä¹‹å‰ï¼Œè¿˜éœ€è¦å®Œæˆæ›´å¤šçš„å·¥ä½œï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚ä½•ç¡®ä¿æ‰€æœ‰æœåŠ¡ç½‘æ ¼ç»„ä»¶éƒ½å·²æ­£ç¡®å®‰è£…å’Œé…ç½®ï¼Ÿ&lt;/li&gt;
&lt;li&gt;å¦‚ä½•å®šä¹‰Istioå’ŒEnvoyå‘¨å›´çš„ç½‘ç»œåŸºç¡€æ¶æ„ï¼Œä»¥å®ç°å®‰å…¨çš„è·¨é›†ç¾¤è¿æ¥å’Œå¯ç”¨æ€§ï¼Ÿ&lt;/li&gt;
&lt;li&gt;å¦‚ä½•è§‚å¯Ÿå’Œæ’æŸ¥ç½‘æ ¼ä¸Šçš„æœåŠ¡ï¼Œä»¥ååŠ©æ‰©å±•å’Œä¼˜åŒ–ï¼Ÿ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;TSEå¯ä»¥ä½¿ç”¨Helm chatè½»æ¾å®‰è£…åœ¨EKSä¸Šï¼Œå¹¶ä¸Route 53å’ŒNLBï¼ˆæˆ–å…¶ä»–AWSè´Ÿè½½å¹³è¡¡å™¨ç±»å‹ï¼‰è½»æ¾é›†æˆï¼Œä»¥ä¾¿æ‚¨å¯ä»¥å¿«é€Ÿï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å®šä½æœåŠ¡çš„è¾¹ç¼˜å’Œå…¥å£ç½‘å…³ï¼Œä»¥ç®¡ç†å’Œå®‰å…¨åœ°æ§åˆ¶å…¥å£å’Œå‡ºå£æµé‡ã€‚&lt;/li&gt;
&lt;li&gt;é€šè¿‡å†…ç½®èº«ä»½éªŒè¯ã€é€Ÿç‡é™åˆ¶ã€HAå’Œå®‰å…¨æ€§æä¾›åº”ç”¨ç¨‹åºçš„APIã€‚&lt;/li&gt;
&lt;li&gt;è·å–æœåŠ¡å’Œåº”ç”¨ç¨‹åºçš„MELTï¼ˆåº¦é‡ã€äº‹ä»¶ã€æ—¥å¿—ã€è·Ÿè¸ªï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-ä½¿ç”¨tetrate-service-expresså’Œç¤ºä¾‹é…ç½®å¼€å§‹&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;ä½¿ç”¨Tetrate Service Expresså’Œç¤ºä¾‹é…ç½®å¼€å§‹&#34; srcset=&#34;
               /blog/introducing-tetrate-service-express/image-2_hu6edbc2dd43713e3c95f9bc0844ad92f5_305723_51b4f00bb585783dc54da5039c3aeb4c.webp 400w,
               /blog/introducing-tetrate-service-express/image-2_hu6edbc2dd43713e3c95f9bc0844ad92f5_305723_207639f761c4c3e399bdcb1962abc73e.webp 760w,
               /blog/introducing-tetrate-service-express/image-2_hu6edbc2dd43713e3c95f9bc0844ad92f5_305723_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/introducing-tetrate-service-express/image-2_hu6edbc2dd43713e3c95f9bc0844ad92f5_305723_51b4f00bb585783dc54da5039c3aeb4c.webp&#34;
               width=&#34;760&#34;
               height=&#34;372&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      ä½¿ç”¨Tetrate Service Expresså’Œç¤ºä¾‹é…ç½®å¼€å§‹
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h2 id=&#34;ä¸€æ­¥å¼æœåŠ¡é—´çš„mtlsåŠ å¯†&#34;&gt;ä¸€æ­¥å¼æœåŠ¡é—´çš„mTLSåŠ å¯†&lt;/h2&gt;
&lt;p&gt;æœåŠ¡ç½‘æ ¼çš„ç¬¬ä¸€ä¸ªç”¨ä¾‹ä¹‹ä¸€æ˜¯ä½¿ç”¨mTLSå¯ç”¨æœåŠ¡é—´åŠ å¯†ï¼Œä½†ä¸€æ—¦ä½ æ‰©å±•åˆ°å¤šä¸ªé›†ç¾¤ï¼Œäº‹æƒ…å°±ä¼šå¾ˆå¿«å˜å¾—å¤æ‚ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚ä½•åœ¨å„ä¸ªé›†ç¾¤ä¹‹é—´å»ºç«‹å’Œç®¡ç†å•ä¸ªä¿¡ä»»æ ¹ï¼Ÿ&lt;/li&gt;
&lt;li&gt;å¦‚ä½•åœ¨å…¨é¢æ”¯æŒé›¶ä¿¡ä»»å§¿æ€çš„æƒ…å†µä¸‹ï¼Œå¼ºåˆ¶æ‰§è¡ŒmTLSï¼Ÿ&lt;/li&gt;
&lt;li&gt;å¦‚ä½•å®šæœŸè½®æ¢è¯ä¹¦ï¼Œå¹¶åœ¨æ³„æ¼æˆ–æŸåè¯ä¹¦çš„æƒ…å†µä¸‹åšå‡ºå“åº”ï¼Ÿ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Tetrate Service Expressé€šè¿‡æä¾›ä»¥ä¸‹å†…å®¹ä½¿æœåŠ¡æ˜“äºåŠ å¯†å¹¶åº”ç”¨é›¶ä¿¡ä»»å§¿æ€ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å†…ç½®çš„æ˜“äºä½¿ç”¨çš„è¯ä¹¦é¢å‘æœºæ„ï¼Œå¯åœ¨æ‰€æœ‰ç¾¤é›†ä¸­è½®æ¢å’Œç®¡ç†è¯ä¹¦ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨ç®¡ç†çº§åˆ«ä¸Šå®šä¹‰å¯¹æ‰€æœ‰æœåŠ¡çš„mTLSéœ€æ±‚ã€‚&lt;/li&gt;
&lt;li&gt;ä»é»˜è®¤çš„æ‹’ç»æ‰€æœ‰å§¿æ€å¼€å§‹åˆ›å»ºç»†ç²’åº¦çš„è®¿é—®ç­–ç•¥ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-é»˜è®¤è®¾ç½®mtls&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;é»˜è®¤è®¾ç½®mTLS&#34; srcset=&#34;
               /blog/introducing-tetrate-service-express/image-3_hu6edbc2dd43713e3c95f9bc0844ad92f5_120424_6ce40b46a47c6bf173fe8257819be0d9.webp 400w,
               /blog/introducing-tetrate-service-express/image-3_hu6edbc2dd43713e3c95f9bc0844ad92f5_120424_f700eefbe053bf0cfb8c88295db4d22a.webp 760w,
               /blog/introducing-tetrate-service-express/image-3_hu6edbc2dd43713e3c95f9bc0844ad92f5_120424_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/introducing-tetrate-service-express/image-3_hu6edbc2dd43713e3c95f9bc0844ad92f5_120424_6ce40b46a47c6bf173fe8257819be0d9.webp&#34;
               width=&#34;760&#34;
               height=&#34;372&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      é»˜è®¤è®¾ç½®mTLS
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h2 id=&#34;é›†ç¾¤å’ŒåŒºåŸŸä¹‹é—´çš„æ˜“äºæ•…éšœè½¬ç§»è®¾ç½®&#34;&gt;é›†ç¾¤å’ŒåŒºåŸŸä¹‹é—´çš„æ˜“äºæ•…éšœè½¬ç§»è®¾ç½®&lt;/h2&gt;
&lt;p&gt;åœ¨å®šä¹‰åº”ç”¨ç¨‹åºåŸºç¡€æ¶æ„æ—¶ï¼Œè®¾ç½®æœåŠ¡çš„å†…éƒ¨é«˜å¯ç”¨æ€§å¯èƒ½æ˜¯æ¯”è¾ƒå¤æ‚çš„äº‹æƒ…ï¼Œç‰¹åˆ«æ˜¯åœ¨ä¸åŒçš„åŒºåŸŸå†…ã€‚ä¸€äº›å¯èƒ½é‡åˆ°çš„é—®é¢˜åŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚ä½•é…ç½®Route53ã€Amazonè´Ÿè½½å‡è¡¡å’Œå…¶ä»–è´Ÿè½½å‡è¡¡æœåŠ¡ï¼Œä»¥åœ¨ä¸åŒçš„é›†ç¾¤ä¹‹é—´å®ç°å¯é çš„HAï¼Ÿ&lt;/li&gt;
&lt;li&gt;å¦‚ä½•åœ¨æ²¡æœ‰Hairpinningçš„æƒ…å†µä¸‹è®¾ç½®è·¨é›†ç¾¤é€šä¿¡å’Œå†…éƒ¨é«˜å¯ç”¨æ€§ï¼Ÿ&lt;/li&gt;
&lt;li&gt;å½“æœåŠ¡å¤±è´¥æ—¶å¦‚ä½•è‡ªåŠ¨åŒ–ç½‘ç»œé…ç½®æ›´æ”¹ï¼Ÿ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Tetrate Service Expressé€šè¿‡æä¾›ä»¥ä¸‹åŠŸèƒ½ä½¿è·å–æœåŠ¡HAæ˜“äºå®ç°ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹æœåŠ¡å‘å¸ƒè¿›è¡Œè‡ªåŠ¨é…ç½®çš„å…¥å£ã€Amazonè´Ÿè½½å‡è¡¡å’ŒRoute 53ã€‚&lt;/li&gt;
&lt;li&gt;ä¸ºå†…éƒ¨é«˜å¯ç”¨æ€§è‡ªåŠ¨é…ç½®å†…éƒ¨å’Œä¸œ/è¥¿ç½‘å…³ã€‚&lt;/li&gt;
&lt;li&gt;åŠ¨æ€é‡æ–°é…ç½®ç½‘ç»œè§„åˆ™ï¼Œä»¥åœ¨æœ€å°ä¸­æ–­çš„æƒ…å†µä¸‹åœ¨é›†ç¾¤ä¹‹é—´å’Œä¹‹é—´ä¼ è¾“æµé‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-é…ç½®è·¨åŒºåŸŸæ•…éšœè½¬ç§»&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;é…ç½®è·¨åŒºåŸŸæ•…éšœè½¬ç§»&#34; srcset=&#34;
               /blog/introducing-tetrate-service-express/image-4_hue1b036012aa61af809eb8e728b9f7c49_191752_0afe42205722b79a9f67bdcd80cf2140.webp 400w,
               /blog/introducing-tetrate-service-express/image-4_hue1b036012aa61af809eb8e728b9f7c49_191752_22005613c5e7fcf59976b749256d71e4.webp 760w,
               /blog/introducing-tetrate-service-express/image-4_hue1b036012aa61af809eb8e728b9f7c49_191752_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/introducing-tetrate-service-express/image-4_hue1b036012aa61af809eb8e728b9f7c49_191752_0afe42205722b79a9f67bdcd80cf2140.webp&#34;
               width=&#34;760&#34;
               height=&#34;391&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      é…ç½®è·¨åŒºåŸŸæ•…éšœè½¬ç§»
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h2 id=&#34;æ¥ä¸‹æ¥&#34;&gt;æ¥ä¸‹æ¥&lt;/h2&gt;
&lt;p&gt;è¿™åªæ˜¯æˆ‘ä»¬è¦ä»Tetrate Service Expressä¸­çªå‡ºæ˜¾ç¤ºçš„ä¸€äº›åŠŸèƒ½ã€‚Tetrate Service Expresså°†åœ¨æœ¬æœˆæ™šäº›æ—¶å€™å‘å¸ƒæŠ€æœ¯é¢„è§ˆç‰ˆï¼Œä½†æ˜¯æ‚¨ç°åœ¨å¯ä»¥åŠ å…¥ç­‰å¾…åˆ—è¡¨ï¼Œä»¥åœ¨å‘å¸ƒæ—¶è·å–è¯„ä¼°å‰¯æœ¬ã€‚ä¸€æ—¦æ‚¨åŠ å…¥ç­‰å¾…åˆ—è¡¨ï¼Œæˆ‘ä»¬å°†ä¸æ‚¨è”ç³»ï¼Œå‘æ‚¨æä¾›è®¿é—®è¯„ä¼°è½¯ä»¶ã€æ–°æ–‡æ¡£é—¨æˆ·ç½‘ç«™å’ŒSlackç¤¾åŒºé¢‘é“çš„ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬è¿˜è®¡åˆ’æ¨å‡ºä¸€ç³»åˆ—é¢å¤–çš„åšå®¢ã€è§†é¢‘å’Œç½‘ç»œç ”è®¨ä¼šï¼Œä»¥å±•ç¤ºæ›´å¤šTSEçš„åŠŸèƒ½ã€‚ä¸‹ä¸€åœºç½‘ç»œç ”è®¨ä¼šå®šäº5æœˆä¸¾è¡Œï¼Œè¯·&lt;a href=&#34;https://app.livestorm.co/p/06a20bee-58b0-4976-977d-c2e4b16dbe68&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç«‹å³æ³¨å†Œ&lt;/a&gt;ã€‚æœ€åï¼Œè¯·ä¸è¦å¿˜è®°åœ¨&lt;a href=&#34;https://twitter.com/Tetrateio&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Twitter&lt;/a&gt;æˆ–&lt;a href=&#34;https://www.linkedin.com/company/tetrate&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;LinkedIn&lt;/a&gt;ä¸Šå…³æ³¨Tetrateï¼Œä»¥ä¾¿åœ¨æ–°çš„TSEå†…å®¹å¯ç”¨æ—¶è·å¾—å³æ—¶æ›´æ–°ï¼&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>å¦‚ä½•åœ¨ Kubernetes ä¸­å®ç°å¤šç§Ÿæˆ·éš”ç¦»ï¼šå‘½åç©ºé—´ã€RBAC å’Œç½‘ç»œç­–ç•¥çš„åº”ç”¨</title>
      <link>https://lib.jimmysong.io/blog/multi-tenancy-in-kubernetes/</link>
      <pubDate>Wed, 12 Apr 2023 22:00:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/multi-tenancy-in-kubernetes/</guid>
      <description>&lt;p&gt;æ‚¨æ˜¯å¦åº”è¯¥è®©å¤šä¸ªå›¢é˜Ÿä½¿ç”¨åŒä¸€ä¸ª Kubernetes é›†ç¾¤?&lt;/p&gt;
&lt;p&gt;æ‚¨æ˜¯å¦å¯ä»¥å®‰å…¨åœ°è¿è¡Œæ¥è‡ªä¸ä¿¡ä»»ç”¨æˆ·çš„ä¸ä¿¡ä»»å·¥ä½œè´Ÿè½½?&lt;/p&gt;
&lt;p&gt;Kubernetes æ˜¯å¦å…·å¤‡å¤šç§Ÿæˆ·åŠŸèƒ½?&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡å°†æ¢è®¨åœ¨è¿è¡Œå…·æœ‰å¤šä¸ªç§Ÿæˆ·çš„é›†ç¾¤æ—¶é¢ä¸´çš„æŒ‘æˆ˜ã€‚&lt;/p&gt;
&lt;p&gt;å¤šç§Ÿæˆ·å¯åˆ†ä¸º:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;è½¯å¤šç§Ÿæˆ·&lt;/strong&gt;ï¼Œé€‚ç”¨äºä¿¡ä»»æ‚¨çš„ç§Ÿæˆ· - æ¯”å¦‚ä¸åŒä¸€å®¶å…¬å¸çš„å›¢é˜Ÿå…±äº«é›†ç¾¤æ—¶ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¡¬å¤šç§Ÿæˆ·&lt;/strong&gt;ï¼Œé€‚ç”¨äºæ‚¨ä¸ä¿¡ä»»çš„ç§Ÿæˆ·ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ‚¨è¿˜å¯ä»¥æ··åˆä½¿ç”¨ï¼&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/multi-tenancy-in-kubernetes/1_hu1ba2525a22304766d59c2d554cb689cc_42403_8be670a4d09403ef1d8bbd9bb32526c0.webp 400w,
               /blog/multi-tenancy-in-kubernetes/1_hu1ba2525a22304766d59c2d554cb689cc_42403_0b38da7888587cb8e1b72f7bf1b77e27.webp 760w,
               /blog/multi-tenancy-in-kubernetes/1_hu1ba2525a22304766d59c2d554cb689cc_42403_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/multi-tenancy-in-kubernetes/1_hu1ba2525a22304766d59c2d554cb689cc_42403_8be670a4d09403ef1d8bbd9bb32526c0.webp&#34;
               width=&#34;760&#34;
               height=&#34;570&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;åœ¨ç§Ÿæˆ·ä¹‹é—´å…±äº«é›†ç¾¤çš„åŸºæœ¬æ„å»ºå—æ˜¯å‘½åç©ºé—´ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å‘½åç©ºé—´åœ¨é€»è¾‘ä¸Šå¯¹èµ„æºè¿›è¡Œåˆ†ç»„ï¼Œå®ƒä»¬ä¸æä¾›ä»»ä½•å®‰å…¨æœºåˆ¶ï¼Œä¹Ÿä¸èƒ½ä¿è¯æ‰€æœ‰èµ„æºéƒ½éƒ¨ç½²åœ¨åŒä¸€èŠ‚ç‚¹ä¸Šã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/multi-tenancy-in-kubernetes/2_hue9385cbb326ad8cc6e28ddf3db3c45fb_29266_c16b70fff870560bdef4f715ad591902.webp 400w,
               /blog/multi-tenancy-in-kubernetes/2_hue9385cbb326ad8cc6e28ddf3db3c45fb_29266_a04a31984867628003e3604ffd125459.webp 760w,
               /blog/multi-tenancy-in-kubernetes/2_hue9385cbb326ad8cc6e28ddf3db3c45fb_29266_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/multi-tenancy-in-kubernetes/2_hue9385cbb326ad8cc6e28ddf3db3c45fb_29266_c16b70fff870560bdef4f715ad591902.webp&#34;
               width=&#34;760&#34;
               height=&#34;570&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å‘½åç©ºé—´ä¸­çš„ Pod ä»ç„¶å¯ä»¥ä¸é›†ç¾¤ä¸­çš„æ‰€æœ‰å…¶ä»– Pod é€šä¿¡ï¼Œå‘ API å‘å‡ºè¯·æ±‚å¹¶ä½¿ç”¨å®ƒä»¬æƒ³è¦çš„ä»»ä½•èµ„æºã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;é»˜è®¤æƒ…å†µä¸‹ï¼Œä»»ä½•ç”¨æˆ·éƒ½å¯ä»¥è®¿é—®ä»»ä½•å‘½åç©ºé—´ã€‚&lt;/p&gt;
&lt;p&gt;é‚£åº”è¯¥æ€ä¹ˆé˜»æ­¢å®ƒï¼Ÿ&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/multi-tenancy-in-kubernetes/3_hu077a449ef860ae081034fb1a891eafa5_75040_7f3ed4537b40757d707b840117a2a282.webp 400w,
               /blog/multi-tenancy-in-kubernetes/3_hu077a449ef860ae081034fb1a891eafa5_75040_81cbb1e5d6f60a6de6483c0a04a2203b.webp 760w,
               /blog/multi-tenancy-in-kubernetes/3_hu077a449ef860ae081034fb1a891eafa5_75040_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/multi-tenancy-in-kubernetes/3_hu077a449ef860ae081034fb1a891eafa5_75040_7f3ed4537b40757d707b840117a2a282.webp&#34;
               width=&#34;760&#34;
               height=&#34;570&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://learnk8s.io/rbac-kubernetes&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;é€šè¿‡ RBACï¼Œæ‚¨å¯ä»¥é™åˆ¶ç”¨æˆ·å’Œåº”ç”¨ç¨‹åºå¯¹å‘½åç©ºé—´å†…å’Œå‘½åç©ºé—´ä¸­çš„å†…å®¹æ‰€èƒ½åšçš„äº‹æƒ…ã€‚&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å¸¸è§çš„æ“ä½œæ˜¯æˆäºˆæœ‰é™ç”¨æˆ·æƒé™ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/multi-tenancy-in-kubernetes/4_hub661c81d6ee4f738813c8aa9e1e27b51_63066_7772b7a18c90a9b6a5cc002b680cdb2e.webp 400w,
               /blog/multi-tenancy-in-kubernetes/4_hub661c81d6ee4f738813c8aa9e1e27b51_63066_1f74ecbaa6f3984563d5b7a4c61f6dae.webp 760w,
               /blog/multi-tenancy-in-kubernetes/4_hub661c81d6ee4f738813c8aa9e1e27b51_63066_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/multi-tenancy-in-kubernetes/4_hub661c81d6ee4f738813c8aa9e1e27b51_63066_7772b7a18c90a9b6a5cc002b680cdb2e.webp&#34;
               width=&#34;760&#34;
               height=&#34;570&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://kubernetes.io/docs/concepts/policy/resource-quotas/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä½¿ç”¨ Quotas å’Œ LimitRangesï¼Œæ‚¨å¯ä»¥é™åˆ¶å‘½åç©ºé—´ä¸­éƒ¨ç½²çš„èµ„æºä»¥åŠå¯ä»¥ä½¿ç”¨çš„å†…å­˜ã€CPU ç­‰ã€‚&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å¦‚æœæ‚¨æƒ³é™åˆ¶ç§Ÿæˆ·å¯¹å…¶å‘½åç©ºé—´æ‰€èƒ½åšçš„äº‹æƒ…ï¼Œè¿™æ˜¯ä¸€ä¸ªç»å¦™çš„æƒ³æ³•ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/multi-tenancy-in-kubernetes/5_hu6499faca5f886e074583a9f8331df280_109237_edc9d27b016383a30a35a4842d1cc269.webp 400w,
               /blog/multi-tenancy-in-kubernetes/5_hu6499faca5f886e074583a9f8331df280_109237_5d50702867b936b462a12fa9f7cc16fd.webp 760w,
               /blog/multi-tenancy-in-kubernetes/5_hu6499faca5f886e074583a9f8331df280_109237_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/multi-tenancy-in-kubernetes/5_hu6499faca5f886e074583a9f8331df280_109237_edc9d27b016383a30a35a4842d1cc269.webp&#34;
               width=&#34;760&#34;
               height=&#34;570&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰ Pod éƒ½å¯ä»¥ä¸ Kubernetes ä¸­çš„ä»»ä½• Pod é€šä¿¡ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å¯¹äºå¤šç§Ÿæˆ·æ¥è¯´è¿™ä¸æ˜¯å¾ˆå¥½ï¼Œä½†æ‚¨å¯ä»¥ä½¿ç”¨ &lt;a href=&#34;https://github.com/ahmetb/kubernetes-network-policy-recipes&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Network Policies&lt;/a&gt; æ¥æ›´æ­£ã€‚&lt;/p&gt;
&lt;p&gt;ç½‘ç»œç­–ç•¥ç±»ä¼¼äºé˜²ç«å¢™è§„åˆ™ï¼Œå¯è®©æ‚¨éš”ç¦»å‡ºç«™å’Œå…¥ç«™æµé‡ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/multi-tenancy-in-kubernetes/6_hu862518f285d537261db6689b14e8d640_36255_973156c6f0d82fba634d2f5d678354aa.webp 400w,
               /blog/multi-tenancy-in-kubernetes/6_hu862518f285d537261db6689b14e8d640_36255_0b455e6f1f46ad9a6f0ac70bcc0125d9.webp 760w,
               /blog/multi-tenancy-in-kubernetes/6_hu862518f285d537261db6689b14e8d640_36255_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/multi-tenancy-in-kubernetes/6_hu862518f285d537261db6689b14e8d640_36255_973156c6f0d82fba634d2f5d678354aa.webp&#34;
               width=&#34;760&#34;
               height=&#34;570&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;å¤ªå¥½äº†ï¼Œå‘½åç©ºé—´ç°åœ¨å®‰å…¨äº†å—ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ä¸è¦è¿™ä¹ˆå¿«ã€‚&lt;/p&gt;
&lt;p&gt;è™½ç„¶ RBACã€Network Policiesã€Quotas ç­‰ä¸ºå¤šç§Ÿæˆ·æä¾›äº†åŸºæœ¬æ„å»ºå—ï¼Œä½†è¿™è¿˜ä¸å¤Ÿã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Kubernetes æœ‰å‡ ä¸ªå…±äº«ç»„ä»¶ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­æ˜¯ Ingress æ§åˆ¶å™¨ï¼Œé€šå¸¸æ¯ä¸ªé›†ç¾¤éƒ¨ç½²ä¸€ä¸ªã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å¦‚æœæ‚¨æäº¤äº†ä¸€ä¸ªå…·æœ‰ç›¸åŒè·¯å¾„çš„ Ingress æ¨¡æ¿ï¼Œåˆ™æœ€åä¸€ä¸ªä¼šè¦†ç›–å®šä¹‰ï¼Œåªæœ‰ä¸€ä¸ªä¼šèµ·ä½œç”¨ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/multi-tenancy-in-kubernetes/7_hu4a71d94010fea551dc7853e1e139f84b_46397_7dae05f4bca1a296b14cf5e8b64d6af6.webp 400w,
               /blog/multi-tenancy-in-kubernetes/7_hu4a71d94010fea551dc7853e1e139f84b_46397_8ad625a94f7852d8cf17a741fbbb28cf.webp 760w,
               /blog/multi-tenancy-in-kubernetes/7_hu4a71d94010fea551dc7853e1e139f84b_46397_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/multi-tenancy-in-kubernetes/7_hu4a71d94010fea551dc7853e1e139f84b_46397_7dae05f4bca1a296b14cf5e8b64d6af6.webp&#34;
               width=&#34;760&#34;
               height=&#34;570&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;æœ€å¥½çš„æ–¹æ³•æ˜¯åœ¨æ¯ä¸ªå‘½åç©ºé—´ä¸­éƒ¨ç½²ä¸€ä¸ªæ§åˆ¶å™¨ã€‚&lt;/p&gt;
&lt;p&gt;å¦ä¸€ä¸ªæœ‰è¶£çš„æŒ‘æˆ˜æ˜¯ CoreDNSã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœå…¶ä¸­ä¸€ä¸ªç§Ÿæˆ·æ»¥ç”¨ DNS æ€ä¹ˆåŠï¼Ÿ&lt;/p&gt;
&lt;p&gt;æ•´ä¸ªé›†ç¾¤ä¹Ÿä¼šå—åˆ°å½±å“ã€‚&lt;/p&gt;
&lt;p&gt;æ‚¨å¯ä»¥ä½¿ç”¨é¢å¤–çš„æ’ä»¶ &lt;a href=&#34;https://github.com/coredns/policy&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://github.com/coredns/policy&lt;/a&gt; é™åˆ¶è¯·æ±‚ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/multi-tenancy-in-kubernetes/8_huc2ed24a69f9ba00299b10f901ff9b628_100826_9bc0e3b9b8e1ea5da2c2c02144c6462f.webp 400w,
               /blog/multi-tenancy-in-kubernetes/8_huc2ed24a69f9ba00299b10f901ff9b628_100826_b169727ac674437561a120f33a13ab73.webp 760w,
               /blog/multi-tenancy-in-kubernetes/8_huc2ed24a69f9ba00299b10f901ff9b628_100826_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/multi-tenancy-in-kubernetes/8_huc2ed24a69f9ba00299b10f901ff9b628_100826_9bc0e3b9b8e1ea5da2c2c02144c6462f.webp&#34;
               width=&#34;760&#34;
               height=&#34;570&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;åŒæ ·çš„æŒ‘æˆ˜ä¹Ÿé€‚ç”¨äº Kubernetes API æœåŠ¡å™¨ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Kubernetes ä¸çŸ¥é“ç§Ÿæˆ·ï¼Œå¦‚æœ API æ”¶åˆ°å¤ªå¤šè¯·æ±‚ï¼Œå°†å¯¹æ‰€æœ‰äººè¿›è¡Œé™æµã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä¸çŸ¥é“æ˜¯å¦æœ‰è§£å†³æ–¹æ³•ï¼&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/multi-tenancy-in-kubernetes/9_hu81c2164cdb8718d46984226eb3f16e3f_102950_d2fb3d8865d3075b8103dc953f5bf92d.webp 400w,
               /blog/multi-tenancy-in-kubernetes/9_hu81c2164cdb8718d46984226eb3f16e3f_102950_4fe79053e3854b968d344a27dc53a0d1.webp 760w,
               /blog/multi-tenancy-in-kubernetes/9_hu81c2164cdb8718d46984226eb3f16e3f_102950_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/multi-tenancy-in-kubernetes/9_hu81c2164cdb8718d46984226eb3f16e3f_102950_d2fb3d8865d3075b8103dc953f5bf92d.webp&#34;
               width=&#34;760&#34;
               height=&#34;570&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;å‡è®¾æ‚¨æˆåŠŸè§£å†³äº†å…±äº«èµ„æºçš„é—®é¢˜ï¼Œè¿˜æœ‰ kubelet å’Œå·¥ä½œè´Ÿè½½çš„æŒ‘æˆ˜ã€‚&lt;/p&gt;
&lt;p&gt;æ­£å¦‚ Philippe Bogaerts åœ¨&lt;a href=&#34;https://xxradar.medium.com/exploiting-applications-using-livenessprobes-in-kubernetes-cdff6329d320&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è¿™ç¯‡æ–‡ç« &lt;/a&gt;ä¸­æ‰€è§£é‡Šçš„é‚£æ ·ï¼Œä¸€ä¸ªç§Ÿæˆ·å¯ä»¥é€šè¿‡ (æ»¥) ä½¿ç”¨æ´»åŠ¨æ¢é’ˆæ¥æ¥ç®¡é›†ç¾¤ä¸­çš„èŠ‚ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;ä¿®å¤ä¸æ˜¯å¾®ä¸è¶³é“çš„ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/multi-tenancy-in-kubernetes/10_hu7a755d3d5d74cabd145f81462b798b99_38911_ddc7742ce6399dcb9c68d49bdd56ed66.webp 400w,
               /blog/multi-tenancy-in-kubernetes/10_hu7a755d3d5d74cabd145f81462b798b99_38911_ee9066e5ec1e4bd1649b5cdc96f47ea8.webp 760w,
               /blog/multi-tenancy-in-kubernetes/10_hu7a755d3d5d74cabd145f81462b798b99_38911_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/multi-tenancy-in-kubernetes/10_hu7a755d3d5d74cabd145f81462b798b99_38911_ddc7742ce6399dcb9c68d49bdd56ed66.webp&#34;
               width=&#34;760&#34;
               height=&#34;570&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;æ‚¨å¯ä»¥å°†ä»£ç è´¨é‡æ£€æŸ¥å™¨ä½œä¸º CI/CD è¿‡ç¨‹çš„ä¸€éƒ¨åˆ†ï¼Œæˆ–ä½¿ç”¨å‡†å…¥æ§åˆ¶å™¨éªŒè¯æäº¤åˆ°é›†ç¾¤çš„èµ„æºæ˜¯å¦å®‰å…¨ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/open-policy-agent/gatekeeper-library&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è¿™é‡Œæ˜¯ Open Policy Agent çš„è§„åˆ™åº“ã€‚&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/multi-tenancy-in-kubernetes/11_huc8b771eed9390505e1351169f02e58eb_51372_0aea9df3166362d973b0b69e3495e3c0.webp 400w,
               /blog/multi-tenancy-in-kubernetes/11_huc8b771eed9390505e1351169f02e58eb_51372_4c4db135658e3fa2f7e24bbcbb9e02fb.webp 760w,
               /blog/multi-tenancy-in-kubernetes/11_huc8b771eed9390505e1351169f02e58eb_51372_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/multi-tenancy-in-kubernetes/11_huc8b771eed9390505e1351169f02e58eb_51372_0aea9df3166362d973b0b69e3495e3c0.webp&#34;
               width=&#34;760&#34;
               height=&#34;570&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å®¹å™¨ä¹Ÿæä¾›äº†æ¯”è™šæ‹Ÿæœºæ›´å¼±çš„éš”ç¦»æœºåˆ¶ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.youtube.com/watch?v=JaMJJTb_bEE&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Lewis Denham-Parry åœ¨è¿™ä¸ªè§†é¢‘ä¸­å±•ç¤ºäº†å¦‚ä½•ä»å®¹å™¨ä¸­é€ƒè„±ã€‚&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è¯¥æ€ä¹ˆåŠï¼Ÿ&lt;/p&gt;
&lt;p&gt;æ‚¨å¯ä»¥ä½¿ç”¨å®¹å™¨æ²™ç®±ï¼Œä¾‹å¦‚ &lt;a href=&#34;https://gvisor.dev/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;gVisor&lt;/a&gt;ã€è½»é‡çº§è™šæ‹Ÿæœºä½œä¸ºå®¹å™¨ (&lt;a href=&#34;https://katacontainers.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Kata containers&lt;/a&gt;ã€&lt;a href=&#34;https://github.com/firecracker-microvm/firecracker-containerd&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;firecracker + containerd&lt;/a&gt;) æˆ–å…¨è™šæ‹Ÿæœº (&lt;a href=&#34;https://github.com/Mirantis/virtlet&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;virtlet ä½œä¸º CRI&lt;/a&gt;)ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/multi-tenancy-in-kubernetes/12_hu691464a6ae1a4dbe71972c3a0bbc55e2_67085_454e1949af62ff39d7ec81474e777171.webp 400w,
               /blog/multi-tenancy-in-kubernetes/12_hu691464a6ae1a4dbe71972c3a0bbc55e2_67085_02422f01a39f30f198505d19d6584bf7.webp 760w,
               /blog/multi-tenancy-in-kubernetes/12_hu691464a6ae1a4dbe71972c3a0bbc55e2_67085_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/multi-tenancy-in-kubernetes/12_hu691464a6ae1a4dbe71972c3a0bbc55e2_67085_454e1949af62ff39d7ec81474e777171.webp&#34;
               width=&#34;760&#34;
               height=&#34;570&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;å¸Œæœ›æ‚¨å·²ç»æ„è¯†åˆ°äº†è¿™ä¸ªä¸»é¢˜çš„å¤æ‚æ€§ä»¥åŠåœ¨ Kubernetes ä¸­æä¾›ä¸¥æ ¼çš„ç½‘ç»œã€å·¥ä½œè´Ÿè½½å’Œæ§åˆ¶å™¨ä¹‹é—´çš„åˆ†éš”è¾¹ç•Œçš„éš¾åº¦ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.jessfraz.com/post/hard-multi-tenancy-in-kubernetes/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä¸å»ºè®®åœ¨ Kubernetes ä¸­æä¾›ç¡¬å¤šç§Ÿæˆ·ã€‚&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœæ‚¨éœ€è¦ç¡¬å¤šç§Ÿæˆ·ï¼Œåˆ™å»ºè®®ä½¿ç”¨å¤šä¸ªé›†ç¾¤æˆ– Cluster-as-a-Service å·¥å…·ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/kubernetes-sigs/cluster-api&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Cluster API&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/openshift/hypershift&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;HyperShift&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/clastix/kamaji&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Kamaji&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://gardener.cloud/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Gardener&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¦‚æœæ‚¨å¯ä»¥å®¹å¿è¾ƒå¼±çš„å¤šç§Ÿæˆ·æ¨¡å‹ï¼Œä»¥æ¢å–ç®€å•å’Œä¾¿åˆ©ï¼Œåˆ™å¯ä»¥æ¨å‡ºæ‚¨çš„ RBACã€Quotas ç­‰è§„åˆ™ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ï¼Œæœ‰ä¸€äº›å·¥å…·å¯ä»¥ä¸ºæ‚¨æŠ½è±¡å‡ºè¿™äº›é—®é¢˜ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/kubernetes-sigs/cluster-api-provider-nested/tree/main/virtualcluster&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Virtual Cluster (wg-multitenancy)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.vcluster.com/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Vcluster&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/clastix/capsule&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Capsule&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/loft-sh/kiosk&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Kiosk&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æœ€åï¼Œå¦‚æœæ‚¨å–œæ¬¢è¿™ä¸ªä¸»é¢˜ï¼Œæ‚¨å¯èƒ½è¿˜ä¼šå–œæ¬¢ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Learnk8s åœ¨è¿è¡Œçš„ Kubernetes å·¥ä½œåŠ &lt;a href=&#34;https://learnk8s.io/training&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://learnk8s.io/training&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;è¿‡å»çš„ä¸»é¢˜é›†åˆ &lt;a href=&#34;https://twitter.com/danielepolencic/status/1298543151901155330&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://twitter.com/danielepolencic/status/1298543151901155330&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;æˆ‘æ¯å‘¨å‘å¸ƒçš„ Kubernetes é€šè®¯ &lt;a href=&#34;https://learnk8s.io/learn-kubernetes-weekly&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://learnk8s.io/learn-kubernetes-weekly&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>ä» Siri åˆ° ChatGPTï¼šå¤§æ•°æ®å…¬å¸å¦‚ä½•è¿æ¥ AI æ–°æµªæ½®</title>
      <link>https://lib.jimmysong.io/blog/the-next-wave-of-big-data-companies-in-the-age-of-chatgpt/</link>
      <pubDate>Tue, 11 Apr 2023 21:20:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/the-next-wave-of-big-data-companies-in-the-age-of-chatgpt/</guid>
      <description>&lt;div class=&#34;alert-note-title&#34;&gt;
    &lt;p&gt;è¯‘è€…æ³¨&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;alert alert-note&#34;&gt;
    è¿™ç¯‡æ–‡ç« æ¢è®¨äº†åœ¨äººå·¥æ™ºèƒ½æ—¶ä»£ï¼Œå¤§æ•°æ®å…¬å¸å¦‚ä½•é€‚åº”å’Œåˆ›æ–°ã€‚ä½œè€…é‡‡è®¿äº† Alation çš„è”åˆåˆ›å§‹äºº Aaron Kalbï¼Œäº†è§£äº†ä»–ä»¬çš„â€œæ•°æ®ç›®å½•â€å¹³å°ï¼Œä»¥åŠä»–å¯¹ ChatGPT ç­‰ç”Ÿæˆå‹ AI è½¯ä»¶çš„çœ‹æ³•ã€‚Kalb è®¤ä¸ºï¼Œç”Ÿæˆå‹ AI æ˜¯ä¸€ç§å‚¬åŒ–å‰‚ï¼Œæ¨åŠ¨äº†ä¸€æ³¢æ–°çš„æ•°æ®æ™ºèƒ½å…¬å¸çš„å‡ºç°ã€‚ä»–è¿˜åˆ†æäº†ç”Ÿæˆå‹ AI çš„ä¼˜åŠ¿å’ŒæŒ‘æˆ˜ï¼Œä»¥åŠå¦‚ä½•åˆ©ç”¨å®ƒæ¥æé«˜æ•°æ®è´¨é‡å’Œå¯ä¿¡åº¦ã€‚
&lt;/div&gt;

&lt;p&gt;å°±åƒäº‘è®¡ç®—å¼•å…¥äº†ä¸€ç³»åˆ—â€œå¤§æ•°æ®â€è§£å†³æ–¹æ¡ˆä¸€æ ·ï¼Œç”Ÿæˆå¼äººå·¥æ™ºèƒ½æ˜¯æ–°ä¸€æ³¢æ•°æ®æ™ºèƒ½å…¬å¸çš„å‚¬åŒ–å‰‚ã€‚&lt;/p&gt;
&lt;p&gt;è¿˜è®°å¾—â€œå¤§æ•°æ®â€è¿™ä¸ªæµè¡Œè¯­å—ï¼Ÿå®ƒåœ¨äº‘è®¡ç®—æ—¶ä»£å­•è‚²äº†è®¸å¤šæˆåŠŸçš„å…¬å¸ï¼Œå¦‚ Snowflakeã€Databricksã€DataStaxã€Splunk å’Œ Clouderaã€‚ä½†ç°åœ¨æˆ‘ä»¬å¤„äºäººå·¥æ™ºèƒ½æ—¶ä»£ï¼Œæ®è¯´æœºå™¨å­¦ä¹ è½¯ä»¶ç°åœ¨å·²ç»è¾¾åˆ°æˆ–æ¥è¿‘â€œæ™ºèƒ½â€äº†ï¼ˆå³ä½¿å®ƒå®¹æ˜“ &lt;a href=&#34;https://thenewstack.io/stopping-ai-hallucinations-for-enterprise-is-key-for-vectara/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;äº§ç”Ÿå¹»è§‰&lt;/a&gt; â€”â€”ä½†æ˜¯ï¼Œæˆ‘ä»¬æ‰€æœ‰äººä¸éƒ½æ˜¯å—ï¼Ÿï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å› æ­¤ï¼Œé‰´äºå½“å‰çš„äººå·¥æ™ºèƒ½çƒ­æ½®ï¼Œæˆ‘ä»¬æ˜¯å¦è¿˜éœ€è¦â€œå¤§æ•°æ®â€å…¬å¸æ¥å¯¹æ•°æ®è¿›è¡Œåˆ†ç±»å’Œç»„ç»‡å‘¢ï¼Ÿç°åœ¨AIä¸æ˜¯å¯ä»¥ä¸ºæˆ‘ä»¬åšåˆ°è¿™ä¸€ç‚¹å—ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ä¸ºäº†äº†è§£æ•°æ®å…¬å¸å¦‚ä½•é€‚åº”äººå·¥æ™ºèƒ½æ—¶ä»£ï¼Œæˆ‘é‡‡è®¿äº† &lt;a href=&#34;https://www.linkedin.com/in/akalb/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Aaron Kalb&lt;/a&gt;ï¼ŒAlationçš„è”åˆåˆ›å§‹äººä¹‹ä¸€ã€‚Alationå°†è‡ªå·±ç§°ä¸ºâ€œæ•°æ®æ™ºèƒ½â€å¹³å°ï¼Œå¹¶æ¨å¹¿äº†ä¸€ä¸ªåä¸ºâ€œæ•°æ®ç›®å½•ï¼ˆdata catalogï¼‰â€çš„æ¦‚å¿µã€‚è¿™å°†â€œæœºå™¨å­¦ä¹ ä¸äººç±»ç­–å±•ï¼ˆcurationï¼‰â€ç›¸ç»“åˆï¼Œåˆ›å»ºä¸€ä¸ªä¼ä¸šå…¬å¸çš„å®šåˆ¶æ•°æ®å­˜å‚¨åº“ã€‚&lt;/p&gt;
&lt;h2 id=&#34;chatgpt-åœ¨-2000-å¹´ä»£ä¸-siri-çš„ä¸åŒä¹‹å¤„&#34;&gt;ChatGPT åœ¨ 2000 å¹´ä»£ä¸ Siri çš„ä¸åŒä¹‹å¤„&lt;/h2&gt;
&lt;p&gt;åœ¨ä¸å‰ Oracle é«˜ç®¡ Satyen Sangani å…±åŒåˆ›ç«‹ Alation ä¹‹å‰ï¼ŒKalb æ›¾åœ¨ Apple å·¥ä½œï¼Œè´Ÿè´£ Siri è½¯ä»¶ã€‚Siri æˆ–è®¸æ˜¯ç¬¬ä¸€ä¸ªåº”ç”¨ AI è¯­è¨€å»ºæ¨¡çš„ä¸»æµè½¯ä»¶åº”ç”¨ã€‚å› æ­¤ï¼Œæˆ‘é—®ä»–å½“å‰çš„ç”Ÿæˆå¼ AI è½¯ä»¶ï¼ˆå¦‚ ChatGPT å’Œ Google Bardï¼‰ä¸ Siri åœ¨ 2000 å¹´ä»£æœ«æ‰€åšçš„æœ‰ä½•ä¸åŒã€‚&lt;/p&gt;
&lt;p&gt;â€œSiri å¼€å§‹æ—¶å¾ˆéš¾ï¼Œå› ä¸ºå½“æ—¶ä»–ä»¬æ²¡æœ‰å¯¹è¯è®­ç»ƒæ•°æ®ï¼Œâ€ä»–å›ç­”è¯´ã€‚â€œä»–ä»¬æ˜¯ç¬¬ä¸€ä¸ªè¯­éŸ³åŠ©æ‰‹ã€‚â€ Siri çš„è¯­è¨€æ¨¡å‹æ‰€è®­ç»ƒçš„è¯­æ–™åº“æ¯”ä»Šå¤©å¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMsï¼‰çš„è®­ç»ƒæ•°æ®å°å¾—å¤šï¼ŒKalb å°† Siri çš„è®­ç»ƒæ•°æ®ç§°ä¸ºâ€œæ–°é—»è¯­æ–™åº“â€ã€‚&lt;/p&gt;
&lt;p&gt;é™¤äº†ç›¸å¯¹è¾ƒå·®çš„è®­ç»ƒæ•°æ®å¤–ï¼ŒSiri å¹¶æ²¡æœ‰ä½¿ç”¨å¤ªå¤šçš„æœºå™¨å­¦ä¹ ã€‚Kalb è¯´ï¼ŒSiri åœ¨è¯­éŸ³åˆ°æ–‡æœ¬å’Œæ–‡æœ¬åˆ°æ„å›¾çš„ä½¿ç”¨ä¸­çŠ¯äº†å¾ˆå¤šé”™è¯¯ã€‚â€œæˆ‘è®¤ä¸ºç›´åˆ°ä»Šå¤©ï¼ŒSiriã€Alexaã€Cortana å’Œ Google åŠ©æ‰‹éƒ½åœ¨åŠªåŠ›ï¼Œâ€ä»–è¡¥å……é“ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä¸ºä»€ä¹ˆ-ai-ä¼šæœ‰å¹»è§‰&#34;&gt;ä¸ºä»€ä¹ˆ AI ä¼šæœ‰å¹»è§‰ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;è¯è™½å¦‚æ­¤ï¼Œç”Ÿæˆå¼ AI ä¹Ÿå¹¶éå®Œç¾æ— ç¼ºã€‚æˆ‘é—® Kalb ä»–å¯¹ ChatGPT å’Œ Bard ç­‰è½¯ä»¶å­˜åœ¨å¹»è§‰ï¼ˆè™šæ„äº‹å®ï¼‰é—®é¢˜çš„çœ‹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;Kalb æš—ç¤ºè¿™å¯¹ç”Ÿæˆå¼ AI çš„äººç±»ç”¨æˆ·è€Œè¨€æ›´åƒæ˜¯ä¸€ç§â€œå¿ƒç†ç°è±¡â€ï¼Œè€Œä¸æ˜¯è½¯ä»¶æœ¬èº«çš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;â€œå¯¹äºè®¸å¤šç§æç¤ºï¼Œå®ƒä¼¼ä¹çœŸçš„ç†è§£äº†æç¤ºå¹¶åˆ¶å®šäº†ç­”æ¡ˆï¼Œç„¶åå°†å…¶ç”¨è¯­è¨€è¡¨è¾¾å‡ºæ¥ï¼Œâ€ä»–è¯´ï¼Œå…³äº ChatGPT å’Œç±»ä¼¼è½¯ä»¶ã€‚â€œä»¤äººå°è±¡æ·±åˆ»ã€‚æˆ‘ä»¬è®¤ä¸ºå®ƒå…·æœ‰ç†è§£å’ŒçœŸæ­£çš„æ™ºèƒ½ã€‚å®ƒå®é™…ä¸Šæ˜¯åœ¨åšä»€ä¹ˆå‘¢ï¼Ÿå®ƒåŸºæœ¬ä¸Šæ˜¯ä¸€ä¸ªè¶…çº§å¤æ‚çš„é©¬å°”ç§‘å¤«æ¨¡å‹ï¼Œå®ƒè¯´ï¼Œå˜¿ï¼Œæ ¹æ®ä¹‹å‰è¯´çš„å•è¯ã€ä¹‹å‰çš„æç¤ºä»¥åŠä¹‹å‰çš„æ•´ä¸ªäº’è”ç½‘æ¦‚ç‡åˆ†å¸ƒï¼Œä¸‹ä¸€ä¸ªå•è¯æ˜¯ä»€ä¹ˆï¼Ÿâ€&lt;/p&gt;
&lt;p&gt;ä»–è®¤ä¸ºå¹»è§‰åœ¨æŸç§ç¨‹åº¦ä¸Šæ˜¯ AI è½¯ä»¶æ‰€â€œå¼ºåˆ¶â€äº§ç”Ÿçš„ï¼Œæœ‰æ—¶æ˜¯å› ä¸ºäººç±»æç¤ºä¸å¤Ÿå¥½ã€‚&lt;/p&gt;
&lt;p&gt;â€œå¹»è§‰ä¼¼ä¹æ˜¯ï¼Œç­‰ç­‰ï¼Œä½ åœ¨é€»è¾‘ä¸­é—´ç–¯äº†ï¼ä½†å®é™…ä¸Šï¼Œå®ƒåªæ˜¯ç®—æ³•çš„ä¸€ç§äº§ç‰©[â€¦]å®ƒæœ‰ä¸€ä¸ªå¯èƒ½å‡ºç°çš„æ‰€æœ‰å•è¯çš„åˆ†å¸ƒï¼Œç„¶åç”¨ä¸€äº›ç»Ÿè®¡éšæœºæ€§é€‰æ‹©ä¸€ä¸ªã€‚å½“å®ƒåˆ°è¾¾ä¸€ä¸ªç‚¹æ—¶ï¼Œå®ƒå¾ˆä¸å¹¸ï¼Œå¯ä»¥è¯´æ˜¯éšä¾¿é€‰äº†ä¸€ä¸‹ã€‚â€&lt;/p&gt;
&lt;h2 id=&#34;æ•°æ®æ™ºèƒ½å¦‚ä½•é€‚åº”-ai-æ™¯è§‚&#34;&gt;æ•°æ®æ™ºèƒ½å¦‚ä½•é€‚åº” AI æ™¯è§‚&lt;/h2&gt;
&lt;p&gt;é‚£ä¹ˆä»€ä¹ˆæ˜¯â€œæ•°æ®æ™ºèƒ½â€å‘¢ï¼ŸKalb å¼€å§‹å›ç­”æ—¶æŒ‡å‡ºï¼Œæ— è®ºæ˜¯ AI è¿˜æ˜¯å¸¸è§çš„ä¼ä¸šç¼©ç•¥è¯­ BIï¼ˆä¸šåŠ¡æ™ºèƒ½ï¼‰ï¼Œéƒ½æ˜¯â€œåƒåœ¾è¿›åƒåœ¾å‡ºâ€ã€‚&lt;/p&gt;
&lt;p&gt;â€œå› æ­¤ï¼Œæ•°æ®æ™ºèƒ½æ˜¯ AI å’Œ BI ä¹‹å‰çš„è¿™ä¸€å±‚ï¼Œå®ƒç¡®ä¿æ‚¨å¯ä»¥æ‰¾åˆ°ã€ç†è§£å’Œä¿¡ä»»æ­£ç¡®çš„æ•°æ®ï¼Œä»¥å°†å…¶æ”¾å…¥æ‚¨çš„ AI å’Œ BI ä¸­ã€‚â€&lt;/p&gt;
&lt;p&gt;åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä»–è¯´ï¼Œå°† ChatGPT ç­‰ä»å…¬å…±äº’è”ç½‘å¸¦å…¥ä¼ä¸šéå¸¸å±é™©ã€‚ä»–è®¤ä¸ºåœ¨ç”¨äºä¼ä¸šçš„ AI ç³»ç»Ÿä¹‹å‰ï¼Œæ•°æ®éœ€è¦æ›´åŠ æ™ºèƒ½ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤å¤–ï¼Œä»–è®¤ä¸ºä¼ä¸šä¸éœ€è¦ ChatGPT å’Œç±»ä¼¼ç³»ç»Ÿçš„â€œäº’è”ç½‘è§„æ¨¡â€ã€‚è¿™å°±æ˜¯ Alation çš„â€œæ•°æ®ç›®å½•â€å‘æŒ¥ä½œç”¨çš„åœ°æ–¹ï¼Œå› ä¸ºå®ƒå°†â€œæœºå™¨å­¦ä¹ ä¸äººç±»ç­–å±•â€ç›¸ç»“åˆï¼Œä»¥â€œç‰¹å®šæ˜ å°„â€å½¢å¼å°†æ•°æ®â€œç²¾ç®€â€ã€‚&lt;/p&gt;
&lt;p&gt;ä»–è¯´ï¼Œæ¯ä¸ªç»„ç»‡éƒ½æœ‰è‡ªå·±çš„æœ¯è¯­ï¼Œè¿™å¯èƒ½æ˜¯è¡Œä¸šæœ¯è¯­ï¼Œä¹Ÿå¯èƒ½æ˜¯éå¸¸ç‰¹å®šäºè¯¥å…¬å¸çš„äº‹æƒ…ã€‚&lt;/p&gt;
&lt;p&gt;â€œæ‰€ä»¥è¿™å°±æ˜¯æ•°æ®æ™ºèƒ½å’Œæ•°æ®ç›®å½•çš„ä½œç”¨ï¼Œâ€Kalb è§£é‡Šé“ã€‚â€œå®ƒæœ‰åŠ©äºæ˜ å°„ç»„ç»‡ä¸­äººä»¬ä½¿ç”¨è¯­è¨€çš„æœ€åä¸€å…¬é‡Œï¼Œä»¥åŠæ•°æ®åº“ä¸­å­˜å‚¨æ•°æ®çš„æ–¹å¼ã€‚â€&lt;/p&gt;
&lt;p&gt;Alation çš„è½¯ä»¶è‡ªåŠ¨åŒ–äº†å°†ç»„ç»‡çš„æ•°æ®æ”¾å…¥è¿™äº›â€œæ•°æ®ç›®å½•â€çš„è¿‡ç¨‹ï¼Œç„¶åå¯ä»¥é€‰æ‹©å°†å…¶é¦ˆé€åˆ°ç”Ÿæˆå¼ AI ç³»ç»Ÿä¸­ï¼ˆå¦‚æœå…¬å¸å¸Œæœ›è¿™æ ·åšï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;Kalb è§£é‡Šè¯´ï¼Œæ•°æ®æ™ºèƒ½æ˜¯â€œä»»åŠ¡çš„ç¬¬é›¶æ­¥â€”â€”æ— è®ºæ˜¯é¢„å¤„ç†ã€ML è®­ç»ƒï¼Œè¿˜æ˜¯åªæ˜¯åˆ¶ä½œç”µå­è¡¨æ ¼å¹¶åˆ†æè‚¡ä¸œä¼šè®®ã€‚â€&lt;/p&gt;
&lt;h2 id=&#34;æ¬¢è¿æ¥åˆ°ä¸‹ä¸€æ³¢å¤§æ•°æ®æµªæ½®&#34;&gt;æ¬¢è¿æ¥åˆ°ä¸‹ä¸€æ³¢å¤§æ•°æ®æµªæ½®&lt;/h2&gt;
&lt;p&gt;åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘å·²ç»ä¸åƒ Cohere å’Œ Vectara è¿™æ ·çš„ç”Ÿæˆå¼ AI å…¬å¸è°ˆè¿‡ä»–ä»¬å¯¹ä¼ä¸š IT æ„¿æ™¯çš„çœ‹æ³•ã€‚ä¸¤è€…éƒ½æåˆ°äº†å‘˜å·¥èƒ½å¤Ÿä¸åŸºäºå¤§å‹è¯­è¨€æ¨¡å‹è®­ç»ƒçš„ AI è¿›è¡Œå¯¹è¯çš„ç”¨ä¾‹â€”â€”ä»æœ¬è´¨ä¸Šè®²ï¼Œè¿™å°±æ˜¯ IT ä¼ ç»Ÿä¸Šæ‰€ç§°çš„â€œçŸ¥è¯†ç®¡ç†â€ï¼Œä½†ç°åœ¨å‘ˆç°ä¸ºèŠå¤©æœºå™¨äººå½¢å¼ã€‚&lt;/p&gt;
&lt;p&gt;Kalb æå‡ºäº†ä¸€ä¸ªå¾ˆå¥½çš„è§‚ç‚¹ï¼šå¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºç”Ÿæˆå¼ AI æ‰€æ¥å—çš„æ•°æ®çš„è´¨é‡ã€‚ä»–è®¤ä¸ºï¼Œæ•°æ®æ™ºèƒ½æ˜¯ ChatGPT å’Œâ€œæ‹¥æœ‰ä¼ä¸šé—¨æˆ·ï¼Œæ‚¨å¯ä»¥ç”¨è‹±è¯­æé—®å¹¶è·å¾—æœ‰å…³æ‚¨ä¸šåŠ¡çš„å‡†ç¡®ã€å¯ä¿¡èµ–çš„ç­”æ¡ˆâ€çš„æ¢¦æƒ³ä¹‹é—´çš„â€œç¼ºå¤±ç¯èŠ‚â€ã€‚&lt;/p&gt;
&lt;p&gt;å› æ­¤ï¼Œå°±åƒäº‘è®¡ç®—å¼•å…¥äº†ä¸€ç³»åˆ—æœ‰ç”¨çš„â€œå¤§æ•°æ®â€å…¬å¸ä¸€æ ·ï¼Œä¼¼ä¹æ˜ç¡®çš„æ˜¯ï¼Œç”Ÿæˆå¼ AI å°†æˆä¸ºä¸‹ä¸€æ³¢æ•°æ®æ™ºèƒ½è§£å†³æ–¹æ¡ˆçš„å‚¬åŒ–å‰‚ã€‚æ­£å¦‚æˆ‘ä»Šå¹´åœ¨ä¸ AI ç›¸å…³çš„è®¸å¤šæ–‡ç« ä¸­æ‰€è¯´çš„é‚£æ ·ï¼Œæ•¬è¯·å…³æ³¨ï¼&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>ä½¿ç”¨ Kyverno å’Œ Argo CD å®æ–½ Kubernetes æœ€ä½³å®è·µ</title>
      <link>https://lib.jimmysong.io/blog/argo-cd-kyverno-best-practice-policies/</link>
      <pubDate>Mon, 10 Apr 2023 22:44:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/argo-cd-kyverno-best-practice-policies/</guid>
      <description>&lt;p&gt;















&lt;figure  &gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;&#34; srcset=&#34;
               /blog/argo-cd-kyverno-best-practice-policies/kyverno-argo_hu1b0a20ed8ba0ac85b8a6958a1470d1b8_110111_8b26e2d514a269f2dacc3aaf5a5a70d4.webp 400w,
               /blog/argo-cd-kyverno-best-practice-policies/kyverno-argo_hu1b0a20ed8ba0ac85b8a6958a1470d1b8_110111_f6ebc9691c2c289ecf61adea2c0572ce.webp 760w,
               /blog/argo-cd-kyverno-best-practice-policies/kyverno-argo_hu1b0a20ed8ba0ac85b8a6958a1470d1b8_110111_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/argo-cd-kyverno-best-practice-policies/kyverno-argo_hu1b0a20ed8ba0ac85b8a6958a1470d1b8_110111_8b26e2d514a269f2dacc3aaf5a5a70d4.webp&#34;
               width=&#34;760&#34;
               height=&#34;428&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ æ­£åœ¨é˜…è¯»è¿™ç¯‡åšå®¢æ–‡ç« ï¼Œæˆ‘å‡è®¾ä½ å·²ç»ç†Ÿæ‚‰ Kubernetes å¹¶ä¸”çŸ¥é“å®ƒæ˜¯ä¸€ä¸ªå®¹å™¨ç¼–æ’å¹³å°ã€‚åœ¨åˆ›å»ºæ–°çš„åº”ç”¨ç¨‹åºç‰ˆæœ¬æ—¶ï¼Œä½ çš„å®¹å™¨æ„å»ºè¿‡ç¨‹å·²ç»å¾ˆå¥½äº†ã€‚Kubernetes æä¾›äº†å¹¿æ³›çš„åŠŸèƒ½ï¼Œä½¿ç”¨æˆ·èƒ½å¤Ÿæ‰§è¡Œå¤æ‚çš„éƒ¨ç½²ç­–ç•¥ã€‚æŒ‘æˆ˜åœ¨äºæ ¹æ®ä½ çš„ç¯å¢ƒï¼Œæœ‰æ­£ç¡®å’Œé”™è¯¯çš„ä½¿ç”¨æ–¹å¼ã€‚&lt;/p&gt;
&lt;p&gt;ä½ ç»„ç»‡ä¸­çš„å¹³å°å·¥ç¨‹å¸ˆå¾ˆå¯èƒ½éå¸¸ç†Ÿæ‚‰ Kubernetesï¼Œäº†è§£å°†åº”ç”¨ç¨‹åºéƒ¨ç½²åˆ°é›†ç¾¤ä¸­çš„æ­£ç¡®å’Œé”™è¯¯æ–¹å¼ã€‚æŒ‘æˆ˜åœ¨äºå‘å¹³å°çš„æ‰€æœ‰ç”¨æˆ·ä¼ é€’è¿™äº›ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;å¤§å¤šæ•°è¿ç»´äººå‘˜çš„ç†è§£å¾ˆå¯èƒ½æ¥è‡ªäºæ­£å¼åŸ¹è®­æˆ–èŠ±è´¹å¾ˆå¤šæ—¶é—´æ„å»ºå¹³å°å¹¶ä»é”™è¯¯ä¸­å­¦ä¹ ã€‚è¦æ±‚æ‰€æœ‰æ‰“ç®—ä¸å¹³å°äº¤äº’çš„åº”ç”¨ç¨‹åºå¼€å‘äººå‘˜å…·æœ‰ç›¸åŒçš„ç»éªŒæ˜¯ä¸ç°å®çš„ã€‚è¿™å¯¹ç»„ç»‡æ¥è¯´åœ¨æ—¶é—´ã€ç²¾åŠ›å’Œå¯¹äº§å“å’Œå®¢æˆ·çš„æ½œåœ¨å½±å“æ–¹é¢éƒ½æ˜¯æ˜‚è´µçš„ï¼Œå› ä¸ºè¿™äº›ç»éªŒæ˜¯ä»é”™è¯¯ä¸­å­¦åˆ°çš„ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æ¯ä¸ªç»„ç»‡å†…ï¼Œç”¨æˆ·ä½¿ç”¨å†…éƒ¨å¼€å‘å¹³å°çš„ç­–ç•¥å’Œæ ‡å‡†æ˜¯å·²çŸ¥çš„æˆ–éœ€è¦éµå¾ªçš„ã€‚æŒ‘æˆ˜åœ¨äºè®¸å¤šç»„ç»‡ä½¿ç”¨æ–‡æ¡£å’Œå¹¿æ³›çš„æ²Ÿé€šæ¥ç¡®ä¿ç”¨æˆ·éµå¾ªè¿™äº›æ ‡å‡†ã€‚è¿™åœ¨äººä»¬åç¦»é¢„æœŸæ ‡å‡†å¹¶å­¦ä¹ æ­£ç¡®æ–¹æ³•ä¹‹é—´æä¾›äº†é•¿æ—¶é—´çš„åé¦ˆå¾ªç¯ã€‚&lt;/p&gt;
&lt;h2 id=&#34;kyverno&#34;&gt;Kyverno&lt;/h2&gt;
&lt;p&gt;è¿™å°±æ˜¯ &lt;a href=&#34;https://kyverno.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Kyverno&lt;/a&gt; çš„ç”¨æ­¦ä¹‹åœ°ï¼Œå®ƒæ˜¯ä¸€ä¸ªåŸºäº Kubernetes çš„ç­–ç•¥å¼•æ“ï¼Œæä¾›äº†ä¸€ç§å°†å¹³å°ç®¡ç†å‘˜å­¦åˆ°çš„ç»éªŒç¼–ç åŒ–çš„æ–¹å¼ã€‚Kyverno ç›´æ¥éƒ¨ç½²åˆ° Kubernetes é›†ç¾¤ä¸­ï¼Œå¹¶ä½¿ç”¨è‡ªå®šä¹‰èµ„æºæ¥å®šä¹‰ç­–ç•¥ã€‚ä½¿ç”¨ admission webhookï¼ŒKyverno å¯ä»¥å®¡è®¡ç­–ç•¥è¿è§„æˆ–ç”šè‡³é˜»æ­¢å°è¯•è¿›å…¥é›†ç¾¤çš„è¯·æ±‚ã€‚&lt;/p&gt;
&lt;p&gt;ç­–ç•¥å¼•æ“å¯ä»¥å¤§å¤§ç¼©çŸ­åœ¨ Kubernetes ä¸­å°è¯•åº”ç”¨æ›´æ”¹å¹¶å­¦ä¹ éƒ¨ç½²ä¸ç¬¦åˆå¹³å°ç®¡ç†å‘˜è®¾ç½®çš„æ ‡å‡†æ—¶çš„åé¦ˆå¾ªç¯ã€‚å½“åº”ç”¨ç¨‹åºå¼€å‘äººå‘˜ä¸é›†ç¾¤äº¤äº’æ—¶ï¼Œç­–ç•¥ä¼šç«‹å³æä¾›åé¦ˆï¼ŒæŒ‡å‡ºä»–ä»¬æ˜¯å¦åç¦»äº†å¹³å°å›¢é˜Ÿåˆ¶å®šçš„æœ€ä½³å®è·µã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œä¸€ä¸ªåˆšå¼€å§‹ç†Ÿæ‚‰ Kubernetes çš„å¼€å‘äººå‘˜å†³å®šéƒ¨ç½²åº”ç”¨ç¨‹åºçš„ &lt;code&gt;latest&lt;/code&gt; æ ‡è®°ã€‚è¿™ä¼¼ä¹æ˜¯æ— å®³çš„ï¼Œä½†ä»–ä»¬ä¸çŸ¥é“ä½¿ç”¨å¯å˜æ ‡è®°çš„å±é™©ã€‚åœ¨æ­¤é”™è¯¯è¢«é›†ç¾¤ç®¡ç†å‘˜æ•æ‰å¹¶å‘ç”¨æˆ·æŠ¥å‘Šä¹‹å‰ï¼Œè¿™æ®µæ—¶é—´å¯èƒ½é€ æˆå¾ˆå¤§çš„æŸå¤±ã€‚&lt;/p&gt;
&lt;p&gt;ç›¸åï¼Œå½“ç”¨æˆ·å°è¯•å°† &lt;code&gt;latest&lt;/code&gt; æ ‡è®°éƒ¨ç½²åˆ°é›†ç¾¤ä¸­æ—¶ï¼Œä»–ä»¬å¯ä»¥ç«‹å³æ”¶åˆ°ä¸€ä¸ªæ¸…æ™°çš„æ¶ˆæ¯ï¼Œè§£é‡Šä¸ºä»€ä¹ˆä¸å…è®¸è¿™æ ·åšï¼Œå¹¶æä¾›çº æ­£ç­–ç•¥è¿è§„çš„æ­¥éª¤ã€‚è¿™ä½¿ä»–ä»¬å¯ä»¥ç»§ç»­å®ç°ä»–ä»¬æƒ³è¦å®Œæˆçš„ç›®æ ‡ï¼Œå°†ä»–ä»¬çš„åº”ç”¨ç¨‹åºéƒ¨ç½²åˆ°é›†ç¾¤ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;ç»„ç»‡ç”šè‡³å¯ä»¥å°†ç­–ç•¥é›†æˆåˆ° CI/CD å·¥ä½œæµç¨‹ä¸­ï¼Œä»¥æ›´æ—©åœ°æ•æ‰ä»»ä½•è¿è§„è¡Œä¸ºã€‚å¦‚æœæŸäº›è¿è§„è¡Œä¸ºåœ¨é›†ç¾¤ä¸­å¾—ä»¥å®ç°ï¼ŒKyverno å¯ä»¥é˜»æ­¢ admission è¯·æ±‚ä»¥å¼ºåˆ¶æ‰§è¡Œè¯¥ç­–ç•¥ï¼Œç”šè‡³å¯ä»¥åœ¨åº”ç”¨å®ƒä»¬æ—¶æ”¹å˜èµ„æºï¼Œä½¿å®ƒä»¬ç¬¦åˆæœ€ä½³å®è·µã€‚&lt;/p&gt;
&lt;h2 id=&#34;gitops--argo-cd&#34;&gt;GitOps / Argo CD&lt;/h2&gt;
&lt;p&gt;ä½œä¸º Kubernetes ç®¡ç†å‘˜ï¼Œä½ å¯èƒ½å¥½å¥‡å¦‚ä½•ç®¡ç†è¿™äº›ç­–ç•¥ï¼Œè¿™å°±æ˜¯ Argo CD å’Œ GitOps çš„ä½œç”¨ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://akuity.io/gitops/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;GitOps&lt;/a&gt; å°†åº”ç”¨ç¨‹åºå¼€å‘çš„æœ€ä½³å®è·µï¼ˆå¦‚ç‰ˆæœ¬æ§åˆ¶ã€åä½œã€åˆè§„æ€§å’Œå·¥å…·ï¼‰åº”ç”¨äº Kubernetesã€‚é›†ç¾¤ä¸­ä½¿ç”¨çš„ Kubernetes èµ„æºçš„æ¸…å•å­˜å‚¨åœ¨ Git ä¸­ï¼Œè¿™æä¾›äº†æ‰€éœ€çŠ¶æ€çš„ä¸å¯å˜ç‰ˆæœ¬ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://akuity.io/what-is-argo/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Argo CD&lt;/a&gt; å……å½“ GitOps ä»£ç†ï¼Œä¸æ–­åœ°å°†æœŸæœ›çŠ¶æ€ä¸é›†ç¾¤çš„å®é™…çŠ¶æ€è¿›è¡Œæ¯”è¾ƒã€‚å®ƒå°† Git ä¸­çš„ä»»ä½•æ›´æ”¹åº”ç”¨äº Kubernetes é›†ç¾¤ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ä»»ä½• Kubernetes æ¸…å•ä¸€æ ·ï¼ŒKyverno ç­–ç•¥å¯ä»¥é€šè¿‡ Git å­˜å‚¨å’Œç®¡ç†ã€‚è¿™ä½¿å®ƒä»¬å¯ä»¥éµå¾ªé€æ˜çš„æ‰¹å‡†æµç¨‹ï¼Œå¹¶æä¾›ç­–ç•¥ä½•æ—¶ä»¥åŠä¸ºä»€ä¹ˆå‘ç”Ÿæ›´æ”¹çš„å®¡è®¡è·Ÿè¸ªã€‚&lt;/p&gt;
&lt;h2 id=&#34;kyverno-æœ€ä½³å®è·µç­–ç•¥&#34;&gt;Kyverno æœ€ä½³å®è·µç­–ç•¥&lt;/h2&gt;
&lt;p&gt;è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹ä½¿ç”¨ Kyverno ç­–ç•¥å®æ–½ Kubernetes æœ€ä½³å®è·µçš„å…¸å‹ç¤ºä¾‹ã€‚æˆ‘ä»¬å°†ä»ä½¿ç”¨ Argo CD å‘é›†ç¾¤æ·»åŠ ç­–ç•¥å¼€å§‹ã€‚å¯¹äºæ­¤ç¤ºä¾‹ï¼ŒKyverno å’Œ Argo CD å·²å®‰è£…åœ¨é›†ç¾¤ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ &lt;a href=&#34;https://github.com/morey-tech/argo-cd-kyverno&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;GitOps ä»“åº“&lt;/a&gt; ä¸­ï¼Œæ·»åŠ  &lt;code&gt;require-resource-requests&lt;/code&gt; ç­–ç•¥ï¼Œè¯¥ç­–ç•¥è¦æ±‚ pod å…·æœ‰å®šä¹‰çš„èµ„æºè¯·æ±‚ã€‚è¿™å¯¹ Kubernetes èƒ½å¤Ÿå°† pod &lt;a href=&#34;https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/#how-pods-with-resource-requests-are-scheduled&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å®‰æ’åˆ°å…·æœ‰è¶³å¤Ÿèµ„æºçš„èŠ‚ç‚¹ä¸Š&lt;/a&gt;è‡³å…³é‡è¦ã€‚å¦‚æœæ²¡æœ‰è¿™äº›èµ„æºè¯·æ±‚ï¼Œä»èµ„æºå¯ç”¨æ€§çš„è§’åº¦æ¥çœ‹ï¼ŒKubernetes å°†ç›²ç›®åœ°å°† pod å®‰æ’åˆ°èŠ‚ç‚¹ä¸Šã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;kyverno.io/v1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;ClusterPolicy&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;require-resource-requests&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;annotations&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;policies.kyverno.io/title&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Require Resource Requests&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;policies.kyverno.io/category&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Best Practices&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;policies.kyverno.io/severity&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;medium&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;policies.kyverno.io/subject&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Pod&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;policies.kyverno.io/minversion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1.6.0&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;policies.kyverno.io/description&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;-&lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;      As application workloads share cluster resources, it is important to specify resources
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;      requested and consumed by each Pod. Requiring resource requests per Pod is recommended,
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;      especially for memory and CPU. If a Namespace level request is specified, defaults will
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;      automatically be applied to each Pod based on the LimitRange configuration. This policy
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;      validates that all containers have something specified for memory and CPU requests.&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;      
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;validationFailureAction&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;enforce&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;background&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;rules&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;validate-resource-requests&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;match&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;any&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;resources&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kinds&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;Pod&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespaces&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;dev&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;validate&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;message&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;CPU and memory resource requests are required.&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;pattern&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;containers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;resources&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;requests&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;memory&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;?*&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;cpu&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;?*&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;validationFailureAction&lt;/code&gt; å­—æ®µç¡®å®š Kyverno å¦‚ä½•å“åº”å¤±è´¥çš„éªŒè¯æ£€æŸ¥çš„è¡Œä¸ºã€‚&lt;code&gt;require-resource-requests&lt;/code&gt; ç­–ç•¥è®¾ç½®ä¸ºå¼ºåˆ¶æ‰§è¡Œè§„åˆ™å¤±è´¥ï¼Œé˜»æ­¢ä»»ä½•è¿åå®ƒä»¬çš„è¯·æ±‚ã€‚å½“å‘ç”Ÿè¿™ç§æƒ…å†µæ—¶ï¼Œå®ƒå°†åœ¨è´Ÿè´£çš„ç­–ç•¥èµ„æºä¸Šè®°å½•ä¸€ä¸ª &lt;code&gt;fail (blocked)&lt;/code&gt; äº‹ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;validate-resource-requests&lt;/code&gt; è§„åˆ™å°†åŒ¹é… &lt;code&gt;dev&lt;/code&gt; å‘½åç©ºé—´ä¸­çš„ä»»ä½• &lt;code&gt;Pod&lt;/code&gt; èµ„æºï¼Œå³ä½¿æ˜¯ä»æ›´é«˜çº§åˆ«çš„èµ„æºï¼ˆå¦‚ Deployment æˆ– ReplicaSetï¼‰ç”Ÿæˆçš„ã€‚å®ƒå°†éªŒè¯ pod ä¸­çš„å®¹å™¨ä¸Šçš„ &lt;code&gt;cpu&lt;/code&gt; å’Œ &lt;code&gt;memory&lt;/code&gt; èµ„æºè¯·æ±‚å­—æ®µæ˜¯å¦å®šä¹‰äº†å€¼ã€‚å½“ç­–ç•¥éªŒè¯å¤±è´¥æ—¶ï¼Œå®ƒå°†åŒ…æ‹¬è§„åˆ™ä¸­å®šä¹‰çš„ &lt;code&gt;message&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å°†æ·»åŠ ä¸€ä¸ªåº”ç”¨ç¨‹åºåˆ° Argo CDï¼Œè¯¥åº”ç”¨ç¨‹åºæŒ‡å‘åŒ…å«ç­–ç•¥çš„ä»“åº“ä¸­çš„ç›®å½•ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;argoproj.io/v1alpha1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Application&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;policies&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;destination&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;kyverno&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;project&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;default&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;source&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;policies&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;repoURL&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;https://github.com/morey-tech/argo-cd-kyverno.git&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;targetRevision&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;directory&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;recurse&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;















&lt;figure  id=&#34;figure-kyverno-ç­–ç•¥åœ¨-argo-cd-ä¸­åŒæ­¥&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Kyverno ç­–ç•¥åœ¨ Argo CD ä¸­åŒæ­¥ã€‚&#34; srcset=&#34;
               /blog/argo-cd-kyverno-best-practice-policies/argo-cd-kyverno-policy-synced_hubcdfe03d92550fd0740ce8923a69fc21_39261_de669a792a4b8f0c40288333f0ecda67.webp 400w,
               /blog/argo-cd-kyverno-best-practice-policies/argo-cd-kyverno-policy-synced_hubcdfe03d92550fd0740ce8923a69fc21_39261_b83e28f75bc90e75423bb946185c7e2f.webp 760w,
               /blog/argo-cd-kyverno-best-practice-policies/argo-cd-kyverno-policy-synced_hubcdfe03d92550fd0740ce8923a69fc21_39261_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/argo-cd-kyverno-best-practice-policies/argo-cd-kyverno-policy-synced_hubcdfe03d92550fd0740ce8923a69fc21_39261_de669a792a4b8f0c40288333f0ecda67.webp&#34;
               width=&#34;760&#34;
               height=&#34;356&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      Kyverno ç­–ç•¥åœ¨ Argo CD ä¸­åŒæ­¥ã€‚
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;éšç€ç­–ç•¥åŒæ­¥åˆ°é›†ç¾¤ä¸­ï¼Œæˆ‘ä»¬å°†éƒ¨ç½²å¦ä¸€ä¸ª Argo CD åº”ç”¨ç¨‹åºï¼Œå…¶ä¸­åŒ…å«ä¸¤ä¸ª &lt;code&gt;nginx&lt;/code&gt; podï¼Œä¸€ä¸ªå°†é€šè¿‡ç­–ç•¥éªŒè¯ï¼Œå¦ä¸€ä¸ªå°†å› ç¼ºå°‘èµ„æºè¯·æ±‚è€Œå¤±è´¥ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-åº”ç”¨ç¨‹åºåŒæ­¥å¤±è´¥å› ä¸º-kyverno-ç­–ç•¥é˜»æ­¢äº†-pod-çš„åˆ›å»º&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;åº”ç”¨ç¨‹åºåŒæ­¥å¤±è´¥ï¼Œå› ä¸º Kyverno ç­–ç•¥é˜»æ­¢äº† pod çš„åˆ›å»ºã€‚&#34; srcset=&#34;
               /blog/argo-cd-kyverno-best-practice-policies/argo-cd-sync-failed-blocked-pod_hu12313ed828e4ff10b68b2e9760424db9_57231_d9e80bbae66968bf3f19d9db3ec95a07.webp 400w,
               /blog/argo-cd-kyverno-best-practice-policies/argo-cd-sync-failed-blocked-pod_hu12313ed828e4ff10b68b2e9760424db9_57231_6c840ffd1b8cb2dc740ab81a9a472075.webp 760w,
               /blog/argo-cd-kyverno-best-practice-policies/argo-cd-sync-failed-blocked-pod_hu12313ed828e4ff10b68b2e9760424db9_57231_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/argo-cd-kyverno-best-practice-policies/argo-cd-sync-failed-blocked-pod_hu12313ed828e4ff10b68b2e9760424db9_57231_d9e80bbae66968bf3f19d9db3ec95a07.webp&#34;
               width=&#34;760&#34;
               height=&#34;312&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      åº”ç”¨ç¨‹åºåŒæ­¥å¤±è´¥ï¼Œå› ä¸º Kyverno ç­–ç•¥é˜»æ­¢äº† pod çš„åˆ›å»ºã€‚
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;åŒæ­¥æœ€ç»ˆå°†å¤±è´¥ï¼Œå› ä¸ºè¯¥ç­–ç•¥è®¾ç½®ä¸ºé˜»æ­¢åˆ›å»ºä»»ä½•åŒ…å«è¿è§„çš„èµ„æºã€‚æŸ¥çœ‹ Argo CD ä¸­çš„åŒæ­¥çŠ¶æ€æ—¶ï¼Œç”¨æˆ·å¯ä»¥çœ‹åˆ°æ¶ˆæ¯ä¸­çš„ Kyverno ç­–ç•¥å¤±è´¥å’Œè§„åˆ™è§£é‡Šå¤±è´¥åŸå› ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-åº”ç”¨ç¨‹åºåŒæ­¥æ‘˜è¦å…¶ä¸­åŒ…å«æ¥è‡ª-kyverno-ç­–ç•¥çš„æ¶ˆæ¯&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;åº”ç”¨ç¨‹åºåŒæ­¥æ‘˜è¦ï¼Œå…¶ä¸­åŒ…å«æ¥è‡ª Kyverno ç­–ç•¥çš„æ¶ˆæ¯ã€‚&#34; srcset=&#34;
               /blog/argo-cd-kyverno-best-practice-policies/argo-cd-sync-summary_hu87ccf1fcd9089e762f58d8d7d7984761_32267_edccda517b1512b82fdc7eb5d1ca73d5.webp 400w,
               /blog/argo-cd-kyverno-best-practice-policies/argo-cd-sync-summary_hu87ccf1fcd9089e762f58d8d7d7984761_32267_ca9c769c3bf87b93d71e3c32c0af19b6.webp 760w,
               /blog/argo-cd-kyverno-best-practice-policies/argo-cd-sync-summary_hu87ccf1fcd9089e762f58d8d7d7984761_32267_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/argo-cd-kyverno-best-practice-policies/argo-cd-sync-summary_hu87ccf1fcd9089e762f58d8d7d7984761_32267_edccda517b1512b82fdc7eb5d1ca73d5.webp&#34;
               width=&#34;760&#34;
               height=&#34;235&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      åº”ç”¨ç¨‹åºåŒæ­¥æ‘˜è¦ï¼Œå…¶ä¸­åŒ…å«æ¥è‡ª Kyverno ç­–ç•¥çš„æ¶ˆæ¯ã€‚
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;åŒæ­¥çŠ¶æ€è¿˜å°†æ¯ä¸ªèµ„æºçš„ç»“æœåˆ†è§£ï¼Œä½¿ç”¨æˆ·æ¸…æ¥šåœ°äº†è§£å“ªä¸ªèµ„æºå¤±è´¥ä»¥åŠåŸå› ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-åº”ç”¨ç¨‹åºåŒæ­¥ç»“æœæ˜¾ç¤ºåŒæ­¥çŠ¶æ€å’Œèµ„æºä¸Šçš„-kyverno-ç­–ç•¥æ¶ˆæ¯&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;åº”ç”¨ç¨‹åºåŒæ­¥ç»“æœï¼Œæ˜¾ç¤ºåŒæ­¥çŠ¶æ€å’Œèµ„æºä¸Šçš„ Kyverno ç­–ç•¥æ¶ˆæ¯ã€‚&#34; srcset=&#34;
               /blog/argo-cd-kyverno-best-practice-policies/argo-cd-sync-result-resources_hu891e7dba28516662dd7cc02bbbf54860_42866_82be77147cd5272320a7cf5c1323c0f7.webp 400w,
               /blog/argo-cd-kyverno-best-practice-policies/argo-cd-sync-result-resources_hu891e7dba28516662dd7cc02bbbf54860_42866_67b6e3bdd08866489d9aa064aa71c64b.webp 760w,
               /blog/argo-cd-kyverno-best-practice-policies/argo-cd-sync-result-resources_hu891e7dba28516662dd7cc02bbbf54860_42866_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/argo-cd-kyverno-best-practice-policies/argo-cd-sync-result-resources_hu891e7dba28516662dd7cc02bbbf54860_42866_82be77147cd5272320a7cf5c1323c0f7.webp&#34;
               width=&#34;760&#34;
               height=&#34;184&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      åº”ç”¨ç¨‹åºåŒæ­¥ç»“æœï¼Œæ˜¾ç¤ºåŒæ­¥çŠ¶æ€å’Œèµ„æºä¸Šçš„ Kyverno ç­–ç•¥æ¶ˆæ¯ã€‚
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;åœ¨ç­–ç•¥èµ„æºä¸Šï¼Œäº‹ä»¶ä¹Ÿä¼šæ˜¾ç¤ºè¿è§„è¡Œä¸ºã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-kyverno-ç­–ç•¥äº‹ä»¶åœ¨-argo-cd-ä¸­&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Kyverno ç­–ç•¥äº‹ä»¶åœ¨ Argo CD ä¸­ã€‚&#34; srcset=&#34;
               /blog/argo-cd-kyverno-best-practice-policies/argo-cd-kyverno-policy-events_hu32494ed063c23044f030329602ae7774_38272_1de7d1989438cd0ca9a39eb5e01ddf30.webp 400w,
               /blog/argo-cd-kyverno-best-practice-policies/argo-cd-kyverno-policy-events_hu32494ed063c23044f030329602ae7774_38272_8c132c5b47ca73b876a76457bdb50abe.webp 760w,
               /blog/argo-cd-kyverno-best-practice-policies/argo-cd-kyverno-policy-events_hu32494ed063c23044f030329602ae7774_38272_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/argo-cd-kyverno-best-practice-policies/argo-cd-kyverno-policy-events_hu32494ed063c23044f030329602ae7774_38272_1de7d1989438cd0ca9a39eb5e01ddf30.webp&#34;
               width=&#34;760&#34;
               height=&#34;305&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      Kyverno ç­–ç•¥äº‹ä»¶åœ¨ Argo CD ä¸­ã€‚
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;ä¸€æ—¦èµ„æºçš„ç­–ç•¥è¿è§„å¾—åˆ°è§£å†³ï¼ŒArgo CD åº”ç”¨ç¨‹åºå°±èƒ½å°†è¯¥èµ„æºåŒæ­¥åˆ°é›†ç¾¤ä¸­ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç»“è®º&#34;&gt;ç»“è®º&lt;/h2&gt;
&lt;p&gt;Kyverno ä½œä¸ºç­–ç•¥å¼•æ“ï¼Œæ˜¯å‘å†…éƒ¨å¼€å‘è€…å¹³å°ç”¨æˆ·æä¾›å®ç°å¹³å°å›¢é˜Ÿåˆ¶å®šçš„æœ€ä½³å®è·µçš„æ¸…æ™°åé¦ˆçš„å¼ºå¤§å·¥å…·ã€‚ç„¶è€Œï¼Œè¿™åªæ˜¯ Kyverno èƒ½åŠ›çš„å†°å±±ä¸€è§’ã€‚æœ¬æ–‡ä¸­çš„ç¤ºä¾‹æ¼”ç¤ºäº†æ³¨å…¥æ§åˆ¶åŠŸèƒ½ï¼Œä½†ç­–ç•¥ä¹Ÿå¯ä»¥ã€ç”Ÿæˆå’Œæ¸…ç†èµ„æºã€‚è¿™æ ·å°±å¯ä»¥é€šè¿‡è‡ªåŠ¨æ›´æ–°èµ„æºæ¥å¼ºåˆ¶æ‰§è¡Œç­–ç•¥ï¼Œä½¿å…¶ç¬¦åˆè¿›å…¥é›†ç¾¤çš„èµ„æºï¼Œæˆ–è€…æ„å»ºä¸€ä¸ªè‡ªåŠ©å¼å¹³å°ï¼Œå“åº”åœ¨é›†ç¾¤ä¸­åˆ›å»ºçš„èµ„æºï¼Œåˆ›å»ºæ–°çš„é›†ç¾¤å¹¶ä½¿ç”¨ Argo CD å¼•å¯¼å®ƒä»¬ã€‚&lt;/p&gt;
&lt;p&gt;éµå¾ª GitOps åŸåˆ™å¹¶ä½¿ç”¨ Argo CD ç®¡ç†éƒ¨ç½²æ—¶ï¼Œç®¡ç†é›†ç¾¤çš„ç­–ç•¥å˜å¾—æ›´åŠ ç®€å•ã€‚Argo CD UI æ˜ç¡®äº†é€šè¿‡ç­–ç•¥éªŒè¯é˜»æ­¢çš„ä»»ä½•èµ„æºï¼Œä½¿ç”¨æˆ·æ˜“äºç†è§£å¦‚ä½•ä½¿èµ„æºç¬¦åˆæ ‡å‡†ã€‚&lt;/p&gt;
&lt;p&gt;Kyverno å’Œ Argo CD ä¸€èµ·å¼€è¾Ÿäº†ä¸€ä¸ªå…¨æ–°çš„é›†ç¾¤ç®¡ç†ä¸–ç•Œï¼Œå¯ä»¥æ ¹æ®æ‚¨ç»„ç»‡çš„éœ€æ±‚è¿›è¡Œæ‰©å±•ã€‚æœ‰å…³ä½¿ç”¨ Argo CD å’Œ Kyverno çš„æ›´å¤šæœ€ä½³å®è·µï¼Œè¯·å‚é˜… Nirmata åšå®¢ä¸Šçš„&lt;a href=&#34;https://nirmata.com/2023/03/09/3-essential-tips-for-using-argo-cd-and-kyverno/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;â€œä½¿ç”¨ Argo CD å’Œ Kyverno çš„ 3 ä¸ªåŸºæœ¬æŠ€å·§â€ ã€‚&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Istio Ambient æ¨¡å¼ä½¿ç”¨ Waypoint ä»£ç†ç®€åŒ– Istio éƒ¨ç½²</title>
      <link>https://lib.jimmysong.io/blog/waypoint-proxy-made-simple/</link>
      <pubDate>Tue, 04 Apr 2023 08:00:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/waypoint-proxy-made-simple/</guid>
      <description>&lt;blockquote&gt;
&lt;p&gt;è¯‘è€…æ³¨ï¼šæœ¬æ–‡ä»‹ç»äº† Istio çš„æ–°çš„ç›®çš„åœ°å¯¼å‘çš„ waypoint ä»£ç†ï¼Œå®ƒå¯ä»¥ç®€åŒ–å’Œæ‰©å±• Istio çš„åŠŸèƒ½ã€‚æ–‡ç« ä»‹ç»äº† waypoint ä»£ç†çš„æ¶æ„ï¼Œéƒ¨ç½²æ–¹å¼ï¼Œä»¥åŠå¦‚ä½•å°†æºä»£ç†çš„é…ç½®è½¬ç§»åˆ°ç›®çš„åœ°ä»£ç†ï¼Œä»è€Œæé«˜å¯æ‰©å±•æ€§ï¼Œå¯è°ƒè¯•æ€§ï¼Œä¸€è‡´æ€§å’Œå®‰å…¨æ€§ã€‚æ–‡ç« è¿˜å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ Istio çš„ç­–ç•¥å’Œé¥æµ‹æ¥ç®¡ç†å’Œç›‘æ§ waypoint ä»£ç†ã€‚æ–‡ç« çš„æ¥æºæ˜¯ Istio å®˜æ–¹åšå®¢ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Ambient å°† Istio çš„åŠŸèƒ½åˆ†ä¸ºä¸¤ä¸ªä¸åŒçš„å±‚ï¼Œä¸€ä¸ªå®‰å…¨è¦†ç›–å±‚å’Œä¸€ä¸ªä¸ƒå±‚æµé‡å¤„ç†å±‚ã€‚Waypoint ä»£ç†æ˜¯ä¸€ä¸ªå¯é€‰ç»„ä»¶ï¼Œå®ƒåŸºäº Envoy å¹¶ä¸ºå…¶ç®¡ç†çš„å·¥ä½œè´Ÿè½½è¿›è¡Œä¸ƒå±‚æµé‡å¤„ç†ã€‚è‡ª 2022 å¹´&lt;a href=&#34;https://istio.io/latest/blog/2022/introducing-ambient-mesh/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;é¦–æ¬¡å¯åŠ¨ Ambient&lt;/a&gt; ä»¥æ¥ï¼Œæˆ‘ä»¬è¿›è¡Œäº†é‡å¤§æ›´æ”¹ä»¥ç®€åŒ–è·¯ç‚¹é…ç½®ã€å¯è°ƒè¯•æ€§å’Œå¯æ‰©å±•æ€§ã€‚&lt;/p&gt;
&lt;h2 id=&#34;waypoint-ä»£ç†çš„æ¶æ„&#34;&gt;Waypoint ä»£ç†çš„æ¶æ„&lt;/h2&gt;
&lt;p&gt;ä¸ sidecar ç±»ä¼¼ï¼Œwaypoint ä»£ç†ä¹Ÿæ˜¯åŸºäº Envoy çš„ï¼Œç”± Istio åŠ¨æ€é…ç½®ä»¥æœåŠ¡äºæ‚¨çš„åº”ç”¨ç¨‹åºã€‚Waypoint ä»£ç†çš„ç‹¬ç‰¹ä¹‹å¤„åœ¨äºå®ƒè¿è¡Œæ¯ä¸ªå‘½åç©ºé—´ï¼ˆé»˜è®¤ï¼‰æˆ–æ¯ä¸ªæœåŠ¡è´¦æˆ·ã€‚é€šè¿‡åœ¨åº”ç”¨ç¨‹åº pod ä¹‹å¤–è¿è¡Œï¼Œwaypoint ä»£ç†å¯ä»¥ç‹¬ç«‹äºåº”ç”¨ç¨‹åºå®‰è£…ã€å‡çº§å’Œæ‰©å±•ï¼Œå¹¶é™ä½è¿è¥æˆæœ¬ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-waypoint-ä»£ç†æ¶æ„&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Waypoint ä»£ç†æ¶æ„&#34; srcset=&#34;
               /blog/waypoint-proxy-made-simple/waypoint-architecture_hu59305ef2f51fbf4c8a3cd5081c94e854_82134_2a06fa92a698bab36a71afcd9429211e.webp 400w,
               /blog/waypoint-proxy-made-simple/waypoint-architecture_hu59305ef2f51fbf4c8a3cd5081c94e854_82134_fa0f9a478796beeebc42ebace44b7fb2.webp 760w,
               /blog/waypoint-proxy-made-simple/waypoint-architecture_hu59305ef2f51fbf4c8a3cd5081c94e854_82134_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/waypoint-proxy-made-simple/waypoint-architecture_hu59305ef2f51fbf4c8a3cd5081c94e854_82134_2a06fa92a698bab36a71afcd9429211e.webp&#34;
               width=&#34;760&#34;
               height=&#34;333&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      Waypoint ä»£ç†æ¶æ„
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ Kubernetes Gateway èµ„æºæˆ– &lt;code&gt;istioctl&lt;/code&gt; å‘½ä»¤ä»¥å£°æ˜æ–¹å¼éƒ¨ç½² waypoint ä»£ç†ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ istioctl experimental waypoint generate
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;apiVersion: gateway.networking.k8s.io/v1beta1
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kind: Gateway
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;metadata:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  name: namespace
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;spec:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  gatewayClassName: istio-waypoint
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  listeners:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  - name: mesh
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    port: &lt;span class=&#34;m&#34;&gt;15008&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    protocol: HBONE
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Istiod å°†ç›‘æ§è¿™äº›èµ„æºå¹¶è‡ªåŠ¨ä¸ºç”¨æˆ·éƒ¨ç½²å’Œç®¡ç†ç›¸åº”çš„ waypoint éƒ¨ç½²ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å°†æºä»£ç†é…ç½®è½¬ç§»åˆ°ç›®æ ‡ä»£ç†&#34;&gt;å°†æºä»£ç†é…ç½®è½¬ç§»åˆ°ç›®æ ‡ä»£ç†&lt;/h2&gt;
&lt;p&gt;åœ¨ç°æœ‰çš„ sidecar æ¶æ„ä¸­ï¼Œå¤§å¤šæ•°æµé‡æ•´å½¢ï¼ˆä¾‹å¦‚&lt;a href=&#34;https://istio.io/latest/docs/tasks/traffic-management/request-routing/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è¯·æ±‚è·¯ç”±&lt;/a&gt;æˆ–&lt;a href=&#34;https://istio.io/latest/docs/tasks/traffic-management/traffic-shifting/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æµé‡è½¬ç§»&lt;/a&gt;æˆ–&lt;a href=&#34;https://istio.io/latest/docs/tasks/traffic-management/fault-injection/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ•…éšœæ³¨å…¥&lt;/a&gt;ï¼‰ç­–ç•¥ç”±æºï¼ˆå®¢æˆ·ç«¯ï¼‰ä»£ç†å®ç°ï¼Œè€Œå¤§å¤šæ•°å®‰å…¨ç­–ç•¥ç”±ç›®æ ‡ï¼ˆæœåŠ¡å™¨ï¼‰ä»£ç†å®ç°ã€‚è¿™å¯¼è‡´äº†ä¸€äº›æ‹…å¿§ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç¼©æ”¾ â€”â€” æ¯ä¸ªæº sidecar éƒ½éœ€è¦çŸ¥é“å…³äºç½‘æ ¼ä¸­æ¯ä¸ªå…¶ä»–ç›®çš„åœ°çš„ä¿¡æ¯ã€‚è¿™æ˜¯ä¸€ä¸ªå¤šé¡¹å¼ç¼©æ”¾é—®é¢˜ã€‚æ›´ç³Ÿç³•çš„æ˜¯ï¼Œå¦‚æœä»»ä½•ç›®æ ‡é…ç½®å‘ç”Ÿå˜åŒ–ï¼Œæˆ‘ä»¬éœ€è¦ç«‹å³é€šçŸ¥æ‰€æœ‰ sidecarã€‚&lt;/li&gt;
&lt;li&gt;è°ƒè¯• â€”â€” å› ä¸ºç­–ç•¥æ‰§è¡Œåœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ sidecar ä¹‹é—´åˆ†å¼€ï¼Œæ‰€ä»¥åœ¨æ•…éšœæ’é™¤æ—¶å¾ˆéš¾ç†è§£ç³»ç»Ÿçš„è¡Œä¸ºã€‚&lt;/li&gt;
&lt;li&gt;æ··åˆç¯å¢ƒ â€”â€” å¦‚æœæˆ‘ä»¬çš„ç³»ç»Ÿä¸æ˜¯æ‰€æœ‰å®¢æˆ·ç«¯éƒ½æ˜¯ç½‘æ ¼çš„ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°±ä¼šå¾—åˆ°ä¸ä¸€è‡´çš„è¡Œä¸ºã€‚ä¾‹å¦‚ï¼Œéç½‘æ ¼å®¢æˆ·ç«¯ä¸ä¼šéµå®ˆé‡‘ä¸é›€éƒ¨ç½²ç­–ç•¥ï¼Œä»è€Œå¯¼è‡´æ„å¤–çš„æµé‡åˆ†é…ã€‚&lt;/li&gt;
&lt;li&gt;æ‰€æœ‰æƒå’Œå½’å± â€”â€” ç†æƒ³æƒ…å†µä¸‹ï¼Œåœ¨ä¸€ä¸ªå‘½åç©ºé—´ä¸­ç¼–å†™çš„ç­–ç•¥åº”è¯¥åªå½±å“åœ¨åŒä¸€å‘½åç©ºé—´ä¸­è¿è¡Œçš„ä»£ç†ã€‚ç„¶è€Œï¼Œåœ¨è¿™ä¸ªæ¨¡å‹ä¸­ï¼Œå®ƒæ˜¯ç”±æ¯ä¸ª sidecar åˆ†å‘å’Œæ‰§è¡Œçš„ã€‚å°½ç®¡ Istio å·²å›´ç»•æ­¤çº¦æŸè¿›è¡Œè®¾è®¡ä»¥ç¡®ä¿å…¶å®‰å…¨ï¼Œä½†å®ƒä»ç„¶ä¸æ˜¯æœ€ä½³é€‰æ‹©ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åœ¨ Ambient ä¸­ï¼Œæ‰€æœ‰ç­–ç•¥éƒ½ç”±ç›®çš„åœ° waypoint ä»£ç†å¼ºåˆ¶æ‰§è¡Œã€‚åœ¨è®¸å¤šæ–¹é¢ï¼Œwaypoint å……å½“è¿›å…¥å‘½åç©ºé—´ï¼ˆé»˜è®¤èŒƒå›´ï¼‰æˆ–æœåŠ¡è´¦æˆ·çš„ç½‘å…³ã€‚Istio å¼ºåˆ¶æ‰€æœ‰è¿›å…¥å‘½åç©ºé—´çš„æµé‡éƒ½ç»è¿‡ waypointï¼Œç„¶åè¯¥ waypoint æ‰§è¡Œè¯¥å‘½åç©ºé—´çš„æ‰€æœ‰ç­–ç•¥ã€‚å› æ­¤ï¼Œæ¯ä¸ª waypoint åªéœ€è¦äº†è§£å…¶è‡ªå·±å‘½åç©ºé—´çš„é…ç½®ã€‚&lt;/p&gt;
&lt;p&gt;å¯æ‰©å±•æ€§é—®é¢˜å¯¹äºåœ¨å¤§å‹é›†ç¾¤ä¸­è¿è¡Œçš„ç”¨æˆ·æ¥è¯´å°¤å…¶éº»çƒ¦ã€‚å¦‚æœæˆ‘ä»¬å°†å…¶å¯è§†åŒ–ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ–°æ¶æ„çš„æ”¹è¿›æœ‰å¤šå¤§ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘ä¸€ä¸ªç®€å•çš„éƒ¨ç½²ï¼Œæˆ‘ä»¬æœ‰ 2 ä¸ªå‘½åç©ºé—´ï¼Œæ¯ä¸ªå‘½åç©ºé—´æœ‰ 2 ä¸ªï¼ˆé¢œè‰²ç¼–ç ï¼‰éƒ¨ç½²ã€‚å¯¹ sidecar è¿›è¡Œç¼–ç¨‹æ‰€éœ€çš„ Envoy (XDS) é…ç½®æ˜¾ç¤ºä¸ºåœ†åœˆï¼š&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-æ¯ä¸ª-sidecar-éƒ½æœ‰å…³äºæ‰€æœ‰å…¶ä»–-sidecar-çš„é…ç½®&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;æ¯ä¸ª sidecar éƒ½æœ‰å…³äºæ‰€æœ‰å…¶ä»– sidecar çš„é…ç½®&#34; srcset=&#34;
               /blog/waypoint-proxy-made-simple/sidecar-config_huaaad4315e47c0a28331280d5fb84b321_119318_2c0bce1c53cb831bdbdf75598b4c342e.webp 400w,
               /blog/waypoint-proxy-made-simple/sidecar-config_huaaad4315e47c0a28331280d5fb84b321_119318_e005d62ca501cf17c6844a5cb069ce7d.webp 760w,
               /blog/waypoint-proxy-made-simple/sidecar-config_huaaad4315e47c0a28331280d5fb84b321_119318_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/waypoint-proxy-made-simple/sidecar-config_huaaad4315e47c0a28331280d5fb84b321_119318_2c0bce1c53cb831bdbdf75598b4c342e.webp&#34;
               width=&#34;753&#34;
               height=&#34;760&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      æ¯ä¸ª sidecar éƒ½æœ‰å…³äºæ‰€æœ‰å…¶ä»– sidecar çš„é…ç½®
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;åœ¨ sidecar æ¨¡å‹ä¸­ï¼Œæˆ‘ä»¬æœ‰ 4 ä¸ªå·¥ä½œè´Ÿè½½ï¼Œæ¯ä¸ªå·¥ä½œè´Ÿè½½æœ‰ 4 ç»„é…ç½®ã€‚å¦‚æœè¿™äº›é…ç½®ä¸­çš„ä»»ä½•ä¸€ä¸ªå‘ç”Ÿæ›´æ”¹ï¼Œåˆ™æ‰€æœ‰è¿™äº›é…ç½®éƒ½éœ€è¦æ›´æ–°ã€‚æ€»å…±æœ‰ 16 ä¸ªé…ç½®åˆ†å¸ƒã€‚&lt;/p&gt;
&lt;p&gt;ç„¶è€Œï¼Œåœ¨ waypoint æ¶æ„ä¸­ï¼Œé…ç½®å¾—åˆ°äº†æå¤§çš„ç®€åŒ–ï¼š&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-æ¯ä¸ª-waypoint-åªæœ‰è‡ªå·±çš„å‘½åç©ºé—´çš„é…ç½®&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;æ¯ä¸ª waypoint åªæœ‰è‡ªå·±çš„å‘½åç©ºé—´çš„é…ç½®&#34; srcset=&#34;
               /blog/waypoint-proxy-made-simple/waypoint-config_hu6cb11bbec754052b69e29edc36bcaab7_57775_fbccebaf3c643ea5f3cd1af83de442a5.webp 400w,
               /blog/waypoint-proxy-made-simple/waypoint-config_hu6cb11bbec754052b69e29edc36bcaab7_57775_e414f2c8fca27e9b64c6187854f367df.webp 760w,
               /blog/waypoint-proxy-made-simple/waypoint-config_hu6cb11bbec754052b69e29edc36bcaab7_57775_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/waypoint-proxy-made-simple/waypoint-config_hu6cb11bbec754052b69e29edc36bcaab7_57775_fbccebaf3c643ea5f3cd1af83de442a5.webp&#34;
               width=&#34;760&#34;
               height=&#34;456&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      æ¯ä¸ª waypoint åªæœ‰è‡ªå·±çš„å‘½åç©ºé—´çš„é…ç½®
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬çœ‹åˆ°äº†ä¸€ä¸ªæˆªç„¶ä¸åŒçš„æ•…äº‹ã€‚æˆ‘ä»¬åªæœ‰ 2 ä¸ªwaypoint ä»£ç†ï¼Œå› ä¸ºæ¯ä¸ªä»£ç†éƒ½èƒ½å¤Ÿä¸ºæ•´ä¸ªå‘½åç©ºé—´æä¾›æœåŠ¡ï¼Œå¹¶ä¸”æ¯ä¸ªä»£ç†åªéœ€è¦ä¸ºè‡ªå·±çš„å‘½åç©ºé—´è¿›è¡Œé…ç½®ã€‚æ€»çš„æ¥è¯´ï¼Œæˆ‘ä»¬å‘é€äº† 25% çš„é…ç½®ï¼Œå³ä½¿æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæˆ‘ä»¬å°†æ¯ä¸ªå‘½åç©ºé—´æ‰©å±•åˆ°æœ€å¤š 25 ä¸ªéƒ¨ç½²ï¼Œæ¯ä¸ªéƒ¨ç½²æœ‰ 10 ä¸ª podï¼Œæ¯ä¸ª waypoint éƒ¨ç½²æœ‰ 2 ä¸ª pod ä»¥å®ç°é«˜å¯ç”¨æ€§ï¼Œè¿™äº›æ•°å­—ä¼šæ›´ä»¤äººå°è±¡æ·±åˆ» â€”â€” waypoint é…ç½®åˆ†å¸ƒåªéœ€è¦ sidecar é…ç½®åˆ†å¸ƒçš„ 0.8%ï¼Œå¦‚è¡¨ä¸‹é¢è¯´æ˜ï¼&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;é…ç½®åˆ†å‘&lt;/th&gt;
&lt;th&gt;å‘½åç©ºé—´ 1&lt;/th&gt;
&lt;th&gt;å‘½åç©ºé—´ 2&lt;/th&gt;
&lt;th&gt;æ€»æ•°&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Sidecar&lt;/td&gt;
&lt;td&gt;25 ç§é…ç½® * 250 ä¸ª sidecar&lt;/td&gt;
&lt;td&gt;25 ç§é…ç½® * 250 ä¸ª sidecar&lt;/td&gt;
&lt;td&gt;12500&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Waypoint&lt;/td&gt;
&lt;td&gt;25 ç§é…ç½® * 2 ä¸ª waypoint&lt;/td&gt;
&lt;td&gt;25 ç§é…ç½® * 2 ä¸ª waypoint&lt;/td&gt;
&lt;td&gt;100&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Waypoint/Sidecar&lt;/td&gt;
&lt;td&gt;0.8%&lt;/td&gt;
&lt;td&gt;0.8%&lt;/td&gt;
&lt;td&gt;0.8%&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;è™½ç„¶æˆ‘ä»¬ä½¿ç”¨å‘½åç©ºé—´èŒƒå›´çš„ waypoint ä»£ç†æ¥è¯´æ˜ä¸Šé¢çš„ç®€åŒ–ï¼Œä½†å½“æ‚¨å°†å…¶åº”ç”¨äºæœåŠ¡è´¦æˆ· waypoint ä»£ç†æ—¶ï¼Œç®€åŒ–æ˜¯ç›¸ä¼¼çš„ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ç§å‡å°‘çš„é…ç½®æ„å‘³ç€æ§åˆ¶å¹³é¢å’Œæ•°æ®å¹³é¢çš„èµ„æºä½¿ç”¨ç‡ï¼ˆCPUã€RAM å’Œç½‘ç»œå¸¦å®½ï¼‰è¾ƒä½ã€‚è™½ç„¶ä»Šå¤©çš„ç”¨æˆ·å¯ä»¥é€šè¿‡è°¨æ…ä½¿ç”¨ &lt;code&gt;exportTo&lt;/code&gt; Istio ç½‘ç»œèµ„æºæˆ– &lt;a href=&#34;https://istio.io/latest/docs/reference/config/networking/sidecar/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Sidecar&lt;/a&gt; API çœ‹åˆ°ç±»ä¼¼çš„æ”¹è¿›ï¼Œä½†åœ¨ Ambient æ¨¡å¼ä¸‹ä¸å†éœ€è¦è¿™æ ·åšï¼Œä»è€Œä½¿æ‰©å±•å˜å¾—è½»è€Œæ˜“ä¸¾ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å¦‚æœæˆ‘çš„ç›®çš„åœ°æ²¡æœ‰-waypoint-ä»£ç†æ€ä¹ˆåŠ&#34;&gt;å¦‚æœæˆ‘çš„ç›®çš„åœ°æ²¡æœ‰ waypoint ä»£ç†æ€ä¹ˆåŠï¼Ÿ&lt;/h2&gt;
&lt;p&gt;Ambient æ¨¡å¼çš„è®¾è®¡å›´ç»•è¿™æ ·ä¸€ä¸ªå‡è®¾ï¼Œå³å¤§å¤šæ•°é…ç½®æœ€å¥½ç”±æœåŠ¡ç”Ÿäº§è€…è€Œä¸æ˜¯æœåŠ¡æ¶ˆè´¹è€…å®æ–½ã€‚ç„¶è€Œï¼Œæƒ…å†µå¹¶éæ€»æ˜¯å¦‚æ­¤ â€”â€” æœ‰æ—¶æˆ‘ä»¬éœ€è¦ä¸ºæˆ‘ä»¬æ— æ³•æ§åˆ¶çš„ç›®çš„åœ°é…ç½®æµé‡ç®¡ç†ã€‚ä¸€ä¸ªå¸¸è§çš„ä¾‹å­æ˜¯è¿æ¥åˆ°å…·æœ‰æ›´é«˜å¼¹æ€§çš„å¤–éƒ¨æœåŠ¡ï¼Œä»¥å¤„ç†å¶å°”çš„è¿æ¥é—®é¢˜ï¼ˆä¾‹å¦‚ï¼Œä¸º &lt;code&gt;example.com&lt;/code&gt; è°ƒç”¨æ·»åŠ è¶…æ—¶ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯ç¤¾åŒºä¸­æ­£åœ¨ç§¯æå¼€å‘çš„ä¸€ä¸ªé¢†åŸŸï¼Œæˆ‘ä»¬åœ¨å…¶ä¸­è®¾è®¡å¦‚ä½•å°†æµé‡è·¯ç”±åˆ°æ‚¨çš„å‡ºå£ç½‘å…³ï¼Œä»¥åŠæ‚¨å¦‚ä½•ä½¿ç”¨æ‰€éœ€çš„ç­–ç•¥é…ç½®å‡ºå£ç½‘å…³ã€‚ç•™æ„è¿™æ–¹é¢çš„æœªæ¥åšå®¢æ–‡ç« ï¼&lt;/p&gt;
&lt;h2 id=&#34;æ·±å…¥äº†è§£-waypoint-ä»£ç†é…ç½®&#34;&gt;æ·±å…¥äº†è§£ waypoint ä»£ç†é…ç½®&lt;/h2&gt;
&lt;p&gt;å‡è®¾æ‚¨å·²éµå¾ª &lt;a href=&#34;http://preliminary.istio.io/latest/docs/ops/ambient/getting-started/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Ambient å…¥é—¨æŒ‡å—&lt;/a&gt;ç›´è‡³å¹¶åŒ…æ‹¬&lt;a href=&#34;http://preliminary.istio.io/latest/docs/ops/ambient/getting-started/#control&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ§åˆ¶æµé‡éƒ¨åˆ†&lt;/a&gt;ï¼Œæ‚¨å·²ç»ä¸º bookinfo-reviews æœåŠ¡è´¦æˆ·éƒ¨ç½²äº†ä¸€ä¸ªwaypoint ä»£ç†ï¼Œä»¥å°† 90% çš„æµé‡å¼•å¯¼è‡³ reviews v1ï¼Œå°† 10% çš„æµé‡å¼•å¯¼è‡³ reviews v2ã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ &lt;code&gt;istioctl&lt;/code&gt;æ£€ç´¢ &lt;code&gt;reviews&lt;/code&gt; waypoint ä»£ç†çš„ç›‘å¬å™¨ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ istioctl proxy-config listener deploy/bookinfo-reviews-istio-waypoint --waypoint
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;LISTENER              CHAIN                                                 MATCH                                         DESTINATION
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;envoy://connect_originate                                                       ALL                                           Cluster: connect_originate
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;envoy://main_internal inbound-vip&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;9080&lt;span class=&#34;o&#34;&gt;||&lt;/span&gt;reviews.default.svc.cluster.local-http  &lt;span class=&#34;nv&#34;&gt;ip&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;10.96.104.108 -&amp;gt; &lt;span class=&#34;nv&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;9080&lt;/span&gt;                 Inline Route: /*
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;envoy://main_internal direct-tcp                                            &lt;span class=&#34;nv&#34;&gt;ip&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;10.244.2.14 -&amp;gt; ANY                         Cluster: encap
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;envoy://main_internal direct-tcp                                            &lt;span class=&#34;nv&#34;&gt;ip&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;10.244.1.6 -&amp;gt; ANY                          Cluster: encap
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;envoy://main_internal direct-tcp                                            &lt;span class=&#34;nv&#34;&gt;ip&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;10.244.2.11 -&amp;gt; ANY                         Cluster: encap
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;envoy://main_internal direct-http                                           &lt;span class=&#34;nv&#34;&gt;ip&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;10.244.2.11 -&amp;gt; application-protocol&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;h2c&amp;#39;&lt;/span&gt;  Cluster: encap
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;envoy://main_internal direct-http                                           &lt;span class=&#34;nv&#34;&gt;ip&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;10.244.2.11 -&amp;gt; application-protocol&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;http/1.1&amp;#39;&lt;/span&gt; Cluster: encap
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;envoy://main_internal direct-http                                           &lt;span class=&#34;nv&#34;&gt;ip&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;10.244.2.14 -&amp;gt; application-protocol&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;http/1.1&amp;#39;&lt;/span&gt; Cluster: encap
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;envoy://main_internal direct-http                                           &lt;span class=&#34;nv&#34;&gt;ip&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;10.244.2.14 -&amp;gt; application-protocol&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;h2c&amp;#39;&lt;/span&gt;  Cluster: encap
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;envoy://main_internal direct-http                                           &lt;span class=&#34;nv&#34;&gt;ip&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;10.244.1.6 -&amp;gt; application-protocol&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;h2c&amp;#39;&lt;/span&gt;   Cluster: encap
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;envoy://main_internal direct-http                                           &lt;span class=&#34;nv&#34;&gt;ip&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;10.244.1.6 -&amp;gt; application-protocol&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;http/1.1&amp;#39;&lt;/span&gt;  Cluster: encap
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;envoy://connect_terminate default                                               ALL                                           Inline Route:
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¯¹äºåˆ°è¾¾ç«¯å£ &lt;code&gt;15008&lt;/code&gt; çš„è¯·æ±‚ï¼Œé»˜è®¤ä¸º Istio çš„å…¥ç«™ HBONE ç«¯å£ï¼Œwaypoint ä»£ç†ç»ˆæ­¢ HBONE è¿æ¥å¹¶å°†è¯·æ±‚è½¬å‘åˆ° &lt;code&gt;main_internal&lt;/code&gt; ç›‘å¬å™¨ä»¥æ‰§è¡Œä»»ä½•å·¥ä½œè´Ÿè½½ç­–ç•¥ï¼Œå¦‚ AuthorizationPolicyã€‚å¦‚æœæ‚¨ä¸ç†Ÿæ‚‰&lt;a href=&#34;https://www.envoyproxy.io/docs/envoy/latest/configuration/other_features/internal_listener&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å†…éƒ¨ç›‘å¬å™¨&lt;/a&gt;ï¼Œå®ƒä»¬æ˜¯ Envoy ç›‘å¬å™¨ï¼Œå¯ä»¥æ¥å—ç”¨æˆ·ç©ºé—´è¿æ¥ï¼Œè€Œä¸ä½¿ç”¨ç³»ç»Ÿç½‘ç»œ APIã€‚ä»¥ä¸Šæ·»åŠ åˆ° &lt;code&gt;istioctl proxy-config&lt;/code&gt; å‘½ä»¤çš„ &lt;code&gt;--waypoint&lt;/code&gt; æ ‡å¿—æŒ‡ç¤ºå®ƒæ˜¾ç¤º &lt;code&gt;main_internal&lt;/code&gt; ç›‘å¬å™¨çš„è¯¦ç»†ä¿¡æ¯ã€å…¶è¿‡æ»¤å™¨é“¾ã€é“¾åŒ¹é…å’Œç›®æ ‡ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„ &lt;code&gt;10.96.104.108&lt;/code&gt; æ˜¯ reviews æœåŠ¡ VIPï¼Œè€Œ &lt;code&gt;10.244.x.x&lt;/code&gt; æ˜¯ reviews v1/v2/v3 pod IPï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ &lt;code&gt;kubectl get svc,pod -o wide&lt;/code&gt; å‘½ä»¤æŸ¥çœ‹é›†ç¾¤ã€‚å¯¹äºçº¯æ–‡æœ¬æˆ– HBONE ç»ˆæ­¢çš„å…¥ç«™æµé‡ï¼Œå®ƒå°†åŒ¹é…æœåŠ¡ VIP å’Œç«¯å£ 9080 ä»¥ä¾› reviews ä½¿ç”¨ï¼Œæˆ–è€…é€šè¿‡ pod IP åœ°å€å’Œåº”ç”¨ç¨‹åºåè®®ï¼ˆANYã€h2c æˆ– http/1.1ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;æ£€æŸ¥ reviews waypoint ä»£ç†çš„é›†ç¾¤ï¼Œæ‚¨ä¼šå¾—åˆ° &lt;code&gt;main_internal&lt;/code&gt; é›†ç¾¤ä»¥åŠä¸€äº›å…¥ç«™é›†ç¾¤ã€‚é™¤äº†åŸºç¡€æ¶æ„çš„é›†ç¾¤ä¹‹å¤–ï¼Œåˆ›å»ºçš„å”¯ä¸€ Envoy é›†ç¾¤æ˜¯è¿è¡Œåœ¨åŒä¸€æœåŠ¡è´¦æˆ·ä¸­çš„æœåŠ¡å’Œ pod çš„é›†ç¾¤ã€‚æ²¡æœ‰ä¸ºå…¶ä»–åœ°æ–¹è¿è¡Œçš„æœåŠ¡æˆ– pod åˆ›å»ºé›†ç¾¤ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ istioctl proxy-config clusters deploy/bookinfo-reviews-istio-waypoint
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;SERVICE FQDN                         PORT SUBSET  DIRECTION   TYPE         DESTINATION RULE
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;agent                                -    -       -           STATIC
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;connect_originate                    -    -       -           ORIGINAL_DST
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;encap                                -    -       -           STATIC
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubernetes.default.svc.cluster.local &lt;span class=&#34;m&#34;&gt;443&lt;/span&gt;  tcp     inbound-vip EDS
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;main_internal                        -    -       -           STATIC
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;prometheus_stats                     -    -       -           STATIC
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;reviews.default.svc.cluster.local    &lt;span class=&#34;m&#34;&gt;9080&lt;/span&gt; http    inbound-vip EDS
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;reviews.default.svc.cluster.local    &lt;span class=&#34;m&#34;&gt;9080&lt;/span&gt; http/v1 inbound-vip EDS
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;reviews.default.svc.cluster.local    &lt;span class=&#34;m&#34;&gt;9080&lt;/span&gt; http/v2 inbound-vip EDS
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;reviews.default.svc.cluster.local    &lt;span class=&#34;m&#34;&gt;9080&lt;/span&gt; http/v3 inbound-vip EDS
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;sds-grpc                             -    -       -           STATIC
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;xds-grpc                             -    -       -           STATIC
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;zipkin                               -    -       -           STRICT_DNS
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¯·æ³¨æ„åˆ—è¡¨ä¸­æ²¡æœ‰ &lt;code&gt;outbound&lt;/code&gt; é›†ç¾¤ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ &lt;code&gt;istioctl proxy-config cluster deploy/bookinfo-reviews-istio-waypoint --direction outbound&lt;/code&gt; è¿›è¡Œç¡®è®¤ï¼å¾ˆå¥½çš„ä¸€ç‚¹æ˜¯ï¼Œæ‚¨ä¸éœ€è¦åœ¨ä»»ä½•å…¶ä»– bookinfo æœåŠ¡ï¼ˆä¾‹å¦‚&lt;code&gt;productpage&lt;/code&gt; æˆ– &lt;code&gt;ratings&lt;/code&gt; æœåŠ¡ï¼‰ä¸Šé…ç½® &lt;code&gt;exportTo&lt;/code&gt;ã€‚æ¢å¥è¯è¯´ï¼Œ&lt;code&gt;reviews&lt;/code&gt; waypoint ä¸ä¼šæ„è¯†åˆ°ä»»ä½•ä¸å¿…è¦çš„é›†ç¾¤ï¼Œè€Œæ‚¨ä¸éœ€è¦è¿›è¡Œä»»ä½•é¢å¤–çš„æ‰‹åŠ¨é…ç½®ã€‚&lt;/p&gt;
&lt;p&gt;æ˜¾ç¤º &lt;code&gt;reviews&lt;/code&gt; waypoint ä»£ç†çš„è·¯ç”±åˆ—è¡¨ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ istioctl proxy-config routes deploy/bookinfo-reviews-istio-waypoint
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;NAME                                                    DOMAINS MATCH              VIRTUAL SERVICE
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;encap                                                   *       /*
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;inbound-vip&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;9080&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;http&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;reviews.default.svc.cluster.local *       /*                 reviews.default
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;default
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å›é¡¾ä¸‹ï¼Œæ‚¨æ²¡æœ‰é…ç½®ä»»ä½• sidecar èµ„æºæˆ– Istio ç½‘ç»œèµ„æºä¸Šçš„ &lt;code&gt;exportTo&lt;/code&gt; é…ç½®ã€‚ ä½†æ˜¯ï¼Œæ‚¨éƒ¨ç½²äº† &lt;code&gt;bookinfo-productpage&lt;/code&gt; è·¯ç”±æ¥é…ç½®å…¥å£ç½‘å…³ä»¥è·¯ç”±åˆ° productpageï¼Œä½† reviews waypoint æ²¡æœ‰æ„è¯†åˆ°ä»»ä½•æ­¤ç±»ä¸ç›¸å…³çš„è·¯ç”±ã€‚&lt;/p&gt;
&lt;p&gt;æ˜¾ç¤º &lt;code&gt;inbound-vip|9080|http|reviews.default.svc.cluster.local&lt;/code&gt; è·¯ç”±çš„è¯¦ç»†ä¿¡æ¯ï¼Œæ‚¨ä¼šçœ‹åˆ°åŸºäºæƒé‡çš„è·¯ç”±é…ç½®å°† 90ï¼…çš„æµé‡å®šå‘åˆ° &lt;code&gt;reviews&lt;/code&gt; v1ï¼Œå°† 10ï¼…çš„æµé‡å®šå‘åˆ° &lt;code&gt;reviews&lt;/code&gt; v2ï¼Œä»¥åŠä¸€äº› Istio çš„é»˜è®¤é‡è¯•å’Œè¶…æ—¶é…ç½®ã€‚ è¿™è¯å®äº†ä¹‹å‰è®¨è®ºçš„æµé‡å’Œå¼¹æ€§ç­–ç•¥ä»æºå¤´è½¬ç§»åˆ°ç›®æ ‡å¯¼å‘çš„ waypointã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ istioctl proxy-config routes deploy/bookinfo-reviews-istio-waypoint --name &lt;span class=&#34;s2&#34;&gt;&amp;#34;inbound-vip|9080|http|reviews.default.svc.cluster.local&amp;#34;&lt;/span&gt; -o yaml
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;- name: inbound-vip&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;9080&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;http&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;reviews.default.svc.cluster.local
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; validateClusters: &lt;span class=&#34;nb&#34;&gt;false&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; virtualHosts:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; - domains:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   - &lt;span class=&#34;s1&#34;&gt;&amp;#39;*&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   name: inbound&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;http&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;9080&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   routes:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   - decorator:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;       operation: reviews:9080/*
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;     match:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;       prefix: /
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;     metadata:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;       filterMetadata:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;         istio:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;           config: /apis/networking.istio.io/v1alpha3/namespaces/default/virtual-service/reviews
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;     route:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;       maxGrpcTimeout: 0s
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;       retryPolicy:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;         hostSelectionRetryMaxAttempts: &lt;span class=&#34;s2&#34;&gt;&amp;#34;5&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;         numRetries: &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;         retriableStatusCodes:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;         - &lt;span class=&#34;m&#34;&gt;503&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;         retryHostPredicate:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;         - name: envoy.retry_host_predicates.previous_hosts
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;           typedConfig:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;             &lt;span class=&#34;s1&#34;&gt;&amp;#39;@type&amp;#39;&lt;/span&gt;: type.googleapis.com/envoy.extensions.retry.host.previous_hosts.v3.PreviousHostsPredicate
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;         retryOn: connect-failure,refused-stream,unavailable,cancelled,retriable-status-codes
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;       timeout: 0s
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;       weightedClusters:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;         clusters:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;         - name: inbound-vip&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;9080&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;http/v1&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;reviews.default.svc.cluster.local
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;           weight: &lt;span class=&#34;m&#34;&gt;90&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;         - name: inbound-vip&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;9080&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;http/v2&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;reviews.default.svc.cluster.local
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;           weight: &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ£€æŸ¥&lt;code&gt;reviews&lt;/code&gt; waypoint ä»£ç†çš„ç«¯ç‚¹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ istioctl proxy-config endpoints deploy/bookinfo-reviews-istio-waypoint
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ENDPOINT                                            STATUS  OUTLIER CHECK CLUSTER
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;127.0.0.1:15000                                     HEALTHY OK            prometheus_stats
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;127.0.0.1:15020                                     HEALTHY OK            agent
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;envoy://connect_originate/                          HEALTHY OK            encap
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;envoy://connect_originate/10.244.1.6:9080           HEALTHY OK            inbound-vip&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;9080&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;http/v2&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;reviews.default.svc.cluster.local
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;envoy://connect_originate/10.244.1.6:9080           HEALTHY OK            inbound-vip&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;9080&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;http&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;reviews.default.svc.cluster.local
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;envoy://connect_originate/10.244.2.11:9080          HEALTHY OK            inbound-vip&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;9080&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;http/v1&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;reviews.default.svc.cluster.local
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;envoy://connect_originate/10.244.2.11:9080          HEALTHY OK            inbound-vip&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;9080&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;http&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;reviews.default.svc.cluster.local
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;envoy://connect_originate/10.244.2.14:9080          HEALTHY OK            inbound-vip&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;9080&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;http/v3&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;reviews.default.svc.cluster.local
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;envoy://connect_originate/10.244.2.14:9080          HEALTHY OK            inbound-vip&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;9080&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;http&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;reviews.default.svc.cluster.local
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;envoy://main_internal/                              HEALTHY OK            main_internal
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;unix://./etc/istio/proxy/XDS                        HEALTHY OK            xds-grpc
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;unix://./var/run/secrets/workload-spiffe-uds/socket HEALTHY OK            sds-grpc
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¯·æ³¨æ„ï¼Œæ‚¨ä¸ä¼šè·å¾—ä¸ reviews ä»¥å¤–çš„ä»»ä½•æœåŠ¡ç›¸å…³çš„ä»»ä½•ç«¯ç‚¹ï¼Œå³ä½¿æ‚¨åœ¨ &lt;code&gt;default&lt;/code&gt; å’Œ &lt;code&gt;istio-system&lt;/code&gt; å‘½åç©ºé—´ä¸­è¿˜æœ‰ä¸€äº›å…¶ä»–æœåŠ¡ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬å¯¹ä¸“æ³¨äºé¢å‘ç›®çš„åœ°çš„ waypoint ä»£ç†çš„ç®€åŒ–æ„Ÿåˆ°éå¸¸å…´å¥‹ã€‚è¿™æ˜¯æœç€ç®€åŒ– Istio çš„å¯ç”¨æ€§ã€å¯æ‰©å±•æ€§å’Œå¯è°ƒè¯•æ€§è¿ˆå‡ºçš„åˆä¸€é‡è¦æ­¥éª¤ï¼Œè¿™äº›æ˜¯ Istio è·¯çº¿å›¾ä¸Šçš„é‡ä¸­ä¹‹é‡ã€‚æŒ‰ç…§æˆ‘ä»¬çš„&lt;a href=&#34;http://preliminary.istio.io/latest/docs/ops/ambient/getting-started/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å…¥é—¨æŒ‡å—&lt;/a&gt;ç«‹å³å°è¯•ç¯å¢ƒ alpha æ„å»ºå¹¶ä½“éªŒç®€åŒ–çš„waypoint ä»£ç†ï¼&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>ä½¿ç”¨ OCI å®¹å™¨è¿è¡Œ WebAssembly å·¥ä½œè´Ÿè½½</title>
      <link>https://lib.jimmysong.io/blog/wasm-containers/</link>
      <pubDate>Mon, 03 Apr 2023 20:00:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/wasm-containers/</guid>
      <description>&lt;blockquote&gt;
&lt;p&gt;è¯‘è€…æ³¨ï¼šæœ¬æ–‡ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨ OCI å®¹å™¨æ¥è¿è¡Œ WebAssembly å·¥ä½œè´Ÿè½½ã€‚WebAssemblyï¼ˆä¹Ÿç§°ä¸º Wasmï¼‰æ˜¯ä¸€ç§å¯ç§»æ¤çš„äºŒè¿›åˆ¶æŒ‡ä»¤æ ¼å¼ï¼Œå…·æœ‰å¯åµŒå…¥å’Œéš”ç¦»çš„æ‰§è¡Œç¯å¢ƒï¼Œé€‚ç”¨äºå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨åº”ç”¨ã€‚WebAssembly å¯ä»¥çœ‹ä½œæ˜¯ä¸€ç§å°å·§ã€å¿«é€Ÿã€é«˜æ•ˆã€å®‰å…¨çš„åŸºäºæ ˆçš„è™šæ‹Ÿæœºï¼Œè®¾è®¡ç”¨äºæ‰§è¡Œä¸å…³å¿ƒ CPU æˆ–æ“ä½œç³»ç»Ÿçš„å¯ç§»æ¤å­—èŠ‚ç ã€‚WebAssembly æœ€åˆæ˜¯ä¸º web æµè§ˆå™¨è®¾è®¡çš„ï¼Œç”¨æ¥ä½œä¸ºå‡½æ•°çš„è½»é‡çº§ã€å¿«é€Ÿã€å®‰å…¨ã€å¤šè¯­è¨€çš„å®¹å™¨ï¼Œä½†å®ƒä¸å†å±€é™äº webã€‚åœ¨ web ä¸Šï¼ŒWebAssembly ä½¿ç”¨æµè§ˆå™¨æä¾›çš„ç°æœ‰ APIã€‚WebAssembly System Interfaceï¼ˆWASIï¼‰æ˜¯ä¸ºäº†å¡«è¡¥ WebAssembly å’Œæµè§ˆå™¨å¤–ç³»ç»Ÿä¹‹é—´çš„ç©ºç™½è€Œåˆ›å»ºçš„ã€‚è¿™ä½¿å¾—éæµè§ˆå™¨ç³»ç»Ÿå¯ä»¥åˆ©ç”¨ WebAssembly çš„å¯ç§»æ¤æ€§ï¼Œä½¿ WASI æˆä¸ºåˆ†å‘å’Œéš”ç¦»å·¥ä½œè´Ÿè½½æ—¶çš„ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ã€‚æ–‡ç« ä¸­ä»‹ç»äº†å¦‚ä½•é…ç½®å®¹å™¨è¿è¡Œæ—¶æ¥ä»è½»é‡çº§å®¹å™¨é•œåƒä¸­è¿è¡Œ Wasm å·¥ä½œè´Ÿè½½ï¼Œå¹¶ç»™å‡ºäº†ä¸€äº›ä½¿ç”¨ç¤ºä¾‹ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;WebAssemblyï¼ˆä¹Ÿç§°ä¸º Wasmï¼‰ä»¥å…¶å¯åµŒå…¥å’Œéš”ç¦»çš„æ‰§è¡Œç¯å¢ƒè€Œæˆä¸ºä¸€ç§æµè¡Œçš„ä¾¿æºå¼äºŒè¿›åˆ¶æŒ‡ä»¤æ ¼å¼ï¼Œç”¨äºå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨åº”ç”¨ç¨‹åºã€‚å°† WebAssembly è§†ä¸ºä¸€ç§å°å‹ã€å¿«é€Ÿã€é«˜æ•ˆä¸”éå¸¸å®‰å…¨çš„åŸºäºå †æ ˆçš„è™šæ‹Ÿæœºï¼Œä¸“é—¨ç”¨äºæ‰§è¡Œå¯ç§»æ¤çš„å­—èŠ‚ç ï¼Œä¸åœ¨ä¹å®ƒè¿è¡Œåœ¨å“ªä¸ª CPU æˆ–æ“ä½œç³»ç»Ÿä¸Šã€‚WebAssembly æœ€åˆæ˜¯ä¸º Web æµè§ˆå™¨è®¾è®¡çš„ï¼Œç”¨äºæˆä¸ºå‡½æ•°çš„è½»é‡çº§ã€å¿«é€Ÿã€å®‰å…¨å’Œå¤šè¯­è¨€å®¹å™¨ï¼Œä½†å®ƒä¸å†ä»…é™äº Webã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ Web ä¸Šï¼ŒWebAssembly ä½¿ç”¨æµè§ˆå™¨æä¾›çš„ç°æœ‰ APIã€‚WebAssembly ç³»ç»Ÿæ¥å£ï¼ˆWASIï¼‰çš„åˆ›å»ºå¡«è¡¥äº† WebAssembly å’Œè¿è¡Œåœ¨æµè§ˆå™¨å¤–éƒ¨çš„ç³»ç»Ÿä¹‹é—´çš„ç©ºç™½ã€‚è¿™ä½¿éæµè§ˆå™¨ç³»ç»Ÿèƒ½å¤Ÿåˆ©ç”¨ WebAssembly çš„å¯ç§»æ¤æ€§ï¼Œä½¿ WASI æˆä¸ºåœ¨åˆ†å‘æ—¶å…·æœ‰å¯ç§»æ¤æ€§å’Œåœ¨è¿è¡Œè´Ÿè½½æ—¶å…·æœ‰éš”ç¦»æ€§çš„è‰¯å¥½é€‰æ‹©ã€‚&lt;/p&gt;
&lt;p&gt;WebAssembly æä¾›äº†å‡ ä¸ªä¼˜ç‚¹ã€‚å› ä¸ºå®ƒæ˜¯å¹³å°ä¸­ç«‹çš„ï¼Œæ‰€ä»¥å¯ä»¥åœ¨å¤šä¸ªæ“ä½œç³»ç»Ÿå’Œæ¶æ„ä¸ŠåŒæ—¶ç¼–è¯‘å’Œæ‰§è¡Œä¸€ä¸ªå•ä¸€çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå…·æœ‰éå¸¸ä½çš„ç£ç›˜å ç”¨å’Œå¯åŠ¨æ—¶é—´ã€‚æœ‰ç”¨çš„å®‰å…¨åŠŸèƒ½åŒ…æ‹¬æ¨¡å—ç­¾åå’Œå¯ä»¥åœ¨è¿è¡Œæ—¶çº§åˆ«ä¸Šæ§åˆ¶çš„å®‰å…¨è°ƒèŠ‚å™¨ï¼Œè€Œä¸æ˜¯ä¾èµ–äºä¸»æœºæ“ä½œç³»ç»Ÿçš„ç”¨æˆ·æƒé™ã€‚å°é—­å¼å†…å­˜ä»ç„¶å¯ä»¥ç”±ç°æœ‰çš„å®¹å™¨å·¥å…·åŸºç¡€æ¶æ„è¿›è¡Œç®¡ç†ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†é€šè¿‡ä¸€ä¸ªé…ç½®å®¹å™¨è¿è¡Œæ—¶æ¥è¿è¡Œè½»é‡çº§å®¹å™¨é•œåƒä¸­çš„ Wasm å·¥ä½œè´Ÿè½½çš„æ–¹æ¡ˆæ¥è®²è§£ã€‚&lt;/p&gt;
&lt;h2 id=&#34;webassembly-åœ¨äº‘åŸºç¡€è®¾æ–½ä¸Šçš„é‡‡ç”¨å’Œé˜»ç¢&#34;&gt;WebAssembly åœ¨äº‘åŸºç¡€è®¾æ–½ä¸Šçš„é‡‡ç”¨å’Œé˜»ç¢&lt;/h2&gt;
&lt;p&gt;WebAssembly å’Œ WASI ç›¸å½“æ–°ï¼Œå› æ­¤å°šæœªè®¾ç½®åœ¨å®¹å™¨ç”Ÿæ€ç³»ç»Ÿä¸­æœ¬åœ°è¿è¡Œ Wasm å·¥ä½œè´Ÿè½½çš„æ ‡å‡†ã€‚æœ¬æ–‡ä»…ä»‹ç»ä¸€ç§è§£å†³æ–¹æ¡ˆï¼Œä½†è¿˜æœ‰å…¶ä»–å¯è¡Œçš„æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;å…¶ä¸­ä¸€äº›è§£å†³æ–¹æ¡ˆåŒ…æ‹¬ä½¿ç”¨å…¼å®¹ Wasm çš„ç»„ä»¶æ›¿æ¢æœ¬æœº Linux å®¹å™¨è¿è¡Œæ—¶ã€‚ä¾‹å¦‚ï¼ŒKrustlet v1.0.0-alpha1 å…è®¸ç”¨æˆ·å¼•å…¥ Kubernetes èŠ‚ç‚¹ï¼Œå…¶ä¸­ Krustlet ç”¨ä½œæ ‡å‡† kubelet çš„æ›¿ä»£å“ã€‚è¿™ç§æ–¹æ³•çš„å±€é™æ€§åœ¨äºç”¨æˆ·å¿…é¡»åœ¨ Linux å®¹å™¨è¿è¡Œæ—¶å’Œ Wasm è¿è¡Œæ—¶ä¹‹é—´è¿›è¡Œé€‰æ‹©ã€‚&lt;/p&gt;
&lt;p&gt;å¦ä¸€ç§è§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨å¸¦æœ‰ Wasm è¿è¡Œæ—¶çš„åŸºæœ¬é•œåƒï¼Œå¹¶æ‰‹åŠ¨è°ƒç”¨ç¼–è¯‘åçš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬åœ¨ä½äºå®¹å™¨è¿è¡Œæ—¶çš„ä¸€çº§åˆ«è°ƒç”¨ Wasm è¿è¡Œæ—¶ï¼Œè¿™ç§æ–¹æ³•ä¼šä½¿å®¹å™¨é•œåƒè†¨èƒ€ï¼Œè¿™ä¸ä¸€å®šæ˜¯å¿…éœ€çš„ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘å°†æè¿°å¦‚ä½•é€šè¿‡åˆ›å»ºä¸€ä¸ªæ··åˆè®¾ç½®æ¥é¿å…è¿™ç§æƒ…å†µï¼Œå…¶ä¸­ç°æœ‰çš„ Open Containers Initiativeï¼ˆOCIï¼‰è¿è¡Œæ—¶å¯ä»¥è¿è¡Œæœ¬åœ° Linux å®¹å™¨å’Œä¸ WASI å…¼å®¹çš„å·¥ä½œè´Ÿè½½ã€‚&lt;/p&gt;
&lt;h2 id=&#34;åœ¨æ··åˆè®¾ç½®ä¸­ä½¿ç”¨-crun-è¿è¡Œ-wasm-å’Œ-linux-å®¹å™¨&#34;&gt;åœ¨æ··åˆè®¾ç½®ä¸­ä½¿ç”¨ crun è¿è¡Œ Wasm å’Œ Linux å®¹å™¨&lt;/h2&gt;
&lt;p&gt;ä¸€äº›ä¸Šè¿°é—®é¢˜å¯ä»¥é€šè¿‡å…è®¸ç°æœ‰çš„ OCI è¿è¡Œæ—¶åœ¨è¾ƒä½çº§åˆ«ä¸Šè°ƒç”¨ Linux å®¹å™¨å’Œ Wasm å®¹å™¨æ¥è½»æ¾è§£å†³ã€‚è¿™é¿å…äº†ä¾èµ–å®¹å™¨é•œåƒæºå¸¦ Wasm è¿è¡Œæ—¶æˆ–å¼•å…¥ä»…æ”¯æŒ Wasm å®¹å™¨çš„åŸºç¡€æ¶æ„æ–°å±‚çš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥å¤„ç†æ­¤ä»»åŠ¡çš„ä¸€ä¸ªå®¹å™¨è¿è¡Œæ—¶æ˜¯ crunã€‚&lt;/p&gt;
&lt;p&gt;Crun å¿«é€Ÿï¼Œå ç”¨å†…å­˜ä½ï¼Œæ˜¯ä¸€ä¸ªå®Œå…¨ç¬¦åˆ OCI çš„å®¹å™¨è¿è¡Œæ—¶ï¼Œå¯ä»¥ç”¨ä½œç°æœ‰å®¹å™¨è¿è¡Œæ—¶çš„æ›¿ä»£å“ã€‚ Crun æœ€åˆæ˜¯ç¼–å†™ç”¨äºè¿è¡Œ Linux å®¹å™¨çš„ï¼Œä½†å®ƒè¿˜æä¾›äº†èƒ½å¤Ÿåœ¨æœ¬åœ°æ–¹å¼ä¸‹åœ¨å®¹å™¨æ²™ç›’ä¸­è¿è¡Œä»»æ„æ‰©å±•çš„å¤„ç†ç¨‹åºã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯ç”¨ crun æ›¿æ¢ç°æœ‰è¿è¡Œæ—¶çš„ä¸€ç§éæ­£å¼æ–¹å¼ï¼Œä»…ç”¨äºå±•ç¤º crun æ˜¯æ‚¨ç°æœ‰ OCI è¿è¡Œæ—¶çš„å®Œæ•´æ›¿ä»£å“ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ mv /path/to/exisiting-runtime /path/to/existing-runtime.backup
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ cp /path/to/crun /path/to/existing-runtime
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å…¶ä¸­ä¹‹ä¸€å¤„ç†ç¨‹åºæ˜¯ &lt;code&gt;crun-wasm-handler&lt;/code&gt;ï¼Œå®ƒå°†ç‰¹åˆ«é…ç½®çš„å®¹å™¨é•œåƒï¼ˆ&lt;em&gt;Wasm å…¼å®¹é•œåƒ&lt;/em&gt;ï¼‰å§”æ´¾ç»™ç°æœ‰ Wasm è¿è¡Œæ—¶çš„éƒ¨åˆ†ï¼Œä»¥æœ¬åœ°æ–¹å¼åœ¨ crun æ²™ç›’å†…è¿è¡Œã€‚è¿™æ ·ï¼Œç»ˆç«¯ç”¨æˆ·æ— éœ€è‡ªå·±ç»´æŠ¤ Wasm è¿è¡Œæ—¶ã€‚&lt;/p&gt;
&lt;p&gt;Crun ä¸ &lt;a href=&#34;https://wasmedge.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;wasmedge&lt;/a&gt;ã€&lt;a href=&#34;https://wasmtime.dev/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;wasmtime&lt;/a&gt; å’Œ &lt;a href=&#34;https://wasmer.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;wasmer&lt;/a&gt; å…·æœ‰æœ¬åœ°é›†æˆï¼Œä»¥æ”¯æŒæ­¤åŠŸèƒ½ã€‚å®ƒåœ¨ crun æ£€æµ‹åˆ°é…ç½®çš„é•œåƒæ˜¯å¦åŒ…å«ä»»ä½• Wasm/WASI å·¥ä½œè´Ÿè½½æ—¶åŠ¨æ€åœ°è°ƒç”¨è¿™äº›è¿è¡Œæ—¶çš„éƒ¨åˆ†ï¼ŒåŒæ—¶ä»æ”¯æŒæœ¬åœ° Linux å®¹å™¨ã€‚&lt;/p&gt;
&lt;p&gt;æœ‰å…³ä½¿ç”¨ Wasm/WASI æ”¯æŒæ„å»º crun çš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§ &lt;a href=&#34;https://github.com/containers/crun/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;GitHub ä¸Šçš„ crun å­˜å‚¨åº“&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;åœ¨-podman-å’Œ-kubernetes-ä¸Šä½¿ç”¨-buildah-æ„å»ºå’Œè¿è¡Œ-wasm-é•œåƒ&#34;&gt;åœ¨ Podman å’Œ Kubernetes ä¸Šä½¿ç”¨ Buildah æ„å»ºå’Œè¿è¡Œ Wasm é•œåƒ&lt;/h2&gt;
&lt;p&gt;ç”¨æˆ·å¯ä»¥åœ¨ Podman å’Œ Kubernetes ä¸Šä½¿ç”¨ crun ä½œä¸º OCI è¿è¡Œæ—¶æ¥åˆ›å»ºå’Œè¿è¡Œå¹³å°æ— å…³çš„ Wasm é•œåƒã€‚ä»¥ä¸‹æ˜¯æ•™ç¨‹ï¼š&lt;/p&gt;
&lt;h3 id=&#34;ä½¿ç”¨-buildah-åˆ›å»º-wasm-å…¼å®¹é•œåƒ&#34;&gt;ä½¿ç”¨ Buildah åˆ›å»º Wasm å…¼å®¹é•œåƒ&lt;/h3&gt;
&lt;p&gt;Wasm/WASI å…¼å®¹é•œåƒå¾ˆç‰¹åˆ«ã€‚å®ƒä»¬åŒ…å«ä¸€ä¸ªé­”æœ¯æ³¨é‡Šï¼Œå¯å¸®åŠ©åƒ crun è¿™æ ·çš„ OCI è¿è¡Œæ—¶åˆ†ç±»åˆ«å®ƒæ˜¯ Linux æœ¬æœºé•œåƒè¿˜æ˜¯å¸¦æœ‰ Wasm/WASI å·¥ä½œè´Ÿè½½çš„é•œåƒã€‚ç„¶åï¼Œå¦‚æœéœ€è¦ï¼Œå®ƒå¯ä»¥è°ƒç”¨å¤„ç†ç¨‹åºã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ä»»ä½•å®¹å™¨é•œåƒæ„å»ºå·¥å…·éƒ½å¯ä»¥éå¸¸è½»æ¾åœ°åˆ›å»ºè¿™äº› Wasm å…¼å®¹é•œåƒï¼Œä½†æ˜¯å¯¹äºæœ¬æ–‡ï¼Œæˆ‘å°†æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨ &lt;a href=&#34;https://opensource.com/article/22/2/build-your-own-container-linux-buildah&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Buildah&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ç¼–è¯‘æ‚¨çš„ &lt;code&gt;.wasm&lt;/code&gt; æ¨¡å—ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨æ‚¨çš„ &lt;code&gt;.wasm&lt;/code&gt; æ¨¡å—å‡†å¤‡ä¸€ä¸ª Containerfileã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-dockerfile&#34; data-lang=&#34;dockerfile&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;FROM&lt;/span&gt;&lt;span class=&#34;s&#34;&gt; scratch&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;COPY&lt;/span&gt; hello.wasm /&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;CMD&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/hello.wasm&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ol start=&#34;3&#34;&gt;
&lt;li&gt;ä½¿ç”¨ Buildah ä½¿ç”¨æ³¨é‡Š &lt;code&gt;module.wasm.image/variant=compat&lt;/code&gt; æ„å»º Wasm é•œåƒã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ buildah build --annotation &lt;span class=&#34;s2&#34;&gt;&amp;#34;module.wasm.image/variant=compat&amp;#34;&lt;/span&gt; -t mywasm-image
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ„å»ºå®Œé•œåƒå¹¶ä¸”å®¹å™¨å¼•æ“å·²é…ç½®ä¸ºä½¿ç”¨ crunï¼Œcrun å°†è‡ªåŠ¨å®Œæˆå·¥ä½œå¹¶é€šè¿‡é…ç½®çš„ Wasm å¤„ç†ç¨‹åºè¿è¡Œæä¾›çš„å·¥ä½œè´Ÿè½½ã€‚&lt;/p&gt;
&lt;h3 id=&#34;åœ¨-podman-ä¸­è¿è¡Œ-wasm-å·¥ä½œè´Ÿè½½&#34;&gt;åœ¨ Podman ä¸­è¿è¡Œ WASM å·¥ä½œè´Ÿè½½&lt;/h3&gt;
&lt;p&gt;Crun æ˜¯ Podman çš„é»˜è®¤ OCI è¿è¡Œæ—¶ã€‚ Podman åŒ…å«æ—‹é’®å’Œå¤„ç†ç¨‹åºï¼Œå¯åˆ©ç”¨å¤§å¤šæ•° crun åŠŸèƒ½ï¼ŒåŒ…æ‹¬ crun Wasm å¤„ç†ç¨‹åºã€‚æ„å»º Wasm å…¼å®¹é•œåƒåï¼Œå®ƒå¯ä»¥åƒä»»ä½•å…¶ä»–å®¹å™¨é•œåƒä¸€æ ·ç”± Podman ä½¿ç”¨ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ podman run mywasm-image:latest
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Podman ä½¿ç”¨ crun çš„ Wasm å¤„ç†ç¨‹åºè¿è¡Œè¯·æ±‚çš„ Wasm å…¼å®¹é•œåƒ &lt;code&gt;mywasm-image:latest&lt;/code&gt;ï¼Œå¹¶è¿”å›ç¡®è®¤æˆ‘ä»¬çš„å·¥ä½œè´Ÿè½½å·²æ‰§è¡Œçš„è¾“å‡ºã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ hello world from the webassembly module !!!!
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;kubernetes-æ”¯æŒå’Œæµ‹è¯•çš„å®¹å™¨è¿è¡Œæ—¶æ¥å£criå®ç°&#34;&gt;Kubernetes æ”¯æŒå’Œæµ‹è¯•çš„å®¹å™¨è¿è¡Œæ—¶æ¥å£ï¼ˆCRIï¼‰å®ç°&lt;/h3&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯é…ç½®ä¸¤ä¸ªæµè¡Œçš„å®¹å™¨è¿è¡Œæ—¶çš„æ–¹æ³•ï¼š&lt;/p&gt;
&lt;h3 id=&#34;cri-o&#34;&gt;CRI-O&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;é€šè¿‡ç¼–è¾‘ &lt;code&gt;/etc/crio/crio.conf&lt;/code&gt; ä¸Šçš„é…ç½®å°† CRI-O é…ç½®ä¸ºä½¿ç”¨ crun è€Œä¸æ˜¯ runcã€‚ Red Hat OpenShift æ–‡æ¡£åŒ…å«æœ‰å…³ &lt;a href=&#34;https://docs.openshift.com/container-platform/3.11/crio/crio_runtime.html#configure-crio-use-crio-engine&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;é…ç½® CRI-O&lt;/a&gt; çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ &lt;code&gt;sudo systemctl restart crio&lt;/code&gt; é‡æ–°å¯åŠ¨ CRI-Oã€‚&lt;/li&gt;
&lt;li&gt;CRI-O è‡ªåŠ¨å°† pod æ³¨é‡Šä¼ æ’­åˆ°å®¹å™¨è§„èŒƒã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;containerd&#34;&gt;Containerd&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Containerd æ”¯æŒé€šè¿‡è‡ªå®šä¹‰é…ç½®å®šä¹‰åœ¨ &lt;code&gt;/etc/containerd/config.toml&lt;/code&gt; ä¸­åˆ‡æ¢å®¹å™¨è¿è¡Œæ—¶ã€‚&lt;/li&gt;
&lt;li&gt;é€šè¿‡ç¡®ä¿è¿è¡Œæ—¶äºŒè¿›åˆ¶æ–‡ä»¶æŒ‡å‘ crunï¼Œå°† containerd é…ç½®ä¸ºä½¿ç”¨ crunã€‚æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§ &lt;a href=&#34;https://github.com/containerd/containerd/blob/main/docs/cri/config.md&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;containerd æ–‡æ¡£&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;é€šè¿‡è®¾ç½® &lt;code&gt;pod_annotations = [&amp;quot;module.wasm.image/variant.*&amp;quot;]&lt;/code&gt; åœ¨é…ç½®ä¸­å…è®¸åˆ—å‡º Wasm æ³¨é‡Šï¼Œä»¥ä¾¿å°†å®ƒä»¬ä¼ æ’­åˆ° OCI è§„èŒƒã€‚ç„¶åä½¿ç”¨ &lt;code&gt;sudo systemctl start containerd&lt;/code&gt; é‡æ–°å¯åŠ¨ containerdã€‚&lt;/li&gt;
&lt;li&gt;ç°åœ¨ï¼Œcontainerd åº”è¯¥å°† Wasm pod æ³¨é‡Šä¼ æ’­åˆ°å®¹å™¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯ä¸ CRI-O å’Œ containerd å…¼å®¹çš„ Kubernetes pod è§„èŒƒç¤ºä¾‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;v1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Pod&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;pod-with-wasm-workload&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;mynamespace&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;annotations&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;module.wasm.image/variant&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;compat&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;containers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;wasm-container&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;image&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;myrepo/mywasmimage:latest&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;å·²çŸ¥é—®é¢˜å’Œè§£å†³æ–¹æ³•&#34;&gt;å·²çŸ¥é—®é¢˜å’Œè§£å†³æ–¹æ³•&lt;/h2&gt;
&lt;p&gt;å¤æ‚çš„ Kubernetes åŸºç¡€æ¶æ„åŒ…å« podï¼Œè€Œä¸”åœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œè¿™äº› pod è¿˜åŒ…æ‹¬ sidecarã€‚è¿™æ„å‘³ç€å½“éƒ¨ç½²åŒ…å« sidecar å¹¶ä¸” sidecar å®¹å™¨ä¸åŒ…å« Wasm å…¥å£ç‚¹ï¼ˆä¾‹å¦‚åƒ Linkerdã€Gloo å’Œ Istio è¿™æ ·çš„æœåŠ¡ç½‘æ ¼æˆ– Envoy è¿™æ ·çš„ä»£ç†çš„åŸºç¡€æ¶æ„è®¾ç½®ï¼‰æ—¶ï¼Œcrun çš„ Wasm é›†æˆå°†æ— ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;æ‚¨å¯ä»¥é€šè¿‡æ·»åŠ ä¸¤ä¸ªæ™ºèƒ½æ³¨é‡Šæ¥è§£å†³æ­¤é—®é¢˜ï¼Œç”¨äº Wasm å¤„ç†ç¨‹åºï¼š&lt;code&gt;compat-smart&lt;/code&gt; å’Œ &lt;code&gt;wasm-smart&lt;/code&gt;ã€‚è¿™äº›æ³¨é‡Šå……å½“æ™ºèƒ½å¼€å…³ï¼Œä»…åœ¨å®¹å™¨éœ€è¦æ—¶åˆ‡æ¢ Wasm è¿è¡Œæ—¶ã€‚å› æ­¤ï¼Œåœ¨è¿è¡Œå¸¦æœ‰ sidecar çš„éƒ¨ç½²æ—¶ï¼Œåªæœ‰åŒ…å«æœ‰æ•ˆ Wasm å·¥ä½œè´Ÿè½½çš„å®¹å™¨æ‰ç”± Wasm å¤„ç†ç¨‹åºæ‰§è¡Œã€‚å¸¸è§„å®¹å™¨åƒå¾€å¸¸ä¸€æ ·è¢«å§”æ´¾ç»™æœ¬æœº Linux å®¹å™¨è¿è¡Œæ—¶ã€‚&lt;/p&gt;
&lt;p&gt;å› æ­¤ï¼Œåœ¨ä¸ºè¿™ç§ç”¨ä¾‹æ„å»ºé•œåƒæ—¶ï¼Œè¯·ä½¿ç”¨æ³¨é‡Š &lt;code&gt;module.wasm.image/variant=compat-smart&lt;/code&gt;ï¼Œè€Œä¸æ˜¯ &lt;code&gt;module.wasm.image/variant=compat&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ‚¨å¯ä»¥åœ¨ &lt;a href=&#34;https://github.com/containers/crun/blob/main/docs/wasm-wasi-on-kubernetes.md#known-issues&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;GitHub ä¸Šçš„ crun æ–‡æ¡£&lt;/a&gt; ä¸­æ‰¾åˆ°å…¶ä»–å·²çŸ¥é—®é¢˜ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Istio ä¸­çš„å¤–éƒ¨æˆæƒè¿‡æ»¤å™¨ï¼šä½¿ç”¨ OPA å®ç°çµæ´»çš„æˆæƒç­–ç•¥</title>
      <link>https://lib.jimmysong.io/blog/understanding-istio-and-open-policy-agent-opa/</link>
      <pubDate>Tue, 28 Mar 2023 12:00:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/understanding-istio-and-open-policy-agent-opa/</guid>
      <description>&lt;p&gt;å®¢æˆ·å‘æˆ‘ä»¬è¯¢é—®æœåŠ¡ç½‘æ ¼å®è·µä¸­å…³äºå¼€æ”¾ç­–ç•¥ä»£ç† (OPA) å’ŒæœåŠ¡ç½‘æ ¼å¦‚ä½•ç»“åˆä½¿ç”¨çš„é—®é¢˜ã€‚æˆ‘ä»¬æ¢è®¨äº†å…³äºæœåŠ¡ç½‘æ ¼å’Œ OPA ç­–ç•¥çš„æœ€ä½³å®è·µï¼Œä»¥åŠå®ƒä»¬å¦‚ä½•ç›¸äº’è¡¥å……çš„æƒ³æ³•ã€‚ä¸ºäº†æ„å»ºè®¨è®ºæ¡†æ¶ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† NIST çš„é›¶ä¿¡ä»»æ¶æ„æ ‡å‡†ã€‚åœ¨å³å°†å‘å¸ƒçš„ NIST æ ‡å‡†æ–‡æ¡£ç‰¹åˆ«å‡ºç‰ˆç‰© 800-207A ä¸­ï¼ŒåŸºäºèº«ä»½çš„åˆ†æ®µæ˜¯ä¸€ä¸ªä¸»è¦æ¦‚å¿µã€‚æœ€ä½æ ‡å‡†åŒ…æ‹¬äº”é¡¹ç­–ç•¥æ£€æŸ¥ï¼Œåº”åº”ç”¨äºè¿›å…¥çš„æ¯ä¸ªè¯·æ±‚ç³»ç»Ÿå’Œæ¯ä¸ªåç»­è·ƒç‚¹ã€‚æ‚¨å¯ä»¥è§‚çœ‹æˆ‘ä»¬åœ¨ä»Šå¹´çš„ CloudNativeSecurityCon ä¸Šä¸æ¥è‡ª NIST çš„ Ramaswami Chandramouli è¿›è¡Œçš„æ·±å…¥è®¨è®ºçš„&lt;a href=&#34;https://www.youtube.com/watch?v=s2lIaFhkA8c&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ¼”ç¤º&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä½¿ç”¨æœåŠ¡ç½‘æ ¼å®ç°åŸºäºèº«ä»½çš„åˆ†å‰²çš„äº”ä¸ªç­–ç•¥æ£€æŸ¥ï¼š&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä¼ è¾“ä¸­åŠ å¯†&lt;/li&gt;
&lt;li&gt;æœåŠ¡èº«ä»½å’Œè®¤è¯&lt;/li&gt;
&lt;li&gt;æœåŠ¡åˆ°æœåŠ¡æˆæƒ&lt;/li&gt;
&lt;li&gt;æœ€ç»ˆç”¨æˆ·èº«ä»½å’Œèº«ä»½éªŒè¯&lt;/li&gt;
&lt;li&gt;æœ€ç»ˆç”¨æˆ·å¯¹èµ„æºçš„æˆæƒ&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç®€è€Œè¨€ä¹‹ï¼ŒæœåŠ¡ç½‘æ ¼æ˜¯ä¸€ä¸ªä¸“ç”¨çš„åŸºç¡€è®¾æ–½å±‚ï¼Œä¸“é—¨ç”¨äºä¸ºå‰å››é¡¹æ£€æŸ¥å®æ–½ç­–ç•¥ï¼Œå¹¶åœ¨ç¬¬äº”é¡¹ä¸­å‘æŒ¥ä¸€å®šä½œç”¨ã€‚OPA çš„äº®ç‚¹åœ¨äºç¬¬äº”ç‚¹ï¼šæœ€ç»ˆç”¨æˆ·å¯¹èµ„æºçš„æˆæƒã€‚&lt;/p&gt;
&lt;p&gt;Istio çš„ sidecar ä»£ç†å……å½“å¾®æœåŠ¡åº”ç”¨ç¨‹åºçš„å®‰å…¨å†…æ ¸ã€‚Envoy æ•°æ®å¹³é¢æ˜¯ä¸€ä¸ªé€šç”¨çš„ç­–ç•¥æ‰§è¡Œç‚¹ (PEP)ï¼Œå¯ä»¥æ‹¦æˆªæ‰€æœ‰æµé‡å¹¶å¯ä»¥åœ¨åº”ç”¨å±‚åº”ç”¨ç­–ç•¥ã€‚å°±æ­¤è€Œè¨€ï¼Œå®ƒæ˜¯ä¸€ä¸ªå‚è€ƒç›‘è§†å™¨ ( &lt;a href=&#34;https://csrc.nist.gov/publications/detail/sp/800-204b/final&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;NIST SP 800-204B&lt;/a&gt; )ã€‚å°† Envoy ä½œä¸º PEPï¼Œæˆ‘ä»¬å¯ä»¥å°†å®‰å…¨é—®é¢˜ä»åº”ç”¨ç¨‹åºè½¬ç§»åˆ°ç½‘æ ¼ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;ç­–ç•¥&lt;strong&gt;æ£€æŸ¥ 1-2ï¼šä¼ è¾“ä¸­çš„åŠ å¯†å’ŒæœåŠ¡èº«ä»½ä¸è®¤è¯&lt;/strong&gt;ã€‚ä¸ºäº†æ»¡è¶³å‰ä¸¤ä¸ªç­–ç•¥æ£€æŸ¥ã€ä¼ è¾“ä¸­çš„åŠ å¯†ä»¥åŠæœåŠ¡èº«ä»½å’Œèº«ä»½éªŒè¯ï¼Œç½‘æ ¼ä¸ºç³»ç»Ÿä¸­çš„æ‰€æœ‰é€šä¿¡å®æ–½ mTLSã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç­–ç•¥æ£€æŸ¥ 3ï¼šæœåŠ¡åˆ°æœåŠ¡æˆæƒã€‚&lt;/strong&gt; æœåŠ¡ç½‘æ ¼è¿˜æä¾›ç­–ç•¥ä¸‰ï¼Œå³æœåŠ¡åˆ°æœåŠ¡çš„æˆæƒã€‚OPA å¯ä»¥åœ¨è¿™é‡Œå¼€å§‹å‘æŒ¥ä½œç”¨ï¼Œä½†ç”±äº OPA æ˜¯é€šç”¨çš„ï¼Œå®ƒæ²¡æœ‰å›´ç»•æœåŠ¡é€šä¿¡çš„ DSLï¼Œå› æ­¤æ‚¨å¿…é¡»è‡ªå·±åˆ›å»ºå®ƒã€‚å¦ä¸€æ–¹é¢ï¼Œæˆ‘ä»¬è®¤ä¸ºç­–ç•¥å¾€å¾€æ›´è‡ªç„¶ï¼Œæ›´å®¹æ˜“ç”¨ä¸“ä¸ºå®ƒæ„å»ºçš„è¯­è¨€æ¥è¡¨è¾¾ã€‚æœåŠ¡ç½‘æ ¼ â€”â€” æ›´é‡è¦çš„æ˜¯ï¼Œæˆ‘ä»¬åœ¨ Istio ä¹‹ä¸Šæ„å»ºçš„åº”ç”¨ç¨‹åºè¿æ¥å’Œå®‰å…¨å¹³å° &lt;a href=&#34;https://tetrate.io/tetrate-service-bridge/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tetrate Service Bridge&lt;/a&gt;â€”â€” å…·æœ‰å¯¹ç¼–å†™æœåŠ¡åˆ°æœåŠ¡ç­–ç•¥æœ‰æ„ä¹‰çš„åè¯ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç­–ç•¥æ£€æŸ¥ 4ï¼šæœ€ç»ˆç”¨æˆ·èº«ä»½å’Œèº«ä»½éªŒè¯ã€‚&lt;/strong&gt; å¯¹äºç¬¬å››ä¸ªç­–ç•¥æ£€æŸ¥ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ç³»ç»Ÿçš„æ¯ä¸€è·³éªŒè¯æœ€ç»ˆç”¨æˆ·èº«ä»½ã€‚æœåŠ¡ç½‘æ ¼æä¾›æ‰§è¡Œç‚¹æ¥è¿›è¡Œæ£€æŸ¥ï¼Œä½†æœ‰å…³ç”¨æˆ·èº«ä»½éªŒè¯çš„å®é™…å†³å®šæ—¢ä¸åœ¨æœåŠ¡ç½‘æ ¼é¢†åŸŸä¹Ÿä¸åœ¨ OPA èŒƒå›´å†…ã€‚ç›¸åï¼Œæˆ‘ä»¬éœ€è¦å§”æ‰˜ç»™å—ä¿¡ä»»çš„èº«ä»½æä¾›è€…æ¥åœ¨æ­¤å¤„åšå‡ºåˆ¤å†³ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç­–ç•¥æ£€æŸ¥ 5ï¼šæœ€ç»ˆç”¨æˆ·å¯¹èµ„æºçš„æˆæƒã€‚&lt;/strong&gt; é›¶ä¿¡ä»»äº‘åŸç”Ÿè®¿é—®æ§åˆ¶çš„ç¬¬äº”ä¸ªç­–ç•¥æ£€æŸ¥æ˜¯ OPA å¯ä»¥å‘æŒ¥é‡è¦ä½œç”¨çš„åœ°æ–¹ã€‚æœåŠ¡ç½‘æ ¼æ²¡æœ‰æœ€ç»ˆç”¨æˆ·å’Œèµ„æºä¹‹é—´å…³ç³»çš„æ¨¡å‹ï¼Œå› æ­¤ä¸é€‚åˆç¼–å†™æœ‰å…³å®ƒçš„ç­–ç•¥ã€‚NIST çš„æŒ‡å—æ˜¯é€šè¿‡ OIDC ä¸ç°æœ‰ç³»ç»Ÿé›†æˆæˆ–åˆ©ç”¨ä¸“ç”¨æˆæƒåŸºç¡€è®¾æ–½ â€”â€” ä¾‹å¦‚ï¼ŒNIST çš„ä¸‹ä¸€ä»£è®¿é—®æ§åˆ¶ (NGAC) å’Œ Open Policy Agentã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œä»¥åª’ä½“æµæœåŠ¡åŠå…¶æ’­æ”¾åˆ—è¡¨ä¸ºä¾‹ã€‚æˆ‘ä»¬å¯èƒ½éœ€è¦æˆæƒæœ€ç»ˆç”¨æˆ·è®¿é—®æ•°ç™¾ä¸‡åˆ°æ•°åäº¿ä¸ªæ’­æ”¾åˆ—è¡¨ã€‚å°±åƒ OPA ä¸æ˜¯ç‰¹åˆ«é€‚åˆæœåŠ¡åˆ°æœåŠ¡çš„æˆæƒä¸€æ ·ï¼ŒIstio æˆæƒç­–ç•¥ä¹Ÿä¸é€‚åˆæœ€ç»ˆç”¨æˆ·åˆ°èµ„æºçš„æˆæƒï¼›ä½†æ˜¯ï¼ŒOPA é€‚åˆã€‚&lt;/p&gt;
&lt;p&gt;OPA ä¹Ÿéå¸¸é€‚åˆè¶…è¶Š NIST ZTA ç­–ç•¥æ¡†æ¶çš„æ­¥éª¤ï¼š&lt;strong&gt;å°†ç‰¹å®šäºä¸šåŠ¡çš„ç­–ç•¥åº”ç”¨äºè¯·æ±‚ã€‚&lt;/strong&gt; åœ¨æˆ‘ä»¬å®Œæˆé›¶ä¿¡ä»»çš„äº”é¡¹ç­–ç•¥æ£€æŸ¥ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å§”æ‰˜ OPA ä½œä¸ºè§„åˆ™å¼•æ“æ¥æ‰§è¡Œä¸šåŠ¡ç­–ç•¥ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æ¥ä¸‹æ¥çš„å‡ ä¸ªæœˆé‡Œï¼Œæˆ‘ä»¬å°†å¯¹æ­¤å‘è¡¨æ›´å¤šçœ‹æ³•ï¼Œå°¤å…¶æ˜¯åœ¨ SP 800-207A è¿›å…¥èµ·è‰è¿‡ç¨‹æ—¶ã€‚ä½†æ˜¯ï¼Œä¸æ­¤åŒæ—¶ï¼Œæˆ‘ä»¬åœ¨ Cloud Native Security Con ä¸Šçš„è°ˆè¯å½•éŸ³å¯¹è¿™äº›é—®é¢˜è¿›è¡Œäº†æ›´æ·±å…¥çš„è®¨è®ºï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.youtube.com/watch?v=s2lIaFhkA8c&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ZTA åŸºäºèº«ä»½çš„åˆ†å‰² â€”â€”Zack Butcherã€Tetrate å’Œ Ramaswamy Chandramouliï¼ŒNIST&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.youtube.com/watch?v=YdcVALVwwY4&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;èµåŠ©ä¸»é¢˜æ¼”è®²ï¼šä» Google åˆ° NIST â€” äº‘åŸç”Ÿå®‰å…¨çš„æœªæ¥ â€” Zack Butcherï¼ŒTetrate&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>JWT ç»„ä»¶è¯¦è§£</title>
      <link>https://lib.jimmysong.io/blog/jwt-components-explained/</link>
      <pubDate>Mon, 27 Mar 2023 17:00:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/jwt-components-explained/</guid>
      <description>&lt;blockquote&gt;
&lt;p&gt;è¯‘è€…æ³¨ï¼šæœ¬æ–‡è¯‘è‡ª &lt;a href=&#34;https://fusionauth.io/learn/expert-advice/tokens/jwt-components-explained&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Fusion Auth Developer&lt;/a&gt;ã€‚JSON Web Tokenï¼ˆé€šå¸¸ç¼©å†™ä¸º JWTï¼‰æ˜¯ä¸€ç§é€šå¸¸ä¸ OAuth2 ç­‰æ ‡å‡†åè®®ä¸€èµ·ä½¿ç”¨çš„ä»¤ç‰Œã€‚æœ¬æ–‡è§£é‡Šäº† JWT çš„ç»„æˆéƒ¨åˆ†å’Œå·¥ä½œåŸç†ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åœ¨æˆ‘ä»¬ç»§ç»­ä¹‹å‰ï¼Œé‡è¦çš„æ˜¯è¦æ³¨æ„ JWT é€šå¸¸è¢«é”™è¯¯åœ°ç§°ä¸º &lt;code&gt;JWT Tokens&lt;/code&gt;ã€‚åœ¨æœ«å°¾æ·»åŠ  &lt;code&gt;Token&lt;/code&gt; å°†ä¼šä½¿å…¶å˜æˆ &lt;code&gt;JSON Web Token Token&lt;/code&gt;ã€‚å› æ­¤ï¼Œåœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬çœç•¥æœ«å°¾çš„ &lt;code&gt;Token&lt;/code&gt; å¹¶ç®€å•åœ°ç§°ä¹‹ä¸º &lt;code&gt;JWT&lt;/code&gt;ï¼Œå› ä¸ºè¿™æ˜¯æ›´æ­£ç¡®çš„åç§°ã€‚åŒæ ·åœ°ï¼Œç”±äº JWT é€šå¸¸ç”¨ä½œèº«ä»½éªŒè¯å’Œæˆæƒè¿‡ç¨‹çš„ä¸€éƒ¨åˆ†ï¼Œä¸€äº›äººå°†å…¶ç§°ä¸º &lt;code&gt;Authentication Tokens&lt;/code&gt; æˆ– &lt;code&gt;JWT Authentication Tokens&lt;/code&gt;ã€‚ä»æŠ€æœ¯ä¸Šè®²ï¼ŒJWT åªæ˜¯ä¸€ä¸ªåŒ…å« Base64 ç¼–ç çš„ JSON çš„ä»¤ç‰Œã€‚å®ƒå¯ä»¥ç”¨äºè®¸å¤šä¸åŒçš„ç”¨ä¾‹ï¼Œ&lt;em&gt;åŒ…æ‹¬&lt;/em&gt;èº«ä»½éªŒè¯å’Œæˆæƒã€‚å› æ­¤ï¼Œåœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬ä¸ä½¿ç”¨è¿™ä¸ªæœ¯è¯­ï¼Œè€Œæ˜¯è®¨è®ºå¦‚ä½•åœ¨èº«ä»½éªŒè¯è¿‡ç¨‹ä¸­ä½¿ç”¨ JWTã€‚&lt;/p&gt;
&lt;p&gt;è®©æˆ‘ä»¬å¼€å§‹å§ï¼è¿™æ˜¯ä¸€ä¸ªæ–°ç”Ÿæˆçš„ JWTã€‚ä¸ºæ¸…æ¥šèµ·è§æ·»åŠ äº†æ¢è¡Œç¬¦ï¼Œä½†å®ƒä»¬é€šå¸¸ä¸å­˜åœ¨ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImY1ODg5MGQxOSJ9.eyJhdWQiO
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;iI4NWEwMzg2Ny1kY2NmLTQ4ODItYWRkZS0xYTc5YWVlYzUwZGYiLCJleHAiOjE2NDQ4ODQ
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;xODUsImlhdCI6MTY0NDg4MDU4NSwiaXNzIjoiYWNtZS5jb20iLCJzdWIiOiIwMDAwMDAwM
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;C0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDEiLCJqdGkiOiIzZGQ2NDM0ZC03OWE5LTR
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kMTUtOThiNS03YjUxZGJiMmNkMzEiLCJhdXRoZW50aWNhdGlvblR5cGUiOiJQQVNTV09SR
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;CIsImVtYWlsIjoiYWRtaW5AZnVzaW9uYXV0aC5pbyIsImVtYWlsX3ZlcmlmaWVkIjp0cnV
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;lLCJhcHBsaWNhdGlvbklkIjoiODVhMDM4NjctZGNjZi00ODgyLWFkZGUtMWE3OWFlZWM1M
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;GRmIiwicm9sZXMiOlsiY2VvIl19.dee-Ke6RzR0G9avaLNRZf1GUCDfe8Zbk9L2c7yaqKME
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™å¯èƒ½çœ‹èµ·æ¥åƒæ˜¯ä¸€å †ä¹±ç ï¼Œä½†éšç€æ‚¨å¯¹ JWT ä»¥åŠå®ƒä»¬åœ¨ OAuth2 æˆ–èº«ä»½éªŒè¯è¿‡ç¨‹ä¸­çš„ä½¿ç”¨æ–¹å¼äº†è§£å¾—æ›´å¤šï¼Œå®ƒå¼€å§‹å˜å¾—æ›´æœ‰æ„ä¹‰äº†ã€‚&lt;/p&gt;
&lt;p&gt;æœ‰å‡ ç§ç±»å‹çš„ JSON Web ä»¤ç‰Œï¼Œä½†æˆ‘å°†é‡ç‚¹ä»‹ç»å·²ç­¾åçš„ JWTï¼Œå› ä¸ºå®ƒä»¬æ˜¯æœ€å¸¸è§çš„ã€‚ç­¾åçš„ JWT ä¹Ÿå¯ä»¥ç§°ä¸º JWSã€‚å®ƒç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆï¼Œä»¥å¥å·åˆ†éš”ã€‚&lt;/p&gt;
&lt;p&gt;æœ‰ä¸€ä¸ªæ ‡å¤´ï¼Œåœ¨ä¸Šé¢çš„JWTä¸­ä»¥&lt;code&gt;eyJhbGc&lt;/code&gt;å¼€å¤´ã€‚ç„¶åæœ‰ä¸€ä¸ªä¸»ä½“æˆ–æœ‰æ•ˆè½½è·ï¼Œä¸Šé¢ä»¥&lt;code&gt;eyJhdWQ&lt;/code&gt;å¼€å¤´ã€‚æœ€åæœ‰ä¸€ä¸ªç­¾åï¼Œåœ¨ç¤ºä¾‹JWTä¸­ä»¥&lt;code&gt;dee-K&lt;/code&gt;å¼€å¤´ã€‚&lt;/p&gt;
&lt;p&gt;JWTå¦‚ä½•å·¥ä½œï¼Ÿè®©æˆ‘ä»¬æ‹†å¼€è¿™ä¸ªç¤ºä¾‹JWTå¹¶æ·±å…¥äº†è§£ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;h2 id=&#34;jwt-æ ‡å¤´è§£é‡Š&#34;&gt;JWT æ ‡å¤´è§£é‡Š&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImY1ODg5MGQxOSJ9&lt;/code&gt;æ˜¯ JWT çš„æ ‡å¤´ã€‚JWT æ ‡å¤´åŒ…å«æœ‰å…³ JWT çš„å…ƒæ•°æ®ï¼ŒåŒ…æ‹¬å¯†é’¥æ ‡è¯†ç¬¦ã€ç”¨äºç™»å½•çš„ç®—æ³•å’Œå…¶ä»–ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæ‚¨é€šè¿‡ base64 è§£ç å™¨è¿è¡Œä¸Šè¿°æ ‡å¤´ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImY1ODg5MGQxOSJ9&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;base64 -d
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä½ ä¼šçœ‹åˆ°è¿™ä¸ª JSONï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;alg&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;HS256&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;typ&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;JWT&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;kid&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;f58890d19&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;%&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;HS256&lt;/code&gt;è¡¨ç¤º JWT æ˜¯ä½¿ç”¨å¯¹ç§°ç®—æ³•ç­¾åçš„ï¼Œç‰¹åˆ«æ˜¯ä½¿ç”¨ SHA-256 çš„ HMACã€‚&lt;/p&gt;
&lt;p&gt;ç®—æ³•åˆ—è¡¨å’Œå®ç°æ”¯æŒçº§åˆ«å¦‚ä¸‹ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;â€œalgâ€ Param Value&lt;/th&gt;
&lt;th&gt;Digital Signature or MAC Algorithm&lt;/th&gt;
&lt;th&gt;Implementation Requirements&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;HS256&lt;/td&gt;
&lt;td&gt;HMAC using SHA-256&lt;/td&gt;
&lt;td&gt;Required&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;HS384&lt;/td&gt;
&lt;td&gt;HMAC using SHA-384&lt;/td&gt;
&lt;td&gt;Optional&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;HS512&lt;/td&gt;
&lt;td&gt;HMAC using SHA-512&lt;/td&gt;
&lt;td&gt;Optional&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;RS256&lt;/td&gt;
&lt;td&gt;RSASSA-PKCS1-v1_5 using SHA-256&lt;/td&gt;
&lt;td&gt;Recommended&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;RS384&lt;/td&gt;
&lt;td&gt;RSASSA-PKCS1-v1_5 using SHA-384&lt;/td&gt;
&lt;td&gt;Optional&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;RS512&lt;/td&gt;
&lt;td&gt;RSASSA-PKCS1-v1_5 using SHA-512&lt;/td&gt;
&lt;td&gt;Optional&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ES256&lt;/td&gt;
&lt;td&gt;ECDSA using P-256 and SHA-256&lt;/td&gt;
&lt;td&gt;Recommended+&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ES384&lt;/td&gt;
&lt;td&gt;ECDSA using P-384 and SHA-384&lt;/td&gt;
&lt;td&gt;Optional&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ES512&lt;/td&gt;
&lt;td&gt;ECDSA using P-521 and SHA-512&lt;/td&gt;
&lt;td&gt;Optional&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;PS256&lt;/td&gt;
&lt;td&gt;RSASSA-PSS using SHA-256 and MGF1 with SHA-256&lt;/td&gt;
&lt;td&gt;Optional&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;PS384&lt;/td&gt;
&lt;td&gt;RSASSA-PSS using SHA-384 and MGF1 with SHA-384&lt;/td&gt;
&lt;td&gt;Optional&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;PS512&lt;/td&gt;
&lt;td&gt;RSASSA-PSS using SHA-512 and MGF1 with SHA-512&lt;/td&gt;
&lt;td&gt;Optional&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;none&lt;/td&gt;
&lt;td&gt;No digital signature or MAC performed&lt;/td&gt;
&lt;td&gt;Optional&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;æ­¤è¡¨å–è‡ª RFC 7518ã€‚ç”±äºä»… HS256 éœ€è¦ç¬¦åˆè§„èŒƒï¼Œè¯·æŸ¥é˜…ç”¨äºåˆ›å»º JWT çš„è½¯ä»¶æˆ–åº“ä»¥è·å–æœ‰å…³å—æ”¯æŒç®—æ³•çš„è¯¦ç»†ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;å…¶ä»–å…ƒæ•°æ®ä¹Ÿå­˜å‚¨åœ¨ JWT çš„è¿™ä¸€éƒ¨åˆ†ä¸­ã€‚&lt;code&gt;typ&lt;/code&gt;æ ‡å¤´æŒ‡ç¤º JWT çš„ç±»å‹ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œè¯¥å€¼ä¸º&lt;code&gt;JWT&lt;/code&gt;ï¼Œä½†å…¶ä»–å€¼å‡æœ‰æ•ˆã€‚ä¾‹å¦‚ï¼Œå¦‚æœ JWT ç¬¦åˆ RFC 9068ï¼Œå®ƒå¯èƒ½å…·æœ‰&lt;code&gt;at+JWT&lt;/code&gt;æŒ‡ç¤ºå®ƒæ˜¯è®¿é—®ä»¤ç‰Œçš„å€¼ã€‚&lt;/p&gt;
&lt;p&gt;è¯¥&lt;code&gt;kid&lt;/code&gt;å€¼æŒ‡ç¤ºç”¨äºç­¾ç½² JWT çš„å¯†é’¥ã€‚å¯¹äºå¯¹ç§°å¯†é’¥ï¼Œ&lt;code&gt;kid&lt;/code&gt;å¯ç”¨äºåœ¨ç§˜å¯†ä¿é™©åº“ä¸­æŸ¥æ‰¾å€¼ã€‚å¯¹äºéå¯¹ç§°ç­¾åç®—æ³•ï¼Œæ­¤å€¼è®© JWT çš„æ¶ˆè´¹è€…æŸ¥æ‰¾ä¸ç­¾ç½²æ­¤ JWT çš„ç§é’¥ç›¸å¯¹åº”çš„æ­£ç¡®å…¬é’¥ã€‚æ­£ç¡®å¤„ç†æ­¤å€¼å¯¹äºç­¾åéªŒè¯å’Œ JWT è´Ÿè½½çš„å®Œæ•´æ€§è‡³å…³é‡è¦ã€‚&lt;/p&gt;
&lt;p&gt;é€šå¸¸æƒ…å†µä¸‹ï¼Œå°†æ ‡å¤´å€¼çš„å¤§éƒ¨åˆ†å¤„ç†è¿‡ç¨‹è½¬ç§»åˆ°åº“ä¸­ã€‚æœ‰è®¸å¤šä¼˜ç§€çš„å¼€æº JWT å¤„ç†åº“ã€‚æ‚¨åº”è¯¥äº†è§£è¿™äº›åº“çš„ä»·å€¼ï¼Œä½†å¯èƒ½ä¸å¿…å®ç°å®é™…å¤„ç†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;jwt-ä»¤ç‰Œä¸»ä½“&#34;&gt;JWT ä»¤ç‰Œä¸»ä½“&lt;/h2&gt;
&lt;p&gt;æœ‰æ•ˆè½½è·æˆ–ä¸»ä½“æ˜¯ä½¿ JWT å˜å¾—æœ‰è¶£çš„åœ°æ–¹ã€‚æ­¤éƒ¨åˆ†åŒ…å«åˆ›å»º JWT ä»¥ä¼ è¾“çš„æ•°æ®ã€‚ä¾‹å¦‚ï¼Œå¦‚æœ JWT è¡¨ç¤ºæˆæƒè®¿é—®æŸäº›æ•°æ®æˆ–åŠŸèƒ½çš„ç”¨æˆ·ï¼Œåˆ™æœ‰æ•ˆè½½è·åŒ…å«ç”¨æˆ·æ•°æ®ï¼Œä¾‹å¦‚è§’è‰²æˆ–å…¶ä»–æˆæƒä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯æ¥è‡ªç¤ºä¾‹ JWT çš„æœ‰æ•ˆè´Ÿè½½ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;eyJhdWQiOiI&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;NWEwMzg&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;Ny&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;kY&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;NmLTQ&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;ODItYWRkZS&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;xYTc&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;YWVlYzUwZGYiLCJleHAiOjE&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;NDQ&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;ODQxODUsImlhdCI&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;6&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;MTY&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;NDg&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;MDU&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;NSwiaXNzIjoiYWNtZS&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;jb&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;20&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;iLCJzdWIiOiIwMDAwMDAwMC&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;wMDAwLTAwMDAtMDAwMC&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;wMDAwMDAwMDAwMDEiLCJqdGkiOiIzZGQ&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;NDM&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;ZC&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;03&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;OWE&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;LTRkMTUtOThiNS&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;03&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;YjUxZGJiMmNkMzEiLCJhdXRoZW&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;50&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;aWNhdGlvblR&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;cGUiOiJQQVNTV&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;09&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;SRCIsImVtYWlsIjoiYWRtaW&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;AZnVzaW&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;9&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;uYXV&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;aC&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;pbyIsImVtYWlsX&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;ZlcmlmaWVkIjp&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;cnVlLCJhcHBsaWNhdGlvbklkIjoiODVhMDM&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;NjctZGNjZi&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;00&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;ODgyLWFkZGUtMWE&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;OWFlZWM&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;MGRmIiwicm&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;9&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;sZXMiOlsiY&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;VvIl&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;19&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¦‚æœæ‚¨é€šè¿‡ base64 è§£ç å™¨è¿è¡Œç¤ºä¾‹è´Ÿè½½ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;eyJhdWQiOiI4NWEwMzg2Ny1kY2NmLTQ4ODItYWRkZS0xYTc5YWVlYzUwZGYiLCJleHAiOjE2NDQ4ODQxODUsImlhdCI6MTY0NDg4MDU4NSwiaXNzIjoiYWNtZS5jb20iLCJzdWIiOiIwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDEiLCJqdGkiOiIzZGQ2NDM0ZC03OWE5LTRkMTUtOThiNS03YjUxZGJiMmNkMzEiLCJhdXRoZW50aWNhdGlvblR5cGUiOiJQQVNTV09SRCIsImVtYWlsIjoiYWRtaW5AZnVzaW9uYXV0aC5pbyIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJhcHBsaWNhdGlvbklkIjoiODVhMDM4NjctZGNjZi00ODgyLWFkZGUtMWE3OWFlZWM1MGRmIiwicm9sZXMiOlsiY2VvIl19&amp;#39;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;base64 -d
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä½ ä¼šçœ‹åˆ°è¿™ä¸ª JSONï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nt&#34;&gt;&amp;#34;aud&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;85a03867-dccf-4882-adde-1a79aeec50df&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nt&#34;&gt;&amp;#34;exp&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1644884185&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nt&#34;&gt;&amp;#34;iat&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1644880585&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nt&#34;&gt;&amp;#34;iss&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;acme.com&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nt&#34;&gt;&amp;#34;sub&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;00000000-0000-0000-0000-000000000001&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nt&#34;&gt;&amp;#34;jti&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;3dd6434d-79a9-4d15-98b5-7b51dbb2cd31&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nt&#34;&gt;&amp;#34;authenticationType&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;PASSWORD&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nt&#34;&gt;&amp;#34;email&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;admin@fusionauth.io&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nt&#34;&gt;&amp;#34;email_verified&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nt&#34;&gt;&amp;#34;applicationId&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;85a03867-dccf-4882-adde-1a79aeec50df&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nt&#34;&gt;&amp;#34;roles&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;ceo&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¯·æ³¨æ„ï¼Œåˆ›å»ºç­¾å JWT çš„ç®—æ³•å¯ä»¥åˆ é™¤ base64 å¡«å……ï¼Œå› æ­¤ JWT æœ«å°¾å¯èƒ½ç¼ºå°‘ç¬¦å·ã€‚æ‚¨å¯èƒ½éœ€è¦å°†å…¶æ·»åŠ å›å»æ‰èƒ½è§£ç  JWT ä»¤ç‰Œã€‚è¿™å–å†³äºå†…å®¹çš„é•¿åº¦ã€‚æ‚¨å¯ä»¥&lt;a href=&#34;https://datatracker.ietf.org/doc/html/rfc7515#appendix-C&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;åœ¨æ­¤å¤„äº†è§£æ›´å¤šä¿¡æ¯&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚ä¸Šæ‰€è¿°ï¼Œè´Ÿè½½æ˜¯æ‚¨çš„åº”ç”¨ç¨‹åºæ‰€å…³å¿ƒçš„ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬æ›´ä»”ç»†åœ°çœ‹ä¸€ä¸‹è¿™ä¸ª JSONã€‚å¯¹è±¡çš„æ¯ä¸ªé”®éƒ½ç§°ä¸º â€œå£°æ˜â€ï¼ˆClaimï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€äº›å£°æ˜æ˜¯ä¼—æ‰€å‘¨çŸ¥çš„ï¼Œå…¶å«ä¹‰ç”± IETF ç­‰æ ‡å‡†æœºæ„è§„å®šã€‚æ‚¨å¯ä»¥åœ¨æ­¤å¤„æŸ¥çœ‹&lt;a href=&#34;https://www.iana.org/assignments/jwt/jwt.xhtml&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ­¤ç±»å£°æ˜çš„ç¤ºä¾‹&lt;/a&gt;ã€‚è¿™äº›åŒ…æ‹¬ç¤ºä¾‹ä»¤ç‰Œä¸­çš„&lt;code&gt;iss&lt;/code&gt;å’Œ&lt;code&gt;aud&lt;/code&gt;å£°æ˜ã€‚å½“å®ƒä»¬å‡ºç°åœ¨ JWT çš„æœ‰æ•ˆè´Ÿè½½ä¸­æ—¶ï¼Œè¿™ä¸¤è€…éƒ½å…·æœ‰å®šä¹‰çš„å«ä¹‰ã€‚&lt;/p&gt;
&lt;p&gt;è¿˜æœ‰å…¶ä»–éæ ‡å‡†å£°æ˜ï¼Œä¾‹å¦‚&lt;code&gt;authenticationType&lt;/code&gt;ã€‚è¿™äº›å£°æ˜å¯èƒ½ä»£è¡¨ä¸šåŠ¡é¢†åŸŸæˆ–è‡ªå®šä¹‰æ•°æ®ã€‚ä¾‹å¦‚ï¼Œ&lt;code&gt;authenticationType&lt;/code&gt;æ˜¯ FusionAuth ä½¿ç”¨çš„ä¸“æœ‰å£°æ˜ï¼Œç”¨äºæŒ‡ç¤ºèº«ä»½éªŒè¯æ–¹æ³•ï¼Œä¾‹å¦‚å¯†ç ã€åˆ·æ–°ä»¤ç‰Œæˆ–é€šè¿‡æ— å¯†ç é“¾æ¥ã€‚&lt;/p&gt;
&lt;p&gt;æ‚¨å¯ä»¥å‘ JWT æ·»åŠ æ‚¨æƒ³è¦çš„ä»»ä½•å£°æ˜ï¼ŒåŒ…æ‹¬å¯¹ JWT çš„ä¸‹æ¸¸æ¶ˆè´¹è€…æœ‰ç”¨çš„æ•°æ®ã€‚ä»&lt;code&gt;roles&lt;/code&gt;å£°æ˜ä¸­å¯ä»¥çœ‹å‡ºï¼Œå£°æ˜ä¸å¿…æ˜¯ç®€å•çš„ JSON åŸè¯­ã€‚å®ƒä»¬å¯ä»¥æ˜¯ä»»ä½•å¯ä»¥ç”¨ JSON è¡¨ç¤ºçš„æ•°æ®ç»“æ„ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å£°æ˜éªŒè¯&#34;&gt;å£°æ˜éªŒè¯&lt;/h2&gt;
&lt;p&gt;å½“ä»£ç ä¸ JWT ä¸€èµ·å‡ºç°æ—¶ï¼Œå®ƒåº”è¯¥éªŒè¯æŸäº›å£°æ˜ã€‚è‡³å°‘ï¼Œåº”æ£€æŸ¥è¿™äº›å£°æ˜ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;iss&lt;/code&gt;æ ‡è¯† JWT çš„å‘è¡Œè€…ã€‚åªè¦ JWT çš„å‘è¡Œè€…å’Œæ¶ˆè´¹è€…å°±æœ‰æ•ˆå€¼è¾¾æˆä¸€è‡´ï¼Œå¹¶ä¸”æ¶ˆè´¹è€…éªŒè¯å£°æ˜ä¸å·²çŸ¥çš„è‰¯å¥½å€¼ç›¸åŒ¹é…ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²åˆ°åº•æ˜¯ä»€ä¹ˆå¹¶ä¸é‡è¦ï¼ˆUUIDã€åŸŸåã€URL æˆ–å…¶ä»–å†…å®¹ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;aud&lt;/code&gt;æ ‡è¯†ä»¤ç‰Œçš„å—ä¼—ï¼Œå³è°åº”è¯¥ä½¿ç”¨å®ƒã€‚å¯ä»¥æ˜¯æ ‡é‡æˆ–æ•°ç»„å€¼ã€‚åŒæ ·ï¼ŒJWT çš„å‘è¡Œè€…å’Œæ¶ˆè´¹è€…åº”è¯¥å°±å¯æ¥å—çš„ç‰¹å®šå€¼è¾¾æˆä¸€è‡´ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;nbf&lt;/code&gt; å’Œ &lt;code&gt;exp&lt;/code&gt;ã€‚è¿™äº›å£°æ˜ç¡®å®šä»¤ç‰Œæœ‰æ•ˆçš„æ—¶é—´èŒƒå›´ã€‚å¦‚æœæ‚¨è¦å‘è¡Œä»¤ç‰Œä»¥ä¾›å°†æ¥ä½¿ç”¨ï¼Œåˆ™è¯¥å£°æ˜å¯èƒ½å¾ˆæœ‰ç”¨ã€‚åº”å§‹ç»ˆè®¾ç½® &lt;code&gt;exp&lt;/code&gt; å£°æ˜ï¼Œå³ JWT ä¸å†æœ‰æ•ˆçš„æ—¶é—´ã€‚ä¸å…¶ä»–å£°æ˜ä¸åŒï¼Œå®ƒä»¬å…·æœ‰å®šä¹‰çš„å€¼æ ¼å¼ï¼šè‡ª unix çºªå…ƒä»¥æ¥çš„ç§’æ•°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é™¤äº†è¿™äº›ä¹‹å¤–ï¼Œè¿˜è¦éªŒè¯ä¸šåŠ¡é¢†åŸŸç‰¹å®šçš„å£°æ˜ã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨ä¸Šè¿° JWT çš„äººå¯ä»¥åœ¨&lt;code&gt;authenticationType&lt;/code&gt;æœªçŸ¥å€¼æ—¶æ‹’ç»è®¿é—®ã€‚&lt;/p&gt;
&lt;p&gt;é¿å…å°†æœªä½¿ç”¨çš„å£°æ˜æ”¾å…¥ JWTã€‚è™½ç„¶ JWT çš„å¤§å°æ²¡æœ‰é™åˆ¶ï¼Œä½†é€šå¸¸å®ƒä»¬è¶Šå¤§ï¼Œç­¾åå’ŒéªŒè¯å®ƒä»¬æ‰€éœ€çš„ CPU å°±è¶Šå¤šï¼Œä¼ è¾“å®ƒä»¬æ‰€éœ€çš„æ—¶é—´ä¹Ÿå°±è¶Šå¤šã€‚Benchmark æœŸæœ› JWT äº†è§£æ€§èƒ½ç‰¹å¾ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å£°æ˜å’Œå®‰å…¨&#34;&gt;å£°æ˜å’Œå®‰å…¨&lt;/h2&gt;
&lt;p&gt;æ‹¥æœ‰ä»¤ç‰Œçš„ä»»ä½•äººéƒ½å¯ä»¥çœ‹åˆ°å·²ç­¾å JWT çš„å£°æ˜ã€‚&lt;/p&gt;
&lt;p&gt;æ­£å¦‚æ‚¨åœ¨ä¸Šé¢çœ‹åˆ°çš„ï¼Œè¦ä»¥æ˜æ–‡å½¢å¼æŸ¥çœ‹å£°æ˜ï¼Œæ‚¨åªéœ€è¦ä¸€ä¸ª base64 è§£ç å™¨ï¼Œå®ƒå¯ä»¥åœ¨æ¯ä¸ªå‘½ä»¤è¡Œå’Œäº’è”ç½‘ä¸Šçš„ä»»ä½•åœ°æ–¹ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;å› æ­¤ï¼Œæ‚¨ä¸åº”å°†ä»»ä½•åº”è¯¥ä¿å¯†çš„å†…å®¹æ”¾å…¥ JWT ä¸­ã€‚è¿™åŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç§äººä¿¡æ¯ï¼Œä¾‹å¦‚æ”¿åºœ ID&lt;/li&gt;
&lt;li&gt;å¯†ç ä¹‹ç±»çš„ç§˜å¯†&lt;/li&gt;
&lt;li&gt;ä»»ä½•ä¼šæ³„éœ²ä¿¡æ¯çš„ä¸œè¥¿ï¼Œæ¯”å¦‚æ•´æ•° id&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¦ä¸€ä¸ªå®‰å…¨é—®é¢˜ä¸&lt;code&gt;aud&lt;/code&gt;å£°æ˜çš„éªŒè¯æœ‰å…³ã€‚ç”±äºæ¶ˆè´¹ä»£ç å·²ç»æ‹¥æœ‰ä»¤ç‰Œï¼ŒéªŒè¯&lt;code&gt;aud&lt;/code&gt;å£°æ˜æ˜¯å¦å¤šæ­¤ä¸€ä¸¾ï¼Ÿ&lt;code&gt;aud&lt;/code&gt;å£°æ˜è¡¨æ˜è°åº”è¯¥æ¥æ”¶è¿™ä¸ª JWTï¼Œä½†ä»£ç å·²ç»æœ‰äº†å®ƒã€‚ä¸ï¼Œæ€»æ˜¯éªŒè¯å£°æ˜ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºä»€ä¹ˆï¼Ÿ&lt;/p&gt;
&lt;p&gt;æƒ³è±¡ä¸€ä¸‹æ‚¨æœ‰ä¸¤ä¸ªä¸åŒ API çš„åœºæ™¯ã€‚ä¸€ä¸ªæ˜¯åˆ›å»ºå’Œç®¡ç†å¾…åŠäº‹é¡¹ï¼Œå¦ä¸€ä¸ªæ˜¯è®¡è´¹ APIï¼Œç”¨äºè½¬è´¦ã€‚è¿™ä¸¤ä¸ª API éƒ½æœŸæœ›ä¸€äº›ç”¨æˆ·å…·æœ‰&lt;code&gt;admin&lt;/code&gt;è§’è‰²ã€‚ç„¶è€Œï¼Œå°±å¯ä»¥é‡‡å–çš„è¡ŒåŠ¨è€Œè¨€ï¼Œè¯¥è§’è‰²æ„å‘³ç€æˆªç„¶ä¸åŒçš„äº‹æƒ…ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœå¾…åŠäº‹é¡¹ API å’Œè®¡è´¹ API å‡æœªéªŒè¯æ˜¯å¦ä¸ºå®ƒä»¬åˆ›å»ºäº†ä»»ä½•ç»™å®šçš„ JWTï¼Œåˆ™æ”»å‡»è€…å¯ä»¥ä»å…·æœ‰è¯¥&lt;code&gt;admin&lt;/code&gt;è§’è‰²çš„å¾…åŠäº‹é¡¹ API ä¸­è·å– JWTï¼Œå¹¶å°†å…¶å‘ˆç°ç»™è®¡è´¹ APIã€‚&lt;/p&gt;
&lt;p&gt;è¿™æœ€å¤šæ˜¯ä¸€ä¸ªé”™è¯¯ï¼Œæœ€åçš„æƒ…å†µæ˜¯ç‰¹æƒå‡çº§ï¼Œå¯¹é“¶è¡Œè´¦æˆ·äº§ç”Ÿè´Ÿé¢å½±å“ã€‚&lt;/p&gt;
&lt;h2 id=&#34;jwt-ç­¾å&#34;&gt;&lt;strong&gt;JWT ç­¾å&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;JWT çš„ç­¾åå¾ˆå…³é”®ï¼Œå› ä¸ºå®ƒä¿è¯äº†è´Ÿè½½å’Œæ ‡å¤´çš„å®Œæ•´æ€§ã€‚éªŒè¯ç­¾åå¿…é¡»æ˜¯ JWT çš„ä»»ä½•æ¶ˆè´¹è€…æ‰§è¡Œçš„ç¬¬ä¸€æ­¥ã€‚å¦‚æœç­¾åä¸åŒ¹é…ï¼Œåˆ™ä¸åº”è¿›è¡Œè¿›ä¸€æ­¥å¤„ç†ã€‚&lt;/p&gt;
&lt;p&gt;è™½ç„¶æ‚¨å¯ä»¥é˜…è¯»&lt;a href=&#34;https://datatracker.ietf.org/doc/html/rfc7515#page-15&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è§„èŒƒçš„ç›¸å…³éƒ¨åˆ†&lt;/a&gt;ä»¥äº†è§£ç­¾åæ˜¯å¦‚ä½•ç”Ÿæˆçš„ï¼Œä½†é«˜çº§æ¦‚è¿°æ˜¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ ‡å¤´å˜æˆäº† base64 URL ç¼–ç çš„å­—ç¬¦ä¸²&lt;/li&gt;
&lt;li&gt;è´Ÿè½½è¢«è½¬æ¢ä¸º base64 URL ç¼–ç çš„å­—ç¬¦ä¸²&lt;/li&gt;
&lt;li&gt;å®ƒä»¬ç”±&lt;code&gt;.&lt;/code&gt; è¿æ¥&lt;/li&gt;
&lt;li&gt;ç”Ÿæˆçš„å­—ç¬¦ä¸²é€šè¿‡æ‰€é€‰çš„åŠ å¯†ç®—æ³•è¿è¡Œï¼Œè¿åŒç›¸åº”çš„å¯†é’¥&lt;/li&gt;
&lt;li&gt;ç­¾åæ˜¯ base64 URL ç¼–ç çš„&lt;/li&gt;
&lt;li&gt;ç¼–ç åçš„ç­¾åä»¥ &lt;code&gt;.&lt;/code&gt; ä½œä¸ºåˆ†éš”ç¬¦é™„åŠ åˆ°å­—ç¬¦ä¸²&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å½“æ”¶åˆ° JWT æ—¶ï¼Œå¯ä»¥æ‰§è¡Œç›¸åŒçš„æ“ä½œã€‚å¦‚æœç”Ÿæˆçš„ç­¾åæ­£ç¡®ï¼Œåˆ™ JWT çš„å†…å®¹ä¸åˆ›å»ºæ—¶æ²¡æœ‰å˜åŒ–ã€‚&lt;/p&gt;
&lt;h2 id=&#34;json-web-ä»¤ç‰Œé™åˆ¶&#34;&gt;&lt;strong&gt;JSON Web ä»¤ç‰Œé™åˆ¶&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;åœ¨è§„èŒƒä¸­ï¼ŒJSON Web Tokens çš„é•¿åº¦æ²¡æœ‰ç¡¬æ€§é™åˆ¶ã€‚å®é™…ä¸Šï¼Œè€ƒè™‘ä¸€ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä½ æ‰“ç®—åœ¨å“ªé‡Œå­˜å‚¨ JWT&lt;/li&gt;
&lt;li&gt;å¤§å‹ JWT çš„æ€§èƒ½æŸå¤±æ˜¯ä»€ä¹ˆ&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;å­˜å‚¨&#34;&gt;å­˜å‚¨&lt;/h2&gt;
&lt;p&gt;JWT å¯ä»¥åœ¨ HTTP æ ‡å¤´ä¸­å‘é€ï¼Œå­˜å‚¨åœ¨ cookie ä¸­ï¼Œå¹¶æ”¾ç½®åœ¨è¡¨å•å‚æ•°ä¸­ã€‚åœ¨è¿™äº›åœºæ™¯ä¸­ï¼Œå­˜å‚¨å†³å®šäº† JWT çš„æœ€å¤§é•¿åº¦ã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œæµè§ˆå™¨ä¸­ cookie çš„å…¸å‹å­˜å‚¨é™åˆ¶é€šå¸¸ä¸º 4096 å­—èŠ‚ï¼ŒåŒ…æ‹¬åç§°ã€‚HTTP æ ‡å¤´çš„é™åˆ¶å› è½¯ä»¶ç»„ä»¶è€Œå¼‚ï¼Œä½† 8192 å­—èŠ‚ä¼¼ä¹æ˜¯ä¸€ä¸ªå¸¸è§å€¼ã€‚&lt;/p&gt;
&lt;p&gt;è¯·æŸ¥é˜…ç›¸å…³è§„èŒƒæˆ–å…¶ä»–èµ„æºä»¥äº†è§£ç‰¹å®šç”¨ä¾‹çš„é™åˆ¶ï¼Œä½†è¯·æ”¾å¿ƒï¼ŒJWT æ²¡æœ‰å›ºæœ‰çš„å¤§å°é™åˆ¶ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ€§èƒ½å½±å“&#34;&gt;æ€§èƒ½å½±å“&lt;/h2&gt;
&lt;p&gt;ç”±äº JWT å¯ä»¥åŒ…å«è®¸å¤šä¸åŒç±»å‹çš„ç”¨æˆ·ä¿¡æ¯ï¼Œå› æ­¤å¼€å‘äººå‘˜å¯èƒ½ä¼šå¿ä¸ä½åœ¨å…¶ä¸­æ”¾å…¥å¤ªå¤šä¿¡æ¯ã€‚è¿™ä¼šé™ä½ç­¾åå’ŒéªŒè¯æ­¥éª¤ä»¥åŠä¼ è¾“ä¸­çš„æ€§èƒ½ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºå‰è€…çš„ç¤ºä¾‹ï¼Œä»¥ä¸‹æ˜¯ç­¾ç½²å’ŒéªŒè¯ä¸¤ä¸ªä¸åŒ JWT çš„åŸºå‡†æµ‹è¯•ç»“æœã€‚æ¯ä¸ªæ“ä½œè¿›è¡Œäº† 50,000 æ¬¡ã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸€ä¸ª JWT çš„æ­£æ–‡é•¿åº¦çº¦ä¸º 180 ä¸ªå­—ç¬¦ï¼›æ€»ç¼–ç ä»¤ç‰Œé•¿åº¦åœ¨ 300 åˆ° 600 ä¹‹é—´ï¼Œå…·ä½“å–å†³äºæ‰€ä½¿ç”¨çš„ç­¾åç®—æ³•ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;hmac sign
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  1.632396   0.011794   1.644190 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;  1.656177&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;hmac verify
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  2.452983   0.015723   2.468706 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;  2.487930&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;rsa sign
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; 28.409793   0.117695  28.527488 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; 28.697615&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;rsa verify
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  3.086154   0.011869   3.098023 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;  3.109780&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ecc sign
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  4.248960   0.017153   4.266113 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;  4.285231&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ecc verify
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  7.057758   0.027116   7.084874 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;  7.113594&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¸‹ä¸€ä¸ª JWT è´Ÿè½½å¤§çº¦æœ‰ 1800 ä¸ªå­—ç¬¦ï¼Œå› æ­¤æ˜¯å‰ä¸€ä¸ªä»¤ç‰Œå¤§å°çš„åå€ã€‚è¿™å…·æœ‰ 2400 åˆ° 2700 ä¸ªå­—ç¬¦çš„æ€»ä»¤ç‰Œé•¿åº¦ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;hmac sign
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  3.356960   0.018175   3.375135 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;  3.389963&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;hmac verify
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  4.283810   0.018320   4.302130 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;  4.321095&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;rsa sign
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; 32.703723   0.172346  32.876069 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt; 33.072665&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;rsa verify
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  5.300321   0.027455   5.327776 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;  5.358079&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ecc sign
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  6.557596   0.032239   6.589835 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;  6.624320&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ecc verify
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  9.184033   0.035617   9.219650 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;  9.259225&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ‚¨å¯ä»¥çœ‹åˆ°ï¼Œå¯¹äºè¾ƒé•¿çš„ JWTï¼Œæ€»æ—¶é—´å¢åŠ äº†ï¼Œä½†é€šå¸¸ä¸æ˜¯çº¿æ€§çš„ã€‚æ‰€ç”¨æ—¶é—´çš„å¢åŠ èŒƒå›´ä» RSA ç­¾åçš„å¤§çº¦ 20% åˆ° HMAC ç­¾åçš„å¤§çº¦ 100%ã€‚&lt;/p&gt;
&lt;p&gt;è¯·æ³¨æ„ä¼ è¾“æ›´é•¿çš„ JWT æ‰€èŠ±è´¹çš„é¢å¤–æ—¶é—´ï¼›è¿™å¯ä»¥ç”¨ä¸ä»»ä½•å…¶ä»– API æˆ– HTML å†…å®¹ç›¸åŒçš„æ–¹å¼è¿›è¡Œæµ‹è¯•å’Œä¼˜åŒ–ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç»“è®º&#34;&gt;ç»“è®º&lt;/h2&gt;
&lt;p&gt;å·²ç­¾åçš„ JWT å…·æœ‰æ ‡å¤´ã€æ­£æ–‡å’Œç­¾åã€‚æ¯ä¸ªéƒ½åœ¨ç¡®ä¿ JWT å¯ç”¨äºå®‰å…¨åœ°å­˜å‚¨å’Œä¼ è¾“å…³é”®ä¿¡æ¯ï¼ˆæ— è®ºæ˜¯å¦ä¸èº«ä»½æœ‰å…³ï¼‰æ–¹é¢å‘æŒ¥ç€è‡³å…³é‡è¦çš„èº«ä»½éªŒè¯ä½œç”¨ã€‚äº†è§£æ‰€æœ‰è¿™ä¸‰ä¸ªç»„ä»¶å¯¹äºæ­£ç¡®ä½¿ç”¨ JWT ä¹Ÿè‡³å…³é‡è¦ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Tetrate å¼€æºé¡¹ç›® Wazero ç®€ä»‹</title>
      <link>https://lib.jimmysong.io/blog/introducing-wazero-from-tetrate/</link>
      <pubDate>Mon, 20 Mar 2023 12:00:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/introducing-wazero-from-tetrate/</guid>
      <description>&lt;blockquote&gt;
&lt;p&gt;è¯‘è€…æ³¨ï¼šæœ¬æ–‡è¯‘è‡ª &lt;a href=&#34;https://tetrate.io/blog/introducing-wazero-from-tetrate/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tetrate åšå®¢&lt;/a&gt;ã€‚è¿™ç¯‡æ–‡ç« ä»‹ç»äº† wazeroï¼Œä¸€ä¸ªç”± Tetrate å¼€å‘çš„ç”¨ Go è¯­è¨€ç¼–å†™çš„ WebAssembly è¿è¡Œæ—¶ã€‚wazero å¯ä»¥è®©å¼€å‘è€…ç”¨ä¸åŒçš„ç¼–ç¨‹è¯­è¨€ç¼–å†™ä»£ç ï¼Œå¹¶åœ¨å®‰å…¨çš„æ²™ç®±ç¯å¢ƒä¸­è¿è¡Œã€‚wazero æœ‰ä»¥ä¸‹å‡ ä¸ªç‰¹ç‚¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;çº¯ Goï¼Œæ— ä¾èµ–ï¼Œæ”¯æŒè·¨å¹³å°å’Œè·¨æ¶æ„&lt;/li&gt;
&lt;li&gt;éµå¾ª WebAssembly æ ¸å¿ƒè§„èŒƒ 1.0 å’Œ 2.0&lt;/li&gt;
&lt;li&gt;æ”¯æŒ Go çš„ç‰¹æ€§ï¼Œå¦‚å¹¶å‘å®‰å…¨å’Œä¸Šä¸‹æ–‡ä¼ é€’&lt;/li&gt;
&lt;li&gt;æä¾›äº†ä¸°å¯Œçš„ç¼–ç¨‹æ¥å£å’Œå‘½ä»¤è¡Œå·¥å…·&lt;/li&gt;
&lt;li&gt;æ€§èƒ½ä¼˜å¼‚ï¼Œè¶…è¿‡äº†å…¶ä»–åŒç±»è¿è¡Œæ—¶&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;WebAssemblyï¼Œä¹Ÿç§°ä¸º Wasmï¼Œæ˜¯ä¸€ç§ç¼–è¯‘ç”¨ä¸€ç§ç¼–ç¨‹è¯­è¨€ï¼ˆä¾‹å¦‚ C æˆ– Rustï¼‰ç¼–å†™çš„ä»£ç å¹¶åœ¨ä¸åŒçš„è¿è¡Œæ—¶ï¼ˆä¾‹å¦‚ Web æµè§ˆå™¨æˆ–å¾®æœåŠ¡ï¼‰ä¸Šè¿è¡Œå®ƒçš„æ–¹æ³•ã€‚ è¿™ä½¿å¾—å®ƒæˆä¸ºç¼–å†™æ’ä»¶ã€æ‰©å±•ä»¥åŠåœ¨å®‰å…¨æ²™ç®±ç¯å¢ƒä¸­è¿è¡Œä»»æ„ç”¨æˆ·å®šä¹‰ä»£ç çš„ç»ä½³é€‰æ‹©ã€‚&lt;/p&gt;
&lt;p&gt;WebAssembly ç»å¸¸è¢«è¯¯è®¤ä¸ºæ˜¯ä¸€ç§ä»…é™æµè§ˆå™¨çš„æŠ€æœ¯ï¼Œè€Œå®é™…ä¸Š Wasm æ˜¯ä¸€ç§è·¨å¹³å°çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¯ä»¥ç”±ä»»ä½• WebAssembly è¿è¡Œæ—¶æ‰§è¡Œã€‚ ä»å†å²ä¸Šçœ‹ï¼ŒGo ç¨‹åºå‘˜æ²¡æœ‰å¤ªå¤šå¥½çš„é€‰æ‹©ï¼Œä½†è¿™ç§æƒ…å†µå·²ç»æ”¹å˜ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡ä»‹ç»äº† &lt;a href=&#34;https://wazero.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;wazero&lt;/a&gt;ï¼Œå®ƒåœ¨ç”¨ Go ç¼–ç¨‹è¯­è¨€ç¼–å†™çš„åŸºç¡€è®¾æ–½ä¸­å¾ˆé‡è¦ï¼Œå¹¶æ¶µç›–äº†å…¶æœ€å¼•äººæ³¨ç›®çš„åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;h2 id=&#34;åœ¨-go-ä¸­è¿è¡Œ-webassembly-çš„ç®€å²&#34;&gt;åœ¨ Go ä¸­è¿è¡Œ WebAssembly çš„ç®€å²&lt;/h2&gt;
&lt;p&gt;æœ€åˆï¼Œå¤§å¤šæ•° WebAssembly è¿è¡Œæ—¶æ˜¯ç”¨ C/C++ å’Œ Rust ç¼–ç¨‹è¯­è¨€ç¼–å†™çš„ã€‚ è®¸å¤šäº‘åŸç”Ÿé¡¹ç›®ï¼ŒåŒ…æ‹¬ Dockerã€Istio å’Œ Kubernetes éƒ½æ˜¯ç”¨ Go ç¼–å†™çš„ã€‚ ä¸æ˜¯ç”¨ Go ç¼–å†™çš„è¿è¡Œæ—¶å¯é€šè¿‡ç§°ä¸º CGO çš„æœºåˆ¶è·å¾—ã€‚ ç„¶è€Œï¼ŒCGO ä¸æ˜¯ Goï¼Œé€šè¿‡é€‰æ‹© CGOï¼Œæ‚¨å°±æ”¾å¼ƒäº† Go è¿è¡Œæ—¶çš„è®¸å¤šæ€æ‰‹çº§åŠŸèƒ½ï¼Œä¾‹å¦‚å¯¹å¹¿æ³›å¹³å°äº¤å‰ç¼–è¯‘çš„ä¸€æµæ”¯æŒã€‚å›´ç»• CGO çš„å¤æ‚æ€§ï¼Œå°¤å…¶æ˜¯éšå«çš„æœ¬æœºåº“ï¼Œæ˜¯å°† wasm æ‰©å±•åˆ° Kubernetes è°ƒåº¦ç¨‹åºçš„è¯·æ±‚è¢«æ‹’ç»çš„åŸå› ã€‚ æ€»ä¹‹ï¼ŒGo ç¼ºä¹åŸç”Ÿè¿è¡Œæ—¶å»¶è¿Ÿæˆ–é™åˆ¶äº†å°† WebAssembly å¼•å…¥æ ¸å¿ƒåŸºç¡€è®¾æ–½ã€‚&lt;/p&gt;
&lt;h2 id=&#34;wazero-æ˜¯ä¸º-go-å¼€å‘äººå‘˜ç¼–å†™çš„&#34;&gt;wazero æ˜¯ä¸º Go å¼€å‘äººå‘˜ç¼–å†™çš„&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://wazero.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;wazero&lt;/a&gt; æ˜¯å”¯ä¸€ç”¨ Go ç¼–å†™çš„&lt;strong&gt;é›¶ä¾èµ– WebAssembly è¿è¡Œæ—¶&lt;/strong&gt;ã€‚ è¿™ä¸ªå¼€æºé¡¹ç›®æœ€åˆæ˜¯ç”± &lt;strong&gt;Takeshi Yoneda&lt;/strong&gt; ä½œä¸ºçˆ±å¥½å¼€å§‹çš„ã€‚ 2021 å¹´åº•ï¼ŒTetrate è®¤è¯†åˆ°å…¶æˆ˜ç•¥ä»·å€¼å¹¶æŠ•å…¥äº†å‡ åå…¨èŒå‘˜å·¥ï¼Œä»¥æœŸæœ‰æœä¸€æ—¥å‘å¸ƒ 1.0 ç‰ˆã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿‡å»çš„å‡ ä¸ªæœˆé‡Œï¼Œè¯¥å›¢é˜Ÿå­œå­œä¸å€¦åœ°å·¥ä½œä»¥æ”¯æŒå¤šç§å¹³å°ã€æ¶æ„å’Œç¼–ç¨‹æ¥å£ã€‚ æˆ‘ä»¬å¾ˆé«˜å…´åœ°å®£å¸ƒ wazero 1.0 å‘å¸ƒï¼&lt;/p&gt;
&lt;p&gt;Wazero æ˜¯ä¸€ä¸ªåŠŸèƒ½é½å…¨ã€ç¬¦åˆæ ‡å‡†ã€ä¸°å¯Œä¸”ç»è¿‡å®æˆ˜æ£€éªŒçš„ WebAssembly è¿è¡Œæ—¶ï¼Œå®ƒä¸ Go è¿è¡Œæ—¶çš„æœ€ä½³ç‰¹æ€§æ— ç¼é›†æˆï¼Œä¾‹å¦‚å®‰å…¨å¹¶å‘å’Œä¸Šä¸‹æ–‡ä¼ æ’­ã€‚ å®ƒåŒ…æ‹¬ä¸€ä¸ªé¢å‘ Go å¼€å‘äººå‘˜çš„ç¼–ç¨‹æ¥å£å’Œä¸€ä¸ªé¢å‘é‚£äº›åªæƒ³è¿è¡Œ Wasm çš„äººçš„ CLIã€‚&lt;/p&gt;
&lt;h2 id=&#34;wazero-æœ‰ä»€ä¹ˆä¸åŒä¹‹å¤„&#34;&gt;Wazero æœ‰ä»€ä¹ˆä¸åŒä¹‹å¤„ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;ä½ å¯èƒ½æƒ³çŸ¥é“ wazero çš„ä¼˜åŠ¿åœ¨å“ªé‡Œï¼Œè€ƒè™‘åˆ° Go ä¸å…¶ä»–è¯­è¨€å…·æœ‰è‰¯å¥½çš„äº’æ“ä½œæ€§ã€‚ è¿™å…è®¸æ‚¨é€šè¿‡ CGO é€‰æ‹©å¤šä¸ªä¸æ˜¯ç”¨ Go ç¼–å†™çš„è¿è¡Œæ—¶ã€‚ ä»¥ä¸‹æ˜¯è€ƒè™‘ Wazero çš„äº”ä¸ªç†ç”±ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æœ€ä½³ Go æ”¯æŒ&lt;/strong&gt;ã€‚Wazero æ˜¯çº¯ Go è¯­è¨€ï¼Œä¸å¼•å…¥ä»»ä½•ä¾èµ–ï¼Œä½†æ”¯æŒæ›´è¿›ä¸€æ­¥ã€‚ Wazero åŒ…æ‹¬æƒ¯ç”¨çš„ Go å‡½æ•°ï¼Œä¾‹å¦‚ä¸Šä¸‹æ–‡é›†æˆã€‚ è¿™å…è®¸æ‚¨é‡ç”¨ä¼ å…¥çš„æˆªæ­¢æ—¥æœŸï¼Œä¾‹å¦‚æ¥è‡ª gRPC è¯·æ±‚ä»¥é™åˆ¶åœ¨ wasm å‡½æ•°ä¸­èŠ±è´¹çš„æ—¶é—´ã€‚ è¿è¡Œæ—¶æ˜¯ä¸“é—¨ä¸º Go è®¾è®¡çš„ï¼Œå› æ­¤åœ¨ Go å¼€å‘äººå‘˜å…³æ³¨çš„é—®é¢˜ï¼ˆä¾‹å¦‚ goroutine security /wazeroï¼‰æ–¹é¢&lt;a href=&#34;https://pkg.go.dev/github.com/tetratelabs&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è®°å½•å¾ˆå¥½&lt;/a&gt;ã€‚æ¯”å¦‚å¾ˆå¤šåº“å¯ä»¥åŒæ—¶ä½¿ç”¨ wazero è€Œä¸äº’ç›¸å†²çªï¼Œè¿™äº›éƒ½æ˜¯åœ¨ Go ä¸­æµ‹è¯•è¿‡çš„ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;API å…¼å®¹æ€§&lt;/strong&gt;ã€‚ WebAssembly è¿è¡Œæ—¶åµŒå…¥åœ¨é¡¹ç›®çš„åº•å±‚ä½ç½®ï¼Œå› æ­¤å…¼å®¹æ€§çš„å˜åŒ–å¯èƒ½ä¼šå¯¼è‡´ç‰ˆæœ¬é”å®šï¼Œå°¤å…¶æ˜¯åœ¨ä¸­é—´ä»¶ä¸­ã€‚ Wazero æ˜¯å”¯ä¸€å·²çŸ¥çš„æä¾›è¯­ä¹‰ç‰ˆæœ¬æ§åˆ¶çš„è¿è¡Œæ—¶ã€‚ å‡½æ•°å¯ä»¥åˆ¶ä½œæˆ 1.1 ç‰ˆæœ¬ï¼Œå®ƒä»¬ä¸ä¼šç ´å 1.0 ç”¨æˆ·ã€‚ Wazero æ‰¿è¯ºä¿æŒé›¶ä¾èµ–å¹¶ä¸ Go çš„å‰ä¸¤ä¸ªç‰ˆæœ¬ä¸€èµ·å·¥ä½œã€‚ æ€»ä¹‹ï¼Œwazero çš„å…¼å®¹æ€§æ–¹æ³•æ˜¯æ¨¡ä»¿ Go æœ¬èº«ï¼Œä¸ºå…¶ç”¨æˆ·å¼•å…¥æœ€å°‘çš„ç»´æŠ¤é—®é¢˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¹³å°å…¼å®¹æ€§&lt;/strong&gt;ã€‚wazero å®Œå…¨æ”¯æŒ amd64ã€arm64ã€FreeBSDã€Linuxã€macOS å’Œ Windows åœ¨æœ€æ–°ä¸‰ä¸ªç‰ˆæœ¬çš„ Go ä¸Šçš„ä»»æ„ç»„åˆã€‚ å®ƒè¿˜é€šè¿‡å…¶ â€œè§£é‡Šå™¨è¿è¡Œæ—¶â€ å°†å¯¹ Go çš„æ”¯æŒæ‰©å±•åˆ°å…¶ä»–å¹³å°ï¼Œå®ƒçš„æ‰§è¡Œé€Ÿåº¦æ¯”æœ¬æœº â€œç¼–è¯‘å™¨è¿è¡Œæ—¶â€ æ…¢ã€‚ wazero åœ¨ Windows ä¸Šéå¸¸æ£’ï¼Œå› ä¸ºå®ƒä¸ä»…æ˜¯ä¸€æµçš„å¹³å°ï¼Œè€Œä¸”æˆ‘ä»¬è¿˜åœ¨å‘å¸ƒæ—¶ç”Ÿæˆç­¾åçš„ MSI å®‰è£…ç¨‹åºã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åšå¦‚ç£çŸ³çš„æµ‹è¯•æ–¹æ³•&lt;/strong&gt;ã€‚ Wazero é€šè¿‡å¤šé¡¹è§„èŒƒæµ‹è¯•æ¥æµ‹è¯•å¹³å°æ”¯æŒï¼ŒåŒ…æ‹¬ WebAssembly æ ¸å¿ƒè§„èŒƒçš„ 1.0 å’Œ 2.0 è‰æ¡ˆç‰ˆæœ¬ä»¥åŠç”¨äºæµ‹è¯• I/O åŠŸèƒ½çš„ WASI æµ‹è¯•å¥—ä»¶ã€‚ æˆ‘ä»¬è¿˜è¿è¡Œç”± Zig å’Œ TinyGo ç¼–å†™çš„æ ‡å‡†åº“æµ‹è¯•ã€‚ æœ€åï¼Œæˆ‘ä»¬è¿è¡ŒåŸºå‡†æµ‹è¯•å¹¶å¯¹æ¯ä¸ªæ›´æ”¹è¿›è¡Œ â€œæ¨¡ç³Šæµ‹è¯•â€ã€‚ æ‰€æœ‰è¿™äº›éƒ½ä½¿å¾— wazero çš„é”™è¯¯æ˜“äºè¯†åˆ«å’Œä¿®å¤ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ´»è·ƒçš„ç»ˆç«¯ç”¨æˆ·ç¤¾åŒºã€‚&lt;/strong&gt; wazero çš„ç¤¾åŒºåŒ…æ‹¬è®¸å¤šå…¬å¸çš„æå¼ºçš„å¼€å‘äººå‘˜ã€‚æˆ‘ä»¬æ¶‰åŠä¸€äº›ä¸ Go æ”¯æŒ WebAssembly æœ‰å…³çš„æ–¹é¢ï¼Œå¹¶ä¸º Go å’Œ TinyGo ç¼–è¯‘å™¨åšå‡ºè´¡çŒ®ã€‚è¯·æŸ¥çœ‹æˆ‘ä»¬çš„&lt;a href=&#34;https://wazero.io/community/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç¤¾åŒº&lt;/a&gt;å’Œ&lt;a href=&#34;https://wazero.io/community/users/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç”¨æˆ·&lt;/a&gt;é¡µé¢ï¼Œäº†è§£æ›´å¤šå…³äºæˆ‘ä»¬ä»¥åŠæ‚¨å¦‚ä½•èå…¥å…¶ä¸­çš„ä¿¡æ¯ï¼&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;å°†-wazero-åµŒå…¥æ‚¨çš„é¡¹ç›®ä¸­&#34;&gt;å°† wazero åµŒå…¥æ‚¨çš„é¡¹ç›®ä¸­&lt;/h2&gt;
&lt;p&gt;Wazero æ˜¾ç„¶ä¹Ÿæ˜¯ä¸€ä¸ª Go åº“ï¼Œå…¶ä¸»è¦ç›®æ ‡æ˜¯è®©æ‚¨ä¸è¿è¡Œæ—¶ç¯å¢ƒæ— ç¼é›†æˆï¼Œå¹¶ä½¿ç”¨ WebAssembly æ‰©å±•æ‚¨çš„ Go åº”ç”¨ç¨‹åºã€‚ä¾‹å¦‚ï¼Œå‡è®¾æ‚¨æƒ³è¿è¡Œ&lt;a href=&#34;https://en.wikipedia.org/wiki/Cowsay&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç»å…¸çš„ Unix ç¨‹åº cowsay&lt;/a&gt;ï¼ˆæœ€åˆæ˜¯ç”¨ Perl ç¼–å†™çš„ï¼‰ã€‚é‚£ä¹ˆæ‚¨å¯ä»¥è¾“å…¥ï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;// Download the executable from:
// https://github.com/evacchi/cowsay/releases/download/0.1.0/cowsay.wasm
//go:embed &amp;#34;cowsay.wasm&amp;#34;
var cowsay []byte

func main() {
	ctx := context.Background()
	r := wazero.NewRuntime(ctx)
	wasi_snapshot_preview1.MustInstantiate(ctx, r)
	r.InstantiateWithConfig(ctx, cowsay,
		wazero.NewModuleConfig().
			WithArgs(&amp;#34;cowsay&amp;#34;, // first arg is usually the executable name
				&amp;#34;wazero is awesome!&amp;#34;).
			WithStdout(os.Stdout))
}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¿è¡Œå®ƒä¼šæ˜¾ç¤ºï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt; ____________________
&amp;lt; wazero is awesome! &amp;gt;
 --------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
               ||----w |
                ||     ||
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;ä½¿ç”¨-wazero-cli-å…¥é—¨&#34;&gt;ä½¿ç”¨ wazero CLI å…¥é—¨&lt;/h2&gt;
&lt;p&gt;è¯¥é¡¹ç›®ç°åœ¨åŒ…æ‹¬ä¸€ä¸ª CLIï¼Œç”¨äºè¿è¡Œ WebAssembly äºŒè¿›åˆ¶æ–‡ä»¶ã€‚æˆ‘ä»¬å‘ç°è®¸å¤šç”¨æˆ·æ— è®ºä½¿ç”¨å“ªç§ç¼–ç¨‹è¯­è¨€éƒ½é€‰æ‹©å®ƒï¼Œå› æ­¤æˆ‘ä»¬å†³å®šä½¿ç”¨è¿™ä¸ªä¾‹å­ã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä¸€ä¸ªç®€å•çš„å‘½ä»¤ä¸‹è½½å’Œå®‰è£… wazero CLIï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;$ curl https://wazero.io/install.sh | sh
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æˆ–è€…åœ¨ Windows ä¸Šï¼Œæ‚¨å¯ä»¥&lt;a href=&#34;https://github.com/tetratelabs/wazero/releases/download/v1.0.0-rc.2/wazero_1.0.0-rc.2_windows_amd64.msi&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä¸‹è½½æœ‰ MSI ç­¾åçš„&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿è¡Œæ‚¨çš„ WebAssembly äºŒè¿›åˆ¶æ–‡ä»¶ï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;$ ./bin/wazero run someApp.wasm
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ä¾‹å¦‚ï¼Œå‡è®¾æ‚¨æƒ³åœ¨ CLI ä¸Šè¿è¡Œ cowsayï¼Œé‚£ä¹ˆåªéœ€é”®å…¥&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;$ curl -LO https://github.com/evacchi/cowsay/releases/download/0.1.0/cowsay.wasm
$ wazero run cowsay.wasm wazero is awesome!
 ____________________
&amp;lt; wazero is awesome! &amp;gt;
 --------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
               ||----w |
                ||     ||
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æˆ–è€…ï¼Œä¹Ÿè®¸ä½ æ›´æƒ³ç© 1977 å¹´çš„ Infocom æ–‡æœ¬å†’é™©æ¸¸æˆ Zorkã€‚&lt;/p&gt;
&lt;p&gt;ä½ å¯ä»¥ä» &lt;a href=&#34;https://github.com/evacchi/zork-1/releases/tag/v0.0.1&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://github.com/evacchi/zork-1/releases/tag/v0.0.1&lt;/a&gt; è·å–ä¸€ä¸ª Wasm äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œç„¶åä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è°ƒç”¨ï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;$ curl -L https://github.com/evacchi/zork-1/releases/download/v0.0.1/zork-wasm-wasi.tgz | tar xzf -
$ wazero run -mount=.:/ zork.wasm
Welcome to Dungeon.			This version created 11-MAR-91.
You are in an open field west of a big white house with a boarded
front door.
There is a small mailbox here.
&amp;gt;open mailbox
Opening the mailbox reveals:
  A leaflet.
&amp;gt;read leaflet
Taken.
		    Welcome to Dungeon!

   Dungeon is a game of adventure, danger, and low cunning.  In it
you will explore some of the most amazing territory ever seen by mortal
man.  Hardened adventurers have run screaming from the terrors contained
within.

   In Dungeon, the intrepid explorer delves into the forgotten secrets
of a lost labyrinth deep in the bowels of the earth, searching for
vast treasures long hidden from prying eyes, treasures guarded by
fearsome monsters and diabolical traps!

   No DECsystem should be without one!
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å°½æƒ…ç©å§ï¼&lt;/p&gt;
&lt;h2 id=&#34;æœ€åçš„è¯&#34;&gt;æœ€åçš„è¯&lt;/h2&gt;
&lt;p&gt;è¿™æ˜¯æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªé‡å¤§å‘å¸ƒï¼Œä½†æˆ‘ä»¬æ‰åˆšåˆšå¼€å§‹ï¼&lt;strong&gt;æœ‰è®¸å¤šå€¼å¾—æœŸå¾…çš„äº‹æƒ…&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;WebAssembly è§„èŒƒæ­£åœ¨ä¸æ–­æ›´æ–°ï¼Œæˆ‘ä»¬å°†å¯†åˆ‡å…³æ³¨å®ƒï¼šä¾‹å¦‚ï¼Œ&lt;a href=&#34;https://github.com/WebAssembly/tail-call/blob/main/README.md&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;tail call proposal&lt;/a&gt; åˆšåˆšè¿›å…¥ç¬¬ 4 é˜¶æ®µï¼Œ&lt;a href=&#34;https://github.com/WebAssembly/gc/blob/master/proposals/gc/Overview.md&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;GC proposal&lt;/a&gt; åˆ™æ˜¯è®¸å¤šç¼–ç¨‹è¯­è¨€ï¼ˆå¦‚ Javaï¼‰çš„æ”¯æŒè€…ï¼Œæœ€è¿‘è¿›å…¥äº†ç¬¬ 3 é˜¶æ®µã€‚ Wazero å°†ç»§ç»­é€šè¿‡æ‰€æœ‰æµ‹è¯•ï¼Œéšç€ WebAssembly çš„å‘å±•è€Œå‘å±•ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬è¿˜å¸Œæœ›ä½œä¸ºæ‚¨ WebAssembly è¿è¡Œæ—¶çš„æˆ˜ç•¥æ€§é€‰æ‹©ã€‚æ‚¨å¯ä»¥æœŸå¾…æŒç»­è‡´åŠ›äºæ€§èƒ½ï¼Œå¯è§‚æµ‹æ€§å’Œå¯æ‰©å±•æ€§ã€‚ä¸€ä¸ªä¾‹å­æ˜¯æˆ‘ä»¬å³å°†æ¨å‡ºçš„ä½çº§æ–‡ä»¶ç³»ç»Ÿæ’ä»¶ã€‚å®ƒæ”¯æŒæ¯” Go çš„ fs.FS æ›´å¤šçš„åŠŸèƒ½ï¼Œç°åœ¨å°±å¯ä»¥ä½¿ç”¨ï¼Œä¾‹å¦‚åˆ›å»ºç›®å½•å’Œæ–‡ä»¶ã€‚è¯¥è®¾è®¡æ”¯æŒè‡ªå®šä¹‰å®¡è®¡å’Œè®¿é—®æ§åˆ¶ï¼Œå¹¶å¯ç”¨äºç¬¬ä¸‰æ–¹ä¸»æœºå‡½æ•°ã€‚&lt;/p&gt;
&lt;p&gt;æœ€åï¼Œå¦‚æœæ‚¨åœ¨ 3 æœˆ 23 æ—¥å’Œ 24 æ—¥å‚åŠ å·´å¡ç½—é‚£çš„ Wasm I/O æ´»åŠ¨ï¼Œå°±æœ‰æœºä¼šè®¤è¯†æˆ‘ä»¬å›¢é˜Ÿçš„ä¸€éƒ¨åˆ†ï¼&lt;/p&gt;
&lt;p&gt;å¦‚æœæ‚¨åœ¨ä¼šè®®ç»“æŸåç•™åœ¨é‚£é‡Œï¼Œæˆ–è€…æ‚¨åªæ˜¯åœ¨é‚£ä¸ªæ™šä¸Šåœ¨åŸå¸‚é‡Œï¼Œ&lt;strong&gt;åœ¨ 3 æœˆ 24 æ—¥æ˜ŸæœŸäº”&lt;/strong&gt;ï¼Œæˆ‘ä»¬ä¹Ÿå¾ˆé«˜å…´&lt;a href=&#34;https://www.eventbrite.com/e/wazero-10-launch-party-tickets-585204150367&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;é‚€è¯·æ‚¨å‚åŠ  wazero 1.0 è‡ªå·±çš„å®˜æ–¹å‘å¸ƒæ´¾å¯¹&lt;/a&gt;ã€‚æˆ‘ä»¬å°†æä¾›å°åƒï¼Œé¥®æ–™å’Œè®¸å¤šç¤¾åŒºè´¡çŒ®è€…ï¼Œä»–ä»¬å°†å±•ç¤ºä»–ä»¬å¦‚ä½•ä½¿ç”¨æˆ‘ä»¬æ‰€é’Ÿçˆ±çš„ WebAssembly è¿è¡Œæ—¶ï¼ä¸€ä½å¹¸è¿çš„å‚ä¼šè€…å°†æœ‰æœºä¼šæŒ‰ä¸‹ 1.0 çš„å‘å¸ƒæŒ‰é’®ï¼&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¾ˆå…´å¥‹åœ°çœ‹åˆ°æ‚¨å°†å¦‚ä½•ä½¿ç”¨ Wazero æ„å»ºé¡¹ç›®ã€‚&lt;a href=&#34;https://wazero.io/community/users/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;åŠ å…¥æˆ‘ä»¬ä¸æ–­å¢é•¿çš„ç¤¾åŒºç”¨æˆ·åˆ—è¡¨&lt;/a&gt;ï¼Œå¹¶è®©æˆ‘ä»¬çŸ¥é“æ‚¨æ­£åœ¨åˆ›é€ ä»€ä¹ˆï¼&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>äº‘åŸç”Ÿç»‘å®šåº”ç”¨ï¼šä¸€ç§è®©å¼€å‘è€…ä¸“æ³¨äºä¸šåŠ¡é€»è¾‘çš„æ–°æ¶æ„</title>
      <link>https://lib.jimmysong.io/blog/cloud-bound-applications/</link>
      <pubDate>Thu, 16 Mar 2023 12:00:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/cloud-bound-applications/</guid>
      <description>&lt;p&gt;æœ¬æ–‡ä½œè€… Bilgin Ibryam æ˜¯ Diagrid çš„æŠ€æœ¯äº§å“ç»ç†ï¼Œè‡´åŠ›äºå¼€å‘äººå‘˜ç”Ÿäº§åŠ›å·¥å…·ã€‚åœ¨æ­¤ä¹‹å‰ï¼Œä»–æ›¾åœ¨ Red Hat æ‹…ä»»é¡¾é—®å’Œæ¶æ„å¸ˆï¼ŒåŒæ—¶ä¹Ÿæ˜¯ Apache è½¯ä»¶åŸºé‡‘ä¼šçš„æäº¤è€…å’Œæˆå‘˜ã€‚Bilgin è¿˜ä¸äººåˆè‘—äº†ä¸¤æœ¬å…³äº Kubernetes æ¨¡å¼å’Œ Camel è®¾è®¡æ¨¡å¼çš„ä¹¦ã€‚åœ¨ä¸šä½™æ—¶é—´ï¼ŒBilgin å–œæ¬¢é€šè¿‡åšå®¢å’Œå…¶ä»–æ–¹å¼å†™ä½œå’Œåˆ†äº«ä»–çš„çŸ¥è¯†ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;è¯‘è€…æ³¨ï¼šæœ¬æ–‡çš„åŸæ ‡é¢˜æ˜¯ã€Šä»€ä¹ˆæ˜¯äº‘åŸç”Ÿç»‘å®šåº”ç”¨ã€‹ã€‚æœ¬æ–‡ä»‹ç»äº†äº‘ç»‘å®šåº”ç”¨ç¨‹åºçš„æ¦‚å¿µï¼Œå¹¶æ¢è®¨äº†åœ¨ä½¿ç”¨äº‘ç»‘å®šåº”ç”¨ç¨‹åºæ—¶éœ€è¦è€ƒè™‘çš„å‡ ä¸ªå…³é”®å› ç´ ã€‚é¦–å…ˆï¼Œä½œè€…è§£é‡Šäº†äº‘ç»‘å®šåº”ç”¨ç¨‹åºæ˜¯æŒ‡åœ¨æ„å»ºåº”ç”¨ç¨‹åºæ—¶ä½¿ç”¨äº‘æä¾›çš„æœåŠ¡å’Œèµ„æºã€‚ä½œè€…å¼ºè°ƒäº†ä½¿ç”¨äº‘ç»‘å®šåº”ç”¨ç¨‹åºå¯ä»¥å¸¦æ¥å¾ˆå¤šå¥½å¤„ï¼Œä¾‹å¦‚é™ä½æˆæœ¬å’Œæé«˜å¯é æ€§ã€‚ç„¶è€Œï¼Œä½œè€…ä¹ŸæŒ‡å‡ºäº†åœ¨ä½¿ç”¨äº‘ç»‘å®šåº”ç”¨ç¨‹åºæ—¶éœ€è¦è€ƒè™‘çš„å‡ ä¸ªå…³é”®å› ç´ ï¼ŒåŒ…æ‹¬äº‘ä¾›åº”å•†é”å®šã€æ•°æ®éšç§å’Œç½‘ç»œè¿æ¥å¯é æ€§ç­‰ã€‚æœ€åï¼Œä½œè€…æä¾›äº†ä¸€äº›å»ºè®®ï¼Œå¸®åŠ©ä¼ä¸šåœ¨ä½¿ç”¨äº‘ç»‘å®šåº”ç”¨ç¨‹åºæ—¶é¿å…æ½œåœ¨çš„é£é™©ã€‚ä¾‹å¦‚ï¼Œé€‰æ‹©å…·æœ‰é«˜å¯ç”¨æ€§çš„äº‘æœåŠ¡æä¾›å•†ï¼Œå¹¶åœ¨ä½¿ç”¨äº‘ç»‘å®šåº”ç”¨ç¨‹åºæ—¶åŠ å¼ºæ•°æ®å®‰å…¨æªæ–½ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;å…³é”®è¦ç‚¹&#34;&gt;å…³é”®è¦ç‚¹&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;äº‘æä¾›å•†å°†é‡ç‚¹ä»åŸºç¡€è®¾æ–½æœåŠ¡è½¬ç§»åˆ°å¼€å‘äººå‘˜ç›´æ¥ä½¿ç”¨çš„åº”ç”¨ç¨‹åºä¼˜å…ˆæœåŠ¡ï¼Œä»è€Œäº§ç”Ÿäº†æ–°çš„åº”ç”¨ç¨‹åºæ¶æ„ã€‚&lt;/li&gt;
&lt;li&gt;è¿™ç§æ¶æ„å…è®¸å¼€å‘äººå‘˜å°†é›†æˆé€»è¾‘å’Œç®¡ç†è´£ä»»å¸è½½åˆ°äº‘æœåŠ¡ï¼Œå¹¶ä¸“æ³¨äºå®ç°ä¸šåŠ¡é€»è¾‘ã€‚&lt;/li&gt;
&lt;li&gt;â€œäº‘ç»‘å®šâ€ ä»£è¡¨äº†äº‘åŸç”Ÿä»è§£å†³ä»¥è®¡ç®—ä¸ºä¸­å¿ƒçš„é—®é¢˜å‘ç®¡ç†åº”ç”¨é›†æˆé—®é¢˜çš„æ¼”è¿›ã€‚&lt;/li&gt;
&lt;li&gt;äº‘ç»‘å®šåº”ç”¨ç¨‹åºä½¿ç”¨å¼€æ”¾ API å’Œäº‹å®æ ‡å‡†å°†åº”ç”¨ç¨‹åºçš„å†…éƒ¨æ¶æ„ä¸å…¶å¤–éƒ¨ä¾èµ–é¡¹åˆ†ç¦»ã€‚&lt;/li&gt;
&lt;li&gt;äº‘ç»‘å®šåº”ç”¨ç¨‹åºä½¿ç”¨å¼€æ”¾çš„ API å’Œæ•°æ®æ ¼å¼å°†åº”ç”¨ç¨‹åºç»‘å®šåˆ°è®¡ç®—åŸºç¡€è®¾æ–½ï¼Œå¹¶å°†çŠ¶æ€ç¼–æ’ã€äº‹ä»¶é©±åŠ¨çš„äº¤äº’å’Œå¯é çš„åŒæ­¥äº¤äº’ç­‰é›†æˆè´£ä»»å¸è½½åˆ°äº‘æœåŠ¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åº”ç”¨ç¨‹åºä¼˜å…ˆäº‘æœåŠ¡çš„æ—¥ç›Šæ™®åŠå¯¼è‡´åº”ç”¨ç¨‹åºå’Œäº‘æœåŠ¡çš„é›†æˆæ¯”ä»¥å‰æ›´æ·±å…¥ã€‚åº”ç”¨ç¨‹åºå’Œäº‘ä¹‹é—´çš„è¿è¡Œæ—¶è¾¹ç•Œæ­£åœ¨ä»è™šæ‹Ÿæœºè½¬ç§»åˆ°å®¹å™¨å’Œå‡½æ•°ã€‚åœ¨è¿™ä¸ªæœ€ç»ˆæ¶æ„ä¸­ï¼Œåº”ç”¨ç¨‹åºæ˜¯ â€œäº‘ç»‘å®šâ€ çš„ï¼Œé€šè¿‡å°†æ›´å¤šåº”ç”¨ç¨‹åºé€»è¾‘å’Œç®¡ç†è´£ä»»å¸è½½åˆ°äº‘æœåŠ¡ï¼Œå¼€å‘äººå‘˜å¯ä»¥ä¸“æ³¨äºä¸šåŠ¡é€»è¾‘ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡é€šè¿‡ä½¿ç”¨ä¿æŒçµæ´»æ€§å’Œå¯ç§»æ¤æ€§çš„å¼€æ”¾ API å’Œæ ‡å‡†å°†åº”ç”¨ç¨‹åºç»‘å®šåˆ°äº‘æœåŠ¡æ¥æ£€æŸ¥æ•´ä¸ªè½¯ä»¶å †æ ˆçš„å•†å“åŒ–ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å†…éƒ¨æ¶æ„æ¼”å˜&#34;&gt;å†…éƒ¨æ¶æ„æ¼”å˜&lt;/h2&gt;
&lt;p&gt;åº”ç”¨ç¨‹åºçš„å†…éƒ¨æ¶æ„é€šå¸¸ç”±ä¸€ä¸ªå›¢é˜Ÿæ‹¥æœ‰å’Œæ§åˆ¶ã€‚æ ¹æ®æ‰€é€‰çš„è¯­è¨€å’Œè¿è¡Œæ—¶ï¼ŒåŒ…ã€æ¨¡å—ã€æ¥å£ã€ç±»å’Œå‡½æ•°ç­‰å·¥å…·å’ŒæŠ½è±¡å¯å¸®åŠ©å¼€å‘äººå‘˜æ§åˆ¶å†…éƒ¨è¾¹ç•Œã€‚é¢†åŸŸé©±åŠ¨è®¾è®¡(DDD) å¸®åŠ©å¼€å‘äººå‘˜è®¾è®¡é¢†åŸŸæ¨¡å‹ï¼Œè¿™äº›æ¨¡å‹ä½œä¸ºæŠ½è±¡æ¥å°è£…å¤æ‚çš„ä¸šåŠ¡é€»è¾‘å¹¶è°ƒè§£ä¸šåŠ¡ç°å®ä¸ä»£ç ä¹‹é—´çš„å·®è·ã€‚&lt;/p&gt;
&lt;p&gt;Hexagonalï¼ŒOnion å’Œ Clean æ¶æ„å¯ä»¥è¡¥å……  DDD å¹¶å®‰æ’å…·æœ‰ä¸åŒè¾¹ç•Œå’Œå¤–éƒ¨åŒ–åŸºç¡€è®¾æ–½ä¾èµ–æ€§çš„åº”ç”¨ç¨‹åºä»£ç ã€‚å°½ç®¡è¿™äº›æ–¹æ³•åœ¨å¼€å§‹æ—¶æ˜¯åˆ›æ–°çš„å¹¶ä¸”åœ¨ä»Šå¤©ä»ç„¶é€‚ç”¨ï¼Œä½†å®ƒä»¬æœ€åˆæ˜¯ä¸ºä¸‰å±‚ Java åº”ç”¨ç¨‹åºå¼€å‘çš„ï¼Œè¯¥åº”ç”¨ç¨‹åºç”±éƒ¨ç½²åœ¨å…±äº«åº”ç”¨ç¨‹åºè¿è¡Œæ—¶ä¸­çš„ JSPã€Servlet å’Œ EJB ç»„æˆã€‚å½“æ—¶çš„ä¸»è¦ç„¦ç‚¹æ˜¯å°†åº”ç”¨ç¨‹åºé€»è¾‘ä¸ UI å’Œæ•°æ®åº“åˆ†ç¦»ï¼Œå¹¶å¯ç”¨éš”ç¦»æµ‹è¯•ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-1å†…éƒ¨åº”ç”¨æ¶æ„&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 1ï¼šå†…éƒ¨åº”ç”¨æ¶æ„&#34; srcset=&#34;
               /blog/cloud-bound-applications/1_hue4b81ea9d779f4b30e717f1931f2f2cc_42288_df15796544d3641c41413a7e0762e87c.webp 400w,
               /blog/cloud-bound-applications/1_hue4b81ea9d779f4b30e717f1931f2f2cc_42288_bda3f593a1aeeaa7aefc5304f3419808.webp 760w,
               /blog/cloud-bound-applications/1_hue4b81ea9d779f4b30e717f1931f2f2cc_42288_1200x1200_fit_q75_h2_lanczos_2.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/cloud-bound-applications/1_hue4b81ea9d779f4b30e717f1931f2f2cc_42288_df15796544d3641c41413a7e0762e87c.webp&#34;
               width=&#34;760&#34;
               height=&#34;619&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 1ï¼šå†…éƒ¨åº”ç”¨æ¶æ„
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;ä»é‚£æ—¶èµ·ï¼Œå¾®æœåŠ¡å’ŒåäºŒå› ç´ åº”ç”¨ç¨‹åºç­‰æ–°æŒ‘æˆ˜å’Œæ¦‚å¿µä¸æ–­æ¶Œç°ï¼Œå¹¶å½±å“äº†æˆ‘ä»¬è®¾è®¡åº”ç”¨ç¨‹åºçš„æ–¹å¼ã€‚å¾®æœåŠ¡çš„æ ¸å¿ƒæ˜¯å°†åº”ç”¨ç¨‹åºé€»è¾‘åˆ†ç¦»åˆ°ç”±å•ä¸ªå›¢é˜Ÿæ‹¥æœ‰çš„å¯ç‹¬ç«‹éƒ¨ç½²çš„å•å…ƒä¸­ã€‚åäºŒå› ç´ åº”ç”¨ç¨‹åºæ–¹æ³•æ—¨åœ¨åˆ›å»ºåœ¨åŠ¨æ€äº‘ç¯å¢ƒä¸­è¿è¡Œå’Œæ‰©å±•çš„åˆ†å¸ƒå¼ã€æ— çŠ¶æ€åº”ç”¨ç¨‹åºã€‚æ‰€æœ‰è¿™äº›æ¶æ„éƒ½å¼•å…¥äº†åŸåˆ™å’Œæœ€ä½³å®è·µï¼Œè¿™äº›åŸåˆ™å’Œæœ€ä½³å®è·µå¡‘é€ äº†æˆ‘ä»¬æ„å»ºåº”ç”¨ç¨‹åºå†…éƒ¨æ¶æ„çš„æ–¹å¼ä»¥åŠæˆ‘ä»¬ç®¡ç†å®ƒçš„æ–¹å¼ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-2åº”ç”¨ç¨‹åºæ¶æ„æ¼”è¿›æ—¶é—´è¡¨&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 2ï¼šåº”ç”¨ç¨‹åºæ¶æ„æ¼”è¿›æ—¶é—´è¡¨&#34; srcset=&#34;
               /blog/cloud-bound-applications/2_hu40b71820fd7baf24807d72301013b030_29518_bf3b668a3da2548818f7d4950c79bb55.webp 400w,
               /blog/cloud-bound-applications/2_hu40b71820fd7baf24807d72301013b030_29518_4547c53e895ffe872f72f0ba59a89e94.webp 760w,
               /blog/cloud-bound-applications/2_hu40b71820fd7baf24807d72301013b030_29518_1200x1200_fit_q75_h2_lanczos_2.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/cloud-bound-applications/2_hu40b71820fd7baf24807d72301013b030_29518_bf3b668a3da2548818f7d4950c79bb55.webp&#34;
               width=&#34;760&#34;
               height=&#34;278&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 2ï¼šåº”ç”¨ç¨‹åºæ¶æ„æ¼”è¿›æ—¶é—´è¡¨
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;åæ¥åœ¨åº”ç”¨ç¨‹åºæ¶æ„æ¼”å˜æ—¶é—´è¡¨ä¸­ï¼Œå®¹å™¨çš„ä¸»æµé‡‡ç”¨å’Œ Kubernetes çš„å¼•å…¥å½»åº•æ”¹å˜äº†åº”ç”¨ç¨‹åºçš„æ‰“åŒ…å’Œç¼–æ’æ–¹å¼ã€‚AWS Lambda å¼•å…¥äº†é«˜åº¦å¯æ‰©å±•çš„å‡½æ•°å³æœåŠ¡ (FaaS) çš„æ¦‚å¿µï¼Œå°†åº”ç”¨ç¨‹åºç²’åº¦çš„æ¦‚å¿µæå‡åˆ°ä¸€ä¸ªæ–°çš„æ°´å¹³ï¼Œå¹¶å°†å®Œæ•´çš„åŸºç¡€è®¾æ–½ç®¡ç†è´£ä»»å¸è½½ç»™äº‘æä¾›å•†ã€‚å…¶ä»–æŠ€æœ¯è¶‹åŠ¿ï¼Œä¾‹å¦‚æœåŠ¡ç½‘æ ¼å’Œå¤šè¿è¡Œæ—¶å¾®æœåŠ¡æ¶æ„ï¼Œä¹Ÿå·²ç»å‡ºç°å¹¶å°†éåŠŸèƒ½æ–¹é¢å•†å“åŒ–ï¼Œä¾‹å¦‚ç½‘ç»œå’Œåˆ†å¸ƒå¼å¼€å‘åŸè¯­ï¼Œåˆ†åˆ«å°†å®ƒä»¬æå–åˆ° sidecar ä¸­ã€‚å—å¾®æœåŠ¡çš„å¯å‘ï¼Œæ•°æ®ç½‘æ ¼æ¶æ„æ—¨åœ¨å°†åº”ç”¨ç¨‹åºçš„åˆ†ææ•°æ®æ¶æ„åˆ†è§£ä¸ºæ›´å°ã€ç‹¬ç«‹çš„æ•°æ®åŸŸï¼Œæ¯ä¸ªåŸŸéƒ½æœ‰è‡ªå·±çš„äº§å“å’Œå›¢é˜Ÿã€‚è¿™äº›ä»¥åŠæœ€è¿‘çš„è¶‹åŠ¿ï¼Œä¾‹å¦‚åº”ç”¨ç¨‹åºä¼˜å…ˆçš„äº‘æœåŠ¡ï¼Œæ­£åœ¨å¼€å§‹é‡å¡‘åº”ç”¨ç¨‹åºçš„å¤–éƒ¨æ¶æ„ï¼Œæˆ‘åœ¨æœ¬æ–‡ä¸­å°†å…¶ç»Ÿç§°ä¸º â€œäº‘ç»‘å®šåº”ç”¨ç¨‹åºâ€ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å¤–éƒ¨æ¶æ„æ¼”åŒ–&#34;&gt;å¤–éƒ¨æ¶æ„æ¼”åŒ–&lt;/h2&gt;
&lt;p&gt;å¤–éƒ¨æ¶æ„æ˜¯åº”ç”¨ç¨‹åºä¸å…¶ä»–å›¢é˜Ÿå’Œç»„ç»‡æ‹¥æœ‰çš„å…¶ä»–åº”ç”¨ç¨‹åºå’ŒåŸºç¡€è®¾æ–½ç›¸äº¤çš„åœ°æ–¹ï¼Œé€šå¸¸ä»¥ä¸“ç”¨çš„æœ¬åœ°ä¸­é—´ä»¶ã€å­˜å‚¨ç³»ç»Ÿæˆ–äº‘æœåŠ¡çš„å½¢å¼å‡ºç°ã€‚åº”ç”¨ç¨‹åºè¿æ¥åˆ°å¤–éƒ¨ç³»ç»Ÿå¹¶å¸è½½å…¶éƒ¨åˆ†èŒè´£çš„æ–¹å¼å½¢æˆäº†å¤–éƒ¨æ¶æ„ã€‚ä¸ºäº†ä»åŸºç¡€æ¶æ„ä¸­å—ç›Šï¼Œåº”ç”¨ç¨‹åºéœ€è¦ç»‘å®šåˆ°è¯¥åŸºç¡€æ¶æ„å¹¶å¼ºåˆ¶æ‰§è¡Œæ¸…æ™°çš„è¾¹ç•Œä»¥ä¿æŒå…¶æ•æ·æ€§ã€‚ä¸€ä¸ªåº”ç”¨ç¨‹åºçš„å†…éƒ¨æ¶æ„å’Œå®ç°åº”è¯¥èƒ½å¤Ÿåœ¨ä¸æ”¹å˜å¦ä¸€ä¸ªåº”ç”¨ç¨‹åºçš„æƒ…å†µä¸‹è¿›è¡Œæ›´æ”¹ï¼Œå¤–éƒ¨ä¾èµ–å…³ç³»ï¼ˆä¾‹å¦‚äº‘æœåŠ¡ï¼‰å¯ä»¥åœ¨ä¸æ”¹å˜å†…éƒ¨ç»“æ„çš„æƒ…å†µä¸‹è¿›è¡Œäº¤æ¢ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-3å¤–éƒ¨åº”ç”¨æ¶æ„&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 3ï¼šå¤–éƒ¨åº”ç”¨æ¶æ„&#34; srcset=&#34;
               /blog/cloud-bound-applications/3_huf37fbf5460b713081b06bb34dc5f650c_50572_20a9750e727f34d326372f52c0225b9b.webp 400w,
               /blog/cloud-bound-applications/3_huf37fbf5460b713081b06bb34dc5f650c_50572_4956fef84911f343eb2add80f4d827f7.webp 760w,
               /blog/cloud-bound-applications/3_huf37fbf5460b713081b06bb34dc5f650c_50572_1200x1200_fit_q75_h2_lanczos_2.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/cloud-bound-applications/3_huf37fbf5460b713081b06bb34dc5f650c_50572_20a9750e727f34d326372f52c0225b9b.webp&#34;
               width=&#34;622&#34;
               height=&#34;760&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 3ï¼šå¤–éƒ¨åº”ç”¨æ¶æ„
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;ä»å¹¿ä¹‰ä¸Šè®²ï¼Œæˆ‘ä»¬å¯ä»¥å°†åº”ç”¨ç¨‹åºä¸å…¶å‘¨å›´ç¯å¢ƒç»‘å®šçš„æ–¹å¼åˆ†ä¸ºä¸¤ç±»ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è®¡ç®—ç»‘å®šæ˜¯åœ¨è®¡ç®—å¹³å°ï¼ˆä¾‹å¦‚ Kubernetesã€å®¹å™¨æœåŠ¡ï¼Œç”šè‡³æ˜¯ AWS Lambda ç­‰æ— æœåŠ¡å™¨å‡½æ•°ï¼‰ä¸Šè¿è¡Œåº”ç”¨ç¨‹åºæ‰€éœ€çš„æ‰€æœ‰ç»‘å®šã€é…ç½®ã€API å’Œåˆçº¦ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¿™äº›ç»‘å®šå¯¹å†…éƒ¨æ¶æ„æ˜¯é€æ˜çš„ï¼Œå¹¶ä¸”ç”±è¿è¥å›¢é˜Ÿè€Œéå¼€å‘äººå‘˜é…ç½®å’Œä½¿ç”¨ã€‚å®¹å™¨æŠ½è±¡æ˜¯å½“ä»Šåº”ç”¨ç¨‹åºè®¡ç®—ç»‘å®šæœ€å¹¿æ³›çš„ â€œAPIâ€ã€‚&lt;/li&gt;
&lt;li&gt;é›†æˆç»‘å®šæ˜¯å¯¹åº”ç”¨ç¨‹åºæ‰€ä¾èµ–çš„å¤–éƒ¨ä¾èµ–é¡¹çš„æ‰€æœ‰å…¶ä»–ç»‘å®šçš„æ€»ç§°ã€‚äº‘æœåŠ¡è¿˜ä½¿ç”¨è¿™äº›ç»‘å®šä¸åº”ç”¨ç¨‹åºäº¤äº’ï¼Œé€šå¸¸æ˜¯é€šè¿‡å®šä¹‰æ˜ç¡®çš„ HTTP â€œAPIâ€ æˆ–ä¸“é—¨çš„æ¶ˆæ¯ä¼ é€’å’Œå­˜å‚¨è®¿é—®åè®®ï¼Œä¾‹å¦‚ AWS S3ã€Apache Kafkaã€Redis API ç­‰ã€‚é›†æˆç»‘å®šä¸åƒè¿è¡Œæ—¶ç»‘å®šé‚£æ ·é€æ˜ã€‚å¼€å‘äººå‘˜éœ€è¦å›´ç»•å®ƒä»¬å®ç°é¢å¤–çš„é€»è¾‘ï¼Œä¾‹å¦‚é‡è¯•ã€TTLã€å»¶è¿Ÿã€æ­»ä¿¡é˜Ÿåˆ— (DLQ) ç­‰ï¼Œå¹¶å°†å®ƒä»¬ç»‘å®šåˆ°åº”ç”¨ç¨‹åºçš„ä¸šåŠ¡é€»è¾‘ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åº”ç”¨ç¨‹åºåœ¨äº‘ä¸Šè¿è¡Œå¹¶é€šè¿‡ä½¿ç”¨è¿™äº›ç»‘å®šæ¥ä½¿ç”¨å…¶ä»–æœåŠ¡ã€‚è®©æˆ‘ä»¬æ›´è¯¦ç»†åœ°äº†è§£è¿™äº›ç»‘å®šèƒŒåçš„å†…å®¹ã€‚&lt;/p&gt;
&lt;h2 id=&#34;è®¡ç®—ç»‘å®š&#34;&gt;è®¡ç®—ç»‘å®š&lt;/h2&gt;
&lt;p&gt;å¯¹äºè¿è¥å›¢é˜Ÿæ¥è¯´ï¼Œç†æƒ³æƒ…å†µä¸‹ï¼Œæ¯ä¸ªåº”ç”¨ç¨‹åºéƒ½æ˜¯ä¸€ä¸ªéœ€è¦åœ¨è®¡ç®—å¹³å°ä¸Šè¿è¡Œçš„é»‘ç›’å•å…ƒã€‚è®¡ç®—ç»‘å®šç”¨äºç®¡ç† Kubernetesã€AWS Lambda å’Œå…¶ä»–æœåŠ¡ç­‰å¹³å°ä¸Šåº”ç”¨ç¨‹åºçš„ç”Ÿå‘½å‘¨æœŸã€‚è¿™äº›ç»‘å®šä»¥åº”ç”¨ç¨‹åºå’Œåº”ç”¨ç¨‹åºè¿è¡Œå¹³å°ä¹‹é—´çš„é…ç½®å’Œ API äº¤äº’é›†åˆçš„å½¢å¼å½¢å¼åŒ–å’Œå®šä¹‰ã€‚è¿™äº›äº¤äº’ä¸­çš„å¤§éƒ¨åˆ†å¯¹åº”ç”¨ç¨‹åºæ˜¯é€æ˜çš„ï¼Œåªæœ‰å°‘æ•° API éœ€è¦å¼€å‘äººå‘˜å®ç°ï¼Œä¾‹å¦‚å¥åº·ç«¯ç‚¹å’ŒæŒ‡æ ‡ APIã€‚è¿™æ˜¯ç›®å‰ CNCF å¯¹ â€œäº‘åŸç”Ÿâ€ å®šä¹‰  å’ŒèŒƒå›´çš„æ‰©å±•ï¼Œåªè¦å¼€å‘è€…å®ç°äº‘åŸç”Ÿåº”ç”¨ï¼Œä»–ä»¬å¯ä»¥åœ¨äº‘è®¡ç®—å¹³å°ä¸Šç»‘å®šè¿è¡Œã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-4åº”ç”¨ç¨‹åºå’Œå¹³å°è®¡ç®—ç»‘å®š&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 4ï¼šåº”ç”¨ç¨‹åºå’Œå¹³å°è®¡ç®—ç»‘å®š&#34; srcset=&#34;
               /blog/cloud-bound-applications/4_hu1b40fa2145481e5f4874d3ce5345bc21_55792_8757d39fa9a483b002667b7270c9d101.webp 400w,
               /blog/cloud-bound-applications/4_hu1b40fa2145481e5f4874d3ce5345bc21_55792_ec0ac96c3ed0af4f5f841d784cc309c8.webp 760w,
               /blog/cloud-bound-applications/4_hu1b40fa2145481e5f4874d3ce5345bc21_55792_1200x1200_fit_q75_h2_lanczos_2.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/cloud-bound-applications/4_hu1b40fa2145481e5f4874d3ce5345bc21_55792_8757d39fa9a483b002667b7270c9d101.webp&#34;
               width=&#34;760&#34;
               height=&#34;616&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 4ï¼šåº”ç”¨ç¨‹åºå’Œå¹³å°è®¡ç®—ç»‘å®š
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;è¦åœ¨äº‘å¹³å°ä¸Šå¯é åœ°è¿è¡Œï¼Œåº”ç”¨ç¨‹åºå¿…é¡»åœ¨ä»è§„èŒƒåˆ°æœ€ä½³å®è·µçš„å¤šä¸ªå±‚é¢ä¸Šä¸ä¹‹ç»‘å®šã€‚è¿™æ˜¯é€šè¿‡ä¸€ç»„è¡Œä¸šæ ‡å‡†è§„èŒƒï¼ˆä¾‹å¦‚å®¹å™¨ APIã€æŒ‡æ ‡ APIï¼‰å®ç°çš„ï¼Œä¾‹å¦‚åŸºäº Prometheusã€å¥åº·ç«¯ç‚¹æˆ–äº‘æä¾›å•†è§„èŒƒï¼ˆä¾‹å¦‚ AWS Lambda æˆ– AWS ECS è§„èŒƒï¼‰ã€‚æ­¤å¤–ï¼Œé€šè¿‡äº‘åŸç”Ÿæœ€ä½³æŠ€æœ¯å’Œå…±äº«çŸ¥è¯†ï¼Œä¾‹å¦‚å¥åº·æ£€æŸ¥ã€éƒ¨ç½²ç­–ç•¥å’Œæ”¾ç½®ç­–ç•¥ã€‚è®©æˆ‘ä»¬çœ‹çœ‹å½“ä»Šä½¿ç”¨çš„å¸¸è§è®¡ç®—ç»‘å®šã€‚&lt;/p&gt;
&lt;h3 id=&#34;èµ„æºéœ€æ±‚&#34;&gt;èµ„æºéœ€æ±‚&lt;/h3&gt;
&lt;p&gt;åŒ…æ‹¬å¾®æœåŠ¡å’Œå‡½æ•°åœ¨å†…çš„åº”ç”¨ç¨‹åºéœ€è¦ CPUã€å†…å­˜å’Œå­˜å‚¨ç­‰èµ„æºã€‚è¿™äº›èµ„æºçš„å®šä¹‰å› æ‰€ä½¿ç”¨çš„å¹³å°è€Œå¼‚ã€‚ä¾‹å¦‚ï¼Œåœ¨ Kubernetes ä¸Šï¼ŒCPU å’Œå†…å­˜æ˜¯é€šè¿‡è¯·æ±‚å’Œé™åˆ¶å®šä¹‰çš„ï¼Œè€Œåœ¨ AWS Lambda ä¸Šï¼Œç”¨æˆ· æŒ‡å®šè¿è¡Œæ—¶åˆ†é…çš„å†…å­˜é‡ï¼Œä»¥åŠå¯¹åº”çš„ CPU åˆ†é…ã€‚å­˜å‚¨åœ¨è¿™äº›å¹³å°ä¸Šçš„å¤„ç†æ–¹å¼ä¹Ÿä¸åŒï¼ŒKubernetes ä½¿ç”¨ä¸´æ—¶å­˜å‚¨å’Œå·ï¼Œè€Œ Lambda æä¾›ä¸´æ—¶æš‚å­˜èµ„æºå’ŒåŸºäº Amazon EFS æŒ‚è½½çš„æŒä¹…å­˜å‚¨ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ç”Ÿå‘½å‘¨æœŸé’©å­&#34;&gt;ç”Ÿå‘½å‘¨æœŸé’©å­&lt;/h3&gt;
&lt;p&gt;ç”±å¹³å°ç®¡ç†çš„åº”ç”¨ç¨‹åºé€šå¸¸éœ€è¦äº†è§£é‡è¦çš„ç”Ÿå‘½å‘¨æœŸäº‹ä»¶ã€‚ä¾‹å¦‚ï¼Œåœ¨ Kubernetes ä¸Šï¼Œinit å®¹å™¨ç­‰æ¦‚å¿µå’Œ PostStart å’Œ PreStop ç­‰é’©å­å…è®¸åº”ç”¨ç¨‹åºå¯¹è¿™äº›äº‹ä»¶åšå‡ºååº”ã€‚åŒæ ·ï¼ŒLambda çš„ extensions API å…è®¸åº”ç”¨ç¨‹åºæ‹¦æˆª Initã€Invoke å’Œ Shutdown é˜¶æ®µã€‚å¤„ç†ç”Ÿå‘½å‘¨æœŸäº‹ä»¶çš„å…¶ä»–é€‰é¡¹åŒ…æ‹¬åŒ…è£…å™¨è„šæœ¬æˆ–ç‰¹å®šäºè¯­è¨€çš„è¿è¡Œæ—¶ä¿®æ”¹é€‰é¡¹ï¼Œä¾‹å¦‚ JVM çš„å…³é—­é’©å­ã€‚è¿™äº›æœºåˆ¶å½¢æˆäº†å¹³å°å’Œåº”ç”¨ç¨‹åºä¹‹é—´çš„å¥‘çº¦ï¼Œä½¿å…¶èƒ½å¤Ÿå“åº”å’Œç®¡ç†è‡ªå·±çš„ç”Ÿå‘½å‘¨æœŸã€‚&lt;/p&gt;
&lt;h3 id=&#34;å¥åº·æ£€æŸ¥&#34;&gt;å¥åº·æ£€æŸ¥&lt;/h3&gt;
&lt;p&gt;è¿è¡ŒçŠ¶å†µæ¢æµ‹æ˜¯å¹³å°ç›‘æ§åº”ç”¨ç¨‹åºè¿è¡ŒçŠ¶å†µå¹¶åœ¨å¿…è¦æ—¶é‡‡å–çº æ­£æªæ–½ï¼ˆä¾‹å¦‚é‡æ–°å¯åŠ¨åº”ç”¨ç¨‹åºï¼‰çš„ä¸€ç§æ–¹å¼ã€‚ç”±äºè¯·æ±‚çš„ç”Ÿå‘½å‘¨æœŸè¾ƒçŸ­ï¼ŒLambda å‡½æ•°æ²¡æœ‰å¥åº·æ¢æµ‹ï¼Œè€Œå®¹å™¨åŒ–åº”ç”¨ç¨‹åºå’Œç¼–æ’å™¨ï¼ˆå¦‚ Kubernetesã€AWS EKS å’Œ GCP Cloud Runï¼‰ç¡®å®åœ¨å…¶å®šä¹‰ä¸­åŒ…å« å¥åº·æ¢æµ‹ã€‚è¿™ä½¿å¹³å°èƒ½å¤Ÿç¡®ä¿åº”ç”¨ç¨‹åºå¹³ç¨³è¿è¡Œï¼Œå¹¶åœ¨åº”ç”¨ç¨‹åºè¿è¡Œä¸å¹³ç¨³æ—¶é‡‡å–æªæ–½ã€‚&lt;/p&gt;
&lt;h3 id=&#34;éƒ¨ç½²å’Œæ”¾ç½®ç­–ç•¥&#34;&gt;éƒ¨ç½²å’Œæ”¾ç½®ç­–ç•¥&lt;/h3&gt;
&lt;p&gt;ä¸€æ—¦çŸ¥é“æ‰€éœ€çš„èµ„æºï¼Œè®¡ç®—å¹³å°å°±å¯ä»¥å¼€å§‹ç®¡ç†åº”ç”¨ç¨‹åºçš„ç”Ÿå‘½å‘¨æœŸã€‚è¦ä»¥ä¸æŸå®³ä¸šåŠ¡é€»è¾‘å®Œæ•´æ€§çš„æ–¹å¼æ‰§è¡Œæ­¤æ“ä½œï¼Œå¹³å°å¿…é¡»äº†è§£æ‰©å±•çº¦æŸã€‚æœ‰äº›åº”ç”¨ç¨‹åºè¢«è®¾è®¡ä¸ºå•ä¾‹ã€‚ä¾‹å¦‚ï¼Œå®ƒä»¬éœ€è¦ç»´æŠ¤å·²å¤„ç†äº‹ä»¶çš„é¡ºåºå¹¶ä¸”ä¸èƒ½æ‰©å±•åˆ°å¤šä¸ªå®ä¾‹ã€‚å…¶ä»–æœ‰çŠ¶æ€åº”ç”¨ç¨‹åºå¯èƒ½æ˜¯ä»²è£é©±åŠ¨çš„ï¼Œå¹¶ä¸”éœ€è¦ç‰¹å®šæ•°é‡çš„æœ€å°å®ä¾‹è¿ç»­è¿è¡Œæ‰èƒ½æ­£å¸¸è¿è¡Œã€‚è¿˜æœ‰ä¸€äº›å‡½æ•°ï¼Œä¾‹å¦‚æ— çŠ¶æ€å‡½æ•°ï¼Œå¯èƒ½æœ‰åˆ©äºå¿«é€Ÿæ‰©å±•ä»¥è§£å†³ä¸æ–­å¢åŠ çš„è´Ÿè½½å³°å€¼é—®é¢˜ã€‚ä¸€æ—¦å»ºç«‹äº†åº”ç”¨ç¨‹åºçš„ç¼©æ”¾æŒ‡å—ï¼Œå¹³å°å°±ä¼šæ§åˆ¶åº”ç”¨ç¨‹åºå®ä¾‹çš„å¯åŠ¨å’Œç»ˆæ­¢ã€‚&lt;/p&gt;
&lt;p&gt;è®¡ç®—è¿˜æä¾›æ»šåŠ¨ã€è“ç»¿ã€é‡‘ä¸é›€ã€ä¸€æ¬¡ç­‰å¤šç§éƒ¨ç½²ç­–ç•¥ï¼Œæ¥æ§åˆ¶æœåŠ¡æ›´æ–°çš„é¡ºåºã€‚é™¤äº†éƒ¨ç½²é¡ºåºä¹‹å¤–ï¼Œè¿™äº›å¹³å°è¿˜å…è®¸ç”¨æˆ·æŒ‡å®šæ”¾ç½®é¦–é€‰é¡¹ã€‚ä¾‹å¦‚ï¼ŒKubernetes æä¾›æ ‡ç­¾ã€æ±¡ç‚¹å’Œå®¹å¿åº¦ã€äº²å’ŒåŠ›å’Œåäº²å’ŒåŠ›ç­‰é€‰é¡¹ï¼Œè€Œ Lambda å…è®¸ç”¨æˆ·åœ¨åŒºåŸŸå’Œè¾¹ç¼˜æ”¾ç½®ç±»å‹ä¹‹é—´è¿›è¡Œé€‰æ‹©ã€‚è¿™äº›é¦–é€‰é¡¹å¯ç¡®ä¿éƒ¨ç½²åº”ç”¨ç¨‹åºå¹¶æ»¡è¶³åˆè§„æ€§å’Œæ€§èƒ½è¦æ±‚ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ç½‘ç»œæµé‡&#34;&gt;ç½‘ç»œæµé‡&lt;/h3&gt;
&lt;p&gt;è®¡ç®—å¹³å°è¿˜è´Ÿè´£å°†ä½çº§ç½‘ç»œæµé‡å¼•å¯¼è‡³æœåŠ¡å®ä¾‹ã€‚è¿™æ˜¯å› ä¸ºå®ƒè´Ÿè´£éƒ¨ç½²æ’åºã€æ”¾ç½®å’Œè‡ªåŠ¨ç¼©æ”¾ï¼Œè¿™äº›éƒ½ä¼šå½±å“æµé‡å¦‚ä½•å®šå‘åˆ°æœåŠ¡å®ä¾‹ã€‚å¥åº·æ£€æŸ¥ä¹Ÿå¯ä»¥åœ¨æµé‡ç®¡ç†ä¸­å‘æŒ¥ä½œç”¨ï¼Œä¾‹å¦‚ GCP Cloud Run å’Œ Kubernetes ä¸­çš„å‡†å¤‡æƒ…å†µæ£€æŸ¥ã€‚é€šè¿‡å¤„ç†è¿™äº›ä»»åŠ¡ï¼Œè®¡ç®—å¹³å°æœ‰åŠ©äºç¡®ä¿æµé‡é«˜æ•ˆä¸”æœ‰æ•ˆåœ°è·¯ç”±åˆ°é€‚å½“çš„æœåŠ¡å®ä¾‹ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ç›‘æ§å’ŒæŠ¥å‘Š&#34;&gt;ç›‘æ§å’ŒæŠ¥å‘Š&lt;/h3&gt;
&lt;p&gt;ä»»ä½•ç”¨äºåˆ†å¸ƒå¼åº”ç”¨ç¨‹åºçš„è®¡ç®—å¹³å°éƒ½å¿…é¡»ä»¥æ—¥å¿—ã€æŒ‡æ ‡å’Œè·Ÿè¸ªçš„å½¢å¼æä¾›æ·±å…¥çš„åº”ç”¨ç¨‹åºæ´å¯ŸåŠ›ã€‚ç›®å‰è¯¥é¢†åŸŸå‡ ä¹æ²¡æœ‰è¢«å¹¿æ³›æ¥å—çš„äº‹å®æ ‡å‡†ï¼šæ—¥å¿—æœ€å¥½ä»¥ç»“æ„åŒ–æ ¼å¼ä½¿ç”¨ï¼Œä¾‹å¦‚ JSON æˆ–å…¶ä»–è¡Œä¸šç‰¹å®šæ ‡å‡†ã€‚è®¡ç®—å¹³å°é€šå¸¸æ”¶é›†æ—¥å¿—æˆ–ä¸ºä¸“é—¨çš„æ—¥å¿—æå–å’Œåˆ†ææœåŠ¡æä¾›æ‰©å±•ç‚¹ä»¥è®¿é—®æ—¥å¿—ã€‚è¿™å¯ä»¥æ˜¯ Kubernetes ä¸Šçš„ DaemonSetï¼Œç”¨äºç›‘æ§çš„ Lambda åˆä½œä¼™ä¼´æ‰©å±•ï¼Œæˆ– Vercel è¾¹ç¼˜åŠŸèƒ½æ—¥å¿— Drainerã€‚è®¡ç®—å¹³å°å¿…é¡»æ”¯æŒæŒ‡æ ‡å’Œè¿½è¸ªæ•°æ®çš„æ”¶é›†å’Œåˆ†æï¼Œä»¥å…¨é¢äº†è§£åˆ†å¸ƒå¼åº”ç”¨ç¨‹åºçš„æ€§èƒ½å’Œè¡Œä¸ºã€‚æœ‰å‡ ç§è¡Œä¸šæ ‡å‡†æ ¼å¼å’Œå·¥å…·å¯ç”¨äºå¤„ç†æ­¤æ•°æ® OpenTelemetry (OTEL) for Tracking è®¡ç®—å¹³å°å¯ä»¥æä¾›å†…ç½®å·¥å…·æ¥æ”¶é›†å’Œåˆ†æè¿™äº›æ•°æ®ï¼Œæˆ–è€…ä¸ºä¸“é—¨æœåŠ¡æä¾›æ‰©å±•ç‚¹æ¥è®¿é—®æ•°æ®ã€‚æ— è®ºä»£ç ç²’åº¦ï¼ˆå¾®æœåŠ¡æˆ–å‡½æ•°ï¼‰æˆ–ä½ç½®ï¼ˆè¾¹ç¼˜æˆ–éè¾¹ç¼˜ï¼‰å¦‚ä½•ï¼Œè®¡ç®—å¹³å°éƒ½å¿…é¡»å…è®¸æ•è·æ—¥å¿—ã€æŒ‡æ ‡å’Œè¿½è¸ªæ•°æ®ï¼Œå¹¶å¯¼å‡ºåˆ°å…¶ä»–åŒç±»æœ€ä½³çš„äº‘æœåŠ¡ã€‚ä¾‹å¦‚ Honeycombã€DataDogã€Grafana ç­‰ã€‚&lt;/p&gt;
&lt;h3 id=&#34;è®¡ç®—ç»‘å®šè¶‹åŠ¿&#34;&gt;è®¡ç®—ç»‘å®šè¶‹åŠ¿&lt;/h3&gt;
&lt;p&gt;è®¡ç®—ç»‘å®šä¸è¯­è¨€å’Œåº”ç”¨ç¨‹åºè¿è¡Œæ—¶æ— å…³ï¼Œä¸»è¦ç”±è¿è¥å›¢é˜Ÿç”¨äºåœ¨è¿è¡Œæ—¶ç®¡ç†åº”ç”¨ç¨‹åºï¼Œè€Œä¸æ˜¯å¼€å‘äººå‘˜å®ç°å®ƒä»¬ã€‚&lt;/p&gt;
&lt;p&gt;è™½ç„¶åº”ç”¨ç¨‹åºçš„å¤§å°å’Œå¤æ‚æ€§å¯èƒ½å› æ•´ä½“å’ŒåŠŸèƒ½è€Œå¼‚ï¼Œä½†å®ƒä»¬é€šå¸¸æ‰“åŒ…åœ¨å…·æœ‰å¥åº·æ£€æŸ¥ç«¯ç‚¹ã€å®æ–½çš„ç”Ÿå‘½å‘¨æœŸæŒ‚é’©å’Œå…¬å¼€æŒ‡æ ‡çš„å®¹å™¨ä¸­ã€‚äº†è§£è¿™äº›è®¡ç®—ç»‘å®šå°†å¸®åŠ©ä½ æœ‰æ•ˆåœ°ä½¿ç”¨ä»»ä½•åŸºäºå®¹å™¨çš„è®¡ç®—å¹³å°ï¼Œæ— è®ºæ˜¯æœ¬åœ° Kubernetes é›†ç¾¤ã€æ‰˜ç®¡å®¹å™¨æœåŠ¡ï¼ˆä¾‹å¦‚ AWS ECSã€Google Cloud Runã€Azure Container Appï¼‰ï¼Œè¿˜æ˜¯åŸºäºå‡½æ•°çš„è¿è¡Œæ—¶ï¼ˆä¾‹å¦‚ä½œä¸º AWS Lambdaã€GCP å‡½æ•°æˆ–è¾¹ç¼˜è¿è¡Œæ—¶ï¼Œä¾‹å¦‚ Vercel è¾¹ç¼˜å‡½æ•°ã€CloudFlare worker æˆ– Netlify edge functions ç­‰ã€‚ä½¿ç”¨å¼€æ”¾çš„äº‹å®ä¸Šçš„æ ‡å‡† API ä¸ä»…å¯ä»¥å¸®åŠ©ä½ åˆ›å»ºå¯ç§»æ¤çš„åº”ç”¨ç¨‹åºï¼Œè¿˜å¯ä»¥é€šè¿‡ä½¿ç”¨å¯è·¨äº‘ä¾›åº”å•†å’ŒæœåŠ¡æä¾›å•†ç§»æ¤çš„æ“ä½œå®è·µå’Œå·¥å…·æ¥é™åˆ¶ä¾›åº”å•†é”å®šã€‚&lt;/p&gt;
&lt;h2 id=&#34;é›†æˆç»‘å®š&#34;&gt;é›†æˆç»‘å®š&lt;/h2&gt;
&lt;p&gt;å¦ä¸€æ–¹é¢ï¼Œé›†æˆç»‘å®šæ—¨åœ¨ä¾›å¼€å‘äººå‘˜è€Œä¸æ˜¯è¿è¥å›¢é˜Ÿä½¿ç”¨ã€‚å®ƒä»¬ä»¥å¸¸è§çš„åˆ†å¸ƒå¼ç³»ç»Ÿå®ç°é¢†åŸŸä¸ºä¸­å¿ƒï¼Œä¾‹å¦‚æœåŠ¡è°ƒç”¨ã€äº‹ä»¶é©±åŠ¨äº¤äº’ã€ä»»åŠ¡è°ƒåº¦å’Œæœ‰çŠ¶æ€å·¥ä½œæµç¼–æ’ã€‚å®ƒä»¬é€šè¿‡åŸºäºäº‘çš„ç±»ä¼¼ä¸­é—´ä»¶çš„æœåŠ¡å¸®åŠ©å°†åº”ç”¨ç¨‹åºä¸ä¸“ç”¨å­˜å‚¨ç³»ç»Ÿå’Œå¤–éƒ¨ç³»ç»Ÿè¿æ¥èµ·æ¥ï¼Œåœ¨æœ¬æ–‡ä¸­ç»Ÿç§°ä¸ºé›†æˆäº‘ã€‚ä¸å®¹å™¨æä¾›è®¡ç®—æŠ½è±¡çš„æ–¹å¼ç›¸åŒï¼Œé›†æˆäº‘æœåŠ¡æä¾›ä¸è¯­è¨€æ— å…³çš„é›†æˆæŠ½è±¡ä½œä¸ºæœåŠ¡ã€‚è¿™äº›åŸè¯­ç‹¬ç«‹äºç”¨ä¾‹ã€åº”ç”¨ç¨‹åºå®ç°ã€è¿è¡Œæ—¶å’Œè®¡ç®—ç¯å¢ƒã€‚ä¾‹å¦‚é‡è¯•æ¨¡å¼ã€DLQ æ¨¡å¼ã€ Saga æ¨¡å¼ã€æœåŠ¡å‘ç°å’Œ æ–­è·¯å™¨æ¨¡å¼éƒ½å¯ä»¥é›†æˆä¸ºæœåŠ¡ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-5åº”ç”¨ç¨‹åºå’Œå¹³å°é›†æˆç»‘å®š&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 5ï¼šåº”ç”¨ç¨‹åºå’Œå¹³å°é›†æˆç»‘å®š&#34; srcset=&#34;
               /blog/cloud-bound-applications/5_hufb20aa7c61dad71a4c335dca460c4126_61270_d8bf9e364f58b2f09b5f0902a734a2a2.webp 400w,
               /blog/cloud-bound-applications/5_hufb20aa7c61dad71a4c335dca460c4126_61270_36cc25a7a9c022f4b9694728d36a7cb2.webp 760w,
               /blog/cloud-bound-applications/5_hufb20aa7c61dad71a4c335dca460c4126_61270_1200x1200_fit_q75_h2_lanczos_2.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/cloud-bound-applications/5_hufb20aa7c61dad71a4c335dca460c4126_61270_d8bf9e364f58b2f09b5f0902a734a2a2.webp&#34;
               width=&#34;760&#34;
               height=&#34;616&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 5ï¼šåº”ç”¨ç¨‹åºå’Œå¹³å°é›†æˆç»‘å®š
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;ä»Šå¤©ä¸å­˜åœ¨å°†æ‰€æœ‰ä¸»è¦æ¨¡å¼å…¬å¼€ä¸ºç‹¬ç«‹åŠŸèƒ½çš„çº¯é›†æˆäº‘ã€‚æ—©æœŸçš„äº‘æœåŠ¡æ­£åœ¨æä¾›å…¶ä¸­ä¸€äº›é›†æˆåŸè¯­ä½œä¸ºå­˜å‚¨ç³»ç»Ÿï¼ˆå¦‚ Kafkaã€Redis ç­‰ï¼‰çš„åŠŸèƒ½ï¼Œä½†è¿™äº›åŠŸèƒ½å¾ˆå°‘å•ç‹¬ä½¿ç”¨æˆ–ä¸å…¶ä»–åŠŸèƒ½ç»“åˆä½¿ç”¨ã€‚è¿™é‡Œå€¼å¾—æ³¨æ„çš„ä¾‹å¤–æ˜¯ AWS EventBridge å’Œ Azure Event Grid ç­‰æœåŠ¡ï¼Œä½ å¯ä»¥å°†å®ƒä»¬ä¸æ¥è‡ªåŒä¸€æä¾›å•†çš„å¤šä¸ªäº‘æœåŠ¡ä¸€èµ·ä½¿ç”¨ï¼Œä½†ä¸èƒ½ç›´æ¥ä¸å…¶ä»–æä¾›å•†ä¸€èµ·ä½¿ç”¨ã€‚è¿™æ˜¯ä¸€ä¸ªå¿«é€Ÿå‘å±•çš„é¢†åŸŸï¼Œæœ‰ä¸€äº›å¾ˆå¥½çš„ä¾‹å­å’Œä¸€äº›å°šæœªå¡«è¡¥çš„ç©ºç™½ï¼Œä½†æˆ‘ç›¸ä¿¡å®ƒä»¬ä¼šåœ¨æœªæ¥å‡ºç°ã€‚åº”ç”¨ç¨‹åºå¿…é¡»ç»‘å®šåˆ°é›†æˆçš„äº‘æœåŠ¡å¹¶å¸è½½å…¶ä¸­çš„ä¸€äº›å¼€å‘äººå‘˜èŒè´£æ‰èƒ½è¿è¡Œã€‚ä»¥ä¸‹æ˜¯é›†æˆäº‘æœåŠ¡çš„ä¸»è¦ç±»å‹å’Œç»‘å®šæ–¹é¢ã€‚&lt;/p&gt;
&lt;h3 id=&#34;é›†æˆè¦æ±‚&#34;&gt;é›†æˆè¦æ±‚&lt;/h3&gt;
&lt;p&gt;ä¸åº”ç”¨ç¨‹åºå¯ä»¥è¯·æ±‚èµ„æºå¹¶å‘è®¡ç®—å¹³å°è¡¨è¾¾éƒ¨ç½²å’Œæ”¾ç½®åå¥½çš„æ–¹å¼ç›¸åŒï¼Œåº”ç”¨ç¨‹åºä¹Ÿå¯ä»¥è¯·æ±‚å’Œæ¿€æ´»ç‰¹å®šçš„é›†æˆç»‘å®šã€‚è¿™äº›ç»‘å®šå¯ä»¥é€šè¿‡ä»¥å£°æ˜æ–¹å¼ä¼ é€’ç»™å¹³å°çš„é…ç½®æ¥æ¿€æ´»ï¼Œæˆ–è€…åœ¨è¿è¡Œæ—¶é€šè¿‡ç¼–ç¨‹äº¤äº’æ¥æ¿€æ´»ã€‚ä¾‹å¦‚ï¼Œåº”ç”¨ç¨‹åºå¯ä»¥ä½¿ç”¨å£°æ˜å¼å’Œç¼–ç¨‹å¼è®¢é˜… pub/sub ä¸»é¢˜ã€‚AWS Lambda å‡½æ•°äº‹ä»¶æºå¯ä»¥é€šè¿‡é…ç½®ä»¥å£°æ˜æ–¹å¼è®¢é˜…ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å®¢æˆ·ç«¯åº“æˆ– SDK è¯·æ±‚é›†æˆå¹³å°æ³¨å†Œæˆ–æ³¨é”€ç‰¹å®šç»‘å®šä»¥ç¼–ç¨‹æ–¹å¼è®¢é˜…ã€‚åº”ç”¨ç¨‹åºå¯ä»¥è®¢é˜… cron ä½œä¸šè§¦å‘å™¨ã€æ¿€æ´»å¤–éƒ¨ç³»ç»Ÿçš„è¿æ¥å™¨ã€è¿›è¡Œé…ç½®æ›´æ”¹ç­‰ç­‰ï¼Œæ‰€æœ‰è¿™äº›éƒ½åœ¨é›†æˆäº‘ä¸Šè¿è¡Œã€‚&lt;/p&gt;
&lt;h3 id=&#34;å·¥ä½œæµç¨‹ç¼–æ’&#34;&gt;å·¥ä½œæµç¨‹ç¼–æ’&lt;/h3&gt;
&lt;p&gt;æŒä¹…æœåŠ¡ç¼–æ’é€»è¾‘æ˜¯ä¸€ç§éå¸¸æ™®éçš„å¿…éœ€å“ï¼Œä¹Ÿæ˜¯ä½œä¸ºæœåŠ¡è¿›è¡Œå¤–éƒ¨åŒ–å’Œæ¶ˆè´¹çš„ä¸»è¦å€™é€‰è€…ã€‚å› æ­¤ï¼Œå·¥ä½œæµç¼–æ’æ˜¯å½“ä»Šæœ€è‘—åçš„é›†æˆç»‘å®šç±»å‹ä¹‹ä¸€ã€‚è¯¥æœåŠ¡çš„å¸¸è§ç”¨é€”åŒ…æ‹¬ä¸ºæœåŠ¡å’Œä¸šåŠ¡æµç¨‹ç¼–æ’å®æ–½ Saga æ¨¡å¼ã€ä½¿ç”¨ AWS Step Functionsã€Google Stateful Functionsã€Azure Durable Functions è¿›è¡Œå‡½æ•°ç¼–æ’ã€ä½¿ç”¨ Google Workflow è¿›è¡Œä»»åŠ¡åˆ†é…ç­‰ç­‰ã€‚å½“ä½¿ç”¨è¿™æ ·çš„ç»‘å®šæ—¶ï¼Œéƒ¨åˆ†åº”ç”¨ç¨‹åºç¼–æ’çŠ¶æ€å’Œé€»è¾‘è¢«å¸è½½åˆ°å¦ä¸€ä¸ªæœåŠ¡ä¸­ã€‚è™½ç„¶åº”ç”¨ç¨‹åºæœåŠ¡å…·æœ‰å†…éƒ¨çŠ¶æ€å’Œç®¡ç†è¯¥çŠ¶æ€çš„é€»è¾‘ï¼Œä½†å…¶ä»–éƒ¨åˆ†æ˜¯å¤–éƒ¨çš„ï¼Œå¯èƒ½åœ¨å…¶ä»–ä¸€äº›äº‘æœåŠ¡ä¸­ã€‚è¿™ä»£è¡¨äº†å½“ä»Šåº”ç”¨ç¨‹åºä½œä¸ºä¸€ä¸ªç‹¬ç«‹çš„å•å…ƒè¿›è¡Œè®¾è®¡å’Œæ“ä½œçš„æ–¹å¼çš„è½¬å˜ã€‚æœªæ¥çš„åº”ç”¨ç¨‹åºä¸ä»…æ•°æ®æ˜¯å¤–éƒ¨çš„ï¼Œè€Œä¸”é›†æˆä¹Ÿå°†æ˜¯å¤–éƒ¨çš„ã€‚éšç€è¶Šæ¥è¶Šå¤šåœ°é‡‡ç”¨é›†æˆäº‘ï¼Œæ›´å¤šçš„é›†æˆæ•°æ®å’Œé€»è¾‘å°†å¼€å§‹å­˜åœ¨äºå¤–éƒ¨ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ—¶é—´è§¦å‘å™¨&#34;&gt;æ—¶é—´è§¦å‘å™¨&lt;/h3&gt;
&lt;p&gt;æ—¶é—´ç»‘å®šè¡¨ç¤ºç¼–æ’ç»‘å®šçš„æ—¶é—´é™åˆ¶ä¸“ä¸šåŒ–ã€‚å®ƒåªæœ‰ä¸€ä¸ªç›®æ ‡ï¼Œå³æ ¹æ®ç»™å®šçš„ç­–ç•¥åœ¨ç‰¹å®šæ—¶é—´è§¦å‘å„ç§æœåŠ¡ã€‚æ­¤ç±»åˆ«ä¸­çš„ç¤ºä¾‹åŒ…æ‹¬ AWS EventBridge Schedulerã€Google Cloud Schedulerã€Upstash Qstack æœåŠ¡ç­‰ã€‚&lt;/p&gt;
&lt;h3 id=&#34;äº‹ä»¶é©±åŠ¨å’Œæ¶ˆæ¯æœåŠ¡&#34;&gt;äº‹ä»¶é©±åŠ¨å’Œæ¶ˆæ¯æœåŠ¡&lt;/h3&gt;
&lt;p&gt;è¿™äº›ç»‘å®šå……å½“äº‹ä»¶å­˜å‚¨æ¥å¸è½½è¯·æ±‚å’Œè§£è€¦åº”ç”¨ç¨‹åºï¼Œä½†å®ƒä»¬è¶Šæ¥è¶Šä¸é™äºå­˜å‚¨å’Œæ‰©å±•ä»¥æä¾›æ¶ˆæ¯å¤„ç†æ¨¡å¼ã€‚å®ƒä»¬åœ¨äº‹ä»¶å­˜å‚¨ä¹‹ä¸Šæä¾›å¼€å‘è€…åŸè¯­ï¼Œä¾‹å¦‚æ­»ä¿¡é˜Ÿåˆ—ã€é‡è¯•ã€å»¶è¿Ÿä¼ é€’å’Œæ¶ˆæ¯å¤„ç†æ¨¡å¼ï¼Œä¾‹å¦‚è¿‡æ»¤ã€èšåˆã€é‡æ–°æ’åºã€åŸºäºå†…å®¹çš„è·¯ç”±ã€çªƒå¬ç­‰ã€‚è¿™ç§ç»‘å®šçš„ä¾‹å­æœ‰ Confluent Cloud kSQLã€AWS EventBridgeã€Decodable Data Pipeline ç­‰ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å¤–éƒ¨è¿æ¥å™¨&#34;&gt;å¤–éƒ¨è¿æ¥å™¨&lt;/h3&gt;
&lt;p&gt;è¿™äº›ç»‘å®šæœ‰åŠ©äºè¿æ¥åˆ°å¤–éƒ¨ç³»ç»Ÿã€‚å®ƒä»¬è¿˜æ‰§è¡Œæ•°æ®è§„èŒƒåŒ–ã€é”™è¯¯å¤„ç†ã€åè®®è½¬æ¢å’Œæ•°æ®è½¬æ¢ã€‚ç¤ºä¾‹åŒ…æ‹¬ Knative æºå¯¼å…¥å™¨ã€AWS EventBridge è¿æ¥å™¨ã€Confluent Cloud è¿æ¥å™¨ã€å¯è§£ç çš„ Kafka è¿æ¥å™¨ã€AWS Lambda æºå’Œç›®æ ‡ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å¥åº·æ£€æŸ¥-1&#34;&gt;å¥åº·æ£€æŸ¥&lt;/h3&gt;
&lt;p&gt;å¥åº·æ£€æŸ¥å¯¹äºè®¡ç®—è¿æ¥è‡³å…³é‡è¦ï¼Œå¤±è´¥çš„å¥åº·æ£€æŸ¥é€šå¸¸ä¼šå¯¼è‡´åº”ç”¨ç¨‹åºé‡å¯ã€‚é›†æˆç»‘å®šä¹Ÿéœ€è¦å¥åº·æ£€æŸ¥ï¼Œä½†ç›®çš„ä¸åŒï¼šé›†æˆå¥åº·æ£€æŸ¥ä¸ä¼šå½±å“åº”ç”¨ç¨‹åºçš„è¿è¡Œæ—¶ï¼Œä½†å®ƒä¼šå‘Šè¯‰é›†æˆäº‘åº”ç”¨ç¨‹åºæ˜¯å¦èƒ½å¤Ÿå¤„ç†é›†æˆé©±åŠ¨çš„äº¤äº’ã€‚å¤±è´¥çš„é›†æˆçŠ¶æ€æ£€æŸ¥ä¼šåœæ­¢é›†æˆç»‘å®šï¼Œç›´åˆ°åº”ç”¨ç¨‹åºè¿”å›æ­£å¸¸çŠ¶æ€å¹¶ä¸”é›†æˆç»‘å®šæ¢å¤ã€‚é€šå¸¸ï¼Œä½ å¯ä»¥ä½¿ç”¨ç›¸åŒçš„åº”ç”¨ç¨‹åºç«¯ç‚¹è¿›è¡Œè®¡ç®—å’Œé›†æˆç»‘å®šæµ‹è¯•ã€‚ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­æ˜¯ Dapr åº”ç”¨ç¨‹åº å¥åº·æ£€æŸ¥ï¼Œå®ƒå¯ä»¥æš‚æ—¶é˜»æ­¢æ¶ˆè´¹è€…å’Œè¿æ¥å™¨ã€‚å°†æ•°æ®æ’å…¥ä¸å¥åº·çš„åº”ç”¨ç¨‹åºã€‚&lt;/p&gt;
&lt;h3 id=&#34;å…¶ä»–ç»‘å®š&#34;&gt;å…¶ä»–ç»‘å®š&lt;/h3&gt;
&lt;p&gt;è¿˜æœ‰æ›´å¤šçš„ç»‘å®šï¼Œå±äºé›†æˆç»‘å®šçš„èŒƒç•´ã€‚ä¾‹å¦‚ï¼ŒKubernetes Downward API å’Œ Lambda ç¯å¢ƒå˜é‡ç­‰ä¸ºåº”ç”¨ç¨‹åºæä¾›å†…çœæ•°æ®ï¼Œå®ƒä¸ºåº”ç”¨ç¨‹åºè‡ªçœå’Œå…ƒæ•°æ®æ³¨å…¥æä¾›äº†ä¸€ç§ç®€å•çš„æœºåˆ¶ã€‚é…ç½®å’Œç§˜å¯†ç»‘å®šï¼Œå…¶ä¸­ç§˜å¯†ä¸ä»…åœ¨å¯åŠ¨æ—¶æ³¨å…¥åˆ°åº”ç”¨ç¨‹åºä¸­ï¼Œè€Œä¸”ä»»ä½•é…ç½®æ›´æ–°éƒ½é€šè¿‡ sidecars æ¨é€åˆ°åº”ç”¨ç¨‹åºï¼Œä¾‹å¦‚ Hashicorp Vault Sidecar Injector æˆ–è€… Dapr çš„ Configuration API, Kubernetes çš„ Service Binding è®¾ç½® è§„èŒƒã€‚å’Œä¸å¤ªå¸¸è§çš„æ¨¡å¼ï¼Œä¾‹å¦‚åˆ†å¸ƒå¼é”ï¼Œè¿™ä¹Ÿæ˜¯ä¸€ä¸ªé›†æˆç»‘å®šæä¾›å¯¹å…±äº«èµ„æºçš„äº’æ–¥è®¿é—®ã€‚&lt;/p&gt;
&lt;h3 id=&#34;é›†æˆç»‘å®šè¶‹åŠ¿&#34;&gt;é›†æˆç»‘å®šè¶‹åŠ¿&lt;/h3&gt;
&lt;p&gt;å®¹å™¨æ­£åœ¨æˆä¸ºæœ€æµè¡Œå’Œå¹¿æ³›ä½¿ç”¨çš„å¯ç§»æ¤æ ¼å¼ï¼Œç”¨äºæ‰“åŒ…å’Œè¿è¡Œåº”ç”¨ç¨‹åºï¼Œæ— è®ºå®ƒä»¬æ˜¯é•¿æœŸè¿è¡Œçš„å¾®æœåŠ¡è¿˜æ˜¯çŸ­æœŸåŠŸèƒ½ã€‚å¦ä¸€æ–¹é¢ï¼Œé›†æˆç»‘å®šå¯ä»¥åˆ†ä¸ºä¸åŒçš„é—®é¢˜åŸŸï¼Œä¾‹å¦‚äº‹ä»¶é©±åŠ¨çš„äº¤äº’ã€æœ‰çŠ¶æ€çš„ç¼–æ’å’ŒçŠ¶æ€è®¿é—®ï¼Œå¹¶ä¸”åœ¨åº•å±‚å­˜å‚¨å’Œä½¿ç”¨æ¨¡å¼æ–¹é¢æœ‰æ‰€ä¸åŒã€‚ä¾‹å¦‚ï¼ŒApache Kafka æ˜¯ äº‹å®ä¸Šçš„æ ‡å‡†ã€ç”¨äºæ–‡æ¡£è®¿é—®çš„ AWS S3 APIã€ç”¨äºé”®å€¼ç¼“å­˜çš„ Redisã€ç”¨äºå…³ç³»æ•°æ®è®¿é—®çš„ PostgreSQL ç­‰ç­‰ã€‚ä½¿å®ƒä»¬æˆä¸ºæ ‡å‡†çš„æ˜¯å›´ç»•å®ƒä»¬æ„å»ºçš„åº“ã€å·¥å…·å’ŒæœåŠ¡çš„ä¸æ–­å¢é•¿çš„ç”Ÿæ€ç³»ç»Ÿï¼Œä¸ºæˆç†Ÿåº¦ã€ç¨³å®šæ€§å’Œæœªæ¥çš„å‘åå…¼å®¹æ€§æä¾›äº†å¾ˆå¤§ç¨‹åº¦çš„ä¿è¯ã€‚ä½†è¿™äº› API æœ¬è´¨ä¸Šä»…é™äºå­˜å‚¨è®¿é—®ï¼Œå¹¶ä¸”é€šå¸¸éœ€è¦å¼€å‘äººå‘˜è§£å†³åº”ç”¨ç¨‹åºä»£ç ä¸­çš„åˆ†å¸ƒå¼ç³»ç»ŸæŒ‘æˆ˜ã€‚ä¸å †æ ˆä¸Šå±‚è½¯ä»¶çš„å•†å“åŒ–ä¸€è‡´ï¼Œé›†æˆç»‘å®šä½œä¸ºæœåŠ¡æä¾›ã€‚è¶Šæ¥è¶Šå¤šçš„æ— æœåŠ¡å™¨äº‘æœåŠ¡æä¾›äº†é¢å¤–çš„é›†æˆåŠŸèƒ½ï¼Œé™¤äº†æ•°æ®è®¿é—®ä¹‹å¤–ï¼Œåº”ç”¨ç¨‹åºä»£ç è¿˜å¯ä»¥ç»‘å®šè¿™äº›åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æ­¤æ¨¡å‹ä¸­ï¼Œäº‘ç»‘å®šåº”ç”¨ç¨‹åºé€šå¸¸åœ¨æ— æœåŠ¡å™¨è®¡ç®—åŸºç¡€è®¾æ–½ä¸Šè¿è¡Œï¼Œéµå¾ªäº‘åŸç”ŸåŸè¯­ã€‚å®ƒä¸å…¶ä»–æ— æœåŠ¡å™¨äº‘æœåŠ¡ç»‘å®šï¼Œç”¨äºæœåŠ¡ç¼–æ’ã€äº‹ä»¶å¤„ç†æˆ–åŒæ­¥äº¤äº’ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-6äº‘ç»‘å®šåº”ç”¨ç¨‹åºç”Ÿæ€ç³»ç»Ÿ&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 6ï¼šäº‘ç»‘å®šåº”ç”¨ç¨‹åºç”Ÿæ€ç³»ç»Ÿ&#34; srcset=&#34;
               /blog/cloud-bound-applications/6_hu76b96fdb2a4bf0da0f289f018df2de45_74762_00bb2daef51a9f499f02107b5b006301.webp 400w,
               /blog/cloud-bound-applications/6_hu76b96fdb2a4bf0da0f289f018df2de45_74762_2a597427cb8ea2d710a43b0d2a9fe03a.webp 760w,
               /blog/cloud-bound-applications/6_hu76b96fdb2a4bf0da0f289f018df2de45_74762_1200x1200_fit_q75_h2_lanczos_2.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/cloud-bound-applications/6_hu76b96fdb2a4bf0da0f289f018df2de45_74762_00bb2daef51a9f499f02107b5b006301.webp&#34;
               width=&#34;760&#34;
               height=&#34;638&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 6ï¼šäº‘ç»‘å®šåº”ç”¨ç¨‹åºç”Ÿæ€ç³»ç»Ÿ
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;CNCF çš„ Dapr æ˜¯ä¸€ä¸ªå°†å¤§éƒ¨åˆ†é›†æˆç»‘å®šå’Œå¼€å‘äººå‘˜å…³æ³¨ç‚¹æ•´åˆåˆ°ä¸€ä¸ªå¼€æº API ä¸­çš„é¡¹ç›®ã€‚å®ƒæä¾›åŒæ­¥æœåŠ¡è°ƒç”¨ã€æœ‰çŠ¶æ€æœåŠ¡ç¼–æ’ã€å¼‚æ­¥äº‹ä»¶é©±åŠ¨äº¤äº’å’Œç‰¹å®šæŠ€æœ¯è¿æ¥å™¨ä½œä¸º APIã€‚ç±»ä¼¼äºå®¹å™¨å’Œ Kubernetes å¦‚ä½•å……å½“è®¡ç®—æŠ½è±¡ï¼ŒDapr å……å½“å¤–éƒ¨æœåŠ¡çš„æŠ½è±¡ã€‚Dapr è¿˜æä¾›äº†ç‹¬ç«‹äºåº•å±‚äº‘æœåŠ¡ä¸”å¾€å¾€å¿…é¡»åœ¨åº”ç”¨å±‚å®ç°çš„é›†æˆèƒ½åŠ›ï¼Œä¾‹å¦‚å¼¹æ€§ç­–ç•¥ã€æ­»ä¿¡é˜Ÿåˆ—ã€ å»¶è¿Ÿäº¤ä»˜ã€è·Ÿè¸ªã€ç»†ç²’åº¦æˆæƒç­‰ã€‚Dapr è¢«è®¾è®¡ä¸ºå¤šè¯­è¨€å¹¶åœ¨åº”ç”¨ç¨‹åºå¤–éƒ¨è¿è¡Œï¼Œä»è€Œå¯ä»¥è½»æ¾äº¤æ¢å¤–éƒ¨ä¾èµ–é¡¹è€Œæ— éœ€æ›´æ”¹åº”ç”¨ç¨‹åºçš„å†…éƒ¨æ¶æ„ï¼Œå¦‚ Hexagon Architecture ä¸­æ‰€è¿°ã€‚è™½ç„¶ Dapr ä¸»è¦ç”±å®æ–½åº”ç”¨ç¨‹åºçš„å¼€å‘äººå‘˜ä½¿ç”¨ï¼Œä½†ä¸€æ—¦å¼•å…¥ï¼ŒDapr å°±ä¼šå¢å¼ºåˆ†å¸ƒå¼åº”ç”¨ç¨‹åºçš„å¯é æ€§å’Œå¯è§æ€§ï¼Œä¸ºè¿è¥å’Œæ¶æ„å¸ˆå›¢é˜Ÿæä¾› æ•´ä½“åˆ©ç›Šã€‚è¦äº†è§£æœ‰å…³æ­¤ä¸»é¢˜çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·åœ¨ä»Šå¹´æ™šäº›æ—¶å€™äº²è‡ªæˆ–ä»¥è™šæ‹Ÿæ–¹å¼å‚åŠ  QConLondonï¼Œæˆ‘å°†åœ¨é‚£é‡Œè®¨è®ºâ€œåº”ç”¨ç¨‹åºä¼˜å…ˆçš„äº‘æœåŠ¡å¦‚ä½•æ”¹å˜æ¸¸æˆè§„åˆ™â€ã€‚&lt;/p&gt;
&lt;h2 id=&#34;åäº‘åŸç”Ÿåº”ç”¨&#34;&gt;åäº‘åŸç”Ÿåº”ç”¨&lt;/h2&gt;
&lt;p&gt;äº‘ç»‘å®šåº”ç”¨ä»£è¡¨äº†äº‘åŸç”Ÿçš„è¿›æ­¥ï¼Œä»åªè§£å†³è®¡ç®—é—®é¢˜åˆ°ç®¡ç†åº”ç”¨å±‚éœ€æ±‚ã€‚åº”ç”¨ç¨‹åºå †æ ˆä¸­çš„äº‘æœåŠ¡ä»åŸºç¡€è®¾æ–½æ‰©å±•åˆ°åº”ç”¨ç¨‹åºä¼˜å…ˆæœåŠ¡ï¼ŒåŠ é€Ÿäº†è¿™ä¸€è¶‹åŠ¿ã€‚æˆ‘ä»¬å¯ä»¥åœ¨ä»¥å¼€å‘äººå‘˜ä¸ºä¸­å¿ƒçš„äº‘æœåŠ¡çš„çˆ†ç‚¸å¼å¢é•¿ä¸­è§‚å¯Ÿåˆ°è¿™ç§è½¬å˜ï¼ŒåŒ…æ‹¬çŠ¶æ€åè°ƒã€äº‹ä»¶é©±åŠ¨çš„åº”ç”¨ç¨‹åºåŸºç¡€æ¶æ„ã€åŒæ­¥äº¤äº’ã€åŸºäºäº‘çš„å¼€å‘å’Œæµ‹è¯•ç¯å¢ƒä»¥åŠæ— æœåŠ¡è¿è¡Œæ—¶ã€‚è¿™ç§å‘åº”ç”¨ç¨‹åºä¼˜å…ˆçš„äº‘æœåŠ¡çš„è½¬å˜æ­£åœ¨äº§ç”Ÿä¸€ç§æ–°çš„åº”ç”¨ç¨‹åºæ¶æ„ï¼Œè¶Šæ¥è¶Šå¤šçš„åº”ç”¨ç¨‹åºé€»è¾‘åœ¨äº‘æœåŠ¡ä¸­è¿è¡Œã€‚åº”ç”¨ç¨‹åºä¸ç¬¬ä¸‰æ–¹äº‘æœåŠ¡çš„è¿™ç§æ··åˆå…è®¸å¼€å‘äººå‘˜åˆ†æ‹…æ›´å¤šè´£ä»»ï¼Œä½†æ˜¯ï¼Œå®ƒå¯èƒ½ä¼šé™åˆ¶ä¸æ–­å˜åŒ–çš„ä¸šåŠ¡éœ€æ±‚æ‰€éœ€çš„çµæ´»æ€§å’Œæ•æ·æ€§ã€‚ä¸ºäº†ä¿æŒåº”ç”¨ç¨‹åºçš„å†…éƒ¨å’Œå¤–éƒ¨æ¶æ„ç‹¬ç«‹ï¼Œåº”ç”¨ç¨‹åºå’Œäº‘æœåŠ¡éœ€è¦åœ¨å¼€å‘æ—¶é€šè¿‡æ¸…æ™°çš„è¾¹ç•Œè§£è€¦ï¼Œå¹¶åœ¨è¿è¡Œæ—¶ä½¿ç”¨å®šä¹‰è‰¯å¥½çš„å¼€æ”¾ API å’Œæ ¼å¼è¿›è¡Œæ·±åº¦ç»‘å®šã€‚æ­£å¦‚å®¹å™¨å’Œ Kubernetes ä¸ºè®¡ç®—æä¾›äº†å¼€æ”¾çš„ APIï¼Œæˆ‘ä»¬éœ€è¦ä¸ºåº”ç”¨ç¨‹åºé›†æˆæŠ½è±¡æä¾›å¼€æ”¾çš„ APIã€‚è¿™å°†ä½¿æ“ä½œå®è·µå’Œå·¥å…·ä»¥åŠå¼€å‘æ¨¡å¼ã€åŠŸèƒ½å’Œå®è·µçš„å¯ç§»æ¤æ€§å’Œé‡ç”¨æˆä¸ºå¯èƒ½ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Istio Ambient Mesh ä¸­åŸºäº Rust çš„ Ztunnel ç»„ä»¶ä»‹ç»</title>
      <link>https://lib.jimmysong.io/blog/rust-based-ztunnel/</link>
      <pubDate>Tue, 07 Mar 2023 19:00:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/rust-based-ztunnel/</guid>
      <description>&lt;blockquote&gt;
&lt;p&gt;è¯‘è€…æ³¨ï¼šè¿™ç¯‡æ–‡ç« ä»‹ç»äº† Istio çš„ Rust-Based Ztunnelï¼Œå®ƒæ˜¯ä¸€ç§åŸºäº Rust è¯­è¨€çš„è½»é‡çº§ä»£ç†ï¼Œç”¨äº Istio çš„ ambient meshã€‚åœ¨æ–‡ç« ä¸­ï¼Œä½œè€…è§£é‡Šäº†ä¸ºä»€ä¹ˆéœ€è¦ä¸€ç§æ–°çš„ä»£ç†ï¼Œä»¥åŠ Rust è¯­è¨€æ˜¯å¦‚ä½•æˆä¸ºæœ€ä½³é€‰æ‹©çš„ã€‚æ–‡ç« è¿˜è®¨è®ºäº†å¦‚ä½•ä½¿ç”¨ workload xDS é…ç½®æ¥ç®¡ç†å·¥ä½œè´Ÿè½½ï¼Œä»¥åŠå¦‚ä½•æŸ¥çœ‹ ztunnel æ—¥å¿—å’Œ L4 æŒ‡æ ‡ã€‚ä½œè€…è¡¨ç¤ºï¼ŒRust-Based Ztunnel æ˜¾è‘—ç®€åŒ–äº† Istio çš„ ambient meshï¼Œå¹¶æé«˜äº†æ€§èƒ½ã€‚æ­¤å¤–ï¼ŒIstio ambient mesh å·²ç»åˆå¹¶åˆ°äº†ä¸Šæ¸¸ä¸»å¹²ï¼Œå¯ä»¥é€šè¿‡éµå¾ªå…¥é—¨æŒ‡å—æ¥å°è¯• Rust-Based Ztunnelã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Ztunnelï¼ˆé›¶ä¿¡ä»»éš§é“ï¼‰ç»„ä»¶æ˜¯ä¸º Istio Ambient Mesh ä¸“é—¨æ„å»ºçš„æ¯èŠ‚ç‚¹ä»£ç†ã€‚å®ƒè´Ÿè´£å®‰å…¨åœ°è¿æ¥å’ŒéªŒè¯ Ambient Mesh ä¸­çš„å·¥ä½œè´Ÿè½½ã€‚Ztunnel æ—¨åœ¨ä¸“æ³¨äº Ambient Mesh ä¸­å·¥ä½œè´Ÿè½½çš„ä¸€å°ç»„åŠŸèƒ½ï¼Œä¾‹å¦‚ mTLSã€èº«ä»½éªŒè¯ã€L4 æˆæƒå’Œé¥æµ‹ï¼Œè€Œæ— éœ€ç»ˆæ­¢å·¥ä½œè´Ÿè½½ HTTP æµé‡æˆ–è§£æå·¥ä½œè´Ÿè½½ HTTP æ ‡å¤´ã€‚Ztunnel ç¡®ä¿æµé‡é«˜æ•ˆã€å®‰å…¨åœ°ä¼ è¾“åˆ° Waypoint Proxyï¼ŒIstio çš„å…¨å¥—åŠŸèƒ½ï¼ˆå¦‚ HTTP é¥æµ‹å’Œè´Ÿè½½å¹³è¡¡ï¼‰åœ¨è¿™é‡Œå®ç°ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äº ztunnel è®¾è®¡ä¸ºåœ¨æ‰€æœ‰ Kubernetes å·¥ä½œèŠ‚ç‚¹ä¸Šè¿è¡Œï¼Œå› æ­¤ä¿æŒå…¶èµ„æºè¶³è¿¹è¾ƒå°è‡³å…³é‡è¦ã€‚Ztunnel è¢«è®¾è®¡ä¸ºæœåŠ¡ç½‘æ ¼çš„ä¸å¯è§ï¼ˆæˆ–â€œAmbientâ€ï¼‰éƒ¨åˆ†ï¼Œå¯¹ä½ çš„å·¥ä½œè´Ÿè½½çš„å½±å“æœ€å°ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ztunnel-æ¶æ„&#34;&gt;Ztunnel æ¶æ„&lt;/h2&gt;
&lt;p&gt;ä¸ sidecar ç±»ä¼¼ï¼Œztunnel ä¹Ÿå……å½“ xDS å®¢æˆ·ç«¯å’Œ CA å®¢æˆ·ç«¯ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åœ¨å¯åŠ¨æœŸé—´ï¼Œå®ƒä½¿ç”¨å…¶æœåŠ¡å¸æˆ·ä»¤ç‰Œå®‰å…¨åœ°è¿æ¥åˆ° Istiod æ§åˆ¶å¹³é¢ã€‚ä¸€æ—¦ä½¿ç”¨ TLS å®‰å…¨åœ°å»ºç«‹äº†ä» ztunnel åˆ° Istiod çš„è¿æ¥ï¼Œå®ƒå°±ä¼šå¼€å§‹ä½œä¸º xDS å®¢æˆ·ç«¯è·å– xDS é…ç½®ã€‚è¿™ç±»ä¼¼äº sidecarã€ç½‘å…³æˆ–è·¯ç‚¹ä»£ç†çš„å·¥ä½œæ–¹å¼ï¼Œä¸åŒä¹‹å¤„åœ¨äº Istiod è¯†åˆ«æ¥è‡ª ztunnel çš„è¯·æ±‚å¹¶å‘é€ä¸“ä¸º ztunnel æ„å»ºçš„ xDS é…ç½®ï¼Œç¨åä½ å°†äº†è§£æ›´å¤šä¿¡æ¯ã€‚&lt;/li&gt;
&lt;li&gt;å®ƒè¿˜å……å½“ CA å®¢æˆ·ç«¯ï¼Œä»£è¡¨å…¶ç®¡ç†çš„æ‰€æœ‰å¹¶ç½®å·¥ä½œè´Ÿè½½ç®¡ç†å’Œæä¾› mTLS è¯ä¹¦ã€‚&lt;/li&gt;
&lt;li&gt;å½“æµé‡ä¼ å…¥æˆ–ä¼ å‡ºæ—¶ï¼Œå®ƒå……å½“æ ¸å¿ƒä»£ç†ï¼Œä¸ºå…¶ç®¡ç†çš„æ‰€æœ‰å¹¶ç½®å·¥ä½œè´Ÿè½½å¤„ç†å…¥ç«™å’Œå‡ºç«™æµé‡ï¼ˆçº¯æ–‡æœ¬ç½‘æ ¼å¤–æˆ– HBONE ç½‘æ ¼å†…ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å®ƒæä¾› L4 é¥æµ‹ï¼ˆæŒ‡æ ‡å’Œæ—¥å¿—ï¼‰å’Œå¸¦æœ‰è°ƒè¯•ä¿¡æ¯çš„ç®¡ç†æœåŠ¡å™¨ï¼Œä»¥å¸®åŠ©ä½ åœ¨éœ€è¦æ—¶è°ƒè¯• ztunnelã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-ztunnel-æ¶æ„&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Ztunnel æ¶æ„&#34; srcset=&#34;
               /blog/rust-based-ztunnel/ztunnel-architecture_hu387b4c2a03db2e99be5472bd5e891d78_255209_797ecbd0898a98a7a4efaf3613b9a9a1.webp 400w,
               /blog/rust-based-ztunnel/ztunnel-architecture_hu387b4c2a03db2e99be5472bd5e891d78_255209_9e1db5b9ceb47b1ca2ae39840c891e4d.webp 760w,
               /blog/rust-based-ztunnel/ztunnel-architecture_hu387b4c2a03db2e99be5472bd5e891d78_255209_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/rust-based-ztunnel/ztunnel-architecture_hu387b4c2a03db2e99be5472bd5e891d78_255209_797ecbd0898a98a7a4efaf3613b9a9a1.webp&#34;
               width=&#34;760&#34;
               height=&#34;515&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      Ztunnel æ¶æ„
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h2 id=&#34;ä¸ºä»€ä¹ˆä¸é‡ç”¨-envoy&#34;&gt;ä¸ºä»€ä¹ˆä¸é‡ç”¨ Envoyï¼Ÿ&lt;/h2&gt;
&lt;p&gt;å½“ Istio Ambient Mesh äº 2022 å¹´ 9 æœˆ 7 æ—¥å‘å¸ƒæ—¶ï¼Œztunnel æ˜¯ä½¿ç”¨ Envoy ä»£ç†å®ç°çš„ã€‚é‰´äºæˆ‘ä»¬å°† Envoy ç”¨äº Istio çš„å…¶ä½™éƒ¨åˆ†â€”â€”sidecarã€ç½‘å…³å’Œ Waypoint Proxyâ€”â€”æˆ‘ä»¬å¼€å§‹ä½¿ç”¨ Envoy å®æ–½ ztunnel æ˜¯å¾ˆè‡ªç„¶çš„é€‰æ‹©ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶è€Œï¼Œæˆ‘ä»¬å‘ç°è™½ç„¶ Envoy éå¸¸é€‚åˆå…¶ä»–ç”¨ä¾‹ï¼Œä½†åœ¨ Envoy ä¸­å®ç° ztunnel å…·æœ‰æŒ‘æˆ˜æ€§ï¼Œå› ä¸ºè®¸å¤šæƒè¡¡ã€è¦æ±‚å’Œç”¨ä¾‹ä¸ sidecar ä»£ç†æˆ–å…¥å£ç½‘å…³æœ‰å¾ˆå¤§ä¸åŒã€‚æ­¤å¤–ï¼Œå¤§å¤šæ•°ä½¿ Envoy éå¸¸é€‚åˆå…¶ä»–ç”¨ä¾‹çš„ä¸œè¥¿ï¼Œä¾‹å¦‚å…¶ä¸°å¯Œçš„ L7 åŠŸèƒ½é›†å’Œå¯æ‰©å±•æ€§ï¼Œéƒ½æµªè´¹åœ¨ä¸éœ€è¦è¿™äº›åŠŸèƒ½çš„ ztunnel ä¸­ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä¸“é—¨æ„å»ºçš„-ztunnel&#34;&gt;ä¸“é—¨æ„å»ºçš„ ztunnel&lt;/h2&gt;
&lt;p&gt;åœ¨ Envoy å› æˆ‘ä»¬çš„éœ€æ±‚è€Œå¤±è´¥åï¼Œæˆ‘ä»¬å¼€å§‹è€ƒè™‘æ„å»º ztunnel çš„ä¸“ç”¨å®ç°ã€‚æˆ‘ä»¬çš„å‡è®¾æ˜¯ï¼Œé€šè¿‡ä»ä¸€å¼€å§‹å°±è€ƒè™‘ä¸€ä¸ªå•ä¸€çš„é‡ç‚¹ç”¨ä¾‹è¿›è¡Œè®¾è®¡ï¼Œæˆ‘ä»¬å¯ä»¥å¼€å‘ä¸€ä¸ªæ¯”å°†é€šç”¨é¡¹ç›®å¡‘é€ æˆè‡ªå®šä¹‰ç”¨ä¾‹æ›´ç®€å•ã€æ€§èƒ½æ›´é«˜çš„è§£å†³æ–¹æ¡ˆã€‚ä½¿ ztunnel ç®€å•åŒ–çš„æ˜ç¡®å†³å®šæ˜¯è¿™ä¸€å‡è®¾çš„å…³é”®ï¼› ä¾‹å¦‚ï¼Œç±»ä¼¼çš„é€»è¾‘ä¸é€‚ç”¨äºå…·æœ‰å¤§é‡æ”¯æŒåŠŸèƒ½å’Œé›†æˆçš„é‡å†™ç½‘å…³ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªä¸“é—¨å»ºé€ çš„ ztunnel æ¶‰åŠä¸¤ä¸ªå…³é”®é¢†åŸŸï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ztunnel ä¸å…¶ Istiod ä¹‹é—´çš„é…ç½®åè®®&lt;/li&gt;
&lt;li&gt;ztunnel çš„è¿è¡Œæ—¶å®ç°&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;é…ç½®åè®®&#34;&gt;é…ç½®åè®®&lt;/h3&gt;
&lt;p&gt;Envoy ä»£ç†ä½¿ç”¨ &lt;a href=&#34;https://www.envoyproxy.io/docs/envoy/latest/api-docs/xds_protocol&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;xDS åè®®&lt;/a&gt; é…ç½®ã€‚è¿™æ˜¯ä½¿ Istio è‰¯å¥½è¿è¡Œçš„å…³é”®éƒ¨åˆ†ï¼Œæä¾›ä¸°å¯Œä¸”åŠ¨æ€çš„é…ç½®æ›´æ–°ã€‚ç„¶è€Œï¼Œéšç€è§„æ¨¡çš„æ‰©å¤§ï¼Œé…ç½®å˜å¾—è¶Šæ¥è¶Šå®šåˆ¶åŒ–ï¼Œè¿™æ„å‘³ç€ç”Ÿæˆå®ƒæ›´å¤§ã€æ›´æ˜‚è´µã€‚åœ¨ sidecar ä¸­ï¼Œå…·æœ‰ 1 ä¸ª pod çš„å•ä¸ªæœåŠ¡ä¼šç”Ÿæˆå¤§çº¦ 350 è¡Œ xDSï¼ˆåœ¨ YAML ä¸­ï¼‰ï¼Œè¿™å·²ç»å¾ˆéš¾æ‰©å±•ã€‚åŸºäº Envoy çš„ ztunnel ç”šè‡³æ›´ç³Ÿï¼Œå¹¶ä¸”åœ¨æŸäº›åŒºåŸŸå…·æœ‰ N^2 ç¼©æ”¾å±æ€§ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†ä½¿ ztunnel é…ç½®å°½å¯èƒ½å°ï¼Œæˆ‘ä»¬ç ”ç©¶äº†ä½¿ç”¨ä¸€ç§ä¸“é—¨æ„å»ºçš„é…ç½®åè®®ï¼Œè¯¥åè®®ä»¥ä¸€ç§æœ‰æ•ˆçš„æ ¼å¼å‡†ç¡®åŒ…å«æˆ‘ä»¬éœ€è¦çš„ä¿¡æ¯ï¼ˆä»…æ­¤è€Œå·²ï¼‰ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ç®€æ´åœ°è¡¨ç¤ºå•ä¸ª podï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;helloworld-v1-55446d46d8-ntdbk&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;default&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;serviceAccount&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;helloworld&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;node&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;ambient-worker2&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;protocol&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;TCP&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;status&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Healthy&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;waypointAddresses&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;workloadIp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;10.244.2.8&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;canonicalName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;helloworld&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;canonicalRevision&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;v1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;workloadName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;helloworld-v1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;workloadType&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;deployment&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ­¤ä¿¡æ¯é€šè¿‡ xDS ä¼ è¾“ API ä¼ è¾“ï¼Œä½†ä½¿ç”¨ç‰¹å®šäºç¯å¢ƒçš„è‡ªå®šä¹‰ç±»å‹ã€‚è¯·å‚é˜…&lt;a href=&#34;https://preliminary.istio.io/latest/blog/2023/rust-based-ztunnel/#workload-xds-configuration&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å·¥ä½œè´Ÿè½½ xDS é…ç½®éƒ¨åˆ†&lt;/a&gt; ä»¥äº†è§£æœ‰å…³é…ç½®è¯¦ç»†ä¿¡æ¯çš„æ›´å¤šä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ä¸“é—¨æ„å»ºçš„ APIï¼Œæˆ‘ä»¬å¯ä»¥å°†é€»è¾‘æ¨é€åˆ°ä»£ç†ä¸­ï¼Œè€Œä¸æ˜¯åœ¨ Envoy é…ç½®ä¸­ã€‚ä¾‹å¦‚ï¼Œè¦åœ¨ Envoy ä¸­é…ç½® mTLSï¼Œæˆ‘ä»¬éœ€è¦æ·»åŠ ç›¸åŒçš„å¤§å‹é…ç½®é›†æ¥è°ƒæ•´æ¯ä¸ªæœåŠ¡çš„ç²¾ç¡® TLS è®¾ç½®ï¼› ä½¿ç”¨ ztunnelï¼Œæˆ‘ä»¬åªéœ€è¦ä¸€ä¸ªæšä¸¾æ¥å£°æ˜æ˜¯å¦åº”è¯¥ä½¿ç”¨ mTLSã€‚å…¶ä½™çš„å¤æ‚é€»è¾‘ç›´æ¥åµŒå…¥åˆ° ztunnel ä»£ç ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;å€ŸåŠ© Istiod å’Œ ztunnel ä¹‹é—´çš„è¿™ç§é«˜æ•ˆ APIï¼Œæˆ‘ä»¬å‘ç°æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æœ‰å…³å¤§å‹ç½‘æ ¼ï¼ˆä¾‹å¦‚å…·æœ‰ 100,000 ä¸ª pod çš„ç½‘æ ¼ï¼‰çš„ä¿¡æ¯æ¥é…ç½® ztunnelï¼Œé…ç½®æ•°é‡å‡å°‘å‡ ä¸ªæ•°é‡çº§ï¼Œè¿™æ„å‘³ç€ CPUã€å†…å­˜å’Œç½‘ç»œæˆæœ¬æ›´ä½ã€‚&lt;/p&gt;
&lt;h3 id=&#34;è¿è¡Œæ—¶å®ç°&#34;&gt;è¿è¡Œæ—¶å®ç°&lt;/h3&gt;
&lt;p&gt;é¡¾åæ€ä¹‰ï¼Œztunnel ä½¿ç”¨ &lt;a href=&#34;https://preliminary.istio.io/latest/blog/2022/introducing-ambient-mesh/#building-an-ambient-mesh&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;HTTPS éš§é“&lt;/a&gt; æ‰¿è½½ç”¨æˆ·è¯·æ±‚ã€‚è™½ç„¶ Envoy æ”¯æŒè¿™ç§éš§é“ï¼Œä½†æˆ‘ä»¬å‘ç°é…ç½®æ¨¡å‹é™åˆ¶äº†æˆ‘ä»¬çš„éœ€æ±‚ã€‚ç®€å•åœ°è¯´ï¼ŒEnvoy çš„å·¥ä½œæ–¹å¼æ˜¯é€šè¿‡ä¸€ç³»åˆ—â€œè¿‡æ»¤å™¨â€å‘é€è¯·æ±‚ï¼Œä»æ¥å—è¯·æ±‚å¼€å§‹åˆ°å‘é€ç»“æŸã€‚æ ¹æ®æˆ‘ä»¬çš„è¦æ±‚ï¼Œå®ƒæœ‰å¤šå±‚è¯·æ±‚ï¼ˆéš§é“æœ¬èº«å’Œç”¨æˆ·çš„è¯·æ±‚ï¼‰ï¼Œä»¥åŠè´Ÿè½½å‡è¡¡åéœ€è¦åº”ç”¨ per-pod ç­–ç•¥ï¼Œæˆ‘ä»¬å‘ç°æ¯ä¸ªè¿æ¥éœ€è¦å¾ªç¯é€šè¿‡è¿™äº›è¿‡æ»¤å™¨ 4 æ¬¡æ‰èƒ½å®ç°æˆ‘ä»¬çš„åŸºäºåœ¨ Envoy ä¸Šå½“ ztunnelã€‚è™½ç„¶ Envoy å¯¹å†…å­˜ä¸­çš„â€œå‘è‡ªèº«å‘é€è¯·æ±‚â€è¿›è¡Œäº† &lt;a href=&#34;https://www.envoyproxy.io/docs/envoy/latest/configuration/other_features/internal_listener&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä¸€äº›ä¼˜åŒ– &lt;/a&gt;ï¼Œä½†è¿™ä»ç„¶éå¸¸å¤æ‚ä¸”æ˜‚è´µã€‚&lt;/p&gt;
&lt;p&gt;é€šè¿‡æ„å»ºæˆ‘ä»¬è‡ªå·±çš„å®ç°ï¼Œæˆ‘ä»¬å¯ä»¥ä»å¤´å¼€å§‹å›´ç»•è¿™äº›çº¦æŸè¿›è¡Œè®¾è®¡ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬åœ¨è®¾è®¡çš„å„ä¸ªæ–¹é¢éƒ½æœ‰æ›´å¤§çš„çµæ´»æ€§ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©è·¨çº¿ç¨‹å…±äº«è¿æ¥æˆ–å›´ç»•æœåŠ¡è´¦æˆ·ä¹‹é—´çš„éš”ç¦»å®ç°æ›´å¤šè‡ªå®šä¹‰éœ€æ±‚ã€‚åœ¨ç¡®å®šä¸“ç”¨ä»£ç†å¯è¡Œåï¼Œæˆ‘ä»¬å¼€å§‹é€‰æ‹©å®ç°ç»†èŠ‚ã€‚&lt;/p&gt;
&lt;h4 id=&#34;åŸºäº-rust-çš„-ztunnel&#34;&gt;åŸºäº Rust çš„ ztunnel&lt;/h4&gt;
&lt;p&gt;ä¸ºäº†ä½¿ ztunnel å¿«é€Ÿã€å®‰å…¨å’Œè½»é‡çº§ï¼Œ&lt;a href=&#34;https://www.rust-lang.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Rust&lt;/a&gt; æ˜¯ä¸€ä¸ªæ˜¾è€Œæ˜“è§çš„é€‰æ‹©ã€‚ç„¶è€Œï¼Œè¿™ä¸æ˜¯æˆ‘ä»¬ç¬¬ä¸€æ¬¡ã€‚é‰´äº Istio ç›®å‰å¯¹ Go çš„å¹¿æ³›ä½¿ç”¨ï¼Œæˆ‘ä»¬æ›¾å¸Œæœ›æˆ‘ä»¬å¯ä»¥ä½¿åŸºäº Go çš„å®ç°æ»¡è¶³è¿™äº›ç›®æ ‡ã€‚åœ¨æœ€åˆçš„åŸå‹ä¸­ï¼Œæˆ‘ä»¬æ„å»ºäº†ä¸€äº›åŸºäº Go çš„å®ç°å’Œä¸€ä¸ªç®€å•ç‰ˆæœ¬çš„åŸºäº Rust çš„å®ç°ã€‚ä»æˆ‘ä»¬çš„æµ‹è¯•ä¸­ï¼Œæˆ‘ä»¬å‘ç°åŸºäº Go çš„ç‰ˆæœ¬ä¸æ»¡è¶³æˆ‘ä»¬çš„æ€§èƒ½å’Œå ç”¨ç©ºé—´è¦æ±‚ã€‚è™½ç„¶æˆ‘ä»¬å¯èƒ½ä¼šè¿›ä¸€æ­¥ä¼˜åŒ–å®ƒï¼Œä½†æˆ‘ä»¬è®¤ä¸ºåŸºäº Rust çš„ä»£ç†ä»é•¿è¿œæ¥çœ‹å°†ä¸ºæˆ‘ä»¬æä¾›æœ€ä½³å®ç°ã€‚&lt;/p&gt;
&lt;p&gt;è¿˜è€ƒè™‘äº† C++ å®ç°â€”â€”å¯èƒ½ä¼šé‡ç”¨ Envoy çš„éƒ¨åˆ†å†…å®¹ã€‚ä½†æ˜¯ï¼Œç”±äºç¼ºä¹å†…å­˜å®‰å…¨ã€å¼€å‘äººå‘˜ä½“éªŒé—®é¢˜ä»¥åŠ Rust çš„ä¸€èˆ¬è¡Œä¸šè¶‹åŠ¿ï¼Œæ­¤é€‰é¡¹æœªè¢«é‡‡ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªæ·˜æ±°è¿‡ç¨‹ç»™æˆ‘ä»¬ç•™ä¸‹äº† Rustï¼Œè¿™æ˜¯ä¸€ä¸ªå®Œç¾çš„é€‰æ‹©ã€‚Rust åœ¨é«˜æ€§èƒ½ã€ä½èµ„æºåˆ©ç”¨ç‡çš„åº”ç”¨ç¨‹åºæ–¹é¢æœ‰ç€æ‚ ä¹…çš„æˆåŠŸå†å²ï¼Œå°¤å…¶æ˜¯ç½‘ç»œåº”ç”¨ç¨‹åºï¼ŒåŒ…æ‹¬æœåŠ¡ç½‘æ ¼ã€‚æˆ‘ä»¬é€‰æ‹©åœ¨ &lt;a href=&#34;https://tokio.rs/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tokio&lt;/a&gt; å’Œ &lt;a href=&#34;https://hyper.rs/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Hyper&lt;/a&gt; åº“ä¹‹ä¸Šæ„å»ºï¼Œè¿™ä¸¤ä¸ªç”Ÿæ€ç³»ç»Ÿä¸­çš„äº‹å®æ ‡å‡†å·²ç»ç»å†äº†å¹¿æ³›çš„éªŒè¯â€”â€”ç»è¿‡æµ‹è¯•ä¸”æ˜“äºç¼–å†™é«˜æ€§èƒ½å¼‚æ­¥ä»£ç ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å¿«é€Ÿäº†è§£åŸºäº-rust-çš„-ztunnel&#34;&gt;å¿«é€Ÿäº†è§£åŸºäº Rust çš„ ztunnel&lt;/h2&gt;
&lt;h3 id=&#34;å·¥ä½œè´Ÿè½½-xds-é…ç½®&#34;&gt;å·¥ä½œè´Ÿè½½ xDS é…ç½®&lt;/h3&gt;
&lt;p&gt;å·¥ä½œè´Ÿè½½ xDS é…ç½®éå¸¸æ˜“äºç†è§£å’Œè°ƒè¯•ã€‚ä½ å¯ä»¥é€šè¿‡ä»ä½ çš„ä¸€ä¸ª ztunnel pod å‘é€è¯·æ±‚ &lt;code&gt;localhost:15000/config_dump&lt;/code&gt; æˆ–ä½¿ç”¨æ–¹ä¾¿çš„ &lt;code&gt;istioctl pc workload&lt;/code&gt; å‘½ä»¤æ¥æŸ¥çœ‹å®ƒä»¬ã€‚æœ‰ä¸¤ä¸ªå…³é”®çš„å·¥ä½œè´Ÿè½½ xDS é…ç½®ï¼šå·¥ä½œè´Ÿè½½å’Œç­–ç•¥ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ä½ çš„å·¥ä½œè´Ÿè½½åŒ…å«åœ¨ Ambient Mesh ä¸­ä¹‹å‰ï¼Œä½ ä»ç„¶å¯ä»¥åœ¨ ztunnel çš„é…ç½®è½¬å‚¨ä¸­çœ‹åˆ°å®ƒä»¬ï¼Œå› ä¸º ztunnel çŸ¥é“æ‰€æœ‰å·¥ä½œè´Ÿè½½ï¼Œæ— è®ºå®ƒä»¬æ˜¯å¦å¯ç”¨äº† Ambient Meshã€‚ä¾‹å¦‚ï¼Œä»¥ä¸‹åŒ…å«æ–°éƒ¨ç½²çš„ helloworld v1 pod çš„ç¤ºä¾‹å·¥ä½œè´Ÿè½½é…ç½®ï¼Œç”± &lt;code&gt;protocol: TCP&lt;/code&gt; æŒ‡ç¤ºï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nt&#34;&gt;&amp;#34;workloads&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nt&#34;&gt;&amp;#34;10.244.2.8&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;nt&#34;&gt;&amp;#34;workloadIp&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;10.244.2.8&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;nt&#34;&gt;&amp;#34;protocol&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;TCP&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;nt&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;helloworld-v1-cross-node-55446d46d8-ntdbk&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;nt&#34;&gt;&amp;#34;namespace&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;default&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;nt&#34;&gt;&amp;#34;serviceAccount&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;helloworld&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;nt&#34;&gt;&amp;#34;workloadName&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;helloworld-v1-cross-node&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;nt&#34;&gt;&amp;#34;workloadType&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;deployment&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;nt&#34;&gt;&amp;#34;canonicalName&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;helloworld&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;nt&#34;&gt;&amp;#34;canonicalRevision&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;v1&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;nt&#34;&gt;&amp;#34;node&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;ambient-worker2&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;nt&#34;&gt;&amp;#34;authorizationPolicies&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[],&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;nt&#34;&gt;&amp;#34;status&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Healthy&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Pod è¢«åŒ…å«åœ¨ ambient ä¸­åï¼ˆé»˜è®¤å°†å‘½åç©ºé—´æ ‡è®°ä¸º &lt;code&gt;istio.io/dataplane-mode=ambient&lt;/code&gt; ï¼‰ï¼Œ protocol å€¼å°†è¢«æ›¿æ¢ä¸º HBONE ï¼Œè¡¨ç¤º ztunnel å°†æ¥è‡ªæ‰€æœ‰ helloworld -v1 pod ä¼ å…¥å’Œä¼ å‡ºé€šä¿¡å‡çº§åˆ° HBONEã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nt&#34;&gt;&amp;#34;workloads&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nt&#34;&gt;&amp;#34;10.244.2.8&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;nt&#34;&gt;&amp;#34;workloadIp&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;10.244.2.8&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;nt&#34;&gt;&amp;#34;protocol&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;HBONE&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;err&#34;&gt;...&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åœ¨éƒ¨ç½²ä»»ä½•å·¥ä½œè´Ÿè½½çº§åˆ«çš„æˆæƒç­–ç•¥åï¼Œç­–ç•¥é…ç½®ä½œä¸º xDS é…ç½®ä» Istiod æ¨é€åˆ° ztunnelï¼Œå¹¶å‡ºç°åœ¨ &lt;code&gt;policies&lt;/code&gt; ä¸­ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nt&#34;&gt;&amp;#34;policies&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nt&#34;&gt;&amp;#34;default/hw-viewer&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;nt&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;hw-viewer&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;nt&#34;&gt;&amp;#34;namespace&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;default&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;nt&#34;&gt;&amp;#34;scope&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;WorkloadSelector&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;nt&#34;&gt;&amp;#34;action&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;Allow&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;nt&#34;&gt;&amp;#34;groups&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[[[{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nt&#34;&gt;&amp;#34;principals&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[{&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;Exact&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;cluster.local/ns/default/sa/sleep&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;p&#34;&gt;}]]]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;err&#34;&gt;...&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å·¥ä½œè´Ÿè½½çš„é…ç½®å·²å‚è€ƒæˆæƒç­–ç•¥è¿›è¡Œäº†æ›´æ–°ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-json&#34; data-lang=&#34;json&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;nt&#34;&gt;&amp;#34;workloads&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nt&#34;&gt;&amp;#34;10.244.2.8&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nt&#34;&gt;&amp;#34;workloadIp&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;10.244.2.8&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;err&#34;&gt;...&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nt&#34;&gt;&amp;#34;authorizationPolicies&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;s2&#34;&gt;&amp;#34;default/hw-viewer&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;err&#34;&gt;...&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;ztunnel-æä¾›çš„-l4-é¥æµ‹&#34;&gt;ztunnel æä¾›çš„ L4 é¥æµ‹&lt;/h3&gt;
&lt;p&gt;ä½ å¯èƒ½ä¼šæƒŠå–œåœ°å‘ç° ztunnel æ—¥å¿—å¾ˆå®¹æ˜“ç†è§£ã€‚ä¾‹å¦‚ï¼Œä½ å°†åœ¨ç›®æ ‡ ztunnel ä¸Šçœ‹åˆ°ä¸€ä¸ª HTTP è¿æ¥è¯·æ±‚ï¼ŒæŒ‡ç¤ºæº pod IP (&lt;code&gt;peer_ip&lt;/code&gt;) å’Œç›®æ ‡ pod IPã€‚&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;2023-02-15T20:40:48.628251Z  INFO inbound{id=4399fa68cf25b8ebccd472d320ba733f peer_ip=10.244.2.5 peer_id=spiffe://cluster.local/ns/default/sa/sleep}: ztunnel::proxy::inbound: got CONNECT request to 10.244.2.8:5000
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ä½ å¯ä»¥é€šè¿‡è®¿é—®ä½äºâ€œlocalhost:15020/metricsâ€çš„ API æŸ¥çœ‹å·¥ä½œè´Ÿè½½çš„ L4 æŒ‡æ ‡ï¼Œå®ƒæä¾›äº†å…¨å¥— TCP &lt;a href=&#34;https://istio.io/latest/docs/reference/config/metrics/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ ‡å‡†æŒ‡æ ‡&lt;/a&gt; é›†ï¼Œå…·æœ‰ä¸ sidecar æš´éœ²çš„ç›¸åŒæ ‡ç­¾ã€‚ä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;istio_tcp_connections_opened_total{
  reporter=&amp;#34;source&amp;#34;,
  source_workload=&amp;#34;sleep&amp;#34;,
  source_workload_namespace=&amp;#34;default&amp;#34;,
  source_principal=&amp;#34;spiffe://cluster.local/ns/default/sa/sleep&amp;#34;,
  destination_workload=&amp;#34;helloworld-v1&amp;#34;,
  destination_workload_namespace=&amp;#34;default&amp;#34;,
  destination_principal=&amp;#34;spiffe://cluster.local/ns/default/sa/helloworld&amp;#34;,
  request_protocol=&amp;#34;tcp&amp;#34;,
  connection_security_policy=&amp;#34;mutual_tls&amp;#34;
  ...
} 1
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å¦‚æœä½ å®‰è£…äº† Prometheus å’Œ Kialiï¼Œä½ å¯ä»¥ä» Kiali çš„ UI è½»æ¾æŸ¥çœ‹è¿™äº›æŒ‡æ ‡ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-kiali-dashboardç”±-ztunnel-æä¾›çš„-l4-é¥æµ‹&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Kiali dashboardï¼šç”± ztunnel æä¾›çš„ L4 é¥æµ‹&#34; srcset=&#34;
               /blog/rust-based-ztunnel/kiali-ambient_hu102f2962e2a65deb1824cca8a9a64826_256006_3171b1a81dc20b51ef6550aa114f76c2.webp 400w,
               /blog/rust-based-ztunnel/kiali-ambient_hu102f2962e2a65deb1824cca8a9a64826_256006_1a7280ff1282d9dbb1e08b29d3dcd483.webp 760w,
               /blog/rust-based-ztunnel/kiali-ambient_hu102f2962e2a65deb1824cca8a9a64826_256006_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/rust-based-ztunnel/kiali-ambient_hu102f2962e2a65deb1824cca8a9a64826_256006_3171b1a81dc20b51ef6550aa114f76c2.webp&#34;
               width=&#34;760&#34;
               height=&#34;357&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      Kiali dashboardï¼šç”± ztunnel æä¾›çš„ L4 é¥æµ‹
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h2 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬æ„Ÿåˆ°éå¸¸å…´å¥‹çš„æ˜¯ï¼Œæ–°çš„ &lt;a href=&#34;https://github.com/istio/ztunnel/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;åŸºäº Rust çš„ ztunnel&lt;/a&gt; æ¯”ä¹‹å‰åŸºäº Envoy çš„ ztunnel æ›´ç®€å•ã€é‡é‡æ›´è½»ä¸”æ€§èƒ½æ›´é«˜ã€‚å€ŸåŠ©ä¸“é—¨ä¸ºåŸºäº Rust çš„ ztunnel è®¾è®¡çš„å·¥ä½œè´Ÿè½½ xDSï¼Œä½ ä¸ä»…å¯ä»¥æ›´è½»æ¾åœ°äº†è§£ xDS é…ç½®ï¼Œè¿˜å¯ä»¥å¤§å¤§é™ä½ Istiod æ§åˆ¶å¹³é¢å’Œ ztunnel ä¹‹é—´çš„ç½‘ç»œæµé‡å’Œæˆæœ¬ã€‚éšç€ Istio ambient ç°åœ¨åˆå¹¶åˆ°ä¸Šæ¸¸ masterï¼Œä½ å¯ä»¥æŒ‰ç…§æˆ‘ä»¬çš„&lt;a href=&#34;http://istio.io/latest/docs/ops/ambient/getting-started/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å…¥é—¨æŒ‡å—&lt;/a&gt; å°è¯•æ–°çš„åŸºäº Rust çš„ ztunnelã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>WebAssembly çœŸçš„ä»£è¡¨ç€æœªæ¥å—ï¼Ÿ</title>
      <link>https://lib.jimmysong.io/blog/is-webassembly-really-the-future/</link>
      <pubDate>Tue, 07 Mar 2023 11:00:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/is-webassembly-really-the-future/</guid>
      <description>&lt;blockquote&gt;
&lt;p&gt;è¯‘è€…æ³¨ï¼šè¿™ç¯‡æ–‡ç« ä»å¤šä¸ªè§’åº¦æ¢è®¨äº† WebAssemblyï¼ˆWasmï¼‰çš„ç°çŠ¶å’Œæœªæ¥ã€‚é¦–å…ˆï¼Œæ–‡ç« å¼•ç”¨äº† Cloud Native Computing Foundationï¼ˆCNCFï¼‰çš„æŠ¥å‘Šï¼ŒæŒ‡å‡º WebAssembly åœ¨ç½‘é¡µã€æ— æœåŠ¡å™¨ã€æ¸¸æˆå’Œå®¹å™¨åŒ–åº”ç”¨ä¸­çš„åº”ç”¨è¶Šæ¥è¶Šå¹¿æ³›ï¼Œå¹¶é¢„æµ‹ WebAssembly å°†æ˜¾è‘—å½±å“è¿™äº›åº”ç”¨ã€‚å…¶æ¬¡ï¼Œæ–‡ç« è®¨è®ºäº† WebAssembly åœ¨å®¹å™¨ã€è¾¹ç¼˜è®¡ç®—ã€ç¼–ç¨‹è¯­è¨€å’Œæ— æœåŠ¡å™¨åº”ç”¨ç­‰æ–¹é¢çš„åº”ç”¨ã€‚è™½ç„¶ WebAssembly å·²ç»æˆç†Ÿåœ°åº”ç”¨äºæµè§ˆå™¨ï¼Œä½†æ˜¯åœ¨åç«¯åº”ç”¨æ–¹é¢ï¼Œå¦‚è¾¹ç¼˜è®¾å¤‡çš„åº”ç”¨å’Œéƒ¨ç½²ï¼Œä»éœ€è¦æ›´å¤šçš„å·¥ä½œã€‚ WASI å·²ç»æˆä¸ºå°† WebAssembly æ‰©å±•åˆ°æµè§ˆå™¨ä¹‹å¤–çš„æœ€ä½³é€‰æ‹©ï¼Œå¯ä»¥å¸®åŠ©è§£å†³åœ¨ä»»ä½•é…ç½®æ­£ç¡®çš„ CPU ä¸Šè¿è¡Œ WebAssembly è¿è¡Œæ—¶çš„å¤æ‚æ€§ã€‚ WebAssembly å’Œå®¹å™¨çš„åº”ç”¨é¢„è®¡å°†å…±åŒå¢é•¿ï¼Œå°½ç®¡ WebAssembly åœ¨æŸäº›ç”¨ä¾‹ä¸­å¯ä»¥å–ä»£å®¹å™¨ï¼Œä½†æ€»ä½“æ¥è¯´ï¼Œä¸¤è€…æ˜¯äº’è¡¥çš„äº§å“ã€‚ WebAssembly çš„æœªæ¥çœ‹èµ·æ¥éå¸¸å…‰æ˜ï¼Œä½†æ˜¯åœ¨å¯é å’Œé«˜æ•ˆåœ°æ”¯æŒ WebAssembly åœ¨æµè§ˆå™¨ä¹‹å¤–çš„ç”Ÿäº§ç”¨ä¾‹æ–¹é¢ï¼Œä»æœ‰å¾ˆå¤šå·¥ä½œè¦åšã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;a href=&#34;https://cncf.io/?utm_content=inline-mention&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;äº‘åŸç”Ÿè®¡ç®—åŸºé‡‘ä¼š (CNCF)&lt;/a&gt; æœ€è¿‘çš„&lt;a href=&#34;https://www.cncf.io/reports/cncf-annual-survey-2022/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¹´åº¦è°ƒæŸ¥åŒ…æ‹¬&lt;/a&gt;&lt;a href=&#34;https://thenewstack.io/how-webassembly-could-streamline-cloud-native-computing/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;WebAssembly (Wasm)&lt;/a&gt; å¤§èƒ†å£°æ˜ï¼šâ€œå®¹å™¨æ˜¯æ–°å¸¸æ€ï¼ŒWebAssembly æ˜¯æœªæ¥â€ã€‚&lt;/p&gt;
&lt;p&gt;è¿™å¥è¯é¢„ç¤ºäº†å¾ˆå¤šäº‹æƒ…ï¼Œä¸ä»…æ˜¯å…³äº WebAssembly çš„è·¯çº¿å›¾å’Œå‘å±•ï¼Œè¿˜æœ‰å®ƒç›®å‰åœ¨è®¡ç®—é¢†åŸŸçš„åœ°ä½ã€‚ æ® CNCF ç§°ï¼Œ37% çš„æœ€ç»ˆç”¨æˆ·ç»„ç»‡å·²ç»å…·æœ‰ä½¿ç”¨ WebAssembly éƒ¨ç½²åº”ç”¨ç¨‹åºçš„ç»éªŒã€‚ æ ¹æ® CNCF æŠ¥å‘Šï¼Œè™½ç„¶å…¶ä¸­è®¸å¤šç”¨é€”æ˜¯ä¸ºäº†æµ‹è¯• Wasm çš„ä¼˜ç‚¹ï¼Œä½† &lt;a href=&#34;https://wasmedge.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;WasmEdge&lt;/a&gt; å’Œ &lt;a href=&#34;https://github.com/bytecodealliance/wasm-micro-runtime&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;WAMR&lt;/a&gt; æ˜¯æœ€å¸¸ç”¨çš„è¿è¡Œæ—¶ã€‚&lt;/p&gt;
&lt;p&gt;CNCF ç”Ÿæ€ç³»ç»Ÿè´Ÿè´£äºº Taylor Dolezal åœ¨å¯¹ TheNewStack ç”µå­é‚®ä»¶å›å¤ä¸­è¯´ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ WebAssembly çš„é‡‡ç”¨å°†èµ°å‘ä½•æ–¹ï¼Œå®ƒçš„è·¯çº¿å›¾å’Œæœªæ¥åœ¨è®¡ç®—ä¸­çš„ä½ç½®æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ è®©æˆ‘ä»¬çœ‹çœ‹ Wasm åœ¨&lt;a href=&#34;https://thenewstack.io/containers/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å®¹å™¨&lt;/a&gt;ã€&lt;a href=&#34;https://thenewstack.io/edge-computing/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è¾¹ç¼˜&lt;/a&gt;å’Œå…¶ä»–åº”ç”¨ç¨‹åºã€&lt;a href=&#34;https://thenewstack.io/25-most-popular-programming-languages-used-by-devops-pros/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç¼–ç¨‹è¯­è¨€&lt;/a&gt; å’Œæ— æœåŠ¡å™¨é›†æˆåŠå…¶æœªæ¥ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æœªæ¥&#34;&gt;æœªæ¥&lt;/h2&gt;
&lt;p&gt;å¯ä»¥è¯´ï¼Œæ‚¨å¯èƒ½ä¼šäº‰è¾©è¯´ Wasm ä¸æœªæ¥æ— å…³ï¼Œä½†å®ƒåœ¨æœ€åˆåˆ›å»ºçš„æ‰€æœ‰ä¸»è¦ç½‘ç»œæµè§ˆå™¨ä¸­çš„ä½¿ç”¨å·²ç»å¾ˆé‡è¦äº†ã€‚ ä½†æ˜¯ï¼Œè™½ç„¶ Wasm åœ¨æµè§ˆå™¨ä¸­å·²ç»æˆç†Ÿï¼Œä½†åœ¨å®ƒæˆä¸ºæœªæ¥çš„ä¸€éƒ¨åˆ†ç”¨äºåç«¯åº”ç”¨ç¨‹åºä¹‹å‰ï¼Œè¿˜éœ€è¦åšæ›´å¤šçš„å·¥ä½œï¼Œä¾‹å¦‚å®ƒåœ¨è¾¹ç¼˜è®¾å¤‡ä¸­çš„ä½¿ç”¨å’Œéƒ¨ç½²ã€‚&lt;/p&gt;
&lt;p&gt;äº‹å®ä¸Šï¼Œå®ƒå¹¶ä¸åƒå°† &lt;a href=&#34;https://thenewstack.io/an-introduction-to-python-for-non-programmers/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Python&lt;/a&gt; æ·»åŠ åˆ° Wasm ç„¶åé€šè¿‡æ‰˜ç®¡ Wasm è¿è¡Œæ—¶çš„ Wasi è¿è¡ŒåŒ…é‚£ä¹ˆç®€å•ã€‚ &lt;a href=&#34;https://thenewstack.io/machine-learning/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç”¨äºæœºå™¨å­¦ä¹ &lt;/a&gt;å’Œ Python ä¸“é—¨é€‚é…çš„æ•°æ®åˆ†æç­‰åç«¯åº”ç”¨ï¼Œå…¶åœ¨åˆšåˆšå¼€å‘ç¼–è¯‘çš„å¤§é‡ç¬¬ä¸‰æ–¹ä¾èµ–çš„ Wasm ä¸­çš„åº”ç”¨å¯†åˆ‡ç›¸å…³ã€‚&lt;/p&gt;
&lt;p&gt;Wasm &lt;a href=&#34;https://thenewstack.io/pipelines-paas-continuously-delivering-continuous-delivery/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¹³å°å³æœåŠ¡ (PaaS)&lt;/a&gt; äº§å“æˆ–å¹³å°å°šä¸å­˜åœ¨ï¼Œå¯è½»æ¾ç”¨äºå°† WebAssembly å€Ÿç»™åç«¯åº”ç”¨ç¨‹åºã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒWasm åœ¨æµè§ˆå™¨ä¹‹å¤–çš„åº”ç”¨æ‰åˆšåˆšå…´èµ·ã€‚&lt;/p&gt;
&lt;p&gt;Enterprise Management Associates çš„åˆ†æå¸ˆ &lt;a href=&#34;https://www.linkedin.com/in/torstenvolk&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Torsten Volk&lt;/a&gt;  å‘Šè¯‰ The New Stackã€‚ ç¼ºå°‘ä»€ä¹ˆï¼Œæˆ‘ä»¬ä¼šä¸€è·¯æ‰¾åˆ°ã€‚ å±Šæ—¶ï¼Œå¼€æºé¡¹ç›®å’Œå•†ä¸šä¾›åº”å•†å°†ä»‹å…¥ä»¥å¡«è¡¥è¿™äº›ç©ºç™½ï¼Œå¹¶æä¾›æœ€ä½³çš„å¼€å‘äººå‘˜å’Œ &lt;a href=&#34;https://thenewstack.io/the-what-why-and-how-of-devops/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;DevOps&lt;/a&gt; ä½“éªŒã€‚ â€&lt;/p&gt;
&lt;p&gt;å°†æœåŠ¡å™¨ç«¯ï¼ˆss-Wasmï¼‰WebAssembly ä¸ç”¨äºæµè§ˆå™¨åº”ç”¨ç¨‹åºçš„ Wasm åŒºåˆ†å¼€æ¥ï¼Œss-Wasm æœ‰ç€å…‰æ˜çš„æœªæ¥ï¼Œè€Œé‡‡ç”¨ ss-Wasm çš„é“è·¯å¾ˆé•¿ï¼Œè€Œä¸”â€œå…¶ä¸­å¾ˆå¤šä»ç„¶éœ€è¦æ˜ å°„â€ï¼Œ&lt;a href=&#34;https://www.linkedin.com/in/wiqar?miniProfileUrn=urn%3Ali%3Afs_miniProfile%3AACoAAACh3tYBq_83ujeBLYcODDpkucuxdpr-KhU&amp;amp;lipi=urn%3Ali%3Apage%3Ad_flagship3_detail_base1H2B1rTin6PqQia%3D&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Wiqar Chaudry&lt;/a&gt;ï¼ŒXmbia é¡¹ç›®åä½œå¹³å°çš„åˆ›å§‹äººå’Œ CEOï¼Œå‘Šè¯‰ The New Stackã€‚&lt;/p&gt;
&lt;p&gt;â€œæœ‰ä¸¤ä¸ªéå¸¸ç®€å•çš„æŒ‡æ ‡ï¼šWasm åœ¨åˆ›å»ºè½¯ä»¶æ—¶æ˜¯å¦æœ‰æ˜ç¡®çš„ç»æµä»·å€¼ä¸»å¼ ï¼Ÿ å®ƒä¼šé™ä½æˆæœ¬ï¼Œå¸®åŠ©å…¬å¸å’Œå¼€å‘å•†èµšæ›´å¤šé’±ï¼Œè¿˜æ˜¯å¸®åŠ©é‡Šæ”¾å…¶ä»–ç±»å‹çš„æœªå®ç°ä»·å€¼ï¼Ÿâ€ Chaudry è¯´ï¼Œä»–ä¹Ÿå‚ä¸äº† &lt;a href=&#34;https://wasmer.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Wasmer&lt;/a&gt; é¡¹ç›®ï¼Œç›®å‰æ‹…ä»»é¡¾é—®ã€‚&lt;/p&gt;
&lt;p&gt;â€œç¬¬äºŒä¸ªæ˜¯å®ƒçš„æŠ€æœ¯ä»·å€¼ä¸»å¼ ã€‚å®ƒæ˜¯å¦å¸å¼•äº†è¶³å¤Ÿå¤šçš„å¼€å‘äººå‘˜å¹¶è§£å†³äº†è¶³å¤Ÿå¤šçš„æŠ€æœ¯éš¾é¢˜ï¼Œä½¿ä»–ä»¬èƒ½å¤Ÿè´Ÿæ‹…å¾—èµ·ä½¿ç”¨ Wasm ä½œä¸ºå…¶æŠ€æœ¯æ ˆçš„ä¸€éƒ¨åˆ†ï¼Ÿâ€&lt;/p&gt;
&lt;h2 id=&#34;wasi&#34;&gt;WASI&lt;/h2&gt;
&lt;p&gt;å°±ç›®å‰è€Œè¨€ï¼ŒWASI å·²æˆä¸ºå°† Wasm èŒƒå›´æ‰©å±•åˆ°æµè§ˆå™¨ä¹‹å¤–çš„æœ€ä½³é€‰æ‹©ã€‚ è¢«æè¿°ä¸º WebAssembly çš„&lt;a href=&#34;https://wasi.dev/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ¨¡å—åŒ–ç³»ç»Ÿæ¥å£&lt;/a&gt;ï¼Œå®ƒå·²è¢«è¯æ˜æœ‰åŠ©äºè§£å†³åœ¨ä»»ä½•æœ‰æ­£ç¡®é…ç½®çš„ CPU çš„åœ°æ–¹è¿è¡Œ Wasm è¿è¡Œæ—¶çš„å¤æ‚æ€§â€”â€”è¿™ä¸€ç›´æ˜¯ WebAssembly è‡ªåˆ›å»ºä»¥æ¥çš„ä¸»è¦å–ç‚¹ä¹‹ä¸€ã€‚&lt;/p&gt;
&lt;p&gt;Fermyon Technologies çš„è”åˆåˆ›å§‹äººå…¼é¦–å¸­æ‰§è¡Œå®˜ &lt;a href=&#34;https://www.linkedin.com/in/mattbutcher/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Matt Butcher&lt;/a&gt; å‘Šè¯‰ The New Stackï¼šâ€œæˆ‘ç›¸ä¿¡ WebAssembly ä½œä¸ºä¸€ç§é€šç”¨æŠ€æœ¯çš„å…³é”®ç‰¹æ€§æ˜¯ä¸ºäº†æ”¯æŒ &lt;a href=&#34;https://thenewstack.io/mozilla-extends-webassembly-beyond-the-browser-with-wasi/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;WebAssembly ç³»ç»Ÿæ¥å£ (WASI)&lt;/a&gt;â€ã€‚ â€œWASI å…è®¸å¼€å‘äººå‘˜åœ¨ä»–ä»¬çš„ä»£ç ä¸­ä½¿ç”¨ç†Ÿæ‚‰çš„ç³»ç»Ÿä¹ æƒ¯ç”¨æ³•ï¼Œä¾‹å¦‚æ‰“å¼€æ–‡ä»¶å’Œè¯»å–ç¯å¢ƒå˜é‡ï¼Œè€Œä¸ä¼šç ´å WebAssembly å®‰å…¨æ¨¡å‹ã€‚éšç€ WASI æ”¯æŒå˜å¾—æ›´åŠ å¹¿æ³›ï¼Œæˆ‘ä»¬å°†çœ‹åˆ° WebAssembly ç”¨ä¾‹çš„çˆ†ç‚¸å¼å¢é•¿ã€‚â€&lt;/p&gt;
&lt;p&gt;ç„¶è€Œï¼ŒWASI ä»åœ¨èµ°å‘æˆç†Ÿã€‚ â€œWASI çš„ç¬¬ä¸€ä¸ªç‰ˆæœ¬å‘æˆ‘ä»¬å±•ç¤ºäº† WebAssembly çš„æ½œåŠ›ã€‚ç¬¬äºŒä¸ªç‰ˆæœ¬ Preview 2 å°†åœ¨å‡ ä¸ªæœˆåå‘å¸ƒï¼Œâ€Butcher è¯´ã€‚ â€œPreview 2 ä¸­æ·»åŠ çš„ç½‘ç»œåŠŸèƒ½å°†å¼€è¾Ÿå¤§é‡æ–°ç”¨é€”ã€‚â€&lt;/p&gt;
&lt;p&gt;Cosmonic é¦–å¸­æ‰§è¡Œå®˜å…¼è”åˆåˆ›å§‹äºº &lt;a href=&#34;https://www.linkedin.com/in/hectaman&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Liam Randall&lt;/a&gt; è¡¨ç¤ºï¼ŒWebAssembly å°†åˆ©ç”¨ç»„ä»¶å’Œ WASI å°†é€šç”¨åº”ç”¨ç¨‹åºåº“æŠ½è±¡ä¸ºé€šç”¨å¯æ‹”æ’ç»„ä»¶ã€‚ ä»–è¯´ï¼Œå‘å¸ƒ-è®¢é˜…æ¶ˆæ¯ä¼ é€’æˆ–ç‰¹å®š SQL æœåŠ¡å™¨ç­‰ç»„ä»¶ä½œä¸ºæŠ½è±¡è€Œä¸æ˜¯ä¸ç‰¹å®šåº“çš„ç´§å¯†è€¦åˆäº¤ä»˜ç»™åº”ç”¨ç¨‹åºã€‚&lt;/p&gt;
&lt;p&gt;â€œå½“å®¹å™¨å‡ºç°æ—¶ï¼Œå®ƒä»¬æ›´å°ï¼Œå¯åŠ¨é€Ÿåº¦æ›´å¿«ï¼Œå¹¶ä¸ºå¼€å‘äººå‘˜æä¾›äº†æ¯”è™šæ‹Ÿæœºæ›´å°çš„è¡¨é¢åŒºåŸŸæ¥é…ç½®å’Œç»´æŠ¤ï¼Œâ€Randall è¯´ã€‚ â€œWebAssembly æ¨¡å—å»¶ç»­äº†è¿™ä¸€è¶‹åŠ¿ï¼Œä½“ç§¯æ›´å°ï¼Œå¯åŠ¨é€Ÿåº¦æ›´å¿«ï¼Œå¹¶åˆ©ç”¨ç»„ä»¶æ¥å‡å°‘å¼€å‘äººå‘˜ç¼–å†™å’Œç»´æŠ¤çš„ä»£ç é‡ã€‚â€&lt;/p&gt;
&lt;p&gt;â€œæ›´é‡è¦çš„æ˜¯ï¼Œç»„ä»¶æ¨¡å‹æ˜¯ä¸€ç§æ–°çš„åº”ç”¨ç¨‹åºæ–¹æ³•ï¼Œå®ƒå…è®¸é¢å‘èƒ½åŠ›çš„å®‰å…¨æ€§ï¼Œå¹¶ä½¿å¹³å°è¿è¥å•†æ›´å®¹æ˜“å®‰å…¨åœ°è¿è¡Œåº”ç”¨ç¨‹åºã€‚â€&lt;/p&gt;
&lt;p&gt;Wasm ä½¿ç”¨ WASI è¿›è¡Œç³»ç»Ÿçº§é›†æˆ API è¿›ä¸€æ­¥æé«˜äº†å®ƒä½œä¸ºé€šç”¨è¿è¡Œæ—¶çš„å¯è¡Œæ€§ï¼ŒDolezal è¯´ï¼šâ€œWebAssembly åœ¨å®‰å…¨ç¯å¢ƒä¸­æ‰˜ç®¡ä¸å—ä¿¡ä»»ä»£ç çš„èƒ½åŠ›ä¹Ÿæ˜¯ä¸€ä¸ªé‡è¦çš„å¥½å¤„ã€‚â€&lt;/p&gt;
&lt;h2 id=&#34;ä¸å®¹å™¨çš„å…³ç³»&#34;&gt;ä¸å®¹å™¨çš„å…³ç³»&lt;/h2&gt;
&lt;p&gt;æ­£å¦‚ CNCF æŠ¥å‘Šæ‰€è¿°ï¼Œ&lt;a href=&#34;https://thenewstack.io/containers/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å®¹å™¨&lt;/a&gt; ç¡®å®æ˜¯â€œæ–°å¸¸æ€â€ï¼Œå°¤å…¶æ˜¯åœ¨äº‘åŸç”Ÿé¢†åŸŸã€‚ åœ¨æŸäº›ç”¨ä¾‹ä¸­ï¼ŒWasm å¯ä»¥å–ä»£å®¹å™¨ï¼Œä½†æ€»çš„æ¥è¯´ï¼ŒWebAssembly å’Œå®¹å™¨çš„é‡‡ç”¨å°†åŒæ­¥å¢é•¿ã€‚&lt;/p&gt;
&lt;p&gt;â€œæˆ‘ç»å¯¹ç›¸ä¿¡ Kubernetes å’Œ Wasm æ˜¯äº’è¡¥çš„äº§å“ï¼ŒKubernetes è´Ÿè´£é…ç½®å’Œæ‰©å±•åŸºç¡€è®¾æ–½ï¼Œè€Œ Wasm åœ¨è¯¥åŸºç¡€è®¾æ–½ä¹‹ä¸Šæä¾›åº”ç”¨ç¨‹åºï¼ŒåŒ…æ‹¬å…¶è¿è¡Œæ—¶ï¼Œâ€Volk è¯´ã€‚&lt;/p&gt;
&lt;p&gt;Kubernetes é‡‡ç”¨çš„è·¯å¾„å¯ä»¥ä½œä¸º Wasm å¦‚ä½•ä»¥åŠä½•æ—¶å¤§è§„æ¨¡é‡‡ç”¨çš„å¯èƒ½æ¨¡å‹ã€‚ â€œç”±äº Kubernetes çš„å¹¿æ³›å¯ç”¨æ€§ä»¥åŠä½¿ç”¨ã€æ‰©å±•å’Œæ”¯æŒå®ƒçš„å·¥å…·ï¼ŒKubernetes è¢«å¹¿æ³›é‡‡ç”¨ï¼Œâ€Chaudry è¯´ã€‚ â€œå¦‚æœ Kubernetes ä¸åƒ AKSã€EKS æˆ– GKE é‚£æ ·å®¹æ˜“è·å¾—ï¼Œæˆ‘ä»¬å°±ä¼šçœ‹åˆ°æ›´å°‘çš„é‡‡ç”¨å’Œä½¿ç”¨ã€‚WebAssembly ä¹Ÿä¼šèµ°åŒæ ·çš„è·¯ã€‚â€&lt;/p&gt;
&lt;p&gt;Wasm ä¹Ÿåªè§£å†³äº†å®¹å™¨æ‰€åšçš„ä¸€äº›é—®é¢˜ï¼Œä»–è¯´ï¼šâ€œå®¹å™¨æ›´å¤æ‚ï¼Œè¿è¥å¼€é”€æ›´é«˜ã€‚ä¸¤è€…ä¹‹é—´çš„æƒè¡¡ä½¿å¾—ä¸¤è€…åŒæ­¥å¢é•¿æ˜¯åˆç†çš„ã€‚â€&lt;/p&gt;
&lt;p&gt;Butcher è¡¨ç¤ºï¼Œå½“ DockerHub å¼€å§‹æ”¯æŒæ–°çš„å·¥ä»¶å­˜å‚¨è§„èŒƒæ—¶ï¼ŒWasm ç¤¾åŒºæ„è¯†åˆ°ï¼Œä¸å…¶é‡æ–°å‘æ˜è½®å­ï¼Œä¸å¦‚å°† Wasm è¿è¡Œæ—¶å­˜å‚¨åœ¨ Docker Hub ç­‰ &lt;a href=&#34;https://thenewstack.io/oci-reveals-governance-structure-amid-debate-focus/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Open Container Initiative registries&lt;/a&gt; ä¸­ä¼šæ›´å¥½ã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œæœ¬æœˆ Fermyon çš„ Spin 0.8 å¼€å§‹æ”¯æŒ OCI æ³¨å†Œè¡¨ã€‚ â€œè™½ç„¶æˆ‘ä»¬æœ€åˆä¸ç¡®å®š OCI æ³¨å†Œè¡¨æ˜¯å¦æ˜¯æ­£ç¡®çš„åˆ†å‘æœºåˆ¶ï¼Œä½†æ ‡å‡†çš„æ¼”å˜åŠ ä¸Š Docker Hub çš„æ”¯æŒæ”¹å˜äº†æˆ‘ä»¬çš„æƒ³æ³•ï¼Œâ€Butcher è¯´ã€‚ â€œæˆ‘ä»¬è‡´åŠ›äºä½¿ç”¨ OCI æ³¨å†Œè¡¨åˆ†å‘ WebAssembly åº”ç”¨ç¨‹åºï¼Œå¹¶ä¸”ä»Šå¤©å·²ç»å®ç°äº†ã€‚â€&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>äº‘åŸç”Ÿç½‘ç»œåŠŸèƒ½ï¼ˆCNFï¼‰åº”è¯¥è®©æ¯ä¸ªå®¹å™¨èšç„¦ä¸€ä¸ªå…³æ³¨ç‚¹</title>
      <link>https://lib.jimmysong.io/blog/cloud-native-network-functions-concern/</link>
      <pubDate>Thu, 02 Mar 2023 11:00:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/cloud-native-network-functions-concern/</guid>
      <description>&lt;blockquote&gt;
&lt;p&gt;è¯‘è€…æ³¨ï¼šè¿™ç¯‡æ–‡ç« ä»‹ç»äº†å¦‚ä½•ç¼–å†™äº‘åŸç”Ÿç½‘ç»œåŠŸèƒ½ï¼ˆCNFï¼‰ï¼Œå³åœ¨ç”µä¿¡é¢†åŸŸçš„ç½‘ç»œåº”ç”¨ï¼Œå®ƒä»¬ä¸å¤§å¤šæ•°äº‘åŸç”Ÿä¼ä¸šåº”ç”¨æœ‰ä¸åŒçš„éåŠŸèƒ½æ€§éœ€æ±‚ã€‚CNF éœ€è¦æ»¡è¶³é«˜æ€§èƒ½ã€é«˜å¯é æ€§ã€é«˜å®‰å…¨æ€§å’Œä½å»¶è¿Ÿç­‰æŒ‡æ ‡ã€‚æ–‡ç« æå‡ºäº†ä¸€ä¸ªåŸºæœ¬çš„è®¾è®¡åŸåˆ™ï¼šæ¯ä¸ªå®¹å™¨åªè´Ÿè´£ä¸€ä¸ªå…³æ³¨ç‚¹ï¼Œå³ä¸€ä¸ªå•ä¸€çš„ç½‘ç»œåŠŸèƒ½æˆ–å­åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;æœ¬æ–‡ä¸»æ—¨&#34;&gt;æœ¬æ–‡ä¸»æ—¨&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Docker å’Œ Kubernetes æ–‡æ¡£éƒ½æå€¡å°†ä¸€ä¸ªåº”ç”¨ç¨‹åºæˆ–æ¯ä¸ªå®¹å™¨â€œä¸€ä¸ªé—®é¢˜â€æ‰“åŒ…çš„æ¦‚å¿µã€‚ è¿™ä¹Ÿå¯ä»¥ä½œä¸ºæ¯ä¸ªåº”ç”¨ç¨‹åºå’Œå®¹å™¨è¿è¡Œâ€œä¸€ç§è¿›ç¨‹ç±»å‹â€çš„æŒ‡å—ã€‚&lt;/li&gt;
&lt;li&gt;åŸºäºç”µä¿¡çš„äº‘åŸç”Ÿç½‘ç»œåŠŸèƒ½ (CNF) å…·æœ‰ä½å»¶è¿Ÿã€é«˜ååé‡å’Œå¼¹æ€§ç­‰ç‰¹å®šè¦æ±‚ï¼Œè¿™æ¿€å‘äº†å¤šå…³æ³¨ç‚¹/å¤šè¿›ç¨‹ç±»å‹çš„å®¹å™¨åŒ–æ–¹æ³•ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨å¤šç§è¿›ç¨‹ç±»å‹å®ç°çš„é«˜æ€§èƒ½ç”µä¿¡åº”ç”¨ç¨‹åºåº”è¯¥æ¢ç´¢ä½¿ç”¨ unix åŸŸå¥—æ¥å­—è€Œä¸æ˜¯ TCP æˆ– HTTP è¿›è¡Œé€šä¿¡ï¼Œå› ä¸ºè¿™å¯ä»¥åŠ å¿«å®¹å™¨ä¹‹é—´çš„é€šä¿¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a href=&#34;https://vmblog.com/archive/2022/01/04/the-zeitgeist-of-cloud-native-microservices.aspx#.Y73WvezMJhE&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¾®æœåŠ¡çš„è¯¦ç»†å’Œç®€æ˜å®šä¹‰&lt;/a&gt; å¾ˆæœ‰ä»·å€¼ã€‚ åšå¾®æœåŠ¡å¯ä»¥æ˜¯ä»»ä½•åˆ©ç”¨åº·å¨å®šå¾‹å¹¶æŒ‰äº§å“å›¢é˜Ÿè¾¹ç•Œéƒ¨ç½²ä»£ç çš„ä¸œè¥¿ã€‚ ç²¾ç›Šå¾®æœåŠ¡æ˜¯é‚£äº›éµå¾ªç²—ç²’åº¦ä»£ç éƒ¨ç½²çš„æœåŠ¡ï¼Œé€šå¸¸åœ¨å®¹å™¨ä¸­ï¼Œå…·æœ‰å•ä¸€çš„å…³æ³¨ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.infoq.com/articles/cloud-native-network-functions/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Cloud Native Network Functions&lt;/a&gt;ï¼ˆCNFsï¼‰æ˜¯ç”µä¿¡é¢†åŸŸçš„ç½‘ç»œåº”ç”¨ï¼ŒéåŠŸèƒ½æ€§éœ€æ±‚ä¸åŒäºå¤§å¤šæ•°äº‘åŸç”Ÿä¼ä¸šåº”ç”¨ã€‚ CNF é€šå¸¸æ˜¯ &lt;a href=&#34;https://www.cncf.io/blog/2022/09/12/top-11-things-you-didnt-know-about-cloud-native-statefulness/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æœ‰çŠ¶æ€çš„&lt;/a&gt; åŒæ—¶éœ€è¦ &lt;a href=&#34;https://www.cncf.io/blog/2022/09/26/top-9-overlooked-questions-when-designing-your-stateful-cloud-native-network-application/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä½å»¶è¿Ÿã€é«˜ååé‡å’Œå¼¹æ€§&lt;/a&gt;ã€‚ä»»ä½•å‡å°‘æˆ–ç¦æ­¢è¿™äº›è¦æ±‚çš„æ¶æ„è¦ä¹ˆä¸é€‚åˆç”µä¿¡å‘å±•ï¼Œè¦ä¹ˆåœ¨å…¶å®æ–½ä¸­éœ€è¦ç‰¹æ®Šä¾‹å¤–ã€‚ è¿™å°±æ˜¯ç˜¦å¾®æœåŠ¡æ¨¡å‹çš„æŒ‘æˆ˜ï¼Œå®ƒä¿ƒè¿›äº†å®¹å™¨å’Œ CNF çš„â€œä¸€ä¸ªå…³ç‚¹ï¼Œä¸€ä¸ªè¿›ç¨‹â€çš„è®¾è®¡ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ¯ä¸ªå®¹å™¨èšç„¦äºä¸€ä¸ªå…³æ³¨ç‚¹&#34;&gt;æ¯ä¸ªå®¹å™¨èšç„¦äºä¸€ä¸ªå…³æ³¨ç‚¹&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://cloud.google.com/architecture/best-practices-for-building-containers&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Google äº‘æ–‡æ¡£ã€&lt;/a&gt;&lt;a href=&#34;https://docs.docker.com/config/containers/multi-service_container/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;docker æ–‡æ¡£&lt;/a&gt; å’Œ &lt;a href=&#34;https://kubernetes.io/docs/concepts/workloads/pods/#how-pods-manage-multiple-containers&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Kubernetes æ–‡æ¡£&lt;/a&gt; éƒ½æå€¡æ¯ä¸ªå®¹å™¨ä¸€ä¸ªåº”ç”¨ç¨‹åºæˆ–ä¸€ä¸ªå…³æ³¨ç‚¹çš„æ¦‚å¿µã€‚ è°·æ­Œäº‘æ–‡æ¡£ä½¿ç”¨æœ¯è¯­â€œåº”ç”¨ç¨‹åºâ€ï¼Œè€Œ docker æ–‡æ¡£ä½¿ç”¨æœ¯è¯­â€œå…³æ³¨ç‚¹â€å¹¶å°†å…³æ³¨ç‚¹è¿›ä¸€æ­¥æè¿°ä¸ºä¸€ç»„çˆ¶/å­è¿›ç¨‹ï¼Œå®ƒä»¬æ˜¯åº”ç”¨ç¨‹åºçš„ä¸€ä¸ªæ–¹é¢ã€‚ nginx å®ç°å°±æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ï¼Œå®ƒå°†åœ¨å¯åŠ¨æ—¶åˆ›å»ºä¸€ç»„å­å·¥ä½œè¿›ç¨‹ã€‚ ç†è§£å•ä¸€å…³æ³¨è§„åˆ™çš„å¦ä¸€ç§æ–¹æ³•æ˜¯è¯´å®¹å™¨ä¸­åº”è¯¥åªå­˜åœ¨ä¸€ç§è¿›ç¨‹ç±»å‹ï¼ˆä¾‹å¦‚ä¸€ç»„ nginx å·¥ä½œè¿›ç¨‹ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºä»€ä¹ˆå­˜åœ¨è¿™æ¡è§„åˆ™ï¼Ÿ è™½ç„¶æœ€åˆè®¤ä¸ºè¿™æ¡è§„åˆ™èƒŒåçš„åŸºæœ¬åŸç†æ˜¯é™ä½å•ä¸ªæ¨¡å—ã€ç»„ä»¶ã€å¯¹è±¡ç­‰çš„å¤æ‚æ€§ï¼Œä½†è¿™æ¡è§„åˆ™èƒŒåçš„çœŸæ­£é©±åŠ¨åŠ›æ˜¯å°Šé‡ä»£ç çš„å˜åŒ–ç‡ï¼Œè¿™ä¸ªæ¦‚å¿µå€Ÿé‰´äº†ä¼ ç»Ÿå»ºç­‘æ¦‚å¿µå’Œç”Ÿç‰©å­¦ã€‚ å·¥ä»¶çš„éƒ¨ç½²é€Ÿåº¦åº”ä¸å…¶æ›´æ”¹é¢‘ç‡ä¸€è‡´ã€‚ äº‘åŸç”Ÿçš„æ–¹å¼æ˜¯é€šè¿‡å°½æœ€å¤§åŠªåŠ›è§£è€¦ä»£ç æ¥åšåˆ°è¿™ä¸€ç‚¹ã€‚ å¯¹æ€§èƒ½ä¼˜åŒ–çš„éœ€æ±‚é€šå¸¸ä¼šåŠ©é•¿å¯¹è§£è€¦çš„æŠµåˆ¶ï¼Œæˆ‘ä»¬å°†åœ¨åé¢ä»‹ç»ã€‚&lt;/p&gt;
&lt;p&gt;ç”µä¿¡ç­‰è¡Œä¸šæœ‰ç‹¬ç«‹å‘å±•çš„å†å²ã€‚ æ¢å¥è¯è¯´ï¼Œåœ¨ç”µä¿¡è¡Œä¸šå†…ï¼Œä»£ç ã€ä»£ç åº“å’Œä»£ç éƒ¨ç½²éƒ½æ˜¯åœ¨ä¸€ä¸ªå¤§å‹ç»„ç»‡å†…å¼€å‘çš„ã€‚ å³ä½¿å¤šä¸ªå­ç»„ç»‡å…±åŒå¼€å‘ä¸€ä¸ªå¤§å‹é¡¹ç›®ï¼ˆä¾‹å¦‚å•†ä¸šçº§äº¤æ¢æœºï¼‰ï¼Œæ­¤ç±»åº“ã€é¡¹ç›®å’Œæœ€ç»ˆäº§å“çš„éƒ¨ç½²ä¹Ÿæ˜¯é›†ä¸­éƒ¨ç½²å¹¶é”å®šæ­¥éª¤ã€‚ é‰´äºè¿™æ®µå†å²ï¼Œå³ä½¿å‰é¢æåˆ°çš„å¾®æœåŠ¡çš„åšå®šä¹‰å­˜åœ¨é—®é¢˜ï¼Œç½‘ç»œåŠŸèƒ½æ›´éš¾éµå®ˆå¾®æœåŠ¡çš„è–„å®šä¹‰å’Œå•ä¸€å…³æ³¨ç‚¹è§„åˆ™ä¹Ÿå°±ä¸è¶³ä¸ºå¥‡äº†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ¯ä¸ªè¿›ç¨‹ä¸€ä¸ªå…³æ³¨ç‚¹çš„ä¸ƒå¤§å¥½å¤„&#34;&gt;æ¯ä¸ªè¿›ç¨‹ä¸€ä¸ªå…³æ³¨ç‚¹çš„ä¸ƒå¤§å¥½å¤„&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://twitter.com/monodot&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tom Donohue&lt;/a&gt; è¯´æ˜äº†æ­¤å¤„é‡è¿°çš„&lt;a href=&#34;https://www.tutorialworks.com/containers-single-or-multiple-processes/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å•ä¸€å…³æ³¨åŸåˆ™&lt;/a&gt; çš„å¥½å¤„ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;éš”ç¦»&lt;/strong&gt;ï¼šè¿›ç¨‹åœ¨ä½¿ç”¨å®¹å™¨å‘½åç©ºé—´ç³»ç»Ÿæ—¶ï¼Œä¸ä¼šç›¸äº’å¹²æ‰°ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯æ‰©å±•æ€§&lt;/strong&gt;ï¼šä¸è®¸å¤šç±»å‹ç›¸æ¯”ï¼Œæ‰©å±•ä¸€ä¸ªè¿›ç¨‹æˆ–ä¸€ç±»è¿›ç¨‹æ›´å®¹æ˜“ã€‚ è¿™å¯èƒ½æ˜¯å‡ºäºå¤æ‚æ€§çš„åŸå› ï¼ˆä¸€ç§è¿›ç¨‹ç±»å‹æ¯”è®¸å¤šè¿›ç¨‹ç±»å‹æ›´éš¾æ‰©å±•ï¼‰æˆ–å› ä¸ºå˜åŒ–ç‡ä¸åŒï¼ˆä¸€ä¸ªè¿›ç¨‹éœ€è¦æ ¹æ®ä¸å…¶ä»–è¿›ç¨‹ä¸åŒçš„æ¡ä»¶å¢é•¿ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯æµ‹è¯•æ€§&lt;/strong&gt;ï¼šå½“å‡å®šä¸€ä¸ªè¿›ç¨‹ç‹¬ç«‹è¿è¡Œæ—¶ï¼Œå®ƒå¯ä»¥ç‹¬ç«‹äºå…¶ä»–è¿›ç¨‹è¿›è¡Œæµ‹è¯•ã€‚ è¿™ä½¿å¼€å‘äººå‘˜å¯ä»¥é€šè¿‡æ¶ˆé™¤é¢å¤–çš„å˜é‡æ¥æ›´è½»æ¾åœ°å®šä½é—®é¢˜çš„æ ¹æœ¬åŸå› ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯éƒ¨ç½²æ€§&lt;/strong&gt;ï¼šå½“è¿›ç¨‹çš„äºŒè¿›åˆ¶æ–‡ä»¶å’Œä¾èµ–é¡¹éƒ¨ç½²åœ¨å®¹å™¨ä¸­æ—¶ï¼Œéƒ¨ç½²çš„å˜åŒ–ç‡ç›¸å¯¹äºäºŒè¿›åˆ¶æ–‡ä»¶å’Œå®¹å™¨æ˜¯ç²—ç²’åº¦çš„ï¼Œä½†ç›¸å¯¹äºå…¶ä»–è¿›ç¨‹åŠå…¶ä¾èµ–é¡¹æ˜¯ç»†ç²’åº¦çš„ã€‚ è¿™å…è®¸éƒ¨ç½²æ ¹æ®ä¾èµ–æ ‘ä¸­å‘ç”Ÿæ›´æ”¹çš„ä½ç½®å’Œæ—¶é—´è¿›è¡Œè°ƒæ•´ï¼Œè€Œä¸æ˜¯åŒæ­¥é‡æ–°éƒ¨ç½²æ‰€æœ‰å†…å®¹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯ç»„åˆæ€§&lt;/strong&gt;ï¼šè¿›ç¨‹ä¸­åªæœ‰ä¸€ä¸ªå…³æ³¨ç‚¹ï¼Œå› æ­¤æ¯ä¸ªå®¹å™¨çš„è¿›ç¨‹ç±»å‹æ›´å®¹æ˜“æ¨ç†ï¼Œå› ä¸ºå®ƒæ›´å®¹æ˜“ä»¥æ•°å­—æ–¹å¼å…±äº«å’Œå£å¤´äº¤æµå…¶å†…å®¹ã€‚ è¿™ä½¿å¾—å®ƒæ›´å®¹æ˜“åœ¨å…¶ä»–é¡¹ç›®ä¸­é‡ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¥æµ‹&lt;/strong&gt;ï¼šä»ä¸€ä¸ªé—®é¢˜æˆ–è¿›ç¨‹ç±»å‹æ¨æ–­æ—¥å¿—æ¶ˆæ¯æ¯”ä¸å…¶ä»–é—®é¢˜äº¤é”™çš„æ—¥å¿—æ¶ˆæ¯æ›´å®¹æ˜“ã€‚ åœ¨å°†æ‰€æœ‰æ—¥å¿—æ¶ˆæ¯æ‰“å°åˆ° &lt;a href=&#34;https://en.wikipedia.org/wiki/Standard_streams&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ ‡å‡†è¾“å‡º&lt;/a&gt; çš„å®¹å™¨ä¸­å°¤å…¶å¦‚æ­¤ï¼Œä¾‹å¦‚ 12 å› ç´ äº‘åŸç”Ÿåº”ç”¨ç¨‹åºã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼–æ’&lt;/strong&gt;ï¼šå¦‚æœå®¹å™¨ä¸­æœ‰å¤šä¸ªè¿›ç¨‹ç±»å‹ï¼Œåˆ™å¿…é¡»åœ¨å®¹å™¨å†…ç®¡ç†æ¬¡è¦å…³æ³¨ç‚¹çš„ç”Ÿå‘½å‘¨æœŸï¼Œè¿™å®é™…ä¸Šæ„å‘³ç€åœ¨çˆ¶è¿›ç¨‹ç±»å‹ä¸­åˆ›å»ºç¼–æ’å™¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¼€æºäº‘åŸç”Ÿè¿åŠ¨å¯¹ç”µä¿¡è¡Œä¸šçš„å½±å“æ˜¯ä¾›åº”å•†ä¹‹é—´åä½œçš„çˆ†ç‚¸å¼å¢é•¿ã€‚ ä¸åœ¨ä¸€ä¸ªç»„ç»‡çš„ä¿æŠ¤ä¼ä¸‹å¼€å‘ç´§å¯†è€¦åˆçš„è½¯ä»¶ç›¸åï¼Œå¯¹æ›´å¤šåä½œå’Œäº’æ“ä½œæ€§çš„å‘¼åå·²ç»ä¿ƒä½¿æ¥è‡ªä¸åŒç»„ç»‡çš„å¤šä¸ªé¡¹ç›®é‡æ–°å®¡è§†å•ä¸€å…³æ³¨ç‚¹åŸåˆ™çš„å¥½å¤„ã€‚&lt;/p&gt;
&lt;h2 id=&#34;äº‘åŸç”Ÿè¿›ç¨‹æœ€ä½³å®è·µ&#34;&gt;äº‘åŸç”Ÿè¿›ç¨‹æœ€ä½³å®è·µ&lt;/h2&gt;
&lt;h3 id=&#34;ç‹¬ç«‹äºæµç¨‹é¡ºåº&#34;&gt;ç‹¬ç«‹äºæµç¨‹é¡ºåº&lt;/h3&gt;
&lt;p&gt;å°†å¤šä¸ªè¿›ç¨‹ç±»å‹æ”¾åœ¨åŒä¸€ä¸ªå®¹å™¨ä¸­çš„è®ºæ®ä¹‹ä¸€æ˜¯&lt;a href=&#34;https://medium.com/@kelseyhightower/12-fractured-apps-1080c73d481c&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;éœ€è¦æ›´å¤šåœ°æ§åˆ¶é—®é¢˜çš„å¯åŠ¨é¡ºåº&lt;/a&gt;ã€‚ ä¾‹å¦‚éœ€è¦æ•°æ®åº“çš„ä¼ ç»Ÿåº”ç”¨ç¨‹åºã€‚ å¦‚æœæ•°æ®åº“ä¸å¯ç”¨ï¼Œåº”ç”¨ç¨‹åºå’Œ Web æœåŠ¡å™¨å¯èƒ½æ— æ³•æ­£å¸¸å¯åŠ¨ï¼Œå› æ­¤æœ‰äººå¯èƒ½ä¼šåœ¨å¯åŠ¨åº”ç”¨ç¨‹åºä¹‹å‰æ‰‹åŠ¨å¯åŠ¨ docker æ–‡ä»¶ä¸­çš„æ•°æ®åº“ã€‚ è™½ç„¶è¿™ç¡®å®æœ‰æ•ˆï¼Œä½†è¿™æ ·åšä¼šå¤±å»å…³æ³¨ç‚¹æ¾æ•£è€¦åˆçš„ä¸ƒä¸ªå¥½å¤„ã€‚ æ›´å¥½çš„æ–¹æ³•æ˜¯ä½¿æ‚¨çš„å…³æ³¨ç‚¹å’Œæµç¨‹ç±»å‹å°½å¯èƒ½ç‹¬ç«‹äºé¡ºåºã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä½ çš„è¿›ç¨‹å°†è¢«ç»ˆæ­¢&#34;&gt;ä½ çš„è¿›ç¨‹å°†è¢«ç»ˆæ­¢&lt;/h3&gt;
&lt;p&gt;Kubernetes æœ‰ä¸€ä¸ª &lt;a href=&#34;https://kubernetes.io/docs/concepts/scheduling-eviction/pod-priority-preemption/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;pod ä¼˜å…ˆçº§&lt;/a&gt; çš„è®¾ç½®ï¼Œå¦‚æœä¸æ»¡è¶³ä¸€ç»„æ¡ä»¶æ—¶ï¼Œå…è®¸ç”¨æˆ·&lt;a href=&#34;https://kubernetes.io/docs/concepts/scheduling-eviction/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æŠ¢å æˆ–ç»ˆæ­¢&lt;/a&gt; podã€‚ è¿™æ„å‘³ç€ pod éœ€è¦å“åº”æ¥è‡ªè¿™äº›è°ƒåº¦ç­–ç•¥çš„æ­£å¸¸å…³é—­è¯·æ±‚ï¼Œå¦åˆ™å®ƒä»¬å°†é¢ä¸´æ•°æ®æŸåå’Œå…¶ä»–é”™è¯¯ã€‚ è¿™äº›æ­£å¸¸å…³é—­è¯·æ±‚ä»¥ &lt;a href=&#34;https://www.gnu.org/software/libc/manual/html_node/Termination-Signals.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SIGTERM è¯·æ±‚&lt;/a&gt; çš„å½¢å¼å‡ºç°ï¼Œé€šå¸¸åœ¨ SIGKILL è¯·æ±‚å‘å‡ºå‰ 30 ç§’ç»ˆæ­¢å¼ºåˆ¶è¿‡ç¨‹ã€‚ å½“è¿è¡Œå¤šä¸ªè¿›ç¨‹æ—¶ï¼Œæ‰€æœ‰å­è¿›ç¨‹éƒ½éœ€è¦èƒ½å¤Ÿå¤„ç†æ­£å¸¸å…³é—­ä¿¡å·ã€‚ æ­£å¦‚æˆ‘ä»¬ç¨åå°†çœ‹åˆ°çš„ï¼Œå¤„ç†è¿›ç¨‹çš„æ­£å¸¸å…³é—­å¯èƒ½ä¼šå¯¼è‡´ä¸€äº›å¾®å¦™çš„é—®é¢˜ï¼Œè¿™äº›é—®é¢˜åœ¨å¤„ç†å¤šä¸ªè¿›ç¨‹æ—¶ä¼šå˜å¾—æ›´ç³Ÿã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ç”µä¿¡ä¸­ï¼Œæµç¨‹é¡ºåºç‹¬ç«‹æ€§å’ŒæŠ¢å é€šå¸¸ç”±ä¸å…¶ç®¡ç†çš„æµç¨‹ç´§å¯†è€¦åˆçš„ç¼–æ’å™¨å¤„ç†ã€‚ æœ‰äº†åƒ Kubernetes è¿™æ ·çš„ä¸åº”ç”¨ç¨‹åºæ— å…³çš„ç¼–æ’å™¨ï¼Œè¿™äº›è‡ªå®šä¹‰å’Œç´§å¯†è€¦åˆçš„ç¼–æ’å™¨æ—¶ä»£å³å°†ç»“æŸï¼Œå¦‚&lt;a href=&#34;https://kubernetes.io/docs/reference/scheduling/config/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å£°æ˜å¼è°ƒåº¦é…ç½®&lt;/a&gt;ã€‚ç”µä¿¡äº‘åŸç”Ÿæ–¹æ³•å¯èƒ½åº”è¯¥ç±»ä¼¼äºErlangç¤¾åŒºå¯¹è¿›ç¨‹çš„ &amp;ldquo;&lt;a href=&#34;https://erlang.org/download/armstrong_thesis_2003.pdf&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è®©å®ƒå¤±è´¥&lt;/a&gt;&amp;ldquo;æ–¹æ³•ï¼Œå…¶ä¸­è°ƒç”¨è¿›ç¨‹å¯¹å®ƒæ‰€è°ƒç”¨çš„è¿›ç¨‹æ›´åŠ ç¨³å¥ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å¤šè¿›ç¨‹å’Œåº”ç”¨ç¨‹åºç”Ÿå‘½å‘¨æœŸ&#34;&gt;å¤šè¿›ç¨‹å’Œåº”ç”¨ç¨‹åºç”Ÿå‘½å‘¨æœŸ&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://cloud.google.com/architecture/best-practices-for-building-containers&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Google Cloud&lt;/a&gt; å»ºè®®æ‚¨ä¸ºæ¯ä¸ªå®¹å™¨æ‰“åŒ…ä¸€ä¸ªâ€œåº”ç”¨ç¨‹åºâ€ã€‚ åœ¨æ›´æŠ€æœ¯å±‚é¢ä¸Šï¼Œå•ä¸ªåº”ç”¨ç¨‹åºè¢«å®šä¹‰ä¸ºå…·æœ‰å¯èƒ½çš„è®¸å¤šå­è¿›ç¨‹çš„å•ä¸ªçˆ¶è¿›ç¨‹ã€‚ è¿™ä¸€åŸºæœ¬åŸç†çš„ä¸»è¦éƒ¨åˆ†æ˜¯åˆ©ç”¨åº”ç”¨ç¨‹åºç”Ÿå‘½å‘¨æœŸä¸­ä¸åŒçš„å˜åŒ–ç‡ã€‚ ç”Ÿå‘½å‘¨æœŸæ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ ç”Ÿå‘½å‘¨æœŸæ˜¯åº”ç”¨ç¨‹åºçš„å¼€å§‹ã€æ‰§è¡Œå’Œç»ˆæ­¢ã€‚ ä»»ä½•å…·æœ‰ä¸åŒå¯åŠ¨ã€æ‰§è¡Œæˆ–ç»ˆæ­¢åŸå› çš„è¿›ç¨‹éƒ½åº”è¯¥ä¸å…¶ä»–è¿›ç¨‹åˆ†å¼€ï¼ˆå³ä¸ç´§å¯†è€¦åˆï¼‰ã€‚ å½“æˆ‘ä»¬ç†æ¸…è¿™äº›é—®é¢˜æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å°†å®ƒä»¬è¡¨ç¤ºä¸ºå•ç‹¬çš„å¥åº·æ£€æŸ¥ã€ç­–ç•¥å’Œéƒ¨ç½²é…ç½®ã€‚ ç„¶åæˆ‘ä»¬å¯ä»¥å£°æ˜æ€§åœ°è¡¨è¾¾è¿™äº›å…³æ³¨ç‚¹ï¼Œåœ¨æºä»£ç æ§åˆ¶ä¸­è·Ÿè¸ªå®ƒä»¬ï¼Œå¹¶åœ¨è¯­ä¹‰ä¸Šå¯¹å®ƒä»¬è¿›è¡Œç‰ˆæœ¬æ§åˆ¶ã€‚ è¿™ä½¿æˆ‘ä»¬èƒ½å¤Ÿé¿å…æ­¥è°ƒä¸€è‡´åœ°å‡çº§ï¼Œå¯¼è‡´å°†ä¸åŒçš„åº”ç”¨ç”Ÿå‘½å‘¨æœŸé”å®šåœ¨ä¸€èµ·ã€‚&lt;/p&gt;
&lt;p&gt;ç®¡ç†å®¹å™¨ä¸­å¤šä¸ªåº”ç”¨ç¨‹åºæˆ–è¿›ç¨‹ç±»å‹çš„ç”Ÿå‘½å‘¨æœŸçš„é—®é¢˜æºäºå®ƒä»¬éƒ½æœ‰&lt;a href=&#34;https://cloud.google.com/architecture/best-practices-for-building-container#package_a_single_app_per_container&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä¸åŒçš„çŠ¶æ€&lt;/a&gt;ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨æœ‰ä¸€ä¸ªçˆ¶è¿›ç¨‹å¯åŠ¨ Apacheï¼Œç„¶åè¿˜å¯åŠ¨ Redisï¼Œåˆ™çˆ¶è¿›ç¨‹éœ€è¦çŸ¥é“å¦‚ä½•ä»¥åŠä½•æ—¶å¯åŠ¨ã€ç›‘è§†å’Œç»ˆæ­¢ Apache å’Œ Redisã€‚ å¯¹äºæ‚¨æ— æ³•æ§åˆ¶çš„ä»£ç æˆ–äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ­¤é—®é¢˜ç”šè‡³æ›´åŠ å›°éš¾ï¼Œå› ä¸ºæ‚¨æ— æ³•æ§åˆ¶è¿™äº›åº”ç”¨ç¨‹åºå¦‚ä½•è¡¨è¾¾å…¶å¥åº·çŠ¶å†µã€‚ è¿™å°±æ˜¯ä¸ºä»€ä¹ˆè¡¨è¾¾ç¨‹åºå¥åº·çŠ¶å†µçš„æœ€ä½³ä½ç½®ï¼Œå°¤å…¶æ˜¯æ‚¨æ— æ³•æ§åˆ¶çš„è¿›ç¨‹ï¼Œæ˜¯åœ¨æš´éœ²ç»™å®¹å™¨ç®¡ç†ç³»ç»Ÿæˆ–ç¼–æ’å™¨ï¼ˆä¾‹å¦‚ Kubernetesï¼‰çš„é…ç½®ä¸­ï¼Œå®ƒæ—¨åœ¨é€‚åº”ç”Ÿå‘½å‘¨æœŸè€Œä¸æ˜¯ä¸´æ—¶çš„ bash è„šæœ¬ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å¤šè¿›ç¨‹åŠ å‰§äº‘åŸç”Ÿä¿¡å·å’Œåƒµå°¸é—®é¢˜&#34;&gt;å¤šè¿›ç¨‹åŠ å‰§äº‘åŸç”Ÿä¿¡å·å’Œåƒµå°¸é—®é¢˜&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.phusion.nl/2015/01/20/docker-and-the-pid-1-zombie-reaping-problem/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä¸å¤„ç†æ‰€è°“çš„PID 1&lt;/a&gt; å®¹å™¨ä¸­çš„è¿›ç¨‹å……æ»¡äº†æåº¦éšè”½ã€éš¾ä»¥å¯Ÿè§‰çš„é—®é¢˜ã€‚ å½“æ¶‰åŠå¤šä¸ªè¿›ç¨‹æ—¶ï¼Œè¿™äº›é—®é¢˜ä¼šåŠ å‰§ã€‚ æ­£ç¡®å¤„ç† PID 1 çš„ä¸¤ä¸ªä¸»è¦é—®é¢˜æ˜¯&lt;a href=&#34;https://cloud.google.com/architecture/best-practices-for-building-containers#signal-handling&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¤„ç†ç»ˆæ­¢ä¿¡å·å’Œåƒµå°¸&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;sigterm&#34;&gt;SIGTERM&lt;/h3&gt;
&lt;p&gt;æ‰€æœ‰åº”ç”¨ç¨‹åºå’Œè¿›ç¨‹éƒ½å¿…é¡»çŸ¥é“ä¸¤ç§ç±»å‹çš„å…³æœºï¼šæ­£å¸¸å…³æœºå’Œç«‹å³å…³æœºã€‚ å‡è®¾ä¸€ä¸ªæœ‰çŠ¶æ€åº”ç”¨ç¨‹åºå¸Œæœ›æ‰“å¼€ä¸€ä¸ªé‡è¦æ–‡ä»¶ã€å†™å…¥æ•°æ®å¹¶å…³é—­æ–‡ä»¶è€Œä¸è¢«ä¸­æ–­ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç”±äº K8s çš„æŠ¢å åŠŸèƒ½ï¼Œåº”ç”¨ç¨‹åºæœ€ç»ˆä¼šç ´åæ–‡ä»¶ã€‚å¤„ç†æ­¤ç±»é—®é¢˜çš„ä¸€ç§æ–¹æ³•æ˜¯æ­£å¸¸å…³é—­ã€‚ è¿™å°±æ˜¯ SIGTERM ä¿¡å·çš„ä½œç”¨ã€‚ å®ƒå‘Šè¯‰åº”ç”¨ç¨‹åºå®ƒå°†è¢«å…³é—­å¹¶å¼€å§‹æ­£å¸¸è¿è¡Œä»¥é¿å…æŸåæˆ–å…¶ä»–é”™è¯¯ã€‚ åœ¨ç¼–æ’ç³»ç»Ÿä¸­ï¼Œæ‰€æœ‰è¿›ç¨‹éƒ½åº”è®¾è®¡ä¸ºåœ¨éœ€è¦æ—¶å¤„ç†æ­£å¸¸å…³é—­ã€‚ ä½†æ˜¯å¯åŠ¨å…¶ä»–è¿›ç¨‹çš„è¿›ç¨‹å‘¢ï¼Ÿ ä¸ºäº†å¤„ç†å­è¿›ç¨‹çš„æ­£å¸¸ç»ˆæ­¢ï¼Œçˆ¶è¿›ç¨‹éœ€è¦å‘æ‰€æœ‰å­è¿›ç¨‹ä¼ é€’ SIGTERM ä¿¡å·ï¼Œè®©å®ƒä»¬ä¹Ÿæ­£å¸¸å…³é—­ã€‚ è¿™å°±æ˜¯ PID 1 å¤„ç†ä¸å½“çš„é—®é¢˜æ‰€åœ¨ã€‚ é™¤éæ˜ç¡®å‘ŠçŸ¥ï¼Œå¦åˆ™åƒ bash è¿™æ ·çš„ç®€å•è„šæœ¬ä¸ä¼šå°† SIGTERM ä¿¡å·ä¼ é€’ç»™å®ƒä»¬å¯åŠ¨çš„è¿›ç¨‹ã€‚ å¦‚æœæ‚¨ä¸é€šè¿‡ SIGTERMï¼Œå°†äº§ç”Ÿéå¸¸éš¾ä»¥æ£€æµ‹çš„é”™è¯¯ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä¸€ä¸ªéšè”½çš„-sigterm-é”™è¯¯ç¤ºä¾‹&#34;&gt;ä¸€ä¸ªéšè”½çš„ SIGTERM é”™è¯¯ç¤ºä¾‹&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://about.gitlab.com/blog/2022/05/17/how-we-removed-all-502-errors-by-caring-about-pid-1-in-kubernetes/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Gitlab è®°å½•&lt;/a&gt;ä»–ä»¬é‡åˆ°äº†ä¸€ä¸ªé—®é¢˜ï¼Œå³é¡µé¢ä¸Šä¼šå‡ºç° 502 é”™è¯¯ï¼Œä½†åœ¨ä¸€å®šæ—¶é—´åç¥ç§˜åœ°è‡ªè¡Œä¿®å¤ã€‚ é—®é¢˜æ˜¯å› ä¸ºå‰é¢æåˆ°çš„æ­£å¸¸ç»ˆæ­¢ä¿¡å· (SIGTERM) æ²¡æœ‰è¢«å‘é€åˆ°åœ¨é¡µé¢æœåŠ¡èµ„æºè¢«åˆ é™¤åæ‰“å¼€è¿æ¥çš„å­è¿›ç¨‹ã€‚ ä¼—æ‰€å‘¨çŸ¥ï¼Œè¿™ä¸ªé—®é¢˜å¾ˆéš¾è¿½è¸ªã€‚&lt;/p&gt;
&lt;h3 id=&#34;åƒµå°¸è¿›ç¨‹&#34;&gt;åƒµå°¸è¿›ç¨‹&lt;/h3&gt;
&lt;p&gt;å®¹å™¨ä¸­çš„&lt;a href=&#34;https://en.m.wikipedia.org/wiki/Process_identifier&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;PID 1è¿›ç¨‹&lt;/a&gt;ä¹Ÿä¼šåœ¨å­è¿›ç¨‹ç»ˆæ­¢åæ¸…ç†å®ƒä»¬ã€‚ è¿™çœ‹èµ·æ¥å¾ˆç®€å•ï¼Œä½†é»˜è®¤æƒ…å†µä¸‹ PID 1 bash è„šæœ¬æ— æ³•æ­£ç¡®æ¸…ç†ã€‚ ä¸æ¸…ç†æˆ–æ”¶å‰²å­è¿›ç¨‹æ„å‘³ç€ä»€ä¹ˆï¼Ÿ è¿™äº›ä¸å¹²å‡€çš„è¿›ç¨‹ï¼Œä¹Ÿç§°ä¸ºåƒµå°¸è¿›ç¨‹ï¼Œå¡«æ»¡äº†æ‰€è°“çš„è¿›ç¨‹è¡¨ã€‚ å®ƒä»¬æœ€ç»ˆä¼šé˜»æ­¢æ‚¨å¯åŠ¨æ–°è¿›ç¨‹ï¼Œä»è€Œé˜»æ­¢æ‚¨çš„æ•´ä¸ªèŠ‚ç‚¹è¿è¡Œã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä¸€ä¸ªåˆé€‚çš„åˆå§‹åŒ–ç³»ç»Ÿæ¥å¤„ç†åƒµå°¸å’Œä¿¡å·&#34;&gt;ä¸€ä¸ªåˆé€‚çš„åˆå§‹åŒ–ç³»ç»Ÿæ¥å¤„ç†åƒµå°¸å’Œä¿¡å·&lt;/h3&gt;
&lt;p&gt;é™åˆ¶åƒµå°¸è¿›ç¨‹å½±å“çš„ä¸€ç§æ–¹æ³•æ˜¯æ‹¥æœ‰ä¸€ä¸ª&lt;a href=&#34;https://ahmet.im/blog/minimal-init-process-for-containers/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;é€‚å½“çš„åˆå§‹åŒ–ç³»ç»Ÿ&lt;/a&gt;ã€‚ å¦‚æœæ‚¨æ­£åœ¨è€ƒè™‘ä½¿ç”¨æ‚¨æ— æ³•æ§åˆ¶çš„ä»£ç ï¼ˆä¾‹å¦‚ Postgres æ•°æ®åº“ï¼‰è¿è¡Œ PID 1 è¿›ç¨‹ï¼Œåˆ™å°¤å…¶å¦‚æ­¤ã€‚ è¿™ä¸ªè¿›ç¨‹å¯èƒ½ä¼šå¯åŠ¨å…¶ä»–è¿›ç¨‹ï¼Œç„¶åå¿˜è®°æ”¶å‰²å®ƒä»¬ã€‚ ä½¿ç”¨é€‚å½“çš„ init ç³»ç»Ÿï¼Œä»»ä½•ç»ˆæ­¢çš„å­è¿›ç¨‹æœ€ç»ˆéƒ½ä¼šè¢« init ç³»ç»Ÿå›æ”¶ã€‚&lt;/p&gt;
&lt;p&gt;æ‚¨å¯ä»¥åœ¨å®¹å™¨å†…è¿è¡Œé€‚å½“çš„åˆå§‹åŒ–ç³»ç»Ÿå’Œå¤æ‚çš„ç›‘ç£ç¨‹åºã€‚ ç›‘ç£ç¨‹åºæœ‰æ—¶å€™è¢«è®¤ä¸ºæ˜¯çŸ«æ‰è¿‡æ­£ï¼Œå› ä¸ºå®ƒä»¬å ç”¨äº†å¤ªå¤šèµ„æºï¼Œè€Œä¸”æœ‰æ—¶è¿‡äºå¤æ‚ã€‚ å¤æ‚ç›‘ç®¡ç¨‹åºæœ‰ supervisordã€monit å’Œ runitã€‚ é€‚å½“çš„ init ç³»ç»Ÿæ¯”å¤æ‚çš„ç›‘ç®¡ç¨‹åºå°ï¼Œå› æ­¤é€‚ç”¨äºå®¹å™¨ã€‚ åˆé€‚çš„å®¹å™¨åˆå§‹åŒ–ç³»ç»Ÿæœ‰ tiniã€dumb-init å’Œ s6-overlayã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ€§èƒ½å’Œäº‘åŸç”Ÿç”µä¿¡è¿›ç¨‹&#34;&gt;æ€§èƒ½å’Œäº‘åŸç”Ÿç”µä¿¡è¿›ç¨‹&lt;/h2&gt;
&lt;p&gt;åœ¨å®¹å™¨ä¸­è¿è¡Œå¤šä¸ªè¿›ç¨‹çš„ä¸»è¦åŠ¨æœºä¹‹ä¸€æ˜¯å¯¹æ€§èƒ½çš„æ¸´æœ›ã€‚ åœ¨å•ç‹¬çš„å®¹å™¨ä¸­è€Œä¸æ˜¯åœ¨åŒä¸€ä¸ªå®¹å™¨ä¸­è¿è¡Œè¿›ç¨‹ï¼ˆå‡è®¾è¿›ç¨‹é—´é€šä¿¡æ˜¯ç›¸åŒçš„ï¼‰ä¼¼ä¹ä¼šé™ä½æ€§èƒ½ã€‚ è¿™ç§&lt;a href=&#34;https://pythonspeed.com/articles/docker-performance-overhead/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ€§èƒ½ä¸‹é™å¯å½’å› äº&lt;/a&gt; å®¹å™¨ç³»ç»Ÿä¸­å†…ç½®çš„éš”ç¦»å’Œå®‰å…¨æªæ–½ã€‚ ä¹Ÿå¯ä»¥é€šè¿‡åœ¨ç‰¹æƒæ¨¡å¼ä¸‹è¿è¡Œå®¹å™¨æ¥åˆ é™¤å®ƒï¼Œä½†è¿™ä¼šé™ä½å®‰å…¨æ€§ã€‚&lt;/p&gt;
&lt;p&gt;äººä»¬å¯¹å°†è¿›ç¨‹åˆ†ç¦»åˆ°å¤šä¸ªå®¹å™¨ä¸­å­˜åœ¨ä¸€ç§è¯¯è§£ï¼Œé‚£å°±æ˜¯æ‰€æœ‰é€šä¿¡çš„æ€§èƒ½éƒ½ä¼šå—åˆ°å½±å“ï¼Œå› ä¸ºå®ƒå¿…é¡»é€šè¿‡ TCP æˆ–æ›´ç³Ÿç³•çš„ HTTP è¿›è¡Œã€‚ è¿™ä¸å¤ªå¯¹ã€‚ é€šè¿‡&lt;a href=&#34;https://dev.to/douglassakey/a-simple-example-of-using-unix-domain-socket-in-kubernetes-1fga&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä½¿ç”¨ unix åŸŸå¥—æ¥å­—è¿›è¡Œé€šä¿¡&lt;/a&gt;ã€‚ è¿™å¯ä»¥åœ¨ Kubernetes ä¸­é€šè¿‡ä½¿ç”¨åœ¨ pod å†…çš„æ‰€æœ‰å®¹å™¨ä¹‹é—´å…±äº«çš„å·æŒ‚è½½æ¥é…ç½®ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ç”µä¿¡ç¯å¢ƒä¸­ï¼Œæ•°æ®å¹³é¢çš„æ ¸å¿ƒå…³æ³¨ç‚¹æ˜¯æ€§èƒ½ï¼Œå› æ­¤ä½¿ç”¨çº¿ç¨‹ã€å…±äº«å†…å­˜å’Œè¿›ç¨‹é—´é€šä¿¡æ¥æé«˜æ€§èƒ½ã€‚ å½“è¿™äº›é—®é¢˜å¯†åˆ‡ç›¸å…³æ—¶ï¼Œå®ƒä¼šå› ä¸ºå¤æ‚æ€§è€Œå¢åŠ ã€‚ åœ¨ä¸åŒå®¹å™¨ä¹‹é—´ä½†åœ¨åŒä¸€ä¸ª pod ä¸­å®ç°çš„è¿›ç¨‹é—´é€šä¿¡åº”è¯¥æœ‰æ‰€å¸®åŠ©ã€‚ ç”µä¿¡æ§åˆ¶å¹³é¢é€šå¸¸éœ€è¦è¾ƒä½çš„æ€§èƒ½ï¼Œå› æ­¤å¯ä»¥è®¾è®¡ä¸ºé—ç•™åº”ç”¨ç¨‹åº&lt;/p&gt;
&lt;h2 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;ä¸ºäº†è·å¾—äº‘åŸç”Ÿç”Ÿæ€ç³»ç»Ÿçš„æœ€å¤§äº’æ“ä½œæ€§å’Œå¯å‡çº§æ€§ä¼˜åŠ¿ï¼Œç”µä¿¡è¡Œä¸šéœ€è¦éµå®ˆå®¹å™¨å’Œéƒ¨ç½²çš„å•ä¸€ç„¦ç‚¹è§„åˆ™ã€‚ èƒ½å¤Ÿåšåˆ°è¿™ä¸€ç‚¹çš„ä¾›åº”å•†å°†æ¯”ä¸èƒ½åšåˆ°è¿™ä¸€ç‚¹çš„ä¾›åº”å•†æ›´å…·ç«äº‰ä¼˜åŠ¿ã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;è¦äº†è§£æ›´å¤šäº‘åŸç”ŸåŸç†ï¼Œè¯·åŠ å…¥ CNCF çš„äº‘åŸç”Ÿ&lt;a href=&#34;https://github.com/cncf/cnf-wg&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç½‘ç»œåŠŸèƒ½å·¥ä½œç»„&lt;/a&gt;ã€‚æœ‰å…³ CNCF çš„ CNF è®¤è¯è®¡åˆ’çš„ä¿¡æ¯ï¼Œè¯¥è®¡åˆ’&lt;a href=&#34;https://www.cncf.io/certification/cnf/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;éªŒè¯æ‚¨ç½‘ç»œåŠŸèƒ½ä¸­çš„äº‘åŸç”Ÿæœ€ä½³å®è·µ&lt;/a&gt;ã€‚&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;ç‰¹åˆ«æ„Ÿè°¢ Denver Williams å¯¹æœ¬æ–‡çš„æŠ€æœ¯å®¡é˜…ã€‚&lt;/em&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Envoy Gateway 0.3 å‘å¸ƒâ€”â€”æ‰©å±• Kubernetes Gateway API</title>
      <link>https://lib.jimmysong.io/blog/envoy-gateways-latest-v0-3-release-extends-the-kubernetes-gateway-api/</link>
      <pubDate>Tue, 28 Feb 2023 11:20:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/envoy-gateways-latest-v0-3-release-extends-the-kubernetes-gateway-api/</guid>
      <description>&lt;p&gt;&lt;a href=&#34;https://github.com/envoyproxy/gateway&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Envoy Gateway&lt;/a&gt; (EG)&lt;a href=&#34;https://tetrate.io/blog/gateway-to-the-future-the-new-gateway-api-and-envoy-gateway-0-2/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;é¦–æ¬¡å…¬å¼€å‘å¸ƒ&lt;/a&gt; å››ä¸ªæœˆåï¼Œæˆ‘ä»¬å¾ˆé«˜å…´åœ°å®£å¸ƒå‘å¸ƒ &lt;a href=&#34;https://github.com/envoyproxy/gateway/releases/tag/v0.3.0&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç‰ˆæœ¬ 0.3&lt;/a&gt; èµ·ã€‚ è¿™ä¸ªæœ€æ–°ç‰ˆæœ¬æ˜¯å‡ ä½ Tetrate åŒäº‹å’Œæ•´ä¸ªç¤¾åŒºå…¶ä»–äººè¾›å‹¤å·¥ä½œçš„ç»“æ™¶ã€‚ Envoy Gateway ç°åœ¨æ”¯æŒæ•´ä¸ª &lt;a href=&#34;https://gateway-api.sigs.k8s.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Kubernetes Gateway API&lt;/a&gt;ï¼ŒåŒ…æ‹¬å®éªŒéƒ¨åˆ†â€”â€”æ·»åŠ äº†ä¸€äº›å¼ºå¤§çš„æ–°åŠŸèƒ½ï¼Œä½¿è¿™ä¸ªå…è´¹çš„å¼€æºè½¯ä»¶æ›´æ¥è¿‘äºåŠŸèƒ½é½å…¨çš„ API ç½‘å…³ã€‚&lt;/p&gt;
&lt;p&gt;EG çš„ä¸€å¤§ç‰¹ç‚¹æ˜¯å®ƒé…ç½®äº†æ–°çš„ç½‘å…³ APIï¼Œè€Œä¸æ˜¯æ—§çš„å’Œéå¸¸æœ‰é™çš„ &lt;a href=&#34;https://kubernetes.io/docs/concepts/services-networking/ingress/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Ingress API&lt;/a&gt;ï¼Œæˆ–ä»»ä½•ä¸ºäº†å¼¥è¡¥ Ingress ç¼ºé™·çš„ä¸“æœ‰ APIã€‚è™½ç„¶ EG 0.2 å®ç°äº† Gateway API çš„æ ¸å¿ƒéƒ¨åˆ†ï¼ˆå®Œå…¨æ”¯æŒâ€œåŸºæœ¬â€HTTP è·¯ç”±ï¼‰ï¼Œä½† EG 0.3 åœ¨å…¶ Gateway API æ”¯æŒæ–¹é¢æ›´è¿›äº†ä¸€æ­¥ï¼Œè¿™å¯èƒ½æ˜¯äº†è§£å…¶æ–°åŠŸèƒ½çš„æœ€ä½³æ–¹å¼ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ”¯æŒæ›´å¤šHTTPåŠŸèƒ½ï¼Œä¾‹å¦‚&lt;a href=&#34;https://gateway.envoyproxy.io/v0.3.0/user/http-urlrewrite.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;URL Rewrite&lt;/a&gt;ã€&lt;a href=&#34;https://gateway.envoyproxy.io/v0.3.0/user/http-response-headers.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Response Header Operation&lt;/a&gt; å’Œæµé‡é•œåƒã€‚ è¿™äº›æ¥è‡ª API è§„èŒƒä¸­çš„æ‰©å±•å­—æ®µã€‚&lt;/li&gt;
&lt;li&gt;æ”¯æŒè·¯ç”± &lt;a href=&#34;https://gateway.envoyproxy.io/v0.3.0/user/grpc-routing.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;gRPC&lt;/a&gt;ã€&lt;a href=&#34;https://gateway.envoyproxy.io/v0.3.0/user/udp-routing.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;UDP&lt;/a&gt; å’ŒåŸå§‹ &lt;a href=&#34;https://gateway.envoyproxy.io/v0.3.0/user/tcp-routing.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;TCP&lt;/a&gt;ã€‚ è¿™äº›æ¥è‡ª API çš„å®éªŒæ€§æ–°éƒ¨åˆ†ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¯·æ³¨æ„è¿™äº› API æ‰©å±•ï¼šæˆ‘ä»¬æ­£åœ¨åŠªåŠ›ä¸ºçœŸå®ç”¨æˆ·æä¾›æœ‰ç”¨çš„åŠŸèƒ½ã€‚ &lt;a href=&#34;https://github.com/kubernetes/community/tree/master/sig-network&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SIG-NETWORK COMMUNITY&lt;/a&gt; ä½œä¸ºè´Ÿè´£ç½‘å…³ API è§„èŒƒçš„äººå‘˜ï¼Œæœ‰è´Ÿè´£ä¿æŠ¤ APIï¼Œå› æ­¤ä»–ä»¬çš„å·¥ä½œéœ€è¦ä¸€äº›å®è·µã€‚ ä½œä¸ºå®æ–½è€…ï¼Œæˆ‘ä»¬æœ‰æ›´å¤šçš„è‡ªç”±åœ¨å…·ä½“è§„èŒƒä¹‹å‰å¼€è¾Ÿä¸€æ¡é“è·¯â€”â€”ä½†æˆ‘ä»¬å·²ç»åœ¨ä¸Šæ¸¸å·¥ä½œä»¥æ ‡å‡†åŒ–è¿™äº›æ‰©å±•ã€‚ è¿™ç§åœ¨å·¥ä½œå®æ–½ä¸­å¯¹æ–°åŠŸèƒ½è¿›è¡Œçš„å®éªŒæ˜¯è®©ä»»ä½•å›¢ä½“æ¥å—æè®®çš„æ–° API çš„é‡è¦ä¸€æ­¥â€”â€”å®ƒå¯¹æ¯ä¸ªäººéƒ½æœ‰å¥½å¤„ã€‚&lt;/p&gt;
&lt;p&gt;è¿™äº›ä»¤äººå…´å¥‹çš„æ–°åŠŸèƒ½ç¡®å®ä½¿ Envoy Gateway é¡¹ç›®è¶…è¶Šäº†äººä»¬çš„å¥½å¥‡å¿ƒï¼Œå¯ä»¥ä¸ºè®¸å¤šç°å®ä¸–ç•Œçš„ç”¨ä¾‹æä¾›æœåŠ¡ã€‚ é‡è¦çš„æ˜¯ï¼Œå®ƒèƒ½å¤Ÿæä¾›æ‰€æœ‰è¿™äº›ï¼ŒåŒæ—¶åŸºäºå¼€æ”¾æ ‡å‡† API å¹¶ä¸”æ˜¯å…è´¹å’Œå¼€æºè½¯ä»¶ï¼Œæ²¡æœ‰ä»˜è´¹å±‚ã€‚&lt;/p&gt;
&lt;p&gt;è‡ªå·±è¯•ç”¨ Envoy Gateway 0.3 éå¸¸ç®€å•ï¼Œåªéœ€è½¬åˆ° &lt;a href=&#34;https://gateway.envoyproxy.io/v0.3.0/user/quickstart.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¿«é€Ÿå…¥é—¨æŒ‡å—&lt;/a&gt; å³å¯å¼€å§‹ï¼ å¦‚æœæ‚¨æƒ³æ›´æ·±å…¥åœ°äº†è§£å¦‚ä½•ä½¿ç”¨ &lt;em&gt;minikube&lt;/em&gt; åœ¨æœ¬åœ°è¿›è¡Œå°è¯•ï¼Œå¤§å¤šæ•° &lt;a href=&#34;https://tetrate.io/blog/hands-on-with-the-gateway-api-using-envoy-gateway-0-2/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;EG 0.2 åŠ¨æ‰‹æŒ‡å—&lt;/a&gt; ä»ç„¶æœ‰æ•ˆã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼šäº”ç§å¸¸è§çš„æˆæƒæ¨¡å‹</title>
      <link>https://lib.jimmysong.io/blog/role-based-access-control-five-common-authorization-patterns/</link>
      <pubDate>Fri, 24 Feb 2023 15:20:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/role-based-access-control-five-common-authorization-patterns/</guid>
      <description>&lt;p&gt;æˆ‘ä»¬ä»æœ€ç®€å•çš„åŸºäº IDP çš„ RBAC å¼€å§‹ï¼Œæœ€ç»ˆå°†åŸºäºç»„çš„ RBAC ä¸ç»†ç²’åº¦çš„æƒé™å’Œç»†ç²’åº¦çš„èµ„æºç›¸ç»“åˆã€‚&lt;/p&gt;
&lt;p&gt;æˆæƒå¾ˆå¤æ‚ï¼Œå› ä¸ºæ¯ä¸ªåº”ç”¨ç¨‹åºéƒ½å¿…é¡»å‘æ˜è‡ªå·±çš„æˆæƒæ¨¡å‹ã€‚ä½†æ˜¯ï¼Œæœ‰ä¸€äº›é™ˆæ—§çš„è·¯å¾„å¯ä»¥ä½œä¸ºå¤§å¤šæ•°åº”ç”¨ç¨‹åºçš„è‰¯å¥½èµ·ç‚¹ã€‚è¿™ç¯‡æ–‡ç« å°†æè¿°è¿™äº›æ¨¡å¼ä»¥åŠ &lt;a href=&#34;https://topaz.sh/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Topaz&lt;/a&gt; å¼€æºé¡¹ç›®æˆ– &lt;a href=&#34;https://www.aserto.com/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Aserto&lt;/a&gt; æˆæƒæœåŠ¡ç­‰æˆæƒå¹³å°å¦‚ä½•å¸®åŠ©ä½ å®æ–½ä»–ä»¬ã€‚&lt;/p&gt;
&lt;h2 id=&#34;è§’è‰²ä½œä¸ºç”¨æˆ·å±æ€§&#34;&gt;è§’è‰²ä½œä¸ºç”¨æˆ·å±æ€§&lt;/h2&gt;
&lt;p&gt;æœ€ç®€å•çš„æˆæƒæ¨¡å¼å°†ä¸€ç»„è§’è‰²å»ºæ¨¡ä¸ºç”¨æˆ·çš„å±æ€§ã€‚è¿™äº›è§’è‰²å¯ä»¥åœ¨èº«ä»½æä¾›è€… (IDP) ä¸­é…ç½®ï¼Œå¹¶ä¸”é€šå¸¸ä½œä¸ºèŒƒå›´åµŒå…¥åˆ° IDP ç”Ÿæˆçš„è®¿é—®ä»¤ç‰Œä¸­ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€äº›åº”ç”¨ç¨‹åºå®Œå…¨åŸºäºåµŒå…¥åœ¨è®¿é—®ä»¤ç‰Œä¸­çš„è§’è‰²ï¼ˆæˆ–ç¦»æ•£æƒé™ï¼‰è¿›è¡Œæˆæƒã€‚ä½†è¿™æœ‰ä¸€äº›&lt;a href=&#34;https://www.aserto.com/blog/oauth2-scopes-are-not-permissions&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç¼ºç‚¹&lt;/a&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è§’è‰²/æƒé™/èŒƒå›´çˆ†ç‚¸&lt;/strong&gt;ï¼šè§’è‰²/æƒé™è¶Šå¤šï¼Œè®¿é—®ä»¤ç‰Œä¸­éœ€è¦åµŒå…¥çš„èŒƒå›´å°±è¶Šå¤šï¼Œä»è€Œå¯¼è‡´å¤§å°é—®é¢˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;IDP å’Œåº”ç”¨ç¨‹åºä¹‹é—´çš„è€¦åˆ&lt;/strong&gt;ï¼šæ¯å½“å‘åº”ç”¨ç¨‹åºæ·»åŠ æ–°æƒé™æ—¶ï¼Œä¹Ÿå¿…é¡»ä¿®æ”¹è®¿é—®ä»¤ç‰Œä¸­ç”Ÿæˆå…¶ä»–èŒƒå›´çš„ä»£ç ã€‚è¿™é€šå¸¸ç”±æœ‰æƒè®¿é—® IDP çš„å®‰å…¨/èº«ä»½å’Œè®¿é—®å›¢é˜Ÿå®Œæˆï¼Œå¹¶ä¸”å®ƒå¼•å…¥äº†å·¥ä½œæµç¨‹çš„å¤æ‚æ€§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¸€æ—¦å‘å¸ƒ&lt;/strong&gt;ï¼Œè®¿é—®ä»¤ç‰Œå°±å¾ˆéš¾å¤±æ•ˆã€‚åªè¦è®¿é—®ä»¤ç‰Œæœ‰æ•ˆï¼Œç»è¿‡èº«ä»½éªŒè¯çš„ç”¨æˆ·å°±æ‹¥æœ‰æƒé™ï¼Œå³ä½¿ä»–ä»¬çš„è§’è‰²åœ¨ä»¤ç‰Œé¢å‘åå‘ç”Ÿäº†å˜åŒ–ã€‚è¿™åè¿‡æ¥åˆä¼šå¯¼è‡´å®‰å…¨æ¼æ´ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½¿ç”¨ Topaz ç­‰æˆæƒæœåŠ¡å…·æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ·»åŠ äº†ä¸€ä¸ªæ˜ç¡®çš„æˆæƒç³»ç»Ÿï¼Œè®©åº”ç”¨ç¨‹åºå®æ—¶æ£€æŸ¥ç”¨æˆ·æ˜¯å¦ä»ç„¶æ‹¥æœ‰è¯¥è§’è‰²æˆ–æƒé™ã€‚&lt;/li&gt;
&lt;li&gt;æˆæƒä»£ç å¯ä»¥ä»åº”ç”¨ç¨‹åºä¸­æå–å¹¶è¡¨ç¤ºä¸ºç­–ç•¥ã€‚è¿™ä½¿å¾—åœ¨æ•´ä¸ªåº”ç”¨ç¨‹åºä¸­æ›´å®¹æ˜“æ¨ç†æˆæƒé€»è¾‘ã€‚&lt;/li&gt;
&lt;li&gt;æ¯ä¸ª API å¯ä»¥æœ‰ä¸åŒçš„æˆæƒç­–ç•¥ï¼Œå…¶ä¸­åŒ…å«æˆæƒæ“ä½œçš„é€»è¾‘ã€‚ä¸€ä¸ªç¤ºä¾‹ç­–ç•¥å¯ä»¥æ˜¯â€œå¦‚æœç”¨æˆ·å…·æœ‰â€˜ç®¡ç†å‘˜â€™æˆ–â€˜ç¼–è¾‘è€…â€™è§’è‰²ï¼Œæˆ–è€…â€˜åˆ›å»ºâ€™æƒé™ï¼Œåˆ™å…è®¸è¯¥æ“ä½œã€‚â€&lt;/li&gt;
&lt;li&gt;ä»»ä½•è§’è‰²æ›´æ”¹ï¼ˆæˆ–ç”¨æˆ·å…¨å±€â€œç¦ç”¨â€æ ‡å¿—çš„å€¼ï¼‰éƒ½å¯ä»¥è¿‘ä¹å®æ—¶åœ°ä¼ è¾“åˆ°æˆæƒç³»ç»Ÿã€‚è¿™è§£å†³äº†ä¸ç›²ç›®ä¿¡ä»»è®¿é—®ä»¤ç‰Œä¸­åµŒå…¥çš„èŒƒå›´ç›¸å…³çš„å®‰å…¨é—®é¢˜ã€‚&lt;/li&gt;
&lt;li&gt;è§’è‰²åˆ°æƒé™çš„æ˜ å°„å¯ä»¥åœ¨æˆæƒç³»ç»Ÿä¸­å®Œæˆã€‚å› æ­¤ï¼ŒIDP åªéœ€è¦çŸ¥é“ç”¨æˆ·åˆ°è§’è‰²çš„æ˜ å°„ï¼Œè€Œä¸éœ€è¦çŸ¥é“æƒé™ã€‚è¿™æœ‰åŠ©äºå°†åº”ç”¨ç¨‹åºä¸ IDP åˆ†ç¦»ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;åŸºäºç»„çš„-rbac&#34;&gt;åŸºäºç»„çš„ RBAC&lt;/h2&gt;
&lt;p&gt;ä¸‹ä¸€ä¸ªæ¨¡å¼ä¾èµ–ç»„ï¼ˆå’Œç»„å±‚æ¬¡ç»“æ„ï¼‰ä½œä¸ºç»„ç»‡ç”¨æˆ·ã€‚&lt;/p&gt;
&lt;p&gt;é€šå¸¸é€šè¿‡ä½¿ç”¨æˆ·æˆä¸ºç»„çš„æˆå‘˜æ¥åˆ†é…è¿™äº›è§’è‰²ã€‚ç»„æˆå‘˜èº«ä»½æ„å‘³ç€ç”¨æˆ·å·²è¢«æˆäºˆè§’è‰²ã€‚ç»„å¯ä»¥ç»„ç»‡æˆå±‚æ¬¡ç»“æ„ã€‚ä¾‹å¦‚ï¼Œâ€œauditorâ€ç»„å¯ä»¥åŒ…æ‹¬â€œinternal-auditorsâ€å’Œâ€œexternal-auditorsâ€ã€‚è¿™ä¸¤ä¸ªç»„åˆå¯ä»¥åŒ…æ‹¬ç‰¹å®šç”¨æˆ·ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æœ¬è´¨ä¸Šæ˜¯ LDAP å’Œ Active Directory æ‰€å›´ç»•çš„æ¨¡å‹ã€‚å› æ­¤ï¼Œå¤§å¤šæ•°æˆæƒç³»ç»Ÿéƒ½æ”¯æŒå°†ç»„ä½œä¸ºå…¶æ¨¡å‹çš„æ ¸å¿ƒéƒ¨åˆ†ã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼ŒTopaz å’Œ Aserto æœ‰ä¸€ä¸ªå†…ç½®çš„â€œç»„â€å¯¹è±¡ç±»å‹ã€‚ç»„å¯¹è±¡ç±»å‹å…·æœ‰â€œæˆå‘˜â€å…³ç³»ç±»å‹ï¼Œå…¶ç›®æ ‡å¯ä»¥æ˜¯ä»»ä½•ä¸»ä½“ï¼ˆç”¨æˆ·æˆ–ç»„ï¼‰ã€‚æ­¤æ¨¡å‹å…è®¸ä¸€ä¸ªç»„åŒ…å«åœ¨å…¶ä»–ç»„ä¸­ã€‚æ£€æŸ¥ç»„æˆå‘˜èµ„æ ¼æ˜¯ä¼ é€’æ€§çš„ï¼šå½“ä½¿ç”¨ç”¨æˆ·å’Œç»„å®ä¾‹è°ƒç”¨ Topaz çš„ check_relation å†…ç½®å‡½æ•°æ—¶ï¼Œå®ƒå°†éå†ç»„å±‚æ¬¡ç»“æ„å¹¶ç›´æ¥æˆ–ä¼ é€’åœ°è¿”å› trueï¼Œå¦‚æœç”¨æˆ·æ˜¯ç»„çš„æˆå‘˜ã€‚&lt;/p&gt;
&lt;p&gt;ä»¥ä¸‹ç­–ç•¥ï¼ˆç”¨ Open Policy Agent çš„ &lt;a href=&#34;https://www.openpolicyagent.org/docs/latest/policy-language/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Rego&lt;/a&gt; è¯­è¨€ç¼–å†™ï¼‰ä½¿ç”¨ Topaz çš„å†…ç½® check_relation æ¥è¯„ä¼°ç”¨æˆ·æ˜¯å¦æ˜¯ä¸€ä¸ªç»„å¹¶å…è®¸è¡ŒåŠ¨ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;allowed&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;n&#34;&gt;ds&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;check_relation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;({&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;subject&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;id&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;input&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;user&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;id&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;relation&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;object_type&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;group&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;member&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;object&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;s2&#34;&gt;&amp;#34;type&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;group&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;s2&#34;&gt;&amp;#34;key&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;input&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;resource&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;})&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç”±äºå¯ä»¥é€šè¿‡å¤šä¸ªè§’è‰²æˆäºˆæƒé™ï¼Œå› æ­¤ç­–ç•¥å¯èƒ½éœ€è¦æ£€æŸ¥æ¯ä¸ªç›¸åº”ç»„çš„ç»„æˆå‘˜èµ„æ ¼ã€‚ä¾‹å¦‚ï¼Œå¦‚æœç”¨æˆ·æ˜¯ä»»ä½• Viewersã€Editors æˆ– Administrators ç»„çš„æˆå‘˜ï¼Œåˆ™å¯ä»¥æˆäºˆ Can View æƒé™ã€‚è¿™å°†é€šè¿‡ä»¥ä¸‹ç­–ç•¥å®ç°ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;groups&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;viewer&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;editor&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;admin&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;allowed&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;n&#34;&gt;ds&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;check_relation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;({&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;subject&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;id&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;input&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;user&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;id&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;relation&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;object_type&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;group&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;member&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;object&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;type&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;group&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;key&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;groups&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;_&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;})&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä½†è¿™å¯èƒ½ä¼šå˜å¾—å¤æ‚ï¼Œå¹¶ä¸”å¯ä»¥è¯´å®ƒåªæ˜¯å°†å¤æ‚æ€§ä»åº”ç”¨ç¨‹åºé€»è¾‘è½¬ç§»åˆ°äº†ç­–ç•¥ä¸Šã€‚ä¸‹ä¸€ä¸ªæ¨¡å¼æ—¨åœ¨è§£å†³è¿™ä¸ªé—®é¢˜ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å…·æœ‰ç»†ç²’åº¦æƒé™çš„åŸºäºç»„çš„-rbac&#34;&gt;å…·æœ‰ç»†ç²’åº¦æƒé™çš„åŸºäºç»„çš„ RBAC&lt;/h2&gt;
&lt;p&gt;RBAC ä»£è¡¨åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ã€‚æƒé™å¯ä»¥åŒ…å«åœ¨å¤šä¸ªè§’è‰²ä¸­ã€‚åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œå¯ä»¥æŸ¥çœ‹æƒé™å¯èƒ½åŒ…å«åœ¨æŸ¥çœ‹è€…ã€ç¼–è¾‘è€…å’Œç®¡ç†å‘˜è§’è‰²ä¸­ã€‚æ›´å…·å¯æ‰©å±•æ€§çš„æˆæƒç³»ç»Ÿå°†å®šä¹‰ä¸€ç»„ç¦»æ•£çš„æƒé™å¹¶å°†è¿™äº›æƒé™åˆ†é…ç»™è§’è‰²ã€‚&lt;/p&gt;
&lt;p&gt;æˆæƒç³»ç»Ÿé€šå¸¸å°†æƒé™å®šä¹‰ä¸ºä¸€çº§çš„æ¦‚å¿µã€‚ç­–ç•¥å¯ä»¥æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å…·æœ‰æƒé™ï¼Œè€Œä¸æ˜¯æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æ˜¯ç»„çš„æˆå‘˜ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢çš„ Aserto æ¸…å•æ–‡ä»¶å°±æ˜¯è¿™æ ·åšçš„ã€‚å®ƒå®šä¹‰äº†ä¸€ä¸ªâ€œç³»ç»Ÿâ€å¯¹è±¡ç±»å‹ï¼Œå…¶ä¸‹æœ‰ä¸¤ç§å…³ç³»ç±»å‹ï¼šâ€œeditorâ€å’Œâ€œviewerâ€ã€‚â€œeditorâ€å…³ç³»ç±»å‹åŒ…æ‹¬â€œviewerâ€å…³ç³»ç±»å‹çš„æ‰€æœ‰æƒé™ï¼ŒåŠ ä¸Š can-edit æƒé™ã€‚æŸ¥çœ‹è€…å…³ç³»ç±»å‹åŒ…å«ä¸€ç§æƒé™ï¼šcan-viewã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;system&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;editor&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;union&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;viewer&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;permissions&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;can-edit&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;viewer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;permissions&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;can-view&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¦‚æœç”¨æˆ·ï¼ˆæˆ–ç»„ï¼‰å…·æœ‰â€œeditorâ€è§’è‰²ï¼ŒTopaz å†…ç½®çš„ check_permission ä¼šåœ¨è¯„ä¼°ç”¨æˆ·æ˜¯å¦å…·æœ‰ can-view æƒé™æ—¶è¿”å› trueã€‚è¿™æ˜¯å› ä¸ºâ€œeditorâ€è§’è‰²å¯ä¼ é€’åœ°åŒ…å«â€œviewer è§’è‰²â€ï¼Œå› æ­¤å…·æœ‰å¯ä»¥æŸ¥çœ‹çš„æƒé™ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä¸“æœ‰åŸŸå¯¹è±¡çš„ç»†ç²’åº¦çš„æˆæƒ&#34;&gt;ä¸“æœ‰åŸŸå¯¹è±¡çš„ç»†ç²’åº¦çš„æˆæƒ&lt;/h2&gt;
&lt;p&gt;åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬ä¸€ç›´åœ¨å¤„ç†â€œå…¨å±€â€è§’è‰²ã€‚è®¸å¤šåº”ç”¨ç¨‹åºå¸Œæœ›å°†æƒé™æˆäºˆå®ƒä»¬ç®¡ç†çš„ä¸€ç»„å¯¹è±¡ã€‚ä¾‹å¦‚ï¼ŒGoogle Drive ç­‰æ–‡ä»¶å…±äº«åº”ç”¨ç¨‹åºå°†â€œæ–‡ä»¶å¤¹â€å’Œâ€œæ–‡ä»¶â€å®šä¹‰ä¸ºå¯¹è±¡ç±»å‹ã€‚æ–‡ä»¶å¤¹å’Œæ–‡ä»¶éƒ½å¯ä»¥æœ‰ä¸€ä¸ªçˆ¶æ–‡ä»¶å¤¹ã€‚è¿™äº›å¯¹è±¡ä¸­çš„æ¯ä¸€ä¸ªéƒ½æœ‰ä¸€ç»„å…³ç³»ï¼ˆâ€œæ‰€æœ‰è€…â€ã€â€œç¼–è¾‘è€…â€ã€â€œè¯„è®ºè€…â€å’Œâ€œæŸ¥çœ‹è€…â€ï¼‰ï¼Œå¹¶ä¸”â€œæ‰€æœ‰è€…â€å¯ä»¥å°†è¿™äº›è§’è‰²æˆäºˆç”¨æˆ·å’Œç»„ã€‚å› æ­¤ï¼Œå¯ä»¥å°†è¿™äº›æƒé™åˆ†é…ç»™ç¦»æ•£çš„æ–‡ä»¶å¤¹å’Œæ–‡ä»¶ï¼Œè€Œä¸æ˜¯å¯¹æ¯ä¸ªæ–‡ä»¶å’Œæ–‡ä»¶å¤¹å…·æœ‰ç¼–è¾‘æƒé™çš„å…¨å±€â€œç¼–è¾‘å™¨â€è§’è‰²ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://research.google/pubs/pub48190/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Google çš„ Zanzibar&lt;/a&gt; æ˜¯æ”¯æŒ Google æ–‡æ¡£å’Œè®¸å¤šå…¶ä»– Google åº”ç”¨ç¨‹åºçš„æˆæƒç³»ç»Ÿï¼Œå®ƒå®ç°äº†è¿™ä¸ªæ¨¡å‹ã€‚Zanzibar å¯å‘äº†è®¸å¤šæˆæƒç³»ç»Ÿï¼ŒåŒ…æ‹¬ Airbnb çš„ Himejiã€Carta çš„ AuthZ å’Œå‡ ä¸ªå¼€æºå®ç°ï¼ŒåŒ…æ‹¬ Topazã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ Topazï¼Œä½ å¯ä»¥å®šä¹‰ç‰¹å®šé¢†åŸŸçš„å¯¹è±¡ç±»å‹å’Œå…³ç³»ç±»å‹ã€‚å¯ä»¥ä¸ºæ¯ç§å…³ç³»ç±»å‹å®šä¹‰æƒé™ï¼ˆå’Œ/æˆ–å…¶ä»–å…³ç³»ç±»å‹çš„è”åˆï¼‰ã€‚å¯ä»¥åœ¨&lt;a href=&#34;https://github.com/aserto-dev/topaz-samples/blob/main/gdrive/model/manifest.yaml&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ­¤å¤„&lt;/a&gt;æ‰¾åˆ°æ”¯æŒæ­¤æ¨¡å‹çš„æ¸…å•çš„å®Œæ•´ç¤ºä¾‹ã€‚&lt;/p&gt;
&lt;p&gt;çº¯ç²¹ä»¥è¯„ä¼°ä¸»ä½“ï¼ˆç”¨æˆ·å’Œç»„ï¼‰å’Œå®¢ä½“ï¼ˆä¾‹å¦‚æ–‡ä»¶å¤¹å’Œæ–‡ä»¶ï¼‰ä¹‹é—´çš„å…³ç³»ï¼ˆä¾‹å¦‚â€œviewerâ€ã€â€œeditorâ€ï¼‰çš„å½¢å¼å»ºç«‹çš„æˆæƒæ¨¡å‹å¯ä»¥ç”¨éå¸¸ç®€å•çš„ç­–ç•¥æ¥è¡¨è¾¾ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;allowed&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;n&#34;&gt;ds&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;check_permission&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;({&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;subject&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;id&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;input&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;user&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;id&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;permission&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;input&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;policy&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;object&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;s2&#34;&gt;&amp;#34;type&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;input&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;resource&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;s2&#34;&gt;&amp;#34;key&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;input&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;resource&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;})&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;ç»“åˆåŸºäºç»„çš„-rbac-å’Œ-fga&#34;&gt;ç»“åˆåŸºäºç»„çš„ RBAC å’Œ FGA&lt;/h2&gt;
&lt;p&gt;å¤§å¤šæ•°ç°å®ä¸–ç•Œçš„åº”ç”¨ç¨‹åºéƒ½å®ç°äº†åŸºäºç»„çš„ RBAC å’Œç»†ç²’åº¦æˆæƒçš„æŸç§ç»„åˆã€‚é€šå¸¸ï¼Œæˆæƒæ¶‰åŠæ£€æŸ¥å…¨å±€è§’è‰²ï¼ˆä¾‹å¦‚ï¼Œâ€œeditorâ€ï¼‰ï¼Œç„¶åæ£€æŸ¥ç”¨æˆ·æ˜¯å¦æœ‰æƒè®¿é—®ç‰¹å®šèµ„æºï¼ˆä¾‹å¦‚ï¼Œåˆ—è¡¨ï¼‰ã€‚ç”¨æˆ·éœ€è¦æ»¡è¶³è¿™ä¸¤ä¸ªæ¡ä»¶æ‰èƒ½ç¼–è¾‘æ­¤åˆ—è¡¨ä¸­çš„é¡¹ç›®ã€‚&lt;/p&gt;
&lt;p&gt;å¦ä¸€ä¸ªä¾‹å­æ˜¯â€œsuper-adminâ€ï¼Œä¸€ä¸ªå¯ä»¥åšä»»ä½•äº‹æƒ…çš„è§’è‰²ã€‚è®¿é—®æ£€æŸ¥åŒ…æ‹¬å…è®¸ç”¨æˆ·é€šè¿‡å…³ç³»è®¿é—®ç‰¹å®šå¯¹è±¡çš„é€»è¾‘ï¼Œä»¥åŠå…è®¸è®¿é—®å…·æœ‰è¿™äº›æå‡è§’è‰²çš„ç”¨æˆ·çš„é€»è¾‘ã€‚&lt;/p&gt;
&lt;p&gt;Topaz è¿˜æ”¯æŒè¿™äº›åœºæ™¯ï¼Œå› ä¸ºå®ƒå»ºç«‹åœ¨ç­–ç•¥å’ŒåŸºäºå…³ç³»çš„è®¿é—®æ§åˆ¶çš„ç»„åˆä¹‹ä¸Šã€‚ä¸ºäº†æ‰©å±•å‰é¢çš„ç¤ºä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç­–ç•¥ä¸­æ·»åŠ å¦ä¸€ä¸ªâ€œå…è®¸â€å­å¥ã€‚å¦‚æœç”¨æˆ·å·²è¢«æˆäºˆå¯¹ç‰¹å®šå¯¹è±¡çš„ç‰¹å®šæƒé™ï¼Œæˆ–è€…å¦‚æœä»–ä»¬æ˜¯â€œsuper-adminâ€ï¼Œåˆ™æ­¤å­å¥å°†å…è®¸æ“ä½œï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;allowed&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;   &lt;span class=&#34;n&#34;&gt;ds&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;check_permission&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;({&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;     &lt;span class=&#34;s2&#34;&gt;&amp;#34;subject&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;id&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;input&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;user&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;id&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;     &lt;span class=&#34;s2&#34;&gt;&amp;#34;permission&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;input&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;policy&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;     &lt;span class=&#34;s2&#34;&gt;&amp;#34;object&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;     &lt;span class=&#34;s2&#34;&gt;&amp;#34;type&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;input&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;resource&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;     &lt;span class=&#34;s2&#34;&gt;&amp;#34;key&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;input&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;resource&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;key&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;})&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;allowed&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;     &lt;span class=&#34;nb&#34;&gt;input&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;user&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;roles&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;_&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;super-admin&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬ä»‹ç»äº†äº”ç§å¸¸è§çš„æˆæƒæ¨¡å‹ï¼Œä»æœ€ç®€å•çš„åŸºäº IDP çš„ RBACï¼Œåˆ°åŸºäºç»„çš„ RBAC ä¸ç»†ç²’åº¦æƒé™å’Œç»†ç²’åº¦èµ„æºçš„ç»“åˆã€‚&lt;/p&gt;
&lt;p&gt;Topaz æ”¯æŒæ‰€æœ‰è¿™äº›æ¨¡å‹ï¼ŒåŒæ ·é‡è¦çš„æ˜¯ï¼Œå®ƒå¯ä»¥é€šè¿‡æ”¹è¿›æˆæƒç­–ç•¥è½»æ¾åœ°ä»ç®€å•æ¨¡å‹å‘å±•åˆ°æ›´å¤æ‚çš„æ¨¡å‹ã€‚&lt;/p&gt;
&lt;p&gt;æœ€ç»ˆï¼Œæ¯ä¸ªæˆåŠŸçš„åº”ç”¨ç¨‹åºéƒ½éœ€è¦ä¸€å¥—æ·±å…¥çš„æˆæƒåŠŸèƒ½ã€‚åœ¨ä½ çš„æ—…ç¨‹ä¸­å°½æ—©é‡‡ç”¨åƒ Topaz æˆ– Aserto è¿™æ ·çš„æˆæƒå¹³å°å¯ä»¥ä½¿ä½ çš„åº”ç”¨ç¨‹åºé¢å‘æœªæ¥ï¼Œå¹¶ä¸”å¯ä»¥æ›´è½»æ¾åœ°æ ¹æ®ä½ ä¸æ–­æ‰©å±•çš„éœ€æ±‚æ”¹è¿›ä½ çš„æˆæƒæ¨¡å‹ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Rust ç¼–è¯‘ WebAssembly æŒ‡å—</title>
      <link>https://lib.jimmysong.io/blog/rust-to-wasm/</link>
      <pubDate>Fri, 24 Feb 2023 11:00:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/rust-to-wasm/</guid>
      <description>&lt;p&gt;ä¸‹é¢æ˜¯æˆ‘æ‰€çŸ¥é“çš„å…³äºå°† Rust ç¼–è¯‘ä¸º WebAssembly çš„æ‰€æœ‰çŸ¥è¯†ã€‚&lt;/p&gt;
&lt;p&gt;å‰ä¸€æ®µæ—¶é—´ï¼Œæˆ‘å†™äº†ä¸€ç¯‡&lt;a href=&#34;https://surma.dev/things/c-to-webassembly&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¦‚ä½•åœ¨æ²¡æœ‰ Emscripten çš„æƒ…å†µä¸‹å°† C ç¼–è¯‘ä¸º WebAssembly&lt;/a&gt; çš„åšå®¢æ–‡ç« ï¼Œå³ä¸é»˜è®¤å·¥å…·æ¥ç®€åŒ–è¿™ä¸ªè¿‡ç¨‹ã€‚ åœ¨ Rust ä¸­ï¼Œä½¿ WebAssembly å˜å¾—ç®€å•çš„å·¥å…·ç§°ä¸º &lt;a href=&#34;https://rustwasm.github.io/wasm-bindgen/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;wasm-bindgen&lt;/a&gt;ï¼Œæˆ‘ä»¬æ­£åœ¨æ”¾å¼ƒå®ƒï¼ åŒæ—¶ï¼ŒRust æœ‰ç‚¹ä¸åŒï¼Œå› ä¸º WebAssembly é•¿æœŸä»¥æ¥ä¸€ç›´æ˜¯ä¸€æµçš„ç›®æ ‡ï¼Œå¹¶ä¸”å¼€ç®±å³ç”¨åœ°æä¾›äº†æ ‡å‡†åº“å¸ƒå±€ã€‚&lt;/p&gt;
&lt;h2 id=&#34;rust-ç¼–è¯‘-webassembly-å…¥é—¨&#34;&gt;Rust ç¼–è¯‘ WebAssembly å…¥é—¨&lt;/h2&gt;
&lt;p&gt;è®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•è®© Rust ä»¥å°½å¯èƒ½å°‘çš„åç¦»æ ‡å‡† Rust å·¥ä½œæµç¨‹çš„æ–¹å¼ç¼–è¯‘æˆ WebAssemblyã€‚ å¦‚æœä½ æµè§ˆäº’è”ç½‘ï¼Œè®¸å¤šæ–‡ç« å’ŒæŒ‡å—éƒ½ä¼šå‘Šè¯‰ä½ ä½¿ç”¨ &lt;code&gt;cargo init --lib&lt;/code&gt; åˆ›å»ºä¸€ä¸ª Rust åº“é¡¹ç›®ï¼Œç„¶åå°† &lt;code&gt;crate-type = [&amp;quot;cdylib&amp;quot;]&lt;/code&gt; æ·»åŠ åˆ°ä½ çš„ &lt;code&gt;cargo.toml&lt;/code&gt;ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-ini&#34; data-lang=&#34;ini&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;[package]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;na&#34;&gt;name&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;my_project&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;na&#34;&gt;version&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;0.1.0&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;na&#34;&gt;edition&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;2021&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;[lib]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;na&#34;&gt;crate-type&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;[&amp;#34;cdylib&amp;#34;]
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;   &lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;[dependencies]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¦‚æœä½ ä¸å°† crate ç±»å‹è®¾ç½®ä¸º &lt;code&gt;cdylib&lt;/code&gt;ï¼ŒRust ç¼–è¯‘å™¨å°†ç”Ÿæˆä¸€ä¸ª &lt;code&gt;.rlib&lt;/code&gt; æ–‡ä»¶ï¼Œè¿™æ˜¯ Rust è‡ªå·±çš„åº“æ ¼å¼ã€‚ è™½ç„¶ &lt;code&gt;cdylib&lt;/code&gt; è¿™ä¸ªåå­—æš—ç¤ºäº†ä¸€ä¸ªä¸ C å…¼å®¹çš„åŠ¨æ€åº“ï¼Œä½†æˆ‘æ€€ç–‘å®ƒçœŸçš„åªæ˜¯ä»£è¡¨â€œä½¿ç”¨å¯äº’æ“ä½œçš„æ ¼å¼â€æˆ–ç±»ä¼¼çš„ä¸œè¥¿ã€‚&lt;/p&gt;
&lt;div class=&#34;alert-note-title&#34;&gt;
    &lt;p&gt;ä»€ä¹ˆæ˜¯ crate?&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;alert alert-note&#34;&gt;
    &lt;p&gt;åœ¨ Rust ç¼–ç¨‹ä¸­ï¼ŒCrateï¼ˆä¸­æ–‡æ„æ€æ˜¯ &amp;ldquo;æ¿æ¡ç®±&amp;rdquo;ï¼‰æŒ‡çš„æ˜¯ Rust è¯­è¨€ä¸­çš„åŒ…ï¼ˆPackageï¼‰ï¼Œæ˜¯ Rust ä»£ç çš„ä¸€ä¸ªå•å…ƒï¼Œç”¨äºç»„ç»‡ã€æ„å»ºå’Œå…±äº« Rust ä»£ç ã€‚ä¸€ä¸ª Crate å¯ä»¥åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªæ¨¡å—ï¼ˆModuleï¼‰ï¼Œå¹¶ä¸”å¯ä»¥è¢«å…¶ä»– Crate å¼•ç”¨å’Œä½¿ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;æ¯ä¸ª Crate éƒ½éœ€è¦æœ‰ä¸€ä¸ª Cargo.toml æ–‡ä»¶ä½œä¸ºå…¶é…ç½®æ–‡ä»¶ã€‚Cargo.toml ä¸­åŒ…å«äº† Crate çš„å…ƒä¿¡æ¯ï¼Œå¦‚åç§°ã€ç‰ˆæœ¬ã€ä½œè€…ã€ä¾èµ–ç­‰ä¿¡æ¯ã€‚åŒæ—¶ï¼ŒCargo.toml ä¸­è¿˜å¯ä»¥å®šä¹‰ç¼–è¯‘å™¨é€‰é¡¹ã€ç¯å¢ƒå˜é‡ç­‰é…ç½®ä¿¡æ¯ï¼Œç”¨äºæ„å»ºå’Œå‘å¸ƒ Crateã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ Rust ç¤¾åŒºä¸­ï¼Œæœ‰å¾ˆå¤šä¼˜ç§€çš„ Crate å¯ä»¥ä¾›ä½¿ç”¨ã€‚é€šè¿‡å¼•ç”¨è¿™äº› Crateï¼Œå¯ä»¥å¿«é€Ÿã€ç®€ä¾¿åœ°å¼€å‘é«˜è´¨é‡çš„ Rust åº”ç”¨ç¨‹åºã€‚åŒæ—¶ï¼ŒRust ç¤¾åŒºä¹Ÿé¼“åŠ±å¼€å‘è€…è´¡çŒ®è‡ªå·±çš„ Crateï¼Œä»¥ä¾¿å…¶ä»–å¼€å‘è€…ä½¿ç”¨å’Œè´¡çŒ®ã€‚&lt;/p&gt;
&lt;p&gt;cdylib ä¹Ÿå¯ä»¥è¢«ç§°ä¸º &amp;ldquo;C-compatible Dynamic Library&amp;rdquo;ã€‚cdylib Crate å¯ä»¥é€šè¿‡ Rust è¯­è¨€ç¼–å†™åŠ¨æ€é“¾æ¥åº“ï¼Œå¹¶å°†å…¶å¯¼å‡ºä¸º C ABIï¼ˆApplication Binary Interfaceï¼‰ã€‚è¿™ä½¿å¾—å…¶ä»–è¯­è¨€ï¼ˆå¦‚ Cã€C++ã€Pythonã€Java ç­‰ï¼‰å¯ä»¥é€šè¿‡ C ABI æ¥å£è°ƒç”¨ Rust åŠ¨æ€é“¾æ¥åº“ä¸­çš„å‡½æ•°å’Œå˜é‡ã€‚è¿™å¯¹äº Rust ä¸å…¶ä»–è¯­è¨€çš„äº’æ“ä½œæ€§éå¸¸é‡è¦ï¼Œç‰¹åˆ«æ˜¯åœ¨éœ€è¦ä¸ç°æœ‰ä»£ç è¿›è¡Œé›†æˆçš„æƒ…å†µä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ cdylib Crate å¯ä»¥æ–¹ä¾¿åœ°åˆ›å»ºå’Œå‘å¸ƒ Rust åŠ¨æ€é“¾æ¥åº“ï¼Œå¹¶å°†å…¶ä¸å…¶ä»–è¯­è¨€è¿›è¡Œé›†æˆã€‚åŒæ—¶ï¼Œcdylib Crate ä¹Ÿæä¾›äº†ä¸€äº›ä¸åŠ¨æ€é“¾æ¥åº“ç›¸å…³çš„å·¥å…·å’Œ APIï¼Œå¦‚åŠ¨æ€é“¾æ¥åº“ç‰ˆæœ¬ç®¡ç†ã€ç¬¦å·å¯¼å‡ºç­‰ã€‚è¿™äº›å·¥å…·å’Œ API å¯ä»¥æ–¹ä¾¿åœ°å°† Rust åŠ¨æ€é“¾æ¥åº“çš„å¼€å‘å’Œé›†æˆè¿‡ç¨‹å˜å¾—æ›´åŠ ç®€å•ã€å¯é å’Œé«˜æ•ˆã€‚&lt;/p&gt;

&lt;/div&gt;

&lt;p&gt;ç°åœ¨ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ Cargo åœ¨åˆ›å»ºæ–°åº“æ—¶ç”Ÿæˆçš„é»˜è®¤/ç¤ºä¾‹å‡½æ•°ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;left&lt;/span&gt;: &lt;span class=&#34;kt&#34;&gt;usize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;right&lt;/span&gt;: &lt;span class=&#34;kt&#34;&gt;usize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;kt&#34;&gt;usize&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;left&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;right&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¸€åˆ‡å°±ç»ªåï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥å°†è¿™ä¸ªåº“ç¼–è¯‘ä¸º WebAssemblyï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cargo build --target&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;wasm32-unknown-unknown --release
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä½ ä¼šåœ¨ &lt;code&gt;target/wasm32-unknown-unknown/release/my_project.wasm&lt;/code&gt; æ‰¾åˆ°å®ƒã€‚ åœ¨æ•´ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†ç»§ç»­ä½¿ç”¨ &lt;code&gt;--release&lt;/code&gt; è¿›è¡Œæ„å»ºï¼Œå› ä¸ºå®ƒä½¿ WebAssembly æ¨¡å—åœ¨æˆ‘ä»¬åæ±‡ç¼–æ—¶æ›´å…·å¯è¯»æ€§ã€‚&lt;/p&gt;
&lt;div class=&#34;alert-note-title&#34;&gt;
    &lt;p&gt;ä»€ä¹ˆæ˜¯ Cargoï¼Ÿ&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;alert alert-note&#34;&gt;
    &lt;p&gt;Cargo æ˜¯ä¸€ä¸ª Rust é¡¹ç›®ç®¡ç†å·¥å…·ï¼Œç”¨äºæ„å»ºã€æµ‹è¯•ã€å‘å¸ƒ Rust åº”ç”¨ç¨‹åºå’Œåº“ã€‚Cargo æä¾›äº†ä¸€ä¸ªå‘½ä»¤è¡Œç•Œé¢å’Œä¸€ç»„ Rust APIï¼Œç”¨äºç®¡ç†é¡¹ç›®ä¾èµ–ã€ç¼–è¯‘ã€æµ‹è¯•å’Œå‘å¸ƒè¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯ Cargo æä¾›çš„ä¸»è¦åŠŸèƒ½ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä¾èµ–ç®¡ç†ï¼šCargo å¯ä»¥é€šè¿‡ Cargo.toml æ–‡ä»¶ç®¡ç† Rust é¡¹ç›®çš„ä¾èµ–ã€‚å½“æ·»åŠ ã€æ›´æ–°æˆ–åˆ é™¤ä¾èµ–æ—¶ï¼ŒCargo ä¼šè‡ªåŠ¨å¤„ç†ä¾èµ–çš„ç‰ˆæœ¬æ§åˆ¶ã€ä¾èµ–è§£å†³å’Œä¾èµ–ç¼–è¯‘ç­‰é—®é¢˜ã€‚&lt;/li&gt;
&lt;li&gt;æ„å»ºå’Œæµ‹è¯•ï¼šCargo å¯ä»¥ä½¿ç”¨ rustc ç¼–è¯‘å™¨æ„å»º Rust é¡¹ç›®ï¼Œå¹¶è‡ªåŠ¨è§£å†³ä¾èµ–å…³ç³»ã€‚åŒæ—¶ï¼ŒCargo è¿˜æ”¯æŒé¡¹ç›®æµ‹è¯•å’Œæ–‡æ¡£ç”Ÿæˆç­‰åŠŸèƒ½ã€‚&lt;/li&gt;
&lt;li&gt;å‘å¸ƒå’Œåˆ†å‘ï¼šCargo å¯ä»¥å°† Rust é¡¹ç›®æ‰“åŒ…ä¸º Crate å¹¶å‘å¸ƒåˆ° crates.io ä¸Šï¼Œä¹Ÿå¯ä»¥å°†äºŒè¿›åˆ¶æ–‡ä»¶æ‰“åŒ…ä¸ºå¯æ‰§è¡Œæ–‡ä»¶å¹¶å‘å¸ƒåˆ°å…¶ä»–å¹³å°ä¸Šã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;é€šè¿‡ä½¿ç”¨ Cargoï¼Œå¼€å‘è€…å¯ä»¥æ–¹ä¾¿åœ°åˆ›å»ºã€æ„å»ºã€æµ‹è¯•å’Œå‘å¸ƒ Rust åº”ç”¨ç¨‹åºå’Œåº“ã€‚åŒæ—¶ï¼ŒCargo è¿˜æä¾›äº†ä¸€äº›æœ‰ç”¨çš„å·¥å…·å’Œå‘½ä»¤è¡Œé€‰é¡¹ï¼Œå¦‚æ¸…ç†é¡¹ç›®ã€æŸ¥è¯¢ä¾èµ–ã€æŸ¥çœ‹æ„å»ºæ—¥å¿—ç­‰ï¼Œç”¨äºæé«˜ Rust é¡¹ç›®çš„å¼€å‘æ•ˆç‡å’Œè´¨é‡ã€‚&lt;/p&gt;

&lt;/div&gt;

&lt;h3 id=&#34;å¯æ‰§è¡Œæ–‡ä»¶ä¸åº“&#34;&gt;å¯æ‰§è¡Œæ–‡ä»¶ä¸åº“&lt;/h3&gt;
&lt;p&gt;ä½ å¯ä»¥åˆ›å»ºä¸€ä¸ª Rust å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆé€šè¿‡ &lt;code&gt;cargo init --bin&lt;/code&gt;ï¼‰ï¼Œè€Œä¸æ˜¯åˆ›å»ºä¸€ä¸ªåº“ã€‚ ä½†æ˜¯è¯·æ³¨æ„ï¼Œä½ è¦ä¹ˆå¿…é¡»è®© &lt;code&gt;main()&lt;/code&gt; å‡½æ•°å…·æœ‰å®Œå–„çš„ç­¾åï¼Œè¦ä¹ˆä½¿ç”¨ &lt;code&gt;#![no_main]&lt;/code&gt; å…³é—­ç¼–è¯‘å™¨ä»¥è®©å®ƒçŸ¥é“ç¼ºå°‘ &lt;code&gt;main()&lt;/code&gt; æ˜¯æ•…æ„çš„ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¸ªæ›´å¥½å—ï¼Ÿ è¿™å¯¹æˆ‘æ¥è¯´ä¼¼ä¹æ˜¯ä¸€ä¸ªå“å‘³é—®é¢˜ï¼Œå› ä¸ºè¿™ä¸¤ç§æ–¹æ³•åœ¨åŠŸèƒ½ä¸Šä¼¼ä¹æ˜¯ç­‰åŒçš„å¹¶ä¸”ç”Ÿæˆç›¸åŒçš„ WebAssembly ä»£ç ã€‚ å¤§å¤šæ•°æ—¶å€™ï¼ŒWebAssembly æ¨¡å—ä¼¼ä¹æ‰®æ¼”äº†ä¸€ä¸ªåº“çš„è§’è‰²ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼ˆé™¤äº†åœ¨ &lt;a href=&#34;https://wasi.dev/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;WASI&lt;/a&gt; çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œç¨åä¼šè¯¦ç»†ä»‹ç»ï¼ï¼‰ï¼Œæ‰€ä»¥åœ¨æˆ‘çœ‹æ¥ï¼Œåº“æ–¹æ³•åœ¨è¯­ä¹‰ä¸Šä¼¼ä¹æ›´å¯å–ã€‚ é™¤éå¦æœ‰è¯´æ˜ï¼Œå¦åˆ™æˆ‘å°†åœ¨æœ¬æ–‡çš„å…¶ä½™éƒ¨åˆ†ä½¿ç”¨åº“è®¾ç½®ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å¯¼å‡º&#34;&gt;å¯¼å‡º&lt;/h3&gt;
&lt;p&gt;ç»§ç»­åº“æ ·å¼çš„è®¾ç½®ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹ç¼–è¯‘å™¨ç”Ÿæˆçš„ WebAssembly ä»£ç ã€‚ ä¸ºæ­¤ï¼Œæˆ‘æ¨è &lt;a href=&#34;https://github.com/WebAssembly/wabt&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;WebAssembly Binary Toolkit&lt;/a&gt;ï¼ˆç®€ç§°â€œwabtâ€ï¼‰ï¼Œå®ƒæä¾›äº†æœ‰ç”¨çš„å·¥å…·ï¼Œå¦‚ wasm2watã€‚ å¦å¤–ï¼Œè¯·ç¡®ä¿å®‰è£…äº† &lt;a href=&#34;https://github.com/WebAssembly/binaryen&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Binarygen&lt;/a&gt;ï¼Œå› ä¸ºæœ¬æ–‡åé¢æˆ‘ä»¬å°†éœ€è¦ wasm-optã€‚ Binaryen è¿˜æä¾›äº† &lt;code&gt;wasm-dis&lt;/code&gt;ï¼Œå…¶å·¥ä½œæ–¹å¼ä¸ wasm2wat ç±»ä¼¼ï¼Œä½†ä¸äº§ç”Ÿ WebAssembly æ–‡æœ¬æ ¼å¼ (WAT)ã€‚ å®ƒç”Ÿæˆæ ‡å‡†åŒ–ç¨‹åº¦è¾ƒä½çš„ WebAssembly S-Expression æ–‡æœ¬æ ¼å¼ (WAST)ã€‚ æœ€åï¼ŒByteCodeAlliance çš„ &lt;a href=&#34;https://github.com/bytecodealliance/wasm-tools&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;wasm-tools&lt;/a&gt; æä¾›äº† &lt;code&gt;wasm-tools print&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;wasm2wat ./target/wasm32-unknown-unknown/release/my_project.wasm
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ­¤å‘½ä»¤ä¼šå°† WebAssembly äºŒè¿›åˆ¶æ–‡ä»¶è½¬æ¢ä¸º WATï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;module&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;table&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(;&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;)&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;funcref&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;memory&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(;&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;)&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;16&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;global&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;$&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;__stack_pointer&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mut&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1048576&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;global&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(;&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;)&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i32&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1048576&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;global&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(;&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;)&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i32&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1048576&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;memory&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;memory&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;__data_end&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;global&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;__heap_base&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;global&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä»¤äººå‘æŒ‡çš„æ˜¯ï¼Œæˆ‘ä»¬å‘ç°æˆ‘ä»¬çš„ add å‡½æ•°å·²ä»äºŒè¿›åˆ¶æ–‡ä»¶ä¸­å®Œå…¨åˆ é™¤ã€‚ æˆ‘ä»¬åªå‰©ä¸‹ä¸€ä¸ªå †æ ˆæŒ‡é’ˆå’Œä¸¤ä¸ªå…¨å±€å˜é‡ï¼Œå®ƒä»¬æŒ‡å®šæ•°æ®éƒ¨åˆ†çš„ç»“æŸä½ç½®å’Œå †çš„å¼€å§‹ä½ç½®ã€‚ äº‹å®è¯æ˜ï¼Œå°†å‡½æ•°å£°æ˜ä¸º &lt;code&gt;pub&lt;/code&gt; ä¸è¶³ä»¥è®©å®ƒå‡ºç°åœ¨æˆ‘ä»¬æœ€ç»ˆçš„ WebAssembly æ¨¡å—ä¸­ã€‚ æˆ‘å…¶å®å¸Œæœ›è¿™å°±è¶³å¤Ÿäº†ï¼Œä½†æˆ‘æ€€ç–‘ Rust æ¨¡å—å¯è§æ€§æ˜¯å”¯ä¸€çš„ï¼Œè€Œä¸æ˜¯é“¾æ¥å™¨çº§åˆ«çš„ç¬¦å·å¯è§æ€§ã€‚&lt;/p&gt;
&lt;p&gt;ç¡®ä¿ç¼–è¯‘å™¨ä¸ä¼šåˆ é™¤æˆ‘ä»¬å…³å¿ƒçš„å‡½æ•°çš„æœ€å¿«æ–¹æ³•æ˜¯æ·»åŠ å±æ€§ &lt;code&gt;#[no_mangle]&lt;/code&gt;ï¼Œå°½ç®¡æˆ‘ä¸å–œæ¬¢è¿™ä¸ªå‘½åã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;#[no_mangle]
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;pub&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nl&#34;&gt;left&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;usize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nl&#34;&gt;right&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;usize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;usize&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;left&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;right&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¾ˆå°‘éœ€è¦ï¼Œä½†æ˜¯ä½ å¯ä»¥é€šè¿‡ä½¿ç”¨  &lt;code&gt;#[export_name = &amp;quot;...&amp;quot;]&lt;/code&gt; å¯¼å‡ºä¸€ä¸ªåç§°ä¸å…¶ Rust å†…éƒ¨åç§°ä¸åŒçš„å‡½æ•°ã€‚&lt;/p&gt;
&lt;p&gt;å°†æˆ‘ä»¬çš„ &lt;code&gt;add&lt;/code&gt; å‡½æ•°æ ‡è®°ä¸ºå¯¼å‡ºåï¼Œæˆ‘ä»¬å¯ä»¥å†æ¬¡ç¼–è¯‘é¡¹ç›®å¹¶æ£€æŸ¥ç”Ÿæˆçš„ WebAssembly æ–‡ä»¶ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-c&#34; data-lang=&#34;c&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;module&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(;&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;param&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i32&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;result&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;$&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;add&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;param&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i32&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;result&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;local&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;local&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;i32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;table&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(;&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;)&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;funcref&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;memory&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(;&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;)&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;16&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;global&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;$&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;__stack_pointer&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mut&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1048576&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;global&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(;&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;)&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i32&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1048576&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;global&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(;&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;)&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i32&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1048576&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;memory&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;memory&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;add&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;err&#34;&gt;$&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;__data_end&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;global&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;__heap_base&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;global&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™ä¸ªæ¨¡å—å¯ä»¥ç”¨æ™®é€šçš„ WebAssembly API å®ä¾‹åŒ–ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-js&#34; data-lang=&#34;js&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;importObj&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{};&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// Node
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;require&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;fs&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;readFileSync&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;./my_project.wasm&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;instance&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kr&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;WebAssembly&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;instantiate&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;importObj&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// Deno
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kr&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;Deno&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;readFile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;./my_project.wasm&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;instance&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kr&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;WebAssembly&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;instantiate&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;importObj&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// For Web, itâ€™s advisable to use `instantiateStreaming` whenever possible:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;response&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kr&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;fetch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;./my_project.wasm&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;instance&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;kr&#34;&gt;await&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;WebAssembly&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;instantiateStreaming&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;response&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;importObj&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;instance&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;exports&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;40&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;c1&#34;&gt;// returns 42
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;çªç„¶ä¹‹é—´ï¼Œæˆ‘ä»¬å‡ ä¹å¯ä»¥ä½¿ç”¨ Rust çš„æ‰€æœ‰åŠŸèƒ½æ¥ç¼–å†™ WebAssemblyã€‚&lt;/p&gt;
&lt;p&gt;éœ€è¦ç‰¹åˆ«æ³¨æ„æ¨¡å—è¾¹ç•Œå¤„çš„å‡½æ•°ï¼ˆå³ä½ ä» JavaScript è°ƒç”¨çš„å‡½æ•°ï¼‰ã€‚è‡³å°‘å°±ç›®å‰è€Œè¨€ï¼Œæœ€å¥½åšæŒä½¿ç”¨&lt;a href=&#34;https://webassembly.github.io/spec/core/syntax/types.html#number-types&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;èƒ½å¤Ÿæ¸…æ™°æ˜ å°„åˆ° WebAssembly çš„ç±»å‹&lt;/a&gt;ï¼ˆå¦‚&lt;code&gt;i32&lt;/code&gt;æˆ–&lt;code&gt;f64&lt;/code&gt;ï¼‰ã€‚å¦‚æœä½ ä½¿ç”¨æ›´é«˜çº§åˆ«çš„ç±»å‹ï¼Œå¦‚æ•°ç»„ã€åˆ‡ç‰‡ï¼Œç”šè‡³ &lt;code&gt;String&lt;/code&gt;ï¼Œè¯¥å‡½æ•°æœ€ç»ˆå¯èƒ½ä¼šä½¿ç”¨æ¯”å®ƒä»¬åœ¨ Rust ä¸­æ›´å¤šçš„å‚æ•°ï¼Œå¹¶ä¸”é€šå¸¸éœ€è¦å¯¹å†…å­˜å¸ƒå±€å’Œç±»ä¼¼åŸåˆ™æœ‰æ›´æ·±å…¥çš„äº†è§£ã€‚&lt;/p&gt;
&lt;h3 id=&#34;abi&#34;&gt;ABI&lt;/h3&gt;
&lt;p&gt;è¯·æ³¨æ„ï¼šæ˜¯çš„ï¼Œæˆ‘ä»¬æ­£åœ¨æˆåŠŸåœ°å°† Rust ç¼–è¯‘ä¸º WebAssemblyã€‚ç„¶è€Œï¼Œåœ¨ Rust ç‰ˆæœ¬ä¸­ï¼Œå¯èƒ½ä¼šç”Ÿæˆä¸€ä¸ªå…·æœ‰å®Œå…¨ä¸åŒå‡½æ•°ç­¾åçš„ WebAssembly æ¨¡å—ã€‚å‡½æ•°å‚æ•°ä»è°ƒç”¨è€…ä¼ é€’åˆ°è¢«è°ƒç”¨è€…çš„æ–¹å¼ï¼ˆä¾‹å¦‚ä½œä¸ºæŒ‡å‘å†…å­˜çš„æŒ‡é’ˆæˆ–ä½œä¸ºç«‹å³å€¼ï¼‰æ˜¯åº”ç”¨ç¨‹åºäºŒè¿›åˆ¶æ¥å£å®šä¹‰æˆ–ç®€ç§°â€œABIâ€çš„ä¸€éƒ¨åˆ†ã€‚&lt;code&gt;rustc&lt;/code&gt; é»˜è®¤ä½¿ç”¨ Rust çš„ ABIï¼Œå®ƒä¸ç¨³å®šï¼Œä¸»è¦è€ƒè™‘ Rust å†…éƒ¨ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;rustc&lt;/code&gt; ä¸ºäº†ç¨³å®šè¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥æ˜¾å¼å®šä¹‰è¦ä¸ºå‡½æ•°ä½¿ç”¨å“ªä¸ª ABI ã€‚è¿™æ˜¯é€šè¿‡ä½¿ç”¨ &lt;a href=&#34;https://doc.rust-lang.org/reference/items/functions.html#extern-function-qualifier&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;code&gt;extern&lt;/code&gt;&lt;/a&gt; å…³é”®å­—æ¥å®Œæˆçš„ã€‚è·¨è¯­è¨€å‡½æ•°è°ƒç”¨çš„ä¸€ä¸ªé•¿æœŸé€‰æ‹©æ˜¯ &lt;a href=&#34;https://github.com/WebAssembly/tool-conventions/blob/main/BasicCABI.md&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;C ABI&lt;/a&gt;ï¼Œæˆ‘ä»¬å°†åœ¨æ­¤å¤„ä½¿ç”¨å®ƒã€‚C ABI ä¸ä¼šæ”¹å˜ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç¡®å®šæˆ‘ä»¬çš„ WebAssembly æ¨¡å—æ¥å£ä¹Ÿä¸ä¼šæ”¹å˜ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;#[no_mangle]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;left&lt;/span&gt;: &lt;span class=&#34;kt&#34;&gt;usize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;right&lt;/span&gt;: &lt;span class=&#34;kt&#34;&gt;usize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;kt&#34;&gt;usize&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;extern&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;C&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;left&lt;/span&gt;: &lt;span class=&#34;kt&#34;&gt;usize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;right&lt;/span&gt;: &lt;span class=&#34;kt&#34;&gt;usize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;kt&#34;&gt;usize&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;left&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;right&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æˆ‘ä»¬ç”šè‡³å¯ä»¥çœç•¥ &lt;code&gt;&amp;quot;C&amp;quot;&lt;/code&gt; è€Œåªä½¿ç”¨ &lt;code&gt;extern&lt;/code&gt;ï¼Œå› ä¸º C ABI æ˜¯é»˜è®¤çš„æ›¿ä»£ ABIã€‚&lt;/p&gt;
&lt;h3 id=&#34;å¯¼å…¥&#34;&gt;å¯¼å…¥&lt;/h3&gt;
&lt;p&gt;WebAssembly çš„ä¸€ä¸ªé‡è¦éƒ¨åˆ†æ˜¯å®ƒçš„æ²™ç®±ã€‚å®ƒç¡®ä¿åœ¨ WebAssembly VM ä¸­è¿è¡Œçš„ä»£ç æ— æ³•è®¿é—®ä¸»æœºç¯å¢ƒä¸­çš„ä»»ä½•å†…å®¹ï¼Œé™¤äº†é€šè¿‡ imports å¯¹è±¡æ˜¾å¼ä¼ é€’åˆ°æ²™ç®±ä¸­çš„å‡½æ•°ã€‚&lt;/p&gt;
&lt;p&gt;å‡è®¾æˆ‘ä»¬æƒ³åœ¨æˆ‘ä»¬çš„ Rust ä»£ç ä¸­ç”Ÿæˆéšæœºæ•°ã€‚æˆ‘ä»¬å¯ä»¥å¼•å…¥ &lt;code&gt;rand&lt;/code&gt; Rust æ²™ç®±ï¼Œä½†å¦‚æœä¸»æœºç¯å¢ƒä¸­å·²ç»æœ‰ä¸œè¥¿ï¼Œä¸ºä»€ä¹ˆè¿˜è¦å‘å¸ƒä»£ç ã€‚ä½œä¸ºç¬¬ä¸€æ­¥ï¼Œæˆ‘ä»¬éœ€è¦å£°æ˜æˆ‘ä»¬çš„ WebAssembly æ¨¡å—éœ€è¦å¯¼å…¥ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;#[link(wasm_import_module = &lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Math&amp;#34;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;)]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;extern&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;C&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;random&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;kt&#34;&gt;f64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;#[export_name = &lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;add&amp;#34;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;left&lt;/span&gt;: &lt;span class=&#34;kt&#34;&gt;f64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;right&lt;/span&gt;: &lt;span class=&#34;kt&#34;&gt;f64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;kt&#34;&gt;f64&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;left&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;right&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;left&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;right&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;random&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;extern &amp;quot;C&amp;quot;&lt;/code&gt; å—ï¼ˆä¸è¦ä¸ä¸Šé¢çš„ &lt;code&gt;extern &amp;quot;C&amp;quot;&lt;/code&gt; å‡½æ•°æ··æ·†ï¼‰å£°æ˜ç¼–è¯‘å™¨å¸Œæœ›åœ¨é“¾æ¥æ—¶ç”±â€œå…¶ä»–äººâ€æä¾›çš„å‡½æ•°ã€‚è¿™é€šå¸¸æ˜¯ä½ åœ¨ Rust ä¸­é“¾æ¥ C åº“çš„æ–¹å¼ï¼Œä½†è¯¥æœºåˆ¶ä¹Ÿé€‚ç”¨äº WebAssemblyã€‚ä½†æ˜¯ï¼Œå¤–éƒ¨å‡½æ•°æ€»æ˜¯éšå¼ä¸å®‰å…¨çš„ï¼Œå› ä¸ºç¼–è¯‘å™¨æ— æ³•ä¸ºé Rust å‡½æ•°æä¾›ä»»ä½•å®‰å…¨ä¿è¯ã€‚å› æ­¤ï¼Œé™¤éæˆ‘ä»¬å°†è°ƒç”¨åŒ…è£…åœ¨ &lt;code&gt;unsafe { ... }&lt;/code&gt; å—ä¸­ï¼Œå¦åˆ™æˆ‘ä»¬æ— æ³•è°ƒç”¨å®ƒä»¬ã€‚&lt;/p&gt;
&lt;p&gt;ä¸Šé¢çš„ä»£ç å¯ä»¥ç¼–è¯‘ï¼Œä½†ä¸ä¼šè¿è¡Œã€‚æˆ‘ä»¬çš„ JavaScript ä»£ç æŠ›å‡ºé”™è¯¯ï¼Œéœ€è¦æ›´æ–°ä»¥æ»¡è¶³æˆ‘ä»¬æŒ‡å®šçš„å¯¼å…¥ã€‚å¯¼å…¥å¯¹è±¡æ˜¯å¯¼å…¥æ¨¡å—çš„å­—å…¸ï¼Œæ¯ä¸ªæ¨¡å—éƒ½æ˜¯å¯¼å…¥é¡¹çš„å­—å…¸ã€‚åœ¨æˆ‘ä»¬çš„ Rust ä»£ç ä¸­ï¼Œæˆ‘ä»¬å£°æ˜äº†ä¸€ä¸ªå¯¼å…¥æ¨¡å—&amp;quot;Math&amp;quot;ï¼Œå¹¶æœŸæœ›ä¸€ä¸ªè¢«è°ƒç”¨çš„å‡½æ•°&amp;quot;random&amp;quot;å‡ºç°åœ¨è¯¥æ¨¡å—ä¸­ã€‚è¿™äº›å€¼å½“ç„¶æ˜¯ç»è¿‡ä»”ç»†é€‰æ‹©çš„ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ä¼ å…¥æ•´ä¸ª Math å¯¹è±¡ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-javascript&#34; data-lang=&#34;javascript&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;importObj&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;nb&#34;&gt;Math&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;nx&#34;&gt;random&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Math&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;random&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;};&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;c1&#34;&gt;// or
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;  
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;kr&#34;&gt;const&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;importObj&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;Math&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;};&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¸ºäº†é¿å…åˆ°å¤„æ³¨å…¥ &lt;code&gt;unsafe { ... }&lt;/code&gt;ï¼Œé€šå¸¸éœ€è¦ç¼–å†™åŒ…è£…å‡½æ•°æ¥æ¢å¤ Rust çš„å®‰å…¨ä¸å˜é‡ã€‚è¿™æ˜¯ Rust å†…è”æ¨¡å—çš„ä¸€ä¸ªå¾ˆå¥½çš„ç”¨ä¾‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;mod&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;math&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;mod&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;math_js&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;#[link(wasm_import_module = &lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Math&amp;#34;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;)]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;extern&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;C&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;random&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;kt&#34;&gt;f64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;random&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;kt&#34;&gt;f64&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;math_js&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;random&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;#[export_name = &lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;add&amp;#34;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;extern&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;C&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;left&lt;/span&gt;: &lt;span class=&#34;kt&#34;&gt;f64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;right&lt;/span&gt;: &lt;span class=&#34;kt&#34;&gt;f64&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;kt&#34;&gt;f64&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;left&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;right&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;math&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;random&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;é¡ºä¾¿è¯´ä¸€å¥ï¼Œå¦‚æœæˆ‘ä»¬æ²¡æœ‰æŒ‡å®š &lt;code&gt;#[link(wasm_import_module = ...)]&lt;/code&gt;å±æ€§ï¼Œåˆ™å‡½æ•°å°†åœ¨é»˜è®¤ &lt;code&gt;env&lt;/code&gt; æ¨¡å—ä¸Šè¿è¡Œã€‚æ­¤å¤–ï¼Œå°±åƒä½ å¯ä»¥ä½¿ç”¨ &lt;code&gt;#[export_name = &amp;quot;...&amp;quot;]&lt;/code&gt; æ›´æ”¹å¯¼å‡ºçš„å‡½æ•°çš„åç§°ä¸€æ ·ï¼Œä½ å¯ä»¥ä½¿ç”¨ &lt;code&gt;#[link_name = &amp;quot;...&amp;quot;]&lt;/code&gt; æ›´æ”¹å¯¼å…¥çš„å‡½æ•°çš„åç§°ã€‚&lt;/p&gt;
&lt;h3 id=&#34;é«˜çº§ç±»å‹&#34;&gt;é«˜çº§ç±»å‹&lt;/h3&gt;
&lt;p&gt;æˆ‘ä¹‹å‰è¯´è¿‡ï¼Œåœ¨æ¨¡å—è¾¹ç•Œå¤„ç†å‡½æ•°çš„æœ€æœ‰æ•ˆæ–¹æ³•æ˜¯ä½¿ç”¨é€æ˜æ˜ å°„åˆ° WebAssembly æ”¯æŒçš„æ•°æ®ç±»å‹çš„å€¼ç±»å‹ã€‚ å½“ç„¶ï¼Œç¼–è¯‘å™¨å…è®¸ä½ ä½¿ç”¨æ›´å¤æ‚çš„ç±»å‹ä½œä¸ºå‡½æ•°çš„å‚æ•°å’Œå€¼ã€‚ åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œç¼–è¯‘å™¨ç”Ÿæˆ &lt;a href=&#34;https://github.com/WebAssembly/tool-conventions/blob/main/BasicCABI.md&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;C ABI&lt;/a&gt; ä¸­æŒ‡å®šçš„ä»£ç ï¼ˆé™¤äº† rustc ç›®å‰ä¸å®Œå…¨ç¬¦åˆ C ABI çš„&lt;a href=&#34;https://github.com/rustwasm/team/issues/291&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä¸è¶³&lt;/a&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;æ— éœ€èµ˜è¿°ï¼Œç±»å‹å¤§å°ï¼ˆä¾‹å¦‚ï¼Œstructã€enum ç­‰ï¼‰å°±å˜æˆäº†ä¸€ä¸ªç®€å•çš„æŒ‡é’ˆã€‚ æ•°ç»„å’Œå…ƒç»„æ˜¯æœ‰å¤§å°çš„ç±»å‹ï¼Œå¦‚æœå®ƒä»¬ä½¿ç”¨å°‘äº 32 ä½ï¼Œå®ƒä»¬å°†è¢«è½¬æ¢ä¸ºç«‹å³å€¼ã€‚ æ›´å¤æ‚çš„æƒ…å†µæ˜¯å‡½æ•°è¿”å›å¤§äº 32 ä½çš„æ•°ç»„ç±»å‹çš„å€¼ï¼šå¦‚æœæ˜¯è¿™ç§æƒ…å†µï¼Œå‡½æ•°å°†ä¸ä¼šæ”¶åˆ°è¿”å›å€¼ï¼Œè€Œæ˜¯ä¼šæ”¶åˆ°ä¸€ä¸ªé™„åŠ ç±»å‹çš„å‚æ•° i32ï¼Œè¯¥å‡½æ•°å°†åˆ©ç”¨æŒ‡å‘æ­¤å‚æ•°çš„æŒ‡é’ˆæ¥å­˜å‚¨ç»“æœã€‚ å¦‚æœä¸€ä¸ªå‡½æ•°è¿”å›ä¸€ä¸ªå…ƒç»„ï¼Œæ— è®ºå…ƒç»„çš„å¤§å°å¦‚ä½•ï¼Œå®ƒæ€»æ˜¯è¢«è®¤ä¸ºæ˜¯å‡½æ•°çš„å‚æ•°ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;(?Sized)&lt;/code&gt; å…·æœ‰æœªæŒ‡å®šç±»å‹çš„å‡½æ•°å‚æ•°ï¼Œä¾‹å¦‚ &lt;code&gt;str&lt;/code&gt;ã€&lt;code&gt;[u8]&lt;/code&gt; æˆ– &lt;code&gt;dyn MyTrait&lt;/code&gt;ï¼Œç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼šç¬¬ä¸€éƒ¨åˆ†æ˜¯æŒ‡å‘æ•°æ®çš„æŒ‡é’ˆï¼Œç¬¬äºŒéƒ¨åˆ†æ˜¯æŒ‡å‘å…ƒæ•°æ®çš„æŒ‡é’ˆã€‚ å¦‚æœæ˜¯ str çš„ä¸€ä¸ªæˆ–ä¸€éƒ¨åˆ†ï¼Œåˆ™å…ƒæ•°æ®æ˜¯æ•°æ®çš„é•¿åº¦ã€‚ åœ¨ç‰¹å¾å¯¹è±¡çš„å®ä¾‹ä¸­ï¼Œå®ƒæ˜¯ä¸€ä¸ªè™šæ‹Ÿè¡¨ï¼ˆæˆ– vtableï¼‰ï¼Œå®ƒæ˜¯æŒ‡å‘å„ä¸ªç‰¹å¾å‡½æ•°å®ç°çš„å‡½æ•°æŒ‡é’ˆåˆ—è¡¨ã€‚ å¦‚æœä½ æƒ³äº†è§£æ›´å¤šæœ‰å…³ Rust ä¸­çš„ VTable çš„ä¿¡æ¯ï¼Œæˆ‘å¯ä»¥æ¨è Thomas BÃ¤chler çš„&lt;a href=&#34;https://articles.bchlr.de/traits-dynamic-dispatch-upcasting&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è¿™ç¯‡æ–‡ç« &lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘åœ¨è¿™é‡Œçœç•¥äº†é‡è¦çš„ç»†èŠ‚ï¼Œå› ä¸ºå»ºè®®ä½ ä¸è¦ç¼–å†™ä¸‹ä¸€ä¸ª wasm-bindgenï¼Œé™¤éä½ éè¦è¿™æ ·åšã€‚ æˆ‘å»ºè®®ä¾é ç°æœ‰å·¥å…·è€Œä¸æ˜¯åˆ›å»ºæ–°å·¥å…·ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ¨¡å—å¤§å°&#34;&gt;æ¨¡å—å¤§å°&lt;/h2&gt;
&lt;p&gt;å½“ WebAssembly éƒ¨ç½²åœ¨ web ä¸Šæ—¶ï¼Œå®ƒçš„äºŒè¿›åˆ¶æ–‡ä»¶çš„å¤§å°éå¸¸é‡è¦ã€‚ æ¯ä¸€ç‚¹éƒ½å¿…é¡»é€šè¿‡ç½‘ç»œä¼ è¾“å¹¶é€šè¿‡æµè§ˆå™¨çš„ WebAssembly ç¼–è¯‘å™¨ï¼Œå› æ­¤ï¼Œè¾ƒå°çš„äºŒè¿›åˆ¶å¤§å°æ„å‘³ç€åœ¨ WebAssembly å¼€å§‹è¿è¡Œä¹‹å‰ç”¨æˆ·ç­‰å¾…çš„æ—¶é—´æ›´å°‘ã€‚ å¦‚æœæˆ‘ä»¬å°†é»˜è®¤é¡¹ç›®æ„é€ ä¸ºå‘å¸ƒç‰ˆæœ¬ï¼Œæˆ‘ä»¬å°†ç”Ÿæˆ 1.7MB çš„ WebAssemblyã€‚ è¿™å¯¹äºä¸¤ä¸ªæ•°å­—ç›¸åŠ çš„åŠŸèƒ½ä¼¼ä¹å¤ªå¤§äº†ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æ•°æ®éƒ¨åˆ†ï¼šWebAssembly æ¨¡å—çš„å¤§éƒ¨åˆ†ç”±æ•°æ®ç»„æˆã€‚ å³æ•°æ®åœ¨ç‰¹å®šç‚¹ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œç„¶åå¤åˆ¶åˆ°çº¿æ€§å†…å­˜ã€‚ è¿™äº›éƒ¨åˆ†çš„ç¼–è¯‘æˆæœ¬å¾ˆä½ï¼Œå› ä¸ºç¼–è¯‘å™¨ä¼šè·³è¿‡å®ƒä»¬ï¼Œåœ¨åˆ†æå’Œå‡å°‘æ¨¡å—çš„å¯åŠ¨æ—¶é—´æ—¶è¯·è®°ä½è¿™ä¸€ç‚¹ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ£€æŸ¥ WebAssembly æ¨¡å—å†…éƒ¨ç»“æ„çš„ä¸€ç§ç®€å•æ–¹æ³•æ˜¯ &lt;code&gt;llvm-objdump&lt;/code&gt;ï¼Œè¿™åº”è¯¥å¯ä»¥åœ¨ä½ çš„ç³»ç»Ÿä¸Šè®¿é—®ã€‚ æˆ–è€…ï¼Œä½ å¯ä»¥ä½¿ç”¨ &lt;code&gt;wasm-objdump&lt;/code&gt;ï¼Œå®ƒæ˜¯ wabt çš„ä¸€éƒ¨åˆ†ï¼Œé€šå¸¸æä¾›ç›¸åŒçš„æ¥å£ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ llvm-objdump -h target/wasm32-unknown-unknown/release/my_project.wasm
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;target/wasm32-unknown-unknown/release/my_project.wasm: file format wasm
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Sections:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Idx Name            Size     VMA      Type
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; TYPE            &lt;span class=&#34;m&#34;&gt;00000007&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;00000000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; FUNCTION        &lt;span class=&#34;m&#34;&gt;00000002&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;00000000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; TABLE           &lt;span class=&#34;m&#34;&gt;00000005&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;00000000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; MEMORY          &lt;span class=&#34;m&#34;&gt;00000003&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;00000000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; GLOBAL          &lt;span class=&#34;m&#34;&gt;00000019&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;00000000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;m&#34;&gt;5&lt;/span&gt; EXPORT          0000002b &lt;span class=&#34;m&#34;&gt;00000000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;m&#34;&gt;6&lt;/span&gt; CODE            &lt;span class=&#34;m&#34;&gt;00000009&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;00000000&lt;/span&gt; TEXT
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;m&#34;&gt;7&lt;/span&gt; .debug_info     00062c72 &lt;span class=&#34;m&#34;&gt;00000000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;m&#34;&gt;8&lt;/span&gt; .debug_pubtypes &lt;span class=&#34;m&#34;&gt;00000144&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;00000000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;m&#34;&gt;9&lt;/span&gt; .debug_ranges   0002af80 &lt;span class=&#34;m&#34;&gt;00000000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;m&#34;&gt;10&lt;/span&gt; .debug_abbrev   &lt;span class=&#34;m&#34;&gt;00001055&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;00000000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;m&#34;&gt;11&lt;/span&gt; .debug_line     00045d24 &lt;span class=&#34;m&#34;&gt;00000000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;m&#34;&gt;12&lt;/span&gt; .debug_str      0009f40c &lt;span class=&#34;m&#34;&gt;00000000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;m&#34;&gt;13&lt;/span&gt; .debug_pubnames 0003e3f2 &lt;span class=&#34;m&#34;&gt;00000000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;m&#34;&gt;14&lt;/span&gt; name            0000001c &lt;span class=&#34;m&#34;&gt;00000000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt; producers       &lt;span class=&#34;m&#34;&gt;00000043&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;00000000&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;llvm-objdump&lt;/code&gt; è¿‡äºç¬¼ç»Ÿï¼Œä¸ºé‚£äº›æœ‰ä½¿ç”¨å…¶ä»–è¯­è¨€æ±‡ç¼–ç»éªŒçš„äººæä¾›ç†Ÿæ‚‰çš„å‘½ä»¤è¡Œã€‚ ç„¶è€Œï¼Œä¸“é—¨ç”¨äºè°ƒè¯•äºŒè¿›åˆ¶å­—ç¬¦ä¸²çš„å¤§å°ï¼Œå®ƒç¼ºå°‘ç®€å•çš„å·¥å…·ï¼Œå¦‚æŒ‰å¤§å°æ’åºéƒ¨åˆ†æˆ–æŒ‰åŠŸèƒ½åˆ†è§£éƒ¨åˆ†ã€‚ å¹¸è¿çš„æ˜¯ï¼Œæœ‰ä¸“é—¨ä¸ºæ­¤è®¾è®¡çš„ WebAssembly ä¸“ç”¨å·¥å…· &lt;a href=&#34;https://rustwasm.github.io/twiggy/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Twiggy&lt;/a&gt;ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ twiggy top target/wasm32-unknown-unknown/release/my_project.wasm
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; Shallow Bytes â”‚ Shallow % â”‚ Item
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;m&#34;&gt;652300&lt;/span&gt; â”Š    36.67% â”Š custom section &lt;span class=&#34;s1&#34;&gt;&amp;#39;.debug_str&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;m&#34;&gt;404594&lt;/span&gt; â”Š    22.75% â”Š custom section &lt;span class=&#34;s1&#34;&gt;&amp;#39;.debug_info&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;m&#34;&gt;285988&lt;/span&gt; â”Š    16.08% â”Š custom section &lt;span class=&#34;s1&#34;&gt;&amp;#39;.debug_line&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;m&#34;&gt;254962&lt;/span&gt; â”Š    14.33% â”Š custom section &lt;span class=&#34;s1&#34;&gt;&amp;#39;.debug_pubnames&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;m&#34;&gt;176000&lt;/span&gt; â”Š     9.89% â”Š custom section &lt;span class=&#34;s1&#34;&gt;&amp;#39;.debug_ranges&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;          &lt;span class=&#34;m&#34;&gt;4181&lt;/span&gt; â”Š     0.24% â”Š custom section &lt;span class=&#34;s1&#34;&gt;&amp;#39;.debug_abbrev&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;           &lt;span class=&#34;m&#34;&gt;324&lt;/span&gt; â”Š     0.02% â”Š custom section &lt;span class=&#34;s1&#34;&gt;&amp;#39;.debug_pubtypes&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;m&#34;&gt;67&lt;/span&gt; â”Š     0.00% â”Š custom section &lt;span class=&#34;s1&#34;&gt;&amp;#39;producers&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;m&#34;&gt;25&lt;/span&gt; â”Š     0.00% â”Š custom section &lt;span class=&#34;s1&#34;&gt;&amp;#39;name&amp;#39;&lt;/span&gt; headers
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;m&#34;&gt;20&lt;/span&gt; â”Š     0.00% â”Š custom section &lt;span class=&#34;s1&#34;&gt;&amp;#39;.debug_pubnames&amp;#39;&lt;/span&gt; headers
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;m&#34;&gt;19&lt;/span&gt; â”Š     0.00% â”Š custom section &lt;span class=&#34;s1&#34;&gt;&amp;#39;.debug_pubtypes&amp;#39;&lt;/span&gt; headers
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;m&#34;&gt;18&lt;/span&gt; â”Š     0.00% â”Š custom section &lt;span class=&#34;s1&#34;&gt;&amp;#39;.debug_ranges&amp;#39;&lt;/span&gt; headers
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;m&#34;&gt;17&lt;/span&gt; â”Š     0.00% â”Š custom section &lt;span class=&#34;s1&#34;&gt;&amp;#39;.debug_abbrev&amp;#39;&lt;/span&gt; headers
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; â”Š     0.00% â”Š custom section &lt;span class=&#34;s1&#34;&gt;&amp;#39;.debug_info&amp;#39;&lt;/span&gt; headers
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; â”Š     0.00% â”Š custom section &lt;span class=&#34;s1&#34;&gt;&amp;#39;.debug_line&amp;#39;&lt;/span&gt; headers
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt; â”Š     0.00% â”Š custom section &lt;span class=&#34;s1&#34;&gt;&amp;#39;.debug_str&amp;#39;&lt;/span&gt; headers
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;m&#34;&gt;14&lt;/span&gt; â”Š     0.00% â”Š &lt;span class=&#34;nb&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;__heap_base&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;m&#34;&gt;13&lt;/span&gt; â”Š     0.00% â”Š &lt;span class=&#34;nb&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;__data_end&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;            &lt;span class=&#34;m&#34;&gt;12&lt;/span&gt; â”Š     0.00% â”Š custom section &lt;span class=&#34;s1&#34;&gt;&amp;#39;producers&amp;#39;&lt;/span&gt; headers
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;             &lt;span class=&#34;m&#34;&gt;9&lt;/span&gt; â”Š     0.00% â”Š &lt;span class=&#34;nb&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;memory&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;             &lt;span class=&#34;m&#34;&gt;9&lt;/span&gt; â”Š     0.00% â”Š add
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;...
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç°åœ¨å¾ˆæ˜æ˜¾ï¼Œæ¨¡å—å¤§å°çš„æ‰€æœ‰ä¸»è¦è´¡çŒ®è€…éƒ½æ˜¯ä¸æ¨¡å—ç”¨é€”æ— å…³çš„è‡ªå®šä¹‰ç»„ä»¶ã€‚ å®ƒä»¬çš„æ ‡é¢˜æš—ç¤ºå®ƒä»¬åŒ…å«ç”¨äºæ•…éšœæ’é™¤çš„ä¿¡æ¯ï¼Œå› æ­¤è¿™äº›éƒ¨åˆ†æ˜¯ä¸ºæ„å»ºå’Œå‘å¸ƒè€Œå‘å‡ºçš„è¿™ä¸€äº‹å®æœ‰äº›ä¸åˆå¸¸è§„ã€‚ è¿™ä¼¼ä¹ä¸æˆ‘ä»¬ä»£ç çš„ä¸€ä¸ªé•¿æœŸå­˜åœ¨çš„é—®é¢˜æœ‰å…³ï¼Œè¯¥é—®é¢˜å¯¼è‡´å®ƒåœ¨ç¼–è¯‘æ—¶æ²¡æœ‰è°ƒè¯•ç¬¦å·ï¼Œä½†åœ¨æˆ‘ä»¬çš„æœºå™¨ä¸Šé¢„ç¼–è¯‘çš„æ ‡å‡†åº“ä»ç„¶æœ‰è°ƒè¯•ç¬¦å·ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬åœ¨ &lt;code&gt;Cargo.toml&lt;/code&gt; ä¸­æ·»åŠ äº†ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-toml&#34; data-lang=&#34;toml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;profile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;release&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;strip&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™å°†å¯¼è‡´ &lt;code&gt;rustc&lt;/code&gt; åˆ é™¤æ‰€æœ‰è‡ªå®šä¹‰éƒ¨åˆ†ï¼ŒåŒ…æ‹¬ä¸ºå‡½æ•°åˆ†é…åç§°çš„éƒ¨åˆ†ã€‚ è¿™å¯èƒ½ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼Œå› ä¸º twiggy çš„è¾“å‡ºå°†åªåŒ…å« &lt;code&gt;saycode[0]&lt;/code&gt; æˆ–ç±»ä¼¼çš„å‡½æ•°ã€‚ å¦‚æœä½ æƒ³ç»´æŠ¤å‡½æ•°åç§°ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç‰¹å®šçš„æ¨¡å¼æ¥åˆ é™¤ä¿¡æ¯ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-toml&#34; data-lang=&#34;toml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;profile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;release&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;strip&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;strip&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;debuginfo&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¦‚æœä½ æƒ³å®Œå…¨ç»†ç²’åº¦æ§åˆ¶ï¼Œä½ å¯ä»¥æ¢å¤å¹¶å®Œå…¨ç¦ç”¨ &lt;code&gt;rustc&lt;/code&gt; çš„ strip æ–¹æ³•ï¼Œè€Œæ˜¯ä½¿ç”¨ &lt;code&gt;llvm-strip&lt;/code&gt; æˆ– &lt;code&gt;wasm-strip&lt;/code&gt;ã€‚ è¿™ä½¿ä½ èƒ½å¤Ÿå†³å®šåº”ä¿ç•™å“ªäº›è‡ªå®šä¹‰éƒ¨ä»¶ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;llvm-strip --keep-section&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;name target/wasm32-unknown-unknown/release/my_project.wasm
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç§»é™¤å¤–å±‚åï¼Œæˆ‘ä»¬å‰©ä¸‹ä¸€ä¸ªä¸ 116B ä¸€æ ·å¤§æˆ–å¤§äº 116B çš„å—ã€‚ æ‹†è§£å®ƒä¼šå‘ç°è¯¥æ¨¡å—çš„å”¯ä¸€ç›®çš„æ˜¯è°ƒç”¨ add å¹¶æ‰§è¡Œ &lt;code&gt;(f64.add (local.get 0) (local.get 1))&lt;/code&gt;ï¼Œè¿™æ„å‘³ç€ Rust ç¼–è¯‘å™¨èƒ½å¤Ÿç”Ÿæˆæœ€ä½³ä»£ç ã€‚ å½“ç„¶ï¼Œä»£ç åº“çš„å¤§å°å¢åŠ äº†ï¼Œè¿™ä½¿å¾—æŒæ¡äºŒè¿›åˆ¶å¤§å°å˜å¾—æ›´åŠ å›°éš¾ã€‚&lt;/p&gt;
&lt;h3 id=&#34;è‡ªå®šä¹‰éƒ¨åˆ†&#34;&gt;è‡ªå®šä¹‰éƒ¨åˆ†&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;æœ‰è¶£çš„äº‹å®ï¼šæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Rust å°†æˆ‘ä»¬çš„è‡ªå®šä¹‰éƒ¨åˆ†æ·»åŠ åˆ° WebAssembly æ¨¡å—ä¸­ã€‚ å¦‚æœæˆ‘ä»¬å£°æ˜ä¸€ä¸ªå­—èŠ‚æ•°ç»„ï¼ˆä¸æ˜¯åˆ‡ç‰‡ï¼ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥æ·»åŠ ä¸€ä¸ª &lt;code&gt;#[link_section=...]&lt;/code&gt; å±æ€§æ¥å°†è¿™äº›å­—èŠ‚æ‰“åŒ…åˆ°å®ƒè‡ªå·±çš„éƒ¨åˆ†ä¸­ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;const&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;_&lt;/span&gt;: &lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;#[link_section = &lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;surmsection&amp;#34;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;static&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SECTION_CONTENT&lt;/span&gt;: &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;u8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;11&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;b&amp;#34;hello world&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;};&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ &lt;a href=&#34;https://developer.mozilla.org/en-US/docs/WebAssembly/JavaScript_interface/Module/customSections&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;code&gt;WebAssembly.Module.customSection()&lt;/code&gt; AP&lt;/a&gt;I æˆ–ä½¿ç”¨ &lt;code&gt;llvm-objdump&lt;/code&gt; æå–è¿™äº›æ•°æ®ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ llvm-objdump -s -j surmsection target/wasm32-unknown-unknown/release/my_project.wasm
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;target/wasm32-unknown-unknown/release/my_project.wasm: file format wasm
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Contents of section surmsection:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;m&#34;&gt;0000&lt;/span&gt; 68656c6c 6f20776f 726c64             hello world
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;å·å·æ‘¸æ‘¸çš„è†¨èƒ€&#34;&gt;å·å·æ‘¸æ‘¸çš„è†¨èƒ€&lt;/h3&gt;
&lt;p&gt;æˆ‘åœ¨ç½‘ä¸Šçœ‹åˆ°ä¸€äº›å…³äº Rust ä¸ºçœ‹ä¼¼å¾ˆå°çš„å·¥ä½œåˆ›å»º WebAssembly æ¨¡å—çš„æŠ±æ€¨ã€‚ æ ¹æ®æˆ‘çš„ç»éªŒï¼ŒRust åˆ›å»ºçš„ WebAssembly äºŒè¿›åˆ¶æ–‡ä»¶å¯èƒ½å¾ˆå¤§çš„åŸå› æœ‰ä»¥ä¸‹ä¸‰ä¸ªï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è°ƒè¯•æ„å»ºï¼ˆå³å¿˜è®°å°† &lt;code&gt;--release&lt;/code&gt; ä¼ é€’ç»™ Cargoï¼‰&lt;/li&gt;
&lt;li&gt;è°ƒè¯•ç¬¦å·ï¼ˆå³å¿˜è®°è¿è¡Œ &lt;code&gt;llvm-strip&lt;/code&gt;ï¼‰&lt;/li&gt;
&lt;li&gt;æ„å¤–çš„å­—ç¬¦ä¸²æ ¼å¼å’Œææ…Œ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æˆ‘ä»¬å·²ç»çœ‹åˆ°äº†å‰ä¸¤ä¸ªã€‚ è®©æˆ‘ä»¬ä»”ç»†çœ‹çœ‹æœ€åä¸€ä¸ªã€‚ è¿™ä¸ªæ— å®³çš„ç¨‹åºç¼–è¯‘æˆ 18KB çš„ WebAssemblyï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;static&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;PRIMES&lt;/span&gt;: &lt;span class=&#34;kp&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;i32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;11&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;13&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;17&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;19&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;23&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;#[no_mangle]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;extern&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;C&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;nth_prime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;: &lt;span class=&#34;kt&#34;&gt;usize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;kt&#34;&gt;i32&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;PRIMES&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¥½å§ï¼Œä¹Ÿè®¸å®ƒæ¯•ç«Ÿä¸æ˜¯é‚£ä¹ˆæ— å®³ã€‚ ä½ å¯èƒ½å·²ç»çŸ¥é“æˆ‘è¦å¹²å˜›äº†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ææ…Œ&#34;&gt;ææ…Œ&lt;/h3&gt;
&lt;p&gt;å¿«é€Ÿæµè§ˆä¸€ä¸‹ twiggy å°±ä¼šå‘ç°ï¼Œå½±å“ Wasm æ¨¡å—å¤§å°çš„ä¸»è¦å› ç´ æ˜¯ä¸å­—ç¬¦ä¸²æ ¼å¼åŒ–ã€ææ…Œå’Œå†…å­˜åˆ†é…ç›¸å…³çš„å‡½æ•°ã€‚ è¿™è¯´å¾—é€šï¼ å‚æ•° n æœªæ¸…ç†å¹¶ç”¨äºç´¢å¼•æ•°ç»„ã€‚ Rust åˆ«æ— é€‰æ‹©ï¼Œåªèƒ½æ³¨å…¥è¾¹ç•Œæ£€æŸ¥ã€‚ å¦‚æœè¾¹ç•Œæ£€æŸ¥å¤±è´¥ï¼ŒRust ä¼šå´©æºƒï¼Œè¿™æ˜¯åˆ›å»ºæ ¼å¼æ­£ç¡®çš„é”™è¯¯æ¶ˆæ¯å’Œå †æ ˆè·Ÿè¸ªæ‰€å¿…éœ€çš„ã€‚&lt;/p&gt;
&lt;p&gt;è§£å†³è¿™ä¸ªé—®é¢˜çš„ä¸€ç§æ–¹æ³•æ˜¯è‡ªå·±è¿›è¡Œè¾¹ç•Œæ£€æŸ¥ã€‚ Rust çš„ç¼–è¯‘å™¨éå¸¸æ“…é•¿ä»…åœ¨éœ€è¦æ—¶æ³¨å…¥æ£€æŸ¥ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;nth_prime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;: &lt;span class=&#34;kt&#34;&gt;usize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;kt&#34;&gt;i32&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;||&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;PRIMES&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;PRIMES&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¯ä»¥è¯´æ›´æƒ¯ç”¨çš„æ–¹æ³•æ˜¯ä¾é &lt;code&gt;Option&amp;lt;T&amp;gt;&lt;/code&gt;API æ¥æ§åˆ¶é”™è¯¯æƒ…å†µçš„å¤„ç†æ–¹å¼ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;nth_prime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;: &lt;span class=&#34;kt&#34;&gt;usize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;kt&#34;&gt;i32&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;PRIMES&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;PRIMES&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;copied&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unwrap_or&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç¬¬ä¸‰ç§æ–¹æ³•æ˜¯ä½¿ç”¨ &lt;code&gt;unchecked&lt;/code&gt; Rust æ˜ç¡®æä¾›çš„ä¸€äº›æ–¹æ³•ã€‚ è¿™äº›ä¸ºæœªå®šä¹‰çš„è¡Œä¸ºæ‰“å¼€äº†å¤§é—¨ï¼Œå› æ­¤æ˜¯ &lt;code&gt;unsafe&lt;/code&gt;ï¼Œä½†å¦‚æœä½ èƒ½å¤Ÿæ‰¿æ‹…èµ·å®‰å…¨çš„é‡æ‹…ï¼Œæ€§èƒ½ï¼ˆæˆ–æ–‡ä»¶å¤§å°ï¼‰çš„æé«˜å°†æ˜¯æ˜¾ç€çš„ï¼&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;nth_prime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;: &lt;span class=&#34;kt&#34;&gt;usize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;kt&#34;&gt;i32&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;PRIMES&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;PRIMES&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get_unchecked&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æˆ‘ä»¬å¯ä»¥å°è¯•å¤„ç†ææ…Œå¯èƒ½å‘ç”Ÿçš„ä½ç½®ï¼Œå¹¶å°è¯•æ‰‹åŠ¨å¤„ç†è¿™äº›è·¯å¾„ã€‚ ç„¶è€Œï¼Œä¸€æ—¦æˆ‘ä»¬å¼€å§‹ä¾èµ–ç¬¬ä¸‰æ–¹ crateï¼ŒæˆåŠŸçš„æœºä¼šå°±ä¼šå‡å°‘ï¼Œå› ä¸ºæˆ‘ä»¬æ— æ³•è½»æ˜“æ”¹å˜åº“å†…éƒ¨å¤„ç†é”™è¯¯çš„æ–¹å¼ã€‚&lt;/p&gt;
&lt;h3 id=&#34;lto&#34;&gt;LTO&lt;/h3&gt;
&lt;p&gt;æˆ‘ä»¬å¯èƒ½ä¸å¾—ä¸æ¥å—è¿™æ ·ä¸€ä¸ªäº‹å®ï¼Œå³æˆ‘ä»¬æ— æ³•é¿å…ä»£ç åº“ä¸­å‡ºç° panic çš„ä»£ç è·¯å¾„ã€‚ è™½ç„¶æˆ‘ä»¬å¯ä»¥å°è¯•å‡è½»ææ…Œçš„å½±å“ï¼ˆæˆ‘ä»¬ä¼šçš„ï¼ï¼‰ï¼Œä½†æœ‰ä¸€ä¸ªç›¸å½“å¼ºå¤§çš„ä¼˜åŒ–é€šå¸¸å¯ä»¥èŠ‚çœä¸€äº›é‡è¦çš„ä»£ç ã€‚ è¿™ä¸ªä¼˜åŒ–è¿‡ç¨‹ç”± LLVM æä¾›ï¼Œç§°ä¸º &lt;a href=&#34;https://llvm.org/docs/LinkTimeOptimization.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;LTOï¼ˆLink Time Optimizationï¼Œé“¾æ¥æ—¶ä¼˜åŒ–ï¼‰&lt;/a&gt;ã€‚ &lt;code&gt;rustc&lt;/code&gt; åœ¨å°†æ‰€æœ‰å†…å®¹é“¾æ¥åˆ°æœ€ç»ˆäºŒè¿›åˆ¶æ–‡ä»¶ä¹‹å‰ç¼–è¯‘å’Œä¼˜åŒ–æ¯ä¸ª crateã€‚ ç„¶è€Œï¼Œä¸€äº›ä¼˜åŒ–åªæœ‰åœ¨é“¾æ¥åæ‰ä¼šå˜å¾—æ˜æ˜¾ã€‚ ä¾‹å¦‚ï¼Œè®¸å¤šå‡½æ•°æ ¹æ®è¾“å…¥æœ‰ä¸åŒçš„åˆ†æ”¯ã€‚ åœ¨ç¼–è¯‘æœŸé—´ï¼Œä½ åªä¼šçœ‹åˆ°æ¥è‡ªåŒä¸€ä¸ª crate çš„å‡½æ•°è°ƒç”¨ã€‚ åœ¨é“¾æ¥æ—¶ï¼Œä½ çŸ¥é“å¯¹ä»»ä½•ç»™å®šå‡½æ•°çš„æ‰€æœ‰å¯èƒ½è°ƒç”¨ï¼Œè¿™æ„å‘³ç€ç°åœ¨å¯ä»¥æ¶ˆé™¤å…¶ä¸­ä¸€äº›ä»£ç åˆ†æ”¯ã€‚&lt;/p&gt;
&lt;p&gt;LTO é»˜è®¤å¤„äºå…³é—­çŠ¶æ€ï¼Œå› ä¸ºå®ƒæ˜¯ä¸€é¡¹ä»£ä»·é«˜æ˜‚çš„ä¼˜åŒ–ï¼Œä¼šæ˜¾ç€å‡æ…¢ç¼–è¯‘æ—¶é—´ï¼Œå°¤å…¶æ˜¯åœ¨è¾ƒå¤§çš„ crate ä¸­ã€‚  ä½ å¯ä»¥é€šè¿‡åœ¨ Cargo.toml ä¸­é…ç½® &lt;code&gt;rustc&lt;/code&gt; çš„è®¸å¤šä»£ç ç”Ÿæˆé€‰é¡¹å¯ç”¨ã€‚ å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬éœ€è¦å°†è¿™ä¸€è¡Œæ·»åŠ åˆ°æˆ‘ä»¬çš„ &lt;code&gt;Cargo.toml&lt;/code&gt; ä¸­ä»¥åœ¨å‘å¸ƒç‰ˆæœ¬ä¸­å¯ç”¨ LTOï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-toml&#34; data-lang=&#34;toml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;package&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;name&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;my_project&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;version&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;0.1.0&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;edition&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;2021&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;lib&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;crate-type&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;cdylib&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;profile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;release&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;lto&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¯ç”¨ LTO åï¼Œå‰¥ç¦»çš„äºŒè¿›åˆ¶æ–‡ä»¶å‡å°‘åˆ° 2.3Kï¼Œè¿™ä»¤äººå°è±¡æ·±åˆ»ã€‚ LTO çš„å”¯ä¸€æˆæœ¬æ˜¯æ›´é•¿çš„é“¾æ¥æ—¶é—´ï¼Œä½†å¦‚æœäºŒè¿›åˆ¶å¤§å°æ˜¯ä¸€ä¸ªé—®é¢˜ï¼ŒLTO å°†æˆä¸ºä¸€é¡¹åˆ©å™¨ï¼Œå› ä¸ºå®ƒâ€œä»…â€èŠ±è´¹æ„å»ºæ—¶é—´å¹¶ä¸”ä¸éœ€è¦æ›´æ”¹ä»£ç ã€‚&lt;/p&gt;
&lt;h3 id=&#34;wasm-opt&#34;&gt;wasm-opt&lt;/h3&gt;
&lt;p&gt;å¦ä¸€ä¸ªå‡ ä¹åº”è¯¥æˆä¸ºæ„å»ºç®¡é“ä¸€éƒ¨åˆ†çš„å·¥å…·æ˜¯æ¥è‡ª &lt;a href=&#34;https://github.com/WebAssembly/binaryen&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;binaryen&lt;/a&gt; çš„ &lt;code&gt;wasm-opt&lt;/code&gt;ã€‚ å®ƒæ˜¯å¦ä¸€ä¸ªä¼˜åŒ–è¿‡ç¨‹çš„é›†åˆï¼Œå®Œå…¨åœ¨ WebAssembly VM æŒ‡ä»¤ä¸Šå·¥ä½œï¼Œç‹¬ç«‹äºç”Ÿæˆå®ƒä»¬çš„æºè¯­è¨€ã€‚ åƒ Rust è¿™æ ·çš„é«˜çº§è¯­è¨€æœ‰æ›´å¤šçš„ä¿¡æ¯å¯ä»¥ç”¨æ¥åº”ç”¨æ›´å¤æ‚çš„ä¼˜åŒ–ï¼Œæ‰€ä»¥ &lt;code&gt;wasm-opt&lt;/code&gt; ä¸èƒ½æ›¿ä»£ä½ çš„è¯­è¨€ç¼–è¯‘å™¨çš„ä¼˜åŒ–ã€‚ ä½†æ˜¯ï¼Œå®ƒé€šå¸¸è®¾æ³•å°†æ¨¡å—å¤§å°å‡å°‘å‡ ä¸ªé¢å¤–çš„å­—èŠ‚ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;wasm-opt -O3 -o output.wasm target/wasm32-unknown-unknown/my_project.wasm
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œ&lt;code&gt;wasm-opt&lt;/code&gt; è¿›ä¸€æ­¥ç¼©å°äº† Rust çš„ 2.3K WebAssembly äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæœ€åæ˜¯ 2.0Kã€‚ å¥½çš„ï¼ ä½†åˆ«æ‹…å¿ƒï¼Œæˆ‘ä¸ä¼šå°±æ­¤æ‰“ä½ã€‚ è¿™å¯¹äºæ•°ç»„ä¸­çš„æŸ¥æ‰¾æ¥è¯´ä»ç„¶å¤ªå¤§äº†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;éæ ‡å‡†&#34;&gt;éæ ‡å‡†&lt;/h2&gt;
&lt;p&gt;Rust æœ‰ä¸€ä¸ª&lt;a href=&#34;https://docs.rs/std&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ ‡å‡†åº“&lt;/a&gt;ï¼Œå…¶ä¸­åŒ…å«ä½ æ¯å¤©è¿›è¡Œç³»ç»Ÿç¼–ç¨‹æ—¶æ‰€éœ€çš„è®¸å¤šæŠ½è±¡å’Œå®ç”¨ç¨‹åºï¼šè®¿é—®æ–‡ä»¶ã€è·å–å½“å‰æ—¶é—´æˆ–æ‰“å¼€ç½‘ç»œå¥—æ¥å­—ã€‚ ä¸€åˆ‡éƒ½åœ¨é‚£é‡Œä¾›ä½ ä½¿ç”¨ï¼Œæ— éœ€å» &lt;a href=&#34;https://crates.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;crates.io&lt;/a&gt; æˆ–ç±»ä¼¼ç½‘ç«™ä¸Šæœç´¢ã€‚ ç„¶è€Œï¼Œè®¸å¤šæ•°æ®ç»“æ„å’Œå‡½æ•°å¯¹å®ƒä»¬çš„ä½¿ç”¨ç¯å¢ƒåšå‡ºäº†å‡è®¾ï¼šå®ƒä»¬å‡è®¾ç¡¬ä»¶çš„ç»†èŠ‚è¢«æŠ½è±¡æˆä¸€ä¸ªç»Ÿä¸€çš„ APIï¼Œå¹¶ä¸”å®ƒä»¬å‡è®¾å®ƒä»¬å¯ä»¥ä»¥æŸç§æ–¹å¼åˆ†é…ï¼ˆå’Œé‡Šæ”¾ï¼‰ä»»æ„å¤§å°çš„å†…å­˜å—ã€‚ é€šå¸¸ï¼Œè¿™ä¸¤é¡¹å·¥ä½œéƒ½æ˜¯ç”±æ“ä½œç³»ç»Ÿå®Œæˆçš„ï¼Œæˆ‘ä»¬å¤§å¤šæ•°äººæ¯å¤©éƒ½åœ¨æ“ä½œç³»ç»Ÿä¸Šå·¥ä½œã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ï¼Œå½“ä½ é€šè¿‡åŸå§‹ API å®ä¾‹åŒ– WebAssembly æ¨¡å—æ—¶ï¼Œæƒ…å†µå°±ä¸åŒäº†ï¼šæ²™ç®±ï¼ˆWebAssembly çš„å®šä¹‰å®‰å…¨åŠŸèƒ½ä¹‹ä¸€ï¼‰å°† WebAssembly ä»£ç ä¸ä¸»æœºéš”ç¦»å¼€æ¥ï¼Œä»è€Œä¸æ“ä½œç³»ç»Ÿéš”ç¦»å¼€æ¥ã€‚ ä½ çš„ä»£ç åªèƒ½è®¿é—®ä¸€å¤§å—çº¿æ€§å†…å­˜ï¼Œå®ƒç”šè‡³æ— æ³•å¼„æ¸…æ¥šå“ªäº›éƒ¨åˆ†æ­£åœ¨ä½¿ç”¨ï¼Œå“ªäº›éƒ¨åˆ†å¯ä»¥ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;WASIï¼šè¿™ä¸æ˜¯æœ¬æ–‡çš„ä¸€éƒ¨åˆ†ï¼Œä½†å°±åƒ WebAssembly æ˜¯å¯¹è¿è¡Œä»£ç çš„å¤„ç†å™¨çš„æŠ½è±¡ä¸€æ ·ï¼Œ&lt;a href=&#34;https://wasi.dev/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;WASI&lt;/a&gt;ï¼ˆWebAssembly ç³»ç»Ÿæ¥å£ï¼‰æ—¨åœ¨æˆä¸ºå¯¹è¿è¡Œä»£ç çš„æ“ä½œç³»ç»Ÿçš„æŠ½è±¡ï¼Œå¹¶ä¸ºä½ æä¾›å¯ä»¥ä½¿ç”¨å•ä¸€ã€ç»Ÿä¸€çš„ APIã€‚ Rust æ”¯æŒ WASIï¼Œå°½ç®¡ WASI æœ¬èº«ä»åœ¨å‘å±•ä¸­ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿™æ„å‘³ç€ Rust ç»™äº†æˆ‘ä»¬ä¸€ç§è™šå‡çš„å®‰å…¨æ„Ÿï¼ å®ƒä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªæ²¡æœ‰æ“ä½œç³»ç»Ÿæ”¯æŒçš„å®Œæ•´æ ‡å‡†åº“ã€‚ äº‹å®ä¸Šï¼Œè®¸å¤š stdlib æ¨¡å—åªæ˜¯åˆ«åæˆ–è€…å¤±è´¥äº†ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒä»¬åœ¨æ²¡æœ‰æ“ä½œç³»ç»Ÿæ”¯æŒçš„æƒ…å†µä¸‹ä¸èƒ½æ­£å¸¸å·¥ä½œã€‚åœ¨æ²¡æœ‰æ“ä½œç³»ç»Ÿæ”¯æŒçš„æƒ…å†µä¸‹ï¼Œè®¸å¤šè¿”å› &lt;code&gt;Result &amp;lt;T&amp;gt;&lt;/code&gt; ç±»å‹çš„å‡½æ•°å¯èƒ½ä¼šå› ä¸ºæ— æ³•æ­£å¸¸å·¥ä½œè€Œå§‹ç»ˆè¿”å› Errï¼Œè¿™æ„å‘³ç€æ— æ³•å¾—åˆ°æ­£ç¡®çš„æ“ä½œç»“æœã€‚åŒæ ·ï¼Œå…¶ä»–ä¸€äº›å‡½æ•°å¯èƒ½ä¼šå› ä¸ºæ— æ³•æ­£å¸¸å·¥ä½œè€Œå¯¼è‡´ç¨‹åºå´©æºƒã€‚&lt;/p&gt;
&lt;h3 id=&#34;å‘æ— æ“ä½œç³»ç»Ÿè®¾å¤‡å­¦ä¹ &#34;&gt;å‘æ— æ“ä½œç³»ç»Ÿè®¾å¤‡å­¦ä¹ &lt;/h3&gt;
&lt;p&gt;åªæ˜¯ä¸€ä¸ªçº¿æ€§å†…å­˜å—ã€‚ æ²¡æœ‰ç®¡ç†å†…å­˜æˆ–å¤–å›´è®¾å¤‡çš„ä¸­å¤®å®ä½“ã€‚ åªæ˜¯ç®—æœ¯ã€‚ å¦‚æœä½ æ›¾ç»ä½¿ç”¨è¿‡åµŒå…¥å¼ç³»ç»Ÿï¼Œè¿™å¬èµ·æ¥å¯èƒ½å¾ˆç†Ÿæ‚‰ã€‚ è™½ç„¶ç°ä»£åµŒå…¥å¼ç³»ç»Ÿè¿è¡Œ Linuxï¼Œä½†è¾ƒå°çš„å¾®å¤„ç†å™¨æ²¡æœ‰èµ„æºæ¥è¿™æ ·åšã€‚ &lt;a href=&#34;https://www.rust-lang.org/what/embedded&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Rust è¿˜é’ˆå¯¹é‚£äº›è¶…å—é™ç¯å¢ƒ&lt;/a&gt;ï¼Œ&lt;a href=&#34;https://docs.rust-embedded.org/book/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Embedded Rust Book&lt;/a&gt; å’Œ &lt;a href=&#34;https://docs.rust-embedded.org/embedonomicon/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Embedomicon&lt;/a&gt; è§£é‡Šäº†å¦‚ä½•ä¸ºè¿™äº›ç¯å¢ƒæ­£ç¡®ç¼–å†™ Rustã€‚&lt;/p&gt;
&lt;p&gt;è¦è¿›å…¥è£¸æœºä¸–ç•ŒğŸ¤˜ï¼Œæˆ‘ä»¬å¿…é¡»åœ¨ä»£ç ä¸­æ·»åŠ ä¸€è¡Œï¼š&lt;code&gt;#![no_std]&lt;/code&gt;ã€‚ è¿™ä¸ª crate å®å‘Šè¯‰ Rust ä¸è¦é“¾æ¥åˆ°æ ‡å‡†åº“ã€‚ ç›¸åï¼Œå®ƒåªé“¾æ¥åˆ° &lt;a href=&#34;https://docs.rs/core&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;core&lt;/a&gt;ã€‚ Embedonomicon éå¸¸ç®€æ´åœ°&lt;a href=&#34;https://docs.rust-embedded.org/embedonomicon/smallest-no-std.html#what-does-no_std-mean&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è§£é‡Š&lt;/a&gt;äº†è¿™æ„å‘³ç€ä»€ä¹ˆï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;core&lt;/code&gt; crate æ˜¯ &lt;code&gt;std&lt;/code&gt; crate çš„å­é›†ï¼Œå®ƒå¯¹ç¨‹åºå°†åœ¨å…¶ä¸Šè¿è¡Œçš„ç³»ç»Ÿåšå‡ºé›¶å‡è®¾ã€‚ å› æ­¤ï¼Œå®ƒä¸ºè¯­è¨€åŸè¯­ï¼ˆå¦‚æµ®ç‚¹æ•°ã€å­—ç¬¦ä¸²å’Œåˆ‡ç‰‡ï¼‰æä¾› APIï¼Œä»¥åŠå…¬å¼€å¤„ç†å™¨åŠŸèƒ½ï¼ˆå¦‚åŸå­æ“ä½œå’Œ SIMD æŒ‡ä»¤ï¼‰çš„ APIã€‚ ä½†æ˜¯ï¼Œå®ƒç¼ºå°‘ä»»ä½•å¤„ç†å †å†…å­˜åˆ†é…å’Œ I/O çš„ APIã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºåº”ç”¨ç¨‹åºï¼Œstd ä¸ä»…ä»…æ˜¯æä¾›ä¸€ç§è®¿é—®æ“ä½œç³»ç»ŸæŠ½è±¡çš„æ–¹æ³•ã€‚ std è¿˜è´Ÿè´£è®¾ç½®å †æ ˆæº¢å‡ºä¿æŠ¤ã€å¤„ç†å‘½ä»¤è¡Œå‚æ•°ä»¥åŠåœ¨è°ƒç”¨ç¨‹åºçš„ä¸»å‡½æ•°ä¹‹å‰ç”Ÿæˆä¸»çº¿ç¨‹ã€‚ &lt;code&gt;#![no_std]&lt;/code&gt; åº”ç”¨ç¨‹åºç¼ºå°‘æ‰€æœ‰æ ‡å‡†è¿è¡Œæ—¶ï¼Œå› æ­¤å¦‚æœéœ€è¦å®ƒå¿…é¡»åˆå§‹åŒ–è‡ªå·±çš„è¿è¡Œæ—¶ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿™å¬èµ·æ¥æœ‰ç‚¹å¯æ€•ï¼Œä½†è®©æˆ‘ä»¬ä¸€æ­¥ä¸€æ­¥æ¥ã€‚ æˆ‘ä»¬é¦–å…ˆå°†ä¸Šé¢çš„ panic-y ç´ æ•°ç¨‹åºå£°æ˜ä¸º &lt;code&gt;no_std&lt;/code&gt;ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;#![no_std]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;static&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;PRIMES&lt;/span&gt;: &lt;span class=&#34;kp&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;i32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;7&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;11&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;13&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;17&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;19&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;23&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;];&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;#[no_mangle]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;extern&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;C&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;nth_prime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;: &lt;span class=&#34;kt&#34;&gt;usize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;kt&#34;&gt;i32&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;PRIMES&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¾ˆé—æ†¾ï¼ŒEmbedonomicon æ®µè½é¢„ç¤ºäº†è¿™ä¸€ç‚¹ã€‚å› ä¸ºæˆ‘ä»¬æ²¡æœ‰æä¾›æ ¸å¿ƒä¾èµ–é¡¹çš„ä¸€äº›åŸºç¡€çŸ¥è¯†ã€‚ åœ¨åˆ—è¡¨çš„æœ€é¡¶éƒ¨ï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰åœ¨è¿™ç§ç¯å¢ƒä¸­å‘ç”Ÿææ…Œæ—¶åº”è¯¥å‘ç”Ÿä»€ä¹ˆã€‚ è¿™æ˜¯ç”±æ°å½“å‘½åçš„ææ…Œå¤„ç†ç¨‹åºå®Œæˆçš„ï¼ŒEmbedonomicon ç»™å‡ºäº†ä¸€ä¸ªä¾‹å­ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;#[panic_handler]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;panic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;_panic&lt;/span&gt;: &lt;span class=&#34;kp&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;core&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;panic&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;PanicInfo&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;_&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;loop&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™å¯¹äºåµŒå…¥å¼ç³»ç»Ÿæ¥è¯´æ˜¯éå¸¸å…¸å‹çš„ï¼Œæœ‰æ•ˆåœ°é˜»æ­¢äº†å¤„ç†å™¨åœ¨å´©æºƒå‘ç”Ÿåè¿›è¡Œä»»ä½•è¿›ä¸€æ­¥çš„å¤„ç†ã€‚ ç„¶è€Œï¼Œè¿™åœ¨ web ä¸Šä¸æ˜¯å¥½çš„è¡Œä¸ºï¼Œæ‰€ä»¥å¯¹äº WebAssemblyï¼Œæˆ‘é€šå¸¸é€‰æ‹©æ‰‹åŠ¨å‘å‡ºæ— æ³•è®¿é—®çš„æŒ‡ä»¤æ¥é˜»æ­¢ä»»ä½• Wasm VM è¿è¡Œï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;#[panic_handler]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;panic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;_panic&lt;/span&gt;: &lt;span class=&#34;kp&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;core&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;panic&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;PanicInfo&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;_&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;loop&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;core&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;arch&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;wasm32&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;unreachable&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æœ‰äº†è¿™ä¸ªï¼Œæˆ‘ä»¬çš„ç¨‹åºå†æ¬¡ç¼–è¯‘ã€‚ å‰¥ç¦»å’Œ &lt;code&gt;wasm-opt&lt;/code&gt; åï¼ŒäºŒè¿›åˆ¶æ–‡ä»¶å¤§å°ä¸º 168Bã€‚ æç®€ä¸»ä¹‰å†æ¬¡è·èƒœï¼&lt;/p&gt;
&lt;h2 id=&#34;å†…å­˜ç®¡ç†&#34;&gt;å†…å­˜ç®¡ç†&lt;/h2&gt;
&lt;p&gt;å½“ç„¶ï¼Œæˆ‘ä»¬å› éæ ‡å‡†è€Œæ”¾å¼ƒäº†å¾ˆå¤šã€‚ æ²¡æœ‰å †åˆ†é…ï¼Œå°±æ²¡æœ‰ &lt;code&gt;Box&lt;/code&gt;ï¼Œæ²¡æœ‰ &lt;code&gt;Vec&lt;/code&gt;ï¼Œæ²¡æœ‰ &lt;code&gt;String&lt;/code&gt; å’Œè®¸å¤šå…¶ä»–æœ‰ç”¨çš„ä¸œè¥¿ã€‚ å¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸æ”¾å¼ƒæ•´ä¸ªæ“ä½œç³»ç»Ÿçš„æƒ…å†µä¸‹å–å›è¿™äº›ä¸œè¥¿ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;std&lt;/code&gt; æä¾›çš„å¾ˆå¤šä¸œè¥¿å®é™…ä¸Šåªæ˜¯æ¥è‡ª &lt;code&gt;core&lt;/code&gt; çš„å¦ä¸€ä¸ªç§°ä¸º &lt;code&gt;alloc&lt;/code&gt; çš„ä¸œè¥¿ã€‚ &lt;code&gt;alloc&lt;/code&gt; åŒ…å«æœ‰å…³å†…å­˜åˆ†é…å’Œä¾èµ–äºå®ƒçš„æ•°æ®ç»“æ„çš„æ‰€æœ‰å†…å®¹ã€‚ é€šè¿‡å¯¼å…¥å®ƒï¼Œæˆ‘ä»¬å¯ä»¥é‡æ–°è·å¾—æˆ‘ä»¬ä¿¡ä»»çš„ &lt;code&gt;Vec&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;#![no_std]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// One of the few occastions where we have to use `extern crate`
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// even in Rust Edition 2021.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;extern&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;crate&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;alloc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;use&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;alloc&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;vec&lt;/span&gt;::&lt;span class=&#34;nb&#34;&gt;Vec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;#[no_mangle]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;extern&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;C&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;nth_prime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;: &lt;span class=&#34;kt&#34;&gt;usize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;kt&#34;&gt;usize&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// Please enjoy this horrible implementation of
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// The Sieve of Eratosthenes.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;mut&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;primes&lt;/span&gt;: &lt;span class=&#34;nb&#34;&gt;Vec&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;usize&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Vec&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;new&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;mut&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;current&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;while&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;primes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;n&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;primes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;iter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;any&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;prime&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;current&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;%&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;prime&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;primes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;push&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;current&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;current&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;primes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;into_iter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;last&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unwrap_or&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;#[panic_handler]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;panic&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;_panic&lt;/span&gt;: &lt;span class=&#34;kp&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;core&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;panic&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;PanicInfo&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;_&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;core&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;arch&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;wasm32&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;unreachable&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å½“ç„¶ï¼Œå°è¯•ç¼–è¯‘å®ƒä¼šå¤±è´¥â€”â€”æˆ‘ä»¬å®é™…ä¸Šå¹¶æ²¡æœ‰å‘Šè¯‰ Rust æˆ‘ä»¬çš„å†…å­˜ç®¡ç†æ˜¯ä»€ä¹ˆæ ·çš„ï¼ŒVec éœ€è¦çŸ¥é“å®ƒæ‰èƒ½è¿è¡Œã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ cargo build --target&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;wasm32-unknown-unknown --release
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;error: no global memory allocator found but one is required&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  link to std or add &lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;#[global_allocator]` to a static item that implements &lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  the GlobalAlloc trait
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;error: &lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;#[alloc_error_handler]` function required, but not found&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;note: use &lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;#![feature(default_alloc_error_handler)]` for a default error handler&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åœ¨æ’°å†™æœ¬æ–‡æ—¶ï¼Œåœ¨ Rust 1.67 ä¸­ï¼Œä½ éœ€è¦æä¾›ä¸€ä¸ªåœ¨åˆ†é…å¤±è´¥æ—¶è°ƒç”¨çš„é”™è¯¯å¤„ç†ç¨‹åºã€‚ åœ¨ä¸‹ä¸€ä¸ªç‰ˆæœ¬ä¸­ï¼ŒRust 1.68 &lt;code&gt;default_alloc_error_handler&lt;/code&gt; å·²ç»ç¨³å®šä¸‹æ¥ï¼Œè¿™æ„å‘³ç€æ¯ä¸ªéæ ‡å‡†çš„ Rust ç¨‹åºéƒ½å°†å¸¦æœ‰è¿™ä¸ªé”™è¯¯å¤„ç†ç¨‹åºçš„é»˜è®¤å®ç°ã€‚ å¦‚æœä½ ä»æƒ³æä¾›è‡ªå·±çš„é”™è¯¯å¤„ç†ç¨‹åºï¼Œä½ å¯ä»¥ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;cp&#34;&gt;#[alloc_error_handler]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;alloc_error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;_&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;core&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;alloc&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;Layout&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;core&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;arch&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;wasm32&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;unreachable&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æœ‰äº†è¿™ä¸ªå¤æ‚çš„é”™è¯¯å¤„ç†ç¨‹åºï¼Œæˆ‘ä»¬æœ€ç»ˆåº”è¯¥æä¾›ä¸€ç§æ–¹æ³•æ¥è¿›è¡Œå®é™…çš„å†…å­˜åˆ†é…ã€‚ å°±åƒæˆ‘åœ¨ &lt;a href=&#34;https://surma.dev/things/c-to-webassembly&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;C åˆ° WebAssembly&lt;/a&gt; çš„æ–‡ç« ä¸­ä¸€æ ·ï¼Œæˆ‘çš„è‡ªå®šä¹‰åˆ†é…å™¨å°†æ˜¯ä¸€ä¸ªæœ€å°çš„ bump åˆ†é…å™¨ï¼Œå®ƒå¾€å¾€åˆå¿«åˆå°ï¼Œä½†ä¸ä¼šé‡Šæ”¾å†…å­˜ã€‚ æˆ‘ä»¬é™æ€åˆ†é…ä¸€ä¸ª arena ä½œä¸ºæˆ‘ä»¬çš„å †ï¼Œå¹¶è·Ÿè¸ªâ€œç©ºé—²åŒºåŸŸâ€çš„å¼€å§‹ä½ç½®ã€‚ ç”±äºæˆ‘ä»¬ä¸ä½¿ç”¨ Wasm çº¿ç¨‹ï¼Œå› æ­¤æˆ‘ä¹Ÿä¼šå¿½ç•¥çº¿ç¨‹å®‰å…¨ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;use&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;core&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;cell&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;UnsafeCell&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;const&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ARENA_SIZE&lt;/span&gt;: &lt;span class=&#34;kt&#34;&gt;usize&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;128&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1024&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;#[repr(C, align(32))]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;SimpleAllocator&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arena&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;UnsafeCell&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;u8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ARENA_SIZE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;head&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;UnsafeCell&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;usize&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;impl&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SimpleAllocator&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;const&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;new&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;nc&#34;&gt;Self&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SimpleAllocator&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arena&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;UnsafeCell&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;new&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;([&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ARENA_SIZE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;head&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;UnsafeCell&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;new&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;impl&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Sync&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SimpleAllocator&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;#[global_allocator]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;static&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ALLOCATOR&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;SimpleAllocator&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SimpleAllocator&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;new&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å°† &lt;code&gt;#[global_allocator]&lt;/code&gt; å…¨å±€å˜é‡æ ‡è®°ä¸ºç®¡ç†å †çš„å®ä½“ã€‚ æ­¤å˜é‡çš„ç±»å‹å¿…é¡»å®ç° GlobalAlloc ç‰¹æ€§ã€‚ ç‰¹æ€§ä¸Šçš„ GlobalAlloc æ–¹æ³•éƒ½ä½¿ç”¨ &amp;amp;selfï¼Œæ‰€ä»¥å¦‚æœä½ æƒ³ä¿®æ”¹æ•°æ®ç±»å‹ä¸­çš„ä»»ä½•å€¼ï¼Œä½ å¿…é¡»ä½¿ç”¨å†…éƒ¨å¯å˜æ€§ã€‚ æˆ‘è¿™é‡Œé€‰æ‹©äº†UnsafeCellã€‚ ä½¿ç”¨ UnsafeCell ä½¿æˆ‘ä»¬çš„ç»“æ„éšå¼ !Syncï¼ŒRust ä¸å…è®¸å…¨å±€é™æ€å˜é‡ã€‚ è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬è¿˜å¿…é¡»æ‰‹åŠ¨å®ç° Synctrait æ¥å‘Šè¯‰ Rust æˆ‘ä»¬çŸ¥é“æˆ‘ä»¬æœ‰è´£ä»»ä½¿è¿™ç§æ•°æ®ç±»å‹æˆä¸ºçº¿ç¨‹å®‰å…¨çš„ï¼ˆè€Œæˆ‘ä»¬å®Œå…¨å¿½ç•¥äº†è¿™ä¸€ç‚¹ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;è¯¥ç»“æ„è¢«æ ‡è®°ä¸º &lt;code&gt;#[repr(C)]&lt;/code&gt; çš„åŸå› å¾ˆç®€å•ï¼Œä»¥ä¾¿æˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨æŒ‡å®šå¯¹é½æ–¹å¼ã€‚ è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ç¡®ä¿å³ä½¿æ˜¯ arena ä¸­çš„ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼ˆä»¥åŠæˆ‘ä»¬è¿”å›çš„ç¬¬ä¸€ä¸ªæŒ‡é’ˆçš„æ‰©å±•ï¼‰ä¹Ÿå…·æœ‰ 32 ä½å¯¹é½ï¼Œè¿™åº”è¯¥å¯ä»¥æ»¡è¶³å¤§å¤šæ•°æ•°æ®ç»“æ„ã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨ä¸ºç‰¹å¾çš„ GlobalAlloc çš„å®é™…å®ç°ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;impl&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;GlobalAlloc&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;SimpleAllocator&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;alloc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;layout&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;Layout&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;mut&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;u8&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;layout&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;align&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;layout&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;align&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// Find the next address that has the right alignment.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;idx&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;head&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()).&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;next_multiple_of&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;align&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// Bump the head to the next free byte
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;head&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;idx&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;size&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arena&lt;/span&gt;: &lt;span class=&#34;kp&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;mut&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;u8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ARENA_SIZE&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;mut&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arena&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;());&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// If we ran out of arena space, we return a null pointer, which
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// signals a failed allocation.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;match&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arena&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;get_mut&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;idx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Some&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;item&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;item&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;as&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;mut&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;u8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;_&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;core&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;ptr&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;null_mut&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;unsafe&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;dealloc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;_ptr&lt;/span&gt;: &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;mut&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;u8&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;_layout&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;Layout&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;cm&#34;&gt;/* lol */&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;#[global_allocator]&lt;/code&gt; ä¸ä»…ä»…æ˜¯ &lt;code&gt;#[no_std]&lt;/code&gt;ï¼ä½ è¿˜å¯ä»¥ä½¿ç”¨å®ƒæ¥è¦†ç›– Rust çš„é»˜è®¤åˆ†é…å™¨å¹¶å°†å…¶æ›¿æ¢ä¸ºä½ è‡ªå·±çš„åˆ†é…å™¨ï¼Œå› ä¸º Rust çš„é»˜è®¤åˆ†é…å™¨æ¶ˆè€—å¤§çº¦ 10K Wasm ç©ºé—´ã€‚&lt;/p&gt;
&lt;h3 id=&#34;wee_alloc&#34;&gt;wee_alloc&lt;/h3&gt;
&lt;p&gt;å½“ç„¶ï¼Œä½ ä¸å¿…è‡ªå·±å®ç°åˆ†é…å™¨ã€‚ äº‹å®ä¸Šï¼Œä¾é ç»è¿‡è‰¯å¥½æµ‹è¯•çš„å®æ–½å¯èƒ½æ˜¯æ˜æ™ºçš„ã€‚ å¤„ç†åˆ†é…å™¨ä¸­çš„é”™è¯¯å’Œå¾®å¦™çš„å†…å­˜æŸåå¹¶ä¸å¥½ç©ã€‚&lt;/p&gt;
&lt;p&gt;è®¸å¤šæŒ‡å—æ¨è &lt;code&gt;wee_alloc&lt;/code&gt;ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸å°çš„ (&amp;lt;1KB) åˆ†é…å™¨ï¼Œç”± Rust WebAssembly å›¢é˜Ÿç¼–å†™ï¼Œä¹Ÿå¯ä»¥é‡Šæ”¾å†…å­˜ã€‚ å¯æ‚²çš„æ˜¯ï¼Œå®ƒä¼¼ä¹æ²¡æœ‰å¾—åˆ°ç»´æŠ¤ï¼Œå¹¶ä¸”æœ‰ä¸€ä¸ª&lt;a href=&#34;https://github.com/rustwasm/wee_alloc/issues/105&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å…³äºå†…å­˜æŸåå’Œå†…å­˜æ³„æ¼çš„æœªè§£å†³é—®é¢˜&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ä»»ä½•ç›¸å½“å¤æ‚çš„ WebAssembly æ¨¡å—ä¸­ï¼ŒRust çš„é»˜è®¤åˆ†é…å™¨æ¶ˆè€—çš„ 10KB åªæ˜¯æ•´ä¸ªæ¨¡å—å¤§å°çš„ä¸€å°éƒ¨åˆ†ï¼Œæ‰€ä»¥æˆ‘å»ºè®®åšæŒä½¿ç”¨å®ƒå¹¶çŸ¥é“åˆ†é…å™¨ç»è¿‡è‰¯å¥½æµ‹è¯•å’Œæ€§èƒ½ã€‚&lt;/p&gt;
&lt;h2 id=&#34;wasm-bindgen&#34;&gt;wasm-bindgen&lt;/h2&gt;
&lt;p&gt;ç°åœ¨æˆ‘ä»¬å·²ç»å®Œæˆäº†å‡ ä¹æ‰€æœ‰å›°éš¾çš„äº‹æƒ…ï¼Œæˆ‘ä»¬å·²ç»çœ‹åˆ°äº†ä½¿ç”¨ &lt;a href=&#34;https://rustwasm.github.io/wasm-bindgen/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;wasm-bindgen&lt;/a&gt; ä¸º WebAssembly ç¼–å†™ Rust çš„ä¾¿æ·æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;wasm-bindgen çš„å…³é”®ç‰¹æ€§æ˜¯ &lt;code&gt;#[wasm_bindgen]&lt;/code&gt; å®ï¼Œæˆ‘ä»¬å¯ä»¥å°†å®ƒæ”¾åœ¨æˆ‘ä»¬æƒ³è¦å¯¼å‡ºçš„æ¯ä¸ªå‡½æ•°ä¸Šã€‚ è¿™ä¸ªå®æ·»åŠ äº†æˆ‘ä»¬åœ¨æœ¬æ–‡å‰é¢æ‰‹åŠ¨æ·»åŠ çš„ç›¸åŒç¼–è¯‘å™¨æŒ‡ä»¤ï¼Œä½†å®ƒè¿˜åšäº†ä¸€äº›æ›´æœ‰ç”¨çš„äº‹æƒ…ã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬å°†ä¸Šé¢çš„å®æ·»åŠ åˆ°æˆ‘ä»¬çš„ &lt;code&gt;add&lt;/code&gt; å‡½æ•°ä¸­ï¼Œå®ƒä¼šå‘å‡ºå¦ä¸€ä¸ªä»¥&lt;a href=&#34;https://github.com/rustwasm/wasm-bindgen/blob/main/crates/cli-support/src/descriptor.rs&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ•°å­—æ ¼å¼&lt;/a&gt;è¿”å›æˆ‘ä»¬çš„å‡½æ•° &lt;code&gt;__wbindgen_describe_add&lt;/code&gt; çš„æè¿°ã€‚ å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬å‡½æ•°çš„æè¿°ç¬¦å¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;Function&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Function&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;arguments&lt;/span&gt;: &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;U32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;U32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;],&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;shim_idx&lt;/span&gt;: &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ret&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;U32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;inner_ret&lt;/span&gt;: &lt;span class=&#34;nb&#34;&gt;Some&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;U32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„å‡½æ•°ï¼Œä½†æ˜¯ wasm-bindgen ä¸­çš„æè¿°ç¬¦èƒ½å¤Ÿè¡¨ç¤ºéå¸¸å¤æ‚çš„å‡½æ•°ç­¾åã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;å±•å¼€:&lt;/strong&gt; å¦‚æœä½ æƒ³æŸ¥çœ‹å®å‘å‡ºçš„ä»£ç  &lt;code&gt;#[wasm_bindgen]&lt;/code&gt;ï¼Œè¯·ä½¿ç”¨ rust-analyzer çš„â€œé€’å½’æ‰©å±•å®â€åŠŸèƒ½ã€‚ ä½ å¯ä»¥é€šè¿‡å‘½ä»¤é¢æ¿åœ¨ VS Code è¿è¡Œå®ƒã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿™äº›æè¿°ç¬¦æœ‰ä»€ä¹ˆç”¨ï¼Ÿ wasm-bindgen ä¸ä»…æä¾›äº†ä¸€ä¸ªå®ï¼Œå®ƒè¿˜é™„å¸¦äº†ä¸€ä¸ª CLIï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®ƒæ¥å¯¹æˆ‘ä»¬çš„ Wasm äºŒè¿›åˆ¶æ–‡ä»¶è¿›è¡Œåå¤„ç†ã€‚  CLI æå–è¿™äº›æè¿°ç¬¦å¹¶ä½¿ç”¨æ­¤ä¿¡æ¯ç”Ÿæˆè‡ªå®šä¹‰ JavaScript ç»‘å®šï¼ˆç„¶ååˆ é™¤æ‰€æœ‰ä¸å†éœ€è¦çš„æè¿°ç¬¦å‡½æ•°ï¼‰ã€‚ ç”Ÿæˆçš„ JavaScript å…·æœ‰å¤„ç†æ›´é«˜çº§åˆ«ç±»å‹çš„æ‰€æœ‰ä¾‹ç¨‹ï¼Œå…è®¸ä½ æ— ç¼ä¼ é€’ç±»å‹ï¼Œä¾‹å¦‚å­—ç¬¦ä¸²ã€&lt;code&gt;ArrayBuffer&lt;/code&gt; ç”šè‡³é—­åŒ…ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ æƒ³ä¸º WebAssembly ç¼–å†™ Rustï¼Œæˆ‘æ¨è wasm-bindgenã€‚wasm-bindgen ä¸é€‚ç”¨äº &lt;code&gt;#![no_std]&lt;/code&gt;ï¼Œä½†å®é™…ä¸Šè¿™å¾ˆå°‘æˆä¸ºé—®é¢˜ã€‚&lt;/p&gt;
&lt;h2 id=&#34;wasm-pack&#34;&gt;wasm-pack&lt;/h2&gt;
&lt;p&gt;æˆ‘è¿˜æƒ³æä¸€ä¸‹ &lt;a href=&#34;https://rustwasm.github.io/wasm-pack/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;wasm-pack&lt;/a&gt;ï¼Œè¿™æ˜¯å¦ä¸€ä¸ªç”¨äº WebAssembly çš„ Rust å·¥å…·ã€‚æˆ‘ä»¬ä½¿ç”¨å…¨å¥—å·¥å…·æ¥ç¼–è¯‘å’Œå¤„ç†æˆ‘ä»¬çš„ WebAssembly ä»¥ä¼˜åŒ–æœ€ç»ˆç»“æœã€‚&lt;code&gt;wasm-pack&lt;/code&gt; æ˜¯ä¸€ç§å¯¹å¤§å¤šæ•°è¿™äº›è¿‡ç¨‹è¿›è¡Œç¼–ç çš„å·¥å…·ã€‚å®ƒå¯ä»¥ä½¿ç”¨é’ˆå¯¹ WebAssembly ä¼˜åŒ–çš„æ‰€æœ‰è®¾ç½®å¼•å¯¼ä¸€ä¸ªæ–°çš„ Rust é¡¹ç›®ã€‚å®ƒæ„å»ºé¡¹ç›®å¹¶ä½¿ç”¨æ‰€æœ‰æ­£ç¡®çš„æ ‡å¿—è°ƒç”¨ &lt;code&gt;cargo&lt;/code&gt;ï¼Œç„¶åå®ƒè°ƒç”¨ &lt;code&gt;wasm-bindgen&lt;/code&gt; CLI æ¥ç”Ÿæˆç»‘å®šï¼Œæœ€åå®ƒè¿è¡Œ &lt;code&gt;wasm-opt&lt;/code&gt; ä»¥ç¡®ä¿æˆ‘ä»¬ä¸ä¼šç•™ä¸‹ä»»ä½•æ€§èƒ½é—®é¢˜ã€‚&lt;code&gt;wasm-pack&lt;/code&gt; è¿˜èƒ½å¤Ÿå‡†å¤‡ä½ çš„ WebAssembly æ¨¡å—ä»¥å‘å¸ƒåˆ° npmï¼Œä½†æˆ‘ä¸ªäººä»æœªä½¿ç”¨è¿‡è¯¥åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;Rust æ˜¯ä¸€ç§ç”¨äº WebAssembly çš„ä¼˜ç§€è¯­è¨€ã€‚å¯ç”¨ LTO åï¼Œä½ å°†è·å¾—éå¸¸å°çš„æ¨¡å—ã€‚Rust çš„ WebAssembly å·¥å…·éå¸¸å‡ºè‰²ï¼Œè‡ªä»æˆ‘ç¬¬ä¸€æ¬¡åœ¨ &lt;a href=&#34;https://squoosh.app/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Squoosh&lt;/a&gt; ä¸­ä½¿ç”¨å®ƒä»¥æ¥ï¼Œå®ƒå˜å¾—æ›´å¥½äº†ã€‚å‘å‡ºçš„èƒ¶æ°´ä»£ç  &lt;code&gt;wasm-bindgen&lt;/code&gt; æ—¢ç°ä»£åˆ tree-shakenã€‚çœ‹åˆ°å®ƒåœ¨å¹•åæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œæˆ‘ä»ä¸­è·å¾—äº†å¾ˆå¤šä¹è¶£ï¼Œå®ƒå¸®åŠ©æˆ‘ç†è§£å’Œæ¬£èµæ‰€æœ‰å·¥å…·ä¸ºæˆ‘æ‰€åšçš„äº‹æƒ…ã€‚æˆ‘å¸Œæœ›ä½ ä¹Ÿæœ‰åŒæ„Ÿã€‚éå¸¸æ„Ÿè°¢ &lt;a href=&#34;https://twitter.com/opinionatedpie&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Ingrid&lt;/a&gt;ã€&lt;a href=&#34;https://twitter.com/rreverser&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Ingvar&lt;/a&gt; å’Œ &lt;a href=&#34;https://twitter.com/saulecabrera/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Saul&lt;/a&gt; å®¡é˜…è¿™ç¯‡æ–‡ç« ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>æˆ‘ä¸æ˜¯ä¾›åº”å•†</title>
      <link>https://lib.jimmysong.io/blog/not-a-supplier/</link>
      <pubDate>Mon, 20 Feb 2023 11:00:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/not-a-supplier/</guid>
      <description>&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;è¯‘è€…è¯„è®º&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡ä½œè€…è§‚ç‚¹æ˜¯ï¼šä¸åº”è¯¥å°†è‡ªç”±å’Œå¼€æºè½¯ä»¶ï¼ˆFOSSï¼‰ç½®äºä½ çš„è½¯ä»¶ä¾›åº”é“¾ä¸­ï¼Œè€Œæ˜¯å¯»æ‰¾ä»–ä»¬çš„ä¾›åº”å•†ï¼Œå› ä¸ºåªæœ‰èƒ½å¤Ÿä¸ºè½¯ä»¶è´Ÿè´£ä»»çš„ä¾›åº”å•†å­˜åœ¨æ‰èƒ½ä½œä¸ºä¾›åº”é“¾çš„ä¸€ç¯ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åœ¨è¿‡å»çš„å‡ å¹´é‡Œï¼Œæˆ‘ä»¬çœ‹åˆ°äº†å¾ˆå¤šå›´ç»•è½¯ä»¶ä¾›åº”é“¾æ¦‚å¿µçš„è®¨è®ºã€‚ è¿™äº›è®¨è®ºå§‹äº LeftPad æ—¶ä»£ï¼Œå¹¶éšç€è¿‡å»å‡ å¹´å‘ç”Ÿçš„å„ç§äº‹ä»¶è€Œå‡çº§ã€‚ è¿™ä¸ªé¢†åŸŸæ‰€æœ‰å·¥ä½œçš„é—®é¢˜åœ¨äºå®ƒå¿˜è®°äº†ä¸€ä¸ªåŸºæœ¬ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨å¼€å§‹è®¨è®ºè¿™ä¸ªåŸºæœ¬ç‚¹ä¹‹å‰ï¼Œæˆ‘å°†å®šä¹‰ä¾›åº”é“¾å’Œä¸€èˆ¬ä¾›åº”å•†çš„å«ä¹‰ï¼Œä»¥åŠæˆ‘ä»¬ç”³è¯·è½¯ä»¶çš„åŸå› ã€‚ é‚£ä¹ˆä¸ºä»€ä¹ˆå°† FOSSï¼ˆè‡ªç”±å’Œå¼€æºè½¯ä»¶ï¼‰ç½®äºè¯¥å®šä¹‰ä¹‹ä¸‹çš„å°è¯•è¢«æ·±æ·±åœ°è¯¯å¯¼äº†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ¦‚å¿µ&#34;&gt;æ¦‚å¿µ&lt;/h2&gt;
&lt;p&gt;åœ¨è¿‡å»çš„å‡ åå¹´é‡Œï¼Œæˆ‘ä»¬çœ‹åˆ°äº† FOSS çš„å…´èµ·ã€‚ç‰¹åˆ«æ˜¯ï¼Œè¿™å¯ä»¥æå¤§åœ°å¢åŠ æ‰“åŒ…ä¸ºåº“çš„ä»£ç ç‰‡æ®µçš„é‡ç”¨ã€‚ è¿™è¦å½’åŠŸäºå›´ç»•è¿™ä¸ªæƒ³æ³•è“¬å‹ƒå‘å±•çš„åºå¤§çš„åŸºç¡€è®¾æ–½ç”Ÿæ€ç³»ç»Ÿã€‚ä»Šå¤©ï¼Œæ¯ä¸€ç§ç¼–ç¨‹è¯­è¨€ç¯å¢ƒä¸­éƒ½æœ‰ä¸€ä¸ªåŒ…ç®¡ç†å™¨ï¼Œä¸­å¤®å­˜å‚¨åº“ä¿å­˜ç€æŸ¥æ‰¾åº“å’Œå¤„ç†å®ƒä»¬çš„åˆ†å‘æ‰€éœ€çš„å…ƒæ•°æ®ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯å¯èƒ½çš„ï¼Œå› ä¸º FOSS è®¸å¯è¯éå¸¸å®½æ¾ï¼Œå¹¶ä¸”å¯ä»¥é‡å¤ä½¿ç”¨å’Œé‡æ–°æ··åˆè¿™äº›åº“ï¼Œå¦åˆ™ä¼šå‡ºç°çš„å¤§é‡æ³•å¾‹å’Œè´¢åŠ¡é—®é¢˜ã€‚ ä¸€ä¸ªç°ä»£è½¯ä»¶é¡¹ç›®å¯èƒ½æœ‰æˆç™¾ä¸Šåƒä¸ªè¿™æ ·çš„ä¾èµ–é¡¹ï¼Œä» OpenSSL åˆ°æµ‹è¯•æ¡†æ¶æˆ–æ—¥æœŸé€‰æ‹©å™¨ï¼Œæ¶µç›–è¯¸å¦‚ JSON ç¼–ç å™¨/è§£ç å™¨åº“ç”šè‡³å®ƒæ‰€éƒ¨ç½²çš„æ“ä½œç³»ç»Ÿçš„ libc ä¹‹ç±»çš„ä¸œè¥¿ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ç§ä¾èµ–å…³ç³»çš„ç”Ÿæ€ç³»ç»Ÿï¼Œå…¶ä¸­è®¸å¤šæ˜¯å¯ä¼ é€’çš„ï¼ˆä¾èµ–å…³ç³»çš„ä¾èµ–å…³ç³»ï¼‰ï¼Œå°±æ˜¯è½¯ä»¶ä¾›åº”é“¾æ¨¡å‹æ‰€ç§°çš„é¡¹ç›®ä¾›åº”é“¾ã€‚åœ¨è¿™ä¸ªæ¨¡å‹ä¸­ï¼Œæˆ‘ä»¬å°†æ‰¾åˆ°æœ‰åŠ©äºç®¡ç†å®ƒçš„å·¥å…·ï¼Œä¾‹å¦‚è½¯ä»¶ç‰©æ–™æ¸…å• (SBOM)ï¼Œå®ƒåº”è¯¥åŒ…å«ä¸€äº›å…³äºè¿™ä¸ªé¡¹ç›®ä½¿ç”¨äº†å“ªäº›åº“ã€åœ¨å“ªé‡Œå¯ä»¥æ‰¾åˆ°å®ƒä»¬ã€å“ªä¸ªç‰ˆæœ¬ã€å†…å®¹ç­‰çš„æ•£åˆ—ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä»€ä¹ˆæ˜¯ä¾›åº”é“¾&#34;&gt;ä»€ä¹ˆæ˜¯ä¾›åº”é“¾ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;ä¾›åº”é“¾çš„æƒ³æ³•å½“ç„¶ä¸æ˜¯ç©ºç©´æ¥é£ã€‚ åœ¨åˆ¶é€ ä¸šä¸­ï¼Œä¾›åº”é“¾æ˜¯ç”Ÿäº§ç‰¹å®šå·¥å‚äº§å“æ‰€éœ€çš„ä¾›åº”å•†çš„é•¿é“¾ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨ç»„è£…ä¸€è¾†æ±½è½¦ï¼Œæ‚¨éœ€è¦åº§æ¤…ã€å¤§é‡èºä¸ã€ç”µç¼†ã€ç”µå­äº§å“ã€å„ç§å†²å‹é‡‘å±æ¿â€¦â€¦æ‚¨çš„ç”µç¼†ä¾›åº”å•†éœ€è¦é“œã€å¡‘æ–™ã€èƒ½æºï¼Œå¯èƒ½è¿˜éœ€è¦å„ç§æœºåºŠã€‚ å¯èƒ½éœ€è¦åˆ¶é€ å…¶ä»–æœºåºŠã€èºé’‰ã€èºæ “ã€èºæ¯å’Œä¸€äº›ç”µå­è®¾å¤‡â€¦â€¦æˆ‘ä»¬å¯ä»¥ç»§ç»­ç©è¿™ä¸ªâ€œä½ éœ€è¦ä»€ä¹ˆæ¥åˆ¶é€ è¿™è¾†è½¦â€çš„æ¼«é•¿æ¸¸æˆï¼Œç›´åˆ°ä½ çš„å›¾è¡¨çœ‹èµ·æ¥åƒä¸€ä¸ªå·¨å¤§çš„æ„å¤§åˆ©é¢çƒã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åå¾·å›½ä¸€å®¶ä¸çŸ¥åçš„å°å·¥å‚é‡Œæœ‰äººç”Ÿç—…äº†ï¼Œç¢°å·§é“¾æ¡ä¸Šæœ‰äº”å±‚ï¼Œæ¯ä¸ªå±‚çº§éƒ½å–å†³äºä»–ä»¬çš„ç‰¹å®šèºæ “ï¼Œéƒ½è¢«æˆ‘ä»¬æç ¸äº†ã€‚è¿™ä¸ªé—®é¢˜çš„ä¸€ä¸ªç‰ˆæœ¬å‡ºç°åœ¨ä¸º Covid19 æä¾›ç–«è‹—çš„æ—©æœŸï¼Œå½“æ—¶ä¾›åº”é“¾ä¸“å®¶æ„è¯†åˆ°ä»–ä»¬éœ€è¦çš„ç»ç’ƒç“¶æ•°é‡è¶…è¿‡å…¨ä¸–ç•Œä¸€å¹´çš„äº§é‡ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†é¿å…åœ¨è¿™ä¸ªé“¾æ¡ä¸Šäº”ä¸ªå±‚çº§ä¸Šå‡ºç°æœ€ç»ˆä¼šåœæ­¢å…¶æœ‰ä»·å€¼çš„ç”Ÿäº§çš„éšœç¢ï¼Œåˆ¶é€ å…¬å¸èŠ±äº†æ•°å¹´æ—¶é—´åœ¨æµç¨‹çš„æ¯ä¸ªå±‚æ¬¡ä¸Šä¸ä¾›åº”å•†å»ºç«‹å…³ç³»ã€‚ è¿™æ—¢æ˜¯ä¸€ç§éå¸¸æ·±åšçš„å…³ç³»ï¼Œä½†å¾€å¾€è¿˜ä¸å¤Ÿï¼Œä½†ä¸æ˜¯æ¯ä¸ªå¤æ‚ç³»ç»Ÿéƒ½å¦‚æ­¤å—ï¼Ÿ&lt;/p&gt;
&lt;h2 id=&#34;ä¸ºä»€ä¹ˆè¦è°ˆè½¯ä»¶ä¾›åº”é“¾&#34;&gt;ä¸ºä»€ä¹ˆè¦è°ˆè½¯ä»¶ä¾›åº”é“¾ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;å¥½å§ï¼Œå› ä¸ºå…¬å¸ä¸æ–­å‘ç°ä»–ä»¬çš„äº§å“å­˜åœ¨å¤§é—®é¢˜ï¼Œè€Œè¿™äº›é—®é¢˜å¹¶éæ¥è‡ªè½¯ä»¶å·¥ç¨‹å¸ˆç¼–å†™çš„ä»£ç ã€‚ é—®é¢˜å¯èƒ½æ¥è‡ªåº“çš„æ‰€æœ‰è€…å†³å®šåœæ­¢æä¾›å¯¹å®ƒçš„è®¿é—®ï¼ˆä¾‹å¦‚ Leftpadï¼‰å¹¶ç ´åäº†ä¸€åŠçš„äº’è”ç½‘ã€‚&lt;/p&gt;
&lt;p&gt;æˆ–è€…å®ƒå¯èƒ½æ¥è‡ª OpenSSL æˆ– Log4J ç­‰é€šç”¨æ•°å­—åŸºç¡€è®¾æ–½ä¸­ä½¿ç”¨çš„å¤§å‹åº“ï¼Œè¿™äº›åº“ä¸­å­˜åœ¨è®¸å¤šå®‰å…¨é—®é¢˜ï¼Œä½¿ä¸€åŠçš„äº’è”ç½‘å®¹æ˜“å—åˆ°é»‘å®¢æ”»å‡»ã€‚&lt;/p&gt;
&lt;p&gt;æˆ–è€…æœ‰äººå¯ä»¥ä¸æ‹¥æœ‰åº“çš„äººäº¤è°ˆï¼Œè·å¾—ä»–ä»¬çš„ä¿¡ä»»ï¼Œè®©æ‹¥æœ‰åº“çš„äººç›¸ä¿¡ä»–ä»¬æ˜¯æ¥å¸®å¿™çš„ï¼Œè·å¾—è®¿é—®æƒé™å¹¶å‘å…¶ä¸­æ·»åŠ åŠ å¯†è´§å¸æŒ–çŸ¿ä»£ç ä»¥è·å–åˆ©æ¶¦ï¼ˆå¾ˆå¤šæ—¶å€™æˆ‘ä¸çŸ¥é“ä»å“ªé‡Œå¼€å§‹ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;æˆ–è€…ä»£ç çš„æ‰€æœ‰è€…ä¸å–œæ¬¢å¥½æˆ˜æ”¿æƒï¼Œæ‰€ä»¥ä»–ä¼šæ·»åŠ ä»£ç æ¥ç ´ååœ¨é‚£äº›æ”¿æƒæ‰€åœ¨åœ°ä½¿ç”¨å…¶ä»£ç çš„è®¡ç®—æœºï¼ˆæ˜¯çš„ï¼Œè¿™ç§æƒ…å†µå·²ç»å‘ç”Ÿè¿‡ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åï¼Œè¿™äº›å…¬å¸çš„æ¯ä¸ªäººéƒ½å‘ç°ä»–ä»¬çš„äº§å“å¯ä»¥ä»ä»–ä»¬ä¸çŸ¥é“çš„ä»£ç ä¸­â€œè¿œç¨‹æ“ä½œâ€ã€‚ äºæ˜¯å‡ºç°äº†â€œè½¯ä»¶ä¾›åº”é“¾â€çš„æ¦‚å¿µï¼Œå®šä¹‰äº†ä¾›åº”é“¾ä¸­çš„äººéœ€è¦åšçš„æ‰€æœ‰äº‹æƒ…ï¼Œè¿™äº›åº“çš„æ‰€æœ‰è€…ï¼Œä¸ºäº†ä¸ç ´åä¸‹æ¸¸å…¬å¸ä½¿ç”¨çš„ä»£ç ï¼Œåšä¸ªå¥½å…¬æ°‘ã€‚&lt;/p&gt;
&lt;p&gt;è¿™äº›è§„åˆ™ç®¡ç†è¯¸å¦‚æˆ‘ä»¬å¦‚ä½•æµ‹è¯•ä»£ç ã€æˆ‘ä»¬å¦‚ä½•ä¿æŠ¤æœ‰æƒè®¿é—®å®ƒçš„äººã€æˆ‘ä»¬å¦‚ä½•å‘å¸ƒç‰ˆæœ¬ã€æˆ‘ä»¬å¦‚ä½•éªŒè¯å…¶å®‰å…¨æ€§ã€æˆ‘ä»¬å¦‚ä½•ç»„ç»‡ä»£ç å·¥ä½œã€æˆ‘ä»¬å¦‚ä½•ä¿æŠ¤æ§åˆ¶ä»£ç ç­‰ç­‰ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æˆ‘ä¸æ˜¯ä¾›åº”å•†&#34;&gt;æˆ‘ä¸æ˜¯ä¾›åº”å•†&lt;/h2&gt;
&lt;p&gt;è¿™é‡Œæœ‰ä¸ªå°é—®é¢˜ã€‚ æˆ‘ä»¬ä¸æ˜¯ä¾›åº”å•†ã€‚ å¯¹äºç¼–å†™å’Œç»´æŠ¤è¿™äº›é¡¹ç›®çš„æ¯ä¸ªäººæ¥è¯´ï¼Œæˆ‘ä»¬ä¸æ˜¯ä¾›åº”å•†ã€‚ æˆ‘ä»¬ä¸è¿™äº›ç»„ç»‡ä¸­çš„ä»»ä½•ä¸€ä¸ªéƒ½æ²¡æœ‰ä¸šåŠ¡å…³ç³»ã€‚ æˆ‘ä»¬æ˜¯æ ¹æ®è¿™äº›è®¸å¯ç¼–å†™ä»£ç å¹¶åœ¨çº¿å‘å¸ƒçš„å¿—æ„¿è€…ã€‚ æ˜¯çš„ï¼Œæˆ‘ä»¬æŠŠå®ƒæ”¾åœ¨ç½‘ä¸Šä¾›äººä»¬ä½¿ç”¨ã€‚ ä½†æˆ‘ä»¬æ²¡æœ‰ä»ä¸­å¾—åˆ°ä»»ä½•ä¸œè¥¿ã€‚&lt;/p&gt;
&lt;p&gt;æ›´ç³Ÿç³•çš„æ˜¯ï¼Œè®¸å¤šæ”¯æ’‘æˆ‘ä»¬æ‰€è°“çš„æ•°å­—ç»æµç»“æ„çš„åº“éƒ½åœ¨åŠªåŠ›ç­¹é›†è¶³å¤Ÿçš„é’±æ¥æ”¯ä»˜é£Ÿç‰©ã€‚ å…³äºè¿™ä¸ªè¯é¢˜ï¼Œæˆ‘å¼ºçƒˆå»ºè®®å¤§å®¶èŠ±æ—¶é—´é˜…è¯» &lt;a href=&#34;https://www.fordfoundation.org/work/learning/research-reports/roads-and-bridges-the-unseen-labor-behind-our-digital-infrastructure/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Nadia Eghbal Road and Bridges&lt;/a&gt; çš„æŠ¥å‘Šï¼Œä»¥äº†è§£é—®é¢˜çš„æ·±åº¦ã€‚ å®ƒæœ‰ç‚¹æ—§ï¼Œå› ä¸ºå®ƒæ˜¯åœ¨ HeartBleed ä¹‹åå†™çš„ï¼Œä½†å®ƒåœ¨ä»Šå¤©å’Œå½“æ—¶ä¸€æ ·é‡è¦ã€‚&lt;/p&gt;
&lt;p&gt;æˆ–è€…ä¸ºäº†æ›´æœ‰è¶£ã€æ›´ç›´è§‚çš„è§£é‡Šï¼Œ&lt;a href=&#34;https://xkcd.com/2347/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;XKCD 2347&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-xkcd-2347ä¸€å †å—çš„å›¾åƒæ ‡è®°ä¸ºæ‰€æœ‰ç°ä»£æ•°å­—åŸºç¡€è®¾æ–½ä¸€ä¸ªå°å—ä¿æŒæ•´ä¸ªå †æ ˆç¨³å®šæ ‡è®°ä¸ºå†…å¸ƒæ‹‰æ–¯åŠ å·æŸä¸ªéšæœºçš„äººè‡ª-2003-å¹´ä»¥æ¥ä¸€ç›´åœ¨ä¸çŸ¥ç–²å€¦åœ°ç»´æŠ¤çš„é¡¹ç›®&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;XKCD 2347ï¼Œä¸€å †å—çš„å›¾åƒï¼Œæ ‡è®°ä¸ºâ€œæ‰€æœ‰ç°ä»£æ•°å­—åŸºç¡€è®¾æ–½â€ï¼Œä¸€ä¸ªå°å—ä¿æŒæ•´ä¸ªå †æ ˆç¨³å®šï¼Œæ ‡è®°ä¸ºâ€œå†…å¸ƒæ‹‰æ–¯åŠ å·æŸä¸ªéšæœºçš„äººè‡ª 2003 å¹´ä»¥æ¥ä¸€ç›´åœ¨ä¸çŸ¥ç–²å€¦åœ°ç»´æŠ¤çš„é¡¹ç›®ã€‚&#34; srcset=&#34;
               /blog/not-a-supplier/dependency_hu9aab65391edcc77b1b768625ad7c3f55_23987_1c678cef18dd13090011e30b7ebcf43a.webp 400w,
               /blog/not-a-supplier/dependency_hu9aab65391edcc77b1b768625ad7c3f55_23987_b251e1234759b9cb0de6c94f82fcd500.webp 760w,
               /blog/not-a-supplier/dependency_hu9aab65391edcc77b1b768625ad7c3f55_23987_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/not-a-supplier/dependency_hu9aab65391edcc77b1b768625ad7c3f55_23987_1c678cef18dd13090011e30b7ebcf43a.webp&#34;
               width=&#34;385&#34;
               height=&#34;489&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      XKCD 2347ï¼Œä¸€å †å—çš„å›¾åƒï¼Œæ ‡è®°ä¸ºâ€œæ‰€æœ‰ç°ä»£æ•°å­—åŸºç¡€è®¾æ–½â€ï¼Œä¸€ä¸ªå°å—ä¿æŒæ•´ä¸ªå †æ ˆç¨³å®šï¼Œæ ‡è®°ä¸ºâ€œå†…å¸ƒæ‹‰æ–¯åŠ å·æŸä¸ªéšæœºçš„äººè‡ª 2003 å¹´ä»¥æ¥ä¸€ç›´åœ¨ä¸çŸ¥ç–²å€¦åœ°ç»´æŠ¤çš„é¡¹ç›®ã€‚
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬çŸ¥é“ã€‚ è¿™å°±æ˜¯ä¸ºä»€ä¹ˆåœ¨è¿™äº›è®¸å¯ä¸­éƒ½ç®¡ç†ç€åœ¨è¿™äº›åº“ä¸­åœ¨çº¿å‘å¸ƒçš„ä½œå“çš„é‡å¤ä½¿ç”¨è§„åˆ™ï¼Œä½ ä¼šå‘ç°è¿™ä¸€æ®µæ˜¯é€å­—å¤åˆ¶çš„ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æœ¬è½¯ä»¶â€œæŒ‰åŸæ ·â€æä¾›ï¼Œä¸æä¾›ä»»ä½•æ˜ç¤ºæˆ–æš—ç¤ºçš„ä¿è¯ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºé€‚é”€æ€§ã€ç‰¹å®šç”¨é€”é€‚ç”¨æ€§å’Œéä¾µæƒä¿è¯ã€‚åœ¨ä»»ä½•æƒ…å†µä¸‹ï¼Œä½œè€…æˆ–ç‰ˆæƒæ‰€æœ‰è€…å‡ä¸å¯¹å› è½¯ä»¶æˆ–å…¶ä½¿ç”¨æˆ–å…¶ä»–äº¤æ˜“å¼•èµ·çš„æˆ–ä¸ä¹‹ç›¸å…³çš„ä»»ä½•ç´¢èµ”ã€æŸå®³æˆ–å…¶ä»–è´£ä»»è´Ÿè´£ï¼Œæ— è®ºæ˜¯åˆåŒã€ä¾µæƒæˆ–å…¶ä»–æ–¹é¢ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿™é‡Œæœ‰å¤ªå¤šæ³•å¾‹æœ¯è¯­ï¼Œä½†æˆ‘å¯ä»¥å¾ˆå®¹æ˜“åœ°æ€»ç»“å‡ºæ¥ã€‚ å¦‚æœä½ ç”¨è¿™ä¸ªï¼Œæˆ‘ä»€ä¹ˆéƒ½ä¸æ¬ ä½ ã€‚ ç»å¯¹ä¸ã€‚ æˆ‘ä»¬æ— æ‰€è°“ã€‚ æˆ‘æŠŠå®ƒæ”¾åœ¨ç½‘ä¸Šçš„æ¡ä»¶æ˜¯ï¼Œå¦‚æœä½ ä½¿ç”¨å®ƒï¼Œä½ å°†å®Œå…¨è‡ªè¡Œæ‰¿æ‹…é£é™©ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ„å‘³ç€è¿™é‡Œæ²¡æœ‰ä¾›åº”é“¾ã€‚å› ä¸ºæ²¡æœ‰ä¾›åº”å•†ã€‚æˆ‘ä¸ä¼šæŠŠä½ ä»æˆ‘è¿™é‡Œä¹°çš„ä¸œè¥¿é€ç»™ä½ ã€‚æ²¡å…³ç³»ã€‚æˆ‘æŠŠä¸œè¥¿æ”¾åˆ°ç½‘ä¸Šæ˜¯å› ä¸ºæˆ‘æƒ³ã€‚ä½ çš„äº§å“ä¾èµ–äºå®ƒæ˜¯ä½ çš„è´£ä»»ã€‚ä¸æ˜¯æˆ‘çš„ã€‚ä¸æ˜¯æä¾›è€…ä¹‹ä¸€ã€‚ æˆ‘ä»¬æä¾›å›¾ä¹¦é¦†ã€‚ä½ ä¸èƒ½å¯¹æˆ‘å¥—ç”¨è¿™äº›è§„åˆ™ã€‚&lt;/p&gt;
&lt;p&gt;è€å®è¯´ï¼Œæˆ‘ä¸ä¼šæ¥å—å®ƒä»¬ã€‚æˆ‘å‡ ä¹æ²¡æœ‰èŠ±æ—¶é—´åœ¨æˆ‘ç»´æŠ¤çš„ FOSS åº“ä¸Šå·¥ä½œï¼Œè€Œä¸”è¿™æ ·åšå¸¸å¸¸è®©åšè¿™ä»¶äº‹çš„äººç­‹ç–²åŠ›å°½ã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨ï¼Œæˆ‘å¾ˆé«˜å…´æˆä¸ºä¾›åº”å•†ã€‚ ä½ å¸Œæœ›æˆ‘ä»¥æŸç§æ–¹å¼å·¥ä½œï¼Œæˆ‘éå¸¸ä¹æ„è¿™æ ·åšã€‚ ä½†è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œæˆ‘å°†ä¸å¾—ä¸æˆä¸ºä¸€åä¾›åº”å•†ã€‚ è¿™æ„å‘³ç€ä½ å°†ä¸å¾—ä¸å¼€å§‹ä»˜é’±ç»™æˆ‘ã€‚ä»·æ ¼å…¬é“ï¼Œæˆ‘ä»¬å¯ä»¥åå•†ã€‚åœ¨ä¸åŒçš„è®¸å¯è¯ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨é‚£ä¹‹å‰ï¼Œæˆ‘ä¸æ˜¯ä½ çš„ä¾›åº”å•†ã€‚é‚£ä¹ˆä½ æ‰€æœ‰çš„è½¯ä»¶ä¾›åº”é“¾æƒ³æ³•ï¼Ÿ ä½ ä¸æ˜¯ä»ä¾›åº”å•†é‚£é‡Œè´­ä¹°ï¼Œä½ æ˜¯åœ¨åƒåœ¾ç®±ä¸­æŒ–æ˜å…è´¹ä»£ç ã€‚ æ‰€ä»¥æˆ‘å»ºè®®ä½ æŠŠè¿™äº›è§„åˆ™æ”¾åœ¨åŒä¸€ä¸ªç®±å­é‡Œã€‚è®°ä½ã€‚æˆ‘ä¸æ˜¯ä¾›åº”å•†ã€‚ &lt;strong&gt;å› ä¸ºæœ¬è½¯ä»¶â€œæŒ‰åŸæ ·â€æä¾›ã€‚&lt;/strong&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>æœåŠ¡ç½‘æ ¼å®‰å…¨æ€§ä¼˜åŒ–æœ€ä½³å®è·µ</title>
      <link>https://lib.jimmysong.io/blog/optimize-traffic-management-and-security-with-these-service-mesh-best-practices/</link>
      <pubDate>Wed, 01 Feb 2023 11:00:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/optimize-traffic-management-and-security-with-these-service-mesh-best-practices/</guid>
      <description>&lt;p&gt;è¿™æ˜¯ &lt;a href=&#34;https://tetrate.io/blog/how-service-mesh-layers-microservices-security-with-traditional-security-to-move-fast-safely/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æœåŠ¡ç½‘æ ¼æœ€ä½³å®è·µç³»åˆ—æ–‡ç« &lt;/a&gt; ä¸­çš„ç¬¬ä¸‰ç¯‡ï¼Œæ‘˜è‡ª Tetrate åˆ›å§‹å·¥ç¨‹å¸ˆ Zack Butcher å³å°†å‡ºç‰ˆçš„æ–°ä¹¦ Istio in Productionã€‚&lt;/p&gt;
&lt;p&gt;Istio å°±åƒä¸€ç»„ä¹é«˜ç§¯æœ¨ï¼šå®ƒå…·æœ‰è®¸å¤šåŠŸèƒ½ï¼Œå¯ä»¥æŒ‰ç…§æ‚¨æƒ³è¦çš„ä»»ä½•æ–¹å¼è¿›è¡Œç»„è£…ã€‚å‡ºç°çš„ç»“æ„å–å†³äºæ‚¨å¦‚ä½•ç»„è£…é›¶ä»¶ã€‚åœ¨ &lt;a href=&#34;../service-mesh-deployment-best-practices-for-security-and-high-availability/&#34;&gt;ä¸Šä¸€ç¯‡ä¸­&lt;/a&gt;ï¼Œæˆ‘ä»¬æè¿°äº†ä¸€ç§è¿è¡Œæ—¶æ‹“æ‰‘ç»“æ„ï¼Œç”¨äºæ„å»ºå¥å£®ã€æœ‰å¼¹æ€§ä¸”å¯é çš„åŸºç¡€æ¶æ„ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†æè¿°ä¸€ç»„ç½‘æ ¼é…ç½®ï¼Œä»¥å¸®åŠ©åœ¨è¿è¡Œæ—¶å®ç°ç¨³å¥æ€§ã€å¼¹æ€§ã€å¯é æ€§å’Œå®‰å…¨æ€§ã€‚&lt;/p&gt;
&lt;p&gt;Istio åœ¨å…¶æ‰€è°“çš„ &lt;a href=&#34;https://istio.io/latest/docs/reference/config/istio.mesh.v1alpha1/#MeshConfig-root_namespace&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ ¹å‘½åç©ºé—´&lt;/a&gt; ä¸­æ”¯æŒå…¨å±€é»˜è®¤é…ç½® â€”â€” é»˜è®¤åœ¨ &lt;code&gt;istio-system&lt;/code&gt;ã€‚åœ¨æ ¹å‘½åç©ºé—´ä¸­å‘å¸ƒçš„é…ç½®é»˜è®¤é€‚ç”¨äºæ‰€æœ‰æœåŠ¡ï¼Œä½†åœ¨æœ¬åœ°å‘½åç©ºé—´ä¸­å‘å¸ƒçš„ä»»ä½•é…ç½®éƒ½ä¼šè¦†ç›–å®ƒã€‚å› æ­¤ï¼Œä¸€äº›é…ç½®åº”è¯¥åœ¨æ ¹å‘½åç©ºé—´ä¸­å‘å¸ƒï¼Œå¹¶ä¸”ä¸å…è®¸åœ¨å…¶ä»–ä»»ä½•åœ°æ–¹å‘å¸ƒï¼ˆä¾‹å¦‚ç”¨äºåœ¨ä¼ è¾“ä¸­å¼ºåˆ¶åŠ å¯†çš„ PeerAuthentication ç­–ç•¥ï¼‰ã€‚å…¶ä»–é…ç½®åº”è¯¥åœ¨æ¯ä¸ªæœåŠ¡è‡ªå·±çš„å‘½åç©ºé—´ä¸­ç¼–å†™ï¼ˆä¾‹å¦‚ VirtualService æ§åˆ¶å®ƒçš„å¼¹æ€§è®¾ç½®ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬çœ‹åˆ°çš„æœ€æˆåŠŸçš„ç½‘æ ¼é‡‡ç”¨å°†ç½‘æ ¼æœ¬èº«éšè—åœ¨å¦ä¸€ä¸ªç•Œé¢åé¢ï¼šä¾‹å¦‚ Helm æ¨¡æ¿ã€Terraform æˆ–æ›´é«˜çº§çš„è§£å†³æ–¹æ¡ˆï¼Œä¾‹å¦‚ &lt;a href=&#34;https://tetrate.io/tetrate-service-bridge/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tetrate Service Bridge (TSB)&lt;/a&gt;ã€‚æ ¸å¿ƒæ€æƒ³æ˜¯åªå…¬å¼€åº”ç”¨ç¨‹åºå¼€å‘äººå‘˜åº”è¯¥é…ç½®çš„ä¸€å°éƒ¨åˆ†ç½‘æ ¼åŠŸèƒ½ï¼Œæœ€å¥½æ˜¯ä½¿ç”¨ä»–ä»¬ç†è§£çš„è¯­è¨€ï¼ˆä¾‹å¦‚ï¼ŒTSB å¯ä»¥ä½¿ç”¨ &lt;a href=&#34;https://docs.tetrate.io/service-bridge/1.6.x/en-us/quickstart/apps&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¸¦æ³¨é‡Šçš„ OpenAPI è§„èŒƒ&lt;/a&gt; è¿›è¡Œé…ç½®ï¼‰ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬é€šå¸¸åªå‘åº”ç”¨ç¨‹åºå¼€å‘äººå‘˜å…¬å¼€æµé‡è®¾ç½®å’Œæˆæƒã€‚èº«ä»½éªŒè¯å’Œé¥æµ‹ç”±å„è‡ªçš„å›¢é˜Ÿæˆ–ä»£è¡¨ä»–ä»¬çš„å¹³å°å›¢é˜Ÿé›†ä¸­æ§åˆ¶ã€‚&lt;a href=&#34;https://tetrate.io/blog/nist-standards-for-zero-trust-the-sp-800-204-series/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;NIST SP800-204 ç³»åˆ—&lt;/a&gt;ï¼Œå°¤å…¶æ˜¯ &lt;a href=&#34;https://csrc.nist.gov/publications/detail/sp/800-204a/final&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SP 800-204A&lt;/a&gt; å’Œ &lt;a href=&#34;https://csrc.nist.gov/publications/detail/sp/800-204b/final&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SP 800-204B&lt;/a&gt;ã€‚Istio é¡¹ç›®ç«™ç‚¹ä¹Ÿæœ‰ä¸€ç»„ &lt;a href=&#34;https://istio.io/latest/docs/ops/best-practices/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æœ€ä½³å®è·µ&lt;/a&gt;ï¼Œä¹Ÿå€¼å¾—æ”¶è—ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æœåŠ¡ç½‘æ ¼å‘½åçº¦å®š&#34;&gt;æœåŠ¡ç½‘æ ¼å‘½åçº¦å®š&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;å»ºè®®&lt;/strong&gt;ï¼šä¸º Istio èµ„æºå¼€å‘å’Œç»´æŠ¤ä¸€è‡´çš„å‘½åæ–¹æ¡ˆï¼Œæœ€å¥½åŸºäºå®ƒä»¬é…ç½®çš„æœåŠ¡æˆ–ä¸»æœºã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å»ºè®®&lt;/strong&gt;ï¼šä¸ºè·¨é›†ç¾¤çš„å›¢é˜Ÿä¿æŒä¸€è‡´çš„åç§°ã€‚å‘½åç©ºé—´åº”è¯¥ç”±ä¸€ä¸ªå›¢é˜Ÿæ‹¥æœ‰ã€‚&lt;/p&gt;
&lt;p&gt;Istio èµ„æºåº”è¯¥æ ¹æ®å®ƒä»¬é…ç½®çš„æœåŠ¡æˆ–ä¸»æœºæ¥å‘½åï¼š&lt;code&gt;ServiceEntry&lt;/code&gt; æ·»åŠ  &lt;code&gt;api.example.com&lt;/code&gt; åˆ°ç½‘æ ¼çš„åº”è¯¥å‘½åä¸º &lt;code&gt;external-api-example-com&lt;/code&gt;ï¼›æœåŠ¡çš„ &lt;code&gt;DestinationRule&lt;/code&gt;ã€&lt;code&gt;VirtualService&lt;/code&gt;ã€&lt;code&gt;PeerAuthentication&lt;/code&gt; å’Œ &lt;code&gt;Authorization&lt;/code&gt; ç­–ç•¥ä¹Ÿéƒ½åº”è¯¥æœ‰ç›¸åŒçš„åç§°ã€‚PCI å‘½åç©ºé—´ä¸­çš„å†…éƒ¨æœåŠ¡ Paymentsï¼ˆåº”ç”¨ç¨‹åºä»£ç ä¸­çš„ hostname &lt;code&gt;payments.pci&lt;/code&gt;ï¼‰åº”è¯¥è¢«å‘½åä¸º &lt;code&gt;payment-pci&lt;/code&gt;ï¼Œå…¶æ‰€æœ‰çš„ç½‘æ ¼é…ç½®åç§°ä¹Ÿåº”è¯¥åŒ¹é…ã€‚è¿™äº›å‘½åæ–¹æ¡ˆå¹¶ä¸æ˜¯ç¡¬æ€§è§„å®šï¼Œä½†ä½ åº”è¯¥åœ¨ä½ çš„ç»„ç»‡å†…å»ºç«‹å¹¶åšæŒä¸€ä¸ªä¸€è‡´çš„æƒ¯ä¾‹ã€‚&lt;/p&gt;
&lt;p&gt;è¿™äº›èµ„æºåº”è¯¥å…¨éƒ¨å‘å¸ƒåœ¨å®ƒä»¬é…ç½®çš„æœåŠ¡çš„å‘½åç©ºé—´ä¸­ï¼Œæˆ–è€…å‘å¸ƒåœ¨ &lt;code&gt;istio-system&lt;/code&gt; å‘½åç©ºé—´ä¸­ä»¥è¿›è¡Œç½‘æ ¼èŒƒå›´çš„é…ç½®ã€‚å¤–éƒ¨æœåŠ¡é€šå¸¸å‘å¸ƒåˆ° &lt;code&gt;istio-system&lt;/code&gt; ä¸­å¹¶ç”±ä¸­å¿ƒå›¢é˜Ÿï¼ˆå¹³å°æˆ–å®‰å…¨å›¢é˜Ÿï¼‰ç®¡ç†ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å»ºè®®è·¨é›†ç¾¤çš„å›¢é˜Ÿä½¿ç”¨ä¸€è‡´çš„åç§°ï¼šæ— è®ºé›†ç¾¤ç§Ÿæˆ·æ¨¡å‹å¦‚ä½•ï¼Œå‘½åç©ºé—´éƒ½åº”ç”±å•ä¸ªå›¢é˜Ÿæ‹¥æœ‰ï¼ˆè¯·å‚é˜…ä¸‹ä¸€èŠ‚ï¼‰ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æœåŠ¡ç½‘æ ¼å…¨å±€è®¾ç½®&#34;&gt;æœåŠ¡ç½‘æ ¼å…¨å±€è®¾ç½®&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;é…ç½®å¯è§æ€§&lt;/strong&gt;ã€‚Istio æœ‰ä¸€ä¸ªé…ç½®å¯è§æ€§çš„æƒ³æ³•ï¼šé…ç½®å¯ä»¥é»˜è®¤åº”ç”¨äºæ•´ä¸ªé›†ç¾¤ï¼Œæˆ–è€…å®ƒå¯ä»¥åªåº”ç”¨äºæœ¬åœ°å‘½åç©ºé—´ï¼Œç”šè‡³å¯ä»¥åªåº”ç”¨äºå•ä¸ªæœåŠ¡ï¼ˆé€‰æ‹©å¯¹æ•´ä¸ªé›†ç¾¤å¯è§ï¼Œæˆ–è€…åªæ˜¯ç‰¹å®šçš„å‘½åç©ºé—´ï¼‰ã€‚ä¸ºäº†æ€§èƒ½å’Œå®‰å…¨ï¼Œæ‚¨åº”è¯¥å°†è¯¥å­—æ®µé»˜è®¤ä¸º &lt;code&gt;exportTo&lt;/code&gt; æœ¬åœ°åç§°ç©ºé—´ï¼ˆâ€œ.â€ï¼‰ã€‚æ‚¨åº”è¯¥åœ¨å®‰è£…æ—¶ä¸º &lt;a href=&#34;https://istio.io/latest/docs/reference/config/istio.mesh.v1alpha1/#MeshConfig-default_service_export_to&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;em&gt;Services&lt;/em&gt;&lt;/a&gt;ã€&lt;a href=&#34;https://istio.io/latest/docs/reference/config/istio.mesh.v1alpha1/#MeshConfig-default_virtual_service_export_to&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;em&gt;VirtualServices&lt;/em&gt;&lt;/a&gt; å’Œ &lt;a href=&#34;https://istio.io/latest/docs/reference/config/istio.mesh.v1alpha1/#MeshConfig-default_destination_rule_export_to&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;em&gt;DestinationRules&lt;/em&gt;&lt;/a&gt; è®¾ç½®è¿™ä¸ªé»˜è®¤å€¼ã€‚æŸ¥çœ‹ Istio çš„ &lt;a href=&#34;https://istio.io/latest/docs/reference/config/istio.mesh.v1alpha1/#MeshConfig-default_service_export_to&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å…¨å±€é…ç½®&lt;/a&gt; æ¥é…ç½®è¿™äº›é»˜è®¤å€¼ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;install.istio.io/v1alpha1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;IstioOperator&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;controlplane&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;istio-system&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# profile: default&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# ...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;meshConfig&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;defaultServiceExportTo&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;- &lt;span class=&#34;s2&#34;&gt;&amp;#34;.&amp;#34;&lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# only the namespace the resource is published in&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;defaultVirtualServiceExportTo&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;- &lt;span class=&#34;s2&#34;&gt;&amp;#34;.&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# equivalent, just different YAML syntax&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;defaultDestinationRuleExportTo&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;.&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç¤ºä¾‹ 1ï¼šé»˜è®¤å…¨å±€è®¾ç½®&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ¯ä¸ªå‘½åç©ºé—´çš„ Sidecar èµ„æºé…ç½®&lt;/strong&gt;ã€‚Istio çš„ &lt;code&gt;Sidecar&lt;/code&gt; ï¼ˆAPIï¼‰èµ„æºæ§åˆ¶ Istio å°†å“ªäº›é…ç½®å‘é€åˆ°æ¯ä¸ªå‘½åç©ºé—´ä¸­çš„ Sidecarã€‚ä¸ºäº†è·å¾—æœ€ä½³æ€§èƒ½å’Œæœ€ä½å¼€é”€ï¼Œæ‚¨åº”è¯¥ä¸ºæ¯ä¸ªå‘½åç©ºé—´ç®¡ç†ä¸€ä¸ªé…ç½®ï¼Œå¹¶ç®¡ç† egress éƒ¨åˆ†ä»¥ä»…åŒ…æ‹¬æœåŠ¡å¿…é¡»ä¸ä¹‹é€šä¿¡çš„ä¸»æœºã€‚è¿™å°†å¯¼è‡´ Istio å‘è¯¥å‘½åç©ºé—´ä¸­çš„ Envoy å®ä¾‹å‘é€æ›´å°‘çš„é…ç½®ï¼Œä»è€Œå‡å°‘å®ƒä»¬çš„å†…å­˜å’Œ CPU æ¶ˆè€—ã€‚ç»“åˆä»…æ³¨å†Œè¡¨å‡ºç«™æµé‡ç­–ç•¥ï¼ˆè§ä¸‹ä¸€æ¡ï¼‰ï¼ŒSidecar èµ„æºè¿˜å¯ä»¥å¸®åŠ©é™åˆ¶æ”»å‡»è€…é€šè¿‡ Envoy çš„è¡¨é¢åŒºåŸŸï¼Œå› ä¸ºä¸åœ¨ Sidecar çš„ egress éƒ¨åˆ†çš„ä¸»æœºå°†æ˜¯è¯¥ Envoy å®ä¾‹çš„ &amp;ldquo;å‡ºç«™æµé‡&amp;rdquo;ã€‚è¿™æœ¬èº«å¹¶ä¸æ˜¯ä¸€ä¸ªè¶³å¤Ÿçš„å®‰å…¨ç­–ç•¥ï¼ˆè§ä¸‹é¢çš„å®‰å…¨éƒ¨åˆ†ï¼‰ï¼Œè€Œæ˜¯å¢åŠ äº†ä¸€ä¸ªæ”»å‡»è€…å¿…é¡»ç©¿è¶Šçš„é¢å¤–é˜²å¾¡å±‚ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç¼–å†™æ˜ç¡®çš„å‡ºç«™ï¼ˆegressï¼‰æµé‡ç­–ç•¥&lt;/strong&gt;ã€‚Istio æä¾›äº†ä¸€äº›é€‰é¡¹æ¥é…ç½®å®ƒå¦‚ä½•å¤„ç†ç½‘æ ¼ä¸­çš„æœåŠ¡ï¼Œè¯¥æœåŠ¡è¯•å›¾ä¸ Istio æœªçŸ¥çš„ç«¯ç‚¹è¿›è¡Œé€šä¿¡ï¼š&lt;a href=&#34;https://istio.io/latest/docs/reference/config/istio.mesh.v1alpha1/#MeshConfig-OutboundTrafficPolicy-Mode&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Outbound Traffic Policy&lt;/a&gt;ã€‚Istio å¯ä»¥å…è®¸æ‰€æœ‰æµé‡ï¼Œä¹Ÿå¯ä»¥å°†æµé‡é™åˆ¶åœ¨ç½‘æ ¼å·²çŸ¥çš„æœåŠ¡ä¸Šã€‚ä½ åº”è¯¥åœ¨å®‰è£…æ—¶é…ç½® Istioï¼Œåªå…è®¸è¿æ¥åˆ°æ³¨å†Œè¡¨ä¸­çš„æœåŠ¡ã€‚æ­¤å¤–ï¼Œä½ åº”è¯¥å°†æ‰€æœ‰éœ€è¦ä¸ä¹‹é€šä¿¡çš„å¤–éƒ¨æœåŠ¡å»ºæ¨¡ä¸º Mesh ä¸­çš„ ServiceEntriesï¼ˆä¾‹å¦‚ï¼ŒSaaS æœåŠ¡çš„ DNS è§£æç­‰ï¼‰ï¼Œä½¿ç”¨ DestinationRules æ¥é…ç½®ä¸å®ƒä»¬é€šä¿¡çš„ TLSã€‚è¿™äº›å¤–éƒ¨æœåŠ¡åº”è¯¥ç”±å®‰å…¨å›¢é˜Ÿé›†ä¸­ç®¡ç†ï¼Œæˆ–è€…ç”±å¹³å°å›¢é˜Ÿä»£è¡¨ä»–ä»¬ç®¡ç†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;è¿è¡Œæ—¶æµé‡ç®¡ç†é…ç½®&#34;&gt;è¿è¡Œæ—¶æµé‡ç®¡ç†é…ç½®&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;ä¸ºæœåŠ¡ä½¿ç”¨ä¸€è‡´çš„å…¨å±€åç§°ï¼Œå¹¶ä½¿ç”¨ Istio å°†å®ƒä»¬æ˜ å°„åˆ°æœ¬åœ°å®ä¾‹&lt;/strong&gt;ã€‚æ‚¨åº”è¯¥ä½¿ç”¨ä¸€è‡´çš„å…¨å±€åç§°æ¥è®¿é—®æœåŠ¡ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ Istio å°†è¿™äº›å…¨å±€åç§°æ˜ å°„åˆ°æœ¬åœ°å®ä¾‹ã€‚ä¾‹å¦‚ï¼Œ&lt;code&gt;payments.tetrate.internal&lt;/code&gt; å¯ä»¥è¢«æ‰€æœ‰å†…éƒ¨åº”ç”¨ç¨‹åºä½¿ç”¨ï¼Œè€Œ Istio å¯ä»¥ç”¨æ¥å°†è¯¥åç§°æ˜ å°„åˆ°æœåŠ¡å®ä¾‹ï¼Œä¾‹å¦‚ â€œåœ¨ &lt;code&gt;us-east-2&lt;/code&gt; Kubernetes é›†ç¾¤ä¸­çš„ &lt;code&gt;payments.default.svc.cluster.local&lt;/code&gt; æœåŠ¡â€ã€‚è¿™ç§å…¨å±€å‘½åæ–¹æ¡ˆä½¿å¼€å‘äººå‘˜å¯ä»¥åƒ SaaS ä¸€æ ·è€ƒè™‘æ‰€æœ‰æœåŠ¡ï¼Œè€Œæ— éœ€ä»”ç»†è€ƒè™‘è¿è¡Œæ—¶æ‹“æ‰‘çš„ç»†èŠ‚ï¼Œå¹¶ä¸”å¯ä»¥è½»æ¾åœ°æ‰§è¡Œæ•…éšœè½¬ç§»ã€é‡‘ä¸é›€å’Œè·¨é›†ç¾¤è·¯ç”±ç­‰æ“ä½œï¼Œä½œä¸ºæ‚¨çš„ç½‘æ ¼ä½¿ç”¨æˆç†Ÿæˆ–ç»„ç»‡éœ€æ±‚æ¼”å˜ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;åœ¨æ ¹é…ç½®ä¸­å®šä¹‰ç²—ç•¥çš„é»˜è®¤å¼¹æ€§è®¾ç½®&lt;/strong&gt;ã€‚æ‚¨åº”è¯¥ä¸ºç½‘æ ¼ä¸­çš„æ‰€æœ‰æœåŠ¡å®šä¹‰ç²—ç•¥çš„è¶…æ—¶ã€é‡è¯•ã€ç†”æ–­å’Œå¼‚å¸¸å€¼æ£€æµ‹è®¾ç½®ã€‚æ‚¨å¯ä»¥åœ¨æ ¹é…ç½®å‘½åç©ºé—´ä¸­ä½¿ç”¨ &lt;code&gt;VirtualService&lt;/code&gt; æ¥å®ç°æ­¤ç›®çš„ã€‚å„ä¸ªå›¢é˜Ÿåº”åœ¨å…¶æœ¬åœ°å‘½åç©ºé—´ä¸­æŒ‡å®šè‡ªå·±çš„åç§°ä»¥è¦†ç›–é»˜è®¤å€¼ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä¸ºåº”ç”¨ç¨‹åºå›¢é˜Ÿæä¾›ç®€åŒ–çš„ â€œä½ / ä¸­ / é«˜â€ å¼¹æ€§è®¾ç½®&lt;/strong&gt;ã€‚å°†ç½‘æ ¼çš„åº•å±‚ API éšè—åœ¨æ›´é«˜çº§åˆ«æ¥å£åé¢çš„ç³»ç»Ÿä¸­ï¼Œä¸ºé…ç½®é»˜è®¤æ–­è·¯å’Œå¼‚å¸¸å€¼æ£€æµ‹è®¾ç½®çš„åº”ç”¨ç¨‹åºå¼€å‘äººå‘˜æä¾›ç®€åŒ–çš„ â€œä½ / ä¸­ / é«˜â€ æ—‹é’®å¾ˆæœ‰ä»·å€¼ï¼Œå› ä¸ºå¾ˆå¤šé¢†åŸŸå®¹æ˜“é…ç½®é”™è¯¯ï¼Œå¯¼è‡´è¯¥åº”ç”¨ç¨‹åºæ€§èƒ½ä¸ä½³ã€‚&lt;/p&gt;
&lt;h2 id=&#34;è¿è¡Œæ—¶å®‰å…¨é…ç½®&#34;&gt;è¿è¡Œæ—¶å®‰å…¨é…ç½®&lt;/h2&gt;
&lt;p&gt;ä»¥ä¸‹å®‰å…¨å»ºè®®æ¥è‡ªæˆ‘ä»¬ä¸ºå¾®æœåŠ¡åº”ç”¨ç¨‹åºå»ºç«‹ç¾å›½å®‰å…¨æ ‡å‡†çš„å·¥ä½œï¼Œè¯¥æ ‡å‡†ç”±ç¾å›½å›½å®¶æ ‡å‡†ä¸æŠ€æœ¯ç ”ç©¶é™¢ï¼ˆNISTï¼‰åœ¨ &lt;a href=&#34;https://tetrate.io/blog/nist-standards-for-zero-trust-the-sp-800-204-series/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SP 800-204 ç³»åˆ—&lt;/a&gt; ä¸­å‘å¸ƒã€‚&lt;a href=&#34;https://tetrate.io/tetrates-guide-to-federal-security-requirements-for-microservices/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ‚¨å¯ä»¥åœ¨æˆ‘ä»¬çš„ç»¼åˆæŒ‡å—&lt;/a&gt; ä¸­é˜…è¯» NIST é’ˆå¯¹å¾®æœåŠ¡åº”ç”¨ç¨‹åºçš„æ‰€æœ‰å®‰å…¨å»ºè®®ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æœ€å°æ§åˆ¶&lt;/strong&gt;ã€‚è¿è¡Œæ—¶çš„é›¶ä¿¡ä»»è‡³å°‘éœ€è¦ä»¥ä¸‹äº”ä¸ªæ§åˆ¶ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åŠ å¯†ä¼ è¾“ä¸­çš„æ‰€æœ‰å†…å®¹&lt;/strong&gt;ï¼šæä¾›æ¶ˆæ¯çœŸå®æ€§å’Œçªƒå¬ä¿æŠ¤ï¼ˆ&lt;a href=&#34;https://tetrate.io/tetrates-guide-to-federal-security-requirements-for-microservices/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SP 800-204ï¼ŒÂ§MS-SS-4&lt;/a&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éªŒè¯æœåŠ¡åˆ°æœåŠ¡çš„é€šä¿¡&lt;/strong&gt;ï¼šæ¯ä¸ªåº”ç”¨ç¨‹åºéƒ½åº”éªŒè¯ä¸ä¹‹é€šä¿¡çš„åº”ç”¨ç¨‹åºçš„èº«ä»½ï¼ˆ&lt;a href=&#34;https://tetrate.io/tetrates-guide-to-federal-security-requirements-for-microservices/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SP 800-204Aï¼ŒÂ§SM-DR16ï¼›SP 800-204Bï¼ŒÂ§APE-SR-3&lt;/a&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æˆæƒæœåŠ¡åˆ°æœåŠ¡è®¿é—®&lt;/strong&gt;ï¼šæ¯ä¸ªåº”ç”¨ç¨‹åºéƒ½åº”ä½¿ç”¨å…¶è¿è¡Œæ—¶èº«ä»½æˆæƒä¸ä¹‹é€šä¿¡çš„åº”ç”¨ç¨‹åºï¼ˆ&lt;a href=&#34;https://tetrate.io/tetrates-guide-to-federal-security-requirements-for-microservices/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SP 800-204Bï¼ŒÂ§SAUZ-SR-1&lt;/a&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éªŒè¯æœ€ç»ˆç”¨æˆ·èº«ä»½&lt;/strong&gt;ï¼šæ¯ä¸ªè¯·æ±‚éƒ½å¿…é¡»åœ¨æœåŠ¡è°ƒç”¨å›¾ä¸­çš„æ¯ä¸ªè·ƒç‚¹è¿›è¡Œèº«ä»½éªŒè¯ï¼ˆ&lt;a href=&#34;https://tetrate.io/tetrates-guide-to-federal-security-requirements-for-microservices/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SP 800-204Bï¼ŒÂ§EAUN-SR-1ï¼ŒÂ§EUAZ-SR-3&lt;/a&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æˆæƒæœ€ç»ˆç”¨æˆ·è®¿é—®èµ„æº&lt;/strong&gt;ï¼šå¯¹æ¯ç§èµ„æºçš„æ¯æ¬¡è®¿é—®éƒ½åº”è·å¾—æˆæƒï¼Œè€Œä¸ä»…ä»…æ˜¯åœ¨å‰é—¨è®¿é—®ä¸€æ¬¡ï¼ˆ&lt;a href=&#34;https://tetrate.io/tetrates-guide-to-federal-security-requirements-for-microservices/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SP 800-204Bï¼ŒÂ§EAUZ-SR-3&lt;/a&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Istio æä¾›ä¼ è¾“ä¸­çš„åŠ å¯†ï¼ˆæˆ‘ä»¬åœ¨ä¸Šé¢è®¨è®ºäº†å…¨å±€å¯ç”¨ï¼‰ï¼Œä»¥åŠå¯éªŒè¯çš„æœåŠ¡èº«ä»½ (&lt;a href=&#34;https://tetrate.io/blog/why-would-you-need-spire-for-authentication-with-istio/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SPIFFE&lt;/a&gt; ) å’ŒæœåŠ¡åˆ°æœåŠ¡çš„è®¿é—®æ§åˆ¶ (Istio &lt;code&gt;AuthorizationPolicy&lt;/code&gt;)ã€‚æ­¤å¤–ï¼Œå®ƒå¯ä»¥é…ç½®ä¸ºä»£è¡¨åº”ç”¨ç¨‹åºï¼ˆJWTã€OIDC ä»¤ç‰Œï¼‰éªŒè¯æŸäº›å½¢å¼çš„æœ€ç»ˆç”¨æˆ·èº«ä»½ï¼Œæœ€å Istio æ”¯æŒå¯æ’æ‹”æˆæƒç³»ç»Ÿï¼ˆEnvoy çš„ &lt;code&gt;ext_authz&lt;/code&gt;ï¼‰ä»¥å¼ºåˆ¶æœ€ç»ˆç”¨æˆ·è®¿é—®èµ„æºã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å®‰è£…é™åˆ¶æ€§é»˜è®¤æˆæƒç­–ç•¥&lt;/strong&gt;ã€‚æ ¹æ® &lt;a href=&#34;https://istio.io/latest/docs/ops/best-practices/security/#use-default-deny-patterns&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Istio æœ€ä½³å®è·µ&lt;/a&gt;ï¼Œæ‚¨åº”è¯¥å®‰è£…ä¸€ä¸ªä¸å…è®¸æµé‡çš„é»˜è®¤æˆæƒç­–ç•¥ï¼Œä¸ºæ¯ä¸ªæœåŠ¡å‘å¸ƒå¯¹è±¡åˆ›å»º &lt;code&gt;AuthorizationPolicy&lt;/code&gt; å¯¹è±¡ä»¥ç®¡ç†å…è®¸å®ƒä»¬ä¸ä¹‹é€šä¿¡çš„å¯¹è±¡ï¼ˆ&lt;a href=&#34;https://tetrate.io/tetrates-guide-to-federal-security-requirements-for-microservices/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SP 800-204Bï¼ŒSAUZ-SR-1&lt;/a&gt;ï¼‰ã€‚æœ‰åŠ©äºå®ç°è¿™ä¸€ç›®æ ‡çš„ä¸¤ä¸ªæˆæƒç­–ç•¥ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;security.istio.io/v1beta1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;AuthorizationPolicy&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;deny-all-audit&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;istio-system&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;action&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;AUDIT&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç¤ºä¾‹ 2ï¼š&lt;code&gt;IstioAuthorizationPolicy&lt;/code&gt;ä¼šæ‹’ç»æ‰€æœ‰æµé‡ï¼Œå¹¶å®¡è®¡è®°å½•å®ƒã€‚æ‚¨å¯èƒ½ä¼šè¿è¡Œè¿™æ ·çš„ç­–ç•¥å‡ å‘¨ï¼Œä»¥äº†è§£åœ¨å¯ç”¨å¼ºåˆ¶æ‰§è¡Œä¹‹å‰æ‚¨éœ€è¦çš„ç­–ç•¥ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;security.istio.io/v1beta1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;AuthorizationPolicy&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;deny-all&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;istio-system&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;{&lt;span class=&#34;nt&#34;&gt;} # or action&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;ALLOW&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç¤ºä¾‹ 3ï¼šæ‹’ç»æ‰€æœ‰æµé‡çš„ Istio AuthorizationPolicyã€‚æˆ–è€…ï¼Œæ‚¨å¯ä»¥åˆ›å»ºä¸€ä¸ªå…è®¸ä½†å…·æœ‰ç©ºè§„åˆ™é›†çš„ç­–ç•¥ï¼Œè¿™ä¸ç©ºä¸»ä½“ç›¸åŒã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;é»˜è®¤æƒ…å†µä¸‹éœ€è¦ mTLS è¿›è¡ŒæœåŠ¡åˆ°æœåŠ¡é€šä¿¡&lt;/strong&gt;ã€‚é€šè¿‡åœ¨ç”±å®‰å…¨æˆ–å¹³å°å›¢é˜Ÿç®¡ç†çš„æ ¹å‘½åç©ºé—´ä¸­é…ç½® &lt;code&gt;PeerAuthentication&lt;/code&gt; èµ„æºï¼Œåº”å°†ä¼ è¾“ä¸­çš„åŠ å¯†è®¾ç½®ä¸ºä¸¥æ ¼ï¼ˆå³ &lt;a href=&#34;https://tetrate.io/blog/how-istios-mtls-traffic-encryption-works-as-part-of-a-zero-trust-security-posture/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;éœ€è¦ mTLS æ‰èƒ½ä¸æœåŠ¡é€šä¿¡&lt;/a&gt;ï¼‰ã€‚ç½‘æ ¼å¤–éƒ¨çš„æœåŠ¡è°ƒç”¨ç½‘æ ¼ä¸­çš„åº”ç”¨ç¨‹åºåº”è¯¥é€šè¿‡åº”ç”¨ç¨‹åºå…¥å£ç½‘å…³è¿›è¡Œé€šä¿¡ï¼Œå®ƒå¯ä»¥å‘å¤–éƒ¨æœåŠ¡æä¾›ç®€å•çš„ TLSï¼ˆç”šè‡³æ˜æ–‡ï¼‰ï¼Œå› ä¸ºå®ƒä¸å¤ªå¯èƒ½æœ‰è¯ä¹¦æ¥å¯¹ç½‘æ ¼æ‰§è¡Œ mTLSã€‚ç½‘æ ¼å†…éƒ¨çš„æœåŠ¡å‘¼å‡ºåº”é…ç½®ä¸ºä½¿ç”¨ç®€å•çš„ TLS æˆ–æ˜æ–‡ï¼Œå¹¶å¸¦æœ‰ç”¨äºå¤–éƒ¨æœåŠ¡çš„ DestinationRule çš„æ˜æ–‡ (&lt;a href=&#34;https://tetrate.io/tetrates-guide-to-federal-security-requirements-for-microservices/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;NIST SP 800-204A, Â§SM-DR8&lt;/a&gt; )ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;TLS é…ç½®é»˜è®¤å€¼&lt;/strong&gt;ã€‚Istio å¼€ç®±å³ç”¨ï¼Œå…·æœ‰è‰¯å¥½çš„ TLS è®¾ç½®ï¼ˆ&lt;a href=&#34;https://istio.io/latest/docs/concepts/security/#mutual-tls-authentication&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;TLS æœ€ä½ç‰ˆæœ¬ 1.2ï¼Œå…·æœ‰ä¸€ç»„æœ‰é™çš„å¯†ç å¥—ä»¶&lt;/a&gt;ï¼‰ï¼Œä½†æ‚¨å¯èƒ½éœ€è¦æ ¹æ®æ‚¨çš„ç¯å¢ƒå¯¹å…¶è¿›è¡Œè°ƒæ•´ï¼ˆä¾‹å¦‚ï¼Œåœ¨ &lt;a href=&#34;https://www.fedramp.gov/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;FedRAMP&lt;/a&gt; ç¯å¢ƒä¸­éµå®ˆ &lt;a href=&#34;https://csrc.nist.gov/publications/detail/fips/140/3/final&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;FIPS 140-3&lt;/a&gt; ï¼‰ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Envoy æ”¯æŒé€šè¿‡é…ç½® &lt;a href=&#34;https://istio.io/latest/docs/reference/config/networking/gateway/#ServerTLSSettings-cipher_suites&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç½‘å…³&lt;/a&gt; ä¸ºæ¯ä¸ªæœåŠ¡é…ç½®æœ€ä½ TLS ç‰ˆæœ¬å’Œä¸€ç»„å—æ”¯æŒçš„å¯†ç å¥—ä»¶ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœå¯èƒ½ï¼Œæˆ‘ä»¬å»ºè®®å°† &lt;strong&gt;TLS 1.3 ä½œä¸ºæœ€ä½ç‰ˆæœ¬&lt;/strong&gt; æ‰§è¡Œï¼ˆå¦‚æœæ‚¨åªæ‰§è¡Œ mTLS Envoy-to-Envoyï¼‰ï¼Œå¹¶ä¸ºéœ€è¦è¾ƒæ—§æˆ–å®‰å…¨æ€§è¾ƒä½çš„ TLS é…ç½®çš„å¤–éƒ¨æµé‡ä½¿ç”¨ç½‘å…³ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;ä¸ºæ¯ä¸ªæœåŠ¡åˆ†é…ä¸€ä¸ªå”¯ä¸€çš„è¿è¡Œæ—¶èº«ä»½ï¼Œä»¥ä¿ƒè¿›è¡¨è¾¾æ€§å¼ºã€ç»†ç²’åº¦çš„æˆæƒç­–ç•¥å¹¶é™åˆ¶æš´éœ²äºæ”»å‡»&lt;/strong&gt;ã€‚ä¸ºæ‚¨æ­£åœ¨éƒ¨ç½²çš„æ¯ä¸ªæœåŠ¡åˆ†é…ä¸€ä¸ªå”¯ä¸€çš„è¿è¡Œæ—¶æ ‡è¯†ã€‚åœ¨ Kubernetes ä¸­ï¼Œä¸è¦åœ¨æ¯ä¸ªå‘½åç©ºé—´ä¸­ä½¿ç”¨é»˜è®¤çš„ Kubernetes æœåŠ¡å¸æˆ·ï¼Œè€Œæ˜¯ä¸ºæ¯ä¸ªå‘½åç©ºé—´ä¸­çš„æ¯ä¸ªæœåŠ¡åˆ†é…ä¸€ä¸ªå”¯ä¸€çš„æœåŠ¡å¸æˆ·ã€‚æˆæƒç­–ç•¥åªèƒ½åœ¨èº«ä»½çš„ç²’åº¦ä¸Šè½»æ¾ç®¡ç†ã€‚å½“å¤šä¸ªè¿è¡Œæ—¶ç»„ä»¶å…±äº«ç›¸åŒçš„èº«ä»½æ—¶ï¼Œå¾ˆéš¾ç®¡ç†ä¸€ä¸ªè®¿é—®æ§åˆ¶ç­–ç•¥æ¥è¡¨è¾¾æ‚¨çš„é¢„æœŸè®¿é—®æƒé™ï¼ŒåŒæ—¶ä¸å…è®¸ä½¿ç”¨å…±äº«èº«ä»½çš„æŸäº›ç»„ä»¶è¿›è¡Œè¿‡äºå¹¿æ³›çš„è®¿é—®ã€‚è¿™å¯¼è‡´æ›´å¤§çš„è¡¨é¢ç§¯æš´éœ²ç»™å¯èƒ½å±åŠç³»ç»Ÿçš„ä¸€ä¸ªç»„ä»¶çš„æ”»å‡»è€…ï¼ˆ&lt;a href=&#34;https://tetrate.io/tetrates-guide-to-federal-security-requirements-for-microservices/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;NIST SP 800-204A Â§SM-DR11ï¼ŒÂ§SM-DR18&lt;/a&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å°†æœåŠ¡åˆ°æœåŠ¡çš„é€šä¿¡é™åˆ¶åœ¨æœ¬åœ°å‘½åç©ºé—´&lt;/strong&gt;ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒæœåŠ¡é—´é€šä¿¡åº”é™åˆ¶åœ¨æœ¬åœ°åç§°ç©ºé—´å†…ã€‚ä¸å¹¸çš„æ˜¯ï¼Œè¿™ä¸èƒ½å†™ä¸ºæ ¹é…ç½®å‘½åç©ºé—´ä¸­çš„å•ä¸ª AuthorizationPolicyã€‚ç›¸åï¼Œå¯ä»¥å°†ä»…å…è®¸åœ¨æœ¬åœ°å‘½åç©ºé—´ä¸­è®¿é—®çš„é»˜è®¤ AuthorizationPolicy æ¨¡æ¿åŒ–ä¸ºé»˜è®¤å€¼ï¼Œå¹¶ä¸”åº”å…è®¸åº”ç”¨ç¨‹åºå›¢é˜Ÿç¼–å†™ä»–ä»¬è‡ªå·±çš„æ›´ä¸“ä¸šï¼ˆå—é™ï¼‰çš„ç­–ç•¥ï¼ˆ&lt;a href=&#34;https://tetrate.io/tetrates-guide-to-federal-security-requirements-for-microservices/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;NIST SP800-204Bï¼ŒÂ§SAUZ-SR-1&lt;/a&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä¸‹ä¸€æ­¥&#34;&gt;ä¸‹ä¸€æ­¥&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬å¸Œæœ›ä»æˆ‘ä»¬å¤šå¹´å¸®åŠ©å®¢æˆ·æ„å»ºæˆåŠŸçš„æœåŠ¡ç½‘æ ¼å®è·µçš„ç»éªŒä¸­è·å¾—çš„è¿™äº›æœ€ä½³å®è·µå°†æœ‰åŠ©äºä¿ƒè¿›æ‚¨çš„éƒ¨ç½²ã€‚å¦‚æœæ‚¨è¿˜æ²¡æœ‰ï¼Œè¯·æŸ¥çœ‹æœåŠ¡ç½‘æ ¼æœ€ä½³å®è·µç³»åˆ—ä¸­çš„å…¶ä»–å¸–å­ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://lib.jimmysong.io/blog/how-service-mesh-layers-microservices-security-with-traditional-security-to-move-fast-safely/&#34;&gt;ç¬¬ 1 éƒ¨åˆ†ï¼šå¦‚ä½•å°†æœåŠ¡ç½‘æ ¼ä½œä¸ºå®‰å…¨æ¨¡å‹çš„ä¸€éƒ¨åˆ†ï¼Œä»¥åˆ†å±‚å½¢å¼å°†å¾®æœåŠ¡å®‰å…¨ä¸ä¼ ç»Ÿå®‰å…¨ç»“åˆèµ·æ¥&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://lib.jimmysong.io/blog/service-mesh-deployment-best-practices-for-security-and-high-availability/&#34;&gt;ç¬¬ 2 éƒ¨åˆ†ï¼šæœåŠ¡ç½‘æ ¼å®‰å…¨æ€§å’Œé«˜å¯ç”¨æ€§éƒ¨ç½²æœ€ä½³å®è·µ&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¦‚éœ€å…¨é¢äº†è§£ NIST å¾®æœåŠ¡å®‰å…¨æ ‡å‡†ï¼Œè¯· &lt;a href=&#34;https://tetrate.io/tetrates-guide-to-federal-security-requirements-for-microservices/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä¸‹è½½æˆ‘ä»¬çš„å…è´¹æŒ‡å—&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ¥ä¸‹æ¥å¤šç§Ÿæˆ·çš„æœåŠ¡ç½‘æ ¼æœ€ä½³å®è·µ&#34;&gt;æ¥ä¸‹æ¥ï¼šå¤šç§Ÿæˆ·çš„æœåŠ¡ç½‘æ ¼æœ€ä½³å®è·µ&lt;/h3&gt;
&lt;p&gt;åœ¨æˆ‘ä»¬å…³äºæœåŠ¡ç½‘æ ¼æœ€ä½³å®è·µç³»åˆ—çš„ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºæˆ‘ä»¬çœ‹åˆ°å®¢æˆ·æ­£åœ¨åŠªåŠ›è§£å†³çš„å¸¸è§ç§Ÿèµå†³ç­–ç‚¹ï¼Œå¹¶é‡ç‚¹å…³æ³¨ç½‘æ ¼å¦‚ä½•å¸®åŠ©ä¿ƒè¿›è¿™äº›å†³ç­–ã€‚æˆ‘ä»¬å°†æ¶µç›–çš„ä¸»é¢˜åŒ…æ‹¬ Kubernetes é›†ç¾¤æ‰€æœ‰æƒã€å‘½åç©ºé—´æ‰€æœ‰æƒã€é…ç½®æ‰€æœ‰æƒï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨æœåŠ¡ç½‘æ ¼åº”ç”¨ç¨‹åºç½‘å…³æ¥ç¼“è§£ä¸­æ–­ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>æœåŠ¡ç½‘æ ¼å®‰å…¨æ€§å’Œé«˜å¯ç”¨æ€§éƒ¨ç½²æœ€ä½³å®è·µ</title>
      <link>https://lib.jimmysong.io/blog/service-mesh-deployment-best-practices-for-security-and-high-availability/</link>
      <pubDate>Mon, 30 Jan 2023 11:00:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/service-mesh-deployment-best-practices-for-security-and-high-availability/</guid>
      <description>&lt;p&gt;è¿™æ˜¯ &lt;a href=&#34;https://tetrate.io/blog/how-service-mesh-layers-microservices-security-with-traditional-security-to-move-fast-safely/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æœåŠ¡ç½‘æ ¼æœ€ä½³å®è·µç³»åˆ—æ–‡ç« &lt;/a&gt; ä¸­çš„ç¬¬äºŒç¯‡ï¼Œæ‘˜è‡ª Tetrate åˆ›å§‹å·¥ç¨‹å¸ˆ Zack Butcher å³å°†å‡ºç‰ˆçš„ä¹¦ç± Istio in Production ã€‚&lt;/p&gt;
&lt;p&gt;å½“æ¶‰åŠåˆ°åœ¨å¤šé›†ç¾¤çš„åŸºç¡€è®¾æ–½ä¸­éƒ¨ç½²æœåŠ¡ç½‘æ ¼æ—¶ï¼Œæœ‰ä¸€äº›å¯ç§»åŠ¨çš„éƒ¨åˆ†ã€‚è¿™é‡Œä¸»è¦æƒ³å¼ºè°ƒçš„æ˜¯æ§åˆ¶å¹³é¢åº”è¯¥å¦‚ä½•éƒ¨ç½²åœ¨åº”ç”¨ç¨‹åºé™„è¿‘ï¼Œå…¥å£åº”è¯¥å¦‚ä½•éƒ¨ç½²ä»¥ä¿ƒè¿›å®‰å…¨æ€§å’Œæ•æ·æ€§ï¼Œå¦‚ä½•ä½¿ç”¨ Envoy ä¿ƒè¿›è·¨é›†ç¾¤è´Ÿè½½å‡è¡¡ï¼Œä»¥åŠç½‘æ ¼å†…éƒ¨å¦‚ä½•ä½¿ç”¨è¯ä¹¦ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä½¿æœåŠ¡ç½‘æ ¼æ§åˆ¶å¹³é¢ä¸æ•…éšœåŸŸä¿æŒä¸€è‡´&#34;&gt;ä½¿æœåŠ¡ç½‘æ ¼æ§åˆ¶å¹³é¢ä¸æ•…éšœåŸŸä¿æŒä¸€è‡´&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;å»ºè®®ï¼šå›´ç»•æ•…éšœåŸŸéƒ¨ç½²æ¾æ•£è€¦åˆçš„æ§åˆ¶å¹³é¢ä»¥å®ç°é«˜å¯ç”¨æ€§ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æ„å»ºé«˜å¯ç”¨æ€§ç³»ç»Ÿå¯èƒ½å…·æœ‰æŒ‘æˆ˜æ€§ï¼Œè€Œä¸”é€šå¸¸æˆæœ¬å¾ˆé«˜ã€‚æˆ‘ä»¬çŸ¥é“çš„ä¸€ç§ç»è¿‡éªŒè¯çš„æŠ€æœ¯æ˜¯å›´ç»•æ•…éšœåŸŸæ„å»ºã€‚æ•…éšœåŸŸæ˜¯å½“å…³é”®ç³»ç»Ÿå‘ç”Ÿæ•…éšœæ—¶å—å½±å“çš„åŸºç¡€æ¶æ„éƒ¨åˆ†ã€‚æˆ‘ä»¬æ„å»ºå¯é ç³»ç»Ÿçš„åŸºæœ¬æ–¹æ³•æ˜¯å°†ç³»ç»Ÿè·¨è¶Šçš„æ•…éšœåŸŸåˆ†ç»„ä¸ºå¤šä¸ªç‹¬ç«‹çš„å­¤å²›ã€‚æœ€ç»ˆç³»ç»Ÿçš„æ•´ä½“å¯é æ€§å–å†³äºæˆ‘ä»¬å¯ä»¥ä½¿å­¤å²›çš„ç‹¬ç«‹ç¨‹åº¦ã€‚å®é™…ä¸Šï¼Œæ€»æ˜¯å­˜åœ¨ä¸€äº›ç›¸äº’ä¾èµ–æ€§ï¼Œå°†å…¶æœ€å°åŒ–æ€»æ˜¯æˆæœ¬ä¸å¯ç”¨æ€§çš„æƒè¡¡ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æ²¡æœ‰è€¦åˆæ•…éšœåŸŸçš„æƒ…å†µä¸‹åˆ›å»ºéš”ç¦»å­¤å²›çš„æœ€ç®€å•æ–¹æ³•æ˜¯åœ¨æ¯ä¸ªå­¤å²›ä¸­è¿è¡Œå…³é”®æœåŠ¡çš„ç‹¬ç«‹å‰¯æœ¬ã€‚æˆ‘ä»¬å¯ä»¥è¯´è¿™äº›å‰¯æœ¬æ˜¯ç­’ä»“çš„æœ¬åœ°å‰¯æœ¬ â€”â€” å®ƒä»¬å…±äº«ç›¸åŒçš„æ•…éšœåŸŸã€‚åœ¨äº‘åŸç”Ÿæ¶æ„ä¸­ï¼ŒKubernetes é›†ç¾¤å½¢æˆäº†æœ€è‡ªç„¶çš„ç­’ä»“è¾¹ç•Œã€‚Istio æ˜¯ä¸€é¡¹å…³é”®æœåŠ¡ï¼Œå› æ­¤æˆ‘ä»¬åœ¨æ¯ä¸ªåº”ç”¨ç¨‹åºé›†ç¾¤ä¸­è¿è¡Œä¸€ä¸ª Istio æ§åˆ¶å¹³é¢å®ä¾‹ã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬éƒ¨ç½² Istio ä½¿å…¶æ•…éšœåŸŸä¸æ‚¨çš„åº”ç”¨ç¨‹åºçš„æ•…éšœåŸŸä¿æŒä¸€è‡´ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤å¤–ï¼Œæˆ‘ä»¬ç¡®ä¿ Istio æ§åˆ¶å¹³é¢å®ä¾‹æ˜¯æ¾æ•£è€¦åˆçš„ï¼Œä¸éœ€è¦ç›´æ¥ä¸å…¶ä»–é›†ç¾¤é€šä¿¡ï¼Œä»è€Œæœ€å¤§é™åº¦åœ°å‡å°‘å…¶ä¸å­¤å²›å¤–éƒ¨çš„é€šä¿¡ã€‚æœ‰å…³å¦‚ä½•å®ç°æ­¤ç›®çš„çš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ä¸‹é¢çš„å¤šé›†ç¾¤éƒ¨åˆ†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä½¿ç”¨åº”ç”¨ç¨‹åºå…¥å£ç½‘å…³éš”ç¦»æ¯ä¸ªåº”ç”¨ç¨‹åºçš„æµé‡&#34;&gt;ä½¿ç”¨åº”ç”¨ç¨‹åºå…¥å£ç½‘å…³éš”ç¦»æ¯ä¸ªåº”ç”¨ç¨‹åºçš„æµé‡&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;å»ºè®®ï¼šä»æ¯ä¸ªåº”ç”¨ç¨‹åºæˆ–åº”ç”¨ç¨‹åºå›¢é˜Ÿçš„ç½‘å…³ï¼ˆåº”ç”¨ç¨‹åºå…¥å£ç½‘å…³ï¼‰å¼€å§‹ï¼Œä»¥å¸®åŠ©ç¼“è§£å…±äº«ä¸­æ–­ã€‚éšç€æ—¶é—´çš„æ¨ç§»æ‚¨æ“ä½œç»éªŒçš„å¢åŠ ï¼Œå°†åº”ç”¨ç¨‹åºå…¥å£åˆå¹¶åˆ°å…±äº«ç½‘å…³ä»¥ä¼˜åŒ–æˆæœ¬ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è™½ç„¶ Istio é»˜è®¤é™„å¸¦å…±äº« &lt;code&gt;istio-ingressgateway&lt;/code&gt;ï¼Œä½†æˆ‘ä»¬ä¸å»ºè®®ä½¿ç”¨å…±äº«ç½‘å…³ã€‚å¤§å¤šæ•°é‡‡ç”¨ç½‘æ ¼çš„å›¢é˜Ÿéƒ½éœ€è¦æ—¶é—´æ¥æ„å»ºå®æ–½å…±äº«ç½‘å…³æ¨¡å‹æ‰€éœ€çš„å®¡æŸ¥å®è·µå’Œæ“ä½œï¼Œè€Œæ²¡æœ‰å…±äº«ä¸­æ–­çš„é£é™©ã€‚ç‰¹åˆ«æ˜¯åœ¨ Istio å®æ–½çš„æ—©æœŸï¼Œæˆ‘ä»¬å»ºè®®æ¯ä¸ªå›¢é˜Ÿéƒ¨ç½²ä¸€ä¸ª Envoy ç½‘å…³ã€‚æˆ‘ä»¬ç§°è¿™äº›ä¸ºåº”ç”¨ç¨‹åºå…¥å£ç½‘å…³ã€‚éšç€æ‚¨è·å¾—æ“ä½œç»éªŒï¼Œæ‚¨å¯ä»¥å¼€å§‹å°†åº”ç”¨ç¨‹åºåˆå¹¶åˆ°å…±äº«ç½‘å…³ä¸Šä»¥ä¼˜åŒ–æˆæœ¬ã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨å…±äº«ç½‘å…³æ¨¡å‹å®ç°æ¯ä¸ªå›¢é˜Ÿéš”ç¦»çš„æ·å¾„æ˜¯ä¸ºæ¯ä¸ªå›¢é˜Ÿåˆ†é…ä¸€ä¸ªå•ç‹¬çš„ä¸»æœºåã€‚æŒ‰ä¸»æœºåéš”ç¦»çš„å›¢é˜Ÿå¯ä»¥æ›´å®‰å…¨åœ°é…ç½®å…±äº«ç½‘å…³å®ä¾‹ã€‚ç„¶è€Œï¼Œå…¶ä»–å…±åŒå‘½è¿çš„ä¸­æ–­é£é™©ä»ç„¶å­˜åœ¨ï¼Œä¾‹å¦‚å…¥å£ä»£ç†éƒ¨ç½²çš„é”™è¯¯é…ç½®ã€å˜ˆæ‚çš„é‚»å±…æ¶ˆè€—èµ„æºå’Œå¢åŠ æ‰€æœ‰åº”ç”¨ç¨‹åºçš„å»¶è¿Ÿç­‰ã€‚æ ¹æ®æˆ‘ä»¬çš„ç»éªŒï¼Œæ¯ä¸ªå›¢é˜Ÿä¸€ä¸ªç½‘å…³çš„æ–¹æ³•ä¼šäº§ç”Ÿæœ€å¿«çš„å½±å“ï¼Œå¹¶ä¸”å¤±è´¥çš„æœºä¼šæœ€å°‘ï¼Œå¹¶ä¸”æ€»ä½“æˆæœ¬ç›¸å¯¹è¾ƒä½ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æœŸæœ›æˆç†Ÿéƒ¨ç½²çš„æœ€ç»ˆçŠ¶æ€æ˜¯ 80-20 çš„æ¯”ä¾‹ï¼šå¤§å¤šæ•°åº”ç”¨ç¨‹åºå°†é€šè¿‡å…±äº«ç½‘å…³æ¥æ”¶æµé‡ï¼Œè€Œä¸€å°éƒ¨åˆ†é«˜åº¦å…³é”®æˆ–æ•æ„Ÿçš„åº”ç”¨ç¨‹åºå°†ä¿ç•™ä¸“ç”¨ç½‘å…³ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä½¿ç”¨åº”ç”¨ç¨‹åºè¾¹ç¼˜ç½‘å…³åœ¨å¤šä¸ªé›†ç¾¤ä¹‹é—´åˆ†é…å…¥å£æµé‡&#34;&gt;ä½¿ç”¨åº”ç”¨ç¨‹åºè¾¹ç¼˜ç½‘å…³åœ¨å¤šä¸ªé›†ç¾¤ä¹‹é—´åˆ†é…å…¥å£æµé‡&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;å»ºè®®ï¼šä½¿ç”¨åº”ç”¨ç¨‹åºè¾¹ç¼˜ç½‘å…³ä¸ºå®¢æˆ·ç«¯æä¾›å•ä¸€åœ°å€ï¼Œä»¥ä¾›å®¢æˆ·ç«¯ä½¿ç”¨å¹¶å°†æµé‡åˆ†é…åˆ°è·¨å¤šä¸ªé›†ç¾¤çš„åº”ç”¨ç¨‹åºå…¥å£ç½‘å…³ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-1-åŸºäº-envoy-çš„åº”ç”¨ç¨‹åºè¾¹ç¼˜ç½‘å…³&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 1ï¼š åŸºäº Envoy çš„åº”ç”¨ç¨‹åºè¾¹ç¼˜ç½‘å…³ã€‚&#34; srcset=&#34;
               /blog/service-mesh-deployment-best-practices-for-security-and-high-availability/f1_hu4e0af13941a7213066b93c4df427cd8b_40712_a448cc91266eb47109ac05d244d771af.webp 400w,
               /blog/service-mesh-deployment-best-practices-for-security-and-high-availability/f1_hu4e0af13941a7213066b93c4df427cd8b_40712_7bc3e1cf719370fafad06d040ee934b0.webp 760w,
               /blog/service-mesh-deployment-best-practices-for-security-and-high-availability/f1_hu4e0af13941a7213066b93c4df427cd8b_40712_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/service-mesh-deployment-best-practices-for-security-and-high-availability/f1_hu4e0af13941a7213066b93c4df427cd8b_40712_a448cc91266eb47109ac05d244d771af.webp&#34;
               width=&#34;744&#34;
               height=&#34;680&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 1ï¼š åŸºäº Envoy çš„åº”ç”¨ç¨‹åºè¾¹ç¼˜ç½‘å…³ã€‚
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ç»å¸¸çœ‹åˆ°å®¢æˆ·éœ€è¦è·¨å¤šä¸ªé›†ç¾¤åˆ†é…å…¥å£æµé‡ã€‚ä¾‹å¦‚ï¼Œä»–ä»¬å¯èƒ½å¸Œæœ›å¯ç”¨è“ / ç»¿åŸºç¡€è®¾æ–½å‡çº§ï¼Œä»¥ä¿ƒè¿›è·¨åŒºåŸŸæ•…éšœè½¬ç§»ï¼Œæˆ–è€…é€šè¿‡ä½¿ç”¨ Envoy çš„ L7 åŠŸèƒ½å°†æµé‡ä»å•ä½“è¿ç§»åˆ°å¾®æœåŠ¡æ¥å®ç°æ‰¼æ€æ¨¡å¼ã€‚æˆ‘ä»¬ç§°è¿™äº›ä¸ºåº”ç”¨ç¨‹åºè¾¹ç¼˜ç½‘å…³ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†å®ç°è¿™ä¸ªç”¨ä¾‹ï¼Œæˆ‘ä»¬å°†éƒ¨ç½² Envoyâ€”â€” åœ¨ä¸“ç”¨çš„ Kubernetes é›†ç¾¤ä¸­æˆ–ä½œä¸ºä¸€ç»„è™šæ‹Ÿæœº â€”â€” æ¥æ¥æ”¶å¤–éƒ¨æµé‡ã€‚è¿™äº› Envoy å®ä¾‹å°†é€šè¿‡å…¶ Kubernetes å…¥å£æˆ– VM VIP å°†æµé‡è½¬å‘åˆ°æ‚¨çš„åº”ç”¨ç¨‹åºã€‚è¿™ä¸ ingress-per-team æ–¹æ³•ååŒå·¥ä½œï¼šå¤šé›†ç¾¤ç½‘å…³ä¸ºå®¢æˆ·ç«¯æä¾›ä¸€ä¸ªå•ä¸€åœ°å€ä»¥ä¾›ä½¿ç”¨ï¼Œæ ¹æ®æ‚¨çš„åŸºç¡€è®¾æ–½éœ€è¦æä¾›å°½å¯èƒ½å¤šçš„åº”ç”¨ç¨‹åºç½‘å…³å’Œé›†ç¾¤ã€‚&lt;/p&gt;
&lt;p&gt;è™½ç„¶æ­¤ç½‘å…³ç¡®å®å­˜åœ¨å…±äº«æ•…éšœåŸŸï¼Œä½†å…¶é…ç½®è¿œæ¯”æ¯ä¸ªåº”ç”¨ç¨‹åºä¸€ä¸ªå…¥å£ç½‘å…³çš„é…ç½®ç®€å•ã€‚å› æ­¤ï¼Œä½œä¸ºå…±äº«åŸºç¡€æ¶æ„è¿è¡Œèµ·æ¥æ›´å®¹æ˜“ï¼Œä¹Ÿæ›´å®‰å…¨ã€‚æ¯ä¸ªé›†ç¾¤éƒ½æœ‰ä¸€ä¸ªåº”ç”¨ç¨‹åºå…¥å£ç½‘å…³çš„å…±äº«åº”ç”¨ç¨‹åºè¾¹ç¼˜ç½‘å…³æ˜¯ä¸€ç§å¼ºå¤§è€Œçµæ´»çš„æ¨¡å‹ï¼Œç”¨äºåœ¨ç½‘æ ¼ä¸Šéƒ¨ç½²å’Œæ“ä½œåº”ç”¨ç¨‹åºï¼Œè¿˜å¯ä»¥æ›´è½»æ¾åœ°æ“ä½œåº•å±‚åŸºç¡€è®¾æ–½ã€‚&lt;/p&gt;
&lt;h2 id=&#34;è¯ä¹¦å’Œå…¬é’¥åŸºç¡€è®¾æ–½-pki-çš„å»ºè®®&#34;&gt;è¯ä¹¦å’Œå…¬é’¥åŸºç¡€è®¾æ–½ (PKI) çš„å»ºè®®&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;å»ºè®®ï¼š ä»æ‚¨ç°æœ‰çš„ä¼ä¸šæ ¹ç›®å½•ä¸ºç½‘æ ¼ mTLS åˆ›å»ºä¸€ä¸ªä¸­é—´ç­¾åè¯ä¹¦ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Istio ä½¿ç”¨å¸¸è§„ X.509 è¯ä¹¦è¿›è¡Œèº«ä»½éªŒè¯å¹¶åœ¨ç½‘æ ¼ä¸­å¯ç”¨ä¼ è¾“åŠ å¯†ã€‚æˆ‘ä»¬å»ºè®®ä¸ºç°æœ‰ä¼ä¸šæ ¹ç›®å½•ä¸­çš„æ‰€æœ‰ç½‘æ ¼ mTLS åˆ›å»ºä¸€ä¸ªç½‘æ ¼ä¸­é—´ç­¾åè¯ä¹¦ã€‚å¦‚æœæ¯ä¸ªç¯å¢ƒéƒ½æœ‰ä¸€ä¸ªæ ¹ï¼Œè¯·ä¸ºæ¯ä¸ªç¯å¢ƒåˆ›å»ºä¸€ä¸ªç½‘æ ¼ä¸­é—´ç­¾åè¯ä¹¦ã€‚ä½¿ç”¨è¯¥ç½‘æ ¼ä¸­é—´é¢å‘è¯ä¹¦ä¸ºæ¯ä¸ª Istio å®‰è£…åˆ›å»ºä¸€ä¸ªç­¾åè¯ä¹¦ã€‚æˆ‘ä»¬å»ºè®®åˆ›å»ºä¸€ä¸ªç½‘æ ¼ä¸­é—´ç­¾åè¯ä¹¦ï¼Œä»¥ä¾¿åœ¨ä»»ä½•ç‰¹å®šç¯å¢ƒä¸­ç½‘æ ¼çš„æ•´ä¸ª PKI æ˜¯ä¸€æ£µæ ‘ï¼Œå¦‚æœéœ€è¦å¯ä»¥ä¸€èµ·å¤±æ•ˆã€‚æˆæœ¬æ˜¯ä¸€äº›é¢å¤–çš„è¯ä¹¦ç®¡ç†ï¼Œä¸æ§åˆ¶å¹³é¢ç­¾åè¯ä¹¦ç›¸æ¯”ï¼Œåœ¨ç®¡ç†ç½‘æ ¼ä¸­é—´ç­¾åè¯ä¹¦çš„ç”Ÿå‘½å‘¨æœŸæ—¶éœ€è¦æ›´åŠ å°å¿ƒã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-2-tetrate-æ¨èçš„å°†ç½‘æ ¼ä¸ç°æœ‰-pki-é›†æˆçš„æ–¹æ³•åœ¨ç¯å¢ƒå¦‚-prodä¸­ä¸º-istio-ç”Ÿæˆä¸­é—´ç­¾åè¯ä¹¦ä½¿ç”¨å®ƒå‘è¯¥ç¯å¢ƒä¸­çš„æ¯ä¸ª-istio-æ§åˆ¶å¹³é¢å®ä¾‹é¢å‘ç­¾åè¯ä¹¦å¹¶è®©-istio-åƒå¾€å¸¸ä¸€æ ·å‘æ¯ä¸ªé›†ç¾¤ä¸­çš„æ‰€æœ‰-pod-é¢å‘å·¥ä½œè´Ÿè½½å¶è¯ä¹¦&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 2. Tetrate æ¨èçš„å°†ç½‘æ ¼ä¸ç°æœ‰ PKI é›†æˆçš„æ–¹æ³•ï¼šåœ¨ç¯å¢ƒï¼ˆå¦‚ prodï¼‰ä¸­ä¸º Istio ç”Ÿæˆä¸­é—´ç­¾åè¯ä¹¦ï¼Œä½¿ç”¨å®ƒå‘è¯¥ç¯å¢ƒä¸­çš„æ¯ä¸ª Istio æ§åˆ¶å¹³é¢å®ä¾‹é¢å‘ç­¾åè¯ä¹¦ï¼Œå¹¶è®© Istio åƒå¾€å¸¸ä¸€æ ·å‘æ¯ä¸ªé›†ç¾¤ä¸­çš„æ‰€æœ‰ pod é¢å‘å·¥ä½œè´Ÿè½½ï¼ˆå¶ï¼‰è¯ä¹¦ã€‚&#34; srcset=&#34;
               /blog/service-mesh-deployment-best-practices-for-security-and-high-availability/f2_hu499f3b283f11a5f6c5b370fbb7ef2e62_57204_89f149631ba0dc84d69e58782a7f81bb.webp 400w,
               /blog/service-mesh-deployment-best-practices-for-security-and-high-availability/f2_hu499f3b283f11a5f6c5b370fbb7ef2e62_57204_cf40f8e9ddd50f1c6e569edfda4972fc.webp 760w,
               /blog/service-mesh-deployment-best-practices-for-security-and-high-availability/f2_hu499f3b283f11a5f6c5b370fbb7ef2e62_57204_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/service-mesh-deployment-best-practices-for-security-and-high-availability/f2_hu499f3b283f11a5f6c5b370fbb7ef2e62_57204_89f149631ba0dc84d69e58782a7f81bb.webp&#34;
               width=&#34;760&#34;
               height=&#34;459&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 2. Tetrate æ¨èçš„å°†ç½‘æ ¼ä¸ç°æœ‰ PKI é›†æˆçš„æ–¹æ³•ï¼šåœ¨ç¯å¢ƒï¼ˆå¦‚ prodï¼‰ä¸­ä¸º Istio ç”Ÿæˆä¸­é—´ç­¾åè¯ä¹¦ï¼Œä½¿ç”¨å®ƒå‘è¯¥ç¯å¢ƒä¸­çš„æ¯ä¸ª Istio æ§åˆ¶å¹³é¢å®ä¾‹é¢å‘ç­¾åè¯ä¹¦ï¼Œå¹¶è®© Istio åƒå¾€å¸¸ä¸€æ ·å‘æ¯ä¸ªé›†ç¾¤ä¸­çš„æ‰€æœ‰ pod é¢å‘å·¥ä½œè´Ÿè½½ï¼ˆå¶ï¼‰è¯ä¹¦ã€‚
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;Istio ç›‘è§†æ–‡ä»¶ç³»ç»Ÿï¼Œå¹¶åœ¨æ£€æµ‹åˆ°æ–‡ä»¶æ›´æ”¹æ—¶é‡æ–°åŠ è½½å…¶ç­¾åè¯ä¹¦ã€‚å› æ­¤ï¼Œåªè¦ä½ æœ‰ä¸€ä¸ªæ‰¹å‡†çš„æœºåˆ¶æ¥å°†ç§˜å¯†åŠ è½½åˆ° &lt;em&gt;istiod&lt;/em&gt; pod çš„æ–‡ä»¶ç³»ç»Ÿä¸­ â€”â€” æ¯”å¦‚ &lt;em&gt;cert-manager&lt;/em&gt;ã€Vault çš„ &lt;em&gt;init-agent&lt;/em&gt; æˆ– sidecarï¼Œæˆ–è€…åªæ˜¯å­˜å‚¨åœ¨åŠ å¯† &lt;em&gt;etcd&lt;/em&gt; ä¸­çš„æ™®é€šæ—§ Kubernetes Secretâ€”â€” é›†æˆ Istio è¿›å…¥æ‚¨çš„ PKI åº”è¯¥å¾ˆå®¹æ˜“ã€‚æ§åˆ¶å¹³é¢ç­¾åè¯ä¹¦çš„è½®æ¢åº”ç”±æ‚¨çš„ PKI è‡ªåŠ¨æ‰§è¡Œã€‚&lt;/p&gt;
&lt;p&gt;Istio ä½¿ç”¨ä¼—æ‰€å‘¨çŸ¥çš„å¯†ç å­¦åº“ï¼šIstio çš„å†…éƒ¨ CA ä½¿ç”¨ Golang çš„å¯†ç å­¦å¥—ä»¶ï¼ŒEnvoyï¼ˆsidecar å’Œ ingressï¼‰ä½¿ç”¨ BoringSSL è¿›è¡Œè¯ä¹¦éªŒè¯å’Œä¼ è¾“ä¸­çš„åŠ å¯†ã€‚é€šè¿‡ Tetrate çš„å¼€æº Istio å‘è¡Œç‰ˆ &lt;a href=&#34;https://tetr8.io/tid&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tetrate Istio Distro&lt;/a&gt; ï¼Œç»è¿‡ FIPS éªŒè¯çš„æ§åˆ¶å¹³é¢å’Œæ•°æ®å¹³é¢æ„å»ºä¹Ÿä½œä¸º &lt;a href=&#34;https://tetr8.io/tis&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tetrate Istio è®¢é˜…&lt;/a&gt; çš„ä¸€éƒ¨åˆ†æä¾›ï¼Œå› æ­¤æ‚¨å¯èƒ½æœŸæœ›çš„æ‰€æœ‰ X.509 çº¦æŸï¼ˆåŸºæœ¬çº¦æŸï¼Œå¦‚ CA å’Œæ·±åº¦ï¼Œå¼€ç®±å³ç”¨åœ°æ”¯æŒå’Œå¼ºåˆ¶æ‰§è¡Œå‘½åçº¦æŸã€ç­–ç•¥çº¦æŸç­‰ï¼‰ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä½¿ç”¨æçŸ­å¯¿å‘½çš„å·¥ä½œè´Ÿè½½è¯ä¹¦ä»¥è½»æ¾åŠé”€&#34;&gt;ä½¿ç”¨æçŸ­å¯¿å‘½çš„å·¥ä½œè´Ÿè½½è¯ä¹¦ä»¥è½»æ¾åŠé”€&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;å»ºè®®ï¼šä½¿ç”¨ Istio æ¥è‡ªåŠ¨åŒ–è¯ä¹¦ç®¡ç†ï¼Œä»¥ä¾¿è®¾ç½®æçŸ­çš„å·¥ä½œè´Ÿè½½è¯ä¹¦ TTL å˜å¾—åˆ‡å®å¯è¡Œï¼Œä»è€Œä½¿ &lt;a href=&#34;https://csrc.nist.gov/glossary/term/certificate_revocation_list&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è¯ä¹¦æ’¤é”€åˆ—è¡¨ï¼ˆCRLï¼‰&lt;/a&gt; ä¿æŒç®€çŸ­ä¸”æ˜“äºç®¡ç†ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;åœ¨è¯ä¹¦é¢å‘å’Œè½®æ¢ï¼ˆIstio ä¸ºæ‚¨è‡ªåŠ¨æ‰§è¡Œï¼‰ä¹‹åï¼ŒPKI ä¸­æœ€å¤§çš„æŒ‘æˆ˜æ˜¯è¯ä¹¦åŠé”€ã€‚è¯ä¹¦åŠé”€æ˜¯é€šè¿‡è¯ä¹¦åŠé”€åˆ—è¡¨å®ç°çš„ï¼Œé€šå¸¸ CRL å…·æœ‰ 24 å°æ—¶çš„å¼ºåˆ¶æ‰§è¡Œ SLAï¼šæ·»åŠ åˆ°åˆ—è¡¨ä¸­çš„è¯ä¹¦åœ¨åŠé”€åæœ€å¤š 24 å°æ—¶å†…å¯èƒ½ä¼šè¢«åŸºç¡€è®¾æ–½è§†ä¸ºæœ‰æ•ˆã€‚æ­¤å¤–ï¼Œç”±äºåŠé”€çš„è¯ä¹¦å¿…é¡»åœ¨å…¶æ•´ä¸ªç”Ÿå‘½å‘¨æœŸ (TTL) å†…ä¿ç•™åœ¨åˆ—è¡¨ä¸­ï¼Œå› æ­¤åŠé”€åˆ—è¡¨ä¼šå˜å¾—åºå¤§è€Œç¬¨æ‹™ã€‚&lt;/p&gt;
&lt;p&gt;Istio æä¾›çš„ä¸€ä¸ªæ›´å¥½çš„è§£å†³æ–¹æ¡ˆæ˜¯è‡ªåŠ¨åŒ–è¯ä¹¦ç®¡ç†ï¼Œä»¥ä¾¿è®¾ç½®æçŸ­çš„å·¥ä½œè´Ÿè½½è¯ä¹¦ TTL æ˜¯åˆ‡å®å¯è¡Œçš„ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒIstio é™„å¸¦ 24 å°æ—¶çš„å·¥ä½œè´Ÿè½½è¯ä¹¦ TTLã€‚è¿™è¶³å¤ŸçŸ­ï¼Œå¤§å¤šæ•°å®‰å…¨ç»„ç»‡å¯ä»¥é€‰æ‹©è®©å—æŸçš„è¯ä¹¦è¿‡æœŸï¼Œè€Œä¸æ˜¯æ˜ç¡®åœ°æ’¤é”€å®ƒä»¬ã€‚è€Œä¸”ï¼Œå½“æ‚¨å‘ CRL æ·»åŠ è¯ä¹¦æ—¶ï¼Œå®ƒåªéœ€è¦åœ¨é‚£é‡Œåœç•™å¾ˆçŸ­çš„æ—¶é—´ï¼ˆå› ä¸ºæˆ‘ä»¬ä¸éœ€è¦åœ¨ CRL ä¸Šä¿ç•™è¿‡æœŸçš„è¯ä¹¦ï¼‰ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œç½‘æ ¼æœ‰åŠ©äºè§£å†³å¤§å¤šæ•°ç»„ç»‡é¢ä¸´çš„æœ€ç—›è‹¦çš„ PKI é—®é¢˜ï¼šå®ƒé¢å‘å’ŒåŠé”€çŸ­æœŸè¯ä¹¦ï¼Œè¿™æ„å‘³ç€åŠé”€åˆ—è¡¨å¯ä»¥åœ¨éœ€è¦æ—¶ä¿æŒç®€çŸ­ä¸”æ˜“äºç®¡ç†ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ³¨æ„&lt;/strong&gt;ï¼šç”±äºç½‘æ ¼ä½¿ç”¨ mTLS è¯ä¹¦ä½œä¸ºèº«ä»½ï¼ŒIstio å°† Envoy é…ç½®ä¸ºè‡ªåŠ¨ä¸¢å¼ƒå·²å»ºç«‹çš„è¿æ¥ï¼Œä»¥å¼ºåˆ¶å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨åœ¨ä»»ä½•ä¸€æ–¹è½®æ¢è¯ä¹¦æ—¶é‡æ–°éªŒè¯å½¼æ­¤ã€‚è¿™æ˜¯ Istio å®ç°ä¸­çš„è®¾è®¡å†³ç­–ï¼Œé€šå¸¸é€šè¿‡ Istio çš„å¼¹æ€§åŠŸèƒ½å¯¹åº”ç”¨ç¨‹åºéšè—ï¼šå¯¹åº”ç”¨ç¨‹åºé€æ˜çš„è‡ªåŠ¨é‡è¯•é‡æ–°å»ºç«‹è¿æ¥ã€‚åœ¨ç½‘æ ¼ä¸­è®¾ç½®è¾ƒçŸ­çš„è¯ä¹¦ TTL ä¼šå¼ºåˆ¶è¿™äº›é‡æ–°è¿æ¥æ›´é¢‘ç¹åœ°å‘ç”Ÿã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™ç§è¡Œä¸ºå¶å°”ä¼šä¸­æ–­ä¸€äº›æœŸæœ›é•¿æœŸ TCP è¿æ¥çš„åº”ç”¨ç¨‹åºã€‚&lt;/p&gt;
&lt;h3 id=&#34;è¿›ä¸€æ­¥çš„è¯ä¹¦æ¨è&#34;&gt;è¿›ä¸€æ­¥çš„è¯ä¹¦æ¨è&lt;/h3&gt;
&lt;p&gt;æ‚¨åº”è¯¥ä¸æ‚¨çš„å®‰å…¨å›¢é˜Ÿåè°ƒï¼Œä¸ºæ‚¨çš„ç½‘æ ¼é¢å‘çš„è¯ä¹¦å»ºç«‹é€‚å½“çš„çº¦æŸã€‚æˆ‘ä»¬æ¨èçš„ä¸€äº›å¸¸è§çº¦æŸå¦‚ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;è¯ä¹¦ç”Ÿå‘½å‘¨æœŸ (TTL)&lt;/strong&gt;ã€‚è¯·æ³¨æ„ï¼Œåªè¦è¯ä¹¦æ˜¯ä»åŒä¸€ä¸ªæ ¹é¢å‘çš„ï¼ŒIstio å°±æ”¯æŒæ§åˆ¶å¹³é¢ç­¾åè¯ä¹¦å’Œå·¥ä½œè´Ÿè½½è¯ä¹¦çš„é›¶åœæœºè½®æ¢ã€‚æˆ‘ä»¬å»ºè®®æ¯ä¸ªçº§åˆ«çš„è¯ä¹¦ç”Ÿå‘½å‘¨æœŸå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç½‘æ ¼ä¸­é—´ç­¾åè¯ä¹¦ 1-3 å¹´&lt;/li&gt;
&lt;li&gt;æ§åˆ¶å¹³é¢ç­¾åè¯ä¹¦ 3 ä¸ªæœˆ&lt;/li&gt;
&lt;li&gt;å·¥ä½œè´Ÿè½½è¯ä¹¦éœ€è¦ 12-24 å°æ—¶&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Istio è‡ªåŠ¨å¤„ç†å·¥ä½œè´Ÿè½½è¯ä¹¦çš„è½®æ¢ã€‚è¿™äº›è¯ä¹¦ä¸Šçš„çŸ­ TTLï¼ˆå°‘äº 24 å°æ—¶ï¼‰æœ‰åŠ©äºé™åˆ¶å¯èƒ½è¢«ç›—çš„å‡­æ®è¿›è¡Œæ—¶é—´é™åˆ¶æ”»å‡»ï¼Œè¿˜å¯ä»¥å‡å°‘å¯¹ CRL çš„éœ€æ±‚ã€‚æ§åˆ¶å¹³é¢è¯ä¹¦åº”æŒ‰ä¸€ä¸ªæœˆçš„åç§»è½®æ¢ä»¥ç¡®ä¿å¹³ç¨³è¿‡æ¸¡ â€”â€” æ¢å¥è¯è¯´ï¼Œåœ¨ 3 ä¸ªæœˆçš„ TTL åˆ°æœŸå‰ 1 ä¸ªæœˆè½®æ¢æ§åˆ¶å¹³é¢ç­¾åè¯ä¹¦ã€‚ç±»ä¼¼åœ°ï¼Œå½“ç½‘æ ¼ä¸­é—´ç­¾åè¯ä¹¦è¿˜å‰©ä¸€åŠåˆ°ä¸‰åˆ†ä¹‹ä¸€çš„ç”Ÿå‘½å‘¨æœŸæ—¶è½®æ¢ï¼ˆä¸€å¹´ TTL æå‰ 3-4 ä¸ªæœˆï¼Œä¸‰å¹´ TTL æå‰ 6-8 ä¸ªæœˆï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;åŸºç¡€ï¼ˆCA å’Œæ·±åº¦ï¼‰&lt;/strong&gt;ã€‚æ§åˆ¶å¹³é¢ç­¾åè¯ä¹¦åº”è¯¥åªèƒ½é¢å‘å¶è¯ä¹¦ï¼šç”¨äºå·¥ä½œè´Ÿè½½è¯†åˆ«çš„éç­¾åè¯ä¹¦ã€‚å› æ­¤ï¼Œåº”é…ç½®æ·±åº¦é™åˆ¶ä»¥é˜²æ­¢æ§åˆ¶å¹³é¢ç­¾åè¯ä¹¦é¢å‘ä»»ä½•å…¶ä»–ç­¾åè¯ä¹¦ã€‚&lt;/p&gt;
&lt;p&gt;ç½‘æ ¼ä¸­é—´ç­¾åè¯ä¹¦éœ€è¦åˆ›å»ºæ§åˆ¶å¹³é¢ç­¾åè¯ä¹¦ï¼Œå› æ­¤å®ƒåº”è¯¥é…ç½®ä¸€ä¸ªæ·±åº¦ï¼Œä»¥ä¾¿èƒ½å¤Ÿ&lt;strong&gt;åœ¨å®ƒä¸‹é¢åˆ›å»ºä¸€ä¸ªçº§åˆ«çš„ç­¾åè¯ä¹¦ï¼Œè€Œä¸æ˜¯æ›´å¤š&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;åç§°çº¦æŸ&lt;/strong&gt;ã€‚Istio é¢å‘çš„å·¥ä½œè´Ÿè½½è¯ä¹¦ä¸ä¼šå¡«å…… X.509 ä¸»ä½“åç§° (SN) å­—æ®µï¼›ç½‘æ ¼èº«ä»½éªŒè¯ä¾èµ–äºä½œä¸ºä¸»ä½“å¤‡ç”¨åç§° (SAN) å­—æ®µæºå¸¦çš„ SPIFFE èº«ä»½ã€‚é˜…è¯» &lt;a href=&#34;https://github.com/spiffe/spiffe/blob/main/standards/X509-SVID.md#4-constraints-and-usage&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SPIFFE è§„èŒƒä»¥è·å–æœ‰å…³éªŒè¯å’Œèº«ä»½éªŒè¯å·¥ä½œçš„ä¿¡æ¯&lt;/a&gt;ï¼Œä»¥åŠ Istio çš„ &lt;a href=&#34;https://istio.io/latest/docs/concepts/security/#istio-identity&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ–‡æ¡£&lt;/a&gt; ä»¥äº†è§£ Istio å¦‚ä½•æ ¹æ® SPIFFE å¯¹èº«ä»½è¿›è¡Œç¼–ç ã€‚åœ¨ä¸ºç½‘æ ¼ä¸­é—´å’Œæ§åˆ¶å¹³é¢ç­¾åè¯ä¹¦ç¼–å†™åç§°çº¦æŸæ—¶ï¼Œè¯·è®°ä½è¿™ä¸€ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å¯†é’¥ç”¨æ³•&lt;/strong&gt;ã€‚ &lt;code&gt;keyCertSign&lt;/code&gt; å¿…é¡»ä¸ºç½‘æ ¼ä¸­é—´ç­¾åè¯ä¹¦å’Œæ§åˆ¶å¹³é¢ç­¾åè¯ä¹¦è®¾ç½®ï¼Œä½†åº”ä¸ºå·¥ä½œè´Ÿè½½è¯ä¹¦ç¦ç”¨ã€‚æ¢å¥è¯è¯´ï¼Œç½‘æ ¼ä¸­é—´å’Œæ§åˆ¶å¹³é¢è¯ä¹¦æ˜¯ç­¾åè¯ä¹¦ï¼Œè€Œå·¥ä½œè´Ÿè½½è¯ä¹¦ä¸æ˜¯ã€‚&lt;/p&gt;
&lt;p&gt;æ ¹æ® SPIFFE çš„å»ºè®®ï¼Œä¸åº”å°†ç­¾åè¯ä¹¦ç”¨äºä¼ è¾“ä¸­çš„åŠ å¯†ï¼Œå¹¶ä¸”åº”é…ç½®å¯†é’¥ä½¿ç”¨ä»¥é˜²æ­¢å®ƒï¼ˆé€šè¿‡åŠ å¯†çº¦æŸï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ‰©å±•å¯†é’¥ç”¨æ³•&lt;/strong&gt;ã€‚è™½ç„¶æ­¤å¤„æ²¡æœ‰å…·ä½“è¦æ±‚ï¼Œä½† SPIFFE X.509 SVID è§„èŒƒè¯´æ˜ &lt;code&gt;id-kp-serverAuth&lt;/code&gt; å’Œ &lt;code&gt;id-kp-clientAuth&lt;/code&gt; åº”é’ˆå¯¹å¶ï¼ˆå·¥ä½œè´Ÿè½½ï¼‰è¯ä¹¦è¿›è¡Œé…ç½®ã€‚&lt;/p&gt;
&lt;p&gt;SPIFFE è§„èŒƒè¿˜æ¨èäº† &lt;a href=&#34;https://github.com/spiffe/spiffe/blob/main/standards/X509-SVID.md#4-constraints-and-usage&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å„ç§è¯ä¹¦çº¦æŸ&lt;/a&gt;ï¼Œå°½ç®¡å…¶ä¸­å¤§éƒ¨åˆ†ä¸Šé¢å·²ç»çº¦æŸäº†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä¸‹ä¸€æ­¥&#34;&gt;ä¸‹ä¸€æ­¥&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬å¸Œæœ›ä»å¤šå¹´å¸®åŠ©æˆ‘ä»¬çš„å®¢æˆ·å……åˆ†åˆ©ç”¨æœåŠ¡ç½‘æ ¼çš„ç»éªŒä¸­æ”¶é›†çš„è¿™äº›æœ€ä½³å®è·µå°†æœ‰åŠ©äºä¿ƒè¿›æ‚¨çš„éƒ¨ç½²ã€‚å¦‚æœæ‚¨è¿˜æ²¡æœ‰ï¼Œè¯·æŸ¥çœ‹ &lt;a href=&#34;https://lib.jimmysong.io/blog/how-service-mesh-layers-microservices-security-with-traditional-security-to-move-fast-safely/&#34;&gt;å¦‚ä½•å°†æœåŠ¡ç½‘æ ¼ä½œä¸ºå®‰å…¨æ¨¡å‹çš„ä¸€éƒ¨åˆ†ï¼Œä»¥åˆ†å±‚å½¢å¼å°†å¾®æœåŠ¡å®‰å…¨ä¸ä¼ ç»Ÿå®‰å…¨ç»“åˆèµ·æ¥&lt;/a&gt; è¿™ç¯‡æ–‡ç« ã€‚&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥ï¼šæœåŠ¡ç½‘æ ¼è¿è¡Œæ—¶é…ç½®å»ºè®®ã€‚åœ¨æˆ‘ä»¬çš„ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†è°ˆè®ºï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å‘½åçº¦å®š&lt;/li&gt;
&lt;li&gt;å…¨å±€è®¾ç½®&lt;/li&gt;
&lt;li&gt;æµé‡ç®¡ç†&lt;/li&gt;
&lt;li&gt;å®‰å…¨&lt;/li&gt;
&lt;li&gt;é¥æµ‹&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ•¬è¯·å…³æ³¨ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>å¦‚ä½•å°†æœåŠ¡ç½‘æ ¼ä½œä¸ºå®‰å…¨æ¨¡å‹çš„ä¸€éƒ¨åˆ†ï¼Œä»¥åˆ†å±‚å½¢å¼å°†å¾®æœåŠ¡å®‰å…¨ä¸ä¼ ç»Ÿå®‰å…¨ç»“åˆèµ·æ¥</title>
      <link>https://lib.jimmysong.io/blog/how-service-mesh-layers-microservices-security-with-traditional-security-to-move-fast-safely/</link>
      <pubDate>Thu, 05 Jan 2023 14:00:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/how-service-mesh-layers-microservices-security-with-traditional-security-to-move-fast-safely/</guid>
      <description>&lt;p&gt;æœ¬æ–‡æ˜¯ Tetrate å³å°†å‡ºç‰ˆçš„ã€ŠIstio in Productionã€‹ä¸€ä¹¦ä¸­æ‘˜å½•çš„æœåŠ¡ç½‘æ ¼æœ€ä½³å®è·µç³»åˆ—çš„ç¬¬ä¸€ç¯‡ï¼Œä½œè€…æ˜¯ Tetrate åˆ›å§‹å·¥ç¨‹å¸ˆ Zack Butcherã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æ¥åˆ°è®¸å¤šå®æ–½ç½‘æ ¼çš„ä¼ä¸šçš„é—®é¢˜ï¼Œå…¶ä¸­ä¹‹ä¸€æ˜¯ â€œæˆ‘è¿˜éœ€è¦å“ªäº›æ§åˆ¶ï¼Œè€Œç½‘æ ¼æä¾›å“ªäº›æ§åˆ¶ï¼Ÿâ€ æ¢å¥è¯è¯´ï¼Œä»–ä»¬æƒ³çŸ¥é“ç½‘æ ¼å¦‚ä½•é€‚åº”ç°æœ‰çš„å®‰å…¨æ¨¡å‹ã€‚æˆ‘ä»¬å‘ç°ï¼Œç½‘æ ¼æœ€é€‚åˆä½œä¸ºä¸€ç»„å®‰å…¨æ§åˆ¶çš„å†…åœˆï¼Œè¿™äº›æ§åˆ¶ä»ç‰©ç†ç½‘ç»œåˆ°åº”ç”¨æœ¬èº«çš„æ¯ä¸€å±‚éƒ½è¢«å®æ–½ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æœåŠ¡ç½‘æ ¼ä½œä¸ºé€šç”¨ç­–ç•¥æ‰§è¡Œç‚¹&#34;&gt;æœåŠ¡ç½‘æ ¼ä½œä¸ºé€šç”¨ç­–ç•¥æ‰§è¡Œç‚¹&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬çœ‹åˆ°ç½‘æ ¼çš„ Sidecar ä½œä¸ºé€šç”¨ç­–ç•¥æ‰§è¡Œç‚¹ï¼ˆ&lt;a href=&#34;https://csrc.nist.gov/publications/detail/sp/800-204b/final&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;NIST SP 800-204Bï¼šä½¿ç”¨æœåŠ¡ç½‘æ ¼çš„åŸºäºå±æ€§çš„è®¿é—®æ§åˆ¶&lt;/a&gt;ï¼‰ã€‚ç”±äºå®ƒæ‹¦æˆªäº†æ‰€æœ‰è¿›å‡ºåº”ç”¨ç¨‹åºçš„æµé‡ï¼ŒSidecar ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªå¼ºå¤§çš„ä½ç½®æ¥å®ç°å„ç§ç­–ç•¥ã€‚æˆ‘ä»¬å¯ä»¥å®ç°ä¼ ç»Ÿçš„å®‰å…¨ç­–ç•¥ï¼Œå¦‚åŸºäºåº”ç”¨ç¨‹åºæ ‡è¯†è€Œéç½‘ç»œä½ç½®çš„æ›´é«˜ä¿è¯çš„åº”ç”¨ç¨‹åºä¹‹é—´çš„æˆæƒã€‚ä½†æˆ‘ä»¬ä¹Ÿå¯ä»¥å®æ–½ä¹‹å‰ä¸åˆ‡å®é™…æˆ–éœ€è¦ä¸åº”ç”¨ç¨‹åºæ·±åº¦å‚ä¸çš„ç­–ç•¥ã€‚ä¾‹å¦‚ï¼Œç½‘æ ¼å…è®¸æ‚¨ç¼–å†™ä»¥ä¸‹ç­–ç•¥ï¼šâ€œåç«¯å¯ä»¥ä»æ•°æ®åº“è¯»å–ï¼ˆä½¿ç”¨åº”ç”¨çº§èº«ä»½è¿›è¡Œèº«ä»½éªŒè¯å’Œæˆæƒï¼‰ï¼Œä½†å‰ææ˜¯è¯·æ±‚å…·æœ‰æœ‰æ•ˆçš„æœ€ç»ˆç”¨æˆ·å‡­è¯å¹¶å…·æœ‰è¯»å–èŒƒå›´ï¼ˆä½¿ç”¨æœ€ç»ˆç”¨æˆ·èº«ä»½è¿›è¡Œèº«ä»½éªŒè¯å’Œæˆæƒï¼‰ã€‚â€&lt;/p&gt;
&lt;p&gt;è™½ç„¶æœåŠ¡ç½‘æ ¼æä¾›äº†ä¸€ä¸ªå¼ºå¤§ï¼ŒåŠ¨æ€å’Œä¸€è‡´çš„å®‰å…¨åŸºçº¿ï¼Œæ‚¨å¯ä»¥åœ¨å…¶ä¸Šæ„å»ºåº”ç”¨ç¨‹åºå®‰å…¨æ¨¡å‹ï¼Œä½†ç½‘æ ¼æœ¬èº«æ°¸è¿œæ— æ³•æä¾›åº”ç”¨ç¨‹åºæ‰€éœ€çš„ 100% è¿è¡Œæ—¶å®‰å…¨ã€‚ä¾‹å¦‚ï¼Œç”±äº Sidecar ä½äºç”¨æˆ·ç©ºé—´ä¸­ï¼Œç½‘æ ¼åœ¨å‡è½»è®¸å¤šç±»å‹çš„ç½‘ç»œæ‹’ç»æœåŠ¡æ”»å‡»æ–¹é¢ä¸å¦‚ä¼ ç»Ÿé˜²ç«å¢™æœºåˆ¶ã€‚å¦ä¸€æ–¹é¢ï¼Œç”±äºåŒæ ·çš„åŸå› ï¼Œç½‘æ ¼åœ¨å‡è½»è®¸å¤šåº”ç”¨çº§æ‹’ç»æœåŠ¡æ”»å‡»æ–¹é¢æ¯”ä¼ ç»ŸåŸºç¡€è®¾æ–½æ›´æœ‰æ•ˆã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä½œä¸ºä¸€ä¸ªå¼ºå¤§çš„ä¸­é—´å±‚&#34;&gt;ä½œä¸ºä¸€ä¸ªå¼ºå¤§çš„ä¸­é—´å±‚&lt;/h2&gt;
&lt;p&gt;ç½‘æ ¼ä½œä¸ºåŸºç¡€æ¶æ„çš„å¼ºå¤§ä¸­é—´å±‚ï¼šä½äºç‰©ç†ç½‘ç»œå’Œæ‰€å®æ–½çš„ L3/L4 æ§åˆ¶ä¹‹ä¸Šï¼Œä½†ä½äºåº”ç”¨ç¨‹åºä¹‹ä¸‹ã€‚è¿™å…è®¸æ›´è„†å¼±å’Œæ›´éš¾ä»¥æ”¹å˜çš„æ¾æ•£é…ç½® â€”â€” å…è®¸æ›´é«˜å±‚çš„æ›´å¤§æ•æ·æ€§ â€”â€” å› ä¸ºæ§åˆ¶ä½“ç³»åœ¨æ›´é«˜å±‚è¢«è€ƒè™‘ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-1å¢åŠ ç»†ç²’åº¦ç­–ç•¥å±‚ä»¥å¢å¼ºä¼ ç»Ÿå®‰å…¨&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 1ï¼šå¢åŠ ç»†ç²’åº¦ç­–ç•¥å±‚ä»¥å¢å¼ºä¼ ç»Ÿå®‰å…¨ã€‚&#34; srcset=&#34;
               /blog/how-service-mesh-layers-microservices-security-with-traditional-security-to-move-fast-safely/f1_huae8a35f32b66687363b4bb0a6229c7fe_99227_3c160c89a73c9c504e8056d88aebba3b.webp 400w,
               /blog/how-service-mesh-layers-microservices-security-with-traditional-security-to-move-fast-safely/f1_huae8a35f32b66687363b4bb0a6229c7fe_99227_dca55d1428bab775c70d9a1253198a48.webp 760w,
               /blog/how-service-mesh-layers-microservices-security-with-traditional-security-to-move-fast-safely/f1_huae8a35f32b66687363b4bb0a6229c7fe_99227_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/how-service-mesh-layers-microservices-security-with-traditional-security-to-move-fast-safely/f1_huae8a35f32b66687363b4bb0a6229c7fe_99227_3c160c89a73c9c504e8056d88aebba3b.webp&#34;
               width=&#34;760&#34;
               height=&#34;629&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 1ï¼šå¢åŠ ç»†ç²’åº¦ç­–ç•¥å±‚ä»¥å¢å¼ºä¼ ç»Ÿå®‰å…¨ã€‚
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;ç½‘æ ¼æä¾›çš„ä¸»è¦å®‰å…¨åŠŸèƒ½æ˜¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä½œä¸º X.509 è¯ä¹¦çš„&lt;strong&gt;è¿è¡Œæ—¶èº«ä»½&lt;/strong&gt;ï¼Œç”¨äºåœ¨ä¼ è¾“æœŸé—´åŠ å¯†ï¼Œä»¥åŠæœåŠ¡ä¹‹é—´é€šä¿¡çš„èº«ä»½éªŒè¯å’Œæˆæƒã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç­–ç•¥æ‰§è¡Œç‚¹&lt;/strong&gt;ï¼Œç”¨äºåœ¨ç½‘æ ¼ä¸­çš„æ‰€æœ‰åº”ç”¨ç¨‹åºä¸Šå®æ–½ä¸€è‡´çš„æœ€ç»ˆç”¨æˆ·èº«ä»½éªŒè¯å’Œæˆæƒã€‚&lt;/li&gt;
&lt;li&gt;æœåŠ¡èº«ä»½å’Œæœ€ç»ˆç”¨æˆ·èº«ä»½çš„&lt;strong&gt;è¿è¡Œæ—¶ç­–ç•¥æ‰§è¡Œ&lt;/strong&gt;ï¼ˆä¾‹å¦‚ï¼Œâ€œA åªèƒ½ä½¿ç”¨å…·æœ‰è¯»å–èŒƒå›´çš„æœ‰æ•ˆæœ€ç»ˆç”¨æˆ·å‡­è¯ä¸ B è¿›è¡Œé€šä¿¡â€ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€Ÿç‡é™åˆ¶å’Œå¼¹æ€§åŠŸèƒ½&lt;/strong&gt;ï¼Œç”¨äºå‡è½»å¸¸è§çš„åº”ç”¨çº§æ‹’ç»æœåŠ¡æ”»å‡»ï¼Œå¹¶ä¿æŠ¤å…å—å¸¸è§çš„çº§è”æ•…éšœæ¨¡å¼çš„å½±å“ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;WAF&lt;/strong&gt; å’Œå…¶ä»–&lt;strong&gt;æ·±å±‚åŒ…æ£€æµ‹&lt;/strong&gt;åŠŸèƒ½ï¼Œç”¨äºå†…éƒ¨æµé‡ï¼Œè€Œä¸ä»…ä»…æ˜¯åœ¨è¾¹ç¼˜ã€‚&lt;/li&gt;
&lt;li&gt;æ¥è‡ªç½‘æ ¼ä¸­æ‰€æœ‰åº”ç”¨ç¨‹åºçš„&lt;strong&gt;ä¸€è‡´çš„æ“ä½œé¥æµ‹&lt;/strong&gt;ï¼Œå¯ç”¨äºç†è§£ã€å®æ–½å’Œå®¡æ ¸å®‰å…¨ç­–ç•¥ã€‚&lt;/li&gt;
&lt;li&gt;å…·æœ‰åŠ¨æ€è¿è¡Œæ—¶æ›´æ–°çš„&lt;strong&gt;ç­–ç•¥å³ä»£ç &lt;/strong&gt;ï¼ˆPolicy-as-codeï¼‰æ¨¡å‹ï¼Œç‹¬ç«‹äºåº”ç”¨ç¨‹åºç”Ÿå‘½å‘¨æœŸã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;æœåŠ¡ç½‘æ ¼ä½œä¸ºåˆ†å±‚é˜²å¾¡çš„ä¸€éƒ¨åˆ†&#34;&gt;æœåŠ¡ç½‘æ ¼ä½œä¸ºåˆ†å±‚é˜²å¾¡çš„ä¸€éƒ¨åˆ†&lt;/h2&gt;
&lt;p&gt;è€ƒè™‘åˆ°ç½‘æ ¼çš„å®‰å…¨åŠŸèƒ½ï¼Œæˆ‘ä»¬è®¤ä¸ºï¼Œç»„ç»‡é‡‡ç”¨å®ƒä½œä¸ºåˆ†å±‚é˜²å¾¡æ–¹æ³•çš„ä¸€éƒ¨åˆ†æ˜¯æœ€åˆç†çš„ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-2æ¯å±‚ç­–ç•¥çš„ç¤ºä¾‹ä»¥åŠä¸€ä¸ªç¤ºä¾‹éƒ¨ç½²æ‹“æ‰‘&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 2ï¼šæ¯å±‚ç­–ç•¥çš„ç¤ºä¾‹ä»¥åŠä¸€ä¸ªç¤ºä¾‹éƒ¨ç½²æ‹“æ‰‘ã€‚&#34; srcset=&#34;
               /blog/how-service-mesh-layers-microservices-security-with-traditional-security-to-move-fast-safely/f2_hu51229ea213419ff3448aa105a91e4832_89514_754f08ee5c071f0703625be9db973cb0.webp 400w,
               /blog/how-service-mesh-layers-microservices-security-with-traditional-security-to-move-fast-safely/f2_hu51229ea213419ff3448aa105a91e4832_89514_0819e3da7a8b88b57b8c620b3d5f9cb7.webp 760w,
               /blog/how-service-mesh-layers-microservices-security-with-traditional-security-to-move-fast-safely/f2_hu51229ea213419ff3448aa105a91e4832_89514_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/how-service-mesh-layers-microservices-security-with-traditional-security-to-move-fast-safely/f2_hu51229ea213419ff3448aa105a91e4832_89514_754f08ee5c071f0703625be9db973cb0.webp&#34;
               width=&#34;760&#34;
               height=&#34;395&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 2ï¼šæ¯å±‚ç­–ç•¥çš„ç¤ºä¾‹ä»¥åŠä¸€ä¸ªç¤ºä¾‹éƒ¨ç½²æ‹“æ‰‘ã€‚
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h2 id=&#34;l3-å±‚çš„æ•æ·æ€§ç²—ç²’åº¦çš„å…¥å£å’Œå‡ºå£ç­–ç•¥ä»¥åŠ-l7-çš„ç»†ç²’åº¦æ§åˆ¶&#34;&gt;L3 å±‚çš„æ•æ·æ€§ï¼šç²—ç²’åº¦çš„å…¥å£å’Œå‡ºå£ç­–ç•¥ä»¥åŠ L7 çš„ç»†ç²’åº¦æ§åˆ¶&lt;/h2&gt;
&lt;p&gt;åœ¨è¾¹ç¼˜çš„ L3 æ§åˆ¶ï¼ˆå¦‚é˜²ç«å¢™ï¼‰åœ¨ç²—ç²’åº¦çš„å…¥å£å’Œå‡ºå£ç­–ç•¥æ–¹é¢ä»ç„¶æœ‰æ•ˆï¼Œä½†é€šå¸¸ä¼šå‡æ…¢åº”ç”¨ç¨‹åºå¼€å‘æ•æ·æ€§ã€‚ç”±äºç½‘æ ¼æä¾›äº†ç»†ç²’åº¦çš„æœåŠ¡é—´æˆæƒï¼Œæ‰€ä»¥å¯ä»¥åœ¨ L3 ä¸Šè®¾ç½®æ›´å¹¿æ³›çš„ç­–ç•¥ï¼Œä¸ºå¹³å°ã€å®‰å…¨å’Œåº”ç”¨ç¨‹åºå›¢é˜Ÿæä¾›æ›´å¤šæ•æ·æ€§ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å®æ–½å¯¹å¤–éƒ¨æœåŠ¡çš„è®¿é—®æ§åˆ¶&lt;/strong&gt;ã€‚ç½‘æ ¼çš„å‡ºå£ä»£ç†ç‰¹åˆ«é€‚ç”¨äºå®æ–½åº”ç”¨ç¨‹åºåˆ°å¤–éƒ¨æœåŠ¡çš„æ§åˆ¶ï¼Œè€Œåªæœ‰å‡ºå£ä»£ç†æœ¬èº«è¢«å¤–å‡ºé˜²ç«å¢™ allow-listedï¼šè¿™ä¸ºå¹³å°æˆ–å®‰å…¨å›¢é˜Ÿåœ¨ç®¡ç†å“ªäº›åº”ç”¨ç¨‹åºå…è®¸ä¸ä¼ä¸šåŸºç¡€æ¶æ„ä¹‹å¤–çš„é€šä¿¡æä¾›äº†å¾ˆå¤šæ•æ·æ€§ï¼ŒåŒæ—¶ä¿æŒç°æœ‰çš„åŸºäºå‘¨ç•Œçš„æ¨¡å‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä½¿ç”¨åŠ å¯†å’ŒåŠ¨æ€è®¿é—®æ§åˆ¶ä»£æ›¿ â€œå¯è¾¾æ€§å³æˆæƒâ€&lt;/strong&gt;ã€‚ç½‘æ ¼å¯ä»¥å¼€å§‹æœ‰æ•ˆåœ°å–ä»£ VPN å’ŒåŸºäº IPSec çš„ç½‘ç»œâ€œå¯è¾¾æ€§å³æˆæƒâ€æ¨¡å¼ï¼Œæä¾›ä¼ è¾“ä¸­çš„åŠ å¯†ï¼Œä»¥åŠæ¯ä¸ªåº”ç”¨è€Œä¸æ˜¯æ¯ä¸ªä¸»æœºçš„è®¤è¯å’Œæˆæƒã€‚&lt;/p&gt;
&lt;h2 id=&#34;l4-å±‚çš„æ”¹è¿›æ›´æ‰å¹³å’Œæ˜“äºç®¡ç†çš„ç½‘ç»œå¾®åˆ†æ®µ&#34;&gt;L4 å±‚çš„æ”¹è¿›ï¼šæ›´æ‰å¹³å’Œæ˜“äºç®¡ç†çš„ç½‘ç»œå¾®åˆ†æ®µ&lt;/h2&gt;
&lt;p&gt;å¾®åˆ†æ®µä¹‹ç±»çš„æ§åˆ¶å¯ä»¥é€šè¿‡ç½‘æ ¼è¿›ä¸€æ­¥æ”¹è¿›ï¼šå°½ç®¡æˆ‘ä»¬å¯èƒ½å…è®¸æ•´ä¸ªï¼ˆå°ï¼‰å­ç½‘åœ¨åŸºäºåˆ†æ®µçš„ç­–ç•¥ä¸­è¿›è¡Œé€šä¿¡ï¼Œä½†æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç½‘æ ¼æŒ‰æ–¹æ³•å’ŒåŠ¨è¯å¯¹å•ç‹¬çš„æœåŠ¡é—´é€šä¿¡è¿›è¡Œæ§åˆ¶ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;è¡¥å……ç°æœ‰çš„å¾®åˆ†æ®µåŒæ—¶å±•å¹³ç½‘ç»œ&lt;/strong&gt;ã€‚é€šè¿‡æä¾›ç»†ç²’åº¦çš„æœåŠ¡é—´æ§åˆ¶ï¼Œç½‘æ ¼å¾€å¾€ä¼šè¡¥å……ç°æœ‰çš„å¾®åˆ†æ®µç­–ç•¥ï¼ŒåŒæ—¶ä½¿å¾—ç»„ç»‡æ›´å®¹æ˜“ç®¡ç†çš„è¾ƒå¹³çš„ç½‘ç»œå¾—ä»¥é‡‡ç”¨ï¼ˆä¾‹å¦‚ï¼Œåœ¨äº‘ç¯å¢ƒä¸­ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä½¿ç”¨å·¥ä½œè´Ÿè½½èº«ä»½å¯ç”¨ä¼ è¾“æœŸé—´çš„åŠ å¯†ï¼ˆmTLSï¼‰å’ŒæœåŠ¡çº§åˆ«è®¿é—®æ§åˆ¶&lt;/strong&gt;ã€‚ä¼ è¾“å±‚å‡ ä¹æ€»æ˜¯å¤„ç†åŠ å¯†ä¼ è¾“ï¼Œç½‘æ ¼é€šè¿‡æ ¹æ® SPIFFE è§„èŒƒå‘å¸ƒå’Œè½®æ¢çŸ­æœŸï¼ˆ&amp;lt;24 å°æ—¶ï¼‰å·¥ä½œè´Ÿè½½èº«ä»½è¯ä¹¦æ¥ä¸ºåº”ç”¨ç¨‹åºå®ç°æ­¤åŠŸèƒ½ï¼Œä»è€Œå…è®¸ä¼ è¾“æœŸé—´çš„åŠ å¯†ä»¥åŠæœåŠ¡çº§åˆ«çš„èº«ä»½éªŒè¯å’Œæˆæƒã€‚&lt;/p&gt;
&lt;h2 id=&#34;l7-å±‚çš„å¢å¼ºæ— å¤„ä¸åœ¨çš„è¾¹ç¼˜å’Œè®¿é—®æ§åˆ¶&#34;&gt;L7 å±‚çš„å¢å¼ºï¼šæ— å¤„ä¸åœ¨çš„è¾¹ç¼˜å’Œè®¿é—®æ§åˆ¶&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;ä¸ºæ‰€æœ‰æµé‡æä¾›è¾¹ç¼˜æ§åˆ¶&lt;/strong&gt;ã€‚L7 æ§åˆ¶ï¼Œå¦‚ Web åº”ç”¨ç¨‹åºé˜²ç«å¢™ï¼ˆWAFï¼‰ä»¥åŠ â€œAPI ç½‘å…³åŠŸèƒ½â€ï¼ˆå¦‚æµé‡é™åˆ¶ï¼‰å‡ ä¹æ€»æ˜¯åœ¨è¾¹ç¼˜å®æ–½ã€‚ç½‘æ ¼å¯ä»¥é€šè¿‡ä¸ºç½‘æ ¼ä¸­æ‰€æœ‰æµé‡ï¼ˆåŒ…æ‹¬å†…éƒ¨çš„ â€œä¸œè¥¿â€ é€šä¿¡ï¼‰å¯ç”¨ç›¸åŒçš„åŠŸèƒ½æ¥å¢å¼ºè¿™äº›ç°æœ‰éƒ¨ç½²ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç®€åŒ–åº”ç”¨ç¨‹åºçš„è®¿é—®æ§åˆ¶&lt;/strong&gt;ã€‚é™¤äº†ä½¿è¾¹ç¼˜æ§åˆ¶æ— å¤„ä¸åœ¨ä¹‹å¤–ï¼Œç½‘æ ¼è¿˜å¯ä»¥åœ¨åº”ç”¨ç¨‹åºçœ‹åˆ°è¯·æ±‚ä¹‹å‰æ‰§è¡Œç«¯ç”¨æˆ·èº«ä»½éªŒè¯å’Œç²—ç²’åº¦æˆæƒï¼Œä»è€Œå¤§å¤§ç®€åŒ–åº”ç”¨ç¨‹åºæœ¬èº«å¿…é¡»æ‰§è¡Œçš„è®¿é—®æ§åˆ¶ã€‚åœ¨æœªæ¥ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°è¶Šæ¥è¶Šå¤šçš„è®¿é—®æ§åˆ¶åŠŸèƒ½ä»åº”ç”¨ç¨‹åºè¿ç§»åˆ°ç½‘æ ¼ä¸­ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ€»ç»“å’Œå±•æœ›&#34;&gt;æ€»ç»“å’Œå±•æœ›&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬è®¤ä¸ºï¼ŒæœåŠ¡ç½‘æ ¼æœ€é€‚åˆä½œä¸ºç°æœ‰å®‰å…¨æ¨¡å‹çš„ä¸€éƒ¨åˆ†ï¼Œé€šè¿‡åœ¨ä¼ ç»Ÿå®‰å…¨æ§åˆ¶ä¹‹ä¸Šæ·»åŠ æ›´ç»†ç²’åº¦çš„å®‰å…¨ç­–ç•¥æ¥å®ç°ã€‚ä½œä¸ºä¸€ä¸ªé€šç”¨ç­–ç•¥æ‰§è¡Œç‚¹ï¼Œç½‘æ ¼åœ¨æ›´æ”¹æœ€å›°éš¾çš„è¾ƒä½å±‚æä¾›äº†æ›´æ¾æ•£çš„ç­–ç•¥ï¼Œå°†æ•æ·æ€§æ¨å‘å †æ ˆçš„é¡¶éƒ¨ï¼Œå…¶ä¸­æ›´å¤šçš„ä¸Šä¸‹æ–‡å…è®¸åœ¨æ›´é«˜å±‚å®ç°æ›´ç‰¹å®šçš„æ§åˆ¶ã€‚è¿™ç§å¼ºå¤§çš„å®‰å…¨å±‚å¯¹äºå¤§å¤šæ•°ç»„ç»‡æ¥è¯´éƒ½æ˜¯é‡‡ç”¨åˆ†å±‚é˜²å¾¡æ·±åº¦æ–¹æ³•çš„æœ€ä½³é€‰æ‹©ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ¥ä¸‹æ¥æœåŠ¡ç½‘æ ¼éƒ¨ç½²æœ€ä½³å®è·µ&#34;&gt;æ¥ä¸‹æ¥ï¼šæœåŠ¡ç½‘æ ¼éƒ¨ç½²æœ€ä½³å®è·µ&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬æœåŠ¡ç½‘æ ¼æœ€ä½³å®è·µç³»åˆ—åšå®¢æ–‡ç« çš„ä¸‹ä¸€ç¯‡å°†è®¨è®ºéƒ¨ç½²æ‹“æ‰‘ã€‚åœ¨å¤šä¸ªé›†ç¾¤çš„çœŸå®åŸºç¡€æ¶æ„ä¸­éƒ¨ç½²æœåŠ¡ç½‘æ ¼æ—¶å­˜åœ¨ä¸€äº›ç§»åŠ¨éƒ¨åˆ†ã€‚åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ›´è¯¦ç»†åœ°ç ”ç©¶ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ§åˆ¶å¹³é¢åº”å¦‚ä½•éƒ¨ç½²åœ¨åº”ç”¨ç¨‹åºé™„è¿‘ã€‚&lt;/li&gt;
&lt;li&gt;åº”è¯¥å¦‚ä½•éƒ¨ç½²å…¥å£ï¼Œä»¥ä¿ƒè¿›å®‰å…¨å’Œæ•æ·æ€§ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚ä½•ä½¿ç”¨Envoyä¿ƒè¿›è·¨é›†ç¾¤çš„è´Ÿè½½å¹³è¡¡ã€‚&lt;/li&gt;
&lt;li&gt;è¯ä¹¦åœ¨ç½‘æ ¼ä¸­åº”è¯¥æ˜¯ä»€ä¹ˆæ ·å­çš„ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;p&gt;å¦‚æœæ‚¨ä¸ç†Ÿæ‚‰æœåŠ¡ç½‘æ ¼å’Œ Kubernetes å®‰å…¨æ€§ï¼Œæˆ‘ä»¬åœ¨ &lt;a href=&#34;https://tetr8.io/academy&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tetrate Academy&lt;/a&gt; æä¾›äº†ä¸€ç³»åˆ—å…è´¹åœ¨çº¿è¯¾ç¨‹ï¼Œå¯ä»¥è®©æ‚¨å¿«é€Ÿäº†è§£ Istio å’Œ Envoyã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæ‚¨æ­£åœ¨å¯»æ‰¾ä¸€ç§å¿«é€Ÿå°† Istio æŠ•å…¥ç”Ÿäº§çš„æ–¹æ³•ï¼Œè¯·æŸ¥çœ‹ &lt;a href=&#34;https://tetr8.io/tid&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tetrate Istio Distribution (TID)&lt;/a&gt;ã€‚TID æ˜¯ Tetrate çš„å¼ºåŒ–ã€å®Œå…¨ä¸Šæ¸¸çš„ Istio å‘è¡Œç‰ˆï¼Œå…·æœ‰ç»è¿‡ FIPS éªŒè¯çš„æ„å»ºå’Œæ”¯æŒã€‚è¿™æ˜¯å¼€å§‹ä½¿ç”¨ Istio çš„å¥½æ–¹æ³•ï¼Œå› ä¸ºæ‚¨çŸ¥é“æ‚¨æœ‰ä¸€ä¸ªå€¼å¾—ä¿¡èµ–çš„å‘è¡Œç‰ˆï¼Œæœ‰ä¸€ä¸ªæ”¯æŒæ‚¨çš„ä¸“å®¶å›¢é˜Ÿï¼Œå¹¶ä¸”å¦‚æœéœ€è¦ï¼Œè¿˜å¯ä»¥é€‰æ‹©å¿«é€Ÿè·å¾— FIPS åˆè§„æ€§ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€æ—¦å¯åŠ¨å¹¶è¿è¡Œ Istioï¼Œæ‚¨å¯èƒ½éœ€è¦æ›´ç®€å•çš„æ–¹æ³•æ¥ç®¡ç†å’Œä¿æŠ¤æ‚¨çš„æœåŠ¡ï¼Œè€Œä¸ä»…ä»…æ˜¯ Istio ä¸­å¯ç”¨çš„æ–¹æ³•ï¼Œè¿™å°±æ˜¯ Tetrate Service Bridge çš„ç”¨æ­¦ä¹‹åœ°ã€‚æ‚¨å¯ä»¥&lt;a href=&#34;https://tetr8.io/tsb&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;åœ¨è¿™é‡Œ&lt;/a&gt;è¯¦ç»†äº†è§£ Tetrate Service Bridge å¦‚ä½•ä½¿æœåŠ¡ç½‘æ ¼æ›´å®‰å…¨ã€æ›´æ˜“äºç®¡ç†å’Œå¼¹æ€§ï¼Œæˆ–&lt;a href=&#34;https://tetr8.io/contact&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è”ç³»æˆ‘ä»¬è¿›è¡Œå¿«é€Ÿæ¼”ç¤º&lt;/a&gt;ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>åœ¨ç”Ÿäº§ä¸­å¤§è§„æ¨¡è‡ªåŠ¨åŒ– Istio CA è½®æ¢</title>
      <link>https://lib.jimmysong.io/blog/automate-istio-ca-rotation-in-production-at-scale/</link>
      <pubDate>Tue, 20 Dec 2022 14:00:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/automate-istio-ca-rotation-in-production-at-scale/</guid>
      <description>&lt;p&gt;Istio çš„æ ¸å¿ƒåŠŸèƒ½ä¹‹ä¸€æ˜¯é€šè¿‡ç®¡ç†ç½‘æ ¼ä¸­æœåŠ¡çš„èº«ä»½æ¥ä¿ƒè¿›é›¶ä¿¡ä»»ç½‘ç»œæ¶æ„ã€‚ä¸ºäº†åœ¨ç½‘æ ¼ä¸­æ£€ç´¢ç”¨äº mTLS é€šä¿¡çš„æœ‰æ•ˆè¯ä¹¦ï¼Œå„ä¸ªå·¥ä½œè´Ÿè½½å‘ &lt;em&gt;istiod&lt;/em&gt; å‘å‡ºè¯ä¹¦ç­¾åè¯·æ±‚ (CSR)ã€‚Istiod åè¿‡æ¥éªŒè¯è¯·æ±‚å¹¶ä½¿ç”¨è¯ä¹¦é¢å‘æœºæ„ï¼ˆCAï¼‰&lt;a href=&#34;https://istio.io/latest/docs/concepts/security/#pki&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç­¾ç½² CSR ä»¥ç”Ÿæˆè¯ä¹¦&lt;/a&gt;ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒIstio ä¸ºæ­¤ç›®çš„ä½¿ç”¨è‡ªå·±çš„è‡ªç­¾å CAï¼Œä½†æœ€ä½³å®è·µæ˜¯é€šè¿‡ä¸ºæ¯ä¸ª Istio éƒ¨ç½²åˆ›å»ºä¸€ä¸ªä¸­é—´ CAï¼Œ&lt;a href=&#34;https://lib.jimmysong.io/blog/istio-trust/&#34;&gt;å°† Istio é›†æˆåˆ°æ‚¨ç°æœ‰çš„ PKI ä¸­&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæ‚¨æ­£åœ¨ç®¡ç†å¤šä¸ªé›†ç¾¤ï¼Œè¿™æ„å‘³ç€é¢å‘å¤šä¸ªä¸­é—´ CAï¼Œæ¯ä¸ªä¸­é—´ CA éƒ½åº”è®¾ç½®ä¸ºåœ¨å‡ ä¸ªæœˆæˆ–æ›´çŸ­çš„æ—¶é—´å†…åˆ°æœŸã€‚ç®¡ç†è¿™äº› CA çš„ç”Ÿå‘½å‘¨æœŸè‡³å…³é‡è¦ï¼Œå› ä¸ºå®ƒä»¬å¿…é¡»åœ¨è¿‡æœŸæˆ–åäº‹å‘ç”Ÿä¹‹å‰è¿›è¡Œè½®æ¢ã€‚æœ¬æ–‡å°†å‘æ‚¨å±•ç¤ºå¦‚ä½•ç®€åŒ–æ­¤ CA ç®¡ç†ä»¥&lt;strong&gt;é™ä½é£é™©&lt;/strong&gt;å¹¶&lt;strong&gt;æé«˜ç³»ç»Ÿçš„æ•´ä½“ç¨³å®šæ€§&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è½®æ¢ CA æ—¶çš„ä¸€ä¸ªå…³é”®æ­¥éª¤æ˜¯ç¡®ä¿å®é™…ä½¿ç”¨æ–°çš„ CAã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒIstio ä»…åœ¨å¯åŠ¨æ—¶åŠ è½½å…¶ CAã€‚ä½†æ˜¯ï¼ŒIstio å¯ä»¥é…ç½®ä¸ºç›‘è§†æ›´æ”¹å¹¶åœ¨æ›´æ–°æ—¶è‡ªåŠ¨é‡æ–°åŠ è½½å…¶ CAã€‚æœ¬æ•™ç¨‹å–è‡ªæˆ‘ä»¬ä¸ç®¡ç†å¤§é‡ Istio éƒ¨ç½²çš„ä¼ä¸šå®¢æˆ·åˆä½œå¼€å‘çš„ç”Ÿäº§æ‰‹å†Œï¼Œå°†å±•ç¤ºå¦‚ä½•é…ç½® Istio ä»¥è‡ªåŠ¨é‡æ–°åŠ è½½å…¶ CAã€‚æˆ‘ä»¬è¿˜å°†ä»‹ç»å¦‚ä½•é…ç½® &lt;a href=&#34;https://cert-manager.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;cert-manager&lt;/a&gt; ä»¥åœ¨ Istio çš„ä¸­é—´ CA åˆ°æœŸå‰å®šæœŸè‡ªåŠ¨è½®æ¢ï¼Œä»¥&lt;strong&gt;æé«˜åœ¨å¤šä¸ªé›†ç¾¤ä¸Šç®¡ç† CA çš„æ“ä½œæ•ˆç‡&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å…ˆå†³æ¡ä»¶&#34;&gt;å…ˆå†³æ¡ä»¶&lt;/h2&gt;
&lt;p&gt;å¯¹äºæœ¬æ•™ç¨‹ï¼Œæ‚¨è‡³å°‘éœ€è¦ä»¥ä¸‹å†…å®¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„ Kubernetes é›†ç¾¤ã€‚åƒ &lt;a href=&#34;https://minikube.sigs.k8s.io/docs/start/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;minikube&lt;/a&gt; æˆ–ç±»ä¼¼çš„ç®€åŒ–çš„ Kubernetes å®‰è£…é€‚ç”¨äºæ¼”ç¤ºç›®çš„ï¼›&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://cert-manager.io/docs/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Istioctl&lt;/a&gt; v1.14.2 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼›&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://cert-manager.io/docs/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;cert-manager&lt;/a&gt; v1.7.2 æˆ–æ›´é«˜ç‰ˆæœ¬ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;ä»»åŠ¡-aå®‰è£…å’Œé…ç½®-cert-manager-ä»¥è‡ªåŠ¨è½®æ¢-istio-çš„-ca&#34;&gt;ä»»åŠ¡ Aï¼šå®‰è£…å’Œé…ç½® cert-manager ä»¥è‡ªåŠ¨è½®æ¢ Istio çš„ CA&lt;/h2&gt;
&lt;h3 id=&#34;æ­¥éª¤-a1å®‰è£…è¯ä¹¦ç®¡ç†å™¨&#34;&gt;æ­¥éª¤ A1ï¼šå®‰è£…è¯ä¹¦ç®¡ç†å™¨&lt;/h3&gt;
&lt;p&gt;ä»¥ä¸‹å‘½ä»¤å°†åœ¨æ‚¨çš„é›†ç¾¤ä¸­å®‰è£… cert-managerã€‚è¦å®‰è£…æ›´æ–°ç‰ˆæœ¬çš„è¯ä¹¦ç®¡ç†å™¨ï¼Œè¯·æ›´æ”¹ GitHub URLã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl apply -f https://github.com/cert-manager/cert-manager/releases/download/v1.10.1/cert-manager.yaml
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;æ­¥éª¤-a2é…ç½®-ca&#34;&gt;æ­¥éª¤ A2ï¼šé…ç½® CA&lt;/h3&gt;
&lt;p&gt;å‡ºäºæ¼”ç¤ºç›®çš„ï¼Œæˆ‘ä»¬å°†è®¾ç½®ä¸€ä¸ªè‡ªç­¾å CAï¼Œä½†&lt;strong&gt;ä¸è¦åœ¨ç”Ÿäº§ä¸­ä½¿ç”¨è‡ªç­¾å CA&lt;/strong&gt;ã€‚å‡ºäºç”Ÿäº§ç›®çš„ï¼Œæ‚¨åº”è¯¥ &lt;a href=&#34;https://tetrate.io/blog/istio-trust/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å°† cert-manager é…ç½®ä¸ºä½¿ç”¨ç°æœ‰çš„ PKI&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cat &lt;span class=&#34;s&#34;&gt;&amp;lt;&amp;lt; EOF | kubectl apply -f -
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;---
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;apiVersion: cert-manager.io/v1
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;kind: Issuer
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;metadata:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  name: selfsigned
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  namespace: cert-manager
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;spec:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  selfSigned: {}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;---
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;apiVersion: cert-manager.io/v1
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;kind: Certificate
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;metadata:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  name: selfsigned-ca
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  namespace: cert-manager
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;spec:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  isCA: true
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  duration: 21600h # 900d
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  secretName: selfsigned-ca
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  commonName: certmanager-ca
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  subject:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    organizations:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;      - cert-manager
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  issuerRef:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    name: selfsigned
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    kind: Issuer
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    group: cert-manager.io
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;---
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;apiVersion: cert-manager.io/v1
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;kind: ClusterIssuer
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;metadata:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  name: selfsigned-ca
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;spec:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  ca:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    secretName: selfsigned-ca
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;EOF&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;æ­¥éª¤-a3ä¸º-istio-é…ç½®ä¸­é—´-ca&#34;&gt;æ­¥éª¤ A3ï¼šä¸º Istio é…ç½®ä¸­é—´ CA&lt;/h3&gt;
&lt;p&gt;è®¾ç½®ä¸­é—´ CA Istio å°†ç”¨äºç­¾ç½²å·¥ä½œè´Ÿè½½è¯ä¹¦ï¼Œè®¾ç½®ä¸ºæ¯ 60 å¤©ï¼ˆ1440 å°æ—¶ï¼‰è¯ä¹¦è½®æ¢ä¸€æ¬¡ï¼Œå¹¶åœ¨ 15 å¤©ï¼ˆ360 å°æ—¶ï¼‰åˆ°æœŸå‰æ›´æ–°ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl create namespace istio-system
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cat &lt;span class=&#34;s&#34;&gt;&amp;lt;&amp;lt; EOF | kubectl apply -f -
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;---
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;apiVersion: cert-manager.io/v1
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;kind: Certificate
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;metadata:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  name: cacerts
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  namespace: istio-system
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;spec:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  secretName: cacerts
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  duration: 1440h
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  renewBefore: 360h
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  commonName: istiod.istio-system.svc
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  isCA: true
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  usages:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    - digital signature
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    - key encipherment
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    - cert sign
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  dnsNames:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    - istiod.istio-system.svc
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  issuerRef:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    name: selfsigned-ca
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    kind: ClusterIssuer
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    group: cert-manager.io
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;EOF&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;strong&gt;æ³¨æ„&lt;/strong&gt;ï¼šCert-manager å°†è¯ä¹¦å’Œå¯†é’¥å…¬å¼€ä¸º &lt;a href=&#34;https://kubernetes.io/docs/concepts/configuration/secret/#secret-types&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;code&gt;kubernetes.io/tls&lt;/code&gt; Secret&lt;/a&gt;ã€‚Istio å¯ä»¥ä½¿ç”¨ä» &lt;a href=&#34;https://istio.io/latest/news/releases/1.14.x/announcing-1.14.2/#changes&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;1.14.2 ç‰ˆæœ¬&lt;/a&gt;å¼€å§‹çš„ &lt;code&gt;kubernetes.io/tls&lt;/code&gt; ç±»å‹çš„ Secretã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä»»åŠ¡-bå®‰è£…å’Œé…ç½®-istio-ä»¥è‡ªåŠ¨æ›´æ–°å…¶-ca&#34;&gt;ä»»åŠ¡ Bï¼šå®‰è£…å’Œé…ç½® Istio ä»¥è‡ªåŠ¨æ›´æ–°å…¶ CA&lt;/h2&gt;
&lt;p&gt;ä½¿ç”¨ &lt;code&gt;istioctl&lt;/code&gt; å®‰è£… Istioã€‚ä»¥ä¸‹ IstioOperator é…ç½®è®¾ç½®ç¯å¢ƒå˜é‡&lt;code&gt;AUTO_RELOAD_PLUGIN_CERTS=true&lt;/code&gt; ä»¥ä½¿ Istio åœ¨æ›´æ–°æ—¶è‡ªåŠ¨é‡æ–°åŠ è½½å…¶ CAï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;istioctl operator init
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cat &lt;span class=&#34;s&#34;&gt;&amp;lt;&amp;lt; EOF | istioctl apply --skip-confirmation -f -
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;apiVersion: install.istio.io/v1alpha1
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;kind: IstioOperator
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;metadata:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  name: demo-istio-install
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  namespace: istio-system
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;spec:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  profile: demo
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  components:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    pilot:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;      k8s:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;        env:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;        - name: AUTO_RELOAD_PLUGIN_CERTS
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;          value: &amp;#34;true&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;EOF&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;ä»»åŠ¡-cé…ç½®å’ŒéªŒè¯-istio-çš„ä¸­é—´-ca-è½®æ¢&#34;&gt;ä»»åŠ¡ Cï¼šé…ç½®å’ŒéªŒè¯ Istio çš„ä¸­é—´ CA è½®æ¢&lt;/h2&gt;
&lt;h3 id=&#34;æ­¥éª¤-c1é…ç½®è½®æ¢ä¸­é—´-ca&#34;&gt;æ­¥éª¤ C1ï¼šé…ç½®è½®æ¢ä¸­é—´ CA&lt;/h3&gt;
&lt;p&gt;å‡è®¾éœ€æ±‚å‘ç”Ÿäº†å˜åŒ–ï¼Œæˆ‘ä»¬éœ€è¦å°† CA è½®æ¢å‘¨æœŸä» 60 å¤©ï¼ˆ1440 å°æ—¶ï¼‰ç¼©çŸ­åˆ° 30 å¤©ï¼ˆ720 å°æ—¶ï¼‰ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cat &lt;span class=&#34;s&#34;&gt;&amp;lt;&amp;lt; EOF | kubectl apply -f -
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;---
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;apiVersion: cert-manager.io/v1
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;kind: Certificate
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;metadata:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  name: cacerts
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  namespace: istio-system
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;spec:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  secretName: cacerts
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  duration: 720h 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  renewBefore: 360h
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  commonName: istiod.istio-system.svc
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  isCA: true
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  usages:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    - digital signature
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    - key encipherment
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    - cert sign
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  dnsNames:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    - istiod.istio-system.svc
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  issuerRef:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    name: selfsigned-ca
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    kind: ClusterIssuer
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    group: cert-manager.io
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;EOF&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;æ­¥éª¤-c2éªŒè¯æ–°çš„ä¸­é—´-ca-æ˜¯å¦å·²é‡æ–°åŠ è½½&#34;&gt;æ­¥éª¤ C2ï¼šéªŒè¯æ–°çš„ä¸­é—´ CA æ˜¯å¦å·²é‡æ–°åŠ è½½&lt;/h3&gt;
&lt;p&gt;æŸ¥çœ‹æ—¥å¿—åº”è¯¥ä¼šæ˜¾ç¤º CA æ›´æ”¹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl logs -l &lt;span class=&#34;nv&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;istiod -n istio-system -f
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ‚¨åº”è¯¥åœ¨æ—¥å¿—è¾“å‡ºä¸­çœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„å†…å®¹ï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;2022-08-11T20:18:41.493247Z	info	Update Istiod cacerts
2022-08-11T20:18:41.493483Z	info	Using kubernetes.io/tls secret type for signing ca files
2022-08-11T20:18:41.716843Z	info	Istiod has detected the newly added intermediate CA and updated its key and certs accordingly
2022-08-11T20:18:41.717170Z	info	x509 cert - Issuer: &amp;#34;CN=istiod.istio-system.svc&amp;#34;, Subject: &amp;#34;&amp;#34;, SN: 1c43c1686425ee2e63f2db90bd3cf17f, NotBefore: &amp;#34;2022-08-11T20:16:41Z&amp;#34;, NotAfter: &amp;#34;2032-08-08T20:18:41Z&amp;#34;
2022-08-11T20:18:41.717220Z	info	x509 cert - Issuer: &amp;#34;CN=certmanager-ca,O=cert-manager&amp;#34;, Subject: &amp;#34;CN=istiod.istio-system.svc&amp;#34;, SN: c172b51eeb4a2891fe66f30babb42bb0, NotBefore: &amp;#34;2022-08-11T20:17:25Z&amp;#34;, NotAfter: &amp;#34;2022-08-13T20:17:25Z&amp;#34;
2022-08-11T20:18:41.717254Z	info	x509 cert - Issuer: &amp;#34;CN=certmanager-ca,O=cert-manager&amp;#34;, Subject: &amp;#34;CN=certmanager-ca,O=cert-manager&amp;#34;, SN: ea1760f2dcf9806a8c997c4bc4b2fb30, NotBefore: &amp;#34;2022-08-11T20:13:33Z&amp;#34;, NotAfter: &amp;#34;2025-01-27T20:13:33Z&amp;#34;
2022-08-11T20:18:41.717256Z	info	Istiod certificates are reloaded
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;æ­£å¦‚æˆ‘ä»¬æ‰€è§ï¼Œä½¿ç”¨ cert-manager æ¥è‡ªåŠ¨åŒ– Istio CA è½®æ¢å¯ä»¥è½»æ¾é«˜æ•ˆåœ°å¤„ç†å…³é”®æ“ä½œåŠŸèƒ½ã€‚å°† Istio é…ç½®ä¸ºè‡ªåŠ¨é‡æ–°åŠ è½½å…¶ CA æ— éœ€æ‰‹åŠ¨é‡å¯ Istioï¼Œä»è€Œæ¶ˆé™¤äº†æ½œåœ¨çš„äººä¸ºé”™è¯¯æ¥æºã€‚&lt;/p&gt;
&lt;p&gt;æœåŠ¡ç½‘æ ¼æ˜¯ä¸€ç§å¼ºå¤§çš„å·¥å…·ï¼Œå¯ç”¨äºå®æ–½é›¶ä¿¡ä»»å®‰å…¨å®è·µå¹¶å¤§è§„æ¨¡æé«˜ä¸šåŠ¡æ•æ·æ€§å’Œè¿ç»­æ€§ã€‚ä¸ºæœåŠ¡ç½‘æ ¼å»ºç«‹æœ‰æ•ˆçš„è¿è¥å®è·µå¯¹äºåˆ©ç”¨è¿™ç§åŠ›é‡è‡³å…³é‡è¦ã€‚ä½œä¸º Istio å’Œ Envoy çš„åˆ›å§‹äººå’Œæ ¸å¿ƒè´¡çŒ®è€…ï¼Œæˆ‘ä»¬ Tetrate æ¯å¤©éƒ½åœ¨å¸®åŠ©æˆ‘ä»¬çš„å®¢æˆ·åšåˆ°è¿™ä¸€ç‚¹ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>å°† Istio çº³å…¥ä¿¡ä»»é“¾ï¼šä½¿ç”¨ç°æœ‰ PKI ä½œä¸ºä¿¡ä»»æ ¹</title>
      <link>https://lib.jimmysong.io/blog/istio-trust/</link>
      <pubDate>Tue, 20 Dec 2022 11:00:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/istio-trust/</guid>
      <description>&lt;p&gt;å½“æˆ‘ä»¬ä¸æƒ³è¦ä½¿ç”¨ Istio çš„å®¢æˆ·æˆ–ç”¨æˆ·äº¤æµæ—¶ï¼Œè¿™ä¸€ä¸ªé—®é¢˜æ—¶é•¿ä¼šå‡ºç°â€”â€”Istio ä¸­çš„è¯ä¹¦ä¿¡ä»»å¦‚ä½•å·¥ä½œçš„ï¼ŸIstio æœ‰è‡ªå·±çš„è¯ä¹¦é¢å‘æœºæ„ï¼Œè€Œæˆ‘ä»¬ä¹Ÿæœ‰è‡ªå·±çš„è¯ä¹¦é¢å‘æœºæ„ï¼Œå¦‚ä½•ç¡®ä¿å®ƒä»¬ç›¸äº’ä¿¡ä»»ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ç®€è€Œè¨€ä¹‹ï¼Œé€šè¿‡ä¸­é—´ç­¾åè¯ä¹¦å°† Istio çº³å…¥åˆ°æ‚¨ç°æœ‰çš„ä¿¡ä»»é“¾ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæ‚¨ä½¿ç”¨ Istio ä½œä¸ºæ¼”ç¤ºæˆ–å¼€ç®±å³ç”¨ï¼Œå®ƒå°†æ‹¥æœ‰è‡ªå·±çš„è‡ªç­¾åè¯ä¹¦ â€”â€” å®ƒæ˜¯è‡ªå·±çš„æ ¹è¯ä¹¦ã€‚å¯¹äºåœ¨å¤šä¸ªé›†ç¾¤ä¸­è¿è¡Œ Istio çš„ç”¨æˆ·æ¥è¯´ï¼Œè¿™æ˜¯ä¸€ä¸ªå¸¸è§çš„ç—›ç‚¹ï¼šä»–ä»¬æ— æ„ä¸­åˆ›å»ºäº†ä¸¤ä¸ªäº’ä¸ä¸ä¿¡ä»»çš„å­¤å²›ï¼Œå› æ­¤æ²¡æœ‰å®‰å…¨é€šä¿¡ã€‚&lt;/p&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯å¦‚ä½•é€šè¿‡è®© Istio ä¿¡ä»»æ‚¨ç°æœ‰çš„ PKI çš„æ­¥éª¤ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç®€è¿°&#34;&gt;ç®€è¿°&lt;/h2&gt;
&lt;p&gt;è¿™æ˜¯ç®€çŸ­çš„ç‰ˆæœ¬ï¼šæ‚¨åº”è¯¥é€šè¿‡ä¸ºæ¯ä¸ª Istio éƒ¨ç½²åˆ›å»ºä¸€ä¸ªä¸­é—´ç­¾åè¯ä¹¦æ¥è®© Istio ä¿¡ä»»æ‚¨ç°æœ‰çš„ PKIï¼ˆå¹¶ä¸”æ¯ä¸ªé›†ç¾¤åº”è¯¥æœ‰ä¸€ä¸ª Istio éƒ¨ç½²ï¼‰ã€‚ç„¶åä½ ä¼šï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å¯ç”¨è·¨ Istio éƒ¨ç½²çš„é€šä¿¡&lt;/li&gt;
&lt;li&gt;å…è®¸ç»†ç²’åº¦çš„è¯ä¹¦æ’¤é”€ï¼Œè€Œæ— éœ€åŒæ—¶åœ¨æ•´ä¸ªåŸºç¡€æ¶æ„ä¸­å¼ºåˆ¶ä½¿ç”¨æ–°è¯ä¹¦ï¼ˆå¦‚æœè¿™å¬èµ·æ¥åƒæ˜¯ç­‰å¾…å‘ç”Ÿçš„é‡å¤§ä¸­æ–­ï¼Œé‚£ä¹ˆæ‚¨æ˜¯å¯¹çš„ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å¯ç”¨ç­¾åè¯ä¹¦çš„è½»æ¾è½®æ¢ã€‚æ‚¨éœ€è¦åšçš„å°±æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„ä¸­é—´ä»¶å¹¶ä½¿ç”¨æ–°è¯ä¹¦é‡æ–°å¯åŠ¨ Istioã€‚å› ä¸ºå®ƒåœ¨åŒä¸€ä¸ªä¿¡ä»»æ ¹ä¸­ï¼Œæ‰€ä»¥ä¸€åˆ‡éƒ½ç»§ç»­å·¥ä½œã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Istio å¿…é¡»é€‚åº”æ‚¨ç°æœ‰çš„æ¶æ„ï¼Œä»¥åœ¨ç»„ç»‡å†…å®ç°å¢é‡é‡‡ç”¨ â€”â€” ä½¿ç½‘æ ¼é€‚åº”æ‚¨çš„ç»„ç»‡ï¼Œè€Œä¸æ˜¯è®©ç»„ç»‡æ¥é€‚åº”ç½‘æ ¼ã€‚ä»äº†è§£å¯¹ä¸­é—´è¯ä¹¦ç­¾åå¯†é’¥çš„éœ€æ±‚å¼€å§‹ï¼Œå°†ä¸ºæ‚¨çš„æˆåŠŸåšå¥½å‡†å¤‡ï¼Œå¹¶ä½¿ä»»ä½•åŸºç¡€æ¶æ„æˆ–ç¯å¢ƒæ›´æ”¹æ›´åŠ é¡ºåˆ©ã€‚&lt;/p&gt;
&lt;h2 id=&#34;è¯¦è¿°&#34;&gt;è¯¦è¿°&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬å…ˆæ¥äº†è§£ä¸€ä¸‹è¯ä¹¦éªŒè¯çš„è¿‡ç¨‹ã€‚åœ¨åŸºæœ¬è¯ä¹¦ä¸­ï¼Œè¯ä¹¦æ£€æŸ¥ä»ä¿¡ä»»æ ¹å¼€å§‹ï¼Œå‘ä¸‹å»¶ä¼¸åˆ°ç‰¹å®šèº«ä»½ï¼ˆå¶å­ï¼‰ã€‚è¯ä¹¦è·¯å¾„éªŒè¯ç®—æ³•æ˜¯æˆ‘ä»¬ç¡®ä¿è¯ä¹¦å¯ä¿¡çš„æ–¹å¼ã€‚å½“æˆ‘ä»¬ä½¿ç”¨ TLS ç­‰å®‰å…¨åè®®è¿æ¥åˆ°å¦ä¸€å°æœºå™¨æ—¶ï¼ŒæœåŠ¡å™¨ä¼šå‘æˆ‘ä»¬æä¾›éƒ¨åˆ†æˆ–å…¨éƒ¨è¯ä¹¦é“¾ä»¥è¯æ˜å…¶èº«ä»½ã€‚å¦‚æœé“¾ä¸­çš„è¯ä¹¦è¢«ç¡®å®šä¸ºæ— æ•ˆï¼Œåˆ™è¯ä¹¦é“¾å°†è¢«æ‹’ç»ä¸”ä¸ä¼šå»ºç«‹ä¿¡ä»»ã€‚å¦‚æœæˆ‘ä»¬é¡ºåˆ©åˆ°è¾¾é“¾çš„æœ«ç«¯ï¼Œåˆ™è·¯å¾„ï¼ˆä»¥åŠè¯ä¹¦ï¼‰æ˜¯æœ‰æ•ˆçš„ã€‚æˆåŠŸï¼æˆ‘ä»¬å¯ä»¥ä¿¡ä»»æœåŠ¡å™¨ï¼&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å¸¦æœ‰å¶è¯ä¹¦ä¸­é—´è¯ä¹¦å’Œæ ¹è¯ä¹¦çš„è¯ä¹¦é“¾æœåŠ¡å™¨å¯ä»¥é€‰æ‹©å‘é€æ•´ä¸ªé“¾æˆ–è€…åªå‘é€ä¸€éƒ¨åˆ†åªè¦æœ‰è¶³å¤Ÿçš„é“¾ä»æ ¹åˆ°å¶æˆ‘ä»¬å°±å¯ä»¥éªŒè¯è¯ä¹¦&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å¸¦æœ‰å¶è¯ä¹¦ã€ä¸­é—´è¯ä¹¦å’Œæ ¹è¯ä¹¦çš„è¯ä¹¦é“¾ã€‚æœåŠ¡å™¨å¯ä»¥é€‰æ‹©å‘é€æ•´ä¸ªé“¾ï¼Œæˆ–è€…åªå‘é€ä¸€éƒ¨åˆ†ï¼›åªè¦æœ‰è¶³å¤Ÿçš„é“¾ä»æ ¹åˆ°å¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥éªŒè¯è¯ä¹¦ã€‚&#34; srcset=&#34;
               /blog/istio-trust/f1_huec9d872c6d7b9744e61eee3d5c25daf4_47186_0a555bb03c90fdc04900b318972e9218.webp 400w,
               /blog/istio-trust/f1_huec9d872c6d7b9744e61eee3d5c25daf4_47186_02390ee732353ac91d0a51c4146d1d54.webp 760w,
               /blog/istio-trust/f1_huec9d872c6d7b9744e61eee3d5c25daf4_47186_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/istio-trust/f1_huec9d872c6d7b9744e61eee3d5c25daf4_47186_0a555bb03c90fdc04900b318972e9218.webp&#34;
               width=&#34;760&#34;
               height=&#34;428&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å¸¦æœ‰å¶è¯ä¹¦ã€ä¸­é—´è¯ä¹¦å’Œæ ¹è¯ä¹¦çš„è¯ä¹¦é“¾ã€‚æœåŠ¡å™¨å¯ä»¥é€‰æ‹©å‘é€æ•´ä¸ªé“¾ï¼Œæˆ–è€…åªå‘é€ä¸€éƒ¨åˆ†ï¼›åªè¦æœ‰è¶³å¤Ÿçš„é“¾ä»æ ¹åˆ°å¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥éªŒè¯è¯ä¹¦ã€‚
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;å½“ TLS æ¡æ‰‹æ—¶ï¼Œè·¯å¾„éªŒè¯ç®—æ³•ä¸å…³å¿ƒæœ‰å¤šå°‘è¯ä¹¦é“¾é©»ç•™åœ¨æˆ‘ä»¬çš„ä¿¡ä»»åŒ…ä¸­ã€‚åŸºäºæˆ‘ä»¬å¸¦æ¥çš„å’Œä»–ä»¬æä¾›çš„è¯ä¹¦ï¼Œå®ƒåªå…³å¿ƒæˆ‘ä»¬èƒ½å¦æ„å»ºä¸€æ¡ä»æœåŠ¡å™¨çš„å¶èŠ‚ç‚¹åˆ°æˆ‘ä»¬çš„æ†ç»‘åŒ…ä¸­çš„ä¿¡ä»»æ ¹çš„é“¾ã€‚ä¸Šé¢çš„ç¤ºä¾‹æ˜¾ç¤ºéªŒè¯å‘ç”Ÿåœ¨è¯ä¹¦äº¤æ¢ä¸­ï¼Œè¿™è¶³ä»¥è®©å¶å­åœ¨è¯ä¹¦é¢å‘æœºæ„ä¸­æ‰¾åˆ°å®ƒçš„ä½ç½®ã€‚&lt;/p&gt;
&lt;p&gt;å½“æ‚¨åœ¨ç”Ÿäº§ç¯å¢ƒä¸­è¿è¡Œ Istio æ—¶ï¼Œæ‚¨å°†æ‹¥æœ‰å¤šä¸ªå¶èŠ‚ç‚¹å’Œä¸­é—´èŠ‚ç‚¹ï¼Œä½†&lt;strong&gt;åªæœ‰ä¸€ä¸ªæ ¹èŠ‚ç‚¹ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å…·æœ‰æ ¹ä¸‰ä¸ªä¸­é—´ç­¾å-ca-å’Œå››ä¸ªå¶è¯ä¹¦ç”±æ ‘ä¸­çš„å„ç§ä¸­é—´ä½“é¢å‘çš„-pki-è¯ä¹¦æ ‘&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å…·æœ‰æ ¹ã€ä¸‰ä¸ªä¸­é—´ç­¾å CA å’Œå››ä¸ªå¶è¯ä¹¦ï¼ˆç”±æ ‘ä¸­çš„å„ç§ä¸­é—´ä½“é¢å‘ï¼‰çš„ PKI è¯ä¹¦æ ‘ã€‚&#34; srcset=&#34;
               /blog/istio-trust/f2_hub07c1aca55232d4eaaa7450e9ad8d1b6_39066_3bad8109ce0409abfc7ebddce7746631.webp 400w,
               /blog/istio-trust/f2_hub07c1aca55232d4eaaa7450e9ad8d1b6_39066_300ffc05783a2a10663726f35cb8ba73.webp 760w,
               /blog/istio-trust/f2_hub07c1aca55232d4eaaa7450e9ad8d1b6_39066_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/istio-trust/f2_hub07c1aca55232d4eaaa7450e9ad8d1b6_39066_3bad8109ce0409abfc7ebddce7746631.webp&#34;
               width=&#34;760&#34;
               height=&#34;428&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å…·æœ‰æ ¹ã€ä¸‰ä¸ªä¸­é—´ç­¾å CA å’Œå››ä¸ªå¶è¯ä¹¦ï¼ˆç”±æ ‘ä¸­çš„å„ç§ä¸­é—´ä½“é¢å‘ï¼‰çš„ PKI è¯ä¹¦æ ‘ã€‚
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;è¿™å°±æ˜¯ä¸ºä»€ä¹ˆè¦åœ¨ç°æœ‰ PKI ä¸­å»ºç«‹ä¿¡ä»»ï¼Œå› ä¸ºæœ‰ä»¥ä¸‹ä¸‰ä¸ªä¸»è¦å¥½å¤„ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å¯ä»¥åœ¨ Istio éƒ¨ç½²ä¹‹é—´çš„äº¤å‰é€šä¿¡&lt;/li&gt;
&lt;li&gt;ç»†ç²’åº¦è¯ä¹¦æ’¤é”€&lt;/li&gt;
&lt;li&gt;è½»æ¾è½®æ¢è¯ä¹¦&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;è·¨-istio-éƒ¨ç½²çš„é€šä¿¡&#34;&gt;è·¨ Istio éƒ¨ç½²çš„é€šä¿¡&lt;/h3&gt;
&lt;p&gt;å¯¹äº Istioï¼Œæœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥ç¡®ä¿è·¨éƒ¨ç½²çš„é€šä¿¡ â€”â€” ç®€å•çš„æ–¹æ³•å’Œå›°éš¾çš„æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;å›°éš¾çš„æ–¹æ³•æ¶‰åŠ Istio è¿ç»´äººå‘˜é‡‡å–è€—æ—¶ã€å¤æ‚ä¸”æ˜‚è´µçš„æ­¥éª¤æ¥ç¡®ä¿ä¸¤ä¸ªæ ¹åŒæ—¶åœ¨å¦ä¸€ä¸ªçš„è¯ä¹¦é¢å‘æœºæ„ (CA) æ†ç»‘åŒ…ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-æˆ‘ä»¬å¯ä»¥é€šè¿‡ç¡®ä¿æ‰€æœ‰å‚ä¸æ–¹çš„æ ¹éƒ½åœ¨-ca-æ†ç»‘åŒ…ä¸­æ¥ç¡®ä¿è·¨ä¸åŒæ ¹çš„ä¿¡ä»»å¦‚æœå®ƒä»¬ä¸æ˜¯å½¼æ­¤ä¿¡ä»»åŒ…çš„ä¸€éƒ¨åˆ†åˆ™æ¥è‡ªæ¯ä¸ª-citadel-çš„è¯ä¹¦ä¸èƒ½ç”¨äºè·¨é›†ç¾¤é€šä¿¡&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;æˆ‘ä»¬å¯ä»¥é€šè¿‡ç¡®ä¿æ‰€æœ‰å‚ä¸æ–¹çš„æ ¹éƒ½åœ¨ CA æ†ç»‘åŒ…ä¸­æ¥ç¡®ä¿è·¨ä¸åŒæ ¹çš„ä¿¡ä»»ã€‚å¦‚æœå®ƒä»¬ä¸æ˜¯å½¼æ­¤ä¿¡ä»»åŒ…çš„ä¸€éƒ¨åˆ†ï¼Œåˆ™æ¥è‡ªæ¯ä¸ª Citadel çš„è¯ä¹¦ä¸èƒ½ç”¨äºè·¨é›†ç¾¤é€šä¿¡ã€‚&#34; srcset=&#34;
               /blog/istio-trust/f3_hude18225d1ce4b392db5d8b58e87abe4b_41877_20c55ff2089db821acd01473dd1b95f9.webp 400w,
               /blog/istio-trust/f3_hude18225d1ce4b392db5d8b58e87abe4b_41877_a320a604a120946eddc0b8a918a83f77.webp 760w,
               /blog/istio-trust/f3_hude18225d1ce4b392db5d8b58e87abe4b_41877_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/istio-trust/f3_hude18225d1ce4b392db5d8b58e87abe4b_41877_20c55ff2089db821acd01473dd1b95f9.webp&#34;
               width=&#34;760&#34;
               height=&#34;428&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      æˆ‘ä»¬å¯ä»¥é€šè¿‡ç¡®ä¿æ‰€æœ‰å‚ä¸æ–¹çš„æ ¹éƒ½åœ¨ CA æ†ç»‘åŒ…ä¸­æ¥ç¡®ä¿è·¨ä¸åŒæ ¹çš„ä¿¡ä»»ã€‚å¦‚æœå®ƒä»¬ä¸æ˜¯å½¼æ­¤ä¿¡ä»»åŒ…çš„ä¸€éƒ¨åˆ†ï¼Œåˆ™æ¥è‡ªæ¯ä¸ª Citadel çš„è¯ä¹¦ä¸èƒ½ç”¨äºè·¨é›†ç¾¤é€šä¿¡ã€‚
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;ç®€å•çš„æ–¹æ³•æ˜¯ä¸ºæ¯ä¸ªéƒ¨ç½²ä½¿ç”¨å•ç‹¬çš„ä¸­é—´ç­¾åè¯ä¹¦éƒ¨ç½² Istioï¼Œæ‰€æœ‰è¿™äº›è¯ä¹¦éƒ½å…±äº«ç›¸åŒçš„æ ¹ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å½“-citadel-ä½¿ç”¨æ¥è‡ªåŒä¸€æ ¹-pki-çš„ä¸­é—´è¯ä¹¦æ—¶æœ€å®¹æ˜“ä¿ƒè¿›è·¨é›†ç¾¤é€šä¿¡æˆ‘ä»¬çœ‹åˆ°ä¸ä¸Šé¢ç›¸åŒçš„-pki-æ ‘ä½†ä¸­é—´-ca-è¢«æ ‡è®°ä¸ºä¸åŒé›†ç¾¤ä¸­çš„-citadel-å®ä¾‹&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å½“ Citadel ä½¿ç”¨æ¥è‡ªåŒä¸€æ ¹ PKI çš„ä¸­é—´è¯ä¹¦æ—¶ï¼Œæœ€å®¹æ˜“ä¿ƒè¿›è·¨é›†ç¾¤é€šä¿¡ã€‚æˆ‘ä»¬çœ‹åˆ°ä¸ä¸Šé¢ç›¸åŒçš„ PKI æ ‘ï¼Œä½†ä¸­é—´ CA è¢«æ ‡è®°ä¸ºä¸åŒé›†ç¾¤ä¸­çš„ Citadel å®ä¾‹ã€‚&#34; srcset=&#34;
               /blog/istio-trust/f4_huea09a22d92f6268de8b161fb6b4726d3_47023_6de4ed0096c5b2d01e95bcc97b774aa2.webp 400w,
               /blog/istio-trust/f4_huea09a22d92f6268de8b161fb6b4726d3_47023_872c7cc9e7eebce0c7bc2ace9a5cb0af.webp 760w,
               /blog/istio-trust/f4_huea09a22d92f6268de8b161fb6b4726d3_47023_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/istio-trust/f4_huea09a22d92f6268de8b161fb6b4726d3_47023_6de4ed0096c5b2d01e95bcc97b774aa2.webp&#34;
               width=&#34;760&#34;
               height=&#34;428&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å½“ Citadel ä½¿ç”¨æ¥è‡ªåŒä¸€æ ¹ PKI çš„ä¸­é—´è¯ä¹¦æ—¶ï¼Œæœ€å®¹æ˜“ä¿ƒè¿›è·¨é›†ç¾¤é€šä¿¡ã€‚æˆ‘ä»¬çœ‹åˆ°ä¸ä¸Šé¢ç›¸åŒçš„ PKI æ ‘ï¼Œä½†ä¸­é—´ CA è¢«æ ‡è®°ä¸ºä¸åŒé›†ç¾¤ä¸­çš„ Citadel å®ä¾‹ã€‚
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;å½“æ¶‰åŠåˆ°ç»†ç²’åº¦æ’¤é”€å’Œè¯ä¹¦è½®æ¢æ—¶ï¼Œè¿™ä¸€å†³å®šçš„è¿é”ååº”æ˜¯å·¨å¤§çš„ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ç»†ç²’åº¦è¯ä¹¦æ’¤é”€&#34;&gt;ç»†ç²’åº¦è¯ä¹¦æ’¤é”€&lt;/h3&gt;
&lt;p&gt;æ’¤é”€è¯ä¹¦ä¼šå°†è¯ä¹¦æ ‡è®°ä¸ºä¸å†å—ä¿¡ä»»ã€‚å½“è¯ä¹¦è·¯å¾„éªŒè¯ç®—æ³•ä»å¶èŠ‚ç‚¹èµ°åˆ°æ ¹èŠ‚ç‚¹æ—¶ï¼Œä¼šå¯¹æ¯ä¸ªè¯ä¹¦è¿›è¡ŒåŠé”€çŠ¶æ€æ£€æŸ¥ã€‚è¿™ä½¿æ‚¨èƒ½å¤Ÿæ’¤é”€å¯¹å•ä¸ªç»„ä»¶æˆ–æ•´ä¸ªéƒ¨ç½²éƒ¨åˆ†çš„ä¿¡ä»»ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-ä½¿ç”¨ä¸ä¹‹å‰ç›¸åŒçš„-pki-æ ‘æˆ‘ä»¬å±•ç¤ºäº†åœ¨æ ‘çš„ä¸€éƒ¨åˆ†ä¸­æ’¤é”€ä¸­é—´-ca-å¦‚ä½•ä½¿è¯¥ä¸­é—´è¯ä¹¦ä»¥åŠç”±å®ƒåˆ›å»ºçš„å¶è¯ä¹¦æ— æ•ˆ&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;ä½¿ç”¨ä¸ä¹‹å‰ç›¸åŒçš„ PKI æ ‘ï¼Œæˆ‘ä»¬å±•ç¤ºäº†åœ¨æ ‘çš„ä¸€éƒ¨åˆ†ä¸­æ’¤é”€ä¸­é—´ CA å¦‚ä½•ä½¿è¯¥ä¸­é—´è¯ä¹¦ä»¥åŠç”±å®ƒåˆ›å»ºçš„å¶è¯ä¹¦æ— æ•ˆã€‚&#34; srcset=&#34;
               /blog/istio-trust/f5_hu92686c7061f8ad32642b37636ba403bb_46338_6af7ef9444a8817e913abcf911ff07e5.webp 400w,
               /blog/istio-trust/f5_hu92686c7061f8ad32642b37636ba403bb_46338_ba29366385e5cb00e2e032d275fea663.webp 760w,
               /blog/istio-trust/f5_hu92686c7061f8ad32642b37636ba403bb_46338_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/istio-trust/f5_hu92686c7061f8ad32642b37636ba403bb_46338_6af7ef9444a8817e913abcf911ff07e5.webp&#34;
               width=&#34;760&#34;
               height=&#34;428&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      ä½¿ç”¨ä¸ä¹‹å‰ç›¸åŒçš„ PKI æ ‘ï¼Œæˆ‘ä»¬å±•ç¤ºäº†åœ¨æ ‘çš„ä¸€éƒ¨åˆ†ä¸­æ’¤é”€ä¸­é—´ CA å¦‚ä½•ä½¿è¯¥ä¸­é—´è¯ä¹¦ä»¥åŠç”±å®ƒåˆ›å»ºçš„å¶è¯ä¹¦æ— æ•ˆã€‚
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;è¿™å¾ˆé‡è¦ï¼Œå› ä¸ºå¦‚æœç­¾åå¯†é’¥è¢«æ³„éœ²ï¼Œæ¶æ„è¡Œä¸ºè€…å¯èƒ½ä¼šé€šè¿‡å‡ºç¤ºæ‚¨çš„å®¢æˆ·è®¤ä¸ºæ˜¯æœ‰æ•ˆè¯ä¹¦æ¥å†’å……æ‚¨çš„æœåŠ¡å™¨ã€‚è¿™åœ¨ Istio ä¸­æ›´ä¸ºé‡è¦ï¼Œå› ä¸ºæˆ‘ä»¬ä½¿ç”¨è¯ä¹¦æ¥è¯†åˆ«å½¼æ­¤çš„å·¥ä½œè´Ÿè½½ â€”â€” æ”»å‡»è€…å¯ä»¥ä¼ªè£…æˆæ‚¨ç½‘æ ¼ä¸­çš„ä»»ä½•æœåŠ¡ï¼&lt;/p&gt;
&lt;p&gt;é€šå¸¸ï¼Œå¤„ç†æ’¤é”€æ˜¯ç®¡ç†ä»»ä½• PKI ä¸­æœ€å›°éš¾çš„éƒ¨åˆ†ã€‚Istio å¸®åŠ©é™ä½è¿™ç§é£é™©çš„æ–¹æ³•ä¹‹ä¸€æ˜¯é¢å‘éå¸¸çŸ­æš‚çš„è¯ä¹¦ã€‚å…¸å‹çš„åŠé”€åˆ—è¡¨æœ€å¤šå¯èƒ½éœ€è¦ 24 å°æ—¶æ‰èƒ½åœ¨æ•´ä¸ªç»„ç»‡ä¸­ä¼ æ’­ã€‚Istio é¢å‘çš„è¯ä¹¦æœ‰æ•ˆæœŸå°‘äº 12 å°æ—¶ï¼Œå› æ­¤å‡ ä¹ä¸éœ€è¦æ’¤é”€ Istio é¢å‘çš„èº«ä»½è¯ä¹¦ã€‚æ‚¨åªéœ€è¦æ‹…å¿ƒä¸ºæ¯ä¸ª Istio éƒ¨ç½²åˆ›å»ºçš„ç­¾åè¯ä¹¦ã€‚&lt;/p&gt;
&lt;h3 id=&#34;è½»æ¾è½®æ¢è¯ä¹¦&#34;&gt;è½»æ¾è½®æ¢è¯ä¹¦&lt;/h3&gt;
&lt;p&gt;ä¸åŠé”€ä¸€æ ·ï¼Œä¸­é—´è¯ä¹¦çš„è½®æ¢æ›´å®¹æ˜“ã€‚ä¼˜ç‚¹åŒ…æ‹¬ï¼Œå¦‚æœæ‚¨èƒ½å¤ŸæŒ‰é›†ç¾¤è½®æ¢è¯ä¹¦è€Œä¸æ˜¯åœ¨æ ¹èŠ‚ç‚¹è½®æ¢è¯ä¹¦ï¼Œæ‚¨å°†ä½“éªŒåˆ°æ›´å°‘çš„åœæœºæ—¶é—´ï¼ˆä»¥åŠç›¸å…³çš„å¤æ‚æ€§ï¼Œå³åœ¨ä»»ä½•åœ°æ–¹å‘å¸ƒä¸€ä¸ªå¸¦æœ‰æ–°æ ¹çš„æ›´æ–°çš„ CA åŒ…ï¼‰ã€‚è€Œä¸”ï¼Œå°±åƒä»»ä½•å¥½çš„ PKI ä¸€æ ·ï¼Œè¿™å¯ä»¥è®©æ‚¨ä½¿æ ¹ç¦»çº¿å¹¶å®‰å…¨åœ°å­˜å‚¨èµ·æ¥ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;ç”¨ç®€å•çš„æ–¹æ³•æ¥åšï¼å°† Istio å¼•å…¥æ‚¨ç°æœ‰çš„ä¿¡ä»»æ ¹ä¸­ï¼Œä»¥é¿å…ç—›è‹¦å’Œå¿ƒç—›ã€‚ä¸­é—´ç­¾åè¯ä¹¦çš„å­˜åœ¨æ˜¯ä¸ºäº†è®©é‡‡ç”¨ Istio æ›´å®¹æ˜“ã€æ›´å®‰å…¨ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>å¦‚ä½•ä½¿ç”¨ Hashicorp Vault ä½œä¸ºä¸€ç§æ›´å®‰å…¨çš„æ–¹å¼æ¥å­˜å‚¨ Istio è¯ä¹¦</title>
      <link>https://lib.jimmysong.io/blog/how-to-use-hashicorp-vault-as-a-more-secure-way-to-store-istio-certificates/</link>
      <pubDate>Mon, 19 Dec 2022 13:00:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/how-to-use-hashicorp-vault-as-a-more-secure-way-to-store-istio-certificates/</guid>
      <description>&lt;p&gt;åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†æ¢è®¨å¦‚ä½•ä½¿ç”¨ Hashicorp Vault ä½œä¸ºä¸€ç§æ¯”ä½¿ç”¨ Kubernetes &lt;a href=&#34;https://kubernetes.io/docs/concepts/configuration/secret&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Secret&lt;/a&gt; æ›´å®‰å…¨çš„æ–¹å¼æ¥å­˜å‚¨ Istio è¯ä¹¦ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒSecret ä½¿ç”¨ base64 ç¼–ç å­˜å‚¨åœ¨ &lt;em&gt;etcd&lt;/em&gt; ä¸­ã€‚åœ¨å®‰å…¨ç­–ç•¥ä¸¥æ ¼çš„ç¯å¢ƒä¸­ï¼Œè¿™å¯èƒ½æ˜¯ä¸å¯æ¥å—çš„ï¼Œå› æ­¤éœ€è¦é¢å¤–çš„æªæ–½æ¥ä¿æŠ¤å®ƒä»¬ã€‚ä¸€ç§æ­¤ç±»è§£å†³æ–¹æ¡ˆæ¶‰åŠå°†æœºå¯†å­˜å‚¨åœ¨å¤–éƒ¨æœºå¯†å­˜å‚¨æä¾›ç¨‹åºä¸­ï¼Œä¾‹å¦‚ &lt;a href=&#34;https://www.vaultproject.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;HashiCorp Vault&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;Vault å¯ä»¥æ‰˜ç®¡åœ¨ Kubernetes é›†ç¾¤å†…éƒ¨å’Œå¤–éƒ¨ã€‚åœ¨æœ¬æ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†æ¢ç´¢ä½¿ç”¨æ‰˜ç®¡åœ¨ Kubernetes å¤–éƒ¨çš„ Vaultï¼Œä»¥ä¾¿å®ƒå¯ä»¥åŒæ—¶ä¸ºå¤šä¸ªé›†ç¾¤æä¾›ç§˜å¯†ã€‚è¯¥è®¾ç½®ä¹Ÿéå¸¸é€‚åˆæ¢ç´¢ Istio çš„&lt;a href=&#34;https://istio.io/latest/docs/setup/install/multicluster&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¤šé›†ç¾¤åŠŸèƒ½&lt;/a&gt;ï¼Œå®ƒéœ€è¦ä¸€ä¸ªå…±äº«çš„ä¿¡ä»»åŸŸã€‚&lt;/p&gt;
&lt;p&gt;åˆ©ç”¨ &lt;code&gt;vault-agent-init&lt;/code&gt; å®¹å™¨ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¯ä¹¦å’Œç§é’¥ææ–™æ³¨å…¥å®é™…çš„ Istio æ§åˆ¶å¹³é¢ Podï¼Œä»¥ä¾¿å®ƒä»¬ä½¿ç”¨å¤–éƒ¨ CA è¯ä¹¦è¿›è¡Œå¼•å¯¼ã€‚è¿™é¿å…äº†ä¾èµ– Secret æ¥å¼•å¯¼ Istio æ§åˆ¶å¹³é¢ã€‚è¯¥æŠ€æœ¯ä¹Ÿå®Œå…¨é€‚ç”¨äºå…¥å£å’Œå‡ºå£è¯ä¹¦ã€‚&lt;/p&gt;
&lt;p&gt;æœ‰å…³å¦‚ä½•åœ¨ Istio ä¸­ä½¿ç”¨å’Œç®¡ç†è¯ä¹¦çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è§å®˜æ–¹æ–‡æ¡£ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://istio.io/latest/zh/docs/concepts/security/#pki&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;èº«ä»½å’Œè¯ä¹¦ç®¡ç†&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://istio.io/latest/zh/docs/tasks/security/cert-management/plugin-ca-cert&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ’å…¥ CA è¯ä¹¦&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://istio.io/latest/zh/docs/tasks/security/cert-management/custom-ca-k8s&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä½¿ç”¨ Kubernetes CSR çš„è‡ªå®šä¹‰ CA é›†æˆ&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æœ‰å…³åŸºäºå®é™…ç”Ÿäº§ç»éªŒçš„æœ€ä½³å®è·µï¼Œå¦è¯·æŸ¥çœ‹ä»¥ä¸‹ &lt;a href=&#34;https://tetrate.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tetrate&lt;/a&gt; çš„åšå®¢æ–‡ç« ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://lib.jimmysong.io/blog/istio-trust/&#34;&gt;åœ¨ Istio ä¸­æ„å»ºè¯ä¹¦ä¿¡ä»»é“¾ï¼šå°†ç°æœ‰ PKI ä½œä¸ºä¿¡ä»»æ ¹&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://lib.jimmysong.io/blog/automate-istio-ca-rotation-in-production-at-scale&#34;&gt;åœ¨ç”Ÿäº§ä¸­å¤§è§„æ¨¡è‡ªåŠ¨åŒ– Istio CA è½®æ¢&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿™ç¯‡åšæ–‡é™„å¸¦çš„ä»£ç å¯ä»¥åœ¨ä»¥ä¸‹å­˜å‚¨åº“ä¸­æ‰¾åˆ°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/tetratelabs/istio-vault-ext-certs&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://github.com/tetratelabs/istio-vault-ext-certs&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;istiod-è¯ä¹¦å¤„ç†&#34;&gt;&lt;strong&gt;Istiod è¯ä¹¦å¤„ç†&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;å°½ç®¡ä¸Šè¿°åšæ–‡ä¸­è§£é‡Šäº†ä¸€äº›å†³ç­–é€»è¾‘ï¼Œä½†ä¹Ÿå€¼å¾—å‚è€ƒ&lt;a href=&#34;https://github.com/istio/istio/blob/master/pilot/pkg/bootstrap/istio_ca.go&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æºä»£ç &lt;/a&gt;ä»¥æŸ¥æ‰¾ä¸€äº›æœªè®°å½•çš„è¡Œä¸ºã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ Istio çš„æºç  &lt;code&gt;istio/pilot/pkg/bootstrap/istio_ca.go&lt;/code&gt; æ–‡ä»¶ä¸­ï¼Œä½ å°†çœ‹åˆ°ï¼šä¸ºäº†å‘åå…¼å®¹ï¼ŒIstio ä¿ç•™äº†å¯¹ç”¨äºè‡ªç­¾åè¯ä¹¦ &lt;code&gt;cacerts&lt;/code&gt; Secret çš„æ”¯æŒã€‚å®ƒå®‰è£…åœ¨ç›¸åŒçš„ä½ç½®ï¼Œå¦‚æœå‘ç°äº†å°±ä¼šè¢«ä½¿ç”¨â€”â€”åˆ›å»ºç§˜å¯†å°±è¶³å¤Ÿäº†ï¼Œä¸éœ€è¦é¢å¤–çš„é€‰é¡¹ã€‚åœ¨æ—§å®‰è£…ç¨‹åºä¸­ï¼Œ&lt;code&gt;LocalCertDir&lt;/code&gt; è¢«ç¡¬ç¼–ç åˆ° &lt;code&gt;/etc/cacerts&lt;/code&gt; å¹¶ä½¿ç”¨ &lt;code&gt;cacerts&lt;/code&gt;  Secret å®‰è£…ã€‚å·²åˆ é™¤å¯¹ç­¾ç½²å…¶ä»–æ ¹ CA çš„æ”¯æŒâ€”â€”å¤ªå±é™©ï¼Œæ²¡æœ‰æ˜ç¡®çš„ç”¨ä¾‹ã€‚&lt;/p&gt;
&lt;p&gt;é»˜è®¤é…ç½®ï¼Œç”¨äºå‘åå…¼å®¹ Citadelï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚æœ &lt;code&gt;istio-system&lt;/code&gt; ä¸­å­˜åœ¨ &lt;code&gt;cacerts&lt;/code&gt; ç§˜å¯†ï¼Œå°†è¢«æŒ‚è½½ã€‚å®ƒå¯èƒ½åŒ…å«ä¸€ä¸ªå¯é€‰çš„ &lt;code&gt;root-cert.pem&lt;/code&gt;ï¼Œ
å¸¦æœ‰é¢å¤–çš„æ ¹å’Œå¯é€‰çš„ &lt;code&gt;{ca-key, ca-cert, cert-chain}.pem&lt;/code&gt; ç”±ç”¨æˆ·æä¾›çš„æ ¹ CAã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœæœªæ‰¾åˆ°ç”¨æˆ·æä¾›çš„æ ¹ CAï¼Œåˆ™ä½¿ç”¨ &lt;code&gt;istio-ca-secret&lt;/code&gt; Secret ï¼Œä»¥åŠ &lt;code&gt;ca-cert.pem&lt;/code&gt; å’Œ &lt;code&gt;ca-key.pem&lt;/code&gt; æ–‡ä»¶ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœä¸¤è€…å‡æœªæ‰¾åˆ°ï¼Œå°†åˆ›å»º &lt;code&gt;istio-ca-secret&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å¸¦æœ‰ &lt;code&gt;caTLSRootCert&lt;/code&gt; æ–‡ä»¶çš„ &lt;code&gt;istio-security&lt;/code&gt; ConfigMap å°†ç”¨äºæ ¹è¯ä¹¦ï¼Œå¹¶åœ¨éœ€è¦æ—¶åˆ›å»ºã€‚è¯¥ ConfigMap ç”±èŠ‚ç‚¹ä»£ç†ä½¿ç”¨ï¼Œä¸å†å¯èƒ½åœ¨ sds-agent ä¸­ä½¿ç”¨ï¼Œä½†æˆ‘ä»¬ä»ä¿ç•™å®ƒä»¥å‘åå…¼å®¹ã€‚å°†ä¸ node-agent ä¸€èµ·åˆ é™¤ã€‚sds-agent ä½¿ç”¨ K8S root ç›´æ¥è°ƒç”¨ &lt;code&gt;NewCitadelClient&lt;/code&gt; ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸ºäº†æŒ‡ç¤º Istio ä»å…¶ä»–åœ°æ–¹è·å–è¯ä¹¦ï¼Œè€Œä¸æ˜¯æ ‡å‡† Kubernetes Secretï¼Œæˆ‘ä»¬å°†åˆ©ç”¨ &lt;em&gt;istio-pilot&lt;/em&gt;ï¼ˆåˆå istiod æˆ– Istio æ§åˆ¶å¹³é¢ï¼‰çš„ç¯å¢ƒå˜é‡ï¼ˆ&lt;a href=&#34;https://istio.io/latest/docs/reference/commands/pilot-discovery&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è§æ­¤æ–‡æ¡£&lt;/a&gt;ï¼‰ï¼Œä» Kubernetes Pod ä¸­çš„å¦ä¸€ä¸ªä½ç½®è·å–è¯ä¹¦ã€‚è¿™æ˜¯å¿…éœ€çš„ï¼Œå› ä¸º &lt;code&gt;vault-agent-init&lt;/code&gt; æ³¨å…¥å®¹å™¨å°†åˆ›å»ºä¸€ä¸ªæ–°çš„æŒ‚è½½å· &lt;code&gt;/vault/secrets&lt;/code&gt; ï¼Œä»¥æ”¾ç½®ä»å¤–éƒ¨ Vault æœåŠ¡å™¨æ‹‰å‡ºçš„è¯ä¹¦å’Œç§é’¥ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;å˜é‡åç§°&lt;/th&gt;
&lt;th&gt;ç±»å‹&lt;/th&gt;
&lt;th&gt;é»˜è®¤å€¼&lt;/th&gt;
&lt;th&gt;æè¿°&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;ROOT_CA_DIR&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;å­—ç¬¦ä¸²&lt;/td&gt;
&lt;td&gt;&lt;code&gt;/etc/cacerts&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æœ¬åœ°æˆ–å®‰è£…çš„ CA æ ¹ç›®å½•çš„ä½ç½®&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;pod-å†…çš„-vault-agent-init-å®¹å™¨æ³¨è§£&#34;&gt;Pod å†…çš„ &lt;code&gt;vault-agent-init&lt;/code&gt; å®¹å™¨æ³¨è§£&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬å°†åˆ©ç”¨ Vault æ³¨å…¥å™¨æ³¨è§£æ¥æŒ‡ç¤º Sidecar æå–å“ªäº›æ•°æ®ä»¥åŠåœ¨è¿™æ ·åšæ—¶ä½¿ç”¨ä»€ä¹ˆ Vault è§’è‰²ã€‚æˆ‘ä»¬è¿˜ç¡®ä¿å®¹å™¨åœ¨æˆ‘ä»¬å®é™…çš„ä¸»å®¹å™¨ä¹‹å‰è¿è¡Œï¼Œå› æ­¤åè€…å¯ä»¥è·å–è¯ä¹¦å’Œå¯†é’¥ææ–™ä»¥æ­£ç¡®å¼•å¯¼è‡ªèº«ã€‚&lt;a href=&#34;https://developer.hashicorp.com/vault/docs/platform/k8s/injector/annotations&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ­¤å¤„&lt;/a&gt;åˆ—ä¸¾å¹¶è®°å½•äº† Vault æ³¨è§£ã€‚æˆ‘ä»¬å°†åœ¨æœ¬æ•™ç¨‹ä¸­ä½¿ç”¨çš„ç›¸å…³æ³¨é‡Šå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;strong&gt;æ³¨è§£&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;é»˜è®¤å€¼&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;æè¿°&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;vault.hashicorp.com/agent-inject&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;false&lt;/td&gt;
&lt;td&gt;é…ç½®æ˜¯å¦ä¸º Pod æ˜¾å¼å¯ç”¨æˆ–ç¦ç”¨æ³¨å…¥ã€‚è¿™åº”è¯¥è®¾ç½®ä¸º true æˆ– falseã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;vault.hashicorp.com/agent-init-first&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;false&lt;/td&gt;
&lt;td&gt;å¦‚æœä¸º trueï¼Œåˆ™å°† Pod é…ç½®ä¸ºé¦–å…ˆè¿è¡Œ Vault Agent init å®¹å™¨ï¼ˆå¦‚æœä¸º falseï¼Œåˆ™æœ€åè¿è¡Œï¼‰ã€‚å½“å…¶ä»– init å®¹å™¨éœ€è¦é¢„å¡«å……çš„ç§˜å¯†æ—¶ï¼Œè¿™å¾ˆæœ‰ç”¨ã€‚è¿™åº”è¯¥è®¾ç½®ä¸º true æˆ– falseã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;vault.hashicorp.com/role&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;â€“&lt;/td&gt;
&lt;td&gt;é…ç½® Vault ä»£ç†è‡ªåŠ¨éªŒè¯æ–¹æ³•ä½¿ç”¨çš„ Vault è§’è‰²ã€‚&lt;code&gt;vault.hashicorp.com/agent-configmap&lt;/code&gt; æœªè®¾ç½®æ—¶éœ€è¦ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;vault.hashicorp.com/auth-path&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;â€“&lt;/td&gt;
&lt;td&gt;é…ç½® Kubernetes èº«ä»½éªŒè¯æ–¹æ³•çš„èº«ä»½éªŒè¯è·¯å¾„ã€‚é»˜è®¤ä¸º &lt;code&gt;auth/kubernetes&lt;/code&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;vault.hashicorp.com/agent-inject-secret-&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;â€“&lt;/td&gt;
&lt;td&gt;é…ç½® Vault ä»£ç†ä»¥ä»å®¹å™¨æ‰€éœ€çš„ Vault ä¸­æ£€ç´¢ç§˜å¯†ã€‚Secret çš„åç§°æ˜¯ &lt;code&gt;vault.hashicorp.com/agent-inject-secret-&lt;/code&gt; ä¹‹åçš„ä»»æ„å”¯ä¸€å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ &lt;code&gt;vault.hashicorp.com/agent-inject-secret-foobar&lt;/code&gt; è¯¥å€¼æ˜¯ secret æ‰€åœ¨çš„ Vault ä¸­çš„è·¯å¾„ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;vault.hashicorp.com/agent-inject-template-&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;â€“&lt;/td&gt;
&lt;td&gt;é…ç½® Vault Agent åº”è¯¥ç”¨äºå‘ˆç°ç§˜å¯†çš„æ¨¡æ¿ã€‚æ¨¡æ¿çš„åç§°æ˜¯ v&lt;code&gt;ault.hashicorp.com/agent-inject-template-&lt;/code&gt; ä¹‹åçš„ä»»ä½•å”¯ä¸€å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ &lt;code&gt;vault.hashicorp.com/agent-inject-template-foobar&lt;/code&gt;ã€‚è¿™åº”è¯¥æ˜ å°„åˆ° &lt;code&gt;vault.hashicorp.com/agent-inject-secret-&lt;/code&gt; ä¸­æä¾›çš„ç›¸åŒå”¯ä¸€å€¼ã€‚å¦‚æœæœªæä¾›ï¼Œåˆ™ä½¿ç”¨é»˜è®¤çš„é€šç”¨æ¨¡æ¿ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;vault-server-considerations&#34;&gt;Vault æœåŠ¡å™¨æ³¨æ„äº‹é¡¹&lt;/h2&gt;
&lt;p&gt;Vault æ”¯æŒå¤šç§å®¢æˆ·ç«¯éªŒè¯è‡ªå·±çš„æ–¹æ³•ã€‚æˆ‘ä»¬å°†åˆ©ç”¨ &lt;a href=&#34;https://developer.hashicorp.com/vault/docs/auth/kubernetes&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Kubernetes èº«ä»½éªŒè¯åç«¯&lt;/a&gt;ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å°†åˆ©ç”¨ Kubernetes ServiceAccount JWT ä»¤ç‰ŒéªŒè¯ã€‚è¯·æ³¨æ„ï¼Œè‡ª Kubernetes 1.24 ä»¥æ¥ï¼Œä¸å†è‡ªåŠ¨ç”Ÿæˆ ServiceAccount ä»¤ç‰Œã€‚æ‚¨ä»ç„¶å¯ä»¥æ‰‹åŠ¨åˆ›å»ºè¿™äº› API ä»¤ç‰Œï¼Œå¦‚&lt;a href=&#34;https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/#manually-create-an-api-token-for-a-serviceaccount&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ­¤å¤„æ‰€è¿°&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è‡³äºè¯ä¹¦å’Œç§é’¥ææ–™çš„å­˜å‚¨ï¼Œæˆ‘ä»¬æœ‰ä¸¤ç§é€‰æ‹©ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://developer.hashicorp.com/vault/docs/secrets/pki&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;PKI ç§˜å¯†å¼•æ“&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://developer.hashicorp.com/vault/docs/secrets/kv&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;KV ç§˜å¯†å¼•æ“&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å› ä¸º PKI ç§˜å¯†å¼•æ“ä¸æä¾›ç²¾ç®€çš„ API æ¥æ£€ç´¢æˆ‘ä»¬éœ€è¦çš„è¯ä¹¦å’Œç§é’¥ï¼Œå¹¶ä¸”å› ä¸º PKI ç§˜å¯†å¼•æ“ä¼šä¸ºæ¯æ¬¡è°ƒç”¨ï¼ˆä¾‹å¦‚ï¼Œæ¯æ¬¡ &lt;em&gt;istiod&lt;/em&gt; é‡å¯ï¼‰ç”Ÿæˆä¸€ä¸ªæ–°çš„ä¸­é—´è¯ä¹¦ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨é€šç”¨çš„ KV ç§˜å¯†å¼•æ“ï¼Œå°†æˆ‘ä»¬éœ€è¦çš„æ‰€æœ‰å€¼å­˜å‚¨åœ¨ä¸€ä¸ªç®€å•çš„é”®å€¼æ•°æ®ç»“æ„ä¸­ã€‚æˆ‘ä»¬å‡è®¾ä¸­é—´è¯ä¹¦çš„æ›´æ–°æ˜¯é€šè¿‡ä¸€äº›æœåŠ¡é—¨æˆ·æˆ– CI/CD è¿‡ç¨‹åœ¨å¤–éƒ¨å¤„ç†çš„ï¼Œè¿™äº›è¿‡ç¨‹ä¹Ÿå°†æ›´æ–°çš„ä¸­é—´è¯ä¹¦å­˜å‚¨åœ¨ Vault æœåŠ¡å™¨ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;Istio çš„æ§åˆ¶å¹³é¢ Pod éœ€è¦ä»¥ä¸‹æ–‡ä»¶æ‰èƒ½åœ¨ CA ä¸­æ­£ç¡®å¼•å¯¼å…¶æ„å»ºï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Key&lt;/th&gt;
&lt;th&gt;å€¼ï¼ˆPEM ç¼–ç ï¼‰&lt;/th&gt;
&lt;th&gt;ç»†èŠ‚&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;ca-key.pem&lt;/td&gt;
&lt;td&gt;ç§é’¥&lt;/td&gt;
&lt;td&gt;ä¸­é—´è¯ä¹¦çš„ç§é’¥ï¼Œç”¨ä½œ &lt;em&gt;istiod&lt;/em&gt; çš„æ ¹ CAã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ca-cert.pem&lt;/td&gt;
&lt;td&gt;CA å…¬å…±è¯ä¹¦&lt;/td&gt;
&lt;td&gt;ä¸­é—´è¯ä¹¦ï¼Œç”¨ä½œ &lt;em&gt;istiod&lt;/em&gt; çš„æ ¹ CAã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;root-cert.pem&lt;/td&gt;
&lt;td&gt;CA æ ¹è¯ä¹¦&lt;/td&gt;
&lt;td&gt;æˆ‘ä»¬æ–°ç”Ÿæˆçš„ä¸­é—´è¯ä¹¦çš„ä¿¡ä»»æ ¹ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;cert-chain.pem&lt;/td&gt;
&lt;td&gt;å®Œæ•´çš„è¯ä¹¦é“¾&lt;/td&gt;
&lt;td&gt;ä¸­é—´è¯ä¹¦åœ¨é¡¶éƒ¨ï¼Œæ ¹è¯ä¹¦åœ¨åº•éƒ¨ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;è®¾ç½®&#34;&gt;è®¾ç½®&lt;/h2&gt;
&lt;p&gt;å¦‚æœè¦éµå¾ªæœ¬åœ°è®¾ç½®ï¼Œåˆ™å®‰è£…è½¯ä»¶çš„å…ˆå†³æ¡ä»¶åŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;kubectl&lt;/em&gt; ä¸ Kubernetes é›†ç¾¤äº¤äº’ï¼ˆ&lt;a href=&#34;https://kubernetes.io/docs/tasks/tools/#kubectl&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä¸‹è½½&lt;/a&gt;ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;em&gt;helm&lt;/em&gt; å®‰è£… Vault injector å’Œ Istio chartï¼ˆ&lt;a href=&#34;https://helm.sh/docs/intro/install&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä¸‹è½½&lt;/a&gt;ï¼‰&lt;/li&gt;
&lt;li&gt;ç”¨äºé…ç½® Vault æœåŠ¡å™¨çš„ &lt;em&gt;vault cli&lt;/em&gt; å·¥å…·ï¼ˆ&lt;a href=&#34;https://developer.hashicorp.com/vault/tutorials/getting-started/getting-started-install#install-vault&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä¸‹è½½&lt;/a&gt;ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¦‚æœæ‚¨æƒ³è¦æœ¬åœ°æ¼”ç¤ºç¯å¢ƒï¼Œè¯·æŒ‰ç…§&lt;a href=&#34;https://github.com/tetratelabs/istio-vault-ext-certs/blob/main/local-setup.md&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ­¤å¤„&lt;/a&gt;çš„è¯´æ˜è¿›è¡Œæ“ä½œï¼Œè¯¥è¯´æ˜ä½¿ç”¨ &lt;code&gt;docker-compose&lt;/code&gt; å¯åŠ¨ä¸€ä¸ª Vault æœåŠ¡å™¨å’Œä¸¤ä¸ªç‹¬ç«‹çš„ k3s é›†ç¾¤ã€‚å¦‚æœæ‚¨ä½¿ç”¨è‡ªå·±çš„ Kubernetes é›†ç¾¤å’Œå¤–éƒ¨æ‰˜ç®¡çš„ Vault å®ä¾‹ï¼Œè¯·è·³è‡³ä¸‹ä¸€èŠ‚ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;docker-compose&lt;/em&gt; å¯åŠ¨æœ¬åœ°ç¯å¢ƒï¼ˆ&lt;a href=&#34;https://github.com/docker/compose/releases&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä¸‹è½½&lt;/a&gt;ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸ºäº†å–å¾—è¿›å±•ï¼Œæˆ‘ä»¬å¸Œæœ›æ ¹æ®æ‚¨çš„ç¯å¢ƒè®¾ç½®ä»¥ä¸‹ shell å˜é‡ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;VAULT_SERVER&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;K8S_API_SERVER_1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;K8S_API_SERVER_2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;vault-kubernetes-èº«ä»½éªŒè¯åç«¯&#34;&gt;&lt;strong&gt;Vault Kubernetes èº«ä»½éªŒè¯åç«¯&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;æ­£å¦‚åœ¨æœ‰å…³ &lt;a href=&#34;#vault-server-considerations&#34;&gt;Vault æœåŠ¡å™¨æ³¨æ„äº‹é¡¹&lt;/a&gt;çš„ä»‹ç»éƒ¨åˆ†ä¸­æåˆ°çš„ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ &lt;a href=&#34;https://developer.hashicorp.com/vault/docs/auth/kubernetes&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Kubernetes èº«ä»½éªŒè¯åç«¯&lt;/a&gt;ã€‚ç”±äº &lt;em&gt;istiod&lt;/em&gt; å°†ä» Vault æœåŠ¡å™¨è·å–è¯ä¹¦å’Œç§é’¥ææ–™ï¼Œè®©æˆ‘ä»¬ä»åœ¨ä¸¤ä¸ªé›†ç¾¤ä¸­åˆ›å»ºç›¸åº”çš„æœåŠ¡è´¦æˆ·å¼€å§‹ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl --kubeconfig kubecfg1.yml create ns istio-system
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl --kubeconfig kubecfg2.yml create ns istio-system
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl --kubeconfig kubecfg1.yml apply -f istio-sa.yml
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl --kubeconfig kubecfg2.yml apply -f istio-sa.yml
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ServiceAccountã€Secret å’Œ ClusterRoleBinding å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c&#34;&gt;# istio-sa.yaml&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;v1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;ServiceAccount&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;istiod&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;istio-system&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;labels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# added for istio helm installation&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;istiod&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;app.kubernetes.io/managed-by&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Helm&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;release&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;istio-istiod&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;annotations&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# added for istio helm installation&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;meta.helm.sh/release-name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;istio-istiod&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;meta.helm.sh/release-namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;istio-system&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nn&#34;&gt;---&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;v1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Secret&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;istiod&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;istio-system&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;annotations&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kubernetes.io/service-account.name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;istiod&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;kubernetes.io/service-account-token&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nn&#34;&gt;---&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;rbac.authorization.k8s.io/v1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;ClusterRoleBinding&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;role-tokenreview-binding&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;roleRef&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;apiGroup&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;rbac.authorization.k8s.io&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;ClusterRole&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;system:auth-delegator&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;subjects&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;ServiceAccount&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;istiod&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;istio-system&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;blockquote&gt;
&lt;p&gt;æ³¨æ„ï¼š&lt;em&gt;æˆ‘ä»¬åœ¨ istiod ServiceAccount ä¸Šæ·»åŠ äº† Helm æ ‡ç­¾å’Œæ³¨è§£ï¼Œä»¥å…ä¸ç¨åçš„ Istio Helm éƒ¨ç½²å‘ç”Ÿå†²çªã€‚&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åœ¨ä¸¤ä¸ªé›†ç¾¤ä¸­åˆ›å»º ServiceAccount åï¼Œè®©æˆ‘ä»¬å°†å®ƒä»¬çš„ Secret ä»¤ç‰Œå’Œ ca.cert å€¼å­˜å‚¨åœ¨ output æ–‡ä»¶å¤¹ä¸­ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;mkdir -p ./output
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl --kubeconfig kubecfg1.yml get secret -n istio-system istiod -o go-template&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;{{ .data.token }}&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; base64 --decode &amp;gt; output/istiod1.jwt
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl --kubeconfig kubecfg1.yml config view --raw --minify --flatten -o &lt;span class=&#34;nv&#34;&gt;jsonpath&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;{.clusters[].cluster.certificate-authority-data}&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; base64 --decode &amp;gt; output/k8sapi-cert1.pem
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl --kubeconfig kubecfg2.yml get secret -n istio-system istiod -o go-template&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;{{ .data.token }}&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; base64 --decode &amp;gt; output/istiod2.jwt
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl --kubeconfig kubecfg2.yml config view --raw --minify --flatten -o &lt;span class=&#34;nv&#34;&gt;jsonpath&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;{.clusters[].cluster.certificate-authority-data}&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; base64 --decode &amp;gt; output/k8sapi-cert2.pem
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å…³äº Kubernetes API è¯ä¹¦å’Œ istiod ServiceAccount JWT ä»¤ç‰Œçš„è¯¦ç»†å†…å®¹çš„æ›´å¤šä¿¡æ¯å¯ä»¥åœ¨&lt;a href=&#34;https://github.com/tetratelabs/istio-vault-ext-certs/blob/main/output&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è¿™é‡Œ&lt;/a&gt;æ‰¾åˆ°ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬ä¹Ÿæ›´æ·±å…¥åœ°æè¿°äº† Vault çš„äº¤äº’è¿‡ç¨‹ï¼Œå³é€šè¿‡ REST API è°ƒç”¨æ¥éªŒè¯å’Œè·å–ç§˜å¯†ã€‚åœ¨è°ƒè¯•æƒé™æ‹’ç»çš„é—®é¢˜æ—¶ï¼Œè¿™äº›å¯ä»¥æ´¾ä¸Šç”¨åœºã€‚&lt;/p&gt;
&lt;p&gt;è®©æˆ‘ä»¬æ ¹æ®åˆšåˆšæ£€ç´¢åˆ°çš„ Kubernetes CA è¯ä¹¦å’Œ JWT ä»¤ç‰Œåˆ›å»ºå¿…è¦çš„ Vault èº«ä»½éªŒè¯é…ç½®ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;VAULT_ADDR&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;http://localhost:8200
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault login root
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault auth &lt;span class=&#34;nb&#34;&gt;enable&lt;/span&gt; --path&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;kubernetes-cluster1 kubernetes
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault auth &lt;span class=&#34;nb&#34;&gt;enable&lt;/span&gt; --path&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;kubernetes-cluster2 kubernetes
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault write auth/kubernetes-cluster1/config &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;kubernetes_host&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$K8S_API_SERVER_1&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;kubernetes_ca_cert&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;@output/k8sapi-cert1.pem &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;token_reviewer_jwt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt;cat output/istiod1.jwt&lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;disable_local_ca_jwt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;true&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault write auth/kubernetes-cluster2/config &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;kubernetes_host&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$K8S_API_SERVER_2&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;kubernetes_ca_cert&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;@output/k8sapi-cert2.pem &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;token_reviewer_jwt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt;cat output/istiod2.jwt&lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;disable_local_ca_jwt&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;true&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;blockquote&gt;
&lt;p&gt;æ³¨æ„ï¼šå¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯ &lt;em&gt;docker-compose&lt;/em&gt; æä¾›çš„ç¯å¢ƒï¼Œåˆ™ &lt;code&gt;VAULT_ADDR&lt;/code&gt; è®¾ç½®ä¸º localhostã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;vault-kv-secret-ä¸­çš„-istio-è¯ä¹¦å’Œç§é’¥&#34;&gt;&lt;em&gt;Vault kv&lt;/em&gt; Secret ä¸­çš„ Istio è¯ä¹¦å’Œç§é’¥&lt;/h2&gt;
&lt;p&gt;æ¥ä¸‹æ¥æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªæ–°çš„è‡ªç­¾åæ ¹è¯ä¹¦å¹¶ä¸ºæˆ‘ä»¬çš„ä¸¤ä¸ªé›†ç¾¤ç”Ÿæˆä¸­é—´è¯ä¹¦ã€‚æˆ‘ä»¬å°†åœ¨&lt;a href=&#34;https://github.com/istio/istio/tree/master/tools/certs&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è¿™é‡Œ&lt;/a&gt;ä½¿ç”¨ä¸Šæ¸¸ Istio æä¾›çš„è¾…åŠ© &lt;em&gt;Makefile&lt;/em&gt; è„šæœ¬ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; certs
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;make -f ../certs-gen/Makefile.selfsigned.mk root-ca
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;make -f ../certs-gen/Makefile.selfsigned.mk istiod-cluster1-cacerts
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;make -f ../certs-gen/Makefile.selfsigned.mk istiod-cluster2-cacerts
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; ..
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æœ‰å…³å®é™…å†…å®¹å’Œæ­£åœ¨è®¾ç½®çš„ X509v3 æ‰©å±•çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§&lt;a href=&#34;https://github.com/tetratelabs/istio-vault-ext-certs/blob/main/certs&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ­¤å¤„&lt;/a&gt;ã€‚æ‚¨å¯ä»¥é€šè¿‡&lt;a href=&#34;https://github.com/tetratelabs/istio-vault-ext-certs/blob/main/certs-gen&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ­¤å¤„&lt;/a&gt;çš„ &lt;em&gt;Makefile&lt;/em&gt;æ–‡æ¡£å’Œç›¸åº”çš„ &lt;em&gt;Makefile&lt;/em&gt; è¦†ç›–å€¼å¾®è°ƒè¯ä¹¦ã€‚&lt;/p&gt;
&lt;p&gt;è®©æˆ‘ä»¬å°†ç”Ÿæˆçš„è¯ä¹¦å’Œç§é’¥æ·»åŠ åˆ° Vault &lt;em&gt;kv&lt;/em&gt; secret ä¸­ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;VAULT_ADDR&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;http://localhost:8200
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault login root
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault secrets &lt;span class=&#34;nb&#34;&gt;enable&lt;/span&gt; -path&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;kubernetes-cluster1-secrets kv
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault secrets &lt;span class=&#34;nb&#34;&gt;enable&lt;/span&gt; -path&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;kubernetes-cluster2-secrets kv
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault kv put kubernetes-cluster1-secrets/istiod-service/certs &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;ca_key&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;@certs/istiod-cluster1/ca-key.pem &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;ca_cert&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;@certs/istiod-cluster1/ca-cert.pem &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;cert_chain&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;@certs/istiod-cluster1/cert-chain.pem &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;root_cert&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;@certs/istiod-cluster1/root-cert.pem
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault kv put kubernetes-cluster2-secrets/istiod-service/certs &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;ca_key&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;@certs/istiod-cluster2/ca-key.pem &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;ca_cert&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;@certs/istiod-cluster2/ca-cert.pem &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;cert_chain&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;@certs/istiod-cluster2/cert-chain.pem &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;root_cert&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;@certs/istiod-cluster2/root-cert.pem
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;é€šè¿‡é™åˆ¶å¯¹æ¯ä¸ªé›†ç¾¤çš„è¿™äº›è¯ä¹¦å’Œç§é’¥çš„è®¿é—®ï¼Œç»‘å®šåˆ°åŸºäº Kubernetes &lt;em&gt;istiod&lt;/em&gt; ServiceAccount çš„èº«ä»½éªŒè¯åç«¯ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;path &amp;#34;kubernetes-cluster1-secrets/istiod-service/certs&amp;#34; {
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;  capabilities = [&amp;#34;read&amp;#34;]
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;}&amp;#39;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; vault policy write istiod-certs-cluster1 -
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;path &amp;#34;kubernetes-cluster2-secrets/istiod-service/certs&amp;#34; {
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;  capabilities = [&amp;#34;read&amp;#34;]
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;}&amp;#39;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; vault policy write istiod-certs-cluster2 -
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault write auth/kubernetes-cluster1/role/istiod &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;bound_service_account_names&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;istiod &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;bound_service_account_namespaces&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;istio-system &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;policies&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;istiod-certs-cluster1 &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;ttl&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;24h
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;vault write auth/kubernetes-cluster2/role/istiod &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;bound_service_account_names&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;istiod &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;bound_service_account_namespaces&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;istio-system &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;policies&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;istiod-certs-cluster2  &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  &lt;span class=&#34;nv&#34;&gt;ttl&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;24h
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;éƒ¨ç½²-vault-inject-å’Œ-istio-helm-charts&#34;&gt;éƒ¨ç½² &lt;em&gt;vault-inject&lt;/em&gt; å’Œ Istio Helm Charts&lt;/h2&gt;
&lt;p&gt;ä¸ºäº†éƒ¨ç½² Vault æ³¨å…¥å™¨ï¼Œæˆ‘ä»¬å°†åˆ©ç”¨å®˜æ–¹ Vault &lt;a href=&#34;https://github.com/hashicorp/vault-helm&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Helm chart&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;helm repo add hashicorp https://helm.releases.hashicorp.com
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;helm repo update
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl --kubeconfig kubecfg1.yml create ns vault
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl --kubeconfig kubecfg2.yml create ns vault
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;helm --kubeconfig kubecfg1.yml install -n vault vault-inject hashicorp/vault --set &lt;span class=&#34;s2&#34;&gt;&amp;#34;injector.externalVaultAddr=&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$VAULT_SERVER&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;helm --kubeconfig kubecfg2.yml install -n vault vault-inject hashicorp/vault --set &lt;span class=&#34;s2&#34;&gt;&amp;#34;injector.externalVaultAddr=&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$VAULT_SERVER&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl --kubeconfig kubecfg1.yml -n vault get pods
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl --kubeconfig kubecfg2.yml -n vault get pods
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;NAME                                           READY   STATUS    RESTARTS   AGE
vault-inject-agent-injector-5776975795-9vt9w   1/1     Running   0          92s
NAME                                           READY   STATUS    RESTARTS   AGE
vault-inject-agent-injector-5776975795-9vjnx   1/1     Running   0          91s
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¦å®‰è£… Istioï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ Tetrate Istio Distro &lt;a href=&#34;https://github.com/tetratelabs/helm-charts&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Helm chart&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;helm repo add tetratelabs https://tetratelabs.github.io/helm-charts
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;helm repo update
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;helm --kubeconfig kubecfg1.yml install -n istio-system istio-base tetratelabs/base
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;helm --kubeconfig kubecfg2.yml install -n istio-system istio-base tetratelabs/base
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;helm --kubeconfig kubecfg1.yml install -n istio-system istio-istiod tetratelabs/istiod --values&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;./cluster1-values.yaml
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;helm --kubeconfig kubecfg2.yml install -n istio-system istio-istiod tetratelabs/istiod --values&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;./cluster2-values.yaml
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl --kubeconfig kubecfg1.yml -n istio-system get pods
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl --kubeconfig kubecfg2.yml -n istio-system get pods
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¯·æ³¨æ„æˆ‘ä»¬å¦‚ä½•åˆ©ç”¨å¤šä¸ª Istio Helm chart å€¼è¦†ç›–æ¥æˆ‘ä»¬é¢„æœŸçš„ç›®æ ‡ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ³¨å…¥ä¸€ä¸ª pilot Pod ç¯å¢ƒå˜é‡ &lt;code&gt;ROOT_CA_DIR&lt;/code&gt; æ¥å‘Šè¯‰ &lt;em&gt;istiod&lt;/em&gt; ä»å“ªé‡Œè·å–è¯ä¹¦å’Œç§é’¥&lt;/li&gt;
&lt;li&gt;å‘Šè¯‰ &lt;code&gt;vault-agent-init&lt;/code&gt; å®¹å™¨åœ¨ &lt;em&gt;istiod&lt;/em&gt; å®¹å™¨ä¹‹å‰è¿è¡Œï¼Œå› æ­¤ç§˜å¯†å®‰è£…åœ¨ &lt;code&gt;/vault/secrets&lt;/code&gt; çš„å·ä¸­å¯ç”¨&lt;/li&gt;
&lt;li&gt;æŒ‡ç¤º Vault æ³¨å…¥å™¨ä»æ­£ç¡®çš„ä½ç½®å’Œæ•°æ®å¯†é’¥è·å–æœºå¯†&lt;/li&gt;
&lt;li&gt;è¿™æ ·åšæ—¶æ‰¿æ‹… Vault &lt;em&gt;istiod&lt;/em&gt; è§’è‰²&lt;/li&gt;
&lt;li&gt;è¦†ç›–é»˜è®¤çš„ Kubernetes auth-pathï¼Œå› ä¸ºæˆ‘ä»¬æœ‰å¤šä¸ªé›†ç¾¤&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;pilot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;env&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;ROOT_CA_DIR&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;/vault/secrets&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;podAnnotations&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;vault.hashicorp.com/agent-inject&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;true&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;vault.hashicorp.com/agent-init-first&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;true&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;vault.hashicorp.com/agent-inject-secret-ca-key.pem&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;kubernetes-cluster1-secrets/istiod-service/certs&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;vault.hashicorp.com/agent-inject-template-ca-key.pem&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;        {{- with secret &amp;#34;kubernetes-cluster1-secrets/istiod-service/certs&amp;#34; -}}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;        {{ .Data.ca_key }}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;        {{ end -}}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;vault.hashicorp.com/agent-inject-secret-ca-cert.pem&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;kubernetes-cluster1-secrets/istiod-service/certs&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;vault.hashicorp.com/agent-inject-template-ca-cert.pem&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;        {{- with secret &amp;#34;kubernetes-cluster1-secrets/istiod-service/certs&amp;#34; -}}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;        {{ .Data.ca_cert }}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;        {{ end -}}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;vault.hashicorp.com/agent-inject-secret-root-cert.pem&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;kubernetes-cluster1-secrets/istiod-service/certs&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;vault.hashicorp.com/agent-inject-template-root-cert.pem&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;        {{- with secret &amp;#34;kubernetes-cluster1-secrets/istiod-service/certs&amp;#34; -}}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;        {{ .Data.root_cert }}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;        {{ end -}}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;vault.hashicorp.com/agent-inject-secret-cert-chain.pem&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;kubernetes-cluster1-secrets/istiod-service/certs&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;vault.hashicorp.com/agent-inject-template-cert-chain.pem&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;        {{- with secret &amp;#34;kubernetes-cluster1-secrets/istiod-service/certs&amp;#34; -}}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;        {{ .Data.cert_chain }}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;        {{ end -}}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;vault.hashicorp.com/role&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;istiod&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;vault.hashicorp.com/auth-path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;auth/kubernetes-cluster1&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å½“æˆ‘ä»¬æŸ¥çœ‹ &lt;code&gt;vault-agent-init&lt;/code&gt; å®¹å™¨æ—¥å¿—æ—¶ï¼Œæˆ‘ä»¬åº”è¯¥çœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„å†…å®¹ã€‚æˆ‘ä»¬çš„æ§åˆ¶å¹³é¢å·²ç»æ­£ç¡®åœ°è·å–äº† Vault æ³¨å…¥çš„ç§˜å¯†ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl --kubeconfig kubecfg1.yml logs -n istio-system -l &lt;span class=&#34;nv&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;istiod -c vault-agent-init --tail&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-1
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;==&amp;gt; Vault agent started! Log data will stream in below:

  ==&amp;gt; Vault agent configuration:

                      Cgo: disabled
                Log Level: info
                  Version: Vault v1.12.0, built 2022-10-10T18:14:33Z
              Version Sha: 558abfa75702b5dab4c98e86b802fb9aef43b0eb

  2022-11-18T11:01:21.398Z [INFO]  sink.file: creating file sink
  2022-11-18T11:01:21.398Z [INFO]  sink.file: file sink configured: path=/home/vault/.vault-token mode=-rw-r-----
  2022-11-18T11:01:21.398Z [INFO]  template.server: starting template server
  2022-11-18T11:01:21.398Z [INFO]  sink.server: starting sink server
  2022-11-18T11:01:21.398Z [INFO]  auth.handler: starting auth handler
  2022-11-18T11:01:21.398Z [INFO]  auth.handler: authenticating
  2022-11-18T11:01:21.398Z [INFO] (runner) creating new runner (dry: false, once: false)
  2022-11-18T11:01:21.398Z [INFO] (runner) creating watcher
  2022-11-18T11:01:21.402Z [INFO]  auth.handler: authentication successful, sending token to sinks
  2022-11-18T11:01:21.402Z [INFO]  auth.handler: starting renewal process
  2022-11-18T11:01:21.402Z [INFO]  sink.file: token written: path=/home/vault/.vault-token
  2022-11-18T11:01:21.402Z [INFO]  sink.server: sink server stopped
  2022-11-18T11:01:21.402Z [INFO]  sinks finished, exiting
  2022-11-18T11:01:21.402Z [INFO]  template.server: template server received new token
  2022-11-18T11:01:21.402Z [INFO] (runner) stopping
  2022-11-18T11:01:21.402Z [INFO] (runner) creating new runner (dry: false, once: false)
  2022-11-18T11:01:21.402Z [INFO] (runner) creating watcher
  2022-11-18T11:01:21.402Z [INFO] (runner) starting
  2022-11-18T11:01:21.403Z [INFO]  auth.handler: renewed auth token
  2022-11-18T11:01:21.515Z [INFO] (runner) rendered &amp;#34;(dynamic)&amp;#34; =&amp;gt; &amp;#34;/vault/secrets/root-cert.pem&amp;#34;
  2022-11-18T11:01:21.515Z [INFO] (runner) rendered &amp;#34;(dynamic)&amp;#34; =&amp;gt; &amp;#34;/vault/secrets/ca-cert.pem&amp;#34;
  2022-11-18T11:01:21.515Z [INFO] (runner) rendered &amp;#34;(dynamic)&amp;#34; =&amp;gt; &amp;#34;/vault/secrets/cert-chain.pem&amp;#34;
  2022-11-18T11:01:21.516Z [INFO] (runner) rendered &amp;#34;(dynamic)&amp;#34; =&amp;gt; &amp;#34;/vault/secrets/ca-key.pem&amp;#34;
  2022-11-18T11:01:21.516Z [INFO] (runner) stopping
  2022-11-18T11:01:21.516Z [INFO]  template.server: template server stopped
  2022-11-18T11:01:21.516Z [INFO] (runner) received finish
  2022-11-18T11:01:21.516Z [INFO]  auth.handler: shutdown triggered, stopping lifetime watcher
  2022-11-18T11:01:21.516Z [INFO]  auth.handler: auth handler stopped
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å½“æˆ‘ä»¬æŸ¥çœ‹ &lt;code&gt;discovery&lt;/code&gt; å®¹å™¨æ—¥å¿—æ—¶ï¼Œæˆ‘ä»¬åº”è¯¥çœ‹åˆ°å¦‚ä¸‹å†…å®¹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl --kubeconfig kubecfg1.yml logs -n istio-system -l &lt;span class=&#34;nv&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;istiod -c discovery --tail&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;-1
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt; info	Using istiod file format for signing ca files
  info	Use plugged-in cert at /vault/secrets/ca-key.pem
  info	x509 cert - Issuer: &amp;#34;CN=Intermediate CA,O=Istio,L=istiod-cluster1&amp;#34;, Subject: &amp;#34;&amp;#34;, SN: 39f67569f10d36a1fc91e9d82156b07d, NotBefore: &amp;#34;2022-11-18T11:11:59Z&amp;#34;, NotAfter: &amp;#34;2032-11-15T11:13:59Z&amp;#34;
  info	x509 cert - Issuer: &amp;#34;CN=Root CA,O=Istio&amp;#34;, Subject: &amp;#34;CN=Intermediate CA,O=Istio,L=istiod-cluster1&amp;#34;, SN: dedf298a147681d6, NotBefore: &amp;#34;2022-11-17T22:01:54Z&amp;#34;, NotAfter: &amp;#34;2024-11-16T22:01:54Z&amp;#34;
  info	x509 cert - Issuer: &amp;#34;CN=Root CA,O=Istio&amp;#34;, Subject: &amp;#34;CN=Root CA,O=Istio&amp;#34;, SN: f5bcd7e89bdb6248, NotBefore: &amp;#34;2022-11-17T22:01:52Z&amp;#34;, NotAfter: &amp;#34;2032-11-14T22:01:52Z&amp;#34;
  info	Istiod certificates are reloaded
  info	spiffe	Added 1 certs to trust domain cluster.local in peer cert verifier
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„ Istio æ§åˆ¶å¹³é¢å·²ç»æ­£ç¡®åœ°è·å–äº†æˆ‘ä»¬çš„ Vault æ³¨å…¥è¯ä¹¦å’Œç§é’¥ã€‚ä»»åŠ¡å®Œæˆï¼&lt;/p&gt;
&lt;h2 id=&#34;ç»“è®º&#34;&gt;ç»“è®º&lt;/h2&gt;
&lt;p&gt;åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å·²ç»ä½¿ç”¨å¤–éƒ¨ Vault å­˜å‚¨çš„è¯ä¹¦å’Œç§é’¥æˆåŠŸå¼•å¯¼äº† Istio æ§åˆ¶å¹³é¢ã€‚å®ç°è¿™ä¸€ç›®æ ‡çš„æ­¥éª¤åŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å°†è¯ä¹¦å’Œç§é’¥å­˜å‚¨åœ¨æ¯ä¸ªé›†ç¾¤ä¸“ç”¨çš„ Vault ç§˜å¯†å®‰è£…è·¯å¾„ä¸­&lt;/li&gt;
&lt;li&gt;ä¸ºæ¯ä¸ªé›†ç¾¤è®¾ç½® Kubernetes Vault èº«ä»½éªŒè¯åç«¯ï¼Œé“¾æ¥åˆ°æ­£ç¡®çš„ ServiceAccount&lt;/li&gt;
&lt;li&gt;å®šä¹‰é€‚å½“çš„è§’è‰²å’Œç­–ç•¥ä»¥å…è®¸ä» &lt;em&gt;istiod&lt;/em&gt; ServiceAccount è®¿é—® Vault æœºå¯†&lt;/li&gt;
&lt;li&gt;å°† Istio Pilot å¼•å¯¼ç¨‹åºå‚æ•°è°ƒæ•´ä¸ºï¼š
&lt;ul&gt;
&lt;li&gt;æ³¨å…¥ &lt;em&gt;vault-agent-init&lt;/em&gt; sidecar&lt;/li&gt;
&lt;li&gt;è·å–åŒ…å«æˆ‘ä»¬çš„è¯ä¹¦å’Œç§é’¥çš„æ­£ç¡® Vault æœºå¯†&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨æ­£ç¡®çš„è§’è‰²å’Œèº«ä»½éªŒè¯åç«¯æ¥è¿™æ ·åš&lt;/li&gt;
&lt;li&gt;ä»æ­£ç¡®çš„ vault secret å®‰è£…è·¯å¾„ä¸­è·å–è¯ä¹¦å’Œç§é’¥&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®Œå…¨ç›¸åŒçš„æŠ€æœ¯æ¥æ³¨å…¥&lt;em&gt;å…¥å£ç½‘å…³&lt;/em&gt;å’Œ&lt;em&gt;å‡ºå£ç½‘å…³&lt;/em&gt;è¯ä¹¦ã€‚åˆ›å»º Istio &lt;a href=&#34;https://istio.io/latest/docs/reference/config/networking/gateway/#ServerTLSSettings&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Gateway&lt;/a&gt; å¯¹è±¡æ—¶ï¼Œè¯·ç¡®ä¿å°† &lt;em&gt;serverCertificate&lt;/em&gt;ã€&lt;em&gt;privateKey&lt;/em&gt; å’Œ &lt;em&gt;caCertificates&lt;/em&gt; æŒ‡å‘ &lt;code&gt;/vault/secrets&lt;/code&gt; æŒ‚è½½å·ä¸­çš„æ­£ç¡®æ–‡ä»¶ã€‚æˆ‘ä»¬å°†æŠŠå®ƒä½œä¸ºç»ƒä¹ ç•™ç»™è¯»è€…ã€‚&lt;/p&gt;
&lt;p&gt;é€šè¿‡å°†è¯ä¹¦æ³¨å…¥ç»‘å®šåˆ° Kubernetes ServiceAccountï¼Œæˆ‘ä»¬ç°åœ¨å·²å°†è¯ä¹¦ç”Ÿå‘½å‘¨æœŸç®¡ç†å§”æ‰˜ç»™å¤–éƒ¨ç§˜å¯† Vault å®ä¾‹ã€‚ç°åœ¨å¯ä»¥ä½¿ç”¨ä¸“ç”¨è§’è‰²å’Œå†™å…¥/æ›´æ–°ç­–ç•¥åˆ›å»ºæœåŠ¡é—¨æˆ·æˆ– CI/CD ç®¡é“ç­‰å¤–éƒ¨æµç¨‹ï¼Œä»¥æä¾›å¿…è¦çš„è¯ä¹¦ç”Ÿå‘½å‘¨æœŸç®¡ç†å®‰å…¨æ€§ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Kubernetes å®‰å…¨çš„ 6 å¤§é›¶ä¿¡ä»»åŸåˆ™</title>
      <link>https://lib.jimmysong.io/blog/the-top-6-zero-trust-principles-for-kubernetes-security/</link>
      <pubDate>Tue, 13 Dec 2022 13:00:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/the-top-6-zero-trust-principles-for-kubernetes-security/</guid>
      <description>&lt;p&gt;ä¼ ç»Ÿçš„ç½‘ç»œå®‰å…¨ä¾èµ–äºå›´ç»•å¯ä¿¡å†…éƒ¨ç½‘ç»œçš„å¼ºå¤§é˜²å¾¡è¾¹ç•Œï¼Œä»¥å°†ä¸è‰¯è¡Œä¸ºè€…æ‹’ä¹‹é—¨å¤–ï¼Œå°†æ•æ„Ÿæ•°æ®æ‹’ä¹‹é—¨å¤–ã€‚åœ¨æ—¥ç›Šå¤æ‚çš„ç½‘ç»œç¯å¢ƒä¸­ï¼Œç»´æŠ¤å¼ºå¤§çš„è¾¹ç•Œè¶Šæ¥è¶Šå›°éš¾ã€‚&lt;/p&gt;
&lt;p&gt;é›¶ä¿¡ä»»å®‰å…¨æ­£åœ¨æˆä¸ºä¼ä¸šä¿æŠ¤å…¶ä¼ ç»Ÿå’Œç°ä»£äº‘åŸç”Ÿåº”ç”¨ç¨‹åºçš„é¦–é€‰æ–¹æ³•ã€‚é›¶ä¿¡ä»»ç½‘ç»œæ¶æ„é¢ è¦†äº†è¾¹ç•Œå®‰å…¨çš„å‡è®¾ã€‚åœ¨é›¶ä¿¡ä»»ç½‘ç»œä¸­ï¼Œæ¯ä¸ªèµ„æºéƒ½åœ¨å†…éƒ¨å—åˆ°ä¿æŠ¤ï¼Œå°±å¥½åƒå®ƒæš´éœ²åœ¨å¼€æ”¾çš„äº’è”ç½‘ä¸­ä¸€æ ·ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†ä¸ºè¡Œä¸šå’Œç¾å›½è”é‚¦æ”¿åºœå»ºç«‹é›¶ä¿¡ä»»å®‰å…¨æŒ‡å—ï¼Œç¾å›½å›½å®¶æ ‡å‡†ä¸æŠ€æœ¯ç ”ç©¶é™¢ (NIST) åœ¨ä¸€ç³»åˆ—å‡ºç‰ˆç‰©ä¸­å»ºç«‹äº†é›¶ä¿¡ä»»å®‰å…¨æŒ‡å—ï¼Œä» SP 800-207 å¼€å§‹ï¼Œä»‹ç»ä¸€èˆ¬çš„é›¶ä¿¡ä»»æ¶æ„åŠå…¶é…å¥—&lt;a href=&#34;https://tetr8.io/3zi85IC&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SP 800-204 å¾®æœåŠ¡å®‰å…¨æ ‡å‡†ç³»åˆ—&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯ NIST çš„æ ¸å¿ƒé›¶ä¿¡ä»»æ¶æ„åŸåˆ™ä»¥åŠå»ºè®®åœ¨å®è·µä¸­åº”ç”¨å®ƒä»¬çš„ Kubernetes å’Œ Istio å‚è€ƒæ¶æ„ã€‚&lt;/p&gt;
&lt;h2 id=&#34;é›¶ä¿¡ä»»ç½‘ç»œçš„å…­é¡¹åŸåˆ™&#34;&gt;é›¶ä¿¡ä»»ç½‘ç»œçš„å…­é¡¹åŸåˆ™&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ— è®ºç½‘ç»œä½ç½®å¦‚ä½•ï¼Œæ‰€æœ‰é€šä¿¡éƒ½åº”è¯¥æ˜¯å®‰å…¨çš„&lt;/strong&gt;ã€‚ç½‘ç»œä½ç½®å’Œå¯è¾¾æ€§å¹¶ä¸æ„å‘³ç€ä¿¡ä»»ã€‚ä¼ä¸šæ‹¥æœ‰æˆ–å…¶ä»–ä¸“ç”¨ç½‘ç»œå†…éƒ¨çš„è®¿é—®è¯·æ±‚å¿…é¡»æ»¡è¶³ä¸æ¥è‡ªä»»ä½•å…¶ä»–ä½ç½®çš„é€šä¿¡ç›¸åŒçš„å®‰å…¨è¦æ±‚ã€‚é›¶ä¿¡ä»»ç³»ç»Ÿçš„ä¸€ä¸ªæ ‡å‡†æ˜¯ï¼Œæ‚¨å¯ä»¥å°†å®ƒæš´éœ²åœ¨å¼€æ”¾çš„äº’è”ç½‘ä¸Šï¼Œå¹¶ä¸”å®ƒä»ç„¶æ˜¯å®‰å…¨çš„ï¼Œæ²¡æœ‰æœªç»æˆæƒçš„ç³»ç»Ÿã€æ•°æ®æˆ–é€šä¿¡è®¿é—®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ‰€æœ‰é€šä¿¡éƒ½åº”åŠ å¯†&lt;/strong&gt;ã€‚çº¿è·¯ä¸Šçš„åŠ å¯†å¯é˜²æ­¢çªƒå¬ï¼Œå¹¶ç¡®ä¿æ¶ˆæ¯çœŸå®ä¸”æœªè¢«ç¯¡æ”¹ã€‚è¿™æ„å‘³ç€è‡³å°‘ä¸ºæ‰€æœ‰é€šä¿¡å®æ–½ TLSï¼Œå°†&lt;a href=&#34;https://tetr8.io/3Na982k&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;mTLS å’Œç›¸å…³çš„å®‰å…¨å·¥ä½œè´Ÿè½½èº«ä»½ä½œä¸ºæœåŠ¡é—´é€šä¿¡çš„æœ€ä½³å®è·µ&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯¹æ¯ä¸ªèµ„æºçš„è®¿é—®éƒ½åº”è¯¥æ ¹æ®åŠ¨æ€ç­–ç•¥è¿›è¡Œèº«ä»½éªŒè¯å’Œæˆæƒ&lt;/strong&gt;ã€‚åœ¨å…è®¸ä»»ä½•è®¿é—®ä¹‹å‰ï¼Œå¯¹æœåŠ¡èº«ä»½å’Œæœ€ç»ˆç”¨æˆ·å‡­æ®è¿›è¡ŒåŠ¨æ€èº«ä»½éªŒè¯å’Œæˆæƒã€‚è®¿é—®è¯·æ±‚çš„åŠ¨æ€ä¸Šä¸‹æ–‡åº”è¯¥æ˜¯è®¿é—®å†³ç­–çš„ä¸€éƒ¨åˆ†ã€‚è¿™å¯èƒ½åŒ…æ‹¬è¡Œä¸ºå±æ€§ï¼Œå¦‚ä¸è§‚å¯Ÿåˆ°çš„ä½¿ç”¨æ¨¡å¼çš„åå·®æˆ–è¯·æ±‚èµ„äº§çš„çŠ¶æ€ï¼Œå¦‚å®‰è£…çš„è½¯ä»¶ç‰ˆæœ¬ã€ç½‘ç»œä½ç½®å’Œè¯·æ±‚çš„æ—¶é—´ / æ—¥æœŸã€‚æˆäºˆè®¿é—®æƒé™æ—¶ï¼Œåº”ä»¥æ‰€éœ€çš„æœ€ä½æƒé™æˆäºˆå®ƒã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯¹èµ„æºçš„è®¿é—®åº”è¯¥åœ¨ç©ºé—´ä¸Šæœ‰ç•Œ&lt;/strong&gt;ã€‚å›´ç»•èµ„æºçš„ä¿¡ä»»èŒƒå›´åº”å°½å¯èƒ½å° â€”â€” ç†æƒ³æƒ…å†µä¸‹ä¸ºé›¶ã€‚è®¿é—®åº”è¯¥ç”±æ¯ä¸ªèƒ½å¤Ÿæ£€ç´¢å’Œæ‰§è¡Œè®¿é—®å†³ç­–çš„èµ„æºå‰é¢çš„ç­–ç•¥æ‰§è¡Œç‚¹ (PEP) è¿›è¡Œè°ƒè§£ã€‚è¿™åº”è¯¥é€‚ç”¨äºæ‰€æœ‰å…¥ç«™ã€å‡ºç«™å’ŒæœåŠ¡åˆ°æœåŠ¡çš„è®¿é—®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åº”åŠæ—¶é™åˆ¶å¯¹èµ„æºçš„è®¿é—®&lt;/strong&gt;ã€‚èº«ä»½éªŒè¯å’Œæˆæƒç»‘å®šåˆ°ä¸€ä¸ªçŸ­æš‚çš„ä¼šè¯ï¼Œä¹‹åå®ƒä»¬å¿…é¡»é‡æ–°å»ºç«‹ã€‚è¿™å¯ç¡®ä¿é¢‘ç¹åšå‡ºè®¿é—®å†³ç­–ï¼Œå¹¶ä½¿ç”¨æœ€æ–°çš„å¯ç”¨ä¸Šä¸‹æ–‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯¹èµ„æºçš„è®¿é—®åº”è¯¥æ˜¯å¯è§‚å¯Ÿçš„&lt;/strong&gt;ã€‚åº”æ”¶é›†å¹¶ä½¿ç”¨å°½å¯èƒ½å¤šçš„ä¿¡æ¯æ¥æ”¹å–„å®‰å…¨æ€åŠ¿ã€‚è¿™å…è®¸æŒç»­ç›‘æ§æ‰€æœ‰èµ„äº§çš„å®Œæ•´æ€§å’Œå®‰å…¨çŠ¶å†µï¼Œå¹¶æŒç»­ç¡®ä¿ç­–ç•¥æ‰§è¡Œã€‚æ­¤å¤–ï¼Œåº”åé¦ˆä»è§‚å¯Ÿä¸­è·å¾—çš„è§è§£ä»¥æ”¹è¿›æ”¿ç­–ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;ä¸ºä»€ä¹ˆé›¶ä¿¡ä»»å®‰å…¨æ€§æ›´å¥½&#34;&gt;ä¸ºä»€ä¹ˆé›¶ä¿¡ä»»å®‰å…¨æ€§æ›´å¥½&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ç½‘ç»œå¯è¾¾æ€§ä¸æ˜¯æˆæƒ&lt;/strong&gt;ã€‚ä¸è¾¹ç•Œå®‰å…¨æ€§ä¸åŒï¼Œå¯¹æœåŠ¡çš„è®¿é—®ä¸ä¼šä»…ä»…å› ä¸ºè¯¥æœåŠ¡å¯è®¿é—®è€Œè¢«æˆäºˆã€‚å®ƒä¹Ÿå¿…é¡»ç»è¿‡æ˜ç¡®çš„èº«ä»½éªŒè¯å’Œæˆæƒã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‘¨è¾¹çªç ´å£çš„æœ‰é™çˆ†ç‚¸åŠå¾„å¯é˜²æ­¢æ”»å‡»è€…æ¨ªå‘ç§»åŠ¨&lt;/strong&gt;ã€‚ç»è¿‡èº«ä»½éªŒè¯å’Œæˆæƒçš„å·¥ä½œè´Ÿè½½å…å—è¾¹ç•Œç ´åã€‚åŠæ—¶é™åˆ¶å‡­è¯æ³„éœ²çš„é£é™©ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç»†ç²’åº¦ç­–ç•¥&lt;/strong&gt;ã€‚ç©ºé—´è¾¹ç•Œå…è®¸é«˜ç²’åº¦çš„ç­–ç•¥æ‰§è¡Œã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é¢‘ç¹çš„æ”¿ç­–è¯„ä¼°&lt;/strong&gt;ã€‚é€šè¿‡åœ¨çŸ­æœŸä¼šè¯ä¸Šæ‰§è¡ŒåŠ¨æ€ç­–ç•¥æ¥åŠæ—¶ç»‘å®šå¯ç¡®ä¿æˆæƒåŸºäºæœ€æ–°çš„ç­–ç•¥ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®‰å…¨ã€çœŸå®çš„é€šä¿¡&lt;/strong&gt;ã€‚åŠ å¯†å’Œå¼ºå¤§çš„å·¥ä½œè´Ÿè½½èº«ä»½é™åˆ¶äº†ä¾¦å¯Ÿå¹¶æä¾›äº†é€šä¿¡çš„çœŸå®æ€§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®‰å…¨çŠ¶å†µå’Œåˆè§„æ€§çš„å®æ—¶å’Œå¯å®¡è®¡ä¿è¯&lt;/strong&gt;ã€‚ç»†ç²’åº¦çš„å¯è§‚å¯Ÿæ€§å…è®¸å®æ—¶ä¿è¯å’Œæ”¿ç­–å®æ–½çš„äº‹åå®¡è®¡ä»¥åŠæ•…éšœæ’é™¤å’Œåˆ†ææ‰€éœ€çš„æ•°æ®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;å¦‚ä½•ä½¿ç”¨-istio-åœ¨-kubernetes-ä¸­å®ç°é›¶ä¿¡ä»»å®‰å…¨ç°ä»£å¾®æœåŠ¡åº”ç”¨ç¨‹åºçš„å‚è€ƒæ¶æ„&#34;&gt;å¦‚ä½•ä½¿ç”¨ Istio åœ¨ Kubernetes ä¸­å®ç°é›¶ä¿¡ä»»å®‰å…¨ï¼šç°ä»£å¾®æœåŠ¡åº”ç”¨ç¨‹åºçš„å‚è€ƒæ¶æ„&lt;/h2&gt;
&lt;p&gt;ä½œä¸º NIST çš„ä¸€èˆ¬é›¶ä¿¡ä»»æ¶æ„æ ‡å‡†çš„è¡¥å……ï¼ŒNIST è¿˜å‘å¸ƒäº†å¦‚ä½•å°†é›¶ä¿¡ä»»åŸåˆ™ä¸“é—¨åº”ç”¨äºå¾®æœåŠ¡åº”ç”¨ç¨‹åºçš„æ ‡å‡†ã€‚è¿™äº›æ ‡å‡†ç”± Tetrate åˆ›å§‹å·¥ç¨‹å¸ˆ Zack Butcher å…±åŒç¼–å†™ï¼Œå¹¶ç¼–å…¥&lt;a href=&#34;https://tetr8.io/3zi85IC&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;NIST çš„ SP 800-204 ç³»åˆ—&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¯¥æ ‡å‡†ä¸­ï¼ŒNIST å»ºç«‹äº†ä¸€ä¸ªç”± Kubernetes ç»„æˆçš„å‚è€ƒå¹³å°ï¼Œç”¨äºç¼–æ’å’Œèµ„æºç®¡ç†ï¼Œå¹¶ä½¿ç”¨ Istio æœåŠ¡ç½‘æ ¼æä¾›æ ¸å¿ƒå®‰å…¨åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;h2 id=&#34;kubernetes-å®‰å…¨æ¼æ´&#34;&gt;Kubernetes å®‰å…¨æ¼æ´&lt;/h2&gt;
&lt;p&gt;ç”±äº Kubernetes ä¸»è¦ä¸“æ³¨äºç¼–æ’ã€èµ„æºç®¡ç†å’ŒåŸºæœ¬è¿æ¥ï¼Œå› æ­¤å®ƒå°†é›¶ä¿¡ä»»ç½‘ç»œå®‰å…¨é—®é¢˜ç•™ç»™å…¶ä»–æ–¹è§£å†³ã€‚Kubernetes ä¸­çš„ä¸»è¦ç½‘ç»œå®‰å…¨æ¼æ´æ˜¯ï¼ˆNIST SP 800-204Bï¼ŒÂ§2.1.1ï¼‰ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é»˜è®¤æƒ…å†µä¸‹ä¸å®‰å…¨çš„é€šä¿¡&lt;/li&gt;
&lt;li&gt;ç¼ºå°‘åœ¨ pod ä¹‹é—´å¼ºåˆ¶æ‰§è¡Œ TLS æ‰€éœ€çš„å†…ç½®è¯ä¹¦ç®¡ç†æœºåˆ¶&lt;/li&gt;
&lt;li&gt;ç¼ºä¹èº«ä»½å’Œè®¿é—®ç®¡ç†æœºåˆ¶&lt;/li&gt;
&lt;li&gt;åœ¨ OSI L3 è€Œé L7 è¿è¡Œçš„é˜²ç«å¢™ç­–ç•¥ï¼Œå› æ­¤æ— æ³•çª¥è§†æ•°æ®åŒ…æˆ–åšå‡ºå…ƒæ•°æ®é©±åŠ¨çš„å†³ç­–&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;æœåŠ¡ç½‘æ ¼å¡«è¡¥äº†-kubernetes-çš„å®‰å…¨æ¼æ´å¾®æœåŠ¡åº”ç”¨ç¨‹åºçš„å®‰å…¨å†…æ ¸&#34;&gt;æœåŠ¡ç½‘æ ¼å¡«è¡¥äº† Kubernetes çš„å®‰å…¨æ¼æ´ï¼šå¾®æœåŠ¡åº”ç”¨ç¨‹åºçš„å®‰å…¨å†…æ ¸&lt;/h2&gt;
&lt;p&gt;ä¸ºäº†å¢å¼º Kubernetes çš„å®‰å…¨æ€§ï¼ŒIstio å……å½“ NIST å‚è€ƒæ¶æ„ä¸­çš„å®‰å…¨å†…æ ¸ã€‚Istio æ»¡è¶³å‚è€ƒç›‘è§†å™¨çš„ä¸‰ä¸ªè¦æ±‚ï¼ˆNIST SP 800-204Bï¼ŒÂ§5.1ï¼‰ã€‚Istio æ˜¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸å¯æ—è·¯&lt;/li&gt;
&lt;li&gt;é˜²æ­¢ä¿®æ”¹&lt;/li&gt;
&lt;li&gt;éªŒè¯å’Œæµ‹è¯•æ˜¯æ­£ç¡®çš„&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Envoy æ•°æ®å¹³é¢é€šè¿‡æ¯ä¸ªæœåŠ¡å‰é¢ä»¥åŠæ¯ä¸ªå…¥å£å’Œå‡ºå£ç½‘å…³çš„ä¸å¯ç»•è¿‡çš„ç­–ç•¥æ‰§è¡Œç‚¹ (PEP) æä¾›å‚è€ƒç›‘è§†å™¨ã€‚æœåŠ¡ç½‘æ ¼ä»£ç ç‹¬ç«‹äºåº”ç”¨ç¨‹åºï¼Œå› æ­¤å®ƒçš„ç”Ÿå‘½å‘¨æœŸå¯ä»¥ç‹¬ç«‹ç®¡ç†ï¼Œå¹¶ä¸”ä¸èƒ½åœ¨è¿è¡Œæ—¶ä¿®æ”¹ã€‚è€Œä¸”ï¼Œç½‘æ ¼æ˜¯ç³»ç»Ÿçš„ä¸€ä¸ªä¸¥æ ¼æ§åˆ¶çš„å…ƒç´ ï¼Œå¯ä»¥é€šè¿‡æ›´å¤šçš„çœ¼ç›å’Œæ›´ä»”ç»†çš„æ£€æŸ¥æ¥å¼ºåŒ–ï¼ˆNIST SP 800-204Bï¼ŒÂ§5.1ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;è€Œä¸”ï¼Œä½œä¸ºä¸“ç”¨çš„åŸºç¡€æ¶æ„å±‚ï¼ŒIstio æä¾›ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è§£å†³&lt;strong&gt;æ¨ªåˆ‡åº”ç”¨ç¨‹åºé—®é¢˜çš„&lt;/strong&gt;ç»Ÿä¸€æ–¹æ³•ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¿«é€Ÿè§£å†³è¿™äº›é—®é¢˜çš„æ ‡å‡†æ’ä»¶&lt;/strong&gt;å’Œæ„å»ºè‡ªå®šä¹‰æ’ä»¶çš„æ¡†æ¶ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç®€åŒ–&lt;/strong&gt;æ“ä½œå¤æ‚æ€§ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ˜“äºç®¡ç†&lt;/strong&gt;ç¬¬ä¸‰æ–¹å¼€å‘äººå‘˜å’Œé›†æˆå•†ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é™ä½&lt;/strong&gt;å¼€å‘å’Œè¿è¥æˆæœ¬ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;ä¸‹ä¸€æ­¥&#34;&gt;ä¸‹ä¸€æ­¥&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;è¦ä»è”é‚¦å®‰å…¨æ ‡å‡†çš„åˆè‘—è€…é‚£é‡Œäº†è§£æœ‰å…³&lt;strong&gt;å¦‚ä½•å®æ–½é›¶ä¿¡ä»»æ¶æ„çš„æ›´å¤šä¿¡æ¯ï¼Œ&lt;/strong&gt;&lt;a href=&#34;https://tetr8.io/zta-wp&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è¯·é˜…è¯» Zack Butcher çš„é›¶ä¿¡ä»»æ¶æ„ç™½çš®ä¹¦&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æœ‰å…³ NIST å®‰å…¨å»ºè®®çš„æ·±å…¥æŒ‡å—ä»¥åŠ Tetrate å¦‚ä½•å¸®åŠ©æ‚¨å®æ–½è¯¥æ ‡å‡†ï¼Œè¯·æŸ¥çœ‹&lt;a href=&#34;https://tetr8.io/3Ccg6Qt&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tetrate çš„å¾®æœåŠ¡è”é‚¦å®‰å…¨è¦æ±‚æŒ‡å—&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¦‚æœæ‚¨æ­£åœ¨å¯»æ‰¾ä½¿ç”¨ Istio æŠ•å…¥ç”Ÿäº§çš„æœ€å¿«æ–¹å¼ï¼Œè¯·æŸ¥çœ‹æˆ‘ä»¬çš„å¼€æº&lt;a href=&#34;https://istio.tetratelabs.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tetrate Istio Distro (TID)&lt;/a&gt;ã€‚TID æ˜¯ç»è¿‡å®¡æŸ¥çš„ Istio ä¸Šæ¸¸å‘è¡Œç‰ˆ â€”â€”Istio çš„å¼ºåŒ–æ˜ åƒï¼Œå…·æœ‰æŒç»­æ”¯æŒï¼Œæ›´æ˜“äºå®‰è£…ã€ç®¡ç†å’Œå‡çº§ã€‚å¯¹äºåœ¨è”é‚¦ç›‘ç®¡ç¯å¢ƒä¸­è¿è¥çš„ç»„ç»‡ï¼ŒTetrate Istio Distro æ˜¯å”¯ä¸€&lt;a href=&#34;https://istio.tetratelabs.io/fips-request/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å…·æœ‰å¯ç”¨ FIPS éªŒè¯æ„å»º&lt;/a&gt;çš„ Istio å‘è¡Œç‰ˆã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæ‚¨éœ€è¦ä¸€ç§ç»Ÿä¸€ä¸”ä¸€è‡´çš„æ–¹å¼æ¥ä¿æŠ¤å’Œç®¡ç†ä¸€ç³»åˆ—åº”ç”¨ç¨‹åºä¸­çš„æœåŠ¡ï¼Œè¯·æŸ¥çœ‹ &lt;a href=&#34;https://tetrate.io/tetrate-service-bridge/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tetrate Service Bridge (TSB)&lt;/a&gt;ï¼Œè¿™æ˜¯æˆ‘ä»¬åŸºäº Istio å’Œ Envoy æ„å»ºçš„å…¨é¢çš„è¾¹ç¼˜åˆ°å·¥ä½œè´Ÿè½½åº”ç”¨ç¨‹åºè¿æ¥å¹³å°ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>é›¶ä¿¡ä»» Kubernetes å®‰å…¨çš„ä¸‰å¤§ mTLS æœ€ä½³å®è·µ</title>
      <link>https://lib.jimmysong.io/blog/top-3-mtls-best-practices-for-zero-trust-kubernetes-security/</link>
      <pubDate>Tue, 13 Dec 2022 10:00:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/top-3-mtls-best-practices-for-zero-trust-kubernetes-security/</guid>
      <description>&lt;p&gt;&lt;a href=&#34;https://kubernetes.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Kubernetes&lt;/a&gt; æ˜¯ç¼–æ’ç°ä»£äº‘åŸç”Ÿå·¥ä½œè´Ÿè½½çš„äº‹å®æ ‡å‡†ã€‚ä½†æ˜¯ï¼Œå®ƒä¸æä¾›å¼€ç®±å³ç”¨çš„å®‰å…¨é€šä¿¡ã€‚è¿™æ„å‘³ç€æ¯ä¸ªéœ€è¦å®æ–½ä¼ è¾“ä¸­åŠ å¯†ä»¥å¯¹å…¶ Kubernetes éƒ¨ç½²&lt;a href=&#34;https://tetr8.io/3FCXsDn&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;é‡‡ç”¨é›¶ä¿¡ä»»å®‰å…¨æ€åŠ¿çš„&lt;/a&gt;äººéƒ½éœ€è¦è‡ªå·±è§£å†³è¿™ä¸ªé—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;å¹¸è¿çš„æ˜¯ï¼Œæœ‰å¾ˆå¤šæ˜“äºç†è§£çš„æ–¹æ³•å¯ä»¥å®ç°ï¼Œåœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»åœ¨ Kubernetes ä¸­å®ç°åŒå‘ TLSï¼ˆmTLSï¼‰çš„ä¸‰å¤§æœ€ä½³å®è·µã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä»€ä¹ˆæ˜¯-mtlsä¸ºä»€ä¹ˆå¯¹å®‰å…¨æ¥è¯´å¾ˆé‡è¦&#34;&gt;ä»€ä¹ˆæ˜¯ mTLSï¼Œä¸ºä»€ä¹ˆå¯¹å®‰å…¨æ¥è¯´å¾ˆé‡è¦ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;ä¼ è¾“å±‚å®‰å…¨æ€§ï¼ˆSSL çš„åç»§è€…ï¼‰æ˜¯éƒ¨ç½²æœ€å¹¿æ³›çš„å®‰å…¨é€šä¿¡æ ‡å‡†ï¼Œåœ¨ HTTPS ä¸­æœ€ä¸ºæ˜æ˜¾ã€‚TLS éå¸¸é€‚åˆåœ¨éœ€è¦å‘å®¢æˆ·ç«¯è¯æ˜å…¶èº«ä»½çš„æœåŠ¡å™¨ä¹‹é—´å»ºç«‹æ—¢ä¿å¯†ï¼ˆé˜²çªƒå¬ï¼‰åˆçœŸå®ï¼ˆé˜²ç¯¡æ”¹ï¼‰çš„å®‰å…¨é€šä¿¡ã€‚ä½†æ˜¯ï¼Œåœ¨åŒæ–¹éƒ½éœ€è¦å‘å¯¹æ–¹è¯æ˜èº«ä»½çš„æƒ…å†µä¸‹ï¼ˆä¾‹å¦‚åœ¨ Kubernetes åº”ç”¨ç¨‹åºä¸­çš„å¾®æœåŠ¡ä¹‹é—´ï¼‰ï¼ŒTLS æ˜¯ä¸å¤Ÿçš„ã€‚&lt;/p&gt;
&lt;p&gt;è¿™å°±æ˜¯åŒå‘ TLS (mTLS) çš„ç”¨æ­¦ä¹‹åœ°ã€‚mTLS æ˜¯ TLSï¼Œä½†åŒæ–¹åœ¨å»ºç«‹å®‰å…¨é€šä¿¡é€šé“ä¹‹å‰å‘å¯¹æ–¹è¯æ˜è‡ªå·±çš„èº«ä»½ã€‚è¿™æ˜¯ Kubernetes ä¸­å®‰å…¨é€šä¿¡æ‰€éœ€çš„å¿…è¦éƒ¨åˆ†ã€‚mTLS æä¾›ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åœ¨çº¿åŠ å¯†ä»¥ç¡®ä¿æœºå¯†æ€§å’Œé˜²ç¯¡æ”¹&lt;/li&gt;
&lt;li&gt;ç›¸äº’çš„ã€åŠ å¯†çš„å®‰å…¨èº«ä»½è¯æ˜ä»¥ç¡®ä¿çœŸå®æ€§&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¦æ·±å…¥äº†è§£ mTLS çš„å·¥ä½œåŸç†ï¼Œè¯·å‚é˜…æˆ‘ä»¬å…³äº &lt;a href=&#34;https://tetr8.io/3NEcL0Q&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;mTLS çš„æ–‡ç« &lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;mtls-çš„å›°éš¾éƒ¨åˆ†è¯æ˜èº«ä»½&#34;&gt;mTLS çš„å›°éš¾éƒ¨åˆ†ï¼šè¯æ˜èº«ä»½&lt;/h2&gt;
&lt;p&gt;å›°éš¾çš„éƒ¨åˆ†æ˜¯ä¸ºæœåŠ¡å»ºç«‹ä¸€ä¸ªå®‰å…¨æœºåˆ¶æ¥å‘å½¼æ­¤è¯æ˜å®ƒä»¬çš„èº«ä»½ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºå¸¸è§„ TLSï¼Œè¿‡å»å¾ˆéš¾ç®¡ç†å‘å…¶å®¢æˆ·ç«¯è¯æ˜æœåŠ¡å™¨èº«ä»½çš„è¯ä¹¦ã€‚&lt;a href=&#34;https://letsencrypt.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;éšç€ Let&amp;rsquo;s Encrypt&lt;/a&gt; å’Œ &lt;a href=&#34;https://en.wikipedia.org/wiki/Automatic_Certificate_Management_Environment&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ACME åè®®&lt;/a&gt;çš„å‡ºç° ï¼Œè¿™å˜å¾—å®¹æ˜“å¤šäº†ã€‚ç„¶è€Œï¼Œåœ¨åƒ Kubernetes è¿™æ ·çš„åŠ¨æ€ï¼ˆå¹¶ä¸”ä¸»è¦æ˜¯ç§æœ‰çš„ï¼‰ç¯å¢ƒä¸­ç®¡ç†æœåŠ¡èº«ä»½å’Œè¯ä¹¦æ›´åŠ å›°éš¾ï¼Œå› ä¸ºæœ‰è®¸å¤šé€šå¸¸æ˜¯çŸ­æš‚çš„æœåŠ¡éœ€è¦å¼ºå¤§çš„ã€å¯è¯æ˜çš„èº«ä»½ï¼Œä½†å®é™…ä¸Šä¸èƒ½ä½¿ç”¨å…¬å…± ACME æœåŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;æ¨å‡ºè‡ªå·±çš„è‡ªåŠ¨åŒ–è¯ä¹¦ç®¡ç†ç³»ç»Ÿæ˜¯ä¸åˆ‡å®é™…ä¸”æœ‰é£é™©çš„ã€‚æ­£ç¡®ç®¡ç† mTLS è¯ä¹¦å¾ˆå›°éš¾ï¼Œé”™è¯¯çš„åæœå¾ˆä¸¥é‡ã€‚æ‚¨éœ€è¦ä¸€ç§å¯ä¿¡èµ–çš„ã€ç»è¿‡éªŒè¯çš„æ–¹æ³•æ¥åšåˆ°è¿™ä¸€ç‚¹ï¼›è¿™å°±æ˜¯æœåŠ¡ç½‘æ ¼çš„ç”¨æ­¦ä¹‹åœ°ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä½¿ç”¨æœåŠ¡ç½‘æ ¼nist-å¾®æœåŠ¡å®‰å…¨æ ‡å‡†&#34;&gt;ä½¿ç”¨æœåŠ¡ç½‘æ ¼ï¼ŒNIST å¾®æœåŠ¡å®‰å…¨æ ‡å‡†&lt;/h2&gt;
&lt;p&gt;åœ¨&lt;a href=&#34;https://tetr8.io/3zi85IC&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¾®æœåŠ¡å®‰å…¨æ ‡å‡†&lt;/a&gt;ä¸­ï¼Œç¾å›½å›½å®¶æ ‡å‡†ä¸æŠ€æœ¯ç ”ç©¶é™¢ (NIST) å»ºè®®ä½¿ç”¨æœåŠ¡ç½‘æ ¼ä½œä¸ºä¸“ç”¨åŸºç¡€è®¾æ–½å±‚æ¥æä¾›æ ¸å¿ƒç½‘ç»œå®‰å…¨åŠŸèƒ½ã€‚è¿™äº›æ ¸å¿ƒåŠŸèƒ½ä¹‹ä¸€æ˜¯æ”¯æŒ mTLS çš„å¼ºå¤§æœåŠ¡èº«ä»½å’Œè¯ä¹¦ç®¡ç†ã€‚è€Œä¸”ï¼ŒIstioâ€”â€”&lt;a href=&#34;https://tetr8.io/3UsARgY&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä½¿ç”¨æœ€å¹¿æ³›çš„æœåŠ¡ç½‘æ ¼&lt;/a&gt;â€”â€” ä¸ºæ‚¨æä¾›å¼€ç®±å³ç”¨çš„ mTLS æ”¯æŒã€‚Istio é€æ˜åœ°æä¾›åŸºç¡€è®¾æ–½ â€”â€” åŒ…æ‹¬å®‰å…¨å‘½åã€å¼ºå¤§çš„æœåŠ¡èº«ä»½å’Œè¯ä¹¦ç®¡ç† â€”â€” ç”¨äº Kubernetes å·¥ä½œè´Ÿè½½ä¹‹é—´çš„å®‰å…¨é€šä¿¡ä»¥åŠä¸å¤–ç•Œçš„è¿æ¥ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæ‚¨æƒ³è¯¦ç»†äº†è§£ NIST çš„å¾®æœåŠ¡å®‰å…¨æ ‡å‡†ä»¥åŠ Tetrate å¦‚ä½•å¸®åŠ©æ»¡è¶³è¿™äº›æ ‡å‡†ï¼Œè¯·æŸ¥çœ‹ &lt;a href=&#34;https://tetr8.io/3Ccg6Qt&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tetrate çš„å¾®æœåŠ¡è”é‚¦å®‰å…¨è¦æ±‚æŒ‡å—&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æœ€ä½³å®è·µä¸€ä¸è¦ä½¿ç”¨è‡ªç­¾åè¯ä¹¦&#34;&gt;æœ€ä½³å®è·µä¸€ï¼šä¸è¦ä½¿ç”¨è‡ªç­¾åè¯ä¹¦&lt;/h2&gt;
&lt;p&gt;è™½ç„¶ Istio å°†ä¸ºæ‚¨å®æ–½ mTLSï¼Œä½†å®ƒé»˜è®¤ä½¿ç”¨è‡ªç­¾åè¯ä¹¦ï¼Œå› æ­¤æ‚¨å¯ä»¥ç«‹å³çœ‹åˆ°ç½‘æ ¼å·¥ä½œï¼Œåªéœ€æœ€å°‘çš„é…ç½®ã€‚è¿™ä½¿å¾—åˆå§‹ç”¨æˆ·ä½“éªŒå˜å¾—ç®€å•ï¼Œä½†å®ƒå¹¶éä¸é€‚åˆç”Ÿäº§ç¯å¢ƒã€‚NIST çš„æŒ‡å—ï¼ˆNIST SP 800-204Aï¼ŒSM-DR12ï¼‰æ˜¯å®Œå…¨ç¦ç”¨ç”Ÿæˆè‡ªç­¾åè¯ä¹¦çš„èƒ½åŠ›ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æœ€ä½³å®è·µäºŒå°†-istio-çš„ä¿¡ä»»æ ¹æ¤äºç°æœ‰-pki&#34;&gt;æœ€ä½³å®è·µäºŒï¼šå°† Istio çš„ä¿¡ä»»æ ¹æ¤äºç°æœ‰ PKI&lt;/h2&gt;
&lt;p&gt;å¦‚æœä¸åº”è¯¥ä½¿ç”¨ Istio çš„é»˜è®¤è‡ªç­¾åè¯ä¹¦ï¼Œè¿˜æœ‰ä»€ä¹ˆé€‰æ‹©ï¼Ÿç®€çŸ­çš„å›ç­”æ˜¯ï¼Œæ‚¨åº”è¯¥ &lt;a href=&#34;https://tetr8.io/3DDcAOJ&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å°† Istio çš„ä¿¡ä»»æ ¹æ¤äºæ‚¨ç°æœ‰çš„å…¬é’¥åŸºç¡€è®¾æ–½ (PKI) ä¸­&lt;/a&gt;ã€‚è¿™å°†é€šè¿‡ç¡®ä¿å®ƒä»¬éƒ½å…·æœ‰ç›¸åŒçš„ä¿¡ä»»æ ¹æ¥å®ç°è·¨å…¶ä»–é›†ç¾¤ä¸­çš„ Istio éƒ¨ç½²çš„é€šä¿¡ã€‚è§‚çœ‹æˆ‘ä»¬å…³äº &lt;a href=&#34;https://www.youtube.com/watch?v=4b3H7isIAnQ&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä½¿ç”¨ Istio çš„å¤–éƒ¨ CA çš„è§†é¢‘ï¼Œäº†è§£æ›´å¤šä¿¡æ¯&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æœ€ä½³å®è·µä¸‰ä½¿ç”¨ä¸­é—´è¯ä¹¦&#34;&gt;æœ€ä½³å®è·µä¸‰ï¼šä½¿ç”¨ä¸­é—´è¯ä¹¦&lt;/h2&gt;
&lt;p&gt;ç¡®åˆ‡åœ°è¯´ï¼Œæ‚¨å¦‚ä½•è®© Istio ä¿¡ä»»æ‚¨ç°æœ‰çš„ PKIï¼ŸTetrate çš„åˆ›å§‹å·¥ç¨‹å¸ˆå’Œ NIST å¾®æœåŠ¡å®‰å…¨æ ‡å‡†çš„åˆè‘—è€… Zack Butcher &lt;a href=&#34;https://tetr8.io/3DDcAOJ&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;åœ¨æ­¤å¤„æä¾›äº†æ‰€æœ‰è¯¦ç»†ä¿¡æ¯&lt;/a&gt;ã€‚ä½†æ˜¯ï¼Œç®€è€Œè¨€ä¹‹ï¼Œæˆ‘ä»¬çš„å»ºè®®æ˜¯ä½¿ç”¨æ‚¨ç»„ç»‡çš„æ ¹è¯ä¹¦é¢å‘æœºæ„é¢å‘çš„ä¸­é—´è¯ä¹¦ã€‚è¿™å°†ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å…è®¸ç»†ç²’åº¦çš„è¯ä¹¦æ’¤é”€ï¼Œè€Œæ— éœ€åŒæ—¶åœ¨æ•´ä¸ªåŸºç¡€æ¶æ„ä¸­å¼ºåˆ¶ä½¿ç”¨æ–°è¯ä¹¦ã€‚&lt;/li&gt;
&lt;li&gt;å¯ç”¨ç­¾åè¯ä¹¦çš„è½»æ¾è½®æ¢ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æœ‰å…³å¦‚ä½•è‡ªåŠ¨åŒ– Istio è¯ä¹¦é¢å‘æœºæ„ (CA) è½®æ¢çš„åˆ†æ­¥è¯´æ˜ï¼Œè¯·å‚é˜…æˆ‘ä»¬å…³äº &lt;a href=&#34;https://tetrate.io/blog/automate-istio-ca-rotation-in-production-at-scale/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;åœ¨å¤§è§„æ¨¡ç”Ÿäº§ä¸­è‡ªåŠ¨åŒ– Istio CA è½®æ¢çš„&lt;/a&gt;æ–‡ç« ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä¸‹ä¸€æ­¥&#34;&gt;ä¸‹ä¸€æ­¥&lt;/h2&gt;
&lt;p&gt;å¦‚æœæ‚¨ä¸ç†Ÿæ‚‰æœåŠ¡ç½‘æ ¼å’Œ Kubernetes å®‰å…¨æ€§ï¼Œæˆ‘ä»¬åœ¨ &lt;a href=&#34;https://tetr8.io/academy&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tetrate Academy&lt;/a&gt; æä¾›ä¸€ç³»åˆ—å…è´¹åœ¨çº¿è¯¾ç¨‹ ï¼Œå¯ä»¥è®©æ‚¨å¿«é€Ÿäº†è§£ Istio å’Œ Envoyã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæ‚¨æ­£åœ¨å¯»æ‰¾ä¸€ç§å¿«é€Ÿå°† Istio æŠ•å…¥ç”Ÿäº§çš„æ–¹æ³•ï¼Œè¯·æŸ¥çœ‹ &lt;a href=&#34;https://tetr8.io/tid&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tetrate Istio Distribution (TID)&lt;/a&gt;ã€‚TID æ˜¯ Tetrate çš„å¼ºåŒ–ã€å®Œå…¨ä¸Šæ¸¸çš„ Istio å‘è¡Œç‰ˆï¼Œå…·æœ‰ç»è¿‡ FIPS éªŒè¯çš„æ„å»ºå’Œæ”¯æŒã€‚è¿™æ˜¯å¼€å§‹ä½¿ç”¨ Istio çš„å¥½æ–¹æ³•ï¼Œå› ä¸ºæ‚¨çŸ¥é“æ‚¨æœ‰ä¸€ä¸ªå€¼å¾—ä¿¡èµ–çš„å‘è¡Œç‰ˆï¼Œæœ‰ä¸€ä¸ªæ”¯æŒæ‚¨çš„ä¸“å®¶å›¢é˜Ÿï¼Œå¹¶ä¸”å¦‚æœéœ€è¦ï¼Œè¿˜å¯ä»¥é€‰æ‹©å¿«é€Ÿè·å¾— FIPS åˆè§„æ€§ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€æ—¦å¯åŠ¨å¹¶è¿è¡Œ Istioï¼Œæ‚¨å¯èƒ½éœ€è¦æ›´ç®€å•çš„æ–¹æ³•æ¥ç®¡ç†å’Œä¿æŠ¤æ‚¨çš„æœåŠ¡ï¼Œè€Œä¸ä»…ä»…æ˜¯ Istio ä¸­å¯ç”¨çš„æ–¹æ³•ï¼Œè¿™å°±æ˜¯ Tetrate Service Bridge çš„ç”¨æ­¦ä¹‹åœ°ã€‚æ‚¨å¯ä»¥&lt;a href=&#34;https://tetr8.io/tsb&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;åœ¨è¿™é‡Œ&lt;/a&gt;è¯¦ç»†äº†è§£ Tetrate Service Bridge å¦‚ä½•ä½¿æœåŠ¡ç½‘æ ¼æ›´å®‰å…¨ã€æ›´æ˜“äºç®¡ç†å’Œå¼¹æ€§ï¼Œæˆ–&lt;a href=&#34;https://tetr8.io/contact&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è”ç³»æˆ‘ä»¬è¿›è¡Œå¿«é€Ÿæ¼”ç¤º&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ›´å¤šèµ„æº&#34;&gt;æ›´å¤šèµ„æº&lt;/h2&gt;
&lt;p&gt;è§‚çœ‹æˆ‘ä»¬çš„è§†é¢‘ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.youtube.com/watch?v=4b3H7isIAnQ&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä½¿ç”¨ Istio çš„å¤–éƒ¨ CA&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.youtube.com/watch?v=nYJJ57WCkxE&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Istio Ingress Gateway ä¸­çš„ SSL è¯ä¹¦&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.youtube.com/watch?v=o8AnLk4Da7M&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¦‚ä½•å°†æœåŠ¡ç½‘æ ¼ç”¨äºæ··åˆäº‘å’Œé—ç•™å·¥ä½œè´Ÿè½½&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.youtube.com/watch?v=mHR7rR83KjM&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¦‚ä½•å°† VM å·¥ä½œè´Ÿè½½è¿æ¥åˆ°ç½‘æ ¼&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.youtube.com/watch?v=E_D4bjvX8Xw&amp;amp;t=2s&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tetrate å¦‚ä½•å¸®åŠ©ç¾å›½å›½é˜²éƒ¨å°† Istio ç”¨äºé›¶ä¿¡ä»»æ¶æ„&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>ä½¿ç”¨ Envoy Gateway 0.2 ä½“éªŒæ–°çš„ Kubernetes Gateway API</title>
      <link>https://lib.jimmysong.io/blog/hands-on-with-envoy-gateway/</link>
      <pubDate>Thu, 27 Oct 2022 16:00:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/hands-on-with-envoy-gateway/</guid>
      <description>&lt;p&gt;åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†äº²èº«ä½“éªŒ &lt;a href=&#34;https://github.com/envoyproxy/gateway&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Envoy Gateway&lt;/a&gt; å’Œ &lt;a href=&#34;https://gateway-api.sigs.k8s.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Gateway API&lt;/a&gt;ã€‚ä»¥ä¸‹æ˜¯é€æ­¥æŒ‡å¯¼ä½ å®‰è£… Envoy Gateway çš„è¯´æ˜ï¼Œä»¥åŠé€šè¿‡ Envoy ä»£ç†åœ¨é›†ç¾¤å¤–å…¬å¼€ HTTP åº”ç”¨ç¨‹åºçš„ç®€å•ç”¨ä¾‹ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ ä¸æ–¹ä¾¿è¿è¡Œï¼Œæˆ‘åœ¨æœ¬æ–‡ä¸­åŒ…å«äº†æ¯ä¸ªå‘½ä»¤çš„è¾“å‡ºï¼Œå³ä½¿ä½ æ²¡æœ‰ Kubernetes é›†ç¾¤ä¹Ÿå¯ä»¥çœ‹åˆ°å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ æ˜¯ GUI çš„ç²‰ä¸ï¼Œåœ¨æ–‡ç« çš„æœ€åæˆ‘ä¼šé™„ä¸Š Tetrate åŸºäº &lt;a href=&#34;https://backstage.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Backstage&lt;/a&gt; çš„æ¦‚å¿µéªŒè¯ &lt;a href=&#34;https://github.com/tetratelabs/eg-backstage-demo&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Envoy Gateway GUI&lt;/a&gt; çš„å±å¹•æˆªå›¾å’Œè¯¦ç»†ä¿¡æ¯ï¼Œä»¥å±•ç¤ºé’ˆå¯¹ Gateway API æ„å»ºæ­¤ç±»ä¸œè¥¿æ˜¯å¤šä¹ˆå®¹æ˜“ã€‚&lt;/p&gt;
&lt;h2 id=&#34;åˆ›å»º-kubernetes-é›†ç¾¤&#34;&gt;åˆ›å»º Kubernetes é›†ç¾¤&lt;/h2&gt;
&lt;p&gt;é¦–å…ˆè¿è¡Œ Envoy Gateway å’Œ Kubernetes é›†ç¾¤ã€‚æœ€ç®€å•ã€æœ€å®‰å…¨çš„æ–¹æ³•æ˜¯ä½¿ç”¨ &lt;a href=&#34;https://minikube.sigs.k8s.io/docs/start/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;minikube&lt;/a&gt; åœ¨æœ¬åœ°æœºå™¨ä¸Šå¯åŠ¨é›†ç¾¤ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ minikube start â€“driver&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;docker --cpus&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; --memory&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;2g
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ğŸ˜„  minikube v1.27.0 on Arch 22.0.0 &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;x86_64&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	â–ª &lt;span class=&#34;nv&#34;&gt;KUBECONFIG&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;...
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;â—  For more information, see: https://github.com/kubernetes/kubernetes/issues/112135
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ğŸ“Œ  Using Docker Desktop driver with root privileges
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ğŸ‘  Starting control plane node minikube in cluster minikube
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ğŸšœ  Pulling base image ...
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ğŸ”¥  Creating docker container &lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;CPUs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;2, &lt;span class=&#34;nv&#34;&gt;Memory&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;2048MB&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; ...
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ğŸ³  Preparing Kubernetes v1.25.2 on Docker 20.10.17 ...
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	â–ª Generating certificates and keys ...
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	â–ª Booting up control plane ...
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	â–ª Configuring RBAC rules ...
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ğŸ”  Verifying Kubernetes components...
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	â–ª Using image gcr.io/k8s-minikube/storage-provisioner:v5
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ğŸŒŸ  Enabled addons: storage-provisioner
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ğŸ„  Done! kubectl is now configured to use &lt;span class=&#34;s2&#34;&gt;&amp;#34;minikube&amp;#34;&lt;/span&gt; cluster and &lt;span class=&#34;s2&#34;&gt;&amp;#34;default&amp;#34;&lt;/span&gt; namespace by default
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;å®‰è£…-envoy-gateway&#34;&gt;å®‰è£… Envoy Gateway&lt;/h2&gt;
&lt;p&gt;å›æƒ³ä¸€ä¸‹ï¼ŒEnvoy Gateway æ˜¯ç”±æ–°çš„ Gateway API é…ç½®çš„ï¼Œè€Œä¸æ˜¯æ—§çš„ Ingress APIã€‚Gateway API å°šæœªåˆå¹¶åˆ°ä¸Šæ¸¸ Kubernetesï¼Œå› æ­¤æˆ‘ä»¬çš„é›†ç¾¤å°†æ— æ³•ä½¿ç”¨å®ƒã€‚æˆ‘ä»¬é€šè¿‡ä¸ºå…¶éƒ¨ç½² CRD æ¥å®‰è£…è¯¥ APIã€‚Envoy Gateway é¡¹ç›®æä¾›äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œç”¨äºå®‰è£… Gateway API å’Œéƒ¨ç½² Envoy Gatewayã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ kubectl apply -f https://github.com/envoyproxy/gateway/releases/download/v0.2.0/install.yaml
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™ä¼šäº§ç”Ÿå¤§é‡èµ„æºï¼Œæˆ‘å°†åˆ†å‡ ä¸ªéƒ¨åˆ†ä¸­è®¨è®ºå®ƒä»¬ã€‚é¦–å…ˆæ˜¯ Gateway APIï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;customresourcedefinition.apiextensions.k8s.io/gatewayclasses.gateway.networking.k8s.io created
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;customresourcedefinition.apiextensions.k8s.io/gateways.gateway.networking.k8s.io created
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;customresourcedefinition.apiextensions.k8s.io/httproutes.gateway.networking.k8s.io created
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;customresourcedefinition.apiextensions.k8s.io/referencegrants.gateway.networking.k8s.io created
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;customresourcedefinition.apiextensions.k8s.io/referencepolicies.gateway.networking.k8s.io created
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;customresourcedefinition.apiextensions.k8s.io/tcproutes.gateway.networking.k8s.io created
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;customresourcedefinition.apiextensions.k8s.io/tlsroutes.gateway.networking.k8s.io created
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;customresourcedefinition.apiextensions.k8s.io/udproutes.gateway.networking.k8s.io created
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;namespace/gateway-system created
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;validatingwebhookconfiguration.admissionregistration.k8s.io/gateway-api-admission created
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;service/gateway-api-admission-server created
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;deployment.apps/gateway-api-admission-server created
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;serviceaccount/gateway-api-admission created
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;clusterrole.rbac.authorization.k8s.io/gateway-api-admission created
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;clusterrolebinding.rbac.authorization.k8s.io/gateway-api-admission created
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;role.rbac.authorization.k8s.io/gateway-api-admission created
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;rolebinding.rbac.authorization.k8s.io/gateway-api-admission created
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;job.batch/gateway-api-admission created
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;job.batch/gateway-api-admission-patch created
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¦‚ä½ æ‰€è§ï¼Œä¸»è¦æ˜¯ CRDã€‚ä½†è¯·æ³¨æ„ï¼Œå®‰è£… Gateway API è¿˜éƒ¨ç½²äº†ä¸€äº›å·¥ä½œè´Ÿè½½èµ„æºï¼ŒåŒ…æ‹¬ Deployment ç­‰ â€”â€”Gateway API å¸¦æœ‰ä¸€ä¸ª webhook å‡†å…¥æ§åˆ¶å™¨æ¥éªŒè¯æˆ‘ä»¬éƒ¨ç½²çš„èµ„æºï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ kubectl get pods --namespace gateway-system
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;NAME                                        	READY   STATUS  	RESTARTS   AGE
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;gateway-api-admission-2dhk5                 	0/1 	Completed   &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;      	70s
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;gateway-api-admission-patch-dbdbc           	0/1 	Completed   &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;      	70s
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;gateway-api-admission-server-68485ffc97-gt8v4   1/1 	Running 	&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;      	70s
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ·»åŠ åˆ°é›†ç¾¤ API ä¸­çš„æ–° CRDï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ kubectl api-resources &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; grep gateway.networking
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;gatewayclasses                	gc       	gateway.networking.k8s.io/v1beta1  	&lt;span class=&#34;nb&#34;&gt;false&lt;/span&gt;    	GatewayClass
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;gateways                      	gtw      	gateway.networking.k8s.io/v1beta1  	&lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt;     	Gateway
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;httproutes                                 	gateway.networking.k8s.io/v1beta1  	&lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt;     	HTTPRoute
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;referencegrants               	refgrant 	gateway.networking.k8s.io/v1alpha2 	&lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt;     	ReferenceGrant
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;referencepolicies             	refpol   	gateway.networking.k8s.io/v1alpha2 	&lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt;     	ReferencePolicy
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;tcproutes                                  	gateway.networking.k8s.io/v1alpha2 	&lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt;     	TCPRoute
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;tlsroutes                                  	gateway.networking.k8s.io/v1alpha2 	&lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt;     	TLSRoute
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;udproutes                                  	gateway.networking.k8s.io/v1alpha2 	&lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt;     	UDPRoute
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¸‹é¢æ˜¯ Envoy Gateway æœ¬èº«ã€‚&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;namespace/envoy-gateway-system created
customresourcedefinition.apiextensions.k8s.io/envoyproxies.config.gateway.envoyproxy.io created
serviceaccount/envoy-gateway created
role.rbac.authorization.k8s.io/leader-election-role created
clusterrole.rbac.authorization.k8s.io/envoy-gateway-role created
clusterrole.rbac.authorization.k8s.io/metrics-reader created
clusterrole.rbac.authorization.k8s.io/proxy-role created
rolebinding.rbac.authorization.k8s.io/leader-election-rolebinding created
clusterrolebinding.rbac.authorization.k8s.io/envoy-gateway-rolebinding created
clusterrolebinding.rbac.authorization.k8s.io/proxy-rolebinding created
configmap/envoy-gateway-config created
service/envoy-gateway created
service/envoy-gateway-metrics-service created
deployment.apps/envoy-gateway created
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¿™äº›æ˜¯å·¥ä½œè´Ÿè½½èµ„æºä»¥åŠç›¸å…³çš„å®‰å…¨å’Œç½‘ç»œã€‚ç‰‡åˆ»ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ­£åœ¨è¿è¡Œçš„æ§åˆ¶å™¨ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ kubectl get pods --namespace envoy-gateway-system
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;NAME                        	READY   STATUS	RESTARTS   AGE
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;envoy-gateway-dc74c4d97-pntbj   2/2 	Running   &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;      	35s
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;å®‰è£…æµ‹è¯•åº”ç”¨&#34;&gt;å®‰è£…æµ‹è¯•åº”ç”¨&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬è¿˜éœ€è¦ä¸€äº›ä¸œè¥¿è®©ç½‘å…³çœŸæ­£å°†æµé‡è½¬å‘åˆ° â€”â€” å°±åƒæˆ‘ä»¬çš„ä¸€ä¸ªåº”ç”¨ç¨‹åºä¸€æ ·çš„ä¸œè¥¿ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ httpbinï¼ŒEnvoy Gateway é¡¹ç›®æä¾›äº†æ–¹ä¾¿çš„æ¸…å•ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ kubectl apply -f https://raw.githubusercontent.com/istio/istio/master/samples/httpbin/httpbin.yaml
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;serviceaccount/httpbin created
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;service/httpbin created
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;deployment.apps/httpbin created
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™å°†åœ¨é»˜è®¤å‘½åç©ºé—´ä¸­è¿è¡Œï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ kubectl get pods -n default
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;NAME                    	READY   STATUS	RESTARTS   AGE
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;httpbin-9dbd644c7-fhtw5 	1/1 	Running   &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;      	4m16s
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;é…ç½®-envoy-gateway&#34;&gt;é…ç½® Envoy Gateway&lt;/h2&gt;
&lt;p&gt;ç°åœ¨æˆ‘ä»¬å¯ä»¥ç»§ç»­é…ç½® Envoy Gateway ä»¥æ‰§è¡Œä¸€äº›è¯·æ±‚è·¯ç”±ã€‚æˆ‘ä»¬éœ€è¦åšçš„ç¬¬ä¸€ä»¶äº‹æ˜¯æ³¨å†Œæˆ‘ä»¬åˆšåˆšéƒ¨ç½²çš„ Envoy Gateway æ§åˆ¶å™¨ï¼Œä»¥ä¾¿å…¶ä»–èµ„æºå¯ä»¥å¼•ç”¨å®ƒæ¥è¯†åˆ«é…ç½®çš„ç½‘å…³ï¼Œä»¥é˜²ä½ åœ¨ä¸€ä¸ªé›†ç¾¤ä¸­éƒ¨ç½²å¤šä¸ªç½‘å…³ã€‚ &lt;code&gt;controllerName&lt;/code&gt; å­—æ®µåŒ¹é…æ§åˆ¶å™¨å‘å…¶è¿è¡Œçš„ Kubernetes é›†ç¾¤æ³¨å†Œçš„å€¼ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ kubectl apply -f - &lt;span class=&#34;s&#34;&gt;&amp;lt;&amp;lt;EOF
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;apiVersion: gateway.networking.k8s.io/v1beta1
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;kind: GatewayClass
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;metadata:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  name: my-envoy-gateway
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;spec:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  controllerName: gateway.envoyproxy.io/gatewayclass-controller
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;EOF&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;gatewayclass.gateway.networking.k8s.io/eg created
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…³äºè¿™ä¸ªæ–°å®ä¾‹çš„ä¸€äº›æœ‰é™ä¿¡æ¯ï¼Œå‡è®¾æˆ‘ä»¬çš„æè¿°æ˜¯æœ‰æ•ˆçš„ï¼Œæˆ‘ä»¬å°†çœ‹åˆ° &lt;code&gt;ACCEPTED: True&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ kubectl get gatewayclass -o wide
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;NAME   CONTROLLER                                  	ACCEPTED   AGE 	DESCRIPTION
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;eg 	gateway.envoyproxy.io/gatewayclass-controller   True   	2m38s  
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬é…ç½®ä¸€ä¸ª Gateway å¯¹è±¡ â€”â€” è¿™å°†æ‰“å¼€æˆ‘ä»¬å¸Œæœ› Envoy ä»£ç†ç›‘å¬çš„ç½‘ç»œç«¯å£ã€‚å¯¹äºè¿™ä¸ªç®€å•çš„æ¼”ç¤ºï¼Œæˆ‘ä»¬å°†ç»‘å®šåˆ°ä¸€ä¸ªç«¯å£è€Œä¸ä½¿ç”¨ TLSï¼Œå› æ­¤æˆ‘å°†å…¶ç§°ä¸º â€œä¸å®‰å…¨ç«¯å£â€ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ kubectl apply -f - &lt;span class=&#34;s&#34;&gt;&amp;lt;&amp;lt;EOF
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;apiVersion: gateway.networking.k8s.io/v1beta1
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;kind: Gateway
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;metadata:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  name: insecure-port
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;spec:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  gatewayClassName: my-envoy-gateway
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  listeners:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    - name: http
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;      protocol: HTTP
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;      port: 8080
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;EOF&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å½“æˆ‘ä»¬æ£€æŸ¥å®ƒæ—¶ï¼Œæˆ‘ä»¬ä¼šå‘ç°å®ƒå¹¶æ²¡æœ‰å°±ç»ªã€‚ç”±äºæˆ‘ä»¬ä½¿ç”¨çš„æœ¬åœ°å¼€å‘é›†ç¾¤æ— æ³•ä½¿è¿™ç§äº‘è´Ÿè½½å‡è¡¡å™¨æˆä¸º â€œçœŸæ­£çš„â€ è´Ÿè½½å‡è¡¡å™¨ï¼ˆå› æ­¤åœ°å€å­—æ®µä¹Ÿæ˜¯ç©ºçš„ï¼‰ï¼Œå› æ­¤è¯¥æ‰¹å‡†è¢«æç½®ã€‚ä¸ç”¨æ‹…å¿ƒè¿™ä¸ªï¼Œå®ƒä»ç„¶å¯ä»¥æ­£å¸¸å·¥ä½œã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ kubectl -n default get gateway -o wide
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;NAME        	CLASS             ADDRESS   READY   AGE
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;insecure-port   my-envoy-gateway                     2m54s
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æœ€åï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºä¸€äº› HTTP æµé‡è®¾ç½®è·¯ç”±ã€‚åœ¨è¿™ä¸ªç®€å•çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬åŒ¹é…ä»»ä½•è·¯å¾„ä¸Šå¯¹ vhost &lt;code&gt;www.example.com&lt;/code&gt; çš„ä»»ä½•è¯·æ±‚ï¼Œå¹¶å°†å…¶å‘é€åˆ°æˆ‘ä»¬ä¹‹å‰éƒ¨ç½²çš„ httpbin å®ä¾‹ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ kubectl apply -f - &lt;span class=&#34;s&#34;&gt;&amp;lt;&amp;lt;EOF
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;apiVersion: gateway.networking.k8s.io/v1beta1
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;kind: HTTPRoute
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;metadata:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  name: httpbin
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;spec:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  parentRefs: [ {name: insecure-port} ]
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  hostnames: [&amp;#34;www.example.com&amp;#34;]
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  rules:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    - matches:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;        - path: {type: PathPrefix, value: /}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;      backendRefs:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;        - {group: &amp;#34;&amp;#34;, kind: Service, name: httpbin, port: 8000, weight: 1}
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;EOF&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;httproute.gateway.networking.k8s.io/httpbin created
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ£€æŸ¥è¿™ç§èµ„æºç›®å‰å¹¶æ²¡æœ‰å‘æˆ‘ä»¬å±•ç¤ºå¤ªå¤šä¸œè¥¿ï¼Œä½†æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®ƒè‡³å°‘å·²éƒ¨ç½²æˆåŠŸã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ kubectl get httproute -n default -o wide
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;NAME   	HOSTNAMES         	AGE
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;httpbin	&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;www.example.com&amp;#34;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;   58s
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æœ€åè¦æ³¨æ„çš„ä¸€ä»¶äº‹æ˜¯ï¼Œç›´åˆ°ç°åœ¨æ‰çœŸæ­£å¯åŠ¨äº† Envoy çš„å®ä¾‹ï¼ˆä¹‹å‰å®ƒåªæ˜¯æ§åˆ¶å™¨ï¼Œå®ƒæœ¬èº«å¹¶ä¸å¤„ç†æµé‡ï¼‰ã€‚è¿™æ˜¯ä»£è¡¨ Envoy Gateway çš„ä¼˜åŒ–ï¼šä»£ç†çš„æ‡’åˆ›å»ºã€‚æ£€æŸ¥ç³»ç»Ÿä¸Šçš„ &lt;code&gt;age&lt;/code&gt; å­—æ®µï¼Œçœ‹çœ‹å®ƒçš„åˆ›å»ºæ—¶é—´ã€‚&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;$ kubectl get pods -n envoy-gateway-system
NAME                        	READY   STATUS	RESTARTS   AGE
envoy-default-insecure-port-5879556bd4-r5ggw   	1/1 	Running   0      	90s
envoy-gateway-dc74c4d97-pntbj   2/2 	Running   0      	13m
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;å¯åŠ¨æµ‹è¯•æµé‡&#34;&gt;å¯åŠ¨æµ‹è¯•æµé‡&lt;/h2&gt;
&lt;p&gt;å°±åƒæˆ‘ä¹‹å‰è¯´çš„ï¼Œæˆ‘ä»¬æ— æ³•è·å¾—çœŸæ­£çš„äº‘è´Ÿè½½å‡è¡¡å™¨ï¼Œå› ä¸ºæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯æœ¬åœ°å¼€å‘é›†ç¾¤ã€‚ä½†æ˜¯ minikube æœ‰ä¸€ä¸ªç®€æ´çš„ç‰¹æ€§ï¼Œå®ƒå°†é›†ç¾¤çš„æœåŠ¡æš´éœ²ç»™æˆ‘ä»¬çš„æœ¬åœ°æœºå™¨ â€”â€” åŒ…æ‹¬ Envoy Gateway å¯åŠ¨çš„ä»£ç†ã€‚æˆ‘ä»¬æ‰“å¼€çš„ 8080 ç«¯å£å°†åœ¨å›ç¯ä¸­å¯ç”¨ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ minikube tunnel
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¯¥å‘½ä»¤ä¼šé˜»å¡ï¼Œå› æ­¤æ ¹æ®æˆ‘ä»¬éƒ¨ç½²çš„è§„åˆ™ï¼Œæ‰“å¼€ä¸€ä¸ªæ–°ç»ˆç«¯ä»¥å‘é€å°†è¢«è·¯ç”±åˆ° httpbin çš„è¯·æ±‚ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ curl --header &lt;span class=&#34;s2&#34;&gt;&amp;#34;Host: www.example.com&amp;#34;&lt;/span&gt; 127.0.0.1:8080/headers
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;HTTP/1.1 &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;server: envoy
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;date: Fri, &lt;span class=&#34;m&#34;&gt;07&lt;/span&gt; Oct &lt;span class=&#34;m&#34;&gt;2022&lt;/span&gt; 12:41:32 GMT
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;content-type: application/json
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;content-length: &lt;span class=&#34;m&#34;&gt;175&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;access-control-allow-origin: *
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;access-control-allow-credentials: &lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;x-envoy-upstream-service-time: &lt;span class=&#34;m&#34;&gt;14&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;s2&#34;&gt;&amp;#34;headers&amp;#34;&lt;/span&gt;: &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    	&lt;span class=&#34;s2&#34;&gt;&amp;#34;Accept&amp;#34;&lt;/span&gt;: &lt;span class=&#34;s2&#34;&gt;&amp;#34;application/json, */*&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    	&lt;span class=&#34;s2&#34;&gt;&amp;#34;Host&amp;#34;&lt;/span&gt;: &lt;span class=&#34;s2&#34;&gt;&amp;#34;www.example.com&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    	&lt;span class=&#34;s2&#34;&gt;&amp;#34;User-Agent&amp;#34;&lt;/span&gt;: &lt;span class=&#34;s2&#34;&gt;&amp;#34;curl/7.79.1&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    	&lt;span class=&#34;s2&#34;&gt;&amp;#34;X-Envoy-Expected-Rq-Timeout-Ms&amp;#34;&lt;/span&gt;: &lt;span class=&#34;s2&#34;&gt;&amp;#34;15000&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™åªæ˜¯ä¸€ä¸ªç®€å•çš„æ¼”ç¤ºï¼Œä½†ä½ å¯ä»¥æ¢ç´¢ Gateway API çš„å…¶ä½™éƒ¨åˆ†å¹¶å¼€å§‹ä½¿ç”¨æ›´å¤šåŠŸèƒ½ â€”â€”Envoy Gateway çš„æ–‡æ¡£å°†æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æŒ‡å—ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç¤ºä¾‹-gui&#34;&gt;ç¤ºä¾‹ GUI&lt;/h2&gt;
&lt;p&gt;æˆ‘ç»™å‡ºçš„è¯´æ˜æ˜¯é’ˆå¯¹å‘½ä»¤è¡Œçš„ï¼Œä½†æ˜¯å¥½çš„ GUI æ˜¯ä¸ä»»ä½•ç³»ç»Ÿäº¤äº’çš„å¥½æ–¹æ³•ã€‚Envoy Gateway å¯¹æ ‡å‡† Gateway API çš„å®æ–½æä¾›äº†äº¤äº’æ“ä½œæ¥å£ç”Ÿæ€ç³»ç»Ÿã€‚Tetrate ä½¿ç”¨ &lt;a href=&#34;https://backstage.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Backstage&lt;/a&gt;ï¼ˆå¼€å‘è€…æ¥å£çš„æ–°å…´æ ‡å‡†ï¼‰ä¸º Envoy Gateway æ„å»ºäº†ä¸€ä¸ªæ¦‚å¿µéªŒè¯ UIã€‚ä¸‹é¢æˆ‘å°†å±•ç¤ºå‡ ä¸ªä»ä¸Šé¢æ£€æŸ¥æ¼”ç¤ºè®¾ç½®çš„å±å¹•æˆªå›¾ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ æƒ³ç©è¿™ä¸ªï¼Œæˆ–è€…forkå®ƒï¼Œ&lt;a href=&#34;https://github.com/tetratelabs/eg-backstage-demo&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æˆ‘ä»¬å·²ç»å‘å¸ƒäº†ä»£ç &lt;/a&gt;â€”â€” ç›®å‰è¿˜æ˜¯ alpha ç‰ˆæœ¬ï¼Œå¹¶ä¸”åªæ˜¯ä¸€ä¸ªå¯ä»¥åœ¨ä¸€å‘¨å†…æ„å»ºçš„ç¤ºä¾‹ï¼å¦‚æœä½ åœ¨ KubeCon Detroitï¼Œè¯·åˆ°æˆ‘ä»¬çš„å±•ä½ï¼Œæˆ‘ä»¬å¯ä»¥äº²è‡ªå‘ä½ å±•ç¤ºï¼&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-ui-for-envoy-gateway&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;UI for Envoy Gateway&#34; srcset=&#34;
               /blog/hands-on-with-envoy-gateway/008vxvgGgy1h7jx53ycsgj30wi0p5ab7_hu689b07b397da5e05e9f1b674f65414e1_51052_9a196803d3b23504cc8650ee9527f7c8.webp 400w,
               /blog/hands-on-with-envoy-gateway/008vxvgGgy1h7jx53ycsgj30wi0p5ab7_hu689b07b397da5e05e9f1b674f65414e1_51052_fd90718fd137327924214ed018002b27.webp 760w,
               /blog/hands-on-with-envoy-gateway/008vxvgGgy1h7jx53ycsgj30wi0p5ab7_hu689b07b397da5e05e9f1b674f65414e1_51052_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/hands-on-with-envoy-gateway/008vxvgGgy1h7jx53ycsgj30wi0p5ab7_hu689b07b397da5e05e9f1b674f65414e1_51052_9a196803d3b23504cc8650ee9527f7c8.webp&#34;
               width=&#34;760&#34;
               height=&#34;588&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      UI for Envoy Gateway
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-backstage-ç•Œé¢&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Backstage ç•Œé¢&#34; srcset=&#34;
               /blog/hands-on-with-envoy-gateway/008vxvgGgy1h7jx54gkz4j30wi0p5wg9_hueb9d88ccfd6f67d8609221003ea0eda6_71957_ab2cfc6e4ca0d867e96968f32f2c131a.webp 400w,
               /blog/hands-on-with-envoy-gateway/008vxvgGgy1h7jx54gkz4j30wi0p5wg9_hueb9d88ccfd6f67d8609221003ea0eda6_71957_8e698775b6b232c5f13516ae26a83f51.webp 760w,
               /blog/hands-on-with-envoy-gateway/008vxvgGgy1h7jx54gkz4j30wi0p5wg9_hueb9d88ccfd6f67d8609221003ea0eda6_71957_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/hands-on-with-envoy-gateway/008vxvgGgy1h7jx54gkz4j30wi0p5wg9_hueb9d88ccfd6f67d8609221003ea0eda6_71957_ab2cfc6e4ca0d867e96968f32f2c131a.webp&#34;
               width=&#34;760&#34;
               height=&#34;588&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      Backstage ç•Œé¢
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ æ­£åœ¨å¼€å§‹ä½¿ç”¨ Istio å’Œ Envoyï¼Œè¯·&lt;a href=&#34;https://academy.tetrate.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æŸ¥çœ‹ Tetrate å­¦é™¢&lt;/a&gt;ï¼Œä½ ä¼šå‘ç°å¤§é‡çš„å…è´¹è¯¾ç¨‹ã€ç ”è®¨ä¼šï¼Œä»¥åŠ Tetrate çš„ Istio ç®¡ç†å‘˜è®¤è¯è€ƒè¯•ã€‚&lt;/p&gt;
&lt;p&gt;è¦æƒ³ä»¥æœ€ç®€å•çš„æ–¹å¼å®‰è£…ã€ç®¡ç†å’Œå‡çº§ Istioï¼Œè¯·æŸ¥çœ‹&lt;a href=&#34;https://istio.tetratelabs.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æˆ‘ä»¬çš„å¼€æº Tetrate Istio å‘è¡Œç‰ˆï¼ˆTIDï¼‰&lt;/a&gt;ã€‚TID æ˜¯ä¸€ä¸ªç»è¿‡å®¡æŸ¥çš„ Istio çš„ä¸Šæ¸¸å‘è¡Œç‰ˆ â€”â€”Istio çš„åŠ å›ºé•œåƒï¼Œå…·æœ‰æŒç»­çš„æ”¯æŒï¼Œæ›´å®¹æ˜“å®‰è£…ã€ç®¡ç†å’Œå‡çº§ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>é¢å‘æœªæ¥çš„ç½‘å…³ï¼šæ–°çš„ Kubernetes Gateway API å’Œ Envoy Gateway 0.2 ä»‹ç»</title>
      <link>https://lib.jimmysong.io/blog/envoy-gateway-to-the-future/</link>
      <pubDate>Thu, 27 Oct 2022 10:00:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/envoy-gateway-to-the-future/</guid>
      <description>&lt;p&gt;æœ€è¿‘ &lt;a href=&#34;https://blog.envoyproxy.io/introducing-envoy-gateway-ad385cc59532&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Envoy Gateway 0.2&lt;/a&gt; å‘å¸ƒäº†ï¼ŒAPI ç½‘å…³çš„ç”Ÿæ€ç³»ç»Ÿè¿æ¥äº†æ–°çš„å˜åŒ–ã€‚è¿™ç¯‡æ–‡ç« å°†æƒ³ä½ ä»‹ç» Kubernetes API ç½‘å…³é¢†åŸŸçš„æœ€æ–°è¿›å±•ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚ä½•å°†å¤–éƒ¨çš„ç½‘ç»œè¯·æ±‚è·¯ç”±åˆ° Kubernetes é›†ç¾¤ï¼Ÿä½ å¯ä»¥ä½¿ç”¨å…¥å£æ§åˆ¶å™¨ï¼šä¸€ç»„ HTTP åå‘ä»£ç†ï¼Œå°†æµé‡è½¬æ¥åˆ°é›†ç¾¤ä¸­ï¼Œå¹¶ç”± operator æ¥ç®¡ç†ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨ Ambassadorã€Contourã€Traefik æˆ– HAproxy è¿™ç±»è½¯ä»¶ã€‚è¿˜å¯ä»¥ä½¿ç”¨äº‘æä¾›å•†çš„è§£å†³æ–¹æ¡ˆï¼Œæˆ–è€…åªæ˜¯ç”¨é»˜è®¤çš„çš„ Nginx Ingressã€‚æˆ–è€…ä½ å¯èƒ½ä½¿ç”¨ä¸€ä¸ªåŠŸèƒ½æ›´å…¨é¢çš„ API ç½‘å…³ï¼Œå¦‚ Tyk æˆ– Kongï¼Œæˆ–è€…åœ¨ Kubernetes Ingress å‰é¢çš„å¦ä¸€å±‚æœ‰ä¸€ä¸ªå•ç‹¬çš„ç½‘å…³ï¼Œå¦‚ AWS çš„ API ç½‘å…³ï¼Œæˆ–å†…éƒ¨çš„ F5ï¼Œå¯ä»¥é€‰æ‹©çš„å®åœ¨å¤ªå¤šã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ–°çš„å…¥å£æ§åˆ¶å™¨&#34;&gt;ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ–°çš„å…¥å£æ§åˆ¶å™¨&lt;/h2&gt;
&lt;p&gt;å› ä¸ºå¾ˆå¤šå…¥å£æ§åˆ¶å™¨éƒ½æœ‰ä¸åŒç¨‹åº¦çš„é™åˆ¶ï¼šæœ‰äº›æ˜¯åŸºäºæ—§çš„æŠ€æœ¯ï¼Œå¦‚ Nginxã€HAproxyï¼Œç”šè‡³æ˜¯åŸºäº Apache å»ºç«‹çš„ã€‚è¿™äº›æŠ€æœ¯çš„ç‰¹æ€§ä¸é€‚ç”¨äºäº‘åŸç”Ÿç¯å¢ƒï¼Œæ¯”å¦‚åœ¨é…ç½®æ”¹å˜æ—¶æ”¾å¼ƒå·²å»ºç«‹çš„è¿æ¥ï¼ˆå¦‚æœä½ æƒ³æ·±å…¥äº†è§£ï¼ŒAmbassador å‘è¡¨äº†ä¸€ç¯‡&lt;a href=&#34;https://blog.getambassador.io/envoy-vs-nginx-vs-haproxy-why-the-open-source-ambassador-api-gateway-chose-envoy-23826aed79ef&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ¯”è¾ƒ&lt;/a&gt;æ–‡ç« ï¼‰ã€‚äº‘ä¾›åº”å•†çš„äº§å“ç¡®å®å€¾å‘äºåŸºäºæ›´ç°ä»£çš„ä¸œè¥¿ï¼ˆæ¯”å¦‚ &lt;a href=&#34;https://www.usenix.org/system/files/conference/nsdi18/nsdi18-dalton.pdf&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SDN&lt;/a&gt;ï¼‰ï¼Œä½†æ˜¯è¿™å¯èƒ½äº§ç”Ÿå‚å•†é”å®šã€‚ç›®å‰ï¼Œä½ åªéœ€ç”¨ä¸€ä¸ª Kubernetes API æ¥æŒ‡å®šæ‰€æœ‰ä¸åŒé€‰é¡¹çš„é…ç½®ï¼šIngressã€‚è¿™ä¸ª API çš„å¯é…ç½®é¡¹å¾ˆå°‘ï¼Œå‡ ä¹ä»»ä½•ä½ æƒ³é…ç½®çš„è®¾ç½®éƒ½éœ€è¦é€šè¿‡ annotation æ¥å®ç°ï¼Œè€Œä¸æ˜¯ä½œä¸ºä¸€ç±»å­—æ®µã€‚&lt;/p&gt;
&lt;h2 id=&#34;envoy-gatewayæœªæ¥-gateway-å‘å±•çš„åŸºç¡€&#34;&gt;Envoy Gatewayï¼šæœªæ¥ Gateway å‘å±•çš„åŸºç¡€&lt;/h2&gt;
&lt;p&gt;ç°åœ¨åˆæœ‰äº†æ–°çš„é€‰æ‹©ï¼šEnvoy Gatewayï¼Œç®€ç§° EGã€‚é¡¾åæ€ä¹‰ï¼Œè¿™æ˜¯ä¸€ä¸ªåŸºäº Envoy ä»£ç†çš„ç½‘å…³ï¼ˆå…¥å£æ§åˆ¶å™¨ï¼‰ã€‚å®ƒæ˜¯ä¸€ä¸ªæ‰˜ç®¡åœ¨ GitHub ä¸Šçš„ Envoy ç¤¾åŒºé¡¹ç›®ã€‚è¿™ä¸æ˜¯ç¬¬ä¸€ä¸ªåŸºäº Envoy çš„å…¥å£ï¼›å·²ç»æœ‰æµè¡Œçš„å»ºç«‹åœ¨ Envoy ä¹‹ä¸Šçš„ Contour å’Œ Ambassador ç­‰é¡¹ç›®ã€‚ä½†æ˜¯è¿™äº›é¡¹ç›®çš„å¼€å‘è€…å’Œæ›´å¤šçš„äººæ­£åœ¨ä¸€èµ·ä¸º EG åšå‡ºè´¡çŒ®ï¼ŒAmbassador å’Œ Contour éƒ½è¯´ä»–ä»¬ä¼šåœ¨é€‚å½“çš„æ—¶å€™&lt;a href=&#34;https://blog.envoyproxy.io/introducing-envoy-gateway-ad385cc59532&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;åœ¨ Envoy Gateway çš„ä»£ç ä¸Šé‡æ„&lt;/a&gt;ï¼ˆä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬ Tetrate å…¬å¸æ— å¯å¦è®¤åœ°ä¸ºæˆ‘ä»¬åœ¨è¿™ä¸ªé¡¹ç›®ä¸­çš„é¢†å¯¼ä½œç”¨æ„Ÿåˆ°è‡ªè±ªï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;Envoy æœ¬èº«æ˜¯ä¹…ç»è€ƒéªŒçš„å…¥å£ä»£ç†ã€sidecar ä»£ç†ï¼Œå¹¶ä¸”æ­£åœ¨å‡†å¤‡å–ä»£&lt;a href=&#34;https://cloud.google.com/docs/security/infrastructure/design#google_front_end_service&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è°·æ­Œçš„ GFE&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä»£ç æ¼”ç¤º&#34;&gt;ä»£ç æ¼”ç¤º&lt;/h3&gt;
&lt;p&gt;å¦‚æœä½ æƒ³åœ¨äº†è§£æ›´å¤šå…³äº Envoy Gateway çš„å†…å®¹ä¹‹å‰å…ˆæ¼”ç»ƒä¸€ç•ªï¼Œæˆ‘å·²ç»å†™äº†&lt;a href=&#34;https://tetr8.io/3MPT6KT&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä¸€ç¯‡å§å¦¹ç¯‡&lt;/a&gt;ï¼Œå…¶ä¸­æœ‰è¯¦ç»†çš„è¯´æ˜ï¼Œå¯ä»¥è‡ªå·±è®¾ç½® Envoy Gatewayï¼Œå¦‚æœä½ æ²¡æœ‰ç¯å¢ƒï¼Œé‚£ç¯‡æ–‡ç« ä¸­ä¹ŸåŒ…æ‹¬äº†æˆ‘æœºå™¨ä¸Šæ‰€æœ‰çš„å‘½ä»¤è¾“å‡ºï¼Œè¿™æ ·ä½ å°±å¯ä»¥çœ‹åˆ°ä¼šå‘ç”Ÿä»€ä¹ˆã€‚&lt;/p&gt;
&lt;h2 id=&#34;é€šå¾€-api-çš„-gateway&#34;&gt;é€šå¾€ API çš„ Gateway&lt;/h2&gt;
&lt;p&gt;Envoy Gateway ä»¥å…¶æœ€ç®€å•çš„å½¢å¼ â€”â€” ä½ å¯èƒ½åˆšåˆšè®¾ç½®å¥½çš„ç³»ç»Ÿï¼Œå°†è¯·æ±‚è½¬å‘åˆ°å…¶é›†ç¾¤ä¸­ã€‚å®ƒæ ¹æ® HTTP host å’Œ path è¿›è¡Œè·¯ç”±ï¼Œä¹Ÿå¯ä»¥æ ¹æ®å…¶ä»– header è¿›è¡Œè·¯ç”±ã€‚æ¯ä¸ªé›†ç¾¤éƒ½éœ€è¦è¿™æ ·åšï¼Œå¾ˆé«˜å…´çœ‹åˆ° Envoy Gateway åœ¨å¼€å‘çš„çŸ­çŸ­ 6 ä¸ªæœˆå†…å°±èƒ½åšåˆ°è¿™ä¸€ç‚¹ï¼ˆè¦äº†è§£æ›´å¤šå…³äº Envoy Gateway çš„ä¿¡æ¯ï¼Œè¯·çœ‹ &lt;a href=&#34;https://www.tetrate.io/envoy-gateway/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Gateway to a New Frontier&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;è¶…è¶ŠåŸºæœ¬å…¥å£çš„é«˜çº§åŠŸèƒ½&#34;&gt;è¶…è¶ŠåŸºæœ¬å…¥å£çš„é«˜çº§åŠŸèƒ½&lt;/h3&gt;
&lt;p&gt;ç„¶è€Œï¼Œè®¸å¤šç»„ç»‡éœ€è¦æ¯”è¿™ä¸ªåŸºæœ¬çš„ 7 å±‚ç½‘ç»œè·¯ç”±æ›´å¤šçš„åŠŸèƒ½ã€‚å¦‚æœéœ€è¦åƒ WAFã€body çš„æ¨¡å¼éªŒè¯ã€bot æ‹¦æˆªç­‰ï¼Œè®¸å¤šäººå°±ä¼šä½¿ç”¨ API ç½‘å…³ã€‚æˆ‘ä»¬çœ‹åˆ°å¾ˆå¤šç»„ç»‡åœ¨ä»–ä»¬çš„å…¥å£æ§åˆ¶å™¨å‰é¢éƒ¨ç½²äº†ä¸€ä¸ªå•ç‹¬çš„ API ç½‘å…³ã€‚ç„¶è€Œï¼ŒAPI ç½‘å…³å¯ä»¥&lt;em&gt;å–ä»£&lt;/em&gt;å…¥å£æ§åˆ¶å™¨ï¼Œå› ä¸ºå®ƒä¹Ÿå¯ä»¥åšè·¯ç”±å’Œæµé‡è§‚å¯Ÿçš„åŸºæœ¬åŠŸèƒ½ã€‚å®ƒä»¬å¯ä»¥æä¾›è¿™äº›åŠŸèƒ½ï¼Œå› ä¸ºå®ƒä»¬æ˜¯ç”±ä¸å…¥å£æ§åˆ¶å™¨ç›¸åŒçš„ä»£ç†æ„å»ºçš„ï¼Œä¾‹å¦‚ï¼ŒKong æ˜¯åŸºäº nginx çš„ã€‚API ç½‘å…³äº§å“åœ¨å¸‚åœºä¸Šå¾ˆå—æ¬¢è¿ï¼Œä½†å¦‚æœä½ çœŸçš„æƒ³ä¸€æƒ³ API ç½‘å…³æ˜¯ä»€ä¹ˆï¼Œå®ƒå°±æ˜¯ä¸€ä¸ª HTTP ä»£ç†ï¼Œæœ‰ä¸€ç³»åˆ—çš„é™„åŠ åŠŸèƒ½ï¼ˆæˆ‘ä¹‹å‰æåˆ°çš„ WAF ç­‰ï¼‰ã€‚è¿™å¹¶ä¸æ˜¯è¯´å®ƒä»¬ä¸å¢åŠ ä»»ä½•ä»·å€¼ â€”â€” å®ƒä»¬æä¾›çš„åŠŸèƒ½æ˜¯å¤šç§å¤šæ ·çš„ï¼Œè€Œä¸”å¾ˆå¼ºå¤§ï¼Œä½†æœ‰ä¸€ä¸ªå…±åŒçš„åŠŸèƒ½åŸºçº¿å’Œå®ç°ä»£ç ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä½¿ç”¨-wasm-çš„åŠ¨æ€å¯æ‰©å±•æ€§&#34;&gt;ä½¿ç”¨ Wasm çš„åŠ¨æ€å¯æ‰©å±•æ€§&lt;/h3&gt;
&lt;p&gt;å› æ­¤ï¼ŒEnvoy Gateway å®Œå…¨æœ‰èƒ½åŠ›å‘å±•æˆä¸ºä¸€ä¸ªå…¨åŠŸèƒ½çš„ API ç½‘å…³ã€‚Envoy å®é™…ä¸Šå·²ç»å…·å¤‡äº†ä¸€äº›æ›´å…ˆè¿›çš„åŠŸèƒ½ï¼ŒåŒ…æ‹¬ JWT éªŒè¯ã€OIDC è®¤è¯æµå’Œé€Ÿç‡é™åˆ¶ã€‚æ­¤å¤–ï¼ŒEnvoy æ˜¯åŠ¨æ€å¯æ‰©å±•çš„ï¼›å®ƒå¯ä»¥åœ¨ä¸é‡å¯çš„æƒ…å†µä¸‹åŠ è½½æ’ä»¶ï¼Œè¿™æ„å‘³ç€å¯ä»¥å¾ˆå®¹æ˜“åœ°æŒ‰éœ€æ·»åŠ æ›´å¤šçš„åŠŸèƒ½ã€‚è¿™äº›æ’ä»¶æ˜¯ä»¥ WASM å­—èŠ‚ç çš„å½¢å¼æä¾›çš„ï¼Œè¿™æ„å‘³ç€å®ƒä»¬å¯ä»¥ç”¨ä»»ä½•å¯ä»¥ç¼–è¯‘æˆ WASM çš„è¯­è¨€ï¼ˆTiny Goã€Rust ç­‰ï¼‰ç¼–å†™ï¼Œè€Œä¸ä»…ä»…æ˜¯å…¶ä»–ä»£ç†æ”¯æŒçš„è„šæœ¬è¯­è¨€ã€‚ç¤¾åŒºæ­£åœ¨å¼€å§‹ç¼–å†™è¿™äº›æ’ä»¶ï¼šç¼“å­˜å¯èƒ½ä¼šé¦–å…ˆè½åœ°ï¼Œ&lt;a href=&#34;https://coraza.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Coraza&lt;/a&gt; é¡¹ç›®æ˜¯ä¸€ä¸ªç›¸å¯¹æˆç†Ÿçš„ &lt;code&gt;mod_security&lt;/code&gt; é£æ ¼çš„ WAFï¼Œç”¨ Go ç¼–å†™ï¼Œå¯ä»¥ç¼–è¯‘æˆ WASMï¼Œç°åœ¨å¯ä»¥ç”¨äº Envoy ä»£ç†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;gateway-api-é¼“åŠ±æ‰©å±•&#34;&gt;Gateway API é¼“åŠ±æ‰©å±•&lt;/h3&gt;
&lt;p&gt;åœ¨å…¥å£æ§åˆ¶å™¨å¸‚åœºä¸Šï¼Œæ‰©å±•å’Œç«äº‰çš„å¦ä¸€å¤§éšœç¢æ˜¯ APIã€‚éœ€è¦ç‰¹å®šäºä¾›åº”å•†çš„æ³¨è§£ï¼ˆæˆ–å…¨æ–°çš„ç‰¹å®šäºä¾›åº”å•†çš„ APIï¼‰ï¼Œè¿™äº›æ³¨è§£å¾ˆç¬¨é‡ï¼Œè€Œä¸”å¦¨ç¢äº†äº¤å‰å…¼å®¹ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒEnvoy Gateway æ˜¯ç”± Gateway API é…ç½®çš„ï¼Œè¿™æ˜¯ &lt;code&gt;gateway.networking.k8s.io &lt;/code&gt;API ç»„çš„ä¸€ç»„èµ„æºã€‚è¿™ä¸ª API å°†æœ€ç»ˆå–ä»£ Ingress èµ„æºã€‚å®ƒçš„æ ¸å¿ƒå·²ç»æ¯” Ingress æ›´åŠ çµæ´»å’Œå¯Œæœ‰è¡¨ç°åŠ›ï¼Œè€Œä¸”å®ƒè¢«è®¾è®¡æˆä»¥å¯ç®¡ç†çš„æ–¹å¼å¢é•¿å’Œæ‰©å±•ã€‚è¿™å°†å…è®¸å®ƒå‘å±•æˆä¸ºæ‰€æœ‰å—åŒ—æµé‡æ§åˆ¶çš„ä¸€æµæ¨¡å‹ï¼Œä»åŸºæœ¬çš„è·¯ç”±åˆ°å…ˆè¿›çš„ API ç®¡ç†åŠŸèƒ½ã€‚è¿™åè¿‡æ¥åˆä¼šå°† Envoy Gateway æ‹¥æœ‰çš„æ‰€æœ‰åŠŸèƒ½ï¼Œä»¥ä¸€ç§æ ‡å‡†çš„ã€ä¸ä¾›åº”å•†æ— å…³çš„æ–¹å¼æš´éœ²å‡ºæ¥ï¼Œè®©äººä»¬åœ¨ä½¿ç”¨è¿™äº›åŠŸèƒ½æ—¶æ— éœ€è·³è¿‡éšœç¢æˆ–æ‹…å¿ƒé”å®šé—®é¢˜ã€‚Envoy Gateway å°†åœ¨ 2023 å¹´ 3 æœˆçš„ 0.3 ç‰ˆæœ¬ä¸­æ”¯æŒ Gateway API çš„è¿™äº›æ–°éƒ¨åˆ†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä¸ºæœªæ¥çš„ç½‘å…³å‘å±•æä¾›ä¸€ä¸ªå…±åŒçš„æœ€ä½³çš„åŸºç¡€&#34;&gt;ä¸ºæœªæ¥çš„ç½‘å…³å‘å±•æä¾›ä¸€ä¸ªå…±åŒçš„ã€æœ€ä½³çš„åŸºç¡€&lt;/h3&gt;
&lt;p&gt;Envoy Gateway çš„åŠ¨åŠ›æ¥è‡ªäºå¯¹ API ç½‘å…³åŠŸèƒ½å †æ ˆçš„æ—¥ç›Šå…³æ³¨ã€‚åŸºæœ¬çš„å…¥å£æ­£åœ¨å˜å¾—å•†ä¸šåŒ–ï¼Œæ‰€ä»¥ç¤¾åŒºæ­£åœ¨æ±‡é›†å…¶èµ„æºå’Œä¸“ä¸šçŸ¥è¯†ï¼Œä¸ºæœªæ¥çš„ç½‘å…³å¼€å‘åˆ›é€ ä¸€ä¸ªå…±åŒçš„ã€æœ€å¥½çš„åŸºç¡€ã€‚åŒæ—¶æä¾›æ–°çš„ Gateway API ä¾›å…¶å®ç°æ˜¯éå¸¸æ–¹ä¾¿çš„ï¼ŒEnvoy Gateway çš„ 0.2 ç‰ˆæœ¬æ ‡å¿—ç€å¯¹ç›®å‰å®šä¹‰çš„ Gateway API æ ¸å¿ƒç±»å‹çš„å…¨é¢æ”¯æŒã€‚&lt;/p&gt;
&lt;p&gt;æ‰©å±•åˆ°é«˜çº§ç”¨ä¾‹æ¨¡å‹çš„å·¥ä½œå·²ç»å¼€å§‹ï¼Œç°åœ¨æ­£åœ¨è®¾è®¡ &lt;a href=&#34;https://docs.google.com/document/d/1TlQjBy1utEwgrxE_HVT4-EHpVJ51hgnfMuAh0Q_uNoE/view&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;JWT auth é…ç½®&lt;/a&gt;ï¼Œå…¶ä»–çš„ä¹Ÿå°†é™†ç»­æ¨å‡ºã€‚æ’ä»¶æœ¬èº«çš„å·¥ä½œä¹Ÿå·²ç»å¼€å§‹ï¼ˆä¾‹å¦‚ï¼ŒCorazaï¼Œä¸€ä¸ªä»¿ç…§æ— å¤„ä¸åœ¨çš„ &lt;code&gt;mod_security&lt;/code&gt; çš„ Golang WAFï¼‰ã€‚è™½ç„¶è¿™äº›éƒ½æœ‰å¾ˆé•¿çš„è·¯è¦èµ°ï¼Œä½†æˆ‘ä¸ªäººéå¸¸æœŸå¾…çœ‹åˆ°è¿™ä¸€åˆ‡åœ¨æœªæ¥ä¸€ä¸¤å¹´çš„å‘å±•ã€‚&lt;/p&gt;
&lt;h2 id=&#34;é€šå¾€æœåŠ¡ç½‘æ ¼çš„-gateway&#34;&gt;é€šå¾€æœåŠ¡ç½‘æ ¼çš„ Gateway&lt;/h2&gt;
&lt;p&gt;ä½ å¯èƒ½åœ¨æƒ³ï¼Œå·²ç»æœ‰ä¸€ç±»äº§å“æ”¯æŒ OIDC è®¤è¯å’Œé€Ÿç‡é™åˆ¶ç­‰åŠŸèƒ½äº†ï¼šæœåŠ¡ç½‘æ ¼ã€‚è¿™æ˜¯çœŸçš„ï¼›æœ€çªå‡ºçš„ç½‘æ ¼ï¼ŒIstioï¼Œåœ¨å…¶é»˜è®¤é…ç½®ä¸­ä¸ºå…¥å£éƒ¨ç½²äº†ä¸€å¥—ä»£ç†æœåŠ¡å™¨ã€‚Istio ç°åœ¨æ”¯æŒ Gateway APIï¼ˆå°±åƒ Envoy Gateway ä¸€æ ·ï¼‰æ¥é…ç½®è¯¥å…¥å£ã€‚æˆ‘ä»¬åœ¨ Tetrate å¯¹è¿™ç§èåˆæ„Ÿåˆ°å…´å¥‹ï¼šä¼ä¸šç°åœ¨å¯ä»¥é‡‡ç”¨ Envoy Gateway æ¥ç®€å•è€Œå¿«é€Ÿåœ°å¼€å±•å·¥ä½œã€‚Envoy Gateway åœ¨ç®¡ç†è¿™ç§å—åŒ—æµé‡æ–¹é¢åšå¾—å¾ˆå¥½ï¼Œè¿è¡Œå®ƒå¯ä»¥è®©ä»–ä»¬äº†è§£ Envoy åœ¨ç”Ÿäº§ä¸­çš„æ€§èƒ½å’Œæ“ä½œç‰¹ç‚¹ã€‚å½“è¿™äº›ç»„ç»‡å‡†å¤‡å¥½æ§åˆ¶ä»–ä»¬çš„æœåŠ¡åˆ°æœåŠ¡ï¼Œä¹Ÿå°±æ˜¯ä¸œè¥¿å‘æµé‡æ—¶ï¼Œä»–ä»¬å¯ä»¥éƒ¨ç½² Istioï¼Œå› ä¸ºä»–ä»¬å·²ç»ç†Ÿæ‚‰äº†ä¸»è¦çš„åŸºç¡€ç»„ä»¶ï¼ˆEnvoyï¼‰ã€‚è™½ç„¶ä»–ä»¬å¯èƒ½ä¼šé€‰æ‹©ä½¿ç”¨ Istio çš„å…¥å£ç½‘å…³ï¼ˆä»¥ä¿æŒä»–ä»¬çš„æ§åˆ¶å¹³é¢æ•°é‡å‡å°‘åˆ° 1ï¼‰ï¼Œä½†ä»–ä»¬ç°æœ‰çš„ Gateway API èµ„æºå°†ç»§ç»­å·¥ä½œã€‚ç”±äºåŒæ ·åŸºäº Envoyï¼ŒIstio çš„ Ingress ä¹Ÿå¯ä»¥æ¥å—ä»»ä½•åŠ è½½åˆ° Envoy Gateway çš„ API Gateway é£æ ¼çš„æ’ä»¶ã€‚æ‰€æœ‰è¿™ä¸€åˆ‡éƒ½ä½¿å¾—åœ¨å¿…è¦æ—¶å¢åŠ æœåŠ¡ç½‘æ ¼çš„åŠ›é‡å˜å¾—éå¸¸å®¹æ˜“ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ç”¨äºå…¥å£å’ŒæœåŠ¡ç½‘æ ¼çš„ç»Ÿä¸€-gateway-api&#34;&gt;ç”¨äºå…¥å£å’ŒæœåŠ¡ç½‘æ ¼çš„ç»Ÿä¸€ Gateway API&lt;/h3&gt;
&lt;p&gt;æ›´é‡è¦çš„æ˜¯ï¼Œç°åœ¨å·²ç»æœ‰äº†ä¸€ä¸ªå·¥ä½œç»„æ¥åè°ƒç½‘å…³å’Œç½‘æ ¼ç½‘ç»œä¹‹é—´çš„é‡å éƒ¨åˆ†ï¼š&lt;a href=&#34;https://gateway-api.sigs.k8s.io/contributing/gamma/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;GAMMA å€¡è®®&lt;/a&gt;ã€‚GAMMA æ˜¯ Gateway API for Mesh Management and Administration çš„ç¼©å†™ï¼Œè¿™æ˜¯å¯¹ Gateway API æœªæ¥å‘å±•æ–¹å‘çš„ä¸€ä¸ªå€¡è®®ï¼›è®¡åˆ’æ˜¯å¼€å§‹å¯¹æœåŠ¡ç½‘æ ¼çš„å…³æ³¨è¿›è¡Œå»ºæ¨¡ï¼Œå³ä¸œè¥¿å‘æµé‡ä¹Ÿæ˜¯å¦‚æ­¤ã€‚GAMMA å°†ç¡®ä¿ Envoy Gateway å’ŒæœåŠ¡ç½‘æ ¼çš„è‰¯å¥½åˆä½œï¼Œå¹¶å°†å…³æ³¨ Gateway API çš„ç»Ÿä¸€ï¼Œä»¥æ¶µç›–å…¥å£å’Œç½‘æ ¼ã€‚æˆ‘ä»¬å¾ˆé«˜å…´çœ‹åˆ°ï¼Œè¿™å°†ä¸ºè®¸å¤šç»„ç»‡è½»æ¾å’Œé€æ­¥åœ°é‡‡ç”¨æœåŠ¡ç½‘æ ¼ï¼ŒåŸºäºä¸€ä¸ªä¸äº§å“æ— å…³çš„ APIï¼Œè¿™å¯¹æ‰€æœ‰äººéƒ½æ˜¯å¥½äº‹ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç»“æŸè¯­&#34;&gt;ç»“æŸè¯­&lt;/h2&gt;
&lt;p&gt;è¿™ç¯‡æ–‡ç« å¯¹æ–°çš„æ ‡å‡† APIã€Gateway API å’Œå‚è€ƒå®ç° Envoy Gateway ä½œäº†å¾ˆå¥½çš„ä»‹ç»ï¼Œå¸Œæœ›èƒ½å¯¹ä½ äº†è§£å½“å‰çš„å…¥å£ç½‘å…³ç”Ÿæ€æœ‰æ‰€å¸®åŠ©ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ æƒ³å…³æ³¨ EG çš„å‘å±•ï¼Œä½ å¯ä»¥åŠ å…¥ Envoy slack çš„ &lt;code&gt;#gateway&lt;/code&gt; é¢‘é“ï¼Œå¹¶åœ¨ &lt;a href=&#34;https://github.com/envoyproxy/gateway&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://github.com/envoyproxy/gateway&lt;/a&gt; æŸ¥çœ‹æäº¤å’Œé—®é¢˜ã€‚è¯¥é¡¹ç›®æœ‰ä¸€ä¸ª &lt;a href=&#34;https://github.com/envoyproxy/gateway/blob/main/docs/design/ROADMAP.md&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æœªæ¥å‡ ä¸ªç‰ˆæœ¬çš„è·¯çº¿å›¾&lt;/a&gt;ï¼Œ0.3.0 ç‰ˆæœ¬å‘å¸ƒé¢„æœŸæ˜¯åœ¨ 2023 å¹´ 3 æœˆã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ æƒ³æµ‹è¯•ä¸€ä¸‹ Envoy Gatewayï¼Œæˆ‘å†™äº†ä¸€ä¸ªé…å¥—çš„æ•™ç¨‹ï¼Œå…¶ä¸­åŒ…å«äº†å¯åŠ¨å’Œè¿è¡Œçš„æ­¥éª¤è¯´æ˜ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ æ­£åœ¨å¼€å§‹ä½¿ç”¨ Istio å’Œ Envoyï¼Œè¯·&lt;a href=&#34;https://academy.tetrate.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æŸ¥çœ‹ Tetrate å­¦é™¢&lt;/a&gt;ï¼Œä½ ä¼šå‘ç°å¤§é‡çš„å…è´¹è¯¾ç¨‹ã€ç ”è®¨ä¼šï¼Œä»¥åŠ Tetrate çš„ Istio ç®¡ç†å‘˜è®¤è¯è€ƒè¯•ã€‚&lt;/p&gt;
&lt;p&gt;è¦æƒ³ä»¥æœ€ç®€å•çš„æ–¹å¼å®‰è£…ã€ç®¡ç†å’Œå‡çº§ Istioï¼Œè¯·æŸ¥çœ‹&lt;a href=&#34;https://istio.tetratelabs.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æˆ‘ä»¬çš„å¼€æº Tetrate Istio å‘è¡Œç‰ˆï¼ˆTIDï¼‰&lt;/a&gt;ã€‚TID æ˜¯ä¸€ä¸ªç»è¿‡å®¡æŸ¥çš„ Istio çš„ä¸Šæ¸¸å‘è¡Œç‰ˆ â€”â€”Istio çš„åŠ å›ºé•œåƒï¼Œå…·æœ‰æŒç»­çš„æ”¯æŒï¼Œæ›´å®¹æ˜“å®‰è£…ã€ç®¡ç†å’Œå‡çº§ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>ä»€ä¹ˆæ˜¯ Ambient Meshï¼Ÿ</title>
      <link>https://lib.jimmysong.io/blog/what-is-ambient-mesh/</link>
      <pubDate>Wed, 28 Sep 2022 10:00:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/what-is-ambient-mesh/</guid>
      <description>&lt;p&gt;Istio&lt;a href=&#34;https://istio.io/latest/blog/2022/introducing-ambient-mesh/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æœ€è¿‘å®£å¸ƒäº† â€œAmbient Meshâ€&lt;/a&gt; â€”â€” ä¸€ç§ç”¨äº Istio çš„å®éªŒæ€§ â€œæ— sidecarâ€ éƒ¨ç½²æ¨¡å‹ã€‚æˆ‘ä»¬æœ€è¿‘åœ¨&lt;a href=&#34;https://www.tetrate.io/blog/ebpf-and-sidecars-getting-the-most-performance-and-resiliency-out-of-the-service-mesh/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä»æœåŠ¡ç½‘æ ¼ä¸­è·å¾—æœ€å¤§æ€§èƒ½å’Œå¼¹æ€§&lt;/a&gt;çš„èƒŒæ™¯ä¸‹å†™äº†å…³äº sidecar ä¸ sidecar-less çš„æ–‡ç« ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†ç‰¹åˆ«ä»‹ç»æˆ‘ä»¬å¯¹ Ambient Mesh çš„çœ‹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ æƒ³ç«‹å³å¼€å§‹ä½¿ç”¨å¯ç”¨äºç”Ÿäº§çš„ Istio å‘è¡Œç‰ˆï¼Œè¯·å°è¯•&lt;a href=&#34;https://istio.tetratelabs.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tetrate Istio Distro (TID)&lt;/a&gt;ã€‚TID æ˜¯ç»è¿‡å®¡æŸ¥çš„ Istio ä¸Šæ¸¸å‘è¡Œç‰ˆï¼Œå®ƒæ˜“äºå®‰è£…ã€ç®¡ç†å’Œå‡çº§ï¼ŒåŸºäºé€‚ç”¨äº FedRAMP ç¯å¢ƒçš„ FIPS è®¤è¯æ„å»ºã€‚å¦‚æœä½ éœ€è¦ä¸€ç§ç»Ÿä¸€ä¸”ä¸€è‡´çš„æ–¹å¼æ¥ä¿æŠ¤å’Œç®¡ç†ä¸€ç»„åº”ç”¨ç¨‹åºä¸­çš„æœåŠ¡ï¼Œè¯·æŸ¥çœ‹&lt;a href=&#34;https://www.tetrate.io/tetrate-service-bridge/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tetrate Service Bridge (TSB)&lt;/a&gt;ï¼Œè¿™æ˜¯æˆ‘ä»¬åŸºäº Istio å’Œ Envoy æ„å»ºçš„å…¨é¢çš„è¾¹ç¼˜åˆ°å·¥ä½œè´Ÿè½½åº”ç”¨ç¨‹åºè¿æ¥å¹³å°ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä»€ä¹ˆæ˜¯-ambient-mesh&#34;&gt;ä»€ä¹ˆæ˜¯ Ambient Meshï¼Ÿ&lt;/h2&gt;
&lt;p&gt;Ambient Mesh æ˜¯æœ€è¿‘å¼•å…¥ Istio çš„ä¸€ç§å®éªŒæ€§æ–°éƒ¨ç½²æ¨¡å‹ã€‚å®ƒå°† Envoy sidecar å½“å‰æ‰§è¡Œçš„èŒè´£åˆ†ä¸ºä¸¤ä¸ªç‹¬ç«‹çš„ç»„ä»¶ï¼šä¸€ä¸ªç”¨äºåŠ å¯†çš„èŠ‚ç‚¹çº§ç»„ä»¶ï¼ˆç§°ä¸º â€œztunnelâ€ï¼‰å’Œä¸€ä¸ªä¸ºæ¯ä¸ªæœåŠ¡è´¦æˆ·éƒ¨ç½²çš„ L7 Envoy å®ä¾‹ï¼Œç”¨äºæ‰€æœ‰å…¶ä»–å¤„ç†ï¼ˆç§°ä¸º â€œwaypointâ€ï¼‰ã€‚Ambient Meshæ¨¡å‹è¯•å›¾åœ¨æ½œåœ¨æ”¹è¿›çš„ç”Ÿå‘½å‘¨æœŸå’Œèµ„æºç®¡ç†ä¸­è·å¾—ä¸€äº›æ•ˆç‡ â€”â€” è‡³å°‘ï¼Œè¿™æ˜¯åŠ¨æœºã€‚&lt;/p&gt;
&lt;h2 id=&#34;æˆ‘ä¸ºä»€ä¹ˆè¦å…³å¿ƒambient-mesh&#34;&gt;æˆ‘ä¸ºä»€ä¹ˆè¦å…³å¿ƒAmbient Meshï¼Ÿ&lt;/h2&gt;
&lt;p&gt;å¯¹äºå¤§å¤šæ•°æœåŠ¡ç½‘æ ¼ç”¨æˆ·æ¥è¯´ï¼ŒIstio æ•°æ®å¹³é¢çš„ç¡®åˆ‡éƒ¨ç½²æ¨¡å‹æ˜¯ä½ å¯èƒ½ä¸éœ€è¦è€ƒè™‘å¤ªå¤šçš„é€‰æ‹©ã€‚é»˜è®¤å¯èƒ½æ²¡é—®é¢˜ã€‚å¯¹äº&lt;em&gt;ä¸€äº›&lt;/em&gt;æœåŠ¡ç½‘æ ¼ç”¨æˆ·ï¼Œç‰¹åˆ«æ˜¯é‚£äº›æ‹¥æœ‰å°‘é‡æœåŠ¡çš„å¤§è§„æ¨¡æ°´å¹³æ‰©å±•è¶³è¿¹çš„ç”¨æˆ·ï¼ˆwaypoint æ¶æ„è·å¾—æœ€é«˜æ•ˆç‡çš„åœ°æ–¹ï¼‰ï¼ŒAmbient Meshæ¨¡å‹å°†åœ¨æˆç†Ÿä¸ºç”Ÿäº§å°±ç»ªçš„åŸºç¡€è®¾æ–½è½¯ä»¶æ—¶å¾ˆæœ‰ç”¨ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æœ¬æ–‡ä¸»æ—¨&#34;&gt;æœ¬æ–‡ä¸»æ—¨&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Ambient Meshéƒ¨ç½²æ¨¡å‹ä¸sidecaræ¨¡å‹è¿›è¡Œäº†ä¸€äº›æƒè¡¡ï¼Œç‰¹åˆ«æ˜¯åœ¨ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€èµ„æºåˆ©ç”¨ã€æ•…éšœæ’é™¤å’Œå®‰å…¨çŠ¶å†µæ–¹é¢ã€‚å®ƒä»¬ä¹‹é—´ä¸åˆ†ä¼¯ä»²ã€‚&lt;/li&gt;
&lt;li&gt;Ambient Meshç›®å‰è¿˜åœ¨å®éªŒé˜¶æ®µï¼Œæœ€æ—©è¦åˆ° 2023 å¹´æ‰èƒ½æŠ•å…¥ç”Ÿäº§ â€”â€” ä¹Ÿå°±æ˜¯è¯´ï¼Œ&lt;strong&gt;æš‚æ—¶ä¸è¦åœ¨æ­¤åŸºç¡€ä¸Šè¿›è¡Œæ„å»º&lt;/strong&gt;ã€‚ç°åœ¨ï¼Œå®ƒçš„æ€§èƒ½å·®ï¼ŒåŠŸèƒ½æ›´å°‘ï¼Œå¹¶ä¸”å¯¹äºå·²å¹¿æ³›ä½¿ç”¨çš„æŠ€æœ¯ï¼ˆå¦‚ CNIï¼‰å…·æœ‰æœªå®šä¹‰çš„è¡Œä¸ºã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬é¢„è®¡éšç€æœªæ¥å‡ ä¸ªæœˆçš„å®ç°ï¼Œè¿™ç§æƒ…å†µå°†è¿…é€Ÿæ”¹å–„ã€‚&lt;/li&gt;
&lt;li&gt;ä½ å…³å¿ƒçš„å¤§éƒ¨åˆ†ç½‘æ ¼åŠŸèƒ½ï¼ˆå¦‚æŒ‰è¯·æ±‚æµé‡ç®¡ç†å’Œå®‰å…¨æ§åˆ¶ã€åˆ†å¸ƒå¼è¿½è¸ªå’Œåº”ç”¨ç¨‹åºçº§ RED æŒ‡æ ‡ï¼‰éƒ½å‘ç”Ÿåœ¨ L7 ä¸­ã€‚ç›®å‰å°šä¸æ¸…æ¥šAmbient Meshçš„ä»… L4 éƒ¨åˆ†çš„é€‚ç”¨èŒƒå›´æœ‰å¤šå¤§ï¼Œä»¥åŠæ‰“ç ´è¿™äº›æ•°æ®å¹³é¢èŒè´£å°†åœ¨å¤šå¤§ç¨‹åº¦ä¸Šæœ‰åŠ©äºæ¨åŠ¨ç½‘æ ¼çš„é‡‡ç”¨ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿™ç¯‡æ–‡ç« çš„å…¶ä½™éƒ¨åˆ†æ˜¯æˆ‘ä»¬å¯¹ç¯å¢ƒæ¨¡å‹ä¸ Istio ç°æœ‰çš„ Sidecar éƒ¨ç½²æ¨¡å‹çš„æƒè¡¡ï¼Œçœ‹çœ‹å“ªä¸€ä¸ªé€‚åˆä½ ä»¥åŠä½•æ—¶é€‚åˆä½ ã€‚&lt;/p&gt;
&lt;h2 id=&#34;istio-ä¸­çš„-l4-å’Œ-l7-å¤„ç†å¦‚ä½•å·¥ä½œ&#34;&gt;Istio ä¸­çš„ L4 å’Œ L7 å¤„ç†å¦‚ä½•å·¥ä½œï¼Ÿ&lt;/h2&gt;
&lt;p&gt;ç”±äºAmbient Meshåˆ†å‰²äº† L4 å’Œ L7 å¤„ç†ï¼Œå› æ­¤å‡†ç¡®äº†è§£æ¯ä¸€å±‚ä¸­å‘ç”Ÿçš„ç½‘æ ¼è¡Œä¸ºéå¸¸é‡è¦ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;L4&lt;/strong&gt;&lt;/th&gt;
&lt;th&gt;&lt;strong&gt;L7&lt;/strong&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å®‰å…¨&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æœåŠ¡é—´èº«ä»½éªŒè¯&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://spiffe.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SPIFFE&lt;/a&gt;ï¼Œé€šè¿‡ mTLS è¯ä¹¦ã€‚Istio é¢å‘ä¸€ä¸ªçŸ­æœŸ X.509 è¯ä¹¦ï¼Œè¯¥è¯ä¹¦å¯¹ pod çš„æœåŠ¡è´¦æˆ·èº«ä»½è¿›è¡Œç¼–ç ã€‚&lt;/td&gt;
&lt;td&gt;ä¸é€‚ç”¨ â€” Istio ä¸­çš„æœåŠ¡èº«ä»½ä»…åŸºäº TLSã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æœåŠ¡é—´æˆæƒ&lt;/td&gt;
&lt;td&gt;åŸºäºç½‘ç»œçš„æˆæƒï¼ŒåŠ ä¸ŠåŸºäºèº«ä»½çš„ç­–ç•¥ï¼Œä¾‹å¦‚ï¼šA åªèƒ½æ¥å—æ¥è‡ª â€œ10.2.0.0/16â€ çš„è°ƒç”¨ï¼›A å¯ä»¥è°ƒç”¨ Bã€‚&lt;/td&gt;
&lt;td&gt;å®Œæ•´çš„ç­–ç•¥ï¼Œä¾‹å¦‚ï¼šA åªèƒ½ä½¿ç”¨åŒ…å« READ èŒƒå›´çš„æœ‰æ•ˆæœ€ç»ˆç”¨æˆ·å‡­æ®åœ¨ B ä¸Šè·å– /foo ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æœ€ç»ˆç”¨æˆ·èº«ä»½éªŒè¯&lt;/td&gt;
&lt;td&gt;ä¸é€‚ç”¨ - æˆ‘ä»¬ä¸èƒ½åº”ç”¨æ¯ä¸ªç”¨æˆ·çš„è®¾ç½®ã€‚&lt;/td&gt;
&lt;td&gt;JWT çš„æœ¬åœ°èº«ä»½éªŒè¯ï¼Œæ”¯æŒé€šè¿‡ OAuth å’Œ OIDC æµè¿›è¡Œè¿œç¨‹èº«ä»½éªŒè¯ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æœ€ç»ˆç”¨æˆ·æˆæƒ&lt;/td&gt;
&lt;td&gt;ä¸é€‚ç”¨ â€”â€” è§ä¸Šæ–‡ã€‚&lt;/td&gt;
&lt;td&gt;æœåŠ¡é—´ç­–ç•¥å¯ä»¥æ‰©å±•ä¸ºéœ€è¦&lt;a href=&#34;https://istio.io/latest/docs/reference/config/security/conditions/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å…·æœ‰ç‰¹å®šèŒƒå›´ã€é¢å‘è€…ã€å§”æ‰˜äººã€å—ä¼—ç­‰çš„æœ€ç»ˆç”¨æˆ·å‡­æ®&lt;/a&gt;â€”â€” ä½†å®ƒä¸èƒ½ç”¨äºå®Œæ•´çš„ç”¨æˆ·åˆ°èµ„æºè®¿é—®æ§åˆ¶ã€‚åº”è¯¥ä½¿ç”¨å¤–éƒ¨æˆæƒæ¥å®ç°ç”¨æˆ·å¯¹èµ„æºçš„å®Œå…¨è®¿é—®ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Envoy çš„å¤–éƒ¨æˆæƒ API (ext_authz)&lt;/td&gt;
&lt;td&gt;æ— æ³•æ‰§è¡Œä»»ä½•é’ˆå¯¹è¯·æ±‚çš„ç­–ç•¥ï¼›ext_authz API åªèƒ½é’ˆå¯¹ L7 æµé‡è¿›è¡Œé…ç½®ã€‚&lt;/td&gt;
&lt;td&gt;ä½¿ç”¨æ¥è‡ªå¤–éƒ¨æœåŠ¡ï¼ˆä¾‹å¦‚ OPAï¼‰çš„å†³ç­–æ¥æ‰§è¡Œæ¯ä¸ªè¯·æ±‚çš„ç­–ç•¥ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;å¯è§‚æµ‹æ€§&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æ—¥å¿—è®°å½•&lt;/td&gt;
&lt;td&gt;åŸºæœ¬ç½‘ç»œä¿¡æ¯ï¼šç½‘ç»œäº”å…ƒç»„ã€å‘é€ / æ¥æ”¶çš„å­—èŠ‚æ•°ç­‰ã€‚&lt;a href=&#34;https://www.envoyproxy.io/docs/envoy/latest/configuration/observability/access_log/usage#command-operators&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è¯·å‚é˜… Envoy æ–‡æ¡£&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://www.envoyproxy.io/docs/envoy/latest/configuration/observability/access_log/usage#command-operators&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å®Œæ•´çš„è¯·æ±‚å…ƒæ•°æ®è®°å½•&lt;/a&gt;ï¼Œä»¥åŠåŸºæœ¬çš„ç½‘ç»œä¿¡æ¯ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;è¿½è¸ª&lt;/td&gt;
&lt;td&gt;ç›®å‰ä¸è¡Œï¼›æœ€ç»ˆå¯èƒ½ä¸ HBONE ä¸€èµ·ä½¿ç”¨ã€‚&lt;/td&gt;
&lt;td&gt;Envoy å‚ä¸åˆ†å¸ƒå¼è·Ÿè¸ªã€‚&lt;a href=&#34;https://istio.io/latest/docs/tasks/observability/distributed-tracing/overview/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è¯·å‚é˜…æœ‰å…³è¿½è¸ªçš„ Istio æ¦‚è¿°&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æŒ‡æ ‡&lt;/td&gt;
&lt;td&gt;ä»…é™ TCPï¼ˆå‘é€ / æ¥æ”¶çš„å­—èŠ‚æ•°ã€æ•°æ®åŒ…æ•°ç­‰ï¼‰ã€‚&lt;/td&gt;
&lt;td&gt;L7 RED æŒ‡æ ‡ï¼šè¯·æ±‚ç‡ã€é”™è¯¯ç‡ã€è¯·æ±‚æŒç»­æ—¶é—´ï¼ˆå»¶è¿Ÿï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;strong&gt;æµé‡ç®¡ç†&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;è´Ÿè½½å‡è¡¡&lt;/td&gt;
&lt;td&gt;ä»…è¿æ¥çº§åˆ«ã€‚&lt;a href=&#34;https://istio.io/latest/docs/tasks/traffic-management/tcp-traffic-shifting/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è¯·å‚é˜… TCP æµé‡è½¬ç§»ä»»åŠ¡&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;td&gt;æ ¹æ®è¯·æ±‚ï¼Œå¯ç”¨ä¾‹å¦‚é‡‘ä¸é›€éƒ¨ç½²ã€gRPC æµé‡ç­‰ã€‚&lt;a href=&#34;https://istio.io/latest/docs/tasks/traffic-management/traffic-shifting/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è¯·å‚é˜… HTTP æµé‡è½¬ç§»ä»»åŠ¡&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æ–­è·¯&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://istio.io/latest/docs/reference/config/networking/destination-rule/#ConnectionPoolSettings-TCPSettings&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä»…é™ TCP&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;td&gt;é™¤äº† TCP ä¹‹å¤–çš„ &lt;a href=&#34;https://istio.io/latest/docs/reference/config/networking/destination-rule/#ConnectionPoolSettings-HTTPSettings&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;HTTP è®¾ç½®&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å¼‚å¸¸å€¼æ£€æµ‹&lt;/td&gt;
&lt;td&gt;å…³äºè¿æ¥å»ºç«‹ / å¤±è´¥ã€‚&lt;/td&gt;
&lt;td&gt;æ ¹æ®è¯·æ±‚æˆåŠŸ / å¤±è´¥ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;é€Ÿç‡é™åˆ¶&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://www.envoyproxy.io/docs/envoy/latest/configuration/listeners/network_filters/rate_limit_filter#config-network-filters-rate-limit&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä»…å¯¹ L4 è¿æ¥æ•°æ®çš„é€Ÿç‡é™åˆ¶ï¼Œåœ¨è¿æ¥å»ºç«‹&lt;/a&gt;æ—¶ï¼Œå…·æœ‰å…¨å±€å’Œæœ¬åœ°é€Ÿç‡é™åˆ¶é€‰é¡¹ã€‚&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://www.envoyproxy.io/docs/envoy/latest/configuration/http/http_filters/rate_limit_filter#config-http-filters-rate-limit&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;L7 è¯·æ±‚å…ƒæ•°æ®çš„é€Ÿç‡é™åˆ¶&lt;/a&gt;ï¼Œæ¯ä¸ªè¯·æ±‚ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;è¶…æ—¶&lt;/td&gt;
&lt;td&gt;ä»…å»ºç«‹è¿æ¥ï¼ˆé€šè¿‡æ–­è·¯è®¾ç½®é…ç½®è¿æ¥ä¿æŒæ´»åŠ¨ï¼‰ã€‚&lt;/td&gt;
&lt;td&gt;æ ¹æ®è¦æ±‚ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;é‡è¯•&lt;/td&gt;
&lt;td&gt;é‡è¯•è¿æ¥å»ºç«‹ã€‚&lt;/td&gt;
&lt;td&gt;æ¯æ¬¡è¯·æ±‚å¤±è´¥æ—¶é‡è¯•ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æ•…éšœæ³¨å…¥&lt;/td&gt;
&lt;td&gt;ä¸é€‚ç”¨â€”â€”æ— æ³•åœ¨ TCP è¿æ¥ä¸Šé…ç½®æ•…éšœæ³¨å…¥ã€‚&lt;/td&gt;
&lt;td&gt;å®Œæ•´çš„åº”ç”¨ç¨‹åºå’Œè¿æ¥çº§æ•…éšœï¼ˆ&lt;a href=&#34;https://istio.io/latest/docs/tasks/traffic-management/fault-injection/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è¶…æ—¶ã€å»¶è¿Ÿã€ç‰¹å®šå“åº”ä»£ç &lt;/a&gt;ï¼‰ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æµé‡é•œåƒ&lt;/td&gt;
&lt;td&gt;ä¸é€‚ç”¨ - ä»… HTTP&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://istio.io/latest/docs/tasks/traffic-management/mirroring/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¯¹å¤šä¸ªåç«¯çš„è¯·æ±‚è¿›è¡ŒåŸºäºç™¾åˆ†æ¯”çš„é•œåƒ&lt;/a&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;å€¼å¾—è®°ä½çš„æ˜¯ï¼Œè¿è¡Œåœ¨ L7 çš„ä»£ç†å¯ä»¥æ‰§è¡Œ L4 å’Œ L7 åˆ—ä¸­çš„æ‰€æœ‰æ“ä½œï¼Œè€Œè¿è¡Œåœ¨ L4 çš„ä»£ç†åªèƒ½æ‰§è¡Œ L4 åˆ—ã€‚é€šè¿‡æ¸…æ¥šåœ°äº†è§£å‘ç”Ÿçš„æƒ…å†µä»¥åŠ L4 ä¸ L7 çš„å±€é™æ€§ï¼Œæˆ‘ä»¬å¯ä»¥æŸ¥çœ‹Ambient Meshä¸sidecaræ¨¡å‹ç›¸æ¯”æ‰€åšçš„æƒè¡¡ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç°åœ¨æˆ‘ä»¬åº”è¯¥ä½¿ç”¨ambient-meshå—è¿˜ä¸å¯ä»¥&#34;&gt;ç°åœ¨æˆ‘ä»¬åº”è¯¥ä½¿ç”¨Ambient Meshå—ï¼Ÿï¼ˆè¿˜ä¸å¯ä»¥ï¼‰&lt;/h2&gt;
&lt;p&gt;æˆªè‡³ 2022 å¹´ 9 æœˆå®£å¸ƒï¼ŒAmbient Meshæ˜¯æ¦‚å¿µçš„å®éªŒè¯æ˜ã€‚ä»&lt;a href=&#34;https://github.com/istio/istio/tree/experimental-ambient#limitations&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å‡ ä¹æ¯ä¸€ä¸ªæŒ‡æ ‡&lt;/a&gt;æ¥çœ‹ï¼Œå®ƒçš„æ€§èƒ½éƒ½æ¯”sidecar æ¨¡å‹å·®ï¼Œè€Œä¸”å®ƒæœ‰å¾ˆå¤š&lt;a href=&#34;https://github.com/istio/istio/tree/experimental-ambient#limitations&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;é™åˆ¶&lt;/a&gt;ã€‚Ambient Meshè¿˜&lt;strong&gt;æ²¡æœ‰å‡†å¤‡å¥½&lt;/strong&gt;åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ï¼ˆå¯¹äºæˆ‘ä»¬çš„å®¢æˆ· â€”â€” å¤§å‹ä¼ä¸šçš„å¹³å°å›¢é˜Ÿ â€”â€” åº”ç”¨ç¨‹åºå¼€å‘å’Œæµ‹è¯•ç¯å¢ƒä¹Ÿç®—ä½œç”Ÿäº§ç¯å¢ƒï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ï¼Œæˆ‘ä»¬é¢„è®¡éšç€ç¤¾åŒºä¸­çš„å·¥ç¨‹å¸ˆè‡´åŠ›äºéƒ¨ç½²æ¨¡å‹ï¼Œè¿™ç§çŠ¶æ€ä¼šç›¸å¯¹è¿…é€Ÿåœ°å‘ç”Ÿå˜åŒ–ã€‚å®ƒå°†åƒ&lt;a href=&#34;https://istio.io/latest/docs/releases/feature-stages/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ‰€æœ‰å…¶ä»– Istio åŠŸèƒ½&lt;/a&gt;ä¸€æ ·é€šè¿‡åŠŸèƒ½é˜¶æ®µè¿›è¡Œã€‚æŸ¥çœ‹&lt;a href=&#34;https://istio.io/latest/docs/releases/feature-stages/#istio-features&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Istio åŠŸèƒ½åˆ—è¡¨&lt;/a&gt;ï¼ŒAmbient Meshå°†åœ¨ 2023 å¹´æŸä¸ªæ—¶å€™å‡çº§ä¸º Alpha çŠ¶æ€ã€‚æˆ‘ä»¬é¢„è®¡å®ƒä¼šåœ¨ 2023 å¹´æœ«æˆ– 2024 å¹´åˆè¿›å…¥ Beta ç‰ˆ â€”â€” åœ¨æ­¤ä¹‹å‰æˆ‘ä»¬ä¸å»ºè®®å°†å…¶ç”¨äºç”Ÿäº§ç”¨é€”ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å…³äº-service-mesh-å’Œ-istio-çš„ambient-meshå‡è®¾&#34;&gt;å…³äº Service Mesh å’Œ Istio çš„Ambient Meshå‡è®¾&lt;/h2&gt;
&lt;p&gt;æ€»ç»“Ambient Meshå…¬å‘Šåšå®¢æ–‡ç« ï¼Œè¯¥æ¶æ„çš„æ ¸å¿ƒåŠ¨æœºæ˜¯å‡è®¾ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;å‡è®¾&lt;/strong&gt;Envoy çš„ L7 åŠŸèƒ½ä½¿å¾—å°†æ–°åº”ç”¨ç¨‹åºåŠ å…¥ç½‘æ ¼å˜å¾—å…·æœ‰æŒ‘æˆ˜æ€§ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‡è®¾&lt;/strong&gt;Envoy çš„ L7 åŠŸèƒ½æ˜¯å‘ç° CVE çš„åœ°æ–¹ï¼ˆç»å¤§å¤šæ•° Envoy CVE åœ¨ L7 ä»£ç ä¸­ï¼Œè€Œä¸æ˜¯åœ¨å¤„ç† TLS å’Œè¿æ¥çš„ L4 ä»£ç ä¸­ï¼‰ï¼Œå› æ­¤åœ¨ä¸¥æ ¼çš„ L4 ä»£ç†ä¸­åœ¨èŠ‚ç‚¹çº§åˆ«æŒæœ‰å¤šä¸ª Pod çš„è¯ä¹¦æ˜¯å¯ä»¥æ¥å—çš„ï¼Œè€Œåœ¨èŠ‚ç‚¹çº§åˆ«æ‰§è¡Œ L7 åˆ™ä¸æ˜¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‡è®¾&lt;/strong&gt;Sidecar é€šå¸¸ä¼šå¯¼è‡´èµ„æºè¿‡åº¦åˆ†é…ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‡è®¾&lt;/strong&gt;ä¸€ä¸ªé¢å¤–çš„ç½‘ç»œè·ƒç‚¹æ¯”ä¸€ä¸ªæ‰§è¡Œ L7 è®¡ç®—çš„ Envoy ä¾¿å®œï¼ˆä»ä¸¤ä¸ª L7 sidecar ç§»åŠ¨åˆ°ä¸€ä¸ª L7 è·¯ç‚¹å¢åŠ äº†ä¸€ä¸ªè·ƒç‚¹ï¼Œä½†åˆ é™¤äº†ä¸€ä¸ªæ‰§è¡Œ L7 å¤„ç†çš„ Envoyï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å‡è®¾&lt;/strong&gt;Istio æœ€æœ‰ä»·å€¼çš„ç‰¹æ€§æ˜¯ä¼ è¾“ä¸­çš„åŠ å¯†ï¼Œå› æ­¤ä¼˜åŒ–ä»¥ç®€åŒ–è¯¥ç”¨ä¾‹æ˜¯å¾ˆæœ‰ä»·å€¼çš„ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;ambient-meshå‡è®¾å¦‚ä½•åŒ¹é…æˆ‘ä»¬ä¸å®é™…å®¢æˆ·çš„ç»éªŒ&#34;&gt;Ambient Meshå‡è®¾å¦‚ä½•åŒ¹é…æˆ‘ä»¬ä¸å®é™…å®¢æˆ·çš„ç»éªŒ&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬ä¸ä¸–ç•Œä¸Šä¸€äº›æœ€å¤§çš„ä¼ä¸šå¯†åˆ‡åˆä½œä»¥å®ç°æœåŠ¡ç½‘æ ¼é‡‡ç”¨çš„ç»éªŒå¹¶&lt;strong&gt;ä¸èƒ½å®Œå…¨&lt;/strong&gt;è¯æ˜è¿™äº›æ¿€åŠ±æƒ³æ³•ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;L7 åŠŸèƒ½&lt;/strong&gt;ï¼šç½‘æ ¼çš„æŸäº› L7 åŠŸèƒ½&lt;strong&gt;å¯èƒ½&lt;/strong&gt;ä¼šä½¿åº”ç”¨ç¨‹åºæ›´éš¾é‡‡ç”¨ï¼Œä½†æ ¹æ®æˆ‘ä»¬çš„ç»éªŒï¼Œç”±äºè¿æ¥å¯¿å‘½çš„å˜åŒ–æˆ–åŒé‡åŠ å¯†é—®é¢˜ï¼Œåº”ç”¨ç¨‹åºè½½å…¥ä¸­ä¼šå‡ºç°æ›´å¤šçš„ä¸­æ–­ã€‚æ— è®º sidecar æˆ–èŠ‚ç‚¹çº§ä»£ç†å¦‚ä½•ï¼Œè¿™äº›é—®é¢˜éƒ½ä¼šç±»ä¼¼åœ°è¡¨ç°å‡ºæ¥ï¼Œä½†å¯¹äºåº”ç”¨ç¨‹åºå›¢é˜Ÿåœ¨èŠ‚ç‚¹éƒ¨ç½²æ¨¡å‹ä¸­è¿›è¡Œæ•…éšœæ’é™¤æ›´å…·æŒ‘æˆ˜æ€§ï¼ˆä»–ä»¬é€šå¸¸ç¼ºä¹æ£€æŸ¥ç‰¹æƒ / èŠ‚ç‚¹çº§ç»„ä»¶æ—¥å¿—çš„æƒé™ï¼‰ã€‚è¦æ›´æ·±å…¥åœ°äº†è§£&lt;a href=&#34;https://www.tetrate.io/blog/ebpf-and-sidecars-getting-the-most-performance-and-resiliency-out-of-the-service-mesh/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;èŠ‚ç‚¹çº§ä»£ç†ä¸sidecar&lt;/a&gt;ï¼Œè¯·å‚é˜…æˆ‘ä»¬ä¸Šé¢æåˆ°çš„åšå®¢æ–‡ç« ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;L7 CVE&lt;/strong&gt;ï¼Œ&lt;a href=&#34;https://www.cvedetails.com/vulnerability-list/vendor_id-19794/product_id-53798/Envoyproxy-Envoy.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æŸ¥çœ‹å®ƒä»¬&lt;/a&gt;ï¼Œæˆ‘ä»¬çœ‹åˆ°ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;33 ä¸ªå’Œ L7 å¤„ç†æœ‰å…³ï¼Œä¸»è¦æ˜¯è§£ææˆ–è€… HTTP å¤„ç†ã€‚&lt;/li&gt;
&lt;li&gt;å‰©ä¸‹çš„ 12 ä¸ªæ˜¯ L4 æˆ– Envoy å›ºæœ‰çš„ï¼ˆè¿æ¥å¤„ç†ã€è¯ä¹¦å¤„ç†ã€å˜ˆæ‚çš„é‚»å±… DOSã€ç¼“å†²åŒºæº¢å‡ºç­‰ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;L7 CVE çš„å¹³å‡ä¸¥é‡æ€§é«˜äºé L7 CVEã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸ L7 Envoy ç›¸æ¯”ï¼Œä»… L4 çš„ Envoy &lt;strong&gt;ç¡®å®&lt;/strong&gt;æä¾›äº†æ›´å°çš„æ”»å‡»é¢ï¼Œå› ä¸ºå¯ä»¥åˆ©ç”¨çš„ä»£ç ï¼ˆå’Œ CVEï¼‰æ›´å°‘ã€‚æ”»å‡»é¢æ˜¯å¦è¶³å¤Ÿä½ä»¥è¯æ˜æŒæœ‰èŠ‚ç‚¹ä¸Šæ¯ä¸ª pod çš„èº«ä»½æ˜¯åˆç†çš„ï¼Œè¿˜æœ‰å¾…è§‚å¯Ÿã€‚Ambient Meshå®‰å…¨æ¨¡å‹çš„å…³é”®åœ¨äºæˆ‘ä»¬å¯¹ ztunnel ç»„ä»¶çš„ä¿¡ä»»ç¨‹åº¦ â€”â€” è¿™æ˜¯ç¤¾åŒºæ‰“ç®—é¦–å…ˆå…³æ³¨çš„ç»„ä»¶ã€‚æ€»ä½“è€Œè¨€ï¼Œä¸sidecaræ¨¡å‹ç›¸æ¯”ï¼Œambient çš„å®‰å…¨æ¨¡å‹å……å…¶é‡æ˜¯æ¨ªå‘çš„ä¸€æ­¥ï¼Œä½†åœ¨å°†å…¶èå…¥ç°æœ‰å®‰å…¨æ¨¡å‹æ—¶ï¼Œè¾¹ç•Œæ›´éš¾æ¨ç†ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;èµ„æºåˆ©ç”¨ç‡&lt;/strong&gt;ï¼šç¡®å®ï¼Œå¦‚æœæœªé…ç½® pod èµ„æºè¯·æ±‚ï¼Œå¹¶ä¸”æœªä½¿ç”¨&lt;a href=&#34;https://istio.io/latest/docs/ops/best-practices/traffic-management/#cross-namespace-configuration&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;é…ç½®èµ„æºå¯è§æ€§&lt;/a&gt;æˆ–&lt;a href=&#34;https://istio.io/latest/docs/reference/config/networking/sidecar/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Sidecar API èµ„æº&lt;/a&gt;ç­‰æŠ€æœ¯ï¼Œsidecar ä¼šå¯¼è‡´èµ„æºåˆ©ç”¨ç‡ä½ä¸‹ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬é€šè¿‡ Sidecar API èµ„æºä¸¥æ ¼æ§åˆ¶èµ„æºå¯è§æ€§å’Œé™åˆ¶é…ç½®èŒƒå›´çš„ Istio éƒ¨ç½²çš„ç»éªŒæ˜¯ï¼Œsidecar èµ„æºåˆ©ç”¨ç‡éå¸¸ä½ï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥ä¸ºæ¯ä¸ª sidecar è®¾ç½®æ¯” Istio çš„é»˜è®¤é…ç½®æ–‡ä»¶æ›´å°çš„èµ„æºè¯·æ±‚ã€‚ä¸ºè¿™ç§ç±»å‹çš„é…ç½®æ‰‹åŠ¨ç»´æŠ¤ Sidecar API èµ„æºéå¸¸å…·æœ‰æŒ‘æˆ˜æ€§ â€”â€” è¿™å°±æ˜¯ &lt;a href=&#34;https://www.tetrate.io/tetrate-service-bridge/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tetrate Service Bridge&lt;/a&gt; æ ¹æ®æ›´é«˜çº§åˆ«çš„è®¿é—®ç»“æ„è‡ªåŠ¨ç”Ÿæˆå®ƒçš„åŸå› ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¾ˆé«˜å…´çœ‹åˆ° Ambient éƒ¨ç½²æ¨¡å‹å¦‚ä½•æé«˜èµ„æºåˆ©ç”¨ç‡ â€”â€” ä¸ºç›¸åŒçš„ç½‘æ ¼è¡Œä¸ºéƒ¨ç½²æ›´å°‘çš„ Envoy å…·æœ‰å¾ˆå¤§çš„æ½œåŠ›ï¼Œå› ä¸ºç‹¬ç«‹çš„ Watpoint Envoy é€šå¸¸å¯ä»¥å¤„ç†æ¯”å•ä¸ªæœåŠ¡å®ä¾‹ï¼ˆåŠå…¶sidecarï¼‰æ›´å¤šçš„æµé‡ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;é¢å¤–çš„ç½‘ç»œè·ƒç‚¹ä¸ sidecar&lt;/strong&gt;ï¼šAmbient çš„éƒ¨ç½²æ¨¡å‹æä¾›çš„æœ€æœ‰è¶£çš„å¯èƒ½æ€§ä¹‹ä¸€æ˜¯åœ¨ sidecar æ¶æ„ä¸­ç§»é™¤é¢å¤–çš„ L7 Envoyã€‚å› ä¸ºç½‘æ ¼ä¸­çš„é€šä¿¡æ˜¯ sidecar-to-sidecarï¼Œå¹¶ä¸”å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨éƒ½åº”ç”¨ L7 ç­–ç•¥ï¼Œæˆ‘ä»¬å¿…é¡»å¯¹æ¯ä¸ªè¯·æ±‚è¿›è¡Œä¸¤æ¬¡ L7 å¤„ç†ã€‚åœ¨Ambientæ¨¡å¼ä¸‹ï¼Œè¯¥ç­–ç•¥å°†ç”±æœåŠ¡å™¨çš„ Waypoint æ‰§è¡Œ â€”â€” å› æ­¤ L7 å¤„ç†æ¯ä¸ªè¯·æ±‚åªå‘ç”Ÿä¸€æ¬¡ã€‚ä½†æ˜¯ï¼Œåœ¨è¿æ¥çš„ä¸¤ä¾§ä»ç„¶æœ‰ä¸€ä¸ª ztunnel è¿›è¡Œ L4 å¤„ç†ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ç§æƒè¡¡ â€”â€” ç½‘ç»œè·³è·ƒè€Œä¸æ˜¯ Envoy è¿›è¡Œ L7 å¤„ç† â€”â€” æ€»ä½“ä¸Šæ˜¯å¦å€¼å¾—ï¼Œè¿˜æœ‰å¾…è§‚å¯Ÿã€‚å½“ç„¶ï¼Œåœ¨å»¶è¿Ÿä½ä¸”è¿æ¥å¯é çš„åŒä¸€å¯ç”¨åŒºçš„äº‘æä¾›å•†ç½‘ç»œä¸­ï¼Œè¿™å¯èƒ½æ˜¯å€¼å¾—çš„ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬çš„è®¸å¤šå®¢æˆ·åœ¨æœ¬åœ°å’Œå„ç§çœ‹èµ·æ¥ä¸åƒäº‘æä¾›å•†ç½‘ç»œçš„ç‰©ç†ç«™ç‚¹ä¸Šéƒ¨ç½²äº†æœåŠ¡ç½‘æ ¼ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;mTLS&lt;/strong&gt;ï¼šIstio çš„ä¼ è¾“åŠ å¯†æ¯«æ— ç–‘é—®æ˜¯å…¶æœ€å¼ºå¤§çš„åŠŸèƒ½ä¹‹ä¸€ã€‚å®ƒç”¨äºï¼ˆ&lt;a href=&#34;https://www.tetrate.io/blog/tetrate-istio-distro-achieves-fips-certification/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä»¥ FIPS éªŒè¯çš„å½¢å¼&lt;/a&gt;ï¼‰ç”¨äº&lt;a href=&#34;https://www.tetrate.io/blog/tetrate-first-to-provide-hardened-istio-to-dods-iron-bank/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;FIPS åˆè§„æ€§&lt;/a&gt;ã€&lt;a href=&#34;https://www.tetrate.io/blog/case-study-fico-encryption-pci-compliance-with-istio-service-mesh/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;PCI åˆè§„æ€§&lt;/a&gt;ï¼Œä»¥åŠåœ¨å„ç§å…¶ä»–å®‰å…¨ç¬¬ä¸€çš„ç¯å¢ƒä¸­ã€‚ä½†æ˜¯ï¼Œå½“æˆ‘ä»¬æŸ¥çœ‹ç½‘æ ¼çš„åŠŸèƒ½æ—¶ï¼Œå•ç‹¬é‡‡ç”¨åŠ å¯†çš„åŸå› å¹¶ä¸å¸¸è§ï¼šé€šå¸¸æ˜¯åŠ å¯†ä¸ L7 ç­–ç•¥ï¼ˆåŒ…æ‹¬æµé‡æ§åˆ¶ï¼‰å’Œå¯è§‚æµ‹æ€§ç›¸ç»“åˆï¼Œæ¿€å‘äº†å¯¹è¯¥æŠ€æœ¯çš„æŠ•èµ„ã€‚æŸ¥çœ‹ä¸Šè¡¨ï¼Œå¾ˆæ˜æ˜¾è¿™äº›åŠŸèƒ½æ— æ³•ä»…é€šè¿‡ ztunnel å®ç° â€”â€” å®ƒä»¬éœ€è¦ L7 Envoyã€‚äº‹å®ä¸Šï¼Œæˆ‘ä»¬ä»Šå¤©çœ‹åˆ°çš„å¤§å¤šæ•°ç½‘æ ¼ä½¿ç”¨éƒ½éœ€è¦ L7 Envoyã€‚æˆ‘ä»¬å¯¹ä»»ä½•èƒ½å¤Ÿä½¿æœåŠ¡ç½‘æ ¼çš„é‡‡ç”¨æ›´åŠ å®¹æ˜“çš„äº‹æƒ…éƒ½å……æ»¡çƒ­æƒ…ï¼Œä½†æˆ‘ä»¬è¿˜ä¸ç¡®å®šAmbient Meshçš„éƒ¨ç½²æ¨¡å‹èƒ½å¦èƒ½å…‘ç°è¿™ä¸€æ‰¿è¯ºã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;å…³äºambient-meshçš„åˆ†ç¦»æ€è€ƒ&#34;&gt;å…³äºAmbient Meshçš„åˆ†ç¦»æ€è€ƒ&lt;/h2&gt;
&lt;p&gt;Ambient Meshæ˜¯å¯¹æ— sidecaræœåŠ¡ç½‘æ ¼æ¨¡å‹çš„ä¸€ä¸ªæœ‰è¶£çš„å°è¯•ã€‚æˆ‘ä»¬å¾ˆé«˜å…´çœ‹åˆ°å®ƒæ˜¯å¦‚ä½•å‘å±•çš„ï¼Œç‰¹åˆ«æ˜¯å¦‚æœå®ƒæœ‰åŠ©äºæ›´å®¹æ˜“åœ°é‡‡ç”¨ç½‘æ ¼ã€‚åœ¨æŸäº›ç‰¹å®šçš„ç”¨ä¾‹ä¸­ï¼Œæˆ‘ä»¬é¢„è®¡è¿™ç§æ–¹æ³•ä¼šäº§ç”Ÿå¥½å¤„ï¼Œä½†ç°åœ¨è¿˜å¤„äºæ—©æœŸé˜¶æ®µï¼Œè€Œä¸”è¿˜æ²¡æœ‰å†³å®šæƒè¡¡æ˜¯å¦å€¼å¾—ã€‚æ— è®ºå“ªç§æ–¹å¼ï¼ŒAmbient Meshå¯èƒ½éœ€è¦ä¸€æ®µæ—¶é—´æ‰èƒ½è€ƒè™‘æŠ•å…¥ç”Ÿäº§ã€‚åœ¨é‚£ä¹‹å‰ï¼Œæ­£å¦‚ä»–ä»¬æ‰€è¯´ï¼Œæ³¨æ„è¿™ä¸ªç©ºé—´ã€‚&lt;/p&gt;
&lt;p&gt;è¦&lt;a href=&#34;https://istio.tetratelabs.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç«‹å³å¼€å§‹ä½¿ç”¨æœåŠ¡ç½‘æ ¼ï¼ŒTetrate Istio Distro&lt;/a&gt;æ˜¯å®‰è£…ã€ç®¡ç†å’Œå‡çº§ Istio çš„æœ€ç®€å•æ–¹æ³•ã€‚å®ƒæä¾›äº†ç»è¿‡å®¡æŸ¥çš„ Istio ä¸Šæ¸¸å‘è¡Œç‰ˆï¼Œè¯¥å‘è¡Œç‰ˆå·²ç”± Tetrate ä¸ºç‰¹å®šå¹³å°è¿›è¡Œæµ‹è¯•å’Œä¼˜åŒ–ï¼Œä»¥åŠä¸€ä¸ªä¾¿äºè·å–ã€å®‰è£…å’Œé…ç½®å¤šä¸ª Istio ç‰ˆæœ¬çš„ CLIã€‚Tetrate Istio Distro è¿˜ä¸º FedRAMP ç¯å¢ƒæä¾›&lt;a href=&#34;https://www.tetrate.io/blog/tetrate-istio-distro-achieves-fips-certification/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;FIPS è®¤è¯çš„ Istio æ„å»º&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºéœ€è¦ç»Ÿä¸€ä¸”ä¸€è‡´çš„æ–¹å¼æ¥ä¿æŠ¤å’Œç®¡ç†å¤æ‚ã€å¼‚æ„éƒ¨ç½²ç¯å¢ƒä¸­çš„æœåŠ¡å’Œä¼ ç»Ÿå·¥ä½œè´Ÿè½½çš„ä¼ä¸šï¼Œæˆ‘ä»¬æä¾›&lt;a href=&#34;https://www.tetrate.io/tetrate-service-bridge/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tetrate Service Bridge&lt;/a&gt;ï¼Œè¿™æ˜¯æˆ‘ä»¬åŸºäº Istio å’Œ Envoy æ„å»ºçš„æ——èˆ°è¾¹ç¼˜åˆ°å·¥ä½œè´Ÿè½½åº”ç”¨ç¨‹åºè¿æ¥å¹³å°ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Istio æœåŠ¡ç½‘æ ¼ ambient æ¨¡å¼å®‰å…¨è¯¦è§£</title>
      <link>https://lib.jimmysong.io/blog/ambient-security/</link>
      <pubDate>Thu, 08 Sep 2022 12:00:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/ambient-security/</guid>
      <description>&lt;p&gt;æˆ‘ä»¬æœ€è¿‘å‘å¸ƒäº† Istio Ambient Meshï¼ˆè¯‘è€…æ³¨ï¼šç¬”è€…æ›´å€¾å‘äºå°†å…¶ç§°ä¸º Ambient Modeï¼Œå³å¤–å›´æ¨¡å¼ï¼Œä½†è¯‘æ–‡ä¸­ä»ç„¶ä¿ç•™äº† Ambient Mesh çš„å«æ³•ï¼‰ï¼Œå®ƒæ˜¯ Istio çš„æ—  sidecar æ•°æ®å¹³é¢ã€‚å¦‚&lt;a href=&#34;https://lib.jimmysong.io/blog/introducing-ambient-mesh/&#34;&gt;å…¬å‘Šåšå®¢ä¸­æ‰€è¿°&lt;/a&gt;ï¼Œæˆ‘ä»¬ä½¿ç”¨ Ambient Mesh è§£å†³çš„é¦–è¦é—®é¢˜æ˜¯ç®€åŒ–æ“ä½œã€æ›´å¹¿æ³›çš„åº”ç”¨ç¨‹åºå…¼å®¹æ€§ã€é™ä½åŸºç¡€è®¾æ–½æˆæœ¬å’Œæé«˜æ€§èƒ½ã€‚åœ¨è®¾è®¡ ambient æ•°æ®å¹³é¢æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨ä¸ç‰ºç‰²å®‰å…¨æ€§æˆ–åŠŸèƒ½çš„æƒ…å†µä¸‹ä»”ç»†å¹³è¡¡è¿ç»´ã€æˆæœ¬å’Œæ€§èƒ½æ–¹é¢çš„é—®é¢˜ã€‚éšç€ ambient ç»„ä»¶åœ¨åº”ç”¨ç¨‹åº pod ä¹‹å¤–è¿è¡Œï¼Œå®‰å…¨è¾¹ç•Œå‘ç”Ÿäº†å˜åŒ– â€”â€” æˆ‘ä»¬ç›¸ä¿¡ä¼šå˜å¾—æ›´å¥½ã€‚åœ¨è¿™ç¯‡åšå®¢ä¸­ï¼Œæˆ‘ä»¬å°†è¯¦ç»†ä»‹ç»è¿™äº›å®‰å…¨æ€§å˜åŒ–ä»¥åŠå®ƒä»¬ä¸ sidecar éƒ¨ç½²æ¨¡å¼åœ¨å®‰å…¨æ€§æ–¹é¢çš„å¯¹æ¯”ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-ambient-mesh-çš„åˆ†å±‚ç¤ºæ„å›¾&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Ambient Mesh çš„åˆ†å±‚ç¤ºæ„å›¾&#34;
           src=&#34;https://lib.jimmysong.io/blog/ambient-security/amibent-mesh-layer.svg&#34;
           loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      Ambient Mesh çš„åˆ†å±‚ç¤ºæ„å›¾
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;å›é¡¾ä¸€ä¸‹ï¼ŒIstio Ambient Mesh å¼•å…¥äº†ä¸€ä¸ªåˆ†å±‚ç½‘æ ¼æ•°æ®å¹³é¢ï¼Œå®ƒå…·æœ‰è´Ÿè´£ä¼ è¾“å®‰å…¨å’Œè·¯ç”±çš„å®‰å…¨è¦†ç›–å±‚ï¼Œå¯ä»¥é€‰æ‹©ä¸ºéœ€è¦å®ƒä»¬çš„å‘½åç©ºé—´æ·»åŠ  L7 åŠŸèƒ½ã€‚è¦äº†è§£æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…&lt;a href=&#34;https://istio.io/latest/blog/2022/introducing-ambient-mesh/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å…¬å‘Šåšå®¢&lt;/a&gt;å’Œ&lt;a href=&#34;https://istio.io/latest/blog/2022/get-started-ambient&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å…¥é—¨åšå®¢&lt;/a&gt;ã€‚å®‰å…¨è¦†ç›–å±‚åŒ…æ‹¬ä¸€ä¸ªèŠ‚ç‚¹å…±äº«ç»„ä»¶ ztunnelï¼Œå®ƒè´Ÿè´£ L4 é¥æµ‹å’Œéƒ¨ç½²ä¸º DaemonSet çš„ mTLSã€‚ç½‘æ ¼çš„ L7 å±‚ç”± Waypoint ä»£ç†æä¾›ï¼Œå®Œæ•´çš„ L7 Envoy ä»£ç†æŒ‰èº«ä»½/å·¥ä½œè´Ÿè½½ç±»å‹éƒ¨ç½²ã€‚è¿™ç§è®¾è®¡çš„ä¸€äº›åŸºæœ¬åŸåˆ™åŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åº”ç”¨ç¨‹åºä¸æ•°æ®å¹³é¢åˆ†ç¦»&lt;/li&gt;
&lt;li&gt;å®‰å…¨è¦†ç›–å±‚çš„ç»„ä»¶ç±»ä¼¼äº CNI&lt;/li&gt;
&lt;li&gt;æ“ä½œç®€å•æ›´åˆ©äºå®‰å…¨&lt;/li&gt;
&lt;li&gt;é¿å…å¤šç§Ÿæˆ· L7 ä»£ç†&lt;/li&gt;
&lt;li&gt;Sidecar ä»ç„¶æ˜¯é¦–é€‰çš„éƒ¨ç½²æ¨¡å¼ä¹‹ä¸€&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;åº”ç”¨ç¨‹åºå’Œæ•°æ®å¹³é¢åˆ†ç¦»&#34;&gt;åº”ç”¨ç¨‹åºå’Œæ•°æ®å¹³é¢åˆ†ç¦»&lt;/h2&gt;
&lt;p&gt;å°½ç®¡ Ambient Mesh çš„ä¸»è¦ç›®æ ‡æ˜¯ç®€åŒ–æœåŠ¡ç½‘æ ¼çš„æ“ä½œï¼Œä½†å®ƒä¹Ÿç¡®å®æœ‰åŠ©äºæé«˜å®‰å…¨æ€§ã€‚å¤æ‚æ€§ä¼šæ»‹ç”Ÿæ¼æ´ï¼Œä¼ä¸šåº”ç”¨ç¨‹åºï¼ˆåŠå…¶ä¼ é€’ä¾èµ–é¡¹ã€åº“å’Œæ¡†æ¶ï¼‰æå…¶å¤æ‚ä¸”å®¹æ˜“å‡ºç°æ¼æ´ã€‚ä»å¤„ç†å¤æ‚çš„ä¸šåŠ¡é€»è¾‘åˆ°åˆ©ç”¨ OSS åº“æˆ–æœ‰ç¼ºé™·çš„å†…éƒ¨å…±äº«åº“ï¼Œæ”»å‡»è€…ï¼ˆæ¥è‡ªå†…éƒ¨æˆ–å¤–éƒ¨ï¼‰çš„ä¸»è¦ç›®æ ‡æ˜¯ç”¨æˆ·çš„åº”ç”¨ç¨‹åºä»£ç ã€‚å¦‚æœåº”ç”¨ç¨‹åºé­åˆ°ç ´åï¼Œå‡­æ®ã€æœºå¯†å’Œå¯†é’¥å°±ä¼šæš´éœ²ç»™æ”»å‡»è€…ï¼ŒåŒ…æ‹¬é‚£äº›å®‰è£…æˆ–å­˜å‚¨åœ¨å†…å­˜ä¸­çš„æ•°æ®ã€‚åœ¨æŸ¥çœ‹ sidecar æ¨¡å‹æ—¶ï¼Œsidecar æ¥ç®¡åº”ç”¨ç¨‹åºä¸­çš„èº«ä»½/å¯†é’¥ææ–™ã€‚ åœ¨ Istio ambient æ¨¡å¼ä¸‹ï¼Œæ•°æ®å¹³é¢ç»„ä»¶ä¸ä¼šä¸åº”ç”¨ç¨‹åºè¿è¡Œåœ¨åŒä¸€ä¸ª pod ä¸­ï¼Œå› æ­¤ï¼Œåº”ç”¨ç¨‹åºçš„ä¸­çš„ç§˜å¯†ä¸ä¼šæ³„éœ²ç»™æ•°æ®å¹³é¢ã€‚&lt;/p&gt;
&lt;p&gt;ä½œä¸ºæ¼æ´çš„æ½œåœ¨ç›®æ ‡ï¼ŒEnvoy Proxy æ€ä¹ˆæ ·ï¼ŸEnvoy æ˜¯ä¸€ä¸ªç»è¿‡ä¸¥æ ¼å®¡æŸ¥çš„æå…¶åšå›ºçš„åŸºç¡€è®¾æ–½ï¼Œå¹¶&lt;a href=&#34;https://www.infoq.com/news/2018/12/envoycon-service-mesh/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;åœ¨å…³é”®ç¯å¢ƒä¸­å¤§è§„æ¨¡è¿è¡Œ&lt;/a&gt;ï¼ˆä¾‹å¦‚ï¼Œ&lt;a href=&#34;https://cloud.google.com/load-balancing/docs/https&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç”¨äºç”Ÿäº§ä»¥æ”¯æŒ Google çš„ç½‘ç»œ&lt;/a&gt;ï¼‰ã€‚ç„¶è€Œï¼Œç”±äº Envoy æ˜¯è½¯ä»¶ï¼Œå®ƒä¸èƒ½å…å—æ¼æ´çš„å½±å“ã€‚å½“æ¼æ´å‡ºç°æ—¶ï¼ŒEnvoy æœ‰ä¸€ä¸ªå¼ºå¤§çš„ CVE æµç¨‹æ¥è¯†åˆ«å¿«é€Ÿä¿®å¤å®ƒä»¬ï¼Œå¹¶åœ¨å®ƒä»¬äº§ç”Ÿå¹¿æ³›å½±å“ä¹‹å‰å°†è¡¥ä¸æ¨é€ç»™å®¢æˆ·ã€‚&lt;/p&gt;
&lt;p&gt;å›åˆ°å‰é¢ â€œå¤æ‚æ€§æ»‹ç”Ÿæ¼æ´â€ çš„è¯„è®ºï¼ŒEnvoy Proxy æœ€å¤æ‚çš„éƒ¨åˆ†åœ¨äºå…¶ L7 å¤„ç†ï¼Œäº‹å®ä¸Šï¼Œå†å²ä¸Š Envoy çš„å¤§å¤šæ•°æ¼æ´éƒ½åœ¨å…¶ L7 å¤„ç†å †æ ˆä¸­ã€‚ä½†æ˜¯ï¼Œå¦‚æœä½ åªå°† Istio ç”¨äº mTLS ä¼šæ€æ ·ï¼Ÿå½“ä½ ä¸ä½¿ç”¨è¯¥åŠŸèƒ½æ—¶ï¼Œä¸ºä»€ä¹ˆè¦å†’é™©éƒ¨ç½²ä¸€ä¸ªæ›´å®¹æ˜“å‘ç”Ÿ CVE çš„æˆç†Ÿ L7 ä»£ç†ï¼Ÿåˆ†ç¦» L4 å’Œ L7 ç½‘æ ¼åŠŸèƒ½åœ¨è¿™é‡Œå¾ˆæœ‰ç”¨ã€‚åœ¨ Sidecar éƒ¨ç½²ä¸­ï¼Œä½ é‡‡ç”¨æ‰€æœ‰ä»£ç†ï¼Œå³ä½¿ä½ åªä½¿ç”¨ä¸€å°éƒ¨åˆ†åŠŸèƒ½ï¼Œåœ¨ ambient æ¨¡å¼ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æä¾›å®‰å…¨è¦†ç›–å¹¶ä»…æ ¹æ®éœ€è¦åœ¨ L7 ä¸­åˆ†å±‚æ¥é™åˆ¶æš´éœ²ã€‚æ­¤å¤–ï¼ŒL7 ç»„ä»¶å®Œå…¨ç‹¬ç«‹äºåº”ç”¨ç¨‹åºè¿è¡Œï¼Œä¸ä¼šæš´éœ²ä¾›æ”»å‡»é¢ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å°†-l4-ä¸‹æ¨åˆ°-cni&#34;&gt;å°† L4 ä¸‹æ¨åˆ° CNI&lt;/h2&gt;
&lt;p&gt;Ambient æ•°æ®å¹³é¢çš„ L4 ç»„ä»¶ä½œä¸º DaemonSet è¿è¡Œï¼Œæˆ–è€…è¯´æ¯ä¸ªèŠ‚ç‚¹ä¸€ä¸ªã€‚è¿™æ„å‘³ç€å®ƒæ˜¯åœ¨ç‰¹å®šèŠ‚ç‚¹ä¸Šè¿è¡Œçš„æ‰€æœ‰ Pod çš„å…±äº«åŸºç¡€æ¶æ„ã€‚è¿™ä¸ªç»„ä»¶ç‰¹åˆ«æ•æ„Ÿï¼Œåº”è¯¥ä¸èŠ‚ç‚¹ä¸Šçš„ä»»ä½•å…¶ä»–å…±äº«ç»„ä»¶ï¼ˆä¾‹å¦‚ä»»ä½• CNI ä»£ç†ã€kube-proxyã€kubelet ç”šè‡³ Linux å†…æ ¸ï¼‰å¤„äºåŒä¸€çº§åˆ«ã€‚æ¥è‡ªå·¥ä½œè´Ÿè½½çš„æµé‡è¢«é‡å®šå‘åˆ° ztunnelï¼Œztunnel ç„¶åè¯†åˆ«å·¥ä½œè´Ÿè½½å¹¶é€‰æ‹©æ­£ç¡®çš„è¯ä¹¦æ¥ä»£è¡¨ mTLS è¿æ¥ä¸­çš„å·¥ä½œè´Ÿè½½ã€‚&lt;/p&gt;
&lt;p&gt;ztunnel ä¸ºæ¯ä¸ª pod ä½¿ç”¨ä¸€ä¸ªç‹¬ç‰¹çš„å‡­è¯ï¼Œåªæœ‰å½“ pod åœ¨å½“å‰èŠ‚ç‚¹ä¸Šè¿è¡Œæ—¶æ‰ä¼šè¢«å‘å‡ºã€‚è¿™ç¡®ä¿äº†è¢«ç ´åçš„ ztunnel çš„çˆ†ç‚¸åŠå¾„â€”â€”åªæœ‰è°ƒåº¦åˆ°å½“å‰èŠ‚ç‚¹ä¸Šçš„ pod çš„å‡­è¯å¯ä»¥è¢«ç›—ã€‚è¿™æ˜¯ä¸€ä¸ªç±»ä¼¼äºå…¶ä»–å®ç°è‰¯å¥½çš„å…±äº«èŠ‚ç‚¹åŸºç¡€è®¾æ–½çš„å±æ€§ï¼ŒåŒ…æ‹¬å…¶ä»–å®‰å…¨ CNI å®ç°ã€‚ztunnel ä¸ä½¿ç”¨é›†ç¾¤èŒƒå›´æˆ–æ¯ä¸ªèŠ‚ç‚¹çš„å‡­è¯ï¼Œå¦‚æœè¢«ç›—ï¼Œå¯èƒ½ä¼šç«‹å³å±åŠé›†ç¾¤ä¸­çš„æ‰€æœ‰åº”ç”¨æµé‡ï¼Œé™¤éè¿™äº›åº”ç”¨ä¹Ÿå®æ–½å¤æ‚çš„äºŒçº§æˆæƒæœºåˆ¶ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæˆ‘ä»¬å°†å…¶ä¸ sidecar æ¨¡å¼è¿›è¡Œæ¯”è¾ƒï¼Œæˆ‘ä»¬ä¼šæ³¨æ„åˆ° ztunnel æ˜¯å…±äº«çš„ï¼Œå®ƒçš„æš´éœ²å¯èƒ½å¯¼è‡´èŠ‚ç‚¹ä¸Šè¿è¡Œçš„åº”ç”¨ç¨‹åºçš„èº«ä»½æ³„éœ²ã€‚ä½†æ˜¯ï¼Œè¯¥ç»„ä»¶ä¸­å‡ºç° CVE çš„å¯èƒ½æ€§ä½äº Istio sidecarï¼Œå› ä¸ºæ”»å‡»é¢å¤§å¤§å‡å°‘ï¼ˆä»… L4 å¤„ç†ï¼‰ï¼›ztunnel ä¸åšä»»ä½• L7 å¤„ç†ã€‚æ­¤å¤–ï¼Œsidecar ä¸­çš„ CVEï¼ˆå…·æœ‰æ›´å¤§çš„ L7 æ”»å‡»é¢ï¼‰å¹¶æ²¡æœ‰çœŸæ­£åŒ…å«åœ¨å—åˆ°æŸå®³çš„ç‰¹å®šå·¥ä½œè´Ÿè½½ä¸­ã€‚Sidecar ä¸­çš„æ‰€æœ‰ä¸¥é‡çš„ CVE éƒ½å¯èƒ½åœ¨ç½‘æ ¼ä¸­çš„ä»»ä½•å·¥ä½œè´Ÿè½½å¤ç°ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ“ä½œç®€å•æ›´åˆ©äºå®‰å…¨&#34;&gt;æ“ä½œç®€å•æ›´åˆ©äºå®‰å…¨&lt;/h2&gt;
&lt;p&gt;å½’æ ¹ç»“åº•ï¼ŒIstio æ˜¯ä¸€ä¸ªå…³é”®çš„åŸºç¡€è®¾æ–½ï¼Œå¿…é¡»è¿›è¡Œç»´æŠ¤ã€‚Istio ä»£è¡¨åº”ç”¨ç¨‹åºå®æ–½é›¶ä¿¡ä»»ç½‘ç»œå®‰å…¨çš„ä¸€äº›åŸåˆ™å—åˆ°ä¿¡ä»»ï¼ŒæŒ‰è®¡åˆ’æˆ–æŒ‰éœ€æ±‚æ¨å‡ºè¡¥ä¸æ˜¯æœ€é‡è¦çš„ã€‚å¹³å°å›¢é˜Ÿé€šå¸¸æœ‰å¯é¢„æµ‹çš„è¡¥ä¸æˆ–ç»´æŠ¤å‘¨æœŸï¼Œè¿™ä¸åº”ç”¨ç¨‹åºçš„å‘¨æœŸå®Œå…¨ä¸åŒã€‚å½“éœ€è¦æ–°çš„èƒ½åŠ›å’ŒåŠŸèƒ½æ—¶ï¼Œåº”ç”¨ç¨‹åºå¯èƒ½ä¼šè¢«æ›´æ–°ï¼Œé€šå¸¸æ˜¯é¡¹ç›®çš„ä¸€éƒ¨åˆ†ã€‚è¿™ç§å¯¹åº”ç”¨ç¨‹åºå˜åŒ–ã€å‡çº§ã€æ¡†æ¶å’Œåº“è¡¥ä¸çš„æ–¹æ³•ï¼Œæ˜¯éå¸¸ä¸å¯é¢„æµ‹çš„ï¼Œä¼šè€—è´¹å¤§é‡æ—¶é—´ï¼Œä¸é€‚åˆå®‰å…¨å®è·µã€‚å› æ­¤ï¼Œä¿æŒè¿™äº›å®‰å…¨åŠŸèƒ½æ˜¯å¹³å°çš„ä¸€éƒ¨åˆ†ï¼Œä¸åº”ç”¨ç¨‹åºåˆ†å¼€ï¼Œæœ‰åˆ©äºä¿æŒæ›´å¥½çš„å®‰å…¨æ€åŠ¿ã€‚&lt;/p&gt;
&lt;p&gt;æ­£å¦‚æˆ‘ä»¬åœ¨å…¬å‘Šåšå®¢ä¸­æŒ‡å‡ºçš„ï¼Œç”±äº sidecar çš„ä¾µå…¥æ€§ï¼Œæ“ä½œ sidecar å¯èƒ½ä¼šæ›´åŠ å¤æ‚ï¼ˆæ³¨å…¥ sidecar/æ”¹å˜éƒ¨ç½²æè¿°ï¼Œé‡å¯åº”ç”¨ç¨‹åºï¼Œå®¹å™¨ä¹‹é—´çš„ç«äº‰æ¡ä»¶ç­‰ï¼‰ã€‚å¯¹å¸¦æœ‰ sidecar çš„å·¥ä½œè´Ÿè½½çš„å‡çº§éœ€è¦æ›´å¤šçš„è®¡åˆ’å’Œæ»šåŠ¨é‡å¯ï¼Œå¯èƒ½éœ€è¦åè°ƒï¼Œä»¥é¿å…åº”ç”¨ç¨‹åºå´©æºƒã€‚æœ‰äº† Ambient Meshï¼Œå¯¹ ztunnel çš„å‡çº§å¯ä»¥ä¸ä»»ä½•æ­£å¸¸çš„èŠ‚ç‚¹è¡¥ä¸æˆ–å‡çº§åŒæ—¶è¿›è¡Œï¼Œè€Œ waypoint ä»£ç†æ˜¯ç½‘ç»œçš„ä¸€éƒ¨åˆ†ï¼Œå¯ä»¥æ ¹æ®éœ€è¦å¯¹åº”ç”¨ç¨‹åºè¿›è¡Œå®Œå…¨é€æ˜çš„å‡çº§ã€‚&lt;/p&gt;
&lt;h2 id=&#34;é¿å…å¤šç§Ÿæˆ·-l7-ä»£ç†&#34;&gt;é¿å…å¤šç§Ÿæˆ· L7 ä»£ç†&lt;/h2&gt;
&lt;p&gt;æ”¯æŒ L7 åè®®ï¼ˆä¾‹å¦‚ HTTP 1/2/3ã€gRPCã€è§£ææ ‡å¤´ã€å®ç°é‡è¯•ã€åœ¨æ•°æ®å¹³é¢ä¸­ä½¿ç”¨ Wasm æˆ– Lua è¿›è¡Œè‡ªå®šä¹‰ï¼‰æ¯”æ”¯æŒ L4 å¤æ‚å¾—å¤šã€‚å®ç°è¿™äº›è¡Œä¸ºçš„ä»£ç è¦å¤šå¾—å¤šï¼ˆåŒ…æ‹¬ Lua å’Œ Wasm ç­‰ç”¨æˆ·è‡ªå®šä¹‰ä»£ç ï¼‰ï¼Œè¿™ç§å¤æ‚æ€§å¯èƒ½ä¼šå¯¼è‡´æ½œåœ¨çš„æ¼æ´ã€‚æ­£å› ä¸ºå¦‚æ­¤ï¼ŒCVE åœ¨è¿™äº› L7 åŠŸèƒ½é¢†åŸŸä¸­å‡ºç°çš„å‡ ç‡æ›´é«˜ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-æ¯ä¸ªå‘½åç©ºé—´èº«ä»½éƒ½æœ‰è‡ªå·±çš„l7ä»£ç†æ²¡æœ‰å¤šç§Ÿæˆ·ä»£ç†&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;æ¯ä¸ªå‘½åç©ºé—´/èº«ä»½éƒ½æœ‰è‡ªå·±çš„L7ä»£ç†ï¼›æ²¡æœ‰å¤šç§Ÿæˆ·ä»£ç†&#34;
           src=&#34;https://lib.jimmysong.io/blog/ambient-security/l7-function.svg&#34;
           loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      æ¯ä¸ªå‘½åç©ºé—´/èº«ä»½éƒ½æœ‰è‡ªå·±çš„L7ä»£ç†ï¼›æ²¡æœ‰å¤šç§Ÿæˆ·ä»£ç†
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;åœ¨ ambient mesh ä¸­ï¼Œæˆ‘ä»¬ä¸åœ¨å¤šä¸ªèº«ä»½ä¹‹é—´å…±äº«ä»£ç†ä¸­çš„ L7 å¤„ç†ã€‚æ¯ä¸ªèº«ä»½ï¼ˆKubernetes ä¸­çš„æœåŠ¡è´¦æˆ·ï¼‰éƒ½æœ‰è‡ªå·±ä¸“é—¨çš„ L7 ä»£ç†ï¼ˆwaypoint ä»£ç†ï¼‰ï¼Œè¿™ä¸æˆ‘ä»¬ä½¿ç”¨çš„ sidecar æ¨¡å‹éå¸¸ç›¸ä¼¼ã€‚è¯•å›¾å°†å¤šä¸ªèº«ä»½ã€å¤æ‚çš„ä¸åŒçš„ç­–ç•¥å’Œå®šåˆ¶æ”¾åœ¨ä¸€èµ·ï¼Œä¼šç»™å…±äº«èµ„æºå¢åŠ å¾ˆå¤šå˜æ•°ï¼Œæœ€å¥½çš„æƒ…å†µæ˜¯å¯¼è‡´èµ„æºçš„ä¸å…¬å¹³åˆ†é…ï¼Œæœ€åçš„æƒ…å†µæ˜¯å¯¼è‡´ä»£ç†è¢«å®Œå…¨ç ´åã€‚&lt;/p&gt;
&lt;h2 id=&#34;sidecar-æ¨¡å¼ä»ç„¶æ˜¯é¦–å…ˆçš„éƒ¨ç½²æ¨¡å¼ä¹‹ä¸€&#34;&gt;Sidecar æ¨¡å¼ä»ç„¶æ˜¯é¦–å…ˆçš„éƒ¨ç½²æ¨¡å¼ä¹‹ä¸€&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬ç†è§£ï¼Œæœ‰äº›äººå¯¹ sidecar æ¨¡å‹åŠå…¶å·²çŸ¥çš„å®‰å…¨è¾¹ç•Œæ„Ÿåˆ°æ»¡æ„ï¼Œå¹¶å¸Œæœ›ç•™åœ¨è¯¥æ¨¡å‹ä¸Šã€‚Sidecar ä»ç„¶æ˜¯ç½‘æ ¼çš„ä¸€ç­‰å…¬æ°‘ï¼Œå¹³å°æ‰€æœ‰è€…å¯ä»¥é€‰æ‹©ç»§ç»­ä½¿ç”¨å®ƒä»¬ã€‚å¦‚æœå¹³å°æ‰€æœ‰è€…æƒ³åŒæ—¶æ”¯æŒ sidecar å’Œ ambient ä¹Ÿæ˜¯å¯ä»¥ã€‚å…·æœ‰ ambient æ•°æ®å¹³é¢çš„å·¥ä½œè´Ÿè½½å¯ä»¥ä¸éƒ¨ç½²äº† sidecar çš„å·¥ä½œè´Ÿè½½è¿›è¡Œæœ¬åœ°é€šä¿¡ã€‚éšç€äººä»¬æ›´å¥½åœ°äº†è§£ ambient mesh çš„å®‰å…¨æ€åŠ¿ï¼Œæˆ‘ä»¬ç›¸ä¿¡ï¼Œambient å°†æˆä¸º Istio æœåŠ¡ç½‘æ ¼çš„é¦–é€‰æ¨¡å¼ï¼Œè€Œ sidecar åˆ™ç”¨äºç‰¹å®šçš„ä¼˜åŒ–ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Istio æ—  sidecar ä»£ç†æ•°æ®å¹³é¢ ambient æ¨¡å¼ç®€ä»‹</title>
      <link>https://lib.jimmysong.io/blog/introducing-ambient-mesh/</link>
      <pubDate>Thu, 08 Sep 2022 11:00:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/introducing-ambient-mesh/</guid>
      <description>&lt;p&gt;ä»Šå¤©ï¼Œæˆ‘ä»¬å¾ˆé«˜å…´åœ°ä»‹ç» &lt;strong&gt;Ambient Mesh&lt;/strong&gt;ï¼ˆè¯‘è€…æ³¨ï¼šç¬”è€…æ›´å€¾å‘äºå°†å…¶ç§°ä¸º Ambient Modeï¼Œå³å¤–å›´æ¨¡å¼ï¼‰ï¼Œè¿™æ˜¯ä¸€ç§æ–°çš„ Istio æ•°æ®å¹³é¢æ¨¡å¼ï¼Œæ—¨åœ¨ç®€åŒ–æ“ä½œã€æ‰©å¤§åº”ç”¨å…¼å®¹æ€§å¹¶é™ä½åŸºç¡€è®¾æ–½æˆæœ¬ã€‚ç”¨æˆ·å¯ä»¥é€‰æ‹©å°† Ambient Mesh é›†æˆåˆ°å…¶åŸºç¡€è®¾æ–½çš„ç½‘æ ¼æ•°æ®å¹³é¢ï¼Œæ”¾å¼ƒ sidecar ä»£ç†ï¼ŒåŒæ—¶ä¿æŒ Istio çš„é›¶ä¿¡ä»»å®‰å…¨ã€é¥æµ‹å’Œæµé‡ç®¡ç†ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚æˆ‘ä»¬æ­£åœ¨ä¸ Istio ç¤¾åŒºåˆ†äº« Ambient Mesh çš„é¢„è§ˆç‰ˆï¼Œæˆ‘ä»¬æ­£åŠªåŠ›åœ¨æœªæ¥å‡ ä¸ªæœˆå†…å°†å…¶æ¨å‘ç”Ÿäº§å°±ç»ªã€‚&lt;/p&gt;
&lt;h2 id=&#34;istio-å’Œ-sidecar&#34;&gt;Istio å’Œ Sidecar&lt;/h2&gt;
&lt;p&gt;è‡ªé¡¹ç›®æˆç«‹ä»¥æ¥ï¼ŒIstio æ¶æ„çš„ä¸€ä¸ªå†³å®šæ€§ç‰¹å¾æ˜¯ä½¿ç”¨ sidecarâ€”â€” ä¸åº”ç”¨å®¹å™¨ä¸€èµ·éƒ¨ç½²çš„å¯ç¼–ç¨‹ä»£ç†ã€‚åˆ©ç”¨ sidecarï¼Œä¸éœ€è¦å¯¹åº”ç”¨ç¨‹åºè¿›è¡Œé‡å¤§è°ƒæ•´å³å¯ä»¥äº«å—æœåŠ¡ç½‘æ ¼å¸¦æ¥çš„å¥½å¤„ï¼Œçœå»è¿ç»´çš„è´Ÿæ‹…ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-istio-çš„ä¼ ç»Ÿæ¨¡å¼æ˜¯å°†-envoy-ä»£ç†ä½œä¸º-sidecar-éƒ¨ç½²åœ¨å·¥ä½œè´Ÿè½½çš„-pod-ä¸­&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Istio çš„ä¼ ç»Ÿæ¨¡å¼æ˜¯å°† Envoy ä»£ç†ä½œä¸º sidecar éƒ¨ç½²åœ¨å·¥ä½œè´Ÿè½½çš„ pod ä¸­ã€‚&#34; srcset=&#34;
               /blog/introducing-ambient-mesh/e6c9d24ely1h5yyo2mg1bj21wj0u0gp0_hu6485f23e60e2e8e9568294bae27898e8_132498_10f6220749ea87ae437eaf6d93d3b726.webp 400w,
               /blog/introducing-ambient-mesh/e6c9d24ely1h5yyo2mg1bj21wj0u0gp0_hu6485f23e60e2e8e9568294bae27898e8_132498_c4136b67d287ee55f3e3e2e4363d60ee.webp 760w,
               /blog/introducing-ambient-mesh/e6c9d24ely1h5yyo2mg1bj21wj0u0gp0_hu6485f23e60e2e8e9568294bae27898e8_132498_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/introducing-ambient-mesh/e6c9d24ely1h5yyo2mg1bj21wj0u0gp0_hu6485f23e60e2e8e9568294bae27898e8_132498_10f6220749ea87ae437eaf6d93d3b726.webp&#34;
               width=&#34;760&#34;
               height=&#34;333&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      Istio çš„ä¼ ç»Ÿæ¨¡å¼æ˜¯å°† Envoy ä»£ç†ä½œä¸º sidecar éƒ¨ç½²åœ¨å·¥ä½œè´Ÿè½½çš„ pod ä¸­ã€‚
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;è™½ç„¶ sidecar æ¯”èµ·é‡æ„åº”ç”¨ç¨‹åºæœ‰æ˜¾è‘—çš„ä¼˜åŠ¿ï¼Œä½†å®ƒä»¬å¹¶æ²¡æœ‰åœ¨åº”ç”¨ç¨‹åºå’Œ Istio æ•°æ®å¹³é¢ä¹‹é—´æä¾›ä¸€ä¸ªå®Œç¾çš„åˆ†ç¦»ã€‚è¿™å¯¼è‡´äº†ä¸€äº›é™åˆ¶ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¾µå…¥æ€§&lt;/strong&gt;ï¼šsidecar å¿…é¡»é€šè¿‡ä¿®æ”¹å…¶ Kubernetes pod é…ç½®å’Œé‡å®šå‘ pod å†…çš„æµé‡æ¥ &lt;strong&gt;æ³¨å…¥&lt;/strong&gt; åº”ç”¨ç¨‹åºã€‚å› æ­¤ï¼Œå®‰è£…æˆ–å‡çº§ sidecar éœ€è¦é‡æ–°å¯åŠ¨åº”ç”¨ podï¼Œè¿™å¯¹å·¥ä½œè´Ÿè½½æ¥è¯´å¯èƒ½æ˜¯ç ´åæ€§çš„ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;èµ„æºåˆ©ç”¨ç‡ä½&lt;/strong&gt;ï¼šç”±äºåœ¨æ¯ä¸ªå·¥ä½œè´Ÿè½½ pod éƒ½æ³¨å…¥äº† sidecar ä»£ç†ï¼Œpod å¿…é¡»ä¸º sidecar ä¿ç•™è¶³å¤Ÿçš„ CPU å’Œå†…å­˜ï¼Œè¿™å¯èƒ½å¯¼è‡´æ•´ä¸ªé›†ç¾¤çš„èµ„æºåˆ©ç”¨ç‡ä¸‹é™ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æµé‡ä¸­æ–­&lt;/strong&gt;ï¼šæµé‡æ•è·å’Œ HTTP å¤„ç†ï¼Œé€šå¸¸ç”± Istio çš„ sidecar å®Œæˆï¼Œè®¡ç®—æˆæœ¬å¾ˆé«˜ï¼Œå¯èƒ½ä¼šç ´åä¸€äº›å…·æœ‰ä¸ç¬¦åˆ HTTP å®ç°çš„åº”ç”¨ç¨‹åºã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è™½ç„¶ sidecar æœ‰å®ƒçš„ç”¨æ­¦ä¹‹åœ°ï¼Œåé¢ä¼šæœ‰æ›´å¤šçš„ä»‹ç» â€”â€” ä½†æˆ‘ä»¬è®¤ä¸ºéœ€è¦æœ‰ä¸€ä¸ªä¾µå…¥æ€§æ›´ä½ã€æ›´å®¹æ˜“çš„é€‰æ‹©ï¼Œè¿™å°†æ›´é€‚åˆè®¸å¤šæœåŠ¡ç½‘æ ¼ç”¨æˆ·ã€‚&lt;/p&gt;
&lt;h2 id=&#34;åˆ†å±‚&#34;&gt;åˆ†å±‚&lt;/h2&gt;
&lt;p&gt;ä¼ ç»Ÿä¸Šï¼ŒIstio åœ¨å•ä¸€çš„æ¶æ„ç»„ä»¶ä¸­å®ç°äº†æ‰€æœ‰çš„æ•°æ®å¹³é¢åŠŸèƒ½ï¼Œä»åŸºæœ¬çš„åŠ å¯†åˆ°é«˜çº§çš„ L7 ç­–ç•¥ï¼Œè¿™å°±æ˜¯ sidecarã€‚åœ¨å®è·µä¸­ï¼Œè¿™ä½¿å¾— sidecar æˆä¸ºä¸€ä¸ªå…¨æœ‰æˆ–å…¨æ— çš„ä¸»å¼ ã€‚å³ä½¿å·¥ä½œè´Ÿè½½åªéœ€è¦ç®€å•çš„ä¼ è¾“å®‰å…¨ï¼Œç®¡ç†å‘˜ä»ç„¶éœ€è¦æ‰¿æ‹…éƒ¨ç½²å’Œç»´æŠ¤ sidecar çš„è¿è¥æˆæœ¬ã€‚Sidecar å¯¹æ¯ä¸ªå·¥ä½œè´Ÿè½½éƒ½æœ‰å›ºå®šçš„è¿è¥æˆæœ¬ï¼Œæ— æ³•æ ¹æ®ç”¨ä¾‹çš„å¤æ‚æ€§è¿›è¡Œæ‰©å±•ã€‚&lt;/p&gt;
&lt;p&gt;Ambient Mesh é‡‡å–äº†ä¸€ç§ä¸åŒçš„æ–¹æ³•ã€‚å®ƒå°† Istio çš„åŠŸèƒ½åˆ†æˆä¸¤ä¸ªä¸åŒçš„å±‚æ¬¡ã€‚åœ¨åº•å±‚ï¼Œæœ‰ä¸€ä¸ªå®‰å…¨è¦†ç›–å±‚ï¼Œå¤„ç†æµé‡çš„è·¯ç”±å’Œé›¶ä¿¡ä»»å®‰å…¨ã€‚åœ¨è¿™ä¹‹ä¸Šï¼Œå½“éœ€è¦æ—¶ï¼Œç”¨æˆ·å¯ä»¥å¯ç”¨ L7 å¤„ç†ï¼Œä»¥è·å¾— Istio çš„å…¨éƒ¨åŠŸèƒ½ã€‚L7 å¤„ç†æ¨¡å¼è™½ç„¶æ¯”å®‰å…¨è¦†ç›–å±‚æ›´é‡ï¼Œä½†ä»ä½œä¸ºåŸºç¡€è®¾æ–½çš„ä¸€ä¸ªå¤–å›´ç»„ä»¶è¿è¡Œï¼Œä¸éœ€è¦å¯¹åº”ç”¨ pod è¿›è¡Œä¿®æ”¹ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-ambient-mesh-åˆ†å±‚&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Ambient Mesh åˆ†å±‚&#34;
           src=&#34;https://lib.jimmysong.io/blog/introducing-ambient-mesh/ambient-mesh-layers.svg&#34;
           loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      Ambient Mesh åˆ†å±‚
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;è¿™ç§åˆ†å±‚æ–¹æ³•ä½¿ç”¨æˆ·èƒ½å¤Ÿä»¥æ›´å¤šçš„å¢é‡æ–¹å¼é‡‡ç”¨ Istioï¼Œä»æ— ç½‘æ ¼åˆ°å®‰å…¨è¦†ç›–ï¼Œå†åˆ°å®Œå…¨çš„ L7 å¤„ç†ï¼Œæ ¹æ®éœ€è¦ä»¥æ¯ä¸ªå‘½åç©ºé—´ä¸ºåŸºç¡€è¿›è¡Œå¹³ç¨³è¿‡æ¸¡ã€‚æ­¤å¤–ï¼Œåœ¨ä¸åŒæ°›å›´æ¨¡å¼ä¸‹è¿è¡Œçš„å·¥ä½œè´Ÿè½½ï¼Œæˆ–ä¸ sidecar æ— ç¼äº’é€šï¼Œå…è®¸ç”¨æˆ·æ ¹æ®éšæ—¶é—´å˜åŒ–çš„ç‰¹å®šéœ€æ±‚æ¥æ··åˆå’ŒåŒ¹é…èƒ½åŠ›ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ„å»º Ambient Mesh&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Ambient Mesh ä½¿ç”¨ä¸€ä¸ªå…±äº«ä»£ç†ï¼ˆagentï¼‰ï¼Œåœ¨ Kubernetes é›†ç¾¤çš„æ¯ä¸ªèŠ‚ç‚¹ä¸Šè¿è¡Œã€‚è¿™ä¸ªä»£ç†æ˜¯ä¸€ä¸ªé›¶ä¿¡ä»»éš§é“ï¼ˆztunnelï¼‰ï¼Œå®ƒçš„ä¸»è¦èŒè´£æ˜¯å®‰å…¨åœ°è¿æ¥å’ŒéªŒè¯ç½‘æ ¼å†…çš„å…ƒç´ ã€‚èŠ‚ç‚¹ä¸Šçš„ç½‘ç»œå †æ ˆå°†å‚ä¸å·¥ä½œè´Ÿè½½çš„æ‰€æœ‰æµé‡é€šè¿‡æœ¬åœ° ztunnel ä»£ç†é‡å®šå‘ã€‚è¿™å°† Istio çš„æ•°æ®å¹³é¢ä¸åº”ç”¨ç¨‹åºçš„å…³æ³¨ç‚¹å®Œå…¨åˆ†å¼€ï¼Œæœ€ç»ˆå…è®¸è¿è¥äººå‘˜å¯ç”¨ã€ç¦ç”¨ã€æ‰©å±•å’Œå‡çº§æ•°æ®å¹³é¢è€Œä¸å¹²æ‰°åº”ç”¨ç¨‹åºã€‚ztunnel ä¸å¯¹å·¥ä½œè´Ÿè½½æµé‡è¿›è¡Œ L7 å¤„ç†ï¼Œä½¿å…¶æ˜æ˜¾æ¯” sidecar ç²¾ç®€ã€‚è¿™å¤§å¤§é™ä½äº†å¤æ‚æ€§å’Œç›¸å…³èµ„æºçš„ä½¿ç”¨æˆæœ¬ï¼Œä½¿å®ƒé€‚åˆä½œä¸ºå…±äº«åŸºç¡€è®¾æ–½äº¤ä»˜ã€‚&lt;/p&gt;
&lt;p&gt;Ztunnel å®ç°äº†æœåŠ¡ç½‘æ ¼çš„æ ¸å¿ƒåŠŸèƒ½ï¼šé›¶ä¿¡ä»»ã€‚å½“ä¸ºå‘½åç©ºé—´å¯ç”¨ Ambient æ—¶ï¼Œä¼šåˆ›å»ºä¸€ä¸ªå®‰å…¨è¦†ç›–å±‚ã€‚å®ƒä¸ºå·¥ä½œè´Ÿè½½æä¾› mTLSã€é¥æµ‹ã€è®¤è¯å’Œ L4 æˆæƒï¼Œè€Œæ— éœ€ç»ˆæ­¢æˆ–è§£æ HTTPã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-ambient-mesh-ä½¿ç”¨ä¸€ä¸ªå…±äº«çš„æ¯ä¸ªèŠ‚ç‚¹çš„-ztunnel-æ¥æä¾›ä¸€ä¸ªé›¶ä¿¡ä»»çš„å®‰å…¨è¦†ç›–&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Ambient mesh ä½¿ç”¨ä¸€ä¸ªå…±äº«çš„ã€æ¯ä¸ªèŠ‚ç‚¹çš„ ztunnel æ¥æä¾›ä¸€ä¸ªé›¶ä¿¡ä»»çš„å®‰å…¨è¦†ç›–ã€‚&#34; srcset=&#34;
               /blog/introducing-ambient-mesh/e6c9d24ely1h5z19731yhj21wj0u040v_hu6485f23e60e2e8e9568294bae27898e8_97321_e0552906855f5bfa1f41960bdd6b8ecf.webp 400w,
               /blog/introducing-ambient-mesh/e6c9d24ely1h5z19731yhj21wj0u040v_hu6485f23e60e2e8e9568294bae27898e8_97321_86e671f76a997a396ed45385253100c6.webp 760w,
               /blog/introducing-ambient-mesh/e6c9d24ely1h5z19731yhj21wj0u040v_hu6485f23e60e2e8e9568294bae27898e8_97321_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/introducing-ambient-mesh/e6c9d24ely1h5z19731yhj21wj0u040v_hu6485f23e60e2e8e9568294bae27898e8_97321_e0552906855f5bfa1f41960bdd6b8ecf.webp&#34;
               width=&#34;760&#34;
               height=&#34;333&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      Ambient mesh ä½¿ç”¨ä¸€ä¸ªå…±äº«çš„ã€æ¯ä¸ªèŠ‚ç‚¹çš„ ztunnel æ¥æä¾›ä¸€ä¸ªé›¶ä¿¡ä»»çš„å®‰å…¨è¦†ç›–ã€‚
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;åœ¨å¯ç”¨ Ambient Mesh å’Œåˆ›å»ºå®‰å…¨è¦†ç›–åï¼Œå¯ä»¥é…ç½®å‘½åç©ºé—´ä»¥åˆ©ç”¨ L7 åŠŸèƒ½ã€‚è¿™å…è®¸å‘½åç©ºé—´å®ç°å…¨å¥—çš„ Istio åŠŸèƒ½ï¼ŒåŒ…æ‹¬ &lt;a href=&#34;https://istio.io/latest/docs/reference/config/networking/virtual-service/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Virtual Service API&lt;/a&gt;ã€&lt;a href=&#34;https://istio.io/latest/docs/reference/config/telemetry/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;L7 é¥æµ‹&lt;/a&gt;å’Œ &lt;a href=&#34;https://istio.io/latest/docs/reference/config/security/authorization-policy/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;L7 æˆæƒç­–ç•¥&lt;/a&gt;ã€‚ä»¥è¿™ç§æ¨¡å¼è¿è¡Œçš„å‘½åç©ºé—´ä½¿ç”¨ä¸€ä¸ªæˆ–å¤šä¸ªåŸºäº Envoy çš„ &lt;strong&gt;Waypoint proxy&lt;/strong&gt;ï¼ˆè·¯å¾„ç‚¹ä»£ç†ï¼‰æ¥å¤„ç†è¯¥å‘½åç©ºé—´çš„å·¥ä½œè´Ÿè½½çš„ L7 å¤„ç†ã€‚Istio çš„æ§åˆ¶å¹³é¢å°†é›†ç¾¤ä¸­çš„ ztunnel é…ç½®ä¸ºé€šè¿‡ waypoint ä»£ç†ä¼ é€’æ‰€æœ‰éœ€è¦ L7 å¤„ç†çš„æµé‡ã€‚é‡è¦çš„æ˜¯ï¼Œä» Kubernetes çš„è§’åº¦æ¥çœ‹ï¼Œwaypoint ä»£ç†åªæ˜¯æ™®é€šçš„ podï¼Œå¯ä»¥åƒå…¶ä»– Kubernetes éƒ¨ç½²ä¸€æ ·è¿›è¡Œè‡ªåŠ¨æ‰©å±•ã€‚æˆ‘ä»¬é¢„è®¡è¿™å°†ä¸ºç”¨æˆ·èŠ‚çœå¤§é‡èµ„æºï¼Œå› ä¸ºè·¯å¾„ä»£ç†å¯ä»¥è‡ªåŠ¨æ‰©å±•ï¼Œä»¥é€‚åº”å®ƒä»¬æ‰€æœåŠ¡çš„å‘½åç©ºé—´çš„å®æ—¶æµé‡éœ€æ±‚ï¼Œè€Œä¸æ˜¯è¿è¥äººå‘˜é¢„æœŸçš„æœ€å¤§æœ€åæƒ…å†µä¸‹çš„è´Ÿè½½ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å½“éœ€è¦é¢å¤–çš„åŠŸèƒ½æ—¶ambient-mesh-ä¼šéƒ¨ç½²è·¯å¾„ä»£ç†ztunnelé€šè¿‡è¿™äº›ä»£ç†è¿›è¡Œè¿æ¥ä»¥æ‰§è¡Œç­–ç•¥&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å½“éœ€è¦é¢å¤–çš„åŠŸèƒ½æ—¶ï¼ŒAmbient Mesh ä¼šéƒ¨ç½²è·¯å¾„ä»£ç†ï¼ŒZtunnelé€šè¿‡è¿™äº›ä»£ç†è¿›è¡Œè¿æ¥ä»¥æ‰§è¡Œç­–ç•¥ã€‚&#34; srcset=&#34;
               /blog/introducing-ambient-mesh/e6c9d24ely1h5yzsd8vv8j21wj0u00vx_hud24c97983a2dff171a980de76f593f78_126284_385fd31aa658cae43db3d254509df0d2.webp 400w,
               /blog/introducing-ambient-mesh/e6c9d24ely1h5yzsd8vv8j21wj0u00vx_hud24c97983a2dff171a980de76f593f78_126284_680b4da92881d3c919a63a2b7754f59c.webp 760w,
               /blog/introducing-ambient-mesh/e6c9d24ely1h5yzsd8vv8j21wj0u00vx_hud24c97983a2dff171a980de76f593f78_126284_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/introducing-ambient-mesh/e6c9d24ely1h5yzsd8vv8j21wj0u00vx_hud24c97983a2dff171a980de76f593f78_126284_385fd31aa658cae43db3d254509df0d2.webp&#34;
               width=&#34;760&#34;
               height=&#34;333&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å½“éœ€è¦é¢å¤–çš„åŠŸèƒ½æ—¶ï¼ŒAmbient Mesh ä¼šéƒ¨ç½²è·¯å¾„ä»£ç†ï¼ŒZtunnelé€šè¿‡è¿™äº›ä»£ç†è¿›è¡Œè¿æ¥ä»¥æ‰§è¡Œç­–ç•¥ã€‚
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;Ambient Mesh ä½¿ç”¨ &lt;strong&gt;HTTP CONNECT over mTLS&lt;/strong&gt; æ¥å®ç°å…¶å®‰å…¨éš§é“ï¼Œå¹¶åœ¨è·¯å¾„ä¸­æ’å…¥ waypoint ä»£ç†ï¼Œè¿™ç§æ¨¡å¼æˆ‘ä»¬ç§°ä¹‹ä¸º &lt;strong&gt;HBONE&lt;/strong&gt;ï¼ˆHTTP-Based Overlay Network Environmentï¼ŒåŸºäº HTTP çš„é‡å ç½‘ç»œç¯å¢ƒï¼‰ã€‚HBONE æä¾›äº†æ¯” TLS æœ¬èº«æ›´å¹²å‡€çš„æµé‡å°è£…ï¼ŒåŒæ—¶å®ç°äº†ä¸æ™®é€šè´Ÿè½½å‡è¡¡å™¨åŸºç¡€è®¾æ–½çš„äº’æ“ä½œæ€§ã€‚é»˜è®¤ä½¿ç”¨ FIPS æ„å»ºï¼Œä»¥æ»¡è¶³åˆè§„æ€§éœ€æ±‚ã€‚å…³äº HBONE çš„æ›´å¤šç»†èŠ‚ï¼Œå…¶åŸºäºæ ‡å‡†çš„æ–¹æ³•ï¼Œä»¥åŠ UDP å’Œå…¶ä»–é TCP åè®®çš„è®¡åˆ’ï¼Œå°†åœ¨æœªæ¥çš„åšå®¢ä¸­æä¾›ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ä¸€ä¸ªç½‘æ ¼ä¸­æ··åˆ sidecar å’Œ ambientï¼Œä¸ä¼šå¯¹ç³»ç»Ÿçš„èƒ½åŠ›æˆ–å®‰å…¨å±æ€§å¸¦æ¥é™åˆ¶ã€‚Istio æ§åˆ¶å¹³é¢ç¡®ä¿ç­–ç•¥çš„æ­£ç¡®æ‰§è¡Œï¼Œæ— è®ºé€‰æ‹©ä½•ç§éƒ¨ç½²æ¨¡å¼ã€‚Ambient åªæ˜¯å¼•å…¥äº†ä¸€ä¸ªå…·æœ‰æ›´å¥½çš„äººæœºå·¥ç¨‹å­¦å’Œæ›´å¤šçµæ´»æ€§çš„é€‰é¡¹ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä¸ºä»€ä¹ˆæœ¬åœ°èŠ‚ç‚¹ä¸Šæ²¡æœ‰-l7-å¤„ç†&#34;&gt;ä¸ºä»€ä¹ˆæœ¬åœ°èŠ‚ç‚¹ä¸Šæ²¡æœ‰ L7 å¤„ç†ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;Ambient ç½‘æ ¼åœ¨èŠ‚ç‚¹ä¸Šä½¿ç”¨ä¸€ä¸ªå…±äº«çš„ ztunnel ä»£ç†ï¼Œå®ƒå¤„ç†ç½‘æ ¼çš„é›¶ä¿¡ä»»æ–¹é¢ï¼Œè€Œ L7 å¤„ç†å‘ç”Ÿåœ¨å•ç‹¬è°ƒåº¦çš„ pod ä¸­çš„ waypoint ä»£ç†ã€‚ä¸ºä»€ä¹ˆè¦è´¹å°½å¿ƒæœºåœ°è¿›è¡Œè½¬æ¥ï¼Œè€Œä¸æ˜¯ç›´æ¥åœ¨èŠ‚ç‚¹ä¸Šä½¿ç”¨ä¸€ä¸ªå…±äº«çš„å®Œæ•´çš„ L7 ä»£ç†ï¼Ÿè¿™æœ‰å‡ ä¸ªåŸå› ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Envoy æœ¬è´¨ä¸Šä¸æ˜¯å¤šç§Ÿæˆ·çš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯¹åœ¨ä¸€ä¸ªå…±äº«å®ä¾‹ä¸­æ··åˆæ¥è‡ªå¤šä¸ªæ— çº¦æŸç§Ÿæˆ·çš„ L7 æµé‡çš„å¤æ‚å¤„ç†è§„åˆ™æœ‰å®‰å…¨æ–¹é¢çš„æ‹…å¿§ã€‚é€šè¿‡ä¸¥æ ¼é™åˆ¶ L4 å¤„ç†ï¼Œæˆ‘ä»¬å¤§å¤§å‡å°‘äº†æ¼æ´çš„åŠå¾„ã€‚&lt;/li&gt;
&lt;li&gt;ä¸ waypoint ä»£ç†æ‰€éœ€çš„ L7 å¤„ç†ç›¸æ¯”ï¼Œztunnel æ‰€æä¾›çš„ mTLS å’Œ L4 åŠŸèƒ½éœ€è¦çš„ CPU å’Œå†…å­˜å ç”¨è¦å°å¾—å¤šã€‚é€šè¿‡å°† waypoint ä»£ç†ä½œä¸ºä¸€ä¸ªå…±äº«çš„å‘½åç©ºé—´èµ„æºæ¥è¿è¡Œï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®è¯¥å‘½åç©ºé—´çš„éœ€æ±‚æ¥ç‹¬ç«‹æ‰©å±•å®ƒä»¬ï¼Œå…¶æˆæœ¬ä¸ä¼šä¸å…¬å¹³åœ°åˆ†é…ç»™ä¸ç›¸å…³çš„ç§Ÿæˆ·ã€‚&lt;/li&gt;
&lt;li&gt;é€šè¿‡å‡å°‘ ztunnel çš„èŒƒå›´ï¼Œæˆ‘ä»¬å…è®¸å®ƒè¢«å…¶ä»–å®‰å…¨éš§é“çš„å®ç°æ‰€å–ä»£ï¼Œè¿™äº›å®ç°å¯ä»¥æ»¡è¶³ä¸€ä¸ªæ˜ç¡®çš„äº’æ“ä½œæ€§åè®®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;ä½†æ˜¯é‚£äº›é¢å¤–çš„è·³æ•°å‘¢&#34;&gt;ä½†æ˜¯é‚£äº›é¢å¤–çš„è·³æ•°å‘¢ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;åœ¨ Ambient ç½‘æ ¼ä¸­ï¼Œwaypoint ä¸ä¸€å®šä¿è¯ä¸å®ƒæ‰€æœåŠ¡çš„å·¥ä½œè´Ÿè½½åœ¨åŒä¸€ä¸ªèŠ‚ç‚¹ä¸Šã€‚è™½ç„¶ä¹ä¸€çœ‹ï¼Œè¿™å¯èƒ½æ˜¯ä¸€ä¸ªæ€§èƒ½é—®é¢˜ï¼Œä½†æˆ‘ä»¬ç›¸ä¿¡ï¼Œå»¶è¿Ÿæœ€ç»ˆå°†ä¸ Istio ç›®å‰çš„ sidecar å®ç°ä¿æŒä¸€è‡´ã€‚æˆ‘ä»¬å°†åœ¨ä¸“é—¨çš„æ€§èƒ½åšæ–‡ä¸­è¯¦ç»†è®¨è®ºï¼Œä½†ç°åœ¨æˆ‘ä»¬å°†æ€»ç»“å‡ºä¸¤ç‚¹ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;äº‹å®ä¸Šï¼ŒIstio çš„å¤§éƒ¨åˆ†ç½‘ç»œå»¶è¿Ÿå¹¶ä¸æ˜¯æ¥è‡ªäºç½‘ç»œï¼ˆç°ä»£çš„äº‘ä¾›åº”å•†æ‹¥æœ‰æå¿«çš„ç½‘ç»œï¼‰ã€‚ç›¸åï¼Œæœ€å¤§çš„ç½ªé­ç¥¸é¦–æ˜¯ Istio éœ€è¦å¯†é›†çš„ L7 å¤„ç†æ¥å®ç°å…¶å¤æ‚çš„åŠŸèƒ½é›†ã€‚ä¸ sidecar ä¸åŒçš„æ˜¯ï¼Œsidecar ä¸ºæ¯ä¸ªè¿æ¥å®ç°äº†ä¸¤ä¸ª L7 å¤„ç†æ­¥éª¤ï¼ˆæ¯ä¸ª sidecar ä¸€ä¸ªï¼‰ï¼Œè€Œ Ambient ç½‘æ ¼è¿™ä¸¤ä¸ªæ­¥éª¤å‹ç¼©æˆä¸€ä¸ªã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›è¿™ç§å‡å°‘çš„å¤„ç†æˆæœ¬èƒ½å¤Ÿè¡¥å¿é¢å¤–çš„ç½‘ç»œè·³è·ƒã€‚&lt;/li&gt;
&lt;li&gt;ç”¨æˆ·é€šå¸¸åœ¨éƒ¨ç½²ç½‘æ ¼æ—¶ï¼Œé¦–å…ˆå¯ç”¨é›¶ä¿¡ä»»çš„å®‰å…¨æ€åŠ¿ï¼Œç„¶åæ ¹æ®éœ€è¦é€‰æ‹©æ€§åœ°å¯ç”¨ L7 åŠŸèƒ½ã€‚Ambient ç½‘æ ¼å…è®¸è¿™äº›ç”¨æˆ·åœ¨ä¸éœ€è¦æ—¶å®Œå…¨ç»•è¿‡ L7 å¤„ç†ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;èµ„æºå¼€é”€&#34;&gt;èµ„æºå¼€é”€&lt;/h2&gt;
&lt;p&gt;æ€»çš„æ¥è¯´ï¼Œæˆ‘ä»¬å¸Œæœ› Ambient Mesh å¯¹å¤§å¤šæ•°ç”¨æˆ·æ¥è¯´è¦æ±‚æ›´å°‘çš„èµ„æºï¼Œè®©èµ„æºéœ€æ±‚æ›´å¯é¢„æµ‹ã€‚ztunnel çš„æœ‰é™è´£ä»»å…è®¸å®ƒä½œä¸ºä¸€ä¸ªå…±äº«èµ„æºéƒ¨ç½²åœ¨èŠ‚ç‚¹ä¸Šã€‚è¿™å°†å¤§å¤§å‡å°‘å¤§å¤šæ•°ç”¨æˆ·ä¸ºæ¯ä¸ªå·¥ä½œè´Ÿè½½çš„é¢„ç•™èµ„æºã€‚æ­¤å¤–ï¼Œç”±äº waypoint ä»£ç†æ˜¯æ­£å¸¸çš„ Kubernetes podï¼Œå®ƒä»¬å¯ä»¥æ ¹æ®å…¶æœåŠ¡çš„å·¥ä½œè´Ÿè½½çš„å®æ—¶æµé‡éœ€æ±‚è¿›è¡ŒåŠ¨æ€éƒ¨ç½²å’Œæ‰©å±•ã€‚&lt;/p&gt;
&lt;p&gt;å¦ä¸€æ–¹é¢ï¼Œsidecar éœ€è¦ä¸ºæ¯ä¸ªå·¥ä½œè´Ÿè½½çš„æœ€åæƒ…å†µä¿ç•™å†…å­˜å’Œ CPUã€‚è¿›è¡Œè¿™äº›è®¡ç®—æ˜¯å¾ˆå¤æ‚çš„ï¼Œæ‰€ä»¥åœ¨å®è·µä¸­ï¼Œç®¡ç†å‘˜å€¾å‘äºè¿‡åº¦é…ç½®ã€‚è¿™å°±å¯¼è‡´äº†ç”±äºå¤§é‡çš„èµ„æºé¢„ç•™å¯¼è‡´å…¶ä»–å·¥ä½œè´Ÿè½½æ— æ³•è¢«è°ƒåº¦ï¼Œä»è€Œå¯¼è‡´èŠ‚ç‚¹åˆ©ç”¨ç‡ä¸è¶³ã€‚Ambient ç½‘æ ¼çš„æ¯èŠ‚ç‚¹å›ºå®šå¼€é”€è¾ƒä½ï¼ŒåŠ¨æ€æ‰©å±•çš„ waypoint ä»£ç†éœ€è¦çš„èµ„æºé¢„ç•™æ€»ä½“ä¸Šè¦å°‘å¾—å¤šï¼Œä»è€Œä½¿é›†ç¾¤çš„ä½¿ç”¨æ•ˆç‡æ›´é«˜ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å®‰å…¨æ€§å¦‚ä½•&#34;&gt;å®‰å…¨æ€§å¦‚ä½•ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;ä¸€ä¸ªå…¨æ–°çš„æ¶æ„è‡ªç„¶ä¼šå¸¦æ¥å®‰å…¨æ–¹é¢çš„é—®é¢˜ã€‚&lt;a href=&#34;https://istio.io/latest/blog/2022/ambient-security/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Ambient å®‰å…¨åšå®¢&lt;/a&gt;å¯¹æ­¤åšäº†æ·±å…¥çš„ç ”ç©¶ï¼Œæˆ‘ä»¬å°†åœ¨æ­¤è¿›è¡Œæ€»ç»“ã€‚&lt;/p&gt;
&lt;p&gt;Sidecar ä¸å®ƒä»¬æ‰€æœåŠ¡çš„å·¥ä½œè´Ÿè½½å…±å¤„ä¸€åœ°ï¼Œå› æ­¤ï¼Œä¸€ä¸ªäººçš„æ¼æ´ä¼šæŸå®³å¦ä¸€ä¸ªäººã€‚åœ¨ Ambient Mesh æ¨¡å‹ä¸­ï¼Œå³ä½¿ä¸€ä¸ªåº”ç”¨ç¨‹åºè¢«ç ´åï¼ŒZtunnel å’Œ waypoint ä»£ç†ä»ç„¶å¯ä»¥å¯¹è¢«ç ´åçš„åº”ç”¨ç¨‹åºçš„æµé‡æ‰§è¡Œä¸¥æ ¼çš„å®‰å…¨ç­–ç•¥ã€‚æ­¤å¤–ï¼Œé‰´äº Envoy æ˜¯ä¸–ç•Œä¸Šæœ€å¤§çš„ç½‘ç»œè¿è¥å•†æ‰€ä½¿ç”¨çš„ç»è¿‡å®æˆ˜è€ƒéªŒçš„æˆç†Ÿè½¯ä»¶ï¼Œå®ƒçš„è„†å¼±æ€§å¾ˆå¯èƒ½ä½äºä¸å®ƒä¸€èµ·è¿è¡Œçš„åº”ç”¨ç¨‹åºã€‚&lt;/p&gt;
&lt;p&gt;è™½ç„¶ ztunnel æ˜¯ä¸€ä¸ªå…±äº«èµ„æºï¼Œä½†å®ƒåªèƒ½è®¿é—®å®ƒæ‰€è¿è¡Œçš„èŠ‚ç‚¹ä¸Šå½“å‰å·¥ä½œè´Ÿè½½çš„å¯†é’¥ã€‚å› æ­¤ï¼Œå®ƒçš„çˆ†ç‚¸åŠå¾„å¹¶ä¸æ¯”ä»»ä½•å…¶ä»–ä¾é æ¯ä¸ªèŠ‚ç‚¹å¯†é’¥è¿›è¡ŒåŠ å¯†çš„åŠ å¯† CNI å·®ã€‚å¦å¤–ï¼Œè€ƒè™‘åˆ° ztunnel æœ‰é™çš„ä»…æœ‰çš„ L4 æ”»å‡»é¢å’Œ Envoy çš„ä¸Šè¿°å®‰å…¨ç‰¹æ€§ï¼Œæˆ‘ä»¬è§‰å¾—è¿™ç§é£é™©æ˜¯æœ‰é™çš„ï¼Œå¯ä»¥æ¥å—çš„ã€‚&lt;/p&gt;
&lt;p&gt;æœ€åï¼Œè™½ç„¶ waypoint ä»£ç†æ˜¯ä¸€ç§å…±äº«èµ„æºï¼Œä½†å®ƒä»¬åªé™äºä¸ºä¸€ä¸ªæœåŠ¡è´¦æˆ·æœåŠ¡ã€‚è¿™ä½¿å¾—å®ƒä»¬ä¸ä¼šæ¯”ç°åœ¨çš„ sidecar æ›´ç³Ÿï¼›å¦‚æœä¸€ä¸ª waypoint ä»£ç†è¢«æ”»ç ´ï¼Œä¸è¯¥ waypoint ç›¸å…³çš„å‡­è¯å°±ä¼šä¸¢å¤±ï¼Œè€Œä¸ä¼šæœ‰å…¶ä»–é—®é¢˜ã€‚&lt;/p&gt;
&lt;h2 id=&#34;è¿™æ˜¯-sidecar-çš„ç»ˆç»“å—&#34;&gt;è¿™æ˜¯ sidecar çš„ç»ˆç»“å—ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;è‚¯å®šä¸æ˜¯ã€‚è™½ç„¶æˆ‘ä»¬ç›¸ä¿¡ Ambient Mesh å°†æ˜¯è®¸å¤šç½‘æ ¼ç”¨æˆ·æœªæ¥çš„æœ€ä½³é€‰æ‹©ï¼Œä½†å¯¹äºé‚£äº›éœ€è¦ä¸“ç”¨æ•°æ®å¹³é¢èµ„æºçš„ç”¨æˆ·æ¥è¯´ï¼Œå¦‚åˆè§„æ€§æˆ–æ€§èƒ½è°ƒæ•´ï¼Œsidecar ä»ç„¶æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚Istio å°†ç»§ç»­æ”¯æŒ sidecarï¼Œè€Œä¸”é‡è¦çš„æ˜¯ï¼Œå…è®¸å®ƒä»¬ä¸ Ambient Mesh æ— ç¼äº’é€šã€‚äº‹å®ä¸Šï¼Œæˆ‘ä»¬ä»Šå¤©å‘å¸ƒçš„ Ambient Mesh ä»£ç å·²ç»æ”¯æŒä¸åŸºäº sidecar çš„ Istio çš„äº’æ“ä½œã€‚&lt;/p&gt;
&lt;h2 id=&#34;è§†é¢‘ä»‹ç»&#34;&gt;è§†é¢‘ä»‹ç»&lt;/h2&gt;
&lt;p&gt;è¯·çœ‹ä¸€ä¸ªç®€çŸ­çš„ &lt;a href=&#34;https://youtu.be/nupRBh9Iypo&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;YouTube è§†é¢‘&lt;/a&gt;ï¼Œçœ‹ Christian è¿è¡Œ Istio Ambient Mesh ç»„ä»¶å¹¶æ¼”ç¤ºä¸€äº›åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å‚ä¸è¿›æ¥&#34;&gt;å‚ä¸è¿›æ¥&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬ä»Šå¤©å‘å¸ƒçš„æ˜¯ Istio ä¸­ Ambient Mesh çš„æ—©æœŸç‰ˆæœ¬ï¼Œå®ƒåœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šä»å¤„äºç§¯æçš„å¼€å‘ä¹‹ä¸­ã€‚æˆ‘ä»¬å¾ˆé«˜å…´ä¸æ›´å¹¿æ³›çš„ç¤¾åŒºåˆ†äº«å®ƒï¼Œå¹¶æœŸå¾…ç€åœ¨ 2023 å¹´è¿›å…¥ç”Ÿäº§å°±ç»ªé˜¶æ®µæ—¶ï¼Œè®©æ›´å¤šäººå‚ä¸å¡‘é€ å®ƒã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¸Œæœ›å¾—åˆ°ä½ çš„åé¦ˆæ¥å¸®åŠ©å¡‘é€ è¿™ä¸ªè§£å†³æ–¹æ¡ˆã€‚æ”¯æŒ Ambient Mesh çš„ Istio æ„å»ºç‰ˆå¯ä»¥åœ¨ &lt;a href=&#34;https://github.com/istio/istio/tree/experimental-ambient&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Istio å®éªŒç‰ˆ&lt;/a&gt;ä¸­&lt;a href=&#34;https://istio.io/latest/blog/2022/get-started-ambient/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä¸‹è½½å’Œè¯•ç”¨&lt;/a&gt;ã€‚åœ¨ &lt;a href=&#34;https://github.com/istio/istio/blob/experimental-ambient/README.md&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;README&lt;/a&gt; ä¸­æä¾›äº†ä¸€ä»½ç¼ºå¤±åŠŸèƒ½å’Œå·¥ä½œé¡¹ç›®çš„æ¸…å•ã€‚è¯·å°è¯•ä¸€ä¸‹ï¼Œå¹¶ &lt;a href=&#34;https://slack.istio.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è®©æˆ‘ä»¬çŸ¥é“ä½ çš„æƒ³æ³•&lt;/a&gt;ï¼&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>äº‘åŸç”Ÿç½‘ç»œåŠŸèƒ½ï¼ˆCNFï¼‰ ä»‹ç»</title>
      <link>https://lib.jimmysong.io/blog/cloud-native-network-functions/</link>
      <pubDate>Tue, 23 Aug 2022 11:00:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/cloud-native-network-functions/</guid>
      <description>&lt;p&gt;æœ¬æ–‡è¯‘è‡ª &lt;a href=&#34;https://infoq.com/articles/cloud-native-network-functions/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Cloud Native Network Functions Are Here&lt;/a&gt;ï¼Œè¯‘è€… &lt;a href=&#34;https://jimmysong.io&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Jimmy Song&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä¸»è¦æ”¶è·&#34;&gt;ä¸»è¦æ”¶è·&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;äº‘åŸç”Ÿç½‘ç»œä¸æ˜¯å¦ä¸€ç§æ–¹å¼çš„ SDNï¼Œå®ƒä»¥ä¸€ç§å®Œå…¨ä¸åŒçš„æ–¹å¼æ¥çœ‹å¾…ç½‘ç»œã€‚&lt;/li&gt;
&lt;li&gt;è™½ç„¶SDNä¼¼ä¹æ˜¯æŠŠç‰©ç†ç½‘ç»œå’Œæœºå™¨åšäº†è™šæ‹ŸåŒ–ï¼Œä½†ã€Œäº‘åŸç”Ÿç½‘ç»œåŠŸèƒ½ã€ï¼ˆCloud-native Network Functionsï¼Œä¸‹æ–‡ç®€ç§° CNFï¼‰ä¸ä»…ä»…æ˜¯å®¹å™¨åŒ–çš„ç½‘ç»œå’Œè™šæ‹Ÿæœºï¼Œå®ƒè¿˜å°†ç½‘ç»œåŠŸèƒ½åˆ†å‰²æˆæœåŠ¡ï¼Œè¿™æ˜¯ CNF ä¸ SDN çš„ä¸€ä¸ªä¸»è¦åŒºåˆ«ã€‚&lt;/li&gt;
&lt;li&gt;CNFæ˜¯OSIç½‘ç»œæ¨¡å‹ä¸­çš„ç½‘ç»œåŠŸèƒ½ï¼ˆè¶Šåº•å±‚å®ç°èµ·æ¥å°±è¶Šå›°éš¾ï¼‰ï¼Œè¿™äº›åŠŸèƒ½æ˜¯æ ¹æ®äº‘åŸç”Ÿå®è·µå®ç°çš„ã€‚&lt;/li&gt;
&lt;li&gt;è™½ç„¶SDNæ•°æ®å¹³é¢ï¼ˆè¿™é‡ŒæŒ‡çš„æ˜¯è½¬å‘æ•°æ®åŒ…ï¼‰ä½äºç¡¬ä»¶ASICä¸Šï¼Œæˆ–åœ¨ä¼ ç»Ÿå†…æ ¸ç½‘ç»œè½¬å‘çš„è™šæ‹ŸåŒ–ç›’å­é‡Œï¼Œä½†CNFæ¢ç´¢ç”¨æˆ·å¹³é¢è½¬å‘æˆ–æ›´æ–°çš„eBPFæ•°æ®è·¯å¾„è½¬å‘ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨äº‘åŸç”Ÿæ•°æ®ä¸­å¿ƒä¸­ï¼Œåå‘äºä¸‰å±‚çš„è§£å†³æ–¹æ¡ˆï¼Œä½†CNFçš„ä¸€å¤§é©±åŠ¨åŠ›æ˜¯ç”µä¿¡æœåŠ¡æä¾›å•†ï¼Œä»–ä»¬ç»å¸¸ä¸‹é™åˆ°äºŒå±‚çš„åŠŸèƒ½ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åœ¨ä¸‰ç±»äº‘èµ„æºï¼ˆè®¡ç®—ã€å­˜å‚¨å’Œç½‘ç»œï¼‰ä¸­ï¼Œç½‘ç»œä¼¼ä¹æœ€éš¾æ»¡è¶³äº‘åŸç”Ÿçš„éåŠŸèƒ½æ€§éœ€æ±‚ã€‚ä¾‹å¦‚ï¼Œè®¡ç®—å¼¹æ€§å¯ä»¥é€šè¿‡è™šæ‹Ÿæœºã€å®¹å™¨å’Œç¼–æ’å™¨åˆç†åˆ†é…ï¼Œå¹¶é€šè¿‡CI/CDç®¡é“è¿›è¡Œç®¡ç†ã€‚ç½‘ç»œå¼¹æ€§ä¼¼ä¹åœ¨å®æ–½ä¸­æœ‰æ‰€æ¬ ç¼ºã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å±•ç¤ºäº†äº‘åŸç”Ÿç½‘ç»œåŠŸèƒ½å°†ç½‘ç»œåº”ç”¨å¼•å…¥äº‘åŸç”Ÿä¸–ç•Œçš„ä¸€ç§å°è¯•ã€‚ç©¶ç«Ÿä»€ä¹ˆæ˜¯CNFï¼Œä¸ºä»€ä¹ˆå®ƒä»¬å¾ˆé‡è¦ï¼Ÿ&lt;/p&gt;
&lt;h2 id=&#34;sdné‡ç”Ÿæˆ‘ä»¬ä»¥å‰æ²¡æœ‰è¯•è¿‡å—&#34;&gt;SDNé‡ç”Ÿï¼Ÿæˆ‘ä»¬ä»¥å‰æ²¡æœ‰è¯•è¿‡å—ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;ä¸è®ºæ˜¯åœ¨è¿‡å»è¿˜æ˜¯ç°åœ¨ï¼Œè½¯ä»¶å®šä¹‰ç½‘ç»œï¼ˆSDNï¼‰éƒ½è¯•å›¾å®ç°ç½‘ç»œé…ç½®çš„è‡ªåŠ¨åŒ–ã€‚CNF ä¸æ˜¯å¦ä¸€ç§ SDNï¼Œè€Œæ˜¯ä»¥ä¸€ç§å®Œå…¨ä¸åŒçš„æ–¹å¼æ¥çœ‹å¾…ç½‘ç»œã€‚ä»æŸç§æ„ä¹‰ä¸Šè¯´ï¼ŒCNFä¸SDNä¸€æ ·ï¼Œéƒ½æ˜¯åŸºäºè½¯ä»¶è€Œéç¡¬ä»¶çš„è§£å†³æ–¹æ¡ˆã€‚ä½†äº‘åŸç”Ÿç½‘ç»œæœ‰ä¸€å¥—å…¨æ–°çš„éåŠŸèƒ½è¦æ±‚ï¼Œä¸SDNä¸åŒã€‚äº‘åŸç”Ÿçš„éåŠŸèƒ½è¦æ±‚ä¼˜å…ˆè€ƒè™‘å¼¹æ€§ï¼Œå¹¶æ¨è€Œå¹¿ä¹‹ï¼Œè‡ªåŠ¨åŒ–ä¹Ÿæ¯”SDNå¤šå¾—å¤šã€‚è¿™ä¸€è¦æ±‚çš„å®ç°å€šé‡äºå£°æ˜æ€§é…ç½®ã€‚æ¢å¥è¯è¯´ï¼Œäº‘åŸç”Ÿé…ç½®åº”è¯¥æ›´å–œæ¬¢è¯´&amp;quot;æƒ³åšä»€ä¹ˆ&amp;quot;ï¼Œè€Œä¸æ˜¯&amp;quot;æƒ³æ€ä¹ˆåš&amp;quot;ã€‚ä¾‹å¦‚ï¼Œå£°æ˜å¼é…ç½®å¯¹ç½‘ç»œçš„å½±å“ä¹‹ä¸€æ˜¯ç¦æ­¢ç¡¬ç¼–ç çš„IPåœ°å€ã€‚å£°æ˜å¼é…ç½®å…è®¸æ•´ä¸ªç³»ç»Ÿè‡ªæˆ‘ä¿®å¤ï¼Œå› ä¸ºå®ƒä½¿äººä»¬æ›´å®¹æ˜“è¯»æ‡‚å’Œå›åº”ç³»ç»Ÿåº”è¯¥æ˜¯ä»€ä¹ˆæ ·å­ã€‚ç„¶åå¯ä»¥ä½¿ç³»ç»Ÿä¸æ–­åœ°è‡ªæˆ‘ä¿®æ­£ã€‚äº‘åŸç”Ÿç³»ç»Ÿçš„å…¶ä»–éåŠŸèƒ½è¦æ±‚æ˜¯å¼¹æ€§å’Œå¯ç”¨æ€§ï¼Œä½†ç”¨æ‰©å±•å†—ä½™è€Œä¸æ˜¯æ‰©å±•æŠ€æœ¯å®ç°ã€‚äº‘åŸç”Ÿç³»ç»Ÿè¯•å›¾é€šè¿‡æ›´é«˜çš„å¯æœåŠ¡æ€§å’Œå†—ä½™åº¦ä½¿å­ç»„ä»¶å…·æœ‰æ›´é«˜çš„å¯ç”¨æ€§æ¥è§£å†³å¯é æ€§é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œåœ¨äº‘åŸç”Ÿç³»ç»Ÿä¸­ï¼Œå¦‚æœä¸€ä¸ªé¡¶çº§ç»„ä»¶å¸¦æœ‰å¤šä¸ªå†—ä½™çš„å­ç»„ä»¶ï¼Œå…¶ä¸­æœ‰å‡ ä¸ªç»„ä»¶æ˜¯å¯ç”¨çš„ï¼Œä½†æœ‰å‡ ä¸ªç»„ä»¶å‡ºç°æ•…éšœï¼Œè¿™æ¯”ä¸€ä¸ªç´§å¯†è€¦åˆä½†&amp;quot;é«˜åº¦å¯é  &amp;quot;çš„ç»„ä»¶æ›´å¯é ã€‚&lt;/p&gt;
&lt;h2 id=&#34;è¶…è¶Šè™šæ‹ŸåŒ–çš„ç½‘ç»œç›’å­&#34;&gt;è¶…è¶Šè™šæ‹ŸåŒ–çš„ç½‘ç»œç›’å­&lt;/h2&gt;
&lt;p&gt;åœ¨æŸç§æ„ä¹‰ä¸Šï¼Œ&amp;quot;ç½‘ç»œåŠŸèƒ½&amp;quot;å¹¶æ²¡æœ‰è¢«è§£è€¦ã€‚è™šæ‹Ÿç½‘ç»œåŠŸèƒ½ï¼ˆVNFï¼‰å¼€å§‹æ˜¯ç½‘ç»œç¡¬ä»¶çš„è™šæ‹ŸåŒ–ã€‚VNFæœ‰ä¸€ä¸ªç¡¬ä»¶ä¸è™šæ‹ŸåŒ–ç¡¬ä»¶çš„ä¸€å¯¹ä¸€å¯¹åº”å…³ç³»ï¼Œå°åˆ°ç½‘å¡ã€ç‰¹å®šåº”ç”¨é›†æˆç”µè·¯ï¼ˆASICï¼‰ï¼Œå¤§åˆ°æ•´ä¸ªäº¤æ¢æœºã€‚è™½ç„¶SDNä¼¼ä¹é‡‡å–ç‰©ç†ç½‘ç»œæœºå™¨å¹¶å°†å…¶è™šæ‹ŸåŒ–ï¼Œä½†CNFä¸ä»…ä»…æ˜¯å®¹å™¨åŒ–çš„ç½‘ç»œè™šæ‹Ÿæœºã€‚CNFæ˜¯å…³äºè¿›ä¸€æ­¥è§£è€¦ç½‘ç»œåŠŸèƒ½çš„ã€‚CNFæ ¹æ®æ•æ·äº§å“å›¢é˜Ÿçš„å‘å¸ƒå‘¨æœŸï¼Œå°†ç½‘ç»œåŠŸèƒ½åˆ†ç»„ä¸ºå…·æœ‰ç±»ä¼¼å˜åŒ–ç‡çš„ç»„ä»¶ï¼Œè¿™å°±æ‘†è„±äº†å¤§å…¬å¸çš„å¤§å‹å‘å¸ƒå‘¨æœŸã€‚ç”±äº§å“å›¢é˜Ÿå‘å¸ƒçš„è½¯ä»¶[^4] å¯ä»¥è¢«è®¤ä¸ºæ˜¯å¾®æœåŠ¡çš„&amp;quot;åš&amp;quot;å®šä¹‰ã€‚å¾®æœåŠ¡çš„ &amp;ldquo;è–„&amp;rdquo; å®šä¹‰æ˜¯æŒ‡ä½œä¸ºå®¹å™¨å†…çš„å•ä¸€è¿›ç¨‹ç±»å‹äº¤ä»˜çš„è½¯ä»¶ã€‚é€šè¿‡è·Ÿè¸ªå¼€å‘è½¯ä»¶çš„äº§å“å›¢é˜Ÿï¼Œæˆ‘ä»¬å‘ç°åšå¾®æœåŠ¡åœ¨å®è·µä¸­å¾€å¾€çœ‹èµ·æ¥è–„å¾®æœåŠ¡å¾ˆåƒã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†ç®¡ç†å¾®æœåŠ¡ï¼Œå‡ºç°äº†ç¼–æ’å™¨ã€‚ç¼–æ’å™¨è´Ÿè´£å¾®æœåŠ¡çš„è°ƒåº¦ã€å¯åŠ¨ã€åœæ­¢å’Œç›‘æ§ï¼ˆ&lt;a href=&#34;https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç”Ÿå‘½å‘¨æœŸ&lt;/a&gt;ï¼‰ã€‚æœ‰è®¸å¤šç¼–æ’å™¨ï¼Œå…¶ä¸­Kubernetesï¼ˆK8sï¼‰æ˜¯æœ€å—æ¬¢è¿çš„ï¼Œä½†ä¹Ÿæœ‰ç‰¹å®šé¢†åŸŸçš„ç¼–æ’å™¨ï¼Œå¦‚ç”µä¿¡é¢†åŸŸçš„ç¼–æ’å™¨ã€‚äº‘åŸç”Ÿç”Ÿæ€ç³»ç»Ÿçš„æ—©æœŸæ‰¿è¯ºä¹‹ä¸€æ˜¯ä½¿ç¼–æ’å™¨K8sä¸è¢«&amp;quot;ç¢ç‰‡åŒ–&amp;quot;ã€‚ç”±CNCFç»´æŠ¤çš„å®˜æ–¹&lt;a href=&#34;https://www.cncf.io/certification/software-conformance/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;K8sè®¤è¯&lt;/a&gt;ï¼Œç¡®ä¿K8sçš„ä»»ä½•åˆ†å‰ç‰ˆæœ¬éƒ½èƒ½æ”¯æŒç¤¾åŒºè§„å®šçš„APIå’Œæœ€ä½³å®è·µã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç©¶ç«Ÿä»€ä¹ˆæ˜¯äº‘åŸç”Ÿç½‘ç»œåŠŸèƒ½&#34;&gt;ç©¶ç«Ÿä»€ä¹ˆæ˜¯äº‘åŸç”Ÿç½‘ç»œåŠŸèƒ½ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;äº‘åŸç”Ÿç½‘ç»œåŠŸèƒ½ï¼ˆCNFï¼‰ä½äº OSI æ¨¡å‹çš„ç¬¬å…­å±‚ï¼Œå®ƒå‡ºç°åœ¨äº†&lt;a href=&#34;https://github.com/cncf/trailmap&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;äº‘åŸç”Ÿè¶³è¿¹å›¾&lt;/a&gt;ä¸­ã€‚CNFåœ¨å †æ ˆä¸­çš„ä½ç½®è¶Šä½ï¼Œè‰¯å¥½çš„äº‘åŸç”Ÿå®ç°å°±è¶Šå›°éš¾ã€‚è¿™å¯èƒ½æ˜¯å› ä¸ºç½‘ç»œéœ€è¦ä¸ç¼–æ’å™¨å’Œåº•å±‚ä¸»æœºé›†æˆï¼ŒåŒæ—¶ä¿ç•™å…¶äº‘åŸç”Ÿå±æ€§ã€‚è¿™ä¹Ÿå¯èƒ½æ˜¯å› ä¸ºå°†ä»¥å‰çš„ç½‘ç»œåŠŸèƒ½ï¼ˆå¦‚è½¬å‘å¹³é¢çš„åŠŸèƒ½ï¼‰ä»å…±äº«å†…å­˜/çº¿ç¨‹æ¨¡å‹ä¸­åˆ†ç¦»å‡ºæ¥ï¼Œå½¢æˆä¸€ä¸ªæ— å…±äº«çš„è¿›ç¨‹æ¨¡å‹ï¼Œå¦‚æœä¸ä»”ç»†æ“ä½œï¼Œä¼šé™ä½æ€§èƒ½ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†ç†è§£ç½‘ç»œåŠŸèƒ½è§£è€¦çš„å½±å“ï¼Œäº†è§£ä¸€ä¸‹ç½‘ç»œå±‚èƒŒåçš„åŸå› æ˜¯æœ‰å¸®åŠ©çš„ã€‚OSIå±‚çš„å‘å±•ä½¿ç½‘ç»œåˆ›æ–°å¾—ä»¥å‘ç”Ÿï¼ŒåŒæ—¶ä¿æŒå †æ ˆä¸Šä¸‹å„å±‚ä¹‹é—´çš„äº’æ“ä½œæ€§ã€‚åœ¨ç½‘ç»œå±‚ï¼ŒIPåè®®æœ€ç»ˆæˆä¸ºä¸€ä¸ªå¤§èµ¢å®¶ã€‚åœ¨æ•°æ®é“¾è·¯å±‚ï¼ŒARPå‡ºç°äº†ã€‚å¤šä¸ªä¾›åº”å•†åœ¨æ¯ä¸€å±‚çš„åè®®å±‚é¢è¿›è¡Œè¿­ä»£ï¼Œåˆ›é€ æ–°çš„åè®®å’Œåè®®çš„æ–°å®ç°ã€‚CNF æœ‰æœºä¼šä½œä¸ºåº“å†…çš„åè®®ã€å¾®æœåŠ¡å†…çš„åè®®ï¼Œç”šè‡³ä½œä¸ºç½‘ç»œåº”ç”¨å†…çš„ä¸€ç»„å¾®æœåŠ¡æ¥å®ç°ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://networkservicemesh.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Network Service Mesh&lt;/a&gt;é¡¹ç›®çš„Ed Warnickeæ›¾ç»è¯´è¿‡ï¼Œå¯¹äºç½‘ç»œæœåŠ¡æ¥è¯´ï¼Œ&amp;quot;&lt;a href=&#34;https://www.youtube.com/watch?v=OyI2ZuwIc_Q&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ•°æ®åŒ…å°±æ˜¯æœ‰æ•ˆè½½è·&lt;/a&gt;&amp;quot;ã€‚è¿™æ„å‘³ç€ç½‘ç»œåº”ç”¨æˆ–æœåŠ¡å®é™…ä¸Šæ˜¯å¯¹ç½‘ç»œæ•°æ®åŒ…æˆ–å¸§è¿›è¡Œæ“ä½œï¼ˆè½¬æ¢ã€è·¯ç”±æˆ–åˆ†æï¼‰ã€‚ä»¥ä¸‹æ˜¯OSIæ¨¡å‹å„å±‚çš„ç½‘ç»œåŠŸèƒ½çš„ä¸€äº›ä¾‹å­ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç¬¬ä¸ƒå±‚ï¼šCoreDNS&lt;/li&gt;
&lt;li&gt;ç¬¬å…­å±‚ï¼šNFFæ•°æ®åŒ…æ£€æŸ¥å™¨&lt;/li&gt;
&lt;li&gt;ç¬¬äº”å±‚ï¼šRsocket&lt;/li&gt;
&lt;li&gt;ç¬¬å››å±‚å’Œç¬¬ä¸‰å±‚ï¼šEnvoy/Network Service Mesh/å„ç§CNIæ’ä»¶&lt;/li&gt;
&lt;li&gt;ç¬¬äºŒå±‚ï¼šåŸºäºVPPçš„VSwitch&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¯¹äºäº‘åŸç”Ÿç½‘ç»œåº”ç”¨ï¼Œæˆ–è·¨è¶Šå¤šå±‚çš„é«˜é˜¶CNFï¼Œä¾‹å¦‚ &lt;a href=&#34;https://www.matrixx.com/5g-bss-technology/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;MATRIXXè½¯ä»¶&lt;/a&gt;å…¬å¸çš„&lt;a href=&#34;https://github.com/cncf/cnf-wg/tree/main/use-case/0003-UC-stateful-cnf&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;5Gèåˆè®¡è´¹ç³»ç»Ÿ&lt;/a&gt;å’Œ&lt;a href=&#34;https://cdnf.io/cnf_list/bgp/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;PANTHEON.tech&lt;/a&gt;å…¬å¸çš„&lt;a href=&#34;https://github.com/cncf/cnf-wg/tree/main/use-case/0002-UC-bgp-enterprise&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;BGPæœåŠ¡å™¨&lt;/a&gt;ä½¿ç”¨æ¡ˆä¾‹ã€‚&lt;/p&gt;
&lt;p&gt;äº‘åŸç”Ÿè¶³è¿¹å›¾åœ¨ä¸€å®šç¨‹åº¦ä¸Šæè¿°äº†äº‘åŸç”Ÿåº”ç”¨ç¨‹åºçš„æˆç†Ÿåº¦ã€‚å½“æˆ‘ä»¬æ·±å…¥ç ”ç©¶äº‘åŸç”Ÿé“è·¯ä¸Šçš„æ¯ä¸€æ­¥æ—¶ï¼Œäº‹æƒ…å°±ä¼šå˜å¾—æ›´åŠ å¤æ‚ï¼Œæ¯”å¦‚ç½‘ç»œã€ç­–ç•¥å’Œå®‰å…¨ã€‚è¿™å°±æ˜¯è¯´ï¼Œåœ¨å¸®åŠ©ä½ å®ç°äº‘åŸç”Ÿçš„å·¥å…·ä¸­å­˜åœ¨ç€äº‘åŸç”Ÿçš„åå°„æ€§ã€‚å½“æŠŠå®ƒåº”ç”¨äºCNFæ—¶ï¼Œæˆ‘ä»¬æœ€ç»ˆä¸å¾—ä¸åƒå…¶ä»–äº‘åŸç”Ÿåº”ç”¨ä¸€æ ·å®ç°ç½‘ç»œåŠŸèƒ½ã€‚è¿™æ–¹é¢çš„æ€»ç»“å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ç¬¬ä¸€æ­¥ä»ç²—ç²’åº¦çš„éƒ¨ç½²å¼€å§‹ï¼Œé€šå¸¸ä»¥å®¹å™¨å½¢å¼å®ç°ã€‚&lt;/li&gt;
&lt;li&gt;ç¬¬äºŒæ­¥æ˜¯è®©æœåŠ¡æˆ–åº”ç”¨ç¨‹åºåœ¨CI/CDç®¡é“ä¸­ä»¥æ— çŠ¶æ€å’Œå£°æ˜å¼çš„é…ç½®è¿›è¡Œéƒ¨ç½²ã€‚&lt;/li&gt;
&lt;li&gt;ç¬¬ä¸‰æ­¥æ˜¯æ”¯æŒéƒ¨ç½²åœ¨åŒè´¨åŒ–èŠ‚ç‚¹ä¸Šçš„ç¼–æ’å™¨ï¼ˆå¦‚K8sï¼‰ï¼Œè¯¥ç¼–æ’å™¨ç®¡ç†æœåŠ¡çš„ç”Ÿå‘½å‘¨æœŸã€‚&lt;/li&gt;
&lt;li&gt;ç¬¬å››æ­¥ç¡®ä¿ç½‘ç»œåŠŸèƒ½æœ‰é¥æµ‹åŠŸèƒ½ï¼Œè¿™åŒ…æ‹¬åº¦é‡ï¼ˆå¦‚å¼€æ”¾åº¦é‡å…¼å®¹çš„Prometheusï¼‰ã€è¿½è¸ªï¼ˆå…¼å®¹OpenTracingçš„Jaegerï¼‰å’Œäº‹ä»¶æµå…¼å®¹çš„æ—¥å¿—ï¼ˆå¦‚Fluentdï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;äº‘åŸç”Ÿæˆç†Ÿåº¦çš„ç¬¬äº”æ­¥ï¼ŒæœåŠ¡å‘ç°ï¼Œå…è®¸ç½‘ç»œæœåŠ¡è¢«é›†ç¾¤å†…éƒ¨ç”šè‡³å¤–éƒ¨çš„å…¶ä»–æ¶ˆè´¹è€…å‘ç°ã€‚&lt;/li&gt;
&lt;li&gt;ä¸ºäº†ä¿ƒè¿›å£°æ˜æ€§é…ç½®ï¼Œç¬¬å…­æ­¥æ¦‚è¿°äº†ç­–ç•¥çš„é‡è¦æ€§ï¼Œç‰¹åˆ«æ˜¯ç½‘ç»œå’Œå®‰å…¨æ”¿ç­–ï¼Œé€šè¿‡æœåŠ¡é€‚ç”¨å’Œæ”¯æŒã€‚&lt;/li&gt;
&lt;li&gt;ç¬¬ä¸ƒæ­¥æ˜¯åˆ†å¸ƒå¼å­˜å‚¨ï¼Œé€‚ç”¨äºä½¿ç”¨æœ‰çŠ¶æ€å·¥ä½œè´Ÿè½½çš„åœ°æ–¹ï¼Œä»¥ç¡®ä¿ä¸äº‘åŸç”Ÿç¯å¢ƒå…¼å®¹ã€‚&lt;/li&gt;
&lt;li&gt;äº‘åŸç”Ÿä¿¡æ¯ä¼ é€’ã€æ³¨å†Œè¡¨ã€è¿è¡Œæ—¶å’Œè½¯ä»¶åˆ†å‘æ˜¯äº‘åŸç”Ÿæˆç†Ÿåº¦çš„å…¶ä»–é˜¶æ®µï¼Œä½¿&lt;a href=&#34;https://github.com/cncf/trailmap&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;åº”ç”¨ç¨‹åºçš„æ—…ç¨‹&lt;/a&gt;æ›´åŠ å®Œå–„ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;cnfæ•°æ®å¹³é¢&#34;&gt;CNFæ•°æ®å¹³é¢&lt;/h2&gt;
&lt;p&gt;æœ‰äº†CNFï¼Œæ•°æ®å¹³é¢ï¼ˆä¹Ÿè¢«ç§°ä¸ºè½¬å‘å¹³é¢ï¼‰ä¸ä¼ ç»Ÿç¡¬ä»¶çš„è·ç¦»æ›´è¿œã€‚ç”±äºäº‘åŸç”ŸåŸåˆ™é‡è§†æ‰©å±•è€Œä¸æ˜¯æ‰©å¤§ï¼Œè¿™æ„å‘³ç€æ‹¥æœ‰æ›´å¤šçš„åŒè´¨åŒ–å•†ç”¨èŠ‚ç‚¹æ¯”æ‹¥æœ‰æ›´å°‘çš„å¼‚è´¨åŒ–å’Œä¸“ä¸šåŒ–èŠ‚ç‚¹æ›´å—æ¬¢è¿ã€‚æ­£å› ä¸ºå¦‚æ­¤ï¼Œå‡ºç°äº†ä¸€ç§åˆ†è§£è¿åŠ¨ï¼Œç”¨å•†ç”¨æœåŠ¡å™¨æ¥ä»£æ›¿ä¸“é—¨çš„ç½‘ç»œäº¤æ¢æœºçš„ç‰¹å®šåº”ç”¨é›†æˆå›è·¯ï¼ˆASICï¼‰ã€‚è¿™æ ·åšçš„ä¸€ä¸ªå¥½å¤„æ˜¯ï¼Œå‡ºç°äº†æ”¯æŒæ›´æ•æ·çš„å˜åŒ–é€Ÿåº¦çš„æ•°æ®å¹³é¢ã€‚è™½ç„¶SDNæ•°æ®å¹³é¢ï¼ˆè¿™é‡Œæˆ‘ä»¬è¯´çš„æ˜¯å­—é¢æ„ä¹‰ä¸Šçš„è½¬å‘æ•°æ®åŒ…ï¼‰åœç•™åœ¨ç¡¬ä»¶ASICä¸Šæˆ–ä¼ ç»Ÿå†…æ ¸ç½‘ç»œè½¬å‘çš„è™šæ‹ŸåŒ–ç›’å­é‡Œï¼Œä½†CNFå·²ç»å¼€å§‹æ¢ç´¢ç”¨æˆ·æ•°æ®å¹³é¢ï¼ˆå¦‚&lt;a href=&#34;https://s3-docs.fd.io/vpp/22.10/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;VPP&lt;/a&gt;ï¼‰ã€eXpress Data Pathï¼ˆXDPï¼‰çš„æ‰©å±•ä¼¯å…‹åˆ©åŒ…è¿‡æ»¤å™¨ï¼ˆeBPFï¼‰å’ŒSmartNICè½¬å‘ç­‰æŠ€æœ¯ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä¸‰å±‚ç½‘ç»œå‡å&#34;&gt;ä¸‰å±‚ç½‘ç»œå‡å&lt;/h2&gt;
&lt;p&gt;åœ¨äº‘åŸç”Ÿæ•°æ®ä¸­å¿ƒä¸­ï¼Œæœ‰ä¸€ä¸ª&lt;a href=&#34;http://docs.projectcalico.org/v3.5/usage/troubleshooting/faq#i-heard-calico-is-suggesting-layer-2-i-thought-you-were-layer-3-whats-happening&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;åå‘äºä¸‰å±‚çš„è§£å†³æ–¹æ¡ˆ&lt;/a&gt;ã€‚èƒ½å¤Ÿå£°æ˜æ€§åœ°æŒ‡å®šå’Œè‡ªåŠ¨é…ç½®ä¸‰å±‚ç½‘ç»œï¼Œè¿™æ˜¯å‘å±•Kubernetesç½‘ç»œæ¨¡å‹çš„å†³å®šæ€§å› ç´ ã€‚è¿™äº›æ–°çš„äº‘åŸç”Ÿç½‘ç»œä¾é IPåœ°å€æ¥è¿æ¥é›†ç¾¤çš„èŠ‚ç‚¹å’Œåº”ç”¨ï¼Œè€Œä¸æ˜¯ç¬¬äºŒå±‚çš„MACå’ŒVLANã€‚ç„¶è€Œï¼Œè¿™ä¸»è¦æ˜¯ç¼–æ’å™¨åŠå…¶åº”ç”¨ç¨‹åºçš„ç½‘ç»œæ•…äº‹ã€‚æ•°æ®ä¸­å¿ƒæœ‰å¤šä¸ªç§»åŠ¨éƒ¨ä»¶ï¼Œåœ¨è¿™ä¸ªæ•…äº‹ä¸­çš„å˜åŒ–ç‡ä¸åŒã€‚è¿™ä¸‰å±‚å¯ä»¥è¯´æ˜¯åœ¨ç¼–æ’å™¨ä¸‹é¢ï¼ˆæœ‰SONICç­‰ç½‘ç»œæ“ä½œç³»ç»Ÿï¼ŒTerraformç­‰é…ç½®å·¥å…·ï¼‰ï¼Œåœ¨ç¼–æ’å™¨ï¼ˆå¦‚Kubernetesï¼‰æœ¬èº«ï¼Œä»¥åŠåœ¨ç¼–æ’å™¨ä¸Šé¢ä½†åœ¨å®¹å™¨ï¼ˆå¦‚CNFï¼‰å†…ã€‚ç¼–æ’å™¨ä¸‹é¢çš„ç½‘ç»œåŸºç¡€è®¾æ–½ç»“æ„ï¼Œå¦‚æ•°æ®ä¸­å¿ƒçš„æ¶é¡¶äº¤æ¢æœºï¼ˆå¯èƒ½æ˜¯åˆ†è§£çš„ï¼‰ï¼Œç»§ç»­æ‹¥æœ‰ç¬¬äºŒå±‚é…ç½®ã€‚ç”µä¿¡é¢†åŸŸæ˜¯é‡‡ç”¨CNFçš„ä¸»è¦é©±åŠ¨åŠ›ï¼Œä¹Ÿç»§ç»­æœ‰æ— æ³•é¿å…çš„ç¬¬äºŒå±‚ç”¨ä¾‹ï¼Œå¦‚å¤šåè®®æ ‡ç­¾äº¤æ¢ï¼ˆMPLSï¼‰ã€‚ç¬¬äºŒå±‚ç»“æ„çš„æ•…äº‹ä»åœ¨ç”¨æ–°çš„äº¤æ¢è½¯ä»¶å®ç°æ¥ä¹¦å†™ï¼Œå¦‚&lt;a href=&#34;https://sonic-net.github.io/SONiC/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SONiC&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;ç½‘ç»œçš„é…ç½®ã€éƒ¨ç½²å’Œè‡ªåŠ¨åŒ–æ˜¯éš¾ä»¥å®ç°å¼¹æ€§çš„ä¸€äº›åŸå› ï¼Œè€Œå¼¹æ€§æ˜¯äº‘åŸç”Ÿç¯å¢ƒçš„ä¸»è¦ä¼˜åŠ¿ã€‚è¿™å¯èƒ½æ˜¯è½¬ç§»åˆ°è¶…çº§æœåŠ¡å™¨ï¼ˆå¦‚äºšé©¬é€Šï¼‰çš„å†³å®šæ€§å› ç´ ï¼Œå³ä½¿æ˜¯åœ¨éœ€è¦æ›´å¤šå®šåˆ¶éƒ¨ç½²çš„æ—¶å€™ã€‚è¿™ä¸ç”µä¿¡é¢†åŸŸç‰¹åˆ«ç›¸å…³ï¼Œå› ä¸ºä»–ä»¬æœ‰å®šåˆ¶çš„ç½‘ç»œåè®®ï¼Œä»–ä»¬å¯èƒ½æƒ³ä¸ºä¼ä¸šå®¢æˆ·æä¾›æ”¯æŒï¼ˆå¦‚MPLSï¼‰ã€‚CNFé€šè¿‡åŸºäºå˜åŒ–ç‡çš„ç½‘ç»œåŠŸèƒ½è§£è€¦æ¥è§£å†³è¿™äº›éƒ¨ç½²é—®é¢˜ï¼Œä¸€ç›´åˆ°ç²—ç²’åº¦çš„é•œåƒå’Œè¿›ç¨‹ï¼ˆå¦‚å®¹å™¨ï¼‰çº§åˆ«ã€‚è¿™å°±é¿å…äº†ç½‘ç»œå®¹æ˜“å‡ºç°çš„ä¼ ç»Ÿçš„é”æ­¥å¼éƒ¨ç½²é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;CNFæ˜¯ç½‘ç»œåŠŸèƒ½ï¼Œä¹Ÿå°±æ˜¯ä¼ ç»Ÿä¸Šè®¤ä¸ºä½äºOSIå †æ ˆä¸Šçš„åŠŸèƒ½ï¼Œéµå¾ªäº‘åŸç”Ÿå®è·µæ¥å®ç°ï¼Œå®ƒä¸äº‘åŸç”Ÿç”Ÿæ€ç³»ç»Ÿè€¦åˆã€‚ç½‘ç»œï¼Œå°¤å…¶æ˜¯ç”µä¿¡ç½‘ç»œï¼Œå¯¹éåŠŸèƒ½çš„è¦æ±‚ç”±æ¥å·²ä¹…ï¼Œæ¯”å¦‚è¯´å¼¹æ€§ã€‚ç”µä¿¡æœåŠ¡æä¾›å•†ä»¥911ç”µè¯ä¸ºä¾‹ï¼Œå°†å…¶ä½œä¸ºä¸€ä¸ªè¦æ±‚æåº¦å¼¹æ€§å’Œå¯ç”¨æ€§çš„å…³é”®ä»»åŠ¡ç³»ç»Ÿã€‚å³ä¾¿å¦‚æ­¤ï¼Œäº‘åŸç”Ÿç”Ÿæ€ç³»ç»Ÿçš„éåŠŸèƒ½å±æ€§ä¹Ÿå¾—åˆ°äº†æœåŠ¡æä¾›å•†çš„å…³æ³¨ã€‚è¿™äº›å±æ€§ï¼Œå¦‚å¯ç”¨æ€§ï¼ˆäº‘åŸç”Ÿå‹ï¼‰ã€æ˜“äºéƒ¨ç½²å’Œå¼¹æ€§ï¼Œä¿ƒä½¿ç”µä¿¡æœåŠ¡æä¾›å•†å¯¹ç”µä¿¡è®¾å¤‡ä¾›åº”å•†ï¼ˆåŒ…æ‹¬ç‰©ç†å’Œè½¯ä»¶ï¼‰æ–½åŠ å‹åŠ›ï¼Œä½¿å…¶æ›´åŠ äº‘åŸç”Ÿã€‚è¿™å°±è¦æ±‚è¿™äº›æ–°çš„ç½‘ç»œç»„ä»¶éµå¾ªäº‘åŸç”ŸåŸºç¡€è®¾æ–½çš„æœ€ä½³å®è·µï¼Œä»¥ä¾¿æˆä¸ºäº‘åŸç”Ÿç”Ÿæ€ç³»ç»Ÿä¸­çš„æˆç†Ÿè§£å†³æ–¹æ¡ˆã€‚è¿™å¹¶ä¸å®¹æ˜“ï¼Œå› ä¸ºè¦æŠŠä¼ ç»Ÿä¸Šç´§å¯†è€¦åˆçš„ã€å¯¹æ€§èƒ½æœ‰ä¸¥æ ¼è¦æ±‚çš„ç»„ä»¶ï¼ˆå¦‚ç½‘ç»œæ•°æ®çº¿ï¼‰è§£è€¦ï¼Œæ˜¯éå¸¸å›°éš¾çš„ã€‚&lt;/p&gt;
&lt;p&gt;CNFç©ºé—´ä¸­çš„æ•°æ®å¹³é¢æ˜¯ä¸€é¡¹æ­£åœ¨è¿›è¡Œçš„å·¥ä½œï¼Œæœ‰è®¸å¤šè§£å†³æ–¹æ¡ˆã€‚ä»…ä»…æ˜¯æ•°æ®å¹³é¢çš„æ¦‚å¿µå°±ä½¿å¯¹CNFçš„ç†è§£å˜å¾—å¤æ‚ï¼Œå› ä¸ºCNFä¸ä»…ä»…æ˜¯ä¸€ä¸ªç‰©ç†ç›’å­çš„è™šæ‹ŸåŒ–è¡¨ç¤ºã€‚åœ¨ä¸€ä¸ªå¾®ä¸è¶³é“çš„å±‚é¢ä¸Šï¼Œäº‘åŸç”Ÿæ•°æ®ä¸­å¿ƒçš„ç½‘ç»œå¯ä»¥é€šè¿‡é›†ä¸­äºé»˜è®¤çš„å†…æ ¸ç½‘ç»œå’Œç¬¬ä¸‰å±‚IPv4/IPv6ç½‘ç»œæ¥é¿å…è¿™ç§å¤æ‚åŒ–ã€‚è¿™å¯¹äºç”µä¿¡å…¬å¸çš„ç”¨ä¾‹æˆ–ç½‘ç»œç»“æ„çš„å®æ–½é€šå¸¸æ˜¯ä¸å¯è¡Œçš„ã€‚è¿™äº›é—®é¢˜æ˜¯ç½‘ç»œè½¯ä»¶è§£è€¦çš„è‡ªç„¶å‘å±•çš„ä¸€éƒ¨åˆ†ï¼Œæ‰€ä»¥æ²¡æœ‰åŠæ³•é¿å…ã€‚å¦‚æœCNFåšå¾—å¥½ï¼Œå°±ä¼šå¸¦æ¥ä»¥å‰æ²¡æœ‰æ„è¯†åˆ°çš„å¯éƒ¨ç½²æ€§ã€å¼¹æ€§ã€æ˜“é…ç½®æ€§å’Œå¼¹æ€§çš„æ–°æ°´å¹³ã€‚&lt;/p&gt;
&lt;p&gt;è¦äº†è§£æ›´å¤šå…³äºäº‘åŸç”Ÿç½‘ç»œåŠŸèƒ½çš„ä¿¡æ¯ï¼Œè¯·åŠ å…¥CNCFçš„äº‘åŸç”Ÿç½‘ç»œåŠŸèƒ½&lt;a href=&#34;https://github.com/cncf/cnf-wg&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å·¥ä½œå°ç»„&lt;/a&gt;ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>å¼€å‘è€…éœ€è¦äº†è§£çš„é›¶ä¿¡ä»»çŸ¥è¯†</title>
      <link>https://lib.jimmysong.io/blog/zero-trust-developer-guide/</link>
      <pubDate>Fri, 05 Aug 2022 11:00:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/zero-trust-developer-guide/</guid>
      <description>&lt;h2 id=&#34;å…³é”®è¦ç‚¹&#34;&gt;å…³é”®è¦ç‚¹&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;é›¶ä¿¡ä»»é€šè¿‡æœ‰é€‰æ‹©åœ°åªå…è®¸è®¿é—®ç”¨æˆ·åº”è¯¥è¢«å…è®¸è®¿é—®çš„ç‰¹å®šèµ„æºï¼Œè§£å†³äº†å¼€æ”¾ç½‘ç»œè®¿é—®çš„é—®é¢˜ã€‚&lt;/li&gt;
&lt;li&gt;å®ç°æŒç»­éªŒè¯çš„å…³é”®ç­–ç•¥æ˜¯é›¶ä¿¡ä»»ç½‘ç»œè®¿é—® (ZTNA)ã€‚&lt;/li&gt;
&lt;li&gt;å®æ–½é›¶ä¿¡ä»»æœ‰åŠ©äºè§£å†³ SOCï¼ˆå®‰å…¨è¿è¥ä¸­å¿ƒï¼‰æˆ–å®‰å…¨åˆ†æå¸ˆè§’è‰²ä¸­çš„ç»„ç»‡æŠ€èƒ½çŸ­ç¼ºé—®é¢˜ ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨é›¶ä¿¡ä»»ç¯å¢ƒä¸­ï¼Œå¼€å‘äººå‘˜å¿…é¡»å…¨é¢äº†è§£å¦‚ä½•ä¿æŠ¤è¯·æ±‚è€…ä¸åº”ç”¨ç¨‹åºäº¤äº’çš„æ¯ä¸€æ­¥ï¼ŒåŒæ—¶è€ƒè™‘å½“å‰çš„å®‰å…¨ä¸Šä¸‹æ–‡ã€‚&lt;/li&gt;
&lt;li&gt;é›¶ä¿¡ä»»æ¡†æ¶å¹¶æ²¡æœ‰æ¶ˆé™¤åœ¨æ¯æ¬¡éƒ¨ç½²åæŒç»­æ‰«ææ¼æ´çš„éœ€è¦ï¼Œæ¼æ´æ‰«æå¯ä»¥ç¡®ä¿åº”ç”¨ç¨‹åºå’Œåç«¯ç³»ç»Ÿä¿æŒä¿æŠ¤å’Œè¿ä½œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;ä»€ä¹ˆæ˜¯é›¶ä¿¡ä»»æ¨¡å‹&#34;&gt;ä»€ä¹ˆæ˜¯é›¶ä¿¡ä»»æ¨¡å‹ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;é›¶ä¿¡ä»»å®‰å…¨æ¨¡å‹æ˜¯ä¸€ç§è®¾è®¡å’Œå®æ–½å®‰å…¨ IT ç³»ç»Ÿçš„æ–¹æ³•ã€‚é›¶ä¿¡ä»»èƒŒåçš„åŸºæœ¬æ¦‚å¿µæ˜¯ â€œä»ä¸ä¿¡ä»»ï¼Œå§‹ç»ˆéªŒè¯â€ã€‚è¿™æ„å‘³ç€ç”¨æˆ·ã€è®¾å¤‡å’Œè¿æ¥åœ¨é»˜è®¤æƒ…å†µä¸‹æ°¸è¿œä¸ä¼šè¢«ä¿¡ä»»ï¼Œå³ä½¿å®ƒä»¬è¿æ¥åˆ°å…¬å¸ç½‘ç»œæˆ–ä¹‹å‰å·²ç»è¿‡èº«ä»½éªŒè¯ã€‚&lt;/p&gt;
&lt;p&gt;ç°ä»£ IT ç¯å¢ƒç”±è®¸å¤šäº’è¿çš„ç»„ä»¶ç»„æˆï¼ŒåŒ…æ‹¬æœ¬åœ°æœåŠ¡å™¨ã€åŸºäºäº‘çš„æœåŠ¡ã€ç§»åŠ¨è®¾å¤‡ã€è¾¹ç¼˜ä½ç½®å’Œç‰©è”ç½‘ (IoT) è®¾å¤‡ã€‚ä¾èµ–äºä¿æŠ¤æ‰€è°“çš„ â€œç½‘ç»œè¾¹ç•Œâ€ çš„ä¼ ç»Ÿå®‰å…¨æ¨¡å‹åœ¨è¿™ç§å¤æ‚çš„ç¯å¢ƒä¸­æ˜¯æ— æ•ˆçš„ã€‚&lt;/p&gt;
&lt;p&gt;æ”»å‡»è€…å¯ä»¥ç ´åç”¨æˆ·å‡­æ®å¹¶è®¿é—®é˜²ç«å¢™åé¢çš„æœ¬åœ°ç³»ç»Ÿã€‚&lt;/p&gt;
&lt;p&gt;ä»–ä»¬è¿˜å¯ä»¥è®¿é—®åœ¨ç»„ç»‡æ§åˆ¶ä¹‹å¤–éƒ¨ç½²çš„åŸºäºäº‘çš„æˆ–ç‰©è”ç½‘èµ„æºã€‚é›¶ä¿¡ä»»æ–¹æ³•åœ¨å—ä¿æŠ¤èµ„äº§å‘¨å›´å»ºç«‹å¾®è¾¹ç•Œï¼ˆmicro-perimeterï¼‰ï¼Œå¹¶ä½¿ç”¨ç›¸äº’èº«ä»½éªŒè¯ã€è®¾å¤‡èº«ä»½å’Œå®Œæ•´æ€§éªŒè¯ä»¥åŠåŸºäºä¸¥æ ¼ç”¨æˆ·æˆæƒçš„åº”ç”¨ç¨‹åºå’ŒæœåŠ¡è®¿é—®ç­‰å®‰å…¨æœºåˆ¶ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä¸ºä»€ä¹ˆé›¶ä¿¡ä»»å¾ˆé‡è¦&#34;&gt;ä¸ºä»€ä¹ˆé›¶ä¿¡ä»»å¾ˆé‡è¦ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;åœ¨é›¶ä¿¡ä»»å‡ºç°ä¹‹å‰ï¼Œç»„ç»‡ä½¿ç”¨é˜²ç«å¢™å’Œè™šæ‹Ÿä¸“ç”¨ç½‘ç»œ (VPN) ç­‰æŠ€æœ¯æ¥æ§åˆ¶å¯¹ç½‘ç»œå’Œåº”ç”¨ç¨‹åºçš„è®¿é—®ã€‚è¿™äº›è§£å†³æ–¹æ¡ˆçš„é—®é¢˜åœ¨äºï¼Œä¸€æ—¦è¿æ¥é€šè¿‡äº†å®‰å…¨æ£€æŸ¥ï¼Œå®ƒå°±ä¼šè¢«éšå¼ä¿¡ä»»ï¼Œå¹¶å¼€æ”¾è®¿é—®ç½‘ç»œã€‚è¿™å…è®¸åˆæ³•ç”¨æˆ·å’Œæ”»å‡»è€…è®¿é—®æ•æ„Ÿæ•°æ®å’Œå…³é”®ä»»åŠ¡èµ„æºã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†å‡è½»è¿™ç§å¨èƒï¼Œä¼ä¸šå®æ–½äº†å¤šä¸ªå¤æ‚çš„å®‰å…¨å±‚æ¥æ£€æµ‹å’Œé˜»æ­¢æ”»å‡»ï¼Œä½†æ”»å‡»è€…ä»ç„¶å¯ä»¥é¿å¼€è¿™äº›é˜²å¾¡æªæ–½ã€‚é›¶ä¿¡ä»»è§£å†³äº†å¼€æ”¾ç½‘ç»œè®¿é—®çš„é—®é¢˜ï¼Œæ ¹æ®ç»†åŒ–çš„è®¿é—®ç­–ç•¥å’Œå½“å‰çš„å®‰å…¨ç¯å¢ƒï¼Œæœ‰é€‰æ‹©åœ°åªå…è®¸è®¿é—®ç”¨æˆ·åº”è¯¥è¢«å…è®¸è®¿é—®çš„ç‰¹å®šèµ„æºã€‚&lt;/p&gt;
&lt;h2 id=&#34;é›¶ä¿¡ä»»æ¨¡å‹çš„æ ¸å¿ƒåŸåˆ™æ˜¯ä»€ä¹ˆ&#34;&gt;é›¶ä¿¡ä»»æ¨¡å‹çš„æ ¸å¿ƒåŸåˆ™æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/h2&gt;
&lt;p&gt;å®æ–½é›¶ä¿¡ä»»å®‰å…¨æ¨¡å‹éœ€è¦å°†ä»¥ä¸‹åŸåˆ™çº³å…¥ç»„ç»‡çš„å®‰å…¨ç­–ç•¥ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æŒç»­éªŒè¯&#34;&gt;æŒç»­éªŒè¯&lt;/h3&gt;
&lt;p&gt;æŒç»­éªŒè¯æ˜¯é›¶ä¿¡ä»»çš„å…³é”® â€”â€” è¿™æ„å‘³ç€æ²¡æœ‰éšå¼å—ä¿¡ä»»çš„è®¾å¤‡ã€å‡­æ®æˆ–åŒºåŸŸã€‚å‡ ä¸ªå…ƒç´ å¯¹äºå…è®¸å¯¹å„ç§èµ„äº§è¿›è¡ŒæŒç»­éªŒè¯è‡³å…³é‡è¦ï¼ŒåŒ…æ‹¬åŸºäºé£é™©çš„æ¡ä»¶è®¿é—®ä»¥ç»´æŠ¤ç”¨æˆ·ä½“éªŒå’Œæ˜“äºåº”ç”¨çš„è€ƒè™‘åˆè§„æ€§è¦æ±‚çš„åŠ¨æ€å®‰å…¨ç­–ç•¥ã€‚&lt;/p&gt;
&lt;p&gt;å®ç°æŒç»­éªŒè¯çš„å…³é”®ç­–ç•¥æ˜¯&lt;a href=&#34;https://www.catonetworks.com/zero-trust-network-access/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;é›¶ä¿¡ä»»ç½‘ç»œè®¿é—® (ZTNA)&lt;/a&gt; â€”â€”ä¸€ç§å®æ–½é›¶ä¿¡ä»»ç­–ç•¥çš„è§£å†³æ–¹æ¡ˆã€‚ZTNA å¯ä»¥å¼ºåˆ¶æ‰§è¡Œæœ€å°æƒé™åŸåˆ™ (PLP)ï¼Œè¿™æ ·ç”¨æˆ·æˆ–æœåŠ¡è´¦æˆ·åªèƒ½åœ¨å…¶è§’è‰²éœ€è¦æ—¶æ‰èƒ½è®¿é—®èµ„æºã€‚è¿™ç§ç½‘ç»œç­–ç•¥å°†ç½‘ç»œå®‰å…¨é£é™©é™è‡³æœ€ä½ï¼Œå¹¶ä¿æŠ¤ç»„ç»‡å…å—å†…éƒ¨å’Œå¤–éƒ¨å¨èƒã€‚&lt;/p&gt;
&lt;h3 id=&#34;å¾®åˆ†æ®µ&#34;&gt;å¾®åˆ†æ®µ&lt;/h3&gt;
&lt;p&gt;é›¶ä¿¡ä»»ç½‘ç»œåº”&lt;a href=&#34;https://www.tigera.io/learn/guides/zero-trust/microsegmentation/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å®æ–½å¾®åˆ†æ®µ&lt;/a&gt;ä»¥åˆ›å»ºå¤šä¸ªå—ä¿æŠ¤åŒºåŸŸï¼Œè€Œä¸æ˜¯å•ä¸ªå®‰å…¨è¾¹ç•Œã€‚è¿™ç§æ–¹æ³•æœ‰åŠ©äºåˆ†åˆ«ä¿æŠ¤ç½‘ç»œçš„ä¸åŒéƒ¨åˆ†ï¼Œå› æ­¤ä¸€ä¸ªå—æŸåŒºåŸŸä¸ä¼šå¨èƒåˆ°ç½‘ç»œçš„å…¶ä½™éƒ¨åˆ†ã€‚&lt;/p&gt;
&lt;div class=&#34;alert-note-title&#34;&gt;
    &lt;p&gt;ä»€ä¹ˆæ˜¯å¾®åˆ†æ®µ&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;alert alert-note&#34;&gt;
    å¾®åˆ†æ®µï¼ˆMicrosegmentationï¼‰æ˜¯æ¯ä¸ªç½‘ç»œä»…æœ‰ä¸¤ä¸ªç«¯ç«™ï¼Œå³äº¤æ¢æœºçš„ä¸€ä¸ªæ¥å£ä¸Šåªè¿æ¥ä¸€å°ä¸»æœºï¼Œæˆ–è€…ä¸åŒçš„ä¸¤ä¸ªæ¥å£ä¸Šå„è¿æ¥ä¸€å°ä¸»æœºã€‚å®ƒå¯ä»¥ä½¿ç«¯ç«™ä¹‹é—´ä¸ä¼šäº§ç”Ÿå†²çªï¼Œæ˜¯å®ç°å…¨åŒå·¥çš„å¿…è¦å› ç´ ã€‚æ¯ä¸ªç«¯ç«™æœ‰ä¸“ç”¨å¸¦å®½ï¼Œå³æ¯ä¸€ä¸ªå¾®åˆ†æ®µå¯ä»¥ç”±ä¸€ä¸ªç«™å•ç‹¬ä½¿ç”¨ã€‚
&lt;/div&gt;

&lt;h3 id=&#34;æœ€å°æƒé™è®¿é—®&#34;&gt;æœ€å°æƒé™è®¿é—®&lt;/h3&gt;
&lt;p&gt;æœ€å°æƒé™åŸåˆ™æ˜¯é›¶ä¿¡ä»»çš„å…³é”®ã€‚å®ƒæ¶‰åŠæˆäºˆæ¯ä¸ªç”¨æˆ·æˆ–å®ä½“æœ€ä½å¿…è¦çš„è®¿é—®æƒé™ï¼Œé˜²æ­¢æš´éœ²äºæ•æ„Ÿç½‘ç»œåŒºåŸŸã€‚æœ€å°æƒé™æ–¹æ³•éœ€è¦ä»”ç»†ç®¡ç†ç”¨æˆ·æƒé™ã€‚&lt;/p&gt;
&lt;h3 id=&#34;è®¾å¤‡è®¿é—®æ§åˆ¶&#34;&gt;è®¾å¤‡è®¿é—®æ§åˆ¶&lt;/h3&gt;
&lt;p&gt;å¼ºå¤§çš„è®¾å¤‡è®¿é—®æ§åˆ¶è¡¥å……äº†ç”¨æˆ·è®¿é—®æ§åˆ¶ï¼Œä»¥ç¡®ä¿è®¾å¤‡æ— æ³•é€šè¿‡é€‚å½“çš„æˆæƒè®¿é—®ç½‘ç»œã€‚é›¶ä¿¡ä»»ç³»ç»Ÿå¿…é¡»ç›‘æ§è¯•å›¾è®¿é—®ç½‘ç»œçš„è®¾å¤‡ï¼Œä»¥å°½é‡å‡å°‘å…¶æ”»å‡»é¢ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ¨ªå‘ç§»åŠ¨é¢„é˜²&#34;&gt;æ¨ªå‘ç§»åŠ¨é¢„é˜²&lt;/h3&gt;
&lt;p&gt;æ¨ªå‘ç§»åŠ¨æ˜¯æ”»å‡»è€…åœ¨ä¸åŒç½‘ç»œéƒ¨åˆ†ä¹‹é—´ç§»åŠ¨çš„èƒ½åŠ›ã€‚å³ä½¿åˆå§‹å…¥å£ç‚¹å·²çŸ¥ï¼Œåœ¨ç½‘ç»œä¸­æ£€æµ‹æ”»å‡»è€…ä¹Ÿæ˜¯ä¸€é¡¹æŒ‘æˆ˜ï¼Œå› ä¸ºä»–ä»¬å¯èƒ½å·²ç»ç§»åŠ¨åˆ°ç½‘ç»œçš„ä»»ä½•éƒ¨åˆ†ã€‚&lt;/p&gt;
&lt;p&gt;é›¶ä¿¡ä»»è§£å†³æ–¹æ¡ˆå¯¹ç½‘ç»œè¿›è¡Œåˆ†æ®µä»¥é™åˆ¶æ¨ªå‘ç§»åŠ¨å¹¶åŒ…å«æ¸—é€è€…ã€‚è¿™ç§æ–¹æ³•å¯ç¡®ä¿éš”ç¦»å—æ„ŸæŸ“çš„è´¦æˆ·æˆ–è®¾å¤‡å¹¶æ¶ˆé™¤å¨èƒã€‚&lt;/p&gt;
&lt;p&gt;æ‰§è¡Œåˆ†æ®µçš„å®é™…ç»„ä»¶å¯èƒ½æ˜¯ ZTNAã€ä¸é›¶ä¿¡ä»»ç­–ç•¥é›†æˆçš„ä¸‹ä¸€ä»£é˜²ç«å¢™ (NGFW)ï¼Œæˆ–äº‘å®‰å…¨è®¿é—®ä»£ç† (CASB)ï¼Œä¸€ç§é™„åŠ åˆ°äº‘èµ„æºçš„è¿·ä½ é˜²ç«å¢™ã€‚è¿™äº›å·¥å…·å¯ä»¥è·¨å¤šä¸ªç»´åº¦å¯¹ç½‘ç»œè¿›è¡Œåˆ†æ®µ â€”â€” ä¾‹å¦‚åº”ç”¨ç¨‹åºåˆ†æ®µã€ç¯å¢ƒåˆ†æ®µã€æµç¨‹åˆ†æ®µå’ŒåŸºäºç”¨æˆ·çš„åˆ†æ®µã€‚&lt;/p&gt;
&lt;h2 id=&#34;é›¶ä¿¡ä»»ç”¨ä¾‹å’Œå¥½å¤„&#34;&gt;é›¶ä¿¡ä»»ç”¨ä¾‹å’Œå¥½å¤„&lt;/h2&gt;
&lt;p&gt;é›¶ä¿¡ä»»å¤šå¹´æ¥ä¸€ç›´æ˜¯æ—¢å®šæ ‡å‡†ï¼Œä½†å®ƒç»§ç»­ç»å†æ­£å¼åŒ–è¿‡ç¨‹ï¼Œä»¥å¸®åŠ©ç»„ç»‡åº”å¯¹ä¸æ–­å˜åŒ–çš„å¨èƒå½¢åŠ¿ã€‚æ•°å­—åŒ–è½¬å‹çš„æ™®åŠå’Œå¤æ‚ç½‘ç»œå¨èƒçš„å¢é•¿ä¿ƒä½¿è®¸å¤šç»„ç»‡é‡‡ç”¨æˆ–æ”¹è¿›å…¶é›¶ä¿¡ä»»ç­–ç•¥ã€‚&lt;/p&gt;
&lt;p&gt;é›¶ä¿¡ä»»å®‰å…¨å¯¹æ‰€æœ‰ç»„ç»‡éƒ½æœ‰åˆ©ï¼Œå¯¹äºä½¿ç”¨æ··åˆæˆ–å¤šäº‘éƒ¨ç½²æ¨¡å‹ã€éæ‰˜ç®¡è®¾å¤‡ã€é—ç•™ç³»ç»Ÿæˆ–è½¯ä»¶å³æœåŠ¡ (SaaS) åº”ç”¨ç¨‹åºçš„ç»„ç»‡æ¥è¯´å°¤å…¶é‡è¦ã€‚åœ¨æ‰€æœ‰è¿™äº›æƒ…å†µä¸‹ï¼Œç»„ç»‡éƒ½æ‹¥æœ‰ä¸å—å…¶ç›´æ¥æ§åˆ¶çš„èµ„æºï¼Œæˆ–è€…å¯èƒ½ä¸ç»„ç»‡çš„å®‰å…¨ç­–ç•¥å’Œå®è·µä¸å…¼å®¹ â€”â€” é›¶ä¿¡ä»»æœ‰åŠ©äºåœ¨è¿™äº›ç³»ç»Ÿå‘¨å›´å»ºç«‹å®‰å…¨è¾¹ç•Œã€‚&lt;/p&gt;
&lt;p&gt;é›¶ä¿¡ä»»å¯¹äºåŠæ—¶æ£€æµ‹å’Œå“åº”å¸¸è§å¨èƒç”¨ä¾‹ä¹Ÿè‡³å…³é‡è¦ï¼Œä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å‹’ç´¢è½¯ä»¶æ”»å‡» â€”â€” æ‰§è¡Œæ¶æ„ä»£ç å¹¶å±åŠèº«ä»½ã€‚&lt;/li&gt;
&lt;li&gt;å†…éƒ¨å¨èƒ â€”â€” éšç€è¿œç¨‹è®¿é—®å’Œå¤–éƒ¨ç”¨æˆ·çš„å¢åŠ è€Œå¢åŠ çš„é£é™©ã€‚&lt;/li&gt;
&lt;li&gt;ä¾›åº”é“¾æ”»å‡» â€”â€” è¿œç¨‹ç‰¹æƒç”¨æˆ·å’Œéæ‰˜ç®¡ç«¯ç‚¹è®¾å¤‡å¸¦æ¥çš„é£é™©ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å®æ–½é›¶ä¿¡ä»»æœ‰åŠ©äºç»„ç»‡å¼¥è¡¥è¯¸å¦‚ SOCï¼ˆå®‰å…¨è¿è¥ä¸­å¿ƒï¼‰æˆ–å®‰å…¨åˆ†æå¸ˆæŠ€èƒ½çŸ­ç¼ºç­‰æŒ‘æˆ˜ã€‚é›¶ä¿¡ä»»æ”¯æŒè·¨æ··åˆç¯å¢ƒå¤§è§„æ¨¡è®¾ç½®å®‰å…¨ç­–ç•¥ï¼Œå¹¶ä½¿ç”¨è‡ªåŠ¨åŒ–æ¥æ£€æµ‹å’Œå“åº”å¨èƒã€‚è¿™æ¶ˆé™¤äº†æ‰‹åŠ¨å·¥ä½œå¹¶å‡å°‘äº†è¿‡åº¦ç´§å¼ çš„å®‰å…¨å›¢é˜Ÿçš„å·¥ä½œé‡ã€‚&lt;/p&gt;
&lt;p&gt;å®ƒæœ‰åŠ©äºæœ€å¤§é™åº¦åœ°å‡å°‘å®‰å…¨æœºåˆ¶å¯¹ç”¨æˆ·ä½“éªŒçš„å½±å“ï¼ŒåŒæ—¶å¼ºåˆ¶éµå®ˆæ³•è§„å’Œè¡Œä¸šæ ‡å‡†ã€‚é›¶ä¿¡ä»»çš„å¦ä¸€ä¸ªä¼˜åŠ¿æ˜¯åœ¨é¢å¯¹å¿«é€Ÿå˜åŒ–çš„å¨èƒå’Œä¿é™©æ”¿ç­–æ—¶åŠ å¼ºç»„ç»‡çš„ä¿é™©æˆ˜ç•¥ã€‚&lt;/p&gt;
&lt;p&gt;é‰´äºé«˜åº¦å¯å˜çš„ä¸šåŠ¡ã€å®‰å…¨å’Œæ•°å­—åŒ–æ¡ä»¶ï¼Œæ¯ä¸ªç»„ç»‡éƒ½é¢ä¸´ç€ç‹¬ç‰¹çš„æŒ‘æˆ˜ã€‚é›¶ä¿¡ä»»æ˜¯ä¸€ç§å¯è°ƒæ•´çš„ç­–ç•¥ï¼Œå¯ä»¥æ»¡è¶³ä¸åŒç»„ç»‡çš„ç‰¹å®šå®‰å…¨è¦æ±‚ã€‚&lt;/p&gt;
&lt;h2 id=&#34;é›¶ä¿¡ä»»å‚è€ƒæ¶æ„&#34;&gt;é›¶ä¿¡ä»»å‚è€ƒæ¶æ„&lt;/h2&gt;
&lt;p&gt;è¿‡æ¸¡åˆ°é›¶ä¿¡ä»»å¯èƒ½å¾ˆå¤æ‚ã€‚è°·æ­Œå’Œå¾®è½¯æ˜¯ä¸¤ä¸ªå·²ç»å¤§è§„æ¨¡å®æ–½é›¶ä¿¡ä»»çš„ç»„ç»‡ï¼Œå¹¶åˆ›å»ºäº†å‚è€ƒæ¶æ„æ¥å¸®åŠ©ä¸šå†…å…¶ä»–äººæ•ˆä»¿ã€‚&lt;/p&gt;
&lt;h3 id=&#34;beyondcorp&#34;&gt;BeyondCorp&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://cloud.google.com/beyondcorp&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;BeyondCorp&lt;/a&gt;æ˜¯ Google å®ç°çš„é›¶ä¿¡ä»»ã€‚å®ƒä»¥ Google çš„é•¿æœŸç»éªŒä¸ºåŸºç¡€ï¼Œç»“åˆäº†ç¤¾åŒºç†å¿µå’Œæœ€ä½³å®è·µã€‚BeyondCorp å°†è®¿é—®æ§åˆ¶å®‰å…¨å±‚ä»å•ä¸€çš„å¤–å›´è½¬ç§»åˆ°å•ä¸ªç½‘ç»œç”¨æˆ·ï¼Œå…è®¸è¿œç¨‹å·¥ä½œäººå‘˜ä»ä»»ä½•åœ°æ–¹å®‰å…¨åœ°è®¿é—®ç½‘ç»œï¼Œè€Œæ— éœ€ä¼ ç»Ÿçš„ VPNã€‚&lt;/p&gt;
&lt;p&gt;BeyondCorp æä¾›äº†ä¸€ç³»åˆ—æœ€ä½³å®è·µå’Œæ¦‚å¿µï¼Œå¯ä»¥å¸®åŠ©ä»»ä½•ç»„ç»‡å®æ–½é›¶ä¿¡ä»»ã€‚å®ƒä¹Ÿæ˜¯ä¸€ç§å•†ä¸šè§£å†³æ–¹æ¡ˆï¼Œå¯ç”¨äºåœ¨ç»„ç»‡ä¸­å®æ–½é›¶ä¿¡ä»»ã€‚å•†ä¸šè§£å†³æ–¹æ¡ˆè¢«ç§°ä¸º BeyondCorp Enterpriseï¼ˆå–ä»£ä»¥å‰çš„ç‰ˆæœ¬ BeyondCorp Remote Accessï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;BeyondCorp æ–°ç‰ˆæœ¬çš„ä¸€ä¸ªå…³é”®ç‰¹æ€§æ˜¯å®ƒä¸º Google Chrome æ·»åŠ äº†é›¶ä¿¡ä»»åŠŸèƒ½ã€‚é™¤äº†åœ¨æ‰˜ç®¡ç«¯ç‚¹è®¾å¤‡ä¸Šéƒ¨ç½²ä»£ç†ä¹‹å¤–ï¼Œç»„ç»‡è¿˜å¯ä»¥é€šè¿‡æµè§ˆå™¨æ‰©å±• BeyondCorp æ¶æ„ã€‚Chrome çš„æ›´æ–°åŒ…æ‹¬å¨èƒé˜²æŠ¤å’ŒåµŒå…¥å¼æ•°æ®åŠŸèƒ½ï¼Œæœ‰åŠ©äºé˜²æ­¢æ„å¤–æˆ–æ¶æ„æ•°æ®æ³„éœ²ã€æ¶æ„è½¯ä»¶æ„ŸæŸ“ä»¥åŠå…¶ä»–å½¢å¼çš„ç½‘ç»œå’Œè®¾å¤‡å…¥ä¾µã€‚&lt;/p&gt;
&lt;p&gt;BeyondCorp Enterprise è¿˜æä¾›è¿ç»­èº«ä»½éªŒè¯åŠŸèƒ½ï¼Œå®šæœŸå¯¹è®¾å¤‡ã€ç”¨æˆ·å’Œåº”ç”¨ç¨‹åºä¹‹é—´çš„æ‰€æœ‰äº¤äº’è¿›è¡Œèº«ä»½éªŒè¯ã€‚ç»„ç»‡å¯ä»¥åˆ›å»ºå’Œå®æ–½è®¿é—®æ§åˆ¶ç­–ç•¥ï¼Œä»¥æŒç»­éªŒè¯èº«ä»½éªŒè¯æ•°æ®ï¼ŒåŒ…æ‹¬ç”¨æˆ·èº«ä»½ã€è®¾å¤‡æ•°æ®å’Œ IP åœ°å€ï¼Œåœ¨è¿åç­–ç•¥çš„æƒ…å†µä¸‹ç«‹å³æ’¤é”€è®¿é—®æƒé™ã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸‰æ–¹å®‰å…¨æä¾›å•†å¯ä»¥åˆ©ç”¨ BeyondCorp è”ç›Ÿè®¡åˆ’ä¸ºè¿™ä¸ªæ–°å¹³å°å¼€å‘é›¶ä¿¡ä»»äº§å“ã€‚ä¾‹å¦‚ï¼Œ&lt;a href=&#34;https://www.tanium.com/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tanium&lt;/a&gt;ï¼ˆç«¯ç‚¹å®‰å…¨ä¾›åº”å•†ï¼‰æä¾›ä¸ BeyondCorp Enterprise çš„é›†æˆå¹³å°ï¼Œå…è®¸è¿™ä¸¤ç§äº§å“äº¤æ¢å®‰å…¨ä¿¡æ¯å¹¶æé«˜ç»„ç»‡å¯¹å…¶ç¯å¢ƒçš„å¯è§æ€§ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å¾®è½¯é›¶ä¿¡ä»»æ¨¡å‹&#34;&gt;å¾®è½¯é›¶ä¿¡ä»»æ¨¡å‹&lt;/h3&gt;
&lt;p&gt;å¾®è½¯å·²ç»å…¬å¸ƒäº†å…¶&lt;a href=&#34;https://www.microsoft.com/en-us/insidetrack/implementing-a-zero-trust-security-model-at-microsoft&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å†…éƒ¨é›¶ä¿¡ä»»å®æ–½&lt;/a&gt;çš„ç»†èŠ‚ã€‚è¿™ç§é›¶ä¿¡ä»»å®æ–½è§£å†³æ–¹æ¡ˆä¾§é‡äºä¼ä¸šèŒƒå›´çš„ä¼ä¸šæœåŠ¡ï¼Œä¾‹å¦‚ Microsoft Office å’Œä¸šåŠ¡çº¿ (LOB) åº”ç”¨ç¨‹åºã€‚&lt;/p&gt;
&lt;p&gt;å®ƒé€‚ç”¨äºåœ¨ Windowsã€Androidã€Mac æˆ– iPhone ä¸Šè¿è¡Œçš„è®¾å¤‡ã€‚äº‘ç§»åŠ¨è®¾å¤‡ç®¡ç†æœåŠ¡ Microsoft Intune ç®¡ç†è¿™äº›è®¾å¤‡ã€‚&lt;/p&gt;
&lt;p&gt;Microsoft é›¶ä¿¡ä»»æ¨¡å‹åŒ…æ‹¬å››ä¸ªé˜¶æ®µï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;èº«ä»½éªŒè¯&lt;/strong&gt;ï¼šMicrosoft é€šè¿‡è¦æ±‚å¯¹è¿œç¨‹è®¿é—®è¯·æ±‚è¿›è¡ŒåŒé‡èº«ä»½éªŒè¯æ¥ä¿æŠ¤ç½‘ç»œã€‚å†å²ä¸Šï¼Œèº«ä»½éªŒè¯æ–¹æ³•æ˜¯æ™ºèƒ½å¡ï¼Œä½†ä»Šå¤©å®ƒä½¿ç”¨ Azure Authenticator æ¥å¯ç”¨ç§»åŠ¨è®¾å¤‡è´¨è¯¢ã€‚å¾®è½¯æœªæ¥çš„ç›®æ ‡åŒ…æ‹¬æ¶ˆé™¤å¯†ç ä»¥æ”¯æŒå®Œå…¨ç”Ÿç‰©è¯†åˆ«èº«ä»½éªŒè¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è®¾å¤‡å¥åº·éªŒè¯&lt;/strong&gt;ï¼šMicrosoft ä½¿ç”¨ Intune æ³¨å†Œæ–°çš„ç”¨æˆ·è®¾å¤‡ã€‚è®¾å¤‡è¿è¡ŒçŠ¶å†µç­–ç•¥æŒ‡å®šåœ¨è®¿é—®ä¸»è¦ç”Ÿäº§åŠ›åº”ç”¨ç¨‹åºï¼ˆä¾‹å¦‚ SharePointã€Exchange å’Œ Teamsï¼‰ä¹‹å‰å“ªäº›è®¾å¤‡è¿è¡ŒçŠ¶å†µè‰¯å¥½æˆ–éœ€è¦ç®¡ç†ï¼ˆæµ‹è¯•å’Œä¿®è¡¥æ¼æ´ï¼‰ã€‚å¯¹äºæŸäº›ç”¨ä¾‹ï¼ŒMicrosoft é€šè¿‡è™šæ‹ŸåŒ– Windows åº”ç”¨ç¨‹åºå’Œæ¡Œé¢æ”¯æŒéæ‰˜ç®¡è®¾å¤‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è®¿é—®éªŒè¯&lt;/strong&gt;ï¼šä»»ä½•å¯¹ Microsoft æœåŠ¡çš„è®¿é—®å°è¯•éƒ½å¿…é¡»æ ¹æ®èº«ä»½ã€è®¾å¤‡è¿è¡ŒçŠ¶å†µã€æ•´ä½“å®‰å…¨ä¸Šä¸‹æ–‡ï¼ˆä¾‹å¦‚ä¸€å¤©ä¸­çš„æ—¶é—´å’Œç”¨æˆ·çš„ä½ç½®ï¼‰ä»¥åŠæ¥è‡ª Microsoft Intelligence Security Graph çš„å…¶ä»–æ•°æ®è¿›è¡ŒéªŒè¯ã€‚è¿™é‡Œçš„åˆ›æ–°å…ƒç´ æ˜¯ï¼Œæ— è®ºç”¨æˆ·å¦‚ä½•è¿æ¥ â€”â€” æ— è®ºä»–ä»¬æ˜¯ç›´æ¥è®¿é—®å…¬å¸ç½‘ç»œã€é€šè¿‡ VPN è®¿é—®è¿˜æ˜¯é€šè¿‡ Internet è¿æ¥åˆ°èµ„æºï¼Œå¾®è½¯éƒ½å¯ä»¥åº”ç”¨è®¿é—®éªŒè¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æœåŠ¡éªŒè¯&lt;/strong&gt;ï¼šå¾®è½¯æå‡ºäº†ä¸€ç§æœªæ¥çš„æœºåˆ¶æ¥éªŒè¯æœåŠ¡ï¼Œä»¥ç¡®ä¿å®ƒä»¬åœ¨å…è®¸ç”¨æˆ·ä¸ä¹‹äº¤äº’ä¹‹å‰æ˜¯å¥åº·çš„ã€‚è¯¥åŠŸèƒ½ç›®å‰å¤„äºè§„åˆ’é˜¶æ®µã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;å¼€å‘äººå‘˜çš„é›¶ä¿¡ä»»æ³¨æ„äº‹é¡¹&#34;&gt;å¼€å‘äººå‘˜çš„é›¶ä¿¡ä»»æ³¨æ„äº‹é¡¹&lt;/h2&gt;
&lt;p&gt;é›¶ä¿¡ä»»å°†å®‰å…¨è´£ä»»ä»ç½‘ç»œè¾¹ç•Œè½¬ç§»åˆ°åº”ç”¨ç¨‹åºã€‚åº”ç”¨ç¨‹åºæœ¬èº«èƒ½å¤ŸéªŒè¯ç»†ç²’åº¦çš„ç­–ç•¥ï¼Œå¹¶ç¡®ä¿æ¯ä¸ªç”¨æˆ·éƒ½èƒ½å‡†ç¡®åœ°è®¿é—®ä»–ä»¬è¢«å…è®¸è®¿é—®çš„åŠŸèƒ½å’Œæ•°æ®ï¼Œè€Œä¸ä¼šè¶…å‡ºç•Œé™ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨é›¶ä¿¡ä»»ç¯å¢ƒä¸­ï¼Œå¼€å‘äººå‘˜ä¸èƒ½ä»…ä¾èµ–ç®€å•çš„ API ä»¤ç‰Œè¿›è¡Œèº«ä»½éªŒè¯å’Œæˆæƒã€‚ä»–ä»¬å¿…é¡»å…¨é¢äº†è§£å¦‚ä½•ä¿æŠ¤è¯·æ±‚è€…ä¸åº”ç”¨ç¨‹åºäº¤äº’çš„æ¯ä¸€æ­¥ï¼ŒåŒæ—¶è€ƒè™‘åˆ°å½“å‰çš„å®‰å…¨ä¸Šä¸‹æ–‡ã€‚&lt;/p&gt;
&lt;h3 id=&#34;é›¶ä¿¡ä»»ç¯å¢ƒä¸‹çš„åº”ç”¨éœ€æ±‚&#34;&gt;é›¶ä¿¡ä»»ç¯å¢ƒä¸‹çš„åº”ç”¨éœ€æ±‚&lt;/h3&gt;
&lt;p&gt;åœ¨é›¶ä¿¡ä»»å®‰å…¨æ¨¡å‹ä¸­å¼€å‘åº”ç”¨ç¨‹åºæ—¶ï¼Œå¼€å‘äººå‘˜éœ€è¦ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è¯„ä¼°ä¼šè¯çš„å®Œæ•´ä¸Šä¸‹æ–‡ä»¥ç¡®å®šæ€»ä½“é£é™©ã€‚&lt;/li&gt;
&lt;li&gt;ç¡®å®šé›¶ä¿¡ä»»éªŒè¯çš„å…³é”®å› ç´  â€”â€” ç”¨æˆ·èº«ä»½ã€å‘å‡ºè¯·æ±‚çš„è®¾å¤‡çŠ¶æ€ã€æ­£åœ¨ä½¿ç”¨çš„åº”ç”¨ç¨‹åºåŠŸèƒ½ä»¥åŠè¯·æ±‚è¯•å›¾è®¿é—®çš„æ•°æ®ã€‚&lt;/li&gt;
&lt;li&gt;ç¡®ä¿æ¯ä¸ªè¯·æ±‚ï¼Œå³ä½¿å®ƒæ¥è‡ªç½‘ç»œè¾¹ç•Œå†…ï¼Œéƒ½ç»è¿‡æ‰¹å‡†çš„å®‰å…¨ç­–ç•¥æ¥å…è®¸ã€é˜»æ­¢æˆ–é™åˆ¶å®ƒã€‚&lt;/li&gt;
&lt;li&gt;åº”ç”¨é¢å¤–çš„å®‰å…¨æªæ–½ï¼Œä¾‹å¦‚å¤šå› ç´ èº«ä»½éªŒè¯ã€åŠŸèƒ½é™åˆ¶å’Œåˆè§„æ§åˆ¶çš„å®æ–½ã€‚&lt;/li&gt;
&lt;li&gt;ç¡®ä¿åœ¨åº”ç”¨ç¨‹åºç”Ÿå‘½å‘¨æœŸçš„æ‰€æœ‰é˜¶æ®µï¼Œä»…åœ¨å…è®¸åˆ—è¡¨çš„åŸºç¡€ä¸Šæˆäºˆè®¿é—®æƒé™ï¼Œæ¢å¥è¯è¯´ï¼Œåªæœ‰åœ¨æ˜ç¡®å…è®¸æ—¶æ‰æˆäºˆè®¿é—®æƒé™ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç¬¬ä¸€æ­¥åˆ°ç¬¬ä¸‰æ­¥é€šå¸¸é€šè¿‡ API å¤„ç†åˆ°ä¸“ç”¨ ZTNA å·¥å…·ï¼Œä¾‹å¦‚ Perimeter81 æˆ– CrowdStrike Zero Trustã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬å››æ­¥é€šå¸¸ç”± Auth0 æˆ– Okta ç­‰èº«ä»½éªŒè¯è§£å†³æ–¹æ¡ˆå¤„ç†ã€‚åœ¨å¤§å‹ç»„ç»‡ä¸­ï¼Œè¿™äº›ç”± Azure Active Directory ç­‰ä¼ä¸šæ ‡è¯†æœåŠ¡è¡¥å……æˆ–å–ä»£ã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬äº”æ­¥åœ¨åº”ç”¨å±‚å®ç° â€”â€” è¿™æ˜¯åº”ç”¨å¼€å‘è€…å¯¹é›¶ä¿¡ä»»çš„ä¸»è¦è´¡çŒ®ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æŒç»­æµ‹è¯•é›¶ä¿¡ä»»è¦æ±‚&#34;&gt;æŒç»­æµ‹è¯•é›¶ä¿¡ä»»è¦æ±‚&lt;/h3&gt;
&lt;p&gt;ä»…å®æ–½ä¸Šè¿°æªæ–½æ˜¯ä¸å¤Ÿçš„ã€‚è¿˜éœ€è¦æµ‹è¯•å’ŒéªŒè¯åº”ç”¨ç¨‹åºæ˜¯å¦æ­£ç¡®å®ç°äº†èº«ä»½éªŒè¯ã€æˆæƒå’Œæ•°æ®çš„å¼ºåŠ å¯†ã€‚è¿™éœ€è¦ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åœ¨å¼€å‘çš„æ—©æœŸé˜¶æ®µå¯¹ä»£ç è¿è¡Œé™æ€åˆ†æï¼Œä»¥ç¡®ä¿æ¯ä¸ªç”¨æˆ·äº¤äº’éƒ½å¯¹é›¶ä¿¡ä»»å’Œèº«ä»½éªŒè¯ / æˆæƒç»„ä»¶è¿›è¡Œé€‚å½“çš„è°ƒç”¨ã€‚&lt;/li&gt;
&lt;li&gt;å¯¹æµ‹è¯•ã€UAT å’Œç”Ÿäº§ç¯å¢ƒä¸­çš„åº”ç”¨ç¨‹åºè¿è¡ŒåŠ¨æ€åˆ†æï¼Œå¹¶æµ‹è¯•ç”¨æˆ·è¯·æ±‚æ˜¯å¦æ”¶åˆ°é€‚å½“çš„å®‰å…¨æªæ–½ã€‚&lt;/li&gt;
&lt;li&gt;æ‰§è¡Œæ¨¡ç³Šæµ‹è¯•å’Œæ¸—é€æµ‹è¯•ä»¥å‘ç°å¹¶æ¶ˆé™¤åœ¨å¼€å‘ç”Ÿå‘½å‘¨æœŸä¸­å¼•å…¥çš„æ¼æ´ï¼Œä¾‹å¦‚ç¼ºå°‘èº«ä»½éªŒè¯æˆ–å®‰å…¨ç­–ç•¥åº”ç”¨ä¸æ­£ç¡®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;ç®¡ç†ç¬¬ä¸‰æ–¹é£é™©&#34;&gt;ç®¡ç†ç¬¬ä¸‰æ–¹é£é™©&lt;/h3&gt;
&lt;p&gt;é›¶ä¿¡ä»»æ¡†æ¶è¿˜éœ€è¦éªŒè¯ç¬¬ä¸‰æ–¹åˆ›å»ºçš„å¼€æºå’Œä¸“æœ‰ç»„ä»¶çš„å®‰å…¨æ€§ã€‚å¯¹äºå¼€å‘äººå‘˜æ¥è¯´ï¼Œäº†è§£ä»–ä»¬çš„é¡¹ç›®ä¸­ä½¿ç”¨äº†å“ªäº›ç»„ä»¶ã€å®ƒä»¬å­˜åœ¨å“ªäº›é£é™©å’Œæ¼æ´ä»¥åŠå¦‚ä½•åº”ç”¨æ›´æ–°å’Œä¿®å¤éå¸¸é‡è¦ã€‚&lt;/p&gt;
&lt;p&gt;è½¯ä»¶ç»„åˆåˆ†æ (SCA) è§£å†³æ–¹æ¡ˆå¯ä»¥å¸®åŠ©æä¾›å¯¹è½¯ä»¶é¡¹ç›®ä¸­ä½¿ç”¨çš„å¼€æºç»„ä»¶çš„å¯è§æ€§ï¼ŒåŒ…æ‹¬æ•°ä»¥åƒè®¡çš„ä¼ é€’ä¾èµ–é¡¹ã€‚å¯¹äºæ¯ä¸ªå¼€æºåº“ï¼Œè¿™äº›å·¥å…·å¯ä»¥è¯†åˆ«å®‰å…¨å¼±ç‚¹ï¼ŒæŒ‡å‡ºä»£ç è´¨é‡é—®é¢˜ï¼Œè¿˜å¯ä»¥æé†’ç»„ç»‡æ³¨æ„å¯èƒ½é€ æˆæ³•å¾‹é£é™©çš„é™åˆ¶æ€§å¼€æºè®¸å¯è¯ã€‚&lt;a href=&#34;https://www.mend.io/resources/blog/software-composition-analysis/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;åœ¨æ­¤è¯¦ç»†çš„è½¯ä»¶ç»„åˆåˆ†æ&lt;/a&gt;æŒ‡å—ä¸­äº†è§£æ›´å¤šä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸‰æ–¹ç»„ä»¶ä¸æ˜¯å”¯ä¸€çš„é£é™©æ¥æºã€‚å¼€å‘å›¢é˜Ÿå¿…é¡»ç›‘æ§æ•´ä¸ªè½¯ä»¶ä¾›åº”é“¾ï¼ŒåŒ…æ‹¬å¼€å‘ç¯å¢ƒã€æŒç»­é›†æˆ (CI) ç³»ç»Ÿã€éƒ¨ç½²ç³»ç»Ÿå’Œæš‚å­˜ç¯å¢ƒã€å®¹å™¨å­˜å‚¨åº“ä»¥åŠå°†ä»£ç ä»å¼€å‘é˜¶æ®µè½¬ç§»åˆ°ç”Ÿäº§ç¯å¢ƒæ‰€æ¶‰åŠçš„ä»»ä½•å…¶ä»–å…ƒç´ ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å®‰å…¨å‰ç½®&#34;&gt;å®‰å…¨å‰ç½®&lt;/h3&gt;
&lt;p&gt;å¼€å‘äººå‘˜å¿…é¡»ä»ä¸€å¼€å§‹å°±å°†å®‰å…¨æ€§çº³å…¥ä»–ä»¬çš„è®¾è®¡å’Œä»£ç åº“ã€‚è¿™æ˜¯ä»éšå¼ä¿¡ä»»è½¬å‘æ˜¾å¼èº«ä»½éªŒè¯ã€å¼ºèº«ä»½å’Œè®¿é—®æ§åˆ¶çš„æœ€ä½³æ–¹å¼ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆè½¬å‘ DevSecOpsï¼ˆå¼€å‘äººå‘˜ã€å®‰å…¨å›¢é˜Ÿå’Œè¿ç»´éƒ¨é—¨ä¹‹é—´çš„å¯†åˆ‡åˆä½œï¼‰å¼ºçƒˆæ”¯æŒé›¶ä¿¡ä»»é‡‡ç”¨çš„åŸå› ã€‚&lt;/p&gt;
&lt;p&gt;DevSecOps å›¢é˜Ÿå¯ä»¥åœ¨è½¯ä»¶äº¤ä»˜ç”Ÿå‘½å‘¨æœŸçš„æ‰€æœ‰é˜¶æ®µå®æ–½é›¶ä¿¡ä»»è¦æ±‚ã€‚å³ä½¿å¤–å›´æ§åˆ¶å¤±è´¥ï¼Œæ„å»ºåœ¨é›¶ä¿¡ä»»æ¡†æ¶ä¸­çš„åº”ç”¨ç¨‹åºä¹Ÿå¯ä»¥ä¿æŠ¤æ•æ„Ÿæ•°æ®å’ŒåŠŸèƒ½ã€‚ä¾‹å¦‚ï¼Œå³ä½¿é˜²ç«å¢™ã€å…¥ä¾µé˜²å¾¡ç³»ç»Ÿ (IPS) å’Œæ•°æ®ä¸¢å¤±é˜²æŠ¤ (DLP) å·¥å…·é…ç½®é”™è¯¯ã€å‡ºç°æ•…éšœæˆ–è¢«æ”»å‡»è€…ç ´åï¼Œåº”ç”¨ç¨‹åºä¹Ÿä¼šå°½æœ€å¤§åŠªåŠ›ä¿æŠ¤å…¶èµ„äº§ã€‚&lt;/p&gt;
&lt;p&gt;è¯·è®°ä½ï¼Œé›¶ä¿¡ä»»æ¡†æ¶å¹¶æ²¡æœ‰æ¶ˆé™¤åœ¨æ¯æ¬¡éƒ¨ç½²åæŒç»­æ‰«ææ¼æ´çš„éœ€è¦ï¼Œä»¥ç¡®ä¿åº”ç”¨ç¨‹åºå’Œåç«¯ç³»ç»Ÿå¾—åˆ°é€‚å½“çš„ä¿æŠ¤å’Œæ­£å¸¸è¿è¡Œã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç»“è®º&#34;&gt;ç»“è®º&lt;/h2&gt;
&lt;p&gt;ä»Šå¤©çš„å¼€å‘äººå‘˜ä¸ä»…ä»…æ˜¯å¼€å‘äººå‘˜ â€”â€” ä»–ä»¬ä¹Ÿåº”è¯¥æ˜¯å®‰å…¨ä¸“å®¶ã€‚ç»„ç»‡æ„è¯†åˆ°æœ€èƒ½é˜²æ­¢ä¸‹ä¸€æ¬¡å®‰å…¨æ¼æ´çš„äººæ˜¯å…·æœ‰å®‰å…¨æ„è¯†çš„å¼€å‘äººå‘˜ï¼Œä»è½¯ä»¶é¡¹ç›®çš„ç¬¬ä¸€å¤©å¼€å§‹å°±å®æ–½å®‰å…¨ç¼–ç å®è·µã€‚è¿™æ˜¯ä¸€é¡¹é‡å¤§è´£ä»»ï¼Œä½†å¯¹å¼€å‘äººå‘˜æ¥è¯´ä¹Ÿæ˜¯ä¸€ä¸ªé‡å¤§æœºé‡ï¼Œä»–ä»¬å¯ä»¥åœ¨ä¸ºå®¢æˆ·æä¾›ä»·å€¼æ–¹é¢å‘æŒ¥æ›´æ ¸å¿ƒçš„ä½œç”¨ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¸®åŠ©å¼€å‘äººå‘˜å¼€å‘å®‰å…¨æ™ºèƒ½å¹¶æˆ´ä¸Šä»–ä»¬çš„ â€œé›¶ä¿¡ä»»çœ¼é•œâ€â€”â€” é€šè¿‡é›¶ä¿¡ä»»æ¨¡å‹çš„è§†è§’æ¥çœ‹å¾…ä»£ç å’Œè½¯ä»¶æ¶æ„ã€‚è¿™å°†å¸®åŠ©ä»–ä»¬ä¸ä»…å¼€å‘æ›´å®‰å…¨çš„åº”ç”¨ç¨‹åºï¼Œè€Œä¸”æé«˜ä»–ä»¬ â€œè¯´è¯â€ çš„èƒ½åŠ› â€”â€” åœ¨ç°ä»£å®‰å…¨ç¯å¢ƒä¸­è¿›è¡Œæœ‰æ•ˆæ²Ÿé€šå¹¶ç†è§£ç›®æ ‡å’Œç­–ç•¥ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>ä½¿ç”¨ eBPF å‡†ç¡®å®šä½æœåŠ¡ç½‘æ ¼çš„å…³é”®æ€§èƒ½é—®é¢˜</title>
      <link>https://lib.jimmysong.io/blog/pinpoint-service-mesh-critical-performance-impact-by-using-ebpf/</link>
      <pubDate>Tue, 05 Jul 2022 17:00:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/pinpoint-service-mesh-critical-performance-impact-by-using-ebpf/</guid>
      <description>&lt;h2 id=&#34;background&#34;&gt;èƒŒæ™¯ä»‹ç»&lt;/h2&gt;
&lt;p&gt;Apache SkyWalking è§‚å¯Ÿéƒ¨ç½²åœ¨æœåŠ¡ç½‘æ ¼ä¸­çš„æœåŠ¡çš„åº¦é‡ã€æ—¥å¿—ã€è¿½è¸ªå’Œäº‹ä»¶ã€‚åœ¨è¿›è¡Œæ•…éšœæ’é™¤æ—¶ï¼ŒSkyWalking é”™è¯¯åˆ†ææ˜¯ä¸€ä¸ªå®è´µçš„å·¥å…·ï¼Œå¯ä»¥å¸®åŠ©ç¡®å®šé”™è¯¯å‘ç”Ÿçš„ä½ç½®ã€‚ç„¶è€Œï¼Œç¡®å®šæ€§èƒ½é—®é¢˜æ›´åŠ å›°éš¾ï¼šåˆ©ç”¨é¢„å…ˆå­˜åœ¨çš„è§‚å¯Ÿæ•°æ®å¾€å¾€ä¸å¯èƒ½æ‰¾åˆ°æ€§èƒ½é—®é¢˜çš„æ ¹æœ¬åŸå› ã€‚ä¸ºæ­¤ï¼ŒåŠ¨æ€è°ƒè¯•å’Œæ•…éšœæ’é™¤åœ¨è¿›è¡ŒæœåŠ¡æ€§èƒ½å‰–ææ—¶å°±å¿…ä¸å¯å°‘ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºå¦‚ä½•ä½¿ç”¨ eBPF æŠ€æœ¯æ¥æ”¹è¿› SkyWalking ä¸­çš„å‰–æåŠŸèƒ½ï¼Œå¹¶ç”¨äºåˆ†ææœåŠ¡ç½‘æ ¼ä¸­çš„æ€§èƒ½å½±å“ã€‚&lt;/p&gt;
&lt;h2 id=&#34;trace-profiling-in-skywalking&#34;&gt;SkyWalking ä¸­çš„è¿½è¸ªå‰–æ&lt;/h2&gt;
&lt;p&gt;è‡ª SkyWalking 7.0.0 ä»¥æ¥ï¼ŒTrace Profiling é€šè¿‡å®šæœŸå¯¹çº¿ç¨‹å †æ ˆè¿›è¡Œé‡‡æ ·ï¼Œè®©å¼€å‘è€…çŸ¥é“è¿è¡Œå“ªè¡Œä»£ç èŠ±è´¹æ›´å¤šæ—¶é—´ï¼Œä»è€Œå¸®åŠ©å¼€å‘è€…å‘ç°æ€§èƒ½é—®é¢˜ã€‚ç„¶è€Œï¼ŒTrace Profiling ä¸é€‚åˆä»¥ä¸‹æƒ…å†µï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;çº¿ç¨‹æ¨¡å‹&lt;/strong&gt;ï¼šTrace Profiling å¯¹äºå‰–æåœ¨å•çº¿ç¨‹ä¸­æ‰§è¡Œçš„ä»£ç æœ€æœ‰ç”¨ã€‚å®ƒå¯¹ä¸¥é‡ä¾èµ–å¼‚æ­¥æ‰§è¡Œæ¨¡å¼çš„ä¸­é—´ä»¶ä¸å¤ªæœ‰ç”¨ã€‚ä¾‹å¦‚ï¼ŒGo ä¸­çš„ Goroutines æˆ– Kotlin Coroutinesã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¯­è¨€&lt;/strong&gt;ï¼šç›®å‰ï¼ŒTrace Profiling åªæ”¯æŒ Java å’Œ Pythonï¼Œå› ä¸ºåœ¨ Go å’Œ Node.js ç­‰ä¸€äº›è¯­è¨€çš„è¿è¡Œæ—¶ä¸­ä¸å®¹æ˜“è·å¾—çº¿ç¨‹æ ˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Agent ç»‘å®š&lt;/strong&gt;ï¼šTrace Profiling éœ€è¦å®‰è£… Agentï¼Œæ ¹æ®è¯­è¨€çš„ä¸åŒï¼Œè¿™å¯èƒ½å¾ˆéº»çƒ¦ï¼ˆä¾‹å¦‚ï¼ŒPHP å¿…é¡»ä¾èµ–å…¶ C å†…æ ¸ï¼›Rust å’Œ C/C++ éœ€è¦çš„ä»ªå™¨éœ€è¦æ‰‹åŠ¨å®‰è£…ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å…³è”æ€§&lt;/strong&gt;ï¼šç”±äºè¿½è¸ªå‰–æåªä¸å•ä¸ªè¯·æ±‚ç›¸å…³ï¼Œæ‰€ä»¥å½“æ— æ³•ç¡®è®¤å“ªä¸ªè¯·æ±‚äº§ç”Ÿé—®é¢˜æ—¶åˆ™å˜å¾—éš¾å·²å¤„ç†ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç”Ÿå‘½å‘¨æœŸçŸ­çš„æœåŠ¡&lt;/strong&gt;ï¼šç”±äºï¼ˆè‡³å°‘ï¼‰ä¸¤ä¸ªåŸå› ï¼ŒTrace Profiling ä¸æ”¯æŒçŸ­å£°æ˜å‘¨æœŸçš„æœåŠ¡ï¼š
&lt;ul&gt;
&lt;li&gt;åœ¨å¯åŠ¨é˜¶æ®µï¼Œå¾ˆéš¾åŒºåˆ†ç³»ç»Ÿæ€§èƒ½å’Œç±»ä»£ç æ“ä½œã€‚&lt;/li&gt;
&lt;li&gt;Trace Profiling ä¸ä¸€ä¸ªç«¯ç‚¹ç›¸è¿ï¼Œä»¥è¯†åˆ«æ€§èƒ½å½±å“ï¼Œä½†æ²¡æœ‰ç«¯ç‚¹æ¥åŒ¹é…è¿™äº›çŸ­ç”Ÿå‘½å‘¨æœŸçš„æœåŠ¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¹¸è¿çš„æ˜¯ï¼Œæœ‰ä¸€äº›æŠ€æœ¯æ¯” Trace Profiling æ›´å®ç”¨ã€‚&lt;/p&gt;
&lt;h2 id=&#34;introduce-ebpf&#34;&gt;eBPF ç®€ä»‹&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬å‘ç°ï¼ŒeBPF â€”â€” ä¸€ç§å¯ä»¥åœ¨æ“ä½œç³»ç»Ÿå†…æ ¸ä¸­è¿è¡Œæ²™ç›’ç¨‹åºçš„æŠ€æœ¯ï¼Œä»è€Œå®‰å…¨æœ‰æ•ˆåœ°æ‰©å±•å†…æ ¸çš„åŠŸèƒ½ï¼Œè€Œä¸éœ€è¦ä¿®æ”¹å†…æ ¸æˆ–åŠ è½½å†…æ ¸æ¨¡å—ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬å¡«è¡¥ Trace Profiling ç•™ä¸‹çš„ç©ºç™½ã€‚eBPF æŠ€æœ¯æ­£åœ¨æµè¡Œï¼Œå› ä¸ºå®ƒæ‰“ç ´äº†ä¼ ç»Ÿä¸Šçš„ç”¨æˆ·å’Œå†…æ ¸ç©ºé—´ä¹‹é—´çš„éšœç¢ã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥å°†ç¨‹åºä½œä¸ºå­—èŠ‚ç æ³¨å…¥åˆ°å†…æ ¸ä¸­è¿è¡Œï¼Œè€Œä¸éœ€è¦å®šåˆ¶å’Œé‡æ–°ç¼–è¯‘å†…æ ¸ã€‚å¯è§‚æµ‹å¯ä»¥å¾ˆå¥½åœ°åˆ©ç”¨è¿™ä¸€ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ä¸‹å›¾ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå½“ç³»ç»Ÿæ‰§è¡Œ &lt;code&gt;execve&lt;/code&gt; ç³»ç»Ÿè°ƒç”¨æ—¶ï¼ŒeBPF ç¨‹åºè¢«è§¦å‘ï¼Œé€šè¿‡ä½¿ç”¨å‡½æ•°è°ƒç”¨è·å¾—å½“å‰è¿›ç¨‹çš„è¿è¡Œæ—¶ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-ebpf-ç¨‹åºè°ƒç”¨æµç¨‹å›¾&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;eBPF ç¨‹åºè°ƒç”¨æµç¨‹å›¾&#34; srcset=&#34;
               /blog/pinpoint-service-mesh-critical-performance-impact-by-using-ebpf/eBPF-hook-points_hu045d3eb9c20514286c2b99759556b302_48258_31dd29f7e8dc45b4aa8c3e9978c15fd3.webp 400w,
               /blog/pinpoint-service-mesh-critical-performance-impact-by-using-ebpf/eBPF-hook-points_hu045d3eb9c20514286c2b99759556b302_48258_501ba58999de3fea0b73da4d1a5134c6.webp 760w,
               /blog/pinpoint-service-mesh-critical-performance-impact-by-using-ebpf/eBPF-hook-points_hu045d3eb9c20514286c2b99759556b302_48258_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/pinpoint-service-mesh-critical-performance-impact-by-using-ebpf/eBPF-hook-points_hu045d3eb9c20514286c2b99759556b302_48258_31dd29f7e8dc45b4aa8c3e9978c15fd3.webp&#34;
               width=&#34;760&#34;
               height=&#34;578&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      eBPF ç¨‹åºè°ƒç”¨æµç¨‹å›¾
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ eBPF æŠ€æœ¯ï¼Œå¯ä»¥å°† SkyWalking çš„å‰–æèƒ½åŠ›èŒƒå›´æ‰©å¤§åˆ°ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å…¨å±€æ€§èƒ½å‰–æ&lt;/strong&gt;ï¼šåœ¨ eBPF ä¹‹å‰ï¼Œæ•°æ®æ”¶é›†è¢«é™åˆ¶åœ¨ä»£ç†å¯ä»¥è§‚å¯Ÿçš„èŒƒå›´å†…ã€‚ç”±äº eBPF ç¨‹åºåœ¨å†…æ ¸ä¸­è¿è¡Œï¼Œå®ƒä»¬å¯ä»¥è§‚å¯Ÿåˆ°æ‰€æœ‰çš„çº¿ç¨‹ã€‚å½“ä½ ä¸ç¡®å®šæŸä¸ªæ€§èƒ½é—®é¢˜æ˜¯å¦æ˜¯ç”±ä¸€ä¸ªç‰¹å®šçš„è¯·æ±‚å¼•èµ·çš„ï¼Œè¿™ä¸€ç‚¹ç‰¹åˆ«æœ‰ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®å†…å®¹&lt;/strong&gt;ï¼šeBPF å¯ä»¥è½¬å‚¨ç”¨æˆ·å’Œå†…æ ¸ç©ºé—´çš„çº¿ç¨‹æ ˆï¼Œæ‰€ä»¥å¦‚æœæ€§èƒ½é—®é¢˜å‘ç”Ÿåœ¨å†…æ ¸ç©ºé—´å°±æ›´å®¹æ˜“è¢«å‘ç°ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä»£ç†ç»‘å®š&lt;/strong&gt;ï¼šæ‰€æœ‰ç°ä»£ Linux å†…æ ¸éƒ½æ”¯æŒ eBPFï¼Œæ‰€ä»¥ä¸éœ€è¦å®‰è£…ä»»ä½•ä¸œè¥¿ã€‚è¿™æ„å‘³ç€å®ƒæ˜¯ä¸€ä¸ªå…ç¼–æ’ä¸ä»£ç†çš„æ¨¡å‹ã€‚è¿™å‡å°‘äº†ç”±å†…ç½®è½¯ä»¶å¼•èµ·çš„æ‘©æ“¦ï¼Œè¿™äº›è½¯ä»¶å¯èƒ½æ²¡æœ‰å®‰è£…æ­£ç¡®çš„ä»£ç†ï¼Œå¦‚æœåŠ¡ç½‘æ ¼ä¸­çš„ Envoyã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é‡‡æ ·ç±»å‹&lt;/strong&gt;ï¼šä¸è¿½è¸ªå‰–æä¸åŒï¼ŒeBPF æ˜¯äº‹ä»¶é©±åŠ¨çš„ï¼Œå› æ­¤ï¼Œä¸å—é—´éš”è½®è¯¢çš„é™åˆ¶ã€‚ä¾‹å¦‚ï¼ŒeBPF å¯ä»¥è§¦å‘äº‹ä»¶ï¼Œå¹¶æ ¹æ®ä¼ è¾“å¤§å°çš„é˜ˆå€¼æ”¶é›†æ›´å¤šçš„æ•°æ®ã€‚è¿™å¯ä»¥è®©ç³»ç»Ÿåœ¨æç«¯è´Ÿè½½ä¸‹åˆ†æµå’Œä¼˜å…ˆæ”¶é›†æ•°æ®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;ebpf-limitations&#34;&gt;eBPF çš„å±€é™æ€§&lt;/h3&gt;
&lt;p&gt;è™½ç„¶ eBPF ä¸ºå‘æ˜æ€§èƒ½ç“¶é¢ˆæä¾›äº†æ˜¾è‘—çš„ä¼˜åŠ¿ï¼Œä½†æ²¡æœ‰ä»»ä½•æŠ€æœ¯æ˜¯å®Œç¾çš„ã€‚eBPF æœ‰ä¸€äº›é™åˆ¶ï¼Œå¦‚ä¸‹æ‰€è¿°ï¼ˆå¹¸è¿çš„æ˜¯ï¼Œç”±äº SkyWalking ä¸ä¾èµ– eBPFï¼Œå…¶å½±å“æ˜¯æœ‰é™çš„ï¼‰ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Linux ç‰ˆæœ¬è¦æ±‚&lt;/strong&gt;ï¼šeBPF ç¨‹åºéœ€è¦çš„ Linux å†…æ ¸ç‰ˆæœ¬è¦ 4.4 ä»¥ä¸Šï¼Œæ›´æ–°çš„å†…æ ¸ç‰ˆæœ¬å¯ä»¥æä¾›æ›´å¤šçš„æ•°æ®æ”¶é›†ã€‚BCC è®°å½•äº† &lt;a href=&#34;https://github.com/iovisor/bcc/blob/13b5563c11f7722a61a17c6ca0a1a387d2fa7788/docs/kernel-versions.md#main-features&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä¸åŒ Linux å†…æ ¸ç‰ˆæœ¬æ‰€æ”¯æŒçš„åŠŸèƒ½&lt;/a&gt;ï¼Œä¸åŒç‰ˆæœ¬ä¹‹é—´çš„å·®å¼‚åœ¨äº eBPF æ”¶é›†çš„æ•°æ®é›†ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;éœ€è¦ç‰¹æƒæƒé™&lt;/strong&gt;ï¼šæ‰€æœ‰æ‰“ç®—å°† eBPF ç¨‹åºåŠ è½½åˆ° Linux å†…æ ¸çš„è¿›ç¨‹å¿…é¡»åœ¨ç‰¹æƒæ¨¡å¼ä¸‹è¿è¡Œã€‚å› æ­¤ï¼Œä»£ç ä¸­çš„é”™è¯¯æˆ–å…¶ä»–é—®é¢˜å¯èƒ½å¯¹å®‰å…¨æœ‰å¾ˆå¤§çš„å½±å“ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯¹åŠ¨æ€è¯­è¨€çš„æ”¯æŒè¾ƒå¼±&lt;/strong&gt;ï¼šeBPF å¯¹åŸºäº JIT çš„åŠ¨æ€è¯­è¨€ï¼Œå¦‚ Javaï¼Œæ”¯æŒè¾ƒå¼±ã€‚è¿™ä¹Ÿå–å†³äºä½ æƒ³æ”¶é›†ä»€ä¹ˆæ•°æ®ã€‚å¯¹äº Profilingï¼ŒeBPF ä¸æ”¯æŒè§£æç¨‹åºçš„å­—ç¬¦è¡¨ï¼ˆsymbolï¼‰ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆå¤§å¤šæ•°åŸºäº eBPF çš„å‰–ææŠ€æœ¯åªæ”¯æŒé™æ€è¯­è¨€å¦‚ Cã€C++ã€Go å’Œ Rustã€‚ç„¶è€Œï¼Œå­—ç¬¦è¡¨æ˜ å°„æœ‰æ—¶å¯ä»¥é€šè¿‡è¯­è¨€æ‰€æä¾›çš„å·¥å…·æ¥è§£å†³ã€‚ä¾‹å¦‚ï¼Œåœ¨ Java ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ &lt;a href=&#34;https://github.com/jvm-profiling-tools/perf-map-agent#architecture&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;perf-map-agent&lt;/a&gt; æ¥ç”Ÿæˆå­—ç¬¦è¡¨æ˜ å°„ã€‚ç„¶è€Œï¼ŒåŠ¨æ€è¯­è¨€ä¸æ”¯æŒé™„åŠ ï¼ˆ&lt;code&gt;uprobe&lt;/code&gt;ï¼‰åŠŸèƒ½ï¼Œè€Œè¿™ç§åŠŸèƒ½å¯ä»¥è®©æˆ‘ä»¬é€šè¿‡ç¬¦å·è¿½è¸ªæ‰§è¡Œäº‹ä»¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;introducing-skywalking-rover&#34;&gt;SkyWalking Rover ç®€ä»‹&lt;/h3&gt;
&lt;p&gt;SkyWalking Rover æ˜¯ SkyWalking ç”Ÿæ€ç³»ç»Ÿä¸­å¼•å…¥çš„ eBPF å‰–æåŠŸèƒ½ã€‚ä¸‹å›¾æ˜¾ç¤ºäº† SkyWalking Rover çš„æ•´ä½“æ¶æ„ã€‚SkyWalking Rover ç›®å‰æ”¯æŒ Kubernetes ç¯å¢ƒï¼Œå¿…é¡»éƒ¨ç½²åœ¨ Kubernetes é›†ç¾¤å†…ã€‚ä¸ SkyWalking åç«¯æœåŠ¡å™¨å»ºç«‹è¿æ¥åï¼Œå®ƒå°†å½“å‰æœºå™¨ä¸Šçš„è¿›ç¨‹ä¿¡æ¯ä¿å­˜åˆ° SkyWalkingã€‚å½“ç”¨æˆ·é€šè¿‡ç”¨æˆ·ç•Œé¢åˆ›å»º eBPF å‰–æä»»åŠ¡æ—¶ï¼ŒSkyWalking Rover ä¼šæ¥æ”¶ä»»åŠ¡å¹¶åœ¨ç›¸å…³çš„åŸºäº Cã€C++ã€Golang å’Œ Rust è¯­è¨€çš„ç¨‹åºä¸­æ‰§è¡Œã€‚&lt;/p&gt;
&lt;p&gt;é™¤äº†éœ€è¦å…·æœ‰ eBPF åŠŸèƒ½çš„å†…æ ¸å¤–ï¼Œéƒ¨ç½² SkyWalking Rover æ²¡æœ‰å…¶ä»–å…ˆå†³æ¡ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-skywalking-rover-æ¶æ„å›¾&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;SkyWalking Rover æ¶æ„å›¾&#34; srcset=&#34;
               /blog/pinpoint-service-mesh-critical-performance-impact-by-using-ebpf/skywalking-rover_hu96ce0a1793ef4084b7c6baa2f4d21194_31590_6edef539501f91527785125de04f77d1.webp 400w,
               /blog/pinpoint-service-mesh-critical-performance-impact-by-using-ebpf/skywalking-rover_hu96ce0a1793ef4084b7c6baa2f4d21194_31590_77630572196fa0d44044c36d67f6e3d2.webp 760w,
               /blog/pinpoint-service-mesh-critical-performance-impact-by-using-ebpf/skywalking-rover_hu96ce0a1793ef4084b7c6baa2f4d21194_31590_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/pinpoint-service-mesh-critical-performance-impact-by-using-ebpf/skywalking-rover_hu96ce0a1793ef4084b7c6baa2f4d21194_31590_6edef539501f91527785125de04f77d1.webp&#34;
               width=&#34;760&#34;
               height=&#34;259&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      SkyWalking Rover æ¶æ„å›¾
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h3 id=&#34;cpu-profiling-with-rover&#34;&gt;ä½¿ç”¨ Rover è¿›è¡Œ CPU å‰–æ&lt;/h3&gt;
&lt;p&gt;CPU å‰–ææ˜¯æ˜¾ç¤ºæœåŠ¡æ€§èƒ½çš„æœ€ç›´è§‚æ–¹å¼ã€‚å— &lt;a href=&#34;https://www.brendangregg.com/offcpuanalysis.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Brendan Gregg çš„åšå®¢æ–‡ç« &lt;/a&gt; çš„å¯å‘ï¼Œæˆ‘ä»¬å°† CPU å‰–æåˆ†ä¸ºä¸¤ç§ç±»å‹ï¼Œå¹¶åœ¨ Rover ä¸­åŠ ä»¥å®æ–½ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;CPU å‰–æ&lt;/strong&gt;ï¼šçº¿ç¨‹åœ¨ CPU ä¸Šçš„è¿è¡Œæ—¶é—´ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;off-CPU å‰–æ&lt;/strong&gt;ï¼šçº¿ç¨‹åœ¨ I/Oã€é”ã€å®šæ—¶å™¨ã€åˆ†é¡µ / äº¤æ¢ç­‰æ–¹é¢è¢«é˜»å¡æ—¶çš„ç­‰å¾…æ—¶é—´ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;profiling-envoy-with-ebpf&#34;&gt;ç”¨ eBPF å¯¹ Envoy è¿›è¡Œå‰–æ&lt;/h2&gt;
&lt;p&gt;Envoy æ˜¯ä¸€ä¸ªæµè¡Œçš„ä»£ç†ï¼Œåœ¨ Istio æœåŠ¡ç½‘æ ¼ä¸­è¢«ç”¨ä½œä¸ºæ•°æ®å¹³é¢ã€‚åœ¨ Kubernetes é›†ç¾¤ä¸­ï¼ŒIstio å°† Envoy ä½œä¸º sidecar æ³¨å…¥åˆ°æ¯ä¸ªæœåŠ¡çš„ pod ä¸­ï¼Œåœ¨é‚£é‡Œé€æ˜åœ°æ‹¦æˆªå’Œå¤„ç†ä¼ å…¥å’Œä¼ å‡ºçš„æµé‡ã€‚ä½œä¸ºæ•°æ®å¹³é¢ï¼ŒEnvoy çš„ä»»ä½•æ€§èƒ½é—®é¢˜éƒ½ä¼šå½±å“åˆ°ç½‘æ ¼ä¸­çš„æ‰€æœ‰æœåŠ¡æµé‡ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½¿ç”¨ eBPF å‰–ææ¥åˆ†æç”Ÿäº§ä¸­ç”±æœåŠ¡ç½‘æ ¼å¼•èµ·çš„é—®é¢˜æ˜¯æ¯”è¾ƒæœ‰åŠ›çš„ã€‚&lt;/p&gt;
&lt;h3 id=&#34;demo-environment&#34;&gt;æ¼”ç¤ºç¯å¢ƒ&lt;/h3&gt;
&lt;p&gt;å¦‚æœä½ æƒ³çœ‹åˆ°è¯¦ç»†è¿‡ç¨‹ï¼Œæˆ‘ä»¬å·²ç»å»ºç«‹äº†ä¸€ä¸ªæ¼”ç¤ºç¯å¢ƒï¼Œåœ¨é‚£é‡Œæˆ‘ä»¬éƒ¨ç½²äº†ä¸€ä¸ª Nginx æœåŠ¡è¿›è¡Œå‹åŠ›æµ‹è¯•ã€‚æµé‡è¢« Envoy æ‹¦æˆªå¹¶è½¬å‘åˆ° Nginxã€‚å®‰è£…æ•´ä¸ªç¯å¢ƒçš„å‘½ä»¤å¯ä»¥åœ¨ &lt;a href=&#34;https://github.com/mrproliu/skywalking-rover-profiling-demo&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;GitHub&lt;/a&gt; ä¸Šè·å–ã€‚&lt;/p&gt;
&lt;h2 id=&#34;on-cpu-profiling&#34;&gt;CPU å‰–æ&lt;/h2&gt;
&lt;p&gt;å½“æœåŠ¡çš„ CPU ä½¿ç”¨ç‡å¾ˆé«˜æ—¶ï¼ŒCPU å‰–æé€‚ç”¨äºåˆ†æçº¿ç¨‹å †æ ˆã€‚å¦‚æœå †æ ˆè¢«è½¬å‚¨çš„æ¬¡æ•°è¾ƒå¤šï¼Œæ„å‘³ç€çº¿ç¨‹å †æ ˆå æ®äº†æ›´å¤šçš„ CPU èµ„æºã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ä½¿ç”¨æ¼”ç¤ºé…ç½®æ–‡ä»¶å®‰è£… Istio æ—¶ï¼Œæˆ‘ä»¬å‘ç°æœ‰ä¸¤ä¸ªåœ°æ–¹çš„æ€§èƒ½å¯ä»¥ä¼˜åŒ–ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Zipkin è¿½è¸ª&lt;/strong&gt;ï¼šä¸åŒçš„ Zipkin é‡‡æ ·ç™¾åˆ†æ¯”å¯¹ QPS æœ‰ç›´æ¥å½±å“ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è®¿é—®æ—¥å¿—æ ¼å¼&lt;/strong&gt;ï¼šå‡å°‘ Envoy è®¿é—®æ—¥å¿—çš„å­—æ®µå¯ä»¥æé«˜ QPSã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;zipkin-è¿½è¸ª&#34;&gt;Zipkin è¿½è¸ª&lt;/h3&gt;
&lt;h3 id=&#34;zipkin-100-é‡‡æ ·&#34;&gt;Zipkin 100% é‡‡æ ·&lt;/h3&gt;
&lt;p&gt;åœ¨é»˜è®¤çš„æ¼”ç¤ºé…ç½®æ–‡ä»¶ä¸­ï¼ŒEnvoy ä½¿ç”¨ 100% é‡‡æ ·ä½œä¸ºé»˜è®¤çš„è¿½è¸ªç­–ç•¥ã€‚è¿™å¯¹æ€§èƒ½æœ‰ä»€ä¹ˆå½±å“ï¼Ÿ&lt;/p&gt;
&lt;p&gt;å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä½¿ç”¨ CPU å‰–æï¼Œæˆ‘ä»¬å‘ç°å®ƒå¤§çº¦éœ€è¦ &lt;strong&gt;16%&lt;/strong&gt; çš„ CPU å¼€é”€ã€‚åœ¨å›ºå®šæ¶ˆè€— &lt;strong&gt;2 ä¸ª CPU&lt;/strong&gt; çš„æƒ…å†µä¸‹ï¼Œå…¶ QPS å¯ä»¥è¾¾åˆ° &lt;strong&gt;5.7K&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-zipkin-100-é‡‡æ ·-cpu-å‰–æçš„ç«ç„°å›¾&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Zipkin 100% é‡‡æ · CPU å‰–æçš„ç«ç„°å›¾&#34; srcset=&#34;
               /blog/pinpoint-service-mesh-critical-performance-impact-by-using-ebpf/zipkin-sampling-100_huf238a1b5794ab6185477371703bb7cbb_258667_5c5bdd04bcd413ed5927348c85330886.webp 400w,
               /blog/pinpoint-service-mesh-critical-performance-impact-by-using-ebpf/zipkin-sampling-100_huf238a1b5794ab6185477371703bb7cbb_258667_b68a53a9b8fc1f02dbfc560074a62481.webp 760w,
               /blog/pinpoint-service-mesh-critical-performance-impact-by-using-ebpf/zipkin-sampling-100_huf238a1b5794ab6185477371703bb7cbb_258667_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/pinpoint-service-mesh-critical-performance-impact-by-using-ebpf/zipkin-sampling-100_huf238a1b5794ab6185477371703bb7cbb_258667_5c5bdd04bcd413ed5927348c85330886.webp&#34;
               width=&#34;760&#34;
               height=&#34;385&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      Zipkin 100% é‡‡æ · CPU å‰–æçš„ç«ç„°å›¾
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h3 id=&#34;ç¦ç”¨-zipkin-è¿½è¸ª&#34;&gt;ç¦ç”¨ Zipkin è¿½è¸ª&lt;/h3&gt;
&lt;p&gt;æ­¤æ—¶ï¼Œæˆ‘ä»¬å‘ç°ï¼Œå¦‚æœæ²¡æœ‰å¿…è¦ï¼Œå¯ä»¥é™ä½ Zipkin é‡‡æ ·æ¯”ä¾‹ï¼Œç”šè‡³å¯ä»¥ç¦ç”¨è¿½è¸ªã€‚æ ¹æ® &lt;a href=&#34;https://istio.io/latest/docs/reference/config/istio.mesh.v1alpha1/#Tracing&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Istio æ–‡æ¡£&lt;/a&gt;ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å®‰è£… Istio æ—¶ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ç¦ç”¨è¿½è¸ªã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;istioctl install -y --set &lt;span class=&#34;nv&#34;&gt;profile&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;demo &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;   --set &lt;span class=&#34;s1&#34;&gt;&amp;#39;meshConfig.enableTracing=false&amp;#39;&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;   --set &lt;span class=&#34;s1&#34;&gt;&amp;#39;meshConfig.defaultConfig.tracing.sampling=0.0&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç¦ç”¨è¿½è¸ªåï¼Œæˆ‘ä»¬å†æ¬¡è¿›è¡Œ CPU å‰–æã€‚æ ¹æ®ä¸‹å›¾ï¼Œæˆ‘ä»¬å‘ç° Zipkin å·²ç»ä»ç«ç„°å›¾ä¸­æ¶ˆå¤±äº†ã€‚åœ¨ä¸å‰é¢çš„ä¾‹å­ç›¸åŒçš„ &lt;strong&gt;2 ä¸ª CPU&lt;/strong&gt; æ¶ˆè€—ä¸‹ï¼ŒQPS è¾¾åˆ° &lt;strong&gt;9K&lt;/strong&gt;ï¼Œå‡ ä¹å¢åŠ äº† &lt;strong&gt;60%&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-ç¦ç”¨-zipkin-è¿½è¸ªçš„-cpu-å‰–æç«ç„°å›¾&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;ç¦ç”¨ Zipkin è¿½è¸ªçš„ CPU å‰–æç«ç„°å›¾&#34; srcset=&#34;
               /blog/pinpoint-service-mesh-critical-performance-impact-by-using-ebpf/zipkin-disable-tracing_hu1f0ecaf355e785aa0e2514c9e5fd63b4_235208_6ce84d92564a56b7ebc933d9646c9347.webp 400w,
               /blog/pinpoint-service-mesh-critical-performance-impact-by-using-ebpf/zipkin-disable-tracing_hu1f0ecaf355e785aa0e2514c9e5fd63b4_235208_4120d0c8954a6454493ed53dde25e284.webp 760w,
               /blog/pinpoint-service-mesh-critical-performance-impact-by-using-ebpf/zipkin-disable-tracing_hu1f0ecaf355e785aa0e2514c9e5fd63b4_235208_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/pinpoint-service-mesh-critical-performance-impact-by-using-ebpf/zipkin-disable-tracing_hu1f0ecaf355e785aa0e2514c9e5fd63b4_235208_6ce84d92564a56b7ebc933d9646c9347.webp&#34;
               width=&#34;760&#34;
               height=&#34;384&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      ç¦ç”¨ Zipkin è¿½è¸ªçš„ CPU å‰–æç«ç„°å›¾
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h3 id=&#34;tracing-with-throughput&#34;&gt;è¿½è¸ªååé‡&lt;/h3&gt;
&lt;p&gt;åœ¨ CPU ä½¿ç”¨ç‡ç›¸åŒçš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å‘ç°ï¼Œå½“è¿½è¸ªåŠŸèƒ½è¢«ç¦ç”¨æ—¶ï¼ŒEnvoy çš„æ€§èƒ½ä¼šå¤§å¤§æå‡ã€‚å½“ç„¶ï¼Œè¿™éœ€è¦æˆ‘ä»¬åœ¨ Zipkin æ”¶é›†çš„æ ·æœ¬æ•°é‡å’Œ Envoy çš„é¢„æœŸæ€§èƒ½ï¼ˆQPSï¼‰ä¹‹é—´åšå‡ºæƒè¡¡ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹è¡¨è¯´æ˜äº†åœ¨ç›¸åŒçš„ CPU ä½¿ç”¨ç‡ä¸‹ï¼Œä¸åŒçš„ Zipkin é‡‡æ ·æ¯”ä¾‹å¯¹ QPS çš„å½±å“ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Zipkin é‡‡æ ·æ¯”ä¾‹&lt;/th&gt;
&lt;th&gt;QPS&lt;/th&gt;
&lt;th&gt;CPU&lt;/th&gt;
&lt;th&gt;å¤‡æ³¨&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;100% &lt;strong&gt;ï¼ˆé»˜è®¤ï¼‰&lt;/strong&gt;&lt;/td&gt;
&lt;td&gt;5.7K&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;Zipkin å ç”¨ 16%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;1%&lt;/td&gt;
&lt;td&gt;8.1K&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;Zipkin å ç”¨ 0.3%&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;ç¦ç”¨&lt;/td&gt;
&lt;td&gt;9.2K&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;Zipkin å ç”¨ 0%&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id=&#34;access-log-format&#34;&gt;è®¿é—®æ—¥å¿—æ ¼å¼&lt;/h2&gt;
&lt;h3 id=&#34;default-log-format&#34;&gt;é»˜è®¤è®¿é—®æ—¥å¿—æ ¼å¼&lt;/h3&gt;
&lt;p&gt;åœ¨é»˜è®¤çš„æ¼”ç¤ºé…ç½®æ–‡ä»¶ä¸­ï¼Œé»˜è®¤çš„è®¿é—®æ—¥å¿—æ ¼å¼åŒ…å«å¤§é‡çš„æ•°æ®ã€‚ä¸‹é¢çš„ç«ç„°å›¾æ˜¾ç¤ºäº†åœ¨è§£ææ•°æ®æ—¶æ¶‰åŠçš„å„ç§åŠŸèƒ½ï¼Œå¦‚è¯·æ±‚å¤´ã€å“åº”å¤´å’Œæµåª’ä½“ä¸»ä½“ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-é»˜è®¤è®¿é—®æ—¥å¿—æ ¼å¼çš„-cpu-å‰–æç«ç„°å›¾&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;é»˜è®¤è®¿é—®æ—¥å¿—æ ¼å¼çš„ CPU å‰–æç«ç„°å›¾&#34; srcset=&#34;
               /blog/pinpoint-service-mesh-critical-performance-impact-by-using-ebpf/log-format-default_hu7d2fdb57bd91148e550aa40a981eaed2_174188_0f5231040d3cb686febbbade6d4f490a.webp 400w,
               /blog/pinpoint-service-mesh-critical-performance-impact-by-using-ebpf/log-format-default_hu7d2fdb57bd91148e550aa40a981eaed2_174188_ca470e83e66ecbe17169087ebaace536.webp 760w,
               /blog/pinpoint-service-mesh-critical-performance-impact-by-using-ebpf/log-format-default_hu7d2fdb57bd91148e550aa40a981eaed2_174188_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/pinpoint-service-mesh-critical-performance-impact-by-using-ebpf/log-format-default_hu7d2fdb57bd91148e550aa40a981eaed2_174188_0f5231040d3cb686febbbade6d4f490a.webp&#34;
               width=&#34;760&#34;
               height=&#34;385&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      é»˜è®¤è®¿é—®æ—¥å¿—æ ¼å¼çš„ CPU å‰–æç«ç„°å›¾
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h3 id=&#34;simplifying-access-log-format&#34;&gt;ç®€åŒ–è®¿é—®æ—¥å¿—æ ¼å¼&lt;/h3&gt;
&lt;p&gt;é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸éœ€è¦è®¿é—®æ—¥å¿—ä¸­çš„æ‰€æœ‰ä¿¡æ¯ï¼Œæ‰€ä»¥æˆ‘ä»¬é€šå¸¸å¯ä»¥ç®€åŒ–å®ƒæ¥è·å¾—æˆ‘ä»¬éœ€è¦çš„ä¿¡æ¯ã€‚ä¸‹é¢çš„å‘½ä»¤ç®€åŒ–äº†è®¿é—®æ—¥å¿—çš„æ ¼å¼ï¼Œåªæ˜¾ç¤ºåŸºæœ¬ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;istioctl install -y --set &lt;span class=&#34;nv&#34;&gt;profile&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;demo &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;   --set meshConfig.accessLogFormat&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;[% START_TIME%] \&amp;#34;% REQ (:METHOD)% % REQ (X-ENVOY-ORIGINAL-PATH?:PATH)% % PROTOCOL%\&amp;#34;% RESPONSE_CODE%\n&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç®€åŒ–è®¿é—®æ—¥å¿—æ ¼å¼åï¼Œæˆ‘ä»¬å‘ç° QPS ä» &lt;strong&gt;5.7K&lt;/strong&gt; å¢åŠ åˆ° &lt;strong&gt;5.9K&lt;/strong&gt;ã€‚å½“å†æ¬¡æ‰§è¡Œ CPU å‰–ææ—¶ï¼Œæ—¥å¿—æ ¼å¼åŒ–çš„ CPU ä½¿ç”¨ç‡ä» &lt;strong&gt;2.4%&lt;/strong&gt; ä¸‹é™åˆ° &lt;strong&gt;0.7%&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç®€åŒ–æ—¥å¿—æ ¼å¼å¸®åŠ©æˆ‘ä»¬æé«˜äº†æ€§èƒ½ã€‚&lt;/p&gt;
&lt;h2 id=&#34;off-cpu-å‰–æ&#34;&gt;Off-CPU å‰–æ&lt;/h2&gt;
&lt;p&gt;Off-CPU å‰–æé€‚ç”¨äºç”±éé«˜ CPU ä½¿ç”¨ç‡å¼•èµ·çš„æ€§èƒ½é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œå½“ä¸€ä¸ªæœåŠ¡ä¸­æœ‰å¤ªå¤šçš„çº¿ç¨‹æ—¶ï¼Œä½¿ç”¨ off-CPU å‰–æå¯ä»¥æ­ç¤ºå‡ºå“ªäº›çº¿ç¨‹èŠ±è´¹äº†æ›´å¤šçš„æ—¶é—´è¿›è¡Œä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æä¾›ä¸¤ä¸ªç»´åº¦çš„æ•°æ®æ±‡æ€»ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;åˆ‡æ¢æ¬¡æ•°&lt;/strong&gt;ï¼šä¸€ä¸ªçº¿ç¨‹åˆ‡æ¢ä¸Šä¸‹æ–‡çš„æ¬¡æ•°ã€‚å½“çº¿ç¨‹è¿”å›åˆ° CPU æ—¶ï¼Œå®ƒå®Œæˆäº†ä¸€æ¬¡ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚å¼€å…³æ¬¡æ•°è¾ƒå¤šçš„çº¿ç¨‹æ ˆä¼šèŠ±è´¹æ›´å¤šæ—¶é—´è¿›è¡Œä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åˆ‡æ¢æŒç»­æ—¶é—´&lt;/strong&gt;ï¼šä¸€ä¸ªçº¿ç¨‹åˆ‡æ¢ä¸Šä¸‹æ–‡æ‰€éœ€çš„æ—¶é—´ã€‚åˆ‡æ¢æŒç»­æ—¶é—´è¾ƒé•¿çš„çº¿ç¨‹æ ˆåœ¨ off-CPU èŠ±è´¹çš„æ—¶é—´è¾ƒå¤šã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;write-access-log&#34;&gt;å†™å…¥è®¿é—®æ—¥å¿—&lt;/h3&gt;
&lt;h4 id=&#34;enable-write&#34;&gt;å¯ç”¨å†™å…¥&lt;/h4&gt;
&lt;p&gt;ä½¿ç”¨ä¸ä¹‹å‰ CPU æµ‹è¯•ç›¸åŒçš„ç¯å¢ƒå’Œè®¾ç½®ï¼Œæˆ‘ä»¬è¿›è¡Œäº† off-CPU å‰–æã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬å‘ç°è®¿é—®æ—¥å¿—çš„å†™å…¥å æ€»ä¸Šä¸‹æ–‡åˆ‡æ¢çš„ &lt;strong&gt;28%&lt;/strong&gt; å·¦å³ã€‚ä¸‹å›¾ä¸­çš„ &lt;code&gt;__write&lt;/code&gt; ä¹Ÿè¡¨æ˜è¿™æ˜¯ Linux å†…æ ¸ä¸­çš„æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å¯ç”¨å†™å…¥çš„-off-cpu-å‰–æç«ç„°å›¾&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å¯ç”¨å†™å…¥çš„ off-CPU å‰–æç«ç„°å›¾&#34; srcset=&#34;
               /blog/pinpoint-service-mesh-critical-performance-impact-by-using-ebpf/access-log-write-enable_hubdf9a606cdf61d4031d0e2209c45ffff_117338_4f90812f80bcc003b7376d5607177654.webp 400w,
               /blog/pinpoint-service-mesh-critical-performance-impact-by-using-ebpf/access-log-write-enable_hubdf9a606cdf61d4031d0e2209c45ffff_117338_fea2e2c0d03b286f15392cc50602ab21.webp 760w,
               /blog/pinpoint-service-mesh-critical-performance-impact-by-using-ebpf/access-log-write-enable_hubdf9a606cdf61d4031d0e2209c45ffff_117338_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/pinpoint-service-mesh-critical-performance-impact-by-using-ebpf/access-log-write-enable_hubdf9a606cdf61d4031d0e2209c45ffff_117338_4f90812f80bcc003b7376d5607177654.webp&#34;
               width=&#34;760&#34;
               height=&#34;385&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å¯ç”¨å†™å…¥çš„ off-CPU å‰–æç«ç„°å›¾
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h4 id=&#34;ç¦ç”¨å†™å…¥&#34;&gt;ç¦ç”¨å†™å…¥&lt;/h4&gt;
&lt;p&gt;SkyWalking å®ç°äº† Envoy çš„è®¿é—®æ—¥å¿—æœåŠ¡ï¼ˆALSï¼‰åŠŸèƒ½ï¼Œå…è®¸æˆ‘ä»¬ä½¿ç”¨ gRPC åè®®å°†è®¿é—®æ—¥å¿—å‘é€åˆ° SkyWalking å¯è§‚å¯Ÿæ€§åˆ†æå¹³å°ï¼ˆOAPï¼‰ã€‚å³ä½¿ç¦ç”¨è®¿é—®æ—¥å¿—ï¼Œæˆ‘ä»¬ä»ç„¶å¯ä»¥ä½¿ç”¨ ALS æ¥æ•è· / æ±‡æ€»æ—¥å¿—ã€‚æˆ‘ä»¬ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ç¦ç”¨äº†å¯¹è®¿é—®æ—¥å¿—çš„å†™å…¥ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;istioctl install -y --set &lt;span class=&#34;nv&#34;&gt;profile&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;demo --set meshConfig.accessLogFile&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç¦ç”¨è®¿é—®æ—¥å¿—åŠŸèƒ½åï¼Œæˆ‘ä»¬è¿›è¡Œäº† off-CPU å‰–æã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ–‡ä»¶å†™å…¥æ¡ç›®å·²ç»æ¶ˆå¤±äº†ã€‚Envoy çš„ååé‡ä¹Ÿä» &lt;strong&gt;5.7K&lt;/strong&gt; å¢åŠ åˆ° &lt;strong&gt;5.9K&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-ç¦ç”¨è®¿é—®æ—¥å¿—åŠŸèƒ½åçš„-off-cpu-å‰–æç«ç„°å›¾&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;ç¦ç”¨è®¿é—®æ—¥å¿—åŠŸèƒ½åçš„ off-CPU å‰–æç«ç„°å›¾&#34; srcset=&#34;
               /blog/pinpoint-service-mesh-critical-performance-impact-by-using-ebpf/access-log-write-disable_hu5e4e6d524a292897da8cca3705844d39_104099_5d9c5dc3f590028c1b5386c0232bffb5.webp 400w,
               /blog/pinpoint-service-mesh-critical-performance-impact-by-using-ebpf/access-log-write-disable_hu5e4e6d524a292897da8cca3705844d39_104099_64a520f1998a1b10dd8b102cdaefebbb.webp 760w,
               /blog/pinpoint-service-mesh-critical-performance-impact-by-using-ebpf/access-log-write-disable_hu5e4e6d524a292897da8cca3705844d39_104099_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/pinpoint-service-mesh-critical-performance-impact-by-using-ebpf/access-log-write-disable_hu5e4e6d524a292897da8cca3705844d39_104099_5d9c5dc3f590028c1b5386c0232bffb5.webp&#34;
               width=&#34;760&#34;
               height=&#34;385&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      ç¦ç”¨è®¿é—®æ—¥å¿—åŠŸèƒ½åçš„ off-CPU å‰–æç«ç„°å›¾
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h2 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ç ”ç©¶äº† Apache SkyWalking çš„ Trace Profiling å¯ä»¥ç»™æˆ‘ä»¬å¸¦æ¥çš„å¯ç¤ºï¼Œä»¥åŠä½¿ç”¨ eBPF å‰–æå¯ä»¥å®ç°çš„æ›´å¤šåŠŸèƒ½ã€‚æ‰€æœ‰è¿™äº›åŠŸèƒ½éƒ½åœ¨ &lt;a href=&#34;https://github.com/apache/skywalking-rover&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;skywalking-rover&lt;/a&gt; ä¸­å®ç°ã€‚é™¤äº† CPU å’Œ off-CPU å‰–æä¹‹å¤–ï¼Œä½ è¿˜ä¼šå‘ç°ä»¥ä¸‹åŠŸèƒ½ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;è¿ç»­å‰–æ&lt;/strong&gt;ï¼Œå¸®åŠ©ä½ è‡ªåŠ¨å‰–æï¼Œæ— éœ€äººå·¥å¹²é¢„ã€‚ä¾‹å¦‚ï¼Œå½“ Rover æ£€æµ‹åˆ° CPU è¶…è¿‡ä¸€ä¸ªå¯é…ç½®çš„é˜ˆå€¼æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨æ‰§è¡Œ CPU å‰–æä»»åŠ¡ã€‚&lt;/li&gt;
&lt;li&gt;æ›´å¤šçš„å‰–æç±»å‹ï¼Œä»¥ä¸°å¯Œä½¿ç”¨åœºæ™¯ï¼Œå¦‚ç½‘ç»œå’Œå†…å­˜å‰–æã€‚&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>é€šè¿‡ä¸¤çº§ç½‘å…³è®¾è®¡æ¥è·¯ç”±æœåŠ¡ç½‘æ ¼æµé‡</title>
      <link>https://lib.jimmysong.io/blog/designing-traffic-flow-via-tier1-and-tier2-ingress-gateways/</link>
      <pubDate>Wed, 29 Jun 2022 11:00:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/designing-traffic-flow-via-tier1-and-tier2-ingress-gateways/</guid>
      <description>&lt;h2 id=&#34;foreword&#34;&gt;ç¼–è€…çš„è¯&lt;/h2&gt;
&lt;p&gt;æœ¬æ–‡æ˜¯æ¥è‡ª &lt;a href=&#34;https://tetrate.io&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tetrate&lt;/a&gt; å·¥ç¨‹å¸ˆçš„åˆ†äº«ï¼ŒTetrate çš„æ‹³å¤´äº§å“æ˜¯ &lt;a href=&#34;https://tetrate.io/tetrate-service-bridge&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tetrate Service Bridge&lt;/a&gt;ï¼ˆä¸‹æ–‡ç®€ç§° TSBï¼‰ï¼Œå®ƒæ˜¯åœ¨å¼€æºçš„ Istio å’Œ Envoy åŸºç¡€ä¸Šæ„å»ºçš„ï¼Œä½†ä¸ºå…¶å¢åŠ äº†ç®¡ç†å¹³é¢ã€‚&lt;/p&gt;
&lt;h2 id=&#34;intro&#34;&gt;ç®€ä»‹&lt;/h2&gt;
&lt;p&gt;Tetrate çš„åº”ç”¨è¿æ¥å¹³å° Tetrate Service Bridgeï¼ˆTSBï¼‰æä¾›ä¸¤ç§ç½‘å…³ç±»å‹ï¼Œåˆ†åˆ«ä¸ºä¸€çº§ç½‘å…³ï¼ˆTier-1ï¼‰å’ŒäºŒçº§ç½‘å…³ï¼ˆTier-2ï¼‰ï¼Œå®ƒä»¬éƒ½åŸºäº Envoy æ„å»ºï¼Œä½†æ˜¯ç›®çš„æœ‰æ‰€ä¸åŒã€‚æœ¬æ–‡å°†æ¢è®¨è¿™ä¸¤ç§ç±»å‹ç½‘å…³çš„åŠŸèƒ½ï¼Œä»¥åŠä½•æ—¶é€‰ç”¨å“ªç§ç½‘å…³ã€‚&lt;/p&gt;
&lt;p&gt;å…³äºä¸¤çº§ç½‘å…³çš„ç®€è¦ä»‹ç»ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸€çº§ç½‘å…³ï¼ˆä¸‹æ–‡ç®€ç§° T1ï¼‰ä½äºåº”ç”¨è¾¹ç¼˜ï¼Œç”¨äºå¤šé›†ç¾¤ç¯å¢ƒã€‚åŒä¸€åº”ç”¨ä¼šåŒæ—¶æ‰˜ç®¡åœ¨ä¸åŒçš„é›†ç¾¤ä¸Šï¼ŒT1ç½‘å…³å°†å¯¹è¯¥åº”ç”¨çš„è¯·æ±‚æµé‡åœ¨è¿™äº›é›†ç¾¤ä¹‹é—´è·¯ç”±ã€‚&lt;/li&gt;
&lt;li&gt;äºŒçº§ç½‘å…³ï¼ˆä¸‹æ–‡ç®€ç§° T2ï¼‰ä½äºä¸€ä¸ªçš„é›†ç¾¤è¾¹ç¼˜ï¼Œç”¨äºå°†æµé‡è·¯ç”±åˆ°è¯¥é›†ç¾¤å†…ç”±æœåŠ¡ç½‘æ ¼ç®¡ç†çš„æœåŠ¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;explain&#34;&gt;ä¸¤çº§ç½‘å…³é‡Šä¹‰&lt;/h2&gt;
&lt;p&gt;æ‰˜ç®¡åœ¨ TSB ç®¡ç†çš„é›†ç¾¤ä¸­çš„åº”ç”¨éƒ¨ç½²çš„è®¾è®¡ä¸å¼€æºçš„ Istio æ¨¡å‹éå¸¸ç›¸ä¼¼ã€‚å®ƒä»¬çš„ç»“æ„ç›¸åŒï¼Œä½¿ç”¨å…¥å£ç½‘å…³æ¥è·¯ç”±ä¼ å…¥çš„æµé‡ã€‚T2 ç½‘å…³ç›¸å½“äº Istio çš„å…¥å£ç½‘å…³ï¼ˆIngress Gatewayï¼‰ï¼Œåœ¨é€»è¾‘ä¸Šä¸ Istio å¼€æºæ¨¡å‹ç›¸åŒï¼Œå¦‚å›¾ 1 æ‰€ç¤ºã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-1istio-ç½‘å…³å¯¹æ¯”-tetrate-t2-ç½‘å…³&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 1ï¼šIstio ç½‘å…³å¯¹æ¯” Tetrate T2 ç½‘å…³&#34;
           src=&#34;https://lib.jimmysong.io/blog/designing-traffic-flow-via-tier1-and-tier2-ingress-gateways/tier2-gw-deployment.svg&#34;
           loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 1ï¼šIstio ç½‘å…³å¯¹æ¯” Tetrate T2 ç½‘å…³
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;Tetrate Service Bridge ä½¿ç”¨ Istio å’Œ Envoy æ„å»ºçš„æœåŠ¡ç½‘æ ¼ç®¡ç†é›†ç¾¤çš„æ§åˆ¶å¹³é¢å’Œæ•°æ®å¹³é¢ï¼Œå…¶æœ¬èº«ä¸å­˜åœ¨äºåº”ç”¨æ•°æ®è·¯å¾„ä¸­ã€‚æ¯”è¾ƒå¼€æº Istio ç®¡ç†çš„é›†ç¾¤å’Œ TSB ç®¡ç†çš„é›†ç¾¤ä¹‹é—´çš„æ•°æ®åŒ…è·¯å¾„ï¼Œä½ ä¼šå‘ç°ä¸¤è€…ä¹‹é—´æ²¡æœ‰åŒºåˆ«ã€‚TSB çš„é…ç½®æ¸…å•ï¼ˆmanifestï¼‰è¢« Istio æ¶ˆè´¹å’Œä½¿ç”¨ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼ŒTSB çš„ä½œç”¨ç±»ä¼¼äº CI/CD è‡ªåŠ¨åŒ–é€»è¾‘ï¼Œå…¶ä¸­éƒ¨ç½²è¿‡ç¨‹ä¼šå½±å“åº”ç”¨ç¨‹åºçš„è¡Œä¸ºï¼Œä½†ä¸ä¼šå½±å“åº”ç”¨ç¨‹åºé€»è¾‘æœ¬èº«ã€‚&lt;/p&gt;
&lt;p&gt;TSB åœ¨å¼€æº Istio çš„å¢åŠ äº†ä¸€äº›ç»„ä»¶ï¼Œä»¥ç®¡ç†æ¯ç»„åº”ç”¨ç¨‹åºç½‘å…³èŒƒå›´çš„å®‰è£…å’Œé…ç½®ï¼Œä»¥åŠ å¿«å¼€å‘å’Œè¿ç»´äººå‘˜çš„å·¥ä½œè¿›åº¦ï¼Œå°†åŸºç¡€è®¾æ–½å’Œåº”ç”¨ç¨‹åºä¹‹é—´çš„èŒè´£åˆ†ç¦»ï¼Œå°†é”™è¯¯é…ç½®ç½‘å…³çš„å½±å“ä¸å…¶ä»–åº”ç”¨ç¨‹åº/ä¸šåŠ¡ç»„éš”ç¦»ã€‚&lt;/p&gt;
&lt;h2 id=&#34;when-use-t1&#34;&gt;ä½•æ—¶ä½¿ç”¨ T1 ç½‘å…³ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;å½“ä½ æœ‰ä¸¤ä¸ªæˆ–æ›´å¤šçš„ Kubernetes é›†ç¾¤ä¸ºåŒä¸€ä¸ªåº”ç”¨æœåŠ¡æ—¶ï¼Œä¸ºäº†å¢åŠ å®¹é‡ã€è“ç»¿éƒ¨ç½²ã€æ•…éšœè½¬ç§»ç­‰ï¼Œé—®é¢˜æ€»æ˜¯å‡ºç°ï¼šå…¥ç«™æµé‡å¦‚ä½•åœ¨è¿™äº›é›†ç¾¤ä¹‹é—´åˆ†é…ï¼Ÿ åœ¨æ¯ä¸ªé›†ç¾¤è¾¹ç¼˜çš„ T2 ç½‘å…³å…è®¸ç›´æ¥è®¿é—®åº”ç”¨ç¨‹åº â€”â€” ä¾‹å¦‚ï¼Œé›†ç¾¤ A å°†ç›‘å¬ &lt;code&gt;service1A.example.com&lt;/code&gt;ï¼Œé›†ç¾¤ X å°†ç›‘å¬ &lt;code&gt;service1X.example.com&lt;/code&gt;ã€‚åè¿‡æ¥ï¼ŒT2 ç½‘å…³æä¾›è·¨é›†ç¾¤çš„å…¨å±€è´Ÿè½½å‡è¡¡ã€‚è·¨é›†ç¾¤çš„æµé‡è·¯ç”±åˆ†é…åŸºäº 1 åˆ° 100 ä¹‹é—´çš„æƒé‡å€¼ï¼ŒæŒ‡å®šå‘é€åˆ°ç‰¹å®šé›†ç¾¤çš„æµé‡çš„ç™¾åˆ†æ¯”ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ T1 ç½‘å…³é…ç½®çš„ä¾‹å­ã€‚è¿™ä¸ªä¾‹å­è¡¨ç¤ºäº†ä¸€ä¸ªå®Œæ•´çš„ T1 ç½‘å…³æ¸…å•ï¼Œä»¥è¯æ˜è¯¥è§£å†³æ–¹æ¡ˆçš„ç®€å•æ€§ã€‚å…³äºå…·ä½“è®¾ç½®çš„ç»†èŠ‚ï¼Œè¯·å‚è€ƒ&lt;a href=&#34;https://docs.tetrate.io/service-bridge/1.4.x/en-us/refs/tsb/gateway/v2/tier1_gateway#tier1gateway&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt; Tetrate API æ–‡æ¡£&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;gateway.tsb.tetrate.io/v2&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Tier1Gateway&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;service1-tier1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;group&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;demo-gw-group&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;organization&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;demo-org&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;tenant&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;demo-tenant&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;workspace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;demo-ws&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;workloadSelector&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;service1-tier1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;labels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;tsb-gateway-service1-tier1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;istio&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;ingressgateway&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;externalServers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;service1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;hostname&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;service1.cx.example.com&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;80&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;tls&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;{}&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;clusters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;site-1-gcp&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;weight&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;75&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;site-2-aws&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;weight&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;25&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œåˆ° &lt;code&gt;service1.cx.example.com&lt;/code&gt; çš„ 75% ç”¨æˆ·è¯·æ±‚è¢«è½¬å‘åˆ° GCP ä¸­çš„ &lt;code&gt;site-1&lt;/code&gt;ï¼Œå…¶ä½™çš„è½¬å‘åˆ° AWS ä¸­çš„ &lt;code&gt;site-2&lt;/code&gt;ã€‚è¿™ä¸ªä¾‹å­ä¸­çš„æµé‡åˆ°è¾¾æ˜æ–‡ç«¯å£ 80ï¼Œä¹‹å T1 ç½‘å…³å’Œåº”ç”¨é›†ç¾¤ä¹‹é—´çš„æ‰€æœ‰é€šä¿¡éƒ½ç»è¿‡ mTLS åŠ å¯†ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-2t1-å’Œ-t2-ç½‘å…³ç½‘ç»œè·¯å¾„å›¾&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 2ï¼šT1 å’Œ T2 ç½‘å…³ç½‘ç»œè·¯å¾„å›¾&#34;
           src=&#34;https://lib.jimmysong.io/blog/designing-traffic-flow-via-tier1-and-tier2-ingress-gateways/tier1-gw-listening.svg&#34;
           loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 2ï¼šT1 å’Œ T2 ç½‘å…³ç½‘ç»œè·¯å¾„å›¾
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h2 id=&#34;consolidate&#34;&gt;äº‘ä¾›åº”ç½‘å…³æ•´åˆ&lt;/h2&gt;
&lt;p&gt;Istio ç”¨æˆ·é€šå¸¸æŒ‰åº”ç”¨æ¨¡å‹å®æ–½å…¥å£ç½‘å…³ã€‚è¿™ç§æ–¹æ³•ä¿è¯äº†å¯¹ä¸€ä¸ªåº”ç”¨ç¨‹åºåŠå…¶å·¥ä»¶çš„å®‰å…¨ã€ç‹¬ç«‹ç®¡ç†ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œæ³¨æ„åˆ°çš„æœ€å¸¸è§çš„ç—›ç‚¹ â€”â€” æ¯ä¸ªåº”ç”¨éƒ½éœ€è¦ä½¿ç”¨äº‘ä¾›åº”å•†çš„è´Ÿè½½å‡è¡¡å™¨ã€‚è¿™æ ·åšä½¿å¾—ç”¨æˆ·éœ€è¦ç»´æŠ¤ä½äº Envoy å…¥å£ç½‘å…³ Pod å‰å¤§é‡çš„è´Ÿè½½å‡è¡¡å™¨ï¼Œè¿™å¸¦æ¥èµ„é‡‘å¼€é”€å’Œç®¡ç†æˆæœ¬ã€‚&lt;/p&gt;
&lt;p&gt;TSB å…è®¸é€šè¿‡ NodePort æœåŠ¡ç±»å‹è€Œä¸æ˜¯ LoadBalancer è¿›è¡ŒæœåŠ¡å‘ç°å’Œé€šä¿¡ï¼Œè¿™æ„å‘³ç€ä¸å†éœ€è¦äº‘ä¾›åº”å•†çš„è´Ÿè½½å‡è¡¡å™¨ï¼›&lt;strong&gt;TSB é›†ç¾¤å†…çš„æœåŠ¡å¯ä»¥é€šè¿‡ NodePort ç›´æ¥åˆ°è¾¾&lt;/strong&gt;ã€‚T1 ç½‘å…³å…è®¸æˆ‘ä»¬å°†äº‘ä¾›åº”å•†è´Ÿè½½å‡è¡¡å™¨çš„ä½¿ç”¨å‹ç¼©åˆ°ä¸€ä¸ªå•ä¸€çš„å…¥å£ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-3äº‘ä¾›åº”å•†ç½‘å…³æ•´åˆ&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 3ï¼šäº‘ä¾›åº”å•†ç½‘å…³æ•´åˆ&#34;
           src=&#34;https://lib.jimmysong.io/blog/designing-traffic-flow-via-tier1-and-tier2-ingress-gateways/cloud-vendor-setup.svg&#34;
           loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 3ï¼šäº‘ä¾›åº”å•†ç½‘å…³æ•´åˆ
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;å›¾ 3 å±•ç¤ºäº†é€šè¿‡å°†é›†ç¾¤å†…çš„æœåŠ¡è¿æ¥è½¬ç§»åˆ° TSBï¼Œè€Œä¸ä½¿ç”¨äº‘ä¾›åº”å•†çš„è´Ÿè½½å‡è¡¡å™¨æ¥ç®€åŒ–äº‘è®¾ç½®ã€‚åœ¨æ²¡æœ‰ TSB çš„æƒ…å†µä¸‹ï¼Œè¦å®ç°ä¸Šè¿°è®¾ç½®ï¼Œéœ€è¦ä½¿ç”¨å¤–éƒ¨è´Ÿè½½å‡è¡¡å™¨ã€‚TSB è¿˜ç»´æŠ¤ Kubernetes èŠ‚ç‚¹çš„åˆ—è¡¨ã€‚&lt;/p&gt;
&lt;h2 id=&#34;resource-requirement&#34;&gt;èµ„æºè¦æ±‚&lt;/h2&gt;
&lt;p&gt;å°± T2 ç½‘å…³æ‰€éœ€çš„èµ„æºè€Œè¨€ï¼Œå¼€æº Istio å’Œ TSB çš„è¦æ±‚æ²¡æœ‰ä»€ä¹ˆä¸åŒã€‚äº‹å®ä¸Šï¼Œå®ç°æ–¹å¼æ˜¯ä¸€æ ·çš„ â€”â€” Gateway å’Œ VirtualService æ¸…å•å¯ä»¥æ‰‹åŠ¨åˆ›å»ºï¼Œä¹Ÿå¯ä»¥é€šè¿‡å¼€æºçš„è‡ªåŠ¨åŒ–å·¥å…·åˆ›å»ºã€‚åœ¨ Tetrate çš„ç”¨ä¾‹ä¸­ï¼ŒTSB ä¸º Istio åˆ›å»ºæ¸…å•ã€‚&lt;/p&gt;
&lt;p&gt;T1 ç½‘å…³ç¡®å®éœ€è¦ä¸€ä¸ªä¸“é—¨çš„æ§åˆ¶å¹³é¢ï¼Œè¿™æ„å‘³ç€ç½‘æ ¼ç®¡ç†çš„åº”ç”¨ç¨‹åºå’Œ T1 ç½‘å…³ä¸èƒ½åœ¨åŒä¸€ä¸ªé›†ç¾¤ä¸­è¿è¡Œï¼Œå°½ç®¡æ‰¿è½½ T1 ç½‘å…³çš„ Kubernetes é›†ç¾¤ä¹Ÿå¯ä»¥æ‰¿è½½æœåŠ¡ç½‘æ ¼ä»¥å¤–çš„åº”ç”¨ç¨‹åºã€‚ä¸è¿‡ï¼ŒTetrate çš„æœ‰äº›å®¢æˆ·å°† T1 ç½‘å…³æ”¾åœ¨ä¸ TSB ç®¡ç†å¹³é¢ç›¸åŒçš„é›†ç¾¤ä¸Šã€‚&lt;/p&gt;
&lt;h2 id=&#34;consideration&#34;&gt;æ¶æ„è€ƒè™‘å› ç´ &lt;/h2&gt;
&lt;p&gt;éšç€åº”ç”¨ç¯å¢ƒçš„å‘å±•å’Œæˆç†Ÿï¼Œå‡ºç°æ–°çš„éœ€æ±‚æ˜¯å¾ˆå¸¸è§çš„ã€‚T1 ç½‘å…³å¯ä»¥ä½œä¸ºåˆå§‹æœåŠ¡ç½‘æ ¼æ¶æ„å®æ–½çš„ä¸€éƒ¨åˆ†è¿›è¡Œè§„åˆ’å’Œå®æ–½ï¼Œä¹Ÿå¯ä»¥åœ¨ä»¥åæ·»åŠ ã€‚å¢åŠ ä¸€çº§ç½‘å…³åªå½±å“å…¥å£ç‚¹çš„å…¥ç«™æµé‡ï¼Œä½†ä¸éœ€è¦å¯¹ç°æœ‰é›†ç¾¤åšä»»ä½•æ”¹å˜ã€‚&lt;/p&gt;
&lt;p&gt;å›¾ 4 å±•ç¤ºäº†ä¸€ä¸ªæ²¡æœ‰ T1 ç½‘å…³çš„éƒ¨ç½²é…ç½®ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-4æ²¡æœ‰-t1-ç½‘å…³çš„éƒ¨ç½²é…ç½®&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 4ï¼šæ²¡æœ‰ T1 ç½‘å…³çš„éƒ¨ç½²é…ç½®&#34;
           src=&#34;https://lib.jimmysong.io/blog/designing-traffic-flow-via-tier1-and-tier2-ingress-gateways/dns-server-points-website.svg&#34;
           loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 4ï¼šæ²¡æœ‰ T1 ç½‘å…³çš„éƒ¨ç½²é…ç½®
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;å½“å¼•å…¥ T1 ç½‘å…³æ—¶ï¼ˆå›¾5ï¼‰ï¼Œå¿…é¡»æ›´æ–° DNS è®°å½•ä»¥æŒ‡å‘ä¸€çº§ç½‘å…³ï¼Œè€Œä¸éœ€è¦å¯¹åº”ç”¨é›†ç¾¤çš„è®¾ç½®è¿›è¡Œä¿®æ”¹ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-5å¸¦æœ‰ä¸€çº§ç½‘å…³çš„å¤šé›†ç¾¤éƒ¨ç½²å®ä¾‹&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 5ï¼šå¸¦æœ‰ä¸€çº§ç½‘å…³çš„å¤šé›†ç¾¤éƒ¨ç½²å®ä¾‹&#34;
           src=&#34;https://lib.jimmysong.io/blog/designing-traffic-flow-via-tier1-and-tier2-ingress-gateways/application-clusters-config.svg&#34;
           loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 5ï¼šå¸¦æœ‰ä¸€çº§ç½‘å…³çš„å¤šé›†ç¾¤éƒ¨ç½²å®ä¾‹
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;div class=&#34;alert-note-title&#34;&gt;
    &lt;p&gt;æ³¨æ„&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;alert alert-note&#34;&gt;
    TSB ä¸æ˜¯ DNS ç®¡ç†å·¥å…·ï¼ŒDNS è®°å½•çš„æ›´æ”¹æ˜¯åœ¨ TSB ä¹‹å¤–è¿›è¡Œçš„ï¼ˆæœ‰å¤šç§è‡ªåŠ¨åŒ–å·¥å…·å’ŒæŠ€æœ¯å¯ç”¨äºè¯¥æ“ä½œ)ã€‚
&lt;/div&gt;

&lt;p&gt;ç„¶è€Œï¼Œåœ¨æ·»åŠ  T2 ç½‘å…³æ—¶ï¼Œä»ä½¿ç”¨ LoadBalancer åˆ‡æ¢åˆ° NodePort æ¶æ„ï¼Œç¡®å®éœ€è¦å¯¹åº”ç”¨é›†ç¾¤è¿›è¡Œè½»å¾®çš„æ”¹å˜ã€‚&lt;/p&gt;
&lt;p&gt;è™½ç„¶ T1 ç½‘å…³ä½œä¸ºåº”ç”¨è¾¹ç¼˜ä¼ å…¥æµé‡çš„å‰ç«¯ï¼Œä½†å®ƒå¯ä»¥éƒ¨ç½²åœ¨ä¸€ä¸ªé«˜å¯ç”¨æ€§çš„é…ç½®ä¸­ï¼ˆå›¾ 6ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-6é«˜å¯ç”¨æ€§é…ç½®ä¸­çš„t1ç½‘å…³&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 6ï¼šé«˜å¯ç”¨æ€§é…ç½®ä¸­çš„T1ç½‘å…³&#34;
           src=&#34;https://lib.jimmysong.io/blog/designing-traffic-flow-via-tier1-and-tier2-ingress-gateways/tier1-gateway-incoming-traffic.svg&#34;
           loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 6ï¼šé«˜å¯ç”¨æ€§é…ç½®ä¸­çš„T1ç½‘å…³
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;åœ¨é«˜å¯ç”¨æ€§æ–¹é¢ï¼Œå¯ä»¥ä½¿ç”¨ T1 ç½‘å…³çš„æ•°é‡æ²¡æœ‰é™åˆ¶ã€‚è¿™ç§çµæ´»çš„æ¶æ„å…è®¸ç”¨æˆ·å»ºç«‹å¼ºå¤§çš„è®¾è®¡ä»¥æ»¡è¶³å¹¿æ³›çš„è¦æ±‚ã€‚&lt;/p&gt;
&lt;h2 id=&#34;summary&#34;&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;æœ¬æ–‡æ¶µç›–äº†æœåŠ¡ç½‘æ ¼æ¶æ„å¸ˆåœ¨ä¼ä¸šç¯å¢ƒä¸­è®¾è®¡ TSB éƒ¨ç½²æ—¶æœ€å¸¸è§çš„æ¶æ„é—®é¢˜ã€‚ä»¥ä¸‹æ˜¯æœ€é‡è¦çš„æ”¶è·ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;TSB T1 å’Œ T2 ç½‘å…³ä½¿ç”¨ Istio å…¥å£ç½‘å…³ Pod å’ŒæœåŠ¡ã€‚è¿™é‡Œæ²¡æœ‰å¼•å…¥é¢å¤–çš„ä¸“æœ‰ç»„ä»¶ã€‚&lt;/li&gt;
&lt;li&gt;TSB æ”¯æŒå¼€æº Istio ä¸­çš„ç½‘å…³æ¨¡å¼ã€‚ä»…ä»…æ˜¯åç§°ä¸Šçš„æ”¹å˜ï¼Œå¦‚ TSB çš„å…¥å£ç½‘å…³è¢«ç§°ä¸º T2 ç½‘å…³ã€‚&lt;/li&gt;
&lt;li&gt;å•ä¸€çš„ç½‘å…³å¯ä»¥ç”¨äºæ‰€æœ‰çš„åº”ç”¨ï¼Œä¹Ÿå¯ä»¥é‡‡ç”¨æŒ‰åº”ç”¨åˆ’åˆ†çš„ç½‘å…³æ¨¡å¼ã€‚&lt;/li&gt;
&lt;li&gt;TSB å¯ä»¥é€šè¿‡åˆ©ç”¨ Kubernetes NodePort è€Œä¸æ˜¯ LoadBalancer è¿›è¡Œé›†ç¾¤å†…é€šä¿¡ï¼Œå‡å°‘ä½¿ç”¨çš„äº‘å‚å•†è´Ÿè½½å‡è¡¡å™¨çš„æ•°é‡ï¼Œä»è€Œé™ä½äº‘è®¡ç®—æˆæœ¬ã€‚&lt;/li&gt;
&lt;li&gt;TSB T1 ç½‘å…³æä¾›è·¨é›†ç¾¤è´Ÿè½½å‡è¡¡åŠŸèƒ½ã€‚&lt;/li&gt;
&lt;li&gt;ç”±äºåœ¨å®æ–½çš„æ—©æœŸé˜¶æ®µå¯èƒ½ä¸éœ€è¦è·¨é›†ç¾¤è´Ÿè½½å‡è¡¡ï¼Œå› æ­¤ T1 ç½‘å…³ä¸éœ€è¦æˆä¸ºåˆå§‹éƒ¨ç½²çš„ä¸€éƒ¨åˆ†ï¼Œå¯ä»¥åœ¨ä»¥åæ·»åŠ ï¼Œå¯¹ç°æœ‰çš„åº”ç”¨ç¨‹åºæ²¡æœ‰é‡å¤§å½±å“ã€‚&lt;/li&gt;
&lt;li&gt;å¤šä¸ª T1 ç½‘å…³å¯ä»¥éƒ¨ç½²åœ¨åŒä¸€ä¸ªåº”ç”¨ç¨‹åºå‰é¢ï¼Œä»¥å®ç°é«˜å¯ç”¨æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>å†™ç»™ Kubernetes å·¥ç¨‹å¸ˆçš„ mTLS æŒ‡å—</title>
      <link>https://lib.jimmysong.io/blog/mtls-guide/</link>
      <pubDate>Thu, 16 Jun 2022 11:00:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/mtls-guide/</guid>
      <description>&lt;h2 id=&#34;ç¼–è€…çš„è¯&#34;&gt;ç¼–è€…çš„è¯&lt;/h2&gt;
&lt;p&gt;æœ¬æ–‡ç¿»è¯‘èŠ‚é€‰è‡ª &lt;a href=&#34;https://buoyant.io/mtls-guide/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;A Kubernetes engineerâ€™s guide to mTLS&lt;/a&gt;ï¼Œä¸ºäº†ä¾¿äºè¯»è€…ç†è§£ï¼Œç¬”è€…å¯¹åŸæ–‡åšäº†ä¸€ç‚¹ä¿®æ”¹ &lt;sup id=&#34;fnref:1&#34;&gt;&lt;a href=&#34;#fn:1&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;1&lt;/a&gt;&lt;/sup&gt;ã€‚å› ä¸ºç¬”è€…æœ€è¿‘åœ¨ç ”ç©¶ Istio ä¸­çš„èº«ä»½è®¤è¯åŠ SPIFFEï¼Œå¯¹å¦‚ä½•åœ¨ Kubernetes ä¸­åº”ç”¨ mTLS ä»¥åŠä¸ºä»€ä¹ˆè¦ä½¿ç”¨ mTLS äº§ç”Ÿäº†æµ“åšçš„å…´è¶£ï¼Œå†å›æƒ³èµ·äº”å¹´å‰æ‰‹åŠ¨å®‰è£… Kubernetes æ—¶ï¼Œå› ä¸ºç»™é›†ç¾¤å¼€å¯ TLS é—®é¢˜è€Œå¯¼è‡´å®‰è£…åœæ»ä¸å‰ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡çš„ä¸»è¦è§‚ç‚¹æ˜¯ï¼šåœ¨ Kubernetes ä¸­æˆ‘ä»¬ä¸èƒ½ä»…ä¾é ç½‘ç»œå±‚åŠ å¯†ï¼Œè¿˜éœ€è¦ mTLS æ¥å¯¹å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯è¿›è¡ŒåŒå‘çš„ä¼ è¾“å±‚è®¤è¯ã€‚æœ¬æ–‡å°†èšç„¦äº TLS çš„çœŸå®æ€§ï¼Œä»¥åŠè¯ä¹¦ç®¡ç†çš„éš¾é¢˜ï¼Œè¯´æ˜æœåŠ¡ç½‘æ ¼å¯¹äºåœ¨ Kubernetes ä¸­å¼€å¯ mTLS å¸¦æ¥çš„ä¾¿åˆ©ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&#34;ç®€ä»‹&#34;&gt;ç®€ä»‹&lt;/h2&gt;
&lt;p&gt;Mutual TLSï¼ˆåŒå‘ TLSï¼‰ï¼Œæˆ–ç§° mTLSï¼Œæ˜¯ Kubernetes ä¸­çš„ä¸€ä¸ªçƒ­é—¨è¯é¢˜ï¼Œå°¤å…¶æ˜¯å¯¹äºé‚£äº›è´Ÿè´£ä¸ºåº”ç”¨ç¨‹åºæä¾›ä¼ è¾“å±‚åŠ å¯†çš„äººæ¥è¯´ã€‚ä½†æ˜¯ï¼Œä½ æœ‰æ²¡æœ‰è€ƒè™‘è¿‡ï¼Œä»€ä¹ˆæ˜¯ mTLSï¼Œå®ƒæä¾›ä»€ä¹ˆæ ·çš„å®‰å…¨ï¼Œä¸ºä»€ä¹ˆéœ€è¦ mTLSï¼Ÿ&lt;/p&gt;
&lt;p&gt;æœ¬æŒ‡å—æˆ‘å°†ä»‹ç»ä»€ä¹ˆæ˜¯ mTLSï¼Œå®ƒä¸å¸¸è§„ TLS çš„å…³ç³»ï¼Œä»¥åŠä¸ºä»€ä¹ˆå®ƒä¸ Kubernetes æœ‰å…³ã€‚æˆ‘è¿˜ä¼šè°ˆè®º mTLS çš„ä¸€äº›ä¼˜ç¼ºç‚¹åŠæ›¿ä»£æ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä»€ä¹ˆæ˜¯-mtls&#34;&gt;ä»€ä¹ˆæ˜¯ mTLSï¼Ÿ&lt;/h2&gt;
&lt;p&gt;å¯¹äºå¸¸è§„ TLSï¼Œåªéœ€è¦æœåŠ¡ç«¯è®¤è¯ï¼ŒmTLS ç›¸å¯¹æ¥è¯´æœ‰ä¸€ä¸ªé¢å¤–çš„è§„å®šï¼šå®¢æˆ·ç«¯ä¹Ÿè¦ç»è¿‡è®¤è¯ã€‚ä½†è¿™æ„å‘³ç€ä»€ä¹ˆï¼Œä¸ºä»€ä¹ˆè¦è¿™æ ·åšå‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;åœ¨å›ç­”è¿™äº›é—®é¢˜ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆå¯¹ TLS æœ‰ä¸€ä¸ªåŸºæœ¬çš„äº†è§£ã€‚TLS æ˜¯ä¸€ä¸ªä¼ è¾“å±‚åè®®ï¼Œæ—¨åœ¨ä¸º TCP è¿æ¥æä¾›å®‰å…¨ä¿éšœï¼ˆæˆ‘ä»¬å°†åœ¨ä¸‹é¢çœ‹åˆ°å®‰å…¨çš„ç¡®åˆ‡å«ä¹‰ï¼‰ã€‚TLS åœ¨ä¼ è¾“å±‚å·¥ä½œï¼Œå¯ä»¥ä¸ä»»ä½•ä½¿ç”¨ TCP çš„åº”ç”¨å±‚åè®®ç»“åˆä½¿ç”¨ã€‚ä¾‹å¦‚ï¼ŒHTTPS æ˜¯ HTTP ä¸ TLS çš„ç»“åˆï¼ˆHTTPS ä¸­çš„ S æŒ‡çš„æ˜¯ SSLï¼Œå³ TLS çš„å‰èº«ï¼‰ï¼ŒHTTP ä¸éœ€è¦åšä»»ä½•æ”¹å˜æ¥é€‚åº” TLS &lt;sup id=&#34;fnref:2&#34;&gt;&lt;a href=&#34;#fn:2&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;2&lt;/a&gt;&lt;/sup&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å› ä¸º TLS ä¸­å­˜åœ¨å„ç§å„æ ·çš„é—®é¢˜ï¼Œä½¿å¾—å…¶ä»å®‰å…¨çš„è§’åº¦æ¥çœ‹æ˜¯ä¸ç†æƒ³çš„ã€‚TLS è§„èŒƒå¤æ‚ï¼Œè€Œä¸”æ²¡æœ‰å¾—åˆ°å……åˆ†çš„è¯´æ˜ï¼Œæœ‰äº›åœ°æ–¹å¹¶æ²¡æœ‰çœŸæ­£çš„æ„ä¹‰ï¼Œè€Œä¸”ä¸ç®¡æ€æ ·ï¼Œå®ç°èµ·æ¥ä¹Ÿä¸ä¼š 100% ç¬¦åˆ TLS è§„èŒƒã€‚&lt;/p&gt;
&lt;p&gt;å°½ç®¡æœ‰è¿™äº›æ‹…å¿§ï¼ŒTLS è¿˜æ˜¯æ— å¤„ä¸åœ¨ã€‚ä½ ç°åœ¨å°±åœ¨ä½¿ç”¨ TLSï¼šè¿™ä¸ªé¡µé¢æ˜¯é€šè¿‡ HTTPS æä¾›çš„ï¼Œä½ å¯èƒ½åœ¨æµè§ˆå™¨çš„ URL æ ä¸­çœ‹åˆ°ä¸€ä¸ªå°é”å›¾æ ‡ã€‚&lt;/p&gt;
&lt;h2 id=&#34;tls-æä¾›ä»€ä¹ˆæ ·çš„å®‰å…¨æ€§&#34;&gt;TLS æä¾›ä»€ä¹ˆæ ·çš„å®‰å…¨æ€§ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;å¤§å¤šæ•°äººæŠŠ TLS ä¸åŠ å¯†è”ç³»èµ·æ¥ã€‚ä½† TLS ä¸ä»…ä»…æ˜¯è¿™æ ·ã€‚TLS ä¸ºè¿æ¥æä¾›äº†ä¸‰ç§å®‰å…¨ä¿è¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;çœŸå®æ€§&lt;/strong&gt;ï¼šä»»ä½•ä¸€æ–¹éƒ½èƒ½è¯æ˜ä»–ä»¬æ˜¯è‡ªå·±æ‰€å£°ç§°çš„èº«ä»½ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ä¿å¯†æ€§&lt;/strong&gt;ï¼šå…¶ä»–äººæ— æ³•çœ‹åˆ°æ­£åœ¨äº¤æ¢çš„æ•°æ®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å®Œæ•´æ€§&lt;/strong&gt;ï¼šæ”¶åˆ°çš„æ•°æ®ä¸å‘é€çš„æ•°æ®ç›¸åŒã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å› æ­¤ï¼Œè™½ç„¶ TLS ç¡®å®ç»™ä½ æä¾›äº†åŠ å¯† â€”â€” è¿™å°±æ˜¯å®ƒå®ç°ä¿å¯†çš„æ–¹å¼ â€”â€” ä½†ä» TLS çš„è§’åº¦æ¥çœ‹ï¼Œè¿™å¯¹å®‰å…¨é€šä¿¡æ¥è¯´æ˜¯ä¸å¤Ÿçš„ï¼šä½ éœ€è¦æ‰€æœ‰è¿™ä¸‰ç§å±æ€§ã€‚å¦‚æœä½ æ²¡æœ‰çœŸå®æ€§ï¼Œé‚£ä¹ˆæœ‰äººå°±å¯ä»¥åœ¨è¿æ¥çš„å¦ä¸€ç«¯è¿›è¡Œæ¬ºéª—ã€‚å¦‚æœä½ æ²¡æœ‰å®Œæ•´æ€§ï¼Œé‚£ä¹ˆæœ‰äººå¯ä»¥ä¿®æ”¹é€šä¿¡ä¸­çš„å…³é”®ä¿¡æ¯ã€‚å¦‚æœä½ æ²¡æœ‰ä¿å¯†æ€§ï¼Œé‚£ä¹ˆä»»ä½•äººéƒ½å¯ä»¥ç›‘å¬ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿™ä¸‰ç§ä¿è¯ä¸­ï¼Œæœ¬æ–‡ä¸»è¦å…³æ³¨çœŸå®æ€§ã€‚&lt;/p&gt;
&lt;h2 id=&#34;mtls-ä»€ä¹ˆæ—¶å€™æœ‰ç”¨&#34;&gt;mTLS ä»€ä¹ˆæ—¶å€™æœ‰ç”¨ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;å›åˆ°æˆ‘ä»¬æœ€åˆçš„å®šä¹‰ï¼šmTLS æ˜¯ç®€å•çš„å¸¸è§„ TLSï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªé¢å¤–çš„è§„å®šï¼Œå³å®¢æˆ·ç«¯ä¹Ÿè¦ç»è¿‡è®¤è¯ã€‚æœ‰äº†å¯¹ TLS çš„åŸºæœ¬äº†è§£ï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥è§£æè¿™ä¸ªå£°æ˜äº†ã€‚TLS ä¿è¯äº†çœŸå®æ€§ï¼Œä½†é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™åªå‘ç”Ÿåœ¨ä¸€ä¸ªæ–¹å‘ä¸Šï¼šå®¢æˆ·ç«¯å¯¹æœåŠ¡å™¨è¿›è¡Œè®¤è¯ï¼Œä½†æœåŠ¡å™¨å¹¶ä¸å¯¹å®¢æˆ·ç«¯è¿›è¡Œè®¤è¯ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºä»€ä¹ˆ TLS çš„é»˜è®¤åªåœ¨ä¸€ä¸ªæ–¹å‘è¿›è¡Œè®¤è¯ï¼Ÿå› ä¸ºå®¢æˆ·ç«¯çš„èº«ä»½å¾€å¾€æ˜¯ä¸ç›¸å…³çš„ã€‚ä¾‹å¦‚ï¼Œåœ¨åŠ è½½è¿™ä¸ªé¡µé¢æ—¶ï¼Œä½ çš„æµè§ˆå™¨å·²ç»éªŒè¯äº†è¦è®¿é—®çš„ç½‘ç«™æœåŠ¡ç«¯çš„èº«ä»½ï¼Œä½†æœåŠ¡ç«¯å¹¶æ²¡æœ‰éªŒè¯ä½ çš„æµè§ˆå™¨çš„èº«ä»½ã€‚å®ƒå®é™…ä¸Šå¹¶ä¸å…³å¿ƒä½ çš„æµè§ˆå™¨çš„èº«ä»½ã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶ï¼Œä¸éªŒè¯å®¢æˆ·ç«¯èº«ä»½å¯¹äºæä¾›ç½‘é¡µæœåŠ¡æ˜¯æœ‰æ„ä¹‰çš„ï¼Œä½†æœ‰å¾ˆå¤šç±»å‹çš„é€šä¿¡ï¼Œå®¢æˆ·ç«¯çš„èº«ä»½ä¹Ÿå¾ˆé‡è¦ã€‚ä¾‹å¦‚ API è°ƒç”¨ï¼šå¦‚æœä½ è°ƒç”¨åƒ GitHub è¿™æ ·çš„æœåŠ¡ï¼Œé‚£ä¹ˆ GitHub éœ€è¦çŸ¥é“ä½ æ˜¯è° â€”â€” é™¤å…¶ä»–åŸå› å¤–ï¼Œè¿™æ ·ä»–ä»¬å°±å¯ä»¥ç»™ä½ å‘é€è´¦å•ã€‚å¦‚æœä¸å‘ GitHub æä¾›æŸç§å®¢æˆ·ç«¯èº«ä»½ï¼Œä½ å°±ä¸èƒ½å¯¹ GitHub çš„ API è¿›è¡Œè°ƒç”¨ã€‚&lt;/p&gt;
&lt;p&gt;ä½† GitHub å¹¶ä¸ä½¿ç”¨ mTLSã€‚ç›¸åï¼Œä½ é€šè¿‡ç»™ GitHub ä¸€ä¸ªç§˜å¯†çš„è®¤è¯ä»¤ç‰Œï¼ˆtokenï¼‰æ¥è®¤è¯è‡ªå·±ï¼Œè¿™ä¸ªä»¤ç‰Œæ˜¯åˆ›å»ºè´¦æˆ·æ—¶åˆ†é…ç»™ä½ çš„ã€‚å¦ç‡åœ°è¯´ï¼ŒmTLS è®¾ç½®èµ·æ¥å¾ˆçƒ¦äººï¼ˆåé¢ä¼šæœ‰å¾ˆå¤šè¿™æ–¹é¢çš„å†…å®¹ï¼‰ï¼Œæ‰€ä»¥å¦‚æœä½ æä¾›åƒ GitHub è¿™æ ·çš„å…¬å…± APIï¼Œä½ å¯èƒ½ä¼šåªä½¿ç”¨ auth tokenã€‚&lt;/p&gt;
&lt;p&gt;ç„¶è€Œï¼Œä½¿ç”¨ mTLS çš„è®¤è¯æœ‰ä¸€äº›éå¸¸å¼ºå¤§çš„ auth token æ–¹æ³•æ²¡æœ‰çš„ä¼˜åŠ¿ã€‚é¦–å…ˆï¼ŒmTLS è®¤è¯å¯ä»¥å®Œå…¨åœ¨åº”ç”¨ç¨‹åºä¹‹å¤–å®Œæˆï¼Œä¸éœ€è¦ä»»ä½•åº”ç”¨ç¨‹åºçº§åˆ«çš„åŠŸèƒ½æ¥åˆ›å»ºã€æ³¨å†Œæˆ–ç®¡ç†èº«ä»½ã€‚ä½¿ç”¨ auth token æ—¶ï¼Œåœ¨ä½ è¿›è¡Œç¬¬ä¸€æ¬¡ GitHub API è°ƒç”¨ä¹‹å‰ï¼Œä½ éœ€è¦ç™»å½•ç½‘ç«™ï¼Œåˆ›å»ºä¸€ä¸ªè´¦æˆ·ï¼Œè·å¾—ä»¤ç‰Œ &lt;sup id=&#34;fnref:3&#34;&gt;&lt;a href=&#34;#fn:3&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;3&lt;/a&gt;&lt;/sup&gt;ã€‚GitHub çš„ API å¿…é¡»çŸ¥é“è¿™ä¸ª auth tokenï¼Œå¹¶æä¾›å°†å…¶ä¼ é€’ç»™ API è°ƒç”¨å’Œç®¡ç†å®ƒçš„æ–¹æ³•ã€‚ä½†æœ‰äº† mTLSï¼Œä¸€ä¸ªå…¨æ–°çš„å®¢æˆ·ç«¯å°±å¯ä»¥ç›´æ¥è®¤è¯è‡ªå·±ï¼Œå³ä½¿ä»æ²¡æœ‰äººè§è¿‡å®ƒã€‚è€Œåº”ç”¨ç¨‹åºä¸éœ€è¦çŸ¥é“ä»»ä½•å…³äºè®¤è¯çš„äº‹æƒ…ï¼Œä¹Ÿä¸éœ€è¦æä¾›ç«¯ç‚¹æ¥ç®¡ç†è®¤è¯ã€‚&lt;/p&gt;
&lt;p&gt;ç»¼ä¸Šæ‰€è¿°ï¼Œæˆ‘ä»¬çœ‹åˆ° mTLS éå¸¸é€‚åˆä»¥ä¸‹æƒ…å†µï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä½ éœ€è¦å®‰å…¨é€šä¿¡ï¼›&lt;/li&gt;
&lt;li&gt;ä½ å…³å¿ƒå®¢æˆ·ç«¯çš„èº«ä»½ï¼›&lt;/li&gt;
&lt;li&gt;ä¸æƒ³ä¸ºç®¡ç†èº«ä»½å»ºç«‹åº”ç”¨çº§æµç¨‹ï¼›&lt;/li&gt;
&lt;li&gt;ä½ å¯ä»¥ç®¡ç†å®é™…å®æ–½çš„å¤æ‚æ€§ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æœ‰ç§åœºæ™¯å…·æœ‰æ‰€æœ‰è¿™äº›ç‰¹å¾ï¼Œé‚£å°±æ˜¯å¾®æœåŠ¡ï¼&lt;/p&gt;
&lt;h2 id=&#34;ä½¿ç”¨-mtls-æ¥ä¿æŠ¤å¾®æœåŠ¡çš„å®‰å…¨&#34;&gt;ä½¿ç”¨ mTLS æ¥ä¿æŠ¤å¾®æœåŠ¡çš„å®‰å…¨&lt;/h2&gt;
&lt;p&gt;mTLS æ˜¯ä¿è¯å¾®æœåŠ¡ä¹‹é—´è·¨æœåŠ¡é€šä¿¡å®‰å…¨çš„å¥½æ–¹æ³•ï¼ŒåŸå› å°±åœ¨ä¸Šé¢ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆï¼Œä½ æƒ³è¦å®‰å…¨çš„é€šä¿¡ã€‚å½“æˆ‘ä»¬æŠŠæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºæ‹†åˆ†ä¸ºå¤šä¸ªæœåŠ¡æ—¶ï¼Œæˆ‘ä»¬æœ€ç»ˆä¼šåœ¨è¿™äº›æœåŠ¡ä¹‹é—´çš„ç½‘ç»œä¸Šå‘é€æ•æ„Ÿæ•°æ®ã€‚ä»»ä½•èƒ½å¤Ÿè¿›å…¥ç½‘ç»œçš„äººéƒ½æœ‰å¯èƒ½è¯»å–è¿™äº›æ•æ„Ÿæ•°æ®å¹¶ä¼ªé€ è¯·æ±‚ã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬äºŒï¼Œä½ å…³å¿ƒå®¢æˆ·ç«¯çš„èº«ä»½ã€‚é¦–å…ˆï¼Œä½ è¦ç¡®ä¿ä½ èƒ½çŸ¥é“è°ƒç”¨æ˜¯ä»€ä¹ˆæ—¶å€™å‘ç”Ÿçš„ï¼Œä»¥ä¾¿è¿›è¡Œè¯Šæ–­ï¼Œå¹¶æ­£ç¡®è®°å½•æŒ‡æ ‡ç­‰äº‹é¡¹ã€‚æ­¤å¤–ï¼Œä½ å¯èƒ½æƒ³å¯¹è¿™äº›èº«ä»½è¿›è¡Œæˆæƒï¼ˆå…è®¸ A è°ƒç”¨ B å—ï¼‰ã€‚æˆ‘ä»¬å°†åœ¨åé¢è®¨è®ºæ›´å¤šå…³äºæˆæƒçš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸‰ï¼Œä½ å¹¶ä¸çœŸçš„æƒ³ä¸ºç®¡ç†æœåŠ¡èº«ä»½å»ºç«‹åº”ç”¨çº§çš„æµç¨‹ã€‚è¿™ä¸æ˜¯ä¸šåŠ¡é€»è¾‘ï¼Œå¼€å‘äººå‘˜çš„æ—¶é—´æœ€å¥½ç”¨åœ¨å…¶ä»–åœ°æ–¹ã€‚&lt;/p&gt;
&lt;p&gt;æœ€åï¼Œå¦‚æœä½ æ§åˆ¶äº†å¹³å°ï¼Œä½ å®é™…ä¸Šå¯ä»¥ç®¡ç†å®æ–½ mTLS çš„å¤æ‚æ€§ã€‚æˆ–è€…è‡³å°‘ï¼Œæ¯” GitHub åšå¾—æ›´å¥½ã€‚åœ¨æˆ‘ä»¬çš„ GitHub ä¾‹å­ä¸­ï¼Œæ¯ä¸ªç”¨æˆ·éƒ½å¿…é¡»è§£å†³å¯¹ GitHub è¿›è¡Œèº«ä»½éªŒè¯çš„éš¾é¢˜ã€‚è¿™ä¸ªæŒ‘æˆ˜è¶Šéš¾ï¼Œå¯¹ç”¨æˆ·å°±è¶Šä¸åˆ©ï¼ˆå¯¹ GitHub çš„åº•çº¿ä¹Ÿè¶Šä¸åˆ©ï¼‰ã€‚ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬èƒ½åœ¨å¹³å°å±‚é¢ä¸Šå®ç° mTLSï¼Œæˆ‘ä»¬å°±èƒ½ä¸€æ¬¡æ€§æ”¯ä»˜æˆæœ¬ï¼Œè€Œä¸æ˜¯ä¸ºæ¯ä¸ªæœåŠ¡æˆ–æ¯ä¸ªç”¨æˆ·æ”¯ä»˜ã€‚&lt;/p&gt;
&lt;p&gt;ç»¼ä¸Šæ‰€è¿°ï¼ŒmTLS éå¸¸é€‚ç”¨äºç¡®ä¿å¾®æœåŠ¡ä¹‹é—´çš„é€šä¿¡å®‰å…¨ã€‚ä½†æ˜¯æœ‰ä¸€ä¸ªé—®é¢˜ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å®æ–½-tls-çš„éš¾ç‚¹è¯ä¹¦ç®¡ç†&#34;&gt;å®æ–½ TLS çš„éš¾ç‚¹ï¼šè¯ä¹¦ç®¡ç†&lt;/h2&gt;
&lt;p&gt;åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»ä¸º mTLS æç»˜äº†ä¸€å¹…ç¾å¥½çš„å›¾æ™¯ã€‚å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨æ„‰å¿«åœ°ç›¸äº’è®¤è¯ï¼Œç„¶åå®ƒä»¬ä¹‹é—´çš„é€šä¿¡å°±å®‰å…¨äº†ã€‚åœ¨å®è·µä¸­ï¼Œé˜»ç¢ mTLS å·¥ä½œçš„æœ€å¤§æŒ‘æˆ˜æ˜¯&lt;strong&gt;è¯ä¹¦ç®¡ç†&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;TLS ä¸­çš„è®¤è¯æ˜¯é€šè¿‡ &lt;strong&gt;å…¬é’¥å¯†ç å­¦&lt;/strong&gt;å’Œ&lt;strong&gt;å…¬é’¥åŸºç¡€è®¾æ–½ï¼ˆPKIï¼‰è¿›è¡Œçš„&lt;/strong&gt; ã€‚è¿™ä¸¤è€…æœ¬èº«å°±æ˜¯ä¸€ä¸ªå·¨å¤§çš„è¯é¢˜ï¼Œåœ¨è¿™ç¯‡æ–‡ç« ä¸­æˆ‘ä»¬ä¸ä¼šå»è®¨è®ºè¿™äº›ç»†èŠ‚ã€‚ä½†ç®€è€Œè¨€ä¹‹ï¼Œå®ƒä»¬æ¶‰åŠå¤§é‡çš„è¯ä¹¦ã€‚&lt;/p&gt;
&lt;p&gt;TLS è®¤è¯åŸºäº X.509 è¯ä¹¦ã€‚X.509 è¯ä¹¦ä¸­åŒ…å«&lt;strong&gt;èº«ä»½&lt;/strong&gt;å’Œ&lt;strong&gt;å…¬é’¥&lt;/strong&gt;ã€‚å…¬é’¥æœ‰ä¸€ä¸ªç›¸åº”çš„&lt;strong&gt;ç§é’¥&lt;/strong&gt;ï¼Œå®ƒä¸æ˜¯è¯ä¹¦çš„ä¸€éƒ¨åˆ†ã€‚TLS è®¤è¯åˆ†ä¸¤æ­¥ï¼Œç¬¬ä¸€æ­¥æ˜¯å‘å¯¹æ–¹å±•ç¤ºä½ çš„è¯ä¹¦ï¼Œç„¶åç”¨ç§é’¥æ¥è¯æ˜è¯ä¹¦ä¸­åŒ…å«çš„èº«ä»½å±äºä½ ï¼ˆå…¬é’¥å¯†ç å­¦çš„ç¥å¥‡ä¹‹å¤„åœ¨äºï¼Œä»»ä½•å¤åˆ¶è¯ä¹¦çš„äººéƒ½æ— æ³•è¿›è¡Œè¿™ç§è¯æ˜ï¼Œå› ä¸ºä»–ä»¬æ²¡æœ‰ç§é’¥ã€‚å› æ­¤ï¼Œä½ å¯ä»¥éå¸¸è‡ªç”±åœ°ä½¿ç”¨è¯ä¹¦ï¼ŒåŒ…æ‹¬é€šè¿‡æ˜æ–‡æ¸ é“å‘é€è¯ä¹¦æˆ–å°†å…¶å­˜å‚¨åœ¨å…¬å¼€åœºåˆï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;X.509 è¯ä¹¦æ˜¯ç”±ä¸€ä¸ª &lt;strong&gt;è¯ä¹¦æˆæƒæœºæ„ï¼ˆCertificate Authorityï¼Œç®€ç§° CAï¼‰&lt;/strong&gt; ç­¾ç½²ï¼Œå…¶ä¸­åŒ…æ‹¬å— CA ä¿¡ä»»è¯¥çš„èº«ä»½ã€‚è¯ä¹¦ç”¨äº TLS è®¤è¯çš„ç¬¬äºŒæ­¥ï¼šå¦‚æœæœ‰äººå‘ä½ å±•ç¤ºä»–ä»¬çš„èº«ä»½å¹¶è¯æ˜ä»–ä»¬æ‹¥æœ‰è¯¥èº«ä»½ï¼Œä½ ç°åœ¨å¿…é¡»å†³å®šæ˜¯å¦ä¿¡ä»»è¯¥èº«ä»½ã€‚TLS åœ¨è¿™é‡Œä½¿ç”¨äº†ä¸€ä¸ªç®€å•çš„è§„åˆ™ï¼šå¦‚æœè¯ä¹¦æ˜¯ç”± CA ç­¾ç½²çš„ï¼Œä¸”ä½ ä¿¡ä»»è¯¥ CAï¼Œé‚£ä¹ˆä½ å°±åº”è¯¥ä¿¡ä»»è¯¥èº«ä»½ã€‚å¦‚ä½•éªŒè¯ CA å¯¹è¯ä¹¦çš„ç­¾åï¼Ÿé€šè¿‡ä½¿ç”¨è¯¥ CA æœ¬èº«çš„ X.509 è¯ä¹¦ã€‚æ€ä¹ˆçŸ¥é“æ˜¯å¦åº”è¯¥ä¿¡ä»»è¯¥ CAï¼Ÿå—¯ï¼Œè¿™ä¸ªå°±ä¸ TLS åè®®æœ¬èº«æ— å…³ï¼Œä½ ä¼šè¢«å¤–ç•Œå‘ŠçŸ¥åº”è¯¥ä¿¡ä»»å®ƒ &lt;sup id=&#34;fnref:4&#34;&gt;&lt;a href=&#34;#fn:4&#34; class=&#34;footnote-ref&#34; role=&#34;doc-noteref&#34;&gt;4&lt;/a&gt;&lt;/sup&gt;ã€‚&lt;/p&gt;
&lt;p&gt;CA ä¹Ÿç­¾å‘è¯ä¹¦ã€‚è¦è·å¾—è¯ä¹¦ï¼Œä½ é¦–å…ˆè¦åˆ›å»ºå…¬é’¥å’Œç§é’¥å¯¹ã€‚ä½ ä¿ç•™ç§é’¥ï¼Œå—¯ï¼Œç§é’¥ â€”â€” åƒä¸‡ä¸è¦åœ¨ç½‘ç»œä¸Šå‘é€ç§é’¥ â€”â€” ä½ å‘ CA å‘é€ä¸€ä¸ªåŒ…å«å…¬é’¥å’Œä½ èº«ä»½çš„&lt;strong&gt;è¯ä¹¦ç­¾åè¯·æ±‚ï¼ˆCertificate Signing Requestï¼Œç®€ç§° CSRï¼‰&lt;/strong&gt;ã€‚å¦‚æœ CA æ‰¹å‡†äº†è¿™ä¸ªè¯·æ±‚ï¼Œå®ƒå°±ä¼šåˆ›å»ºå’Œç­¾ç½²è¯ä¹¦ï¼Œå¹¶æŠŠè¯ä¹¦å‘é€ç»™ä½ ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œè¯ä¹¦ç®¡ç†å°±æ˜¯å°±æˆäº†è¯ä¹¦åˆ›å»ºå’Œåˆ†å‘æµç¨‹ä¸­çš„æŒ‘æˆ˜ã€‚æˆ‘ä»¬éœ€è¦ç¡®ä¿æœ‰ä¸€ä¸ª CAï¼Œæ¯ä¸ªæœåŠ¡éƒ½å¯ä»¥å‘å…¶å‘é€ CSRï¼Œè€Œä¸” CA å¯ä»¥æŠŠè¯ä¹¦å‘é€ç»™æœåŠ¡ã€‚æˆ‘ä»¬è¿˜éœ€è¦ç¡®ä¿ CA çš„å®‰å…¨ï¼Œæ²¡æœ‰äººèƒ½å¤Ÿè®¿é—®ä»»ä½•æœåŠ¡çš„ç§é’¥ï¼Œè€Œä¸”æ¯ä¸ªæœåŠ¡éƒ½çŸ¥é“è‡ªå·±çš„èº«ä»½ï¼Œè€Œä¸”ä¸èƒ½è¢«æ”¹å˜ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ Kubernetes è¿™æ ·çš„ç¯å¢ƒä¸­ï¼ŒæœåŠ¡å®é™…ä¸Šæ˜¯ä¸€ç»„ä¸æ–­å˜åŒ–çš„å‰¯æœ¬ï¼Œå¯ä»¥éšæ—¶åˆ›å»ºæˆ–é”€æ¯ï¼Œæ¯ä¸ªå‰¯æœ¬éƒ½éœ€è¦è‡ªå·±çš„è¯ä¹¦ï¼Œè¿™ä½¿å¾—è¯ä¹¦åˆ†å‘çš„æŒ‘æˆ˜æ›´åŠ ä¸¥å³»ã€‚&lt;/p&gt;
&lt;p&gt;è€Œä¸”ï¼Œç”±äºåœ¨å®è·µä¸­ï¼Œå‡å°‘è¯ä¹¦æš´éœ²æŸå¤±ï¼ˆå³å½“æœ‰äººæœªç»æˆæƒè·å¾—ç§˜é’¥æ—¶ï¼‰çš„æœ€å¥½æ–¹æ³•æ˜¯&lt;strong&gt;è¯ä¹¦è½®æ¢&lt;/strong&gt;ï¼šç¼©çŸ­è¯ä¹¦çš„å¯¿å‘½ï¼Œåœ¨è¯ä¹¦è¿‡æœŸå‰é‡æ–°é¢å‘ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬éœ€è¦æ¯éš” n å°æ—¶ä¸ºæ¯ä¸ªå‰¯æœ¬é‡å¤æ•´ä¸ªè¯ä¹¦è¯·æ±‚å’Œç­¾åçš„æµç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæˆ‘ä»¬æƒ³åœ¨å¤šä¸ªé›†ç¾¤ä¹‹é—´æ‰©å±•å®‰å…¨é€šä¿¡ï¼Œéœ€è¦ä¸€ç§æ–¹æ³•æ¥ç¡®ä¿åœ¨ä¸€ä¸ªé›†ç¾¤ä¸­äº§ç”Ÿçš„èº«ä»½å¯ä»¥è¢«å…¶ä»–é›†ç¾¤æ‰€ä½¿ç”¨ï¼Œè€Œä¸”å¦‚æœæŸä¸ªé›†ç¾¤è¢«ç ´åï¼Œæˆ‘ä»¬å¯ä»¥ç¦ç”¨è¯¥é›†ç¾¤è€Œä¸ç¦ç”¨å…¶ä»–é›†ç¾¤ï¼Œè¿™å°±è¿›ä¸€æ­¥å¢åŠ äº†è¯ä¹¦ç®¡ç†çš„å¤æ‚æ€§ï¼Œå› ä¸ºè¿™å°†äº§ç”Ÿæ›´å¤šçš„è¯ä¹¦ã€‚&lt;/p&gt;
&lt;p&gt;æ€»ä¹‹ï¼Œå®æ–½ mTLS æ¶‰åŠåˆ°ç®¡ç†å¤§é‡çš„è¯ä¹¦ï¼Œæ¶ˆè€—å¤§é‡çš„æ—¶é—´ã€‚è¿™ä¸€æŒ‘æˆ˜çš„å¤æ‚æ€§ä»¤äººç”Ÿç•ã€‚ä½†å°½ç®¡å¦‚æ­¤ï¼ŒmTLS åœ¨ Kubernetes çš„ä¸–ç•Œé‡Œå·²ç»çœ‹åˆ°äº†ä¸€äº›å¤å…´çš„è¶‹åŠ¿ã€‚è¿™æ˜¯å› ä¸ºæœ‰ä¸€é—¨æŠ€æœ¯ä½¿ mTLS å˜å¾—å¯è¡Œï¼šæœåŠ¡ç½‘æ ¼ã€‚&lt;/p&gt;
&lt;h2 id=&#34;kubernetesmtls-å’ŒæœåŠ¡ç½‘æ ¼&#34;&gt;Kubernetesã€mTLS å’ŒæœåŠ¡ç½‘æ ¼&lt;/h2&gt;
&lt;p&gt;æœåŠ¡ç½‘æ ¼æ˜¯ä¸ºé›†ç¾¤å¼€å¯ mTLS çš„ä¸€ä¸ªç»ä½³çš„æœºåˆ¶ã€‚å®ƒä¸ä»…å¯ä»¥å¤„ç†è¯ä¹¦ç®¡ç†çš„æŒ‘æˆ˜ï¼Œè¿˜å¯ä»¥å¤„ç†å»ºç«‹å’Œæ¥æ”¶ TLS è¿æ¥æœ¬èº«ã€‚å®ƒä½¿å¾—ä¸ºé›†ç¾¤æ·»åŠ  mTLS æˆä¸ºä¸€ä¸ªé›¶é…ç½®çš„æ“ä½œï¼šå½“ä½ åœ¨ Kubernetes é›†ç¾¤ä¸Šå®‰è£…æœåŠ¡ç½‘æ ¼çš„æ—¶å€™ï¼Œç½‘æ ¼åŒ–çš„ pod ä¹‹é—´çš„æ‰€æœ‰é€šä¿¡éƒ½è‡ªåŠ¨è¢« mTLS åŒ–ã€‚å¯¹äºåƒ mTLS è¿™æ ·å¤æ‚çš„ä¸œè¥¿æ¥è¯´ï¼Œè¿™æ˜¯å¾ˆä¸å¯æ€è®®çš„ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸€åˆ‡ä¹‹æ‰€ä»¥èƒ½å¤Ÿå®ç°ï¼Œæ˜¯å› ä¸º Kubernetes ä½¿ä¸€äº›æœ¬æ¥éå¸¸å¤æ‚çš„äº‹æƒ…ï¼Œå¦‚ sidecar æ¨¡å¼ï¼Œå˜å¾—ç®€å•æ˜“è¡Œã€‚å¾—ç›Šäº Kubernetesï¼ŒæœåŠ¡ç½‘æ ¼å¯ä»¥ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é€æ˜åœ°å°†ä¸€ä¸ª sidecar ä»£ç†æ³¨å…¥åˆ°æ¯ä¸ªåº”ç”¨ç¨‹åºçš„ pod ä¸­ï¼Œå¹¶é€šè¿‡è¯¥ä»£ç†è·¯ç”±æ‰€æœ‰è¿›å‡º pod çš„ TCP é€šä¿¡ã€‚&lt;/li&gt;
&lt;li&gt;å°†ä¸€ä¸ªå†…éƒ¨ CA ä½œä¸ºå…¶æ§åˆ¶å¹³é¢çš„ä¸€éƒ¨åˆ†ï¼Œç­¾å‘ TLS è¯ä¹¦ï¼Œå¹¶å°†è¯¥ CA çš„è¯ä¹¦å®‰å…¨åœ°åˆ†é…ç»™æ‰€æœ‰ä»£ç†ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨è¿™ä¸ª CA å‘æ¯ä¸ªä»£ç†å‘æ”¾çŸ­æœŸçš„è¯ä¹¦ï¼Œä¸ pod çš„ Kubernetes ServiceAccount èº«ä»½ç›¸è”ç³»ã€‚&lt;/li&gt;
&lt;li&gt;æ¯éš” N å°æ—¶é‡æ–°ç­¾å‘è¿™äº›è¯ä¹¦ã€‚&lt;/li&gt;
&lt;li&gt;è®©æ¯ä¸ªä»£ç†å¯¹æ‰€æœ‰ä½¿ç”¨è¿™äº›è¯ä¹¦çš„ pod çš„è¿æ¥æ‰§è¡Œ mTLSï¼Œç¡®ä¿å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨åŒæ–¹éƒ½æœ‰æœ‰æ•ˆçš„èº«ä»½ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨è¿æ¥è¿›å…¥åº”ç”¨ç¨‹åºä¹‹å‰ï¼Œä½¿ç”¨è¿™äº›èº«ä»½åº”ç”¨æˆæƒç­–ç•¥ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å½“ç„¶ï¼Œè¿™åªæ˜¯ä¸€ç§ç®€åŒ–çš„æè¿°ã€‚ä¾‹å¦‚ï¼ŒLinkerd å®é™…ä¸Šä½¿ç”¨äº†ä¸¤çº§ CAï¼Œä¸€ä¸ªåœ¨é›†ç¾¤å±‚é¢ï¼Œä¸€ä¸ªåœ¨å…¨å±€å±‚é¢ï¼Œä»¥ä¾¿å…è®¸è·¨é›†ç¾¤é€šä¿¡ã€‚Linkerd å¯ä»¥ä½¿ç”¨å¤šä¸ªä¿¡ä»»æ ¹ï¼Œæ‰€ä»¥ä½ ä¹Ÿå¯ä»¥è½®æµä½¿ç”¨ CAã€‚&lt;/p&gt;
&lt;h2 id=&#34;å¸¸è§é—®é¢˜mtls-å®é™…ä¸Šèƒ½ä¿æŠ¤ä»€ä¹ˆ&#34;&gt;å¸¸è§é—®é¢˜ï¼šmTLS å®é™…ä¸Šèƒ½ä¿æŠ¤ä»€ä¹ˆï¼Ÿ&lt;/h2&gt;
&lt;p&gt;äº‹å®ä¸Šï¼ŒmTLS åªèƒ½ç”¨äºé˜²æ­¢ç‰¹å®šçš„æ”»å‡»ï¼šæœªç»æˆæƒçš„ç½‘ç»œè®¿é—®ã€‚é˜»æ­¢å…¥ä¾µè€…å—…æ¢ç½‘ç»œè¯·æ±‚ä¸­çš„å†…å®¹ï¼Œé˜»æ­¢å†’å……æœåŠ¡è¿›è¡Œè®¿é—®ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯æœ‰å¾ˆå¤šä¸œè¥¿æ˜¯ mTLS ä¸èƒ½ä¿æŠ¤çš„ï¼Œä¾‹å¦‚æœªç»æˆæƒä¸»æœºè®¿é—®ã€‚å¦‚æœé»‘å®¢å…¥ä¾µè¿›äº†ä¸»æœºï¼ŒmTLS ä¿æŠ¤å°±æ— æµäºäº‹äº†ï¼šå…¥ä¾µè€…å¯ä»¥è¯»å–å¯†åŒ™ï¼Œå—…æ¢æˆ–æ¬ºéª—è¿æ¥ï¼Œé¢ è¦† CA å¹¶é€ æˆç ´åï¼Œæˆ–ä»»ä½•å…¶ä»–æ¶æ„æ´»åŠ¨ã€‚&lt;/p&gt;
&lt;p&gt;ç¡®ä¿ Kubernetes çš„å®‰å…¨å¹¶ä¸å®¹æ˜“ï¼Œå®é™…ä¸Š mTLS åªè§£å†³äº† Kubernetes çš„ä¸€å°éƒ¨åˆ†å®‰å…¨æ¼æ´ã€‚&lt;/p&gt;
&lt;h2 id=&#34;mtls-ä¸-ipsec-æˆ–-wireguard-ç­‰ç½‘ç»œå±‚åŠ å¯†ç›¸æ¯”æ€ä¹ˆæ ·&#34;&gt;mTLS ä¸ IPSec æˆ– Wireguard ç­‰ç½‘ç»œå±‚åŠ å¯†ç›¸æ¯”æ€ä¹ˆæ ·ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;åœ¨ Kubernetes ä¸­ï¼Œä¸€äº› CNI æ’ä»¶å¦‚ Calico å’Œ Cilium å¯ä»¥é€šè¿‡ IPSec æˆ– Wireguard ç­‰åè®®æä¾›ç½‘ç»œå±‚åŠ å¯†ã€‚åƒæœåŠ¡ç½‘æ ¼ä¸€æ ·ï¼Œè¿™ç§ç½‘ç»œå±‚åŠ å¯†å¯ä»¥æä¾›ä¼ è¾“å±‚åŠ å¯†ï¼Œè€Œåº”ç”¨ç¨‹åºæœ¬èº«ä¸éœ€è¦åšä»»ä½•äº‹æƒ…ã€‚&lt;/p&gt;
&lt;p&gt;è™½ç„¶ç½‘ç»œå±‚åŠ å¯†å¯ä»¥ä¸ mTLS ç»“åˆä½¿ç”¨ï¼Œä½œä¸ºä¸€ç§æ·±åº¦é˜²å¾¡çš„å½¢å¼ï¼Œä½†æœ‰å‡ ä¸ªåŸå› å¯ä»¥è¯´æ˜ç½‘ç»œå±‚åŠ å¯†ä¸è¶³ä»¥æ›¿ä»£ mTLSã€‚&lt;/p&gt;
&lt;p&gt;å¦‚ä½ æ‰€æ–™ï¼Œç½‘ç»œå±‚åŠ å¯†çš„æœ€å¤§ç¼ºç‚¹æ˜¯å›´ç»•èº«ä»½çš„ã€‚å› ä¸ºå®ƒä»¬åœ¨ç½‘ç»œå±‚å·¥ä½œï¼ŒWireguard å’Œ IPSec åªèƒ½æä¾›ç½‘ç»œèº«ä»½ï¼Œè€Œä¸æ˜¯å·¥ä½œè´Ÿè½½èº«ä»½ã€‚æ¢å¥è¯è¯´ï¼Œå®ƒä»¬ä¸æ˜¯ä½¿ç”¨å·¥ä½œè´Ÿè½½æœ¬èº«å›ºæœ‰çš„èº«ä»½ï¼ˆæ¯”å¦‚ &lt;a href=&#34;https://spiffe.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SPIFFE&lt;/a&gt; æˆ–è€… Kubernetes çš„ ServiceAccountï¼‰ï¼Œè€Œæ˜¯ä½¿ç”¨è¯¥å·¥ä½œè´Ÿè½½è¿è¡Œçš„ IP åœ°å€ã€‚&lt;/p&gt;
&lt;p&gt;ä¾é ç½‘ç»œèº«ä»½æœ‰ä¸€ç³»åˆ—çš„é—®é¢˜ï¼ŒåŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;èº«ä»½ç»ˆæ­¢åœ¨é›†ç¾¤è¾¹ç•Œã€‚Kubernetes ä¸­çš„ IP åœ°å€æ˜¯ä»¥é›†ç¾¤ä¸ºèŒƒå›´çš„ï¼Œå½“è·¨è¶Šé›†ç¾¤è¾¹ç•Œçš„æ—¶å€™ï¼Œä½ å°±å¿…é¡»æƒ³å‡ºå¦ä¸€ç§èº«ä»½æœºåˆ¶ã€‚å› æ­¤ï¼Œå¦‚æœä½ æ­£åœ¨è¿›è¡Œè·¨é›†ç¾¤é€šä¿¡ï¼Œæˆ–è€…æƒ³è¦ä¸€ä¸ªæ¶µç›–é Kubernetes å·¥ä½œè´Ÿè½½çš„èº«ä»½ç³»ç»Ÿï¼ŒIP åœ°å€å°±ä¼šè½ç©ºã€‚&lt;/li&gt;
&lt;li&gt;æ²¡æœ‰ç›´æ¥çš„æœºåˆ¶è¿›è¡Œç»†ç²’åº¦çš„æˆæƒã€‚ç½‘ç»œå±‚æ–¹æ³•ä¸èƒ½è®¿é—®ä¸ƒå±‚ä¿¡æ¯ï¼Œå¦‚ HTTP è·¯ç”±ã€åŠ¨è¯ä»¥åŠ gRPC æ–¹æ³•ï¼ˆæœ‰äº›å¤æ‚çš„ CNI é€šè¿‡å¯åŠ¨ä¸€ä¸ªä¸ƒå±‚ä»£ç†æ¥è§£ææ•°æ®ï¼Œä»¥æœåŠ¡ç½‘æ ¼æ¨¡å¼æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;è¿™ä¸æ˜¯é›¶ä¿¡ä»»ã€‚é›¶ä¿¡ä»»çš„å®‰å…¨æ¨¡å¼è¦æ±‚æˆ‘ä»¬å°†å®‰å…¨è¾¹ç•Œè½¬ç§»åˆ°å°½å¯èƒ½ç»†çš„å±‚æ¬¡ã€‚åœ¨ Kubernetes ä¸­ï¼Œè¿™ä¸ªå•ä½å°±æ˜¯ podã€‚æœ‰äº†æœåŠ¡ç½‘æ ¼çš„ mTLSï¼Œä½ çš„å®‰å…¨è¾¹ç•Œå°±åœ¨ pod å±‚é¢ï¼Œä½†å¯¹äºç½‘ç»œå±‚çš„åŠ å¯†ï¼Œä½ çš„å®‰å…¨è¾¹ç•Œæœ€å¤šåªèƒ½åœ¨ä¸»æœºå±‚é¢æ‰§è¡Œï¼›ä½ å¿…é¡»ä¿¡ä»»ç½‘ç»œï¼Œç­‰ç­‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç”±äºè¿™äº›åŸå› ï¼Œåœ¨ Kubernetes ä¸­ mTLS ä¸ºä½ æä¾›äº†æ¯”ä»…ä»…ä¾é ç½‘ç»œå±‚åŠ å¯†æ›´å¥½çš„å®‰å…¨æ€åŠ¿ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å‚è€ƒ&#34;&gt;å‚è€ƒ&lt;/h2&gt;
&lt;div class=&#34;footnotes&#34; role=&#34;doc-endnotes&#34;&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id=&#34;fn:1&#34;&gt;
&lt;p&gt;æœ¬æ–‡åˆ é™¤äº†åŸæ–‡ä¸­çš„ Linkerd å®‰è£…çš„éƒ¨åˆ†ï¼Œå°† Twillio æ›¿æ¢æˆå›½å†…è¯»è€…æ¯”è¾ƒç†Ÿæ‚‰çš„ GitHubã€‚&amp;#160;&lt;a href=&#34;#fnref:1&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:2&#34;&gt;
&lt;p&gt;è‡³å°‘ï¼Œåœ¨åè®®å±‚é¢ã€‚åœ¨å®è·µä¸­ï¼Œéšç€ HTTPS çš„å¼•å…¥ï¼ŒHTTP çš„ä½¿ç”¨æ–¹å¼è‚¯å®šå·²ç»å‘ç”Ÿäº†å˜åŒ–ã€‚ä¾‹å¦‚ï¼Œåƒ HSTS è¿™æ ·çš„åŠŸèƒ½ç°åœ¨è¢«ç”¨æ¥é˜²æ­¢ HTTPS å¯èƒ½å‘ç”Ÿçš„æŸäº›ç±»å‹çš„æ”»å‡»ã€‚&amp;#160;&lt;a href=&#34;#fnref:2&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:3&#34;&gt;
&lt;p&gt;å°½ç®¡è¿™ä¸ªå®¢æˆ·ç«¯ä»¤ç‰Œæµç¨‹æ²¡æœ‰ä½¿ç”¨ TLS å®¢æˆ·ç«¯è®¤è¯ï¼Œä½†å®ƒä»ç„¶ä¾é  TLS æœåŠ¡å™¨è®¤è¯æ¥ä¿è¯å®‰å…¨ã€‚TLS ç¡®ä¿ä»¤ç‰Œæ¥è‡ª GitHub è€Œä¸æ˜¯ä¸€ä¸ªä¼ªè£…è€…ã€‚&amp;#160;&lt;a href=&#34;#fnref:3&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li id=&#34;fn:4&#34;&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œä½ çš„æµè§ˆå™¨å¸¦æœ‰çŸ¥åå…¬å…± CA çš„è¯ä¹¦ï¼Œå¦‚ Verisignã€Digicert ç­‰ï¼Œè¿™äº›è¯ä¹¦åœ¨å‘å¸ƒæ—¶è¢«æ‰“åŒ…åœ¨ä¸€èµ·ã€‚å½“ä½ ä¸‹è½½ Firefox æ—¶ï¼Œä½ ç›¸ä¿¡ Mozilla å·²ç»æŠŠæ­£ç¡®çš„è¯ä¹¦æ”¾è¿›äº†æµè§ˆå™¨ã€‚å¯¹äºé›†ç¾¤å†…çš„é€šä¿¡ï¼Œæˆ‘ä»¬å°†åˆ›å»ºæˆ‘ä»¬è‡ªå·±çš„ CAï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬ä¹Ÿå¿…é¡»ä»¥ä¸€ç§å®‰å…¨çš„æ–¹å¼ï¼Œå°†è¿™ä¸ª CA çš„è¯ä¹¦åˆ†å‘ç»™é›†ç¾¤çš„æ¯ä¸ªéƒ¨åˆ†ï¼Œè¿™äº›éƒ¨åˆ†éœ€è¦åšå‡ºä¿¡ä»»å†³å®šã€‚&amp;#160;&lt;a href=&#34;#fnref:4&#34; class=&#34;footnote-backref&#34; role=&#34;doc-backlink&#34;&gt;&amp;#x21a9;&amp;#xfe0e;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>å¦‚ä½•åœ¨ Istio ä¸­é›†æˆ SPIRE</title>
      <link>https://lib.jimmysong.io/blog/istio-spire-integration/</link>
      <pubDate>Mon, 06 Jun 2022 11:00:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/istio-spire-integration/</guid>
      <description>&lt;h2 id=&#34;ç¼–è€…çš„è¯&#34;&gt;ç¼–è€…çš„è¯&lt;/h2&gt;
&lt;p&gt;Istio 1.14 ç‰ˆæœ¬å¢åŠ äº†å¯¹ SPIRE é›†æˆçš„æ”¯æŒï¼Œè¿™ç¯‡æ–‡ç« å°†æŒ‡å¯¼ä½ å¦‚ä½•åœ¨ Istio ä¸­é›†æˆ SPIREã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://spiffe.io/docs/latest/spire-about/spire-concepts/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SPIRE&lt;/a&gt; æ˜¯ SPIFFE è§„èŒƒçš„ä¸€ä¸ªç”Ÿäº§å°±ç»ªçš„å®ç°ï¼Œå®ƒå¯ä»¥æ‰§è¡ŒèŠ‚ç‚¹å’Œå·¥ä½œè´Ÿè½½è¯æ˜ï¼Œä»¥ä¾¿å®‰å…¨åœ°å°†åŠ å¯†èº«ä»½å‘ç»™åœ¨å¼‚æ„ç¯å¢ƒä¸­è¿è¡Œçš„å·¥ä½œè´Ÿè½½ã€‚é€šè¿‡ä¸ &lt;a href=&#34;https://www.envoyproxy.io/docs/envoy/latest/configuration/security/secret&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Envoy çš„ SDS API&lt;/a&gt; é›†æˆï¼ŒSPIRE å¯ä»¥è¢«é…ç½®ä¸º Istio å·¥ä½œè´Ÿè½½çš„åŠ å¯†èº«ä»½æ¥æºã€‚Istio å¯ä»¥æ£€æµ‹åˆ°ä¸€ä¸ª UNIX åŸŸå¥—æ¥å­—çš„å­˜åœ¨ï¼Œè¯¥å¥—æ¥å­—åœ¨å®šä¹‰çš„å¥—æ¥å­—è·¯å¾„ä¸Šå®ç°äº† Envoy SDS APIï¼Œå…è®¸ Envoy ç›´æ¥ä»å®ƒé‚£é‡Œè¿›è¡Œé€šä¿¡å’Œè·å–èº«ä»½ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ç§ä¸ SPIRE çš„é›†æˆæä¾›äº†çµæ´»çš„è®¤è¯é€‰é¡¹ï¼Œè¿™æ˜¯é»˜è®¤çš„ Istio èº«ä»½ç®¡ç†æ‰€ä¸å…·å¤‡çš„ï¼ŒåŒæ—¶åˆ©ç”¨äº† Istio å¼ºå¤§çš„æœåŠ¡ç®¡ç†ã€‚ä¾‹å¦‚ï¼ŒSPIRE çš„æ’ä»¶æ¶æ„èƒ½å¤Ÿæä¾›å¤šæ ·åŒ–çš„å·¥ä½œè´Ÿè½½è®¤è¯é€‰é¡¹ï¼Œè¶…è¶Š Istio æä¾›çš„ Kubernetes å‘½åç©ºé—´å’ŒæœåŠ¡è´¦æˆ·è®¤è¯ã€‚SPIRE çš„èŠ‚ç‚¹è®¤è¯å°†è®¤è¯æ‰©å±•åˆ°å·¥ä½œè´Ÿè½½è¿è¡Œçš„ç‰©ç†æˆ–è™šæ‹Ÿç¡¬ä»¶ä¸Šã€‚&lt;/p&gt;
&lt;p&gt;å…³äºè¿™ç§ SPIRE ä¸ Istio é›†æˆçš„å¿«é€Ÿæ¼”ç¤ºï¼Œè¯·å‚é˜…&lt;a href=&#34;https://github.com/istio/istio/tree/release-1.14/samples/security/spire&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;é€šè¿‡ Envoy çš„ SDS API å°† SPIRE ä½œä¸º CA è¿›è¡Œé›†æˆ&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¯·æ³¨æ„ï¼Œè¿™ä¸ªé›†æˆéœ€è¦ 1.14 ç‰ˆæœ¬çš„ &lt;code&gt;istioctl&lt;/code&gt; å’Œæ•°æ®å¹³é¢ã€‚&lt;/p&gt;
&lt;p&gt;è¯¥é›†æˆä¸ Istio çš„å‡çº§å…¼å®¹ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å®‰è£…-spire&#34;&gt;å®‰è£… SPIRE&lt;/h2&gt;
&lt;h3 id=&#34;é€‰é¡¹-1-å¿«é€Ÿå¯åŠ¨&#34;&gt;é€‰é¡¹ 1: å¿«é€Ÿå¯åŠ¨&lt;/h3&gt;
&lt;p&gt;Istio æä¾›äº†ä¸€ä¸ªåŸºæœ¬çš„å®‰è£…ç¤ºä¾‹ï¼Œä»¥å¿«é€Ÿå¯åŠ¨å’Œè¿è¡Œ SPIREã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ kubectl apply -f samples/security/spire/spire-quickstart.yaml
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™å°†æŠŠ SPIRE éƒ¨ç½²åˆ°ä½ çš„é›†ç¾¤ä¸­ï¼ŒåŒæ—¶è¿˜æœ‰ä¸¤ä¸ªé¢å¤–çš„ç»„ä»¶ï¼š&lt;a href=&#34;https://github.com/spiffe/spiffe-csi&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SPIFFE CSI é©±åŠ¨&lt;/a&gt; â€”â€” ç”¨äºä¸æ•´ä¸ªèŠ‚ç‚¹çš„å…¶ä»– pod å…±äº« SPIRE Agent çš„ UNIX åŸŸå¥—æ¥å­—ï¼Œä»¥åŠ &lt;a href=&#34;https://github.com/spiffe/spire/tree/main/support/k8s/k8s-workload-registrar&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SPIRE Kubernetes å·¥ä½œè´Ÿè½½æ³¨å†Œå™¨&lt;/a&gt;ï¼Œè¿™æ˜¯ä¸€ä¸ªåœ¨ Kubernetes å†…æ‰§è¡Œè‡ªåŠ¨å·¥ä½œè´Ÿè½½æ³¨å†Œçš„ä¿ƒè¿›å™¨ã€‚å‚è§&lt;a href=&#34;https://istio.io/latest/docs/ops/integrations/spire/#install-istio&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å®‰è£… Istio&lt;/a&gt; ä»¥é…ç½® Istio å¹¶ä¸ SPIFFE CSI é©±åŠ¨é›†æˆã€‚&lt;/p&gt;
&lt;h3 id=&#34;é€‰é¡¹-2é…ç½®ä¸€ä¸ªè‡ªå®šä¹‰çš„-spire-å®‰è£…&#34;&gt;é€‰é¡¹ 2ï¼šé…ç½®ä¸€ä¸ªè‡ªå®šä¹‰çš„ SPIRE å®‰è£…&lt;/h3&gt;
&lt;p&gt;è¯·å‚é˜… &lt;a href=&#34;https://spiffe.io/docs/latest/try/getting-started-k8s/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SPIRE çš„ Kubernetes å¿«é€Ÿå…¥é—¨æŒ‡å—&lt;/a&gt;ï¼Œå°† SPIRE éƒ¨ç½²åˆ° Kubernetes ç¯å¢ƒä¸­ã€‚è¯·å‚é˜… SPIRE &lt;a href=&#34;https://istio.io/latest/docs/ops/integrations/spire/#spire-ca-integration-prerequisites&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;CA é›†æˆå…ˆå†³æ¡ä»¶&lt;/a&gt;ï¼Œäº†è§£æœ‰å…³é…ç½® SPIRE ä»¥ä¸ Istio éƒ¨ç½²é›†æˆçš„æ›´å¤šä¿¡æ¯ã€‚&lt;/p&gt;
&lt;h4 id=&#34;spire-ca-é›†æˆçš„å…ˆå†³æ¡ä»¶&#34;&gt;SPIRE CA é›†æˆçš„å…ˆå†³æ¡ä»¶&lt;/h4&gt;
&lt;p&gt;å°† SPIRE éƒ¨ç½²ä¸ Istio é›†æˆï¼Œé…ç½® SPIREï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;è®¿é—® &lt;a href=&#34;https://spiffe.io/docs/latest/deploying/spire_agent/#agent-configuration-file&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SPIRE ä»£ç†å‚è€ƒ&lt;/a&gt;ï¼Œé…ç½® SPIRE ä»£ç†å¥—æ¥å­—è·¯å¾„ï¼Œä»¥åŒ¹é… Envoy SDS å®šä¹‰çš„å¥—æ¥å­—è·¯å¾„ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nv&#34;&gt;socket_path&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;/run/secrets/workload-spiffe-uds/socket&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;é€šè¿‡éƒ¨ç½² &lt;a href=&#34;https://github.com/spiffe/spiffe-csi&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SPIFFE CSI é©±åŠ¨&lt;/a&gt;ï¼Œä¸èŠ‚ç‚¹å†…çš„ pod å…±äº« SPIRE ä»£ç†å¥—æ¥å­—ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å‚è§&lt;a href=&#34;https://istio.io/latest/docs/ops/integrations/spire/#install-istio&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å®‰è£… Istio&lt;/a&gt; ä»¥é…ç½® Istio ä¸ SPIFFE CSI é©±åŠ¨é›†æˆã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„ï¼Œä½ å¿…é¡»åœ¨å°† Istio å®‰è£…åˆ°ä½ çš„ç¯å¢ƒä¸­ä¹‹å‰éƒ¨ç½² SPIREï¼Œä»¥ä¾¿ Istio å¯ä»¥æ£€æµ‹åˆ°å®ƒæ˜¯ä¸€ä¸ª CAã€‚&lt;/p&gt;
&lt;h2 id=&#34;å®‰è£…-istio&#34;&gt;å®‰è£… Istio&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://istio.io/latest/docs/setup/getting-started/#download&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä¸‹è½½ Istio 1.14 + ç‰ˆæœ¬&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åœ¨&lt;a href=&#34;https://istio.io/latest/docs/ops/integrations/spire/#install-spire&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å°† SPIRE éƒ¨ç½²&lt;/a&gt;åˆ°ä½ çš„ç¯å¢ƒä¸­ï¼Œå¹¶éªŒè¯æ‰€æœ‰çš„éƒ¨ç½²éƒ½å¤„äº &lt;code&gt;Ready&lt;/code&gt; çŠ¶æ€åï¼Œä¸º Ingress-gateway ä»¥åŠ istio-proxy å®‰è£… Istio çš„å®šåˆ¶è¡¥ä¸ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;l&#34;&gt;$ istioctl install --skip-confirmation -f - &amp;lt;&amp;lt;EOF&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;install.istio.io/v1alpha1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;IstioOperator&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;istio-system&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;profile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;default&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;meshConfig&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;trustDomain&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;example.org&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;values&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;global&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# This is used to customize the sidecar template&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;sidecarInjectorWebhook&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;templates&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spire&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;          spec:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;            containers:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;            - name: istio-proxy
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;              volumeMounts:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;              - name: workload-socket
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;                mountPath: /run/secrets/workload-spiffe-uds
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;                readOnly: true
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;            volumes:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;              - name: workload-socket
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;                csi:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;                  driver: &amp;#34;csi.spiffe.io&amp;#34;          &lt;/span&gt;&lt;span class=&#34;w&#34;&gt;          
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;components&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;ingressGateways&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;istio-ingressgateway&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;enabled&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;label&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;istio&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;ingressgateway&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;k8s&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;overlays&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;apps/v1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Deployment&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;istio-ingressgateway&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;patches&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;spec.template.spec.volumes.[name:workload-socket]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;workload-socket&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;csi&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;driver&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;csi.spiffe.io&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;spec.template.spec.containers.[name:istio-proxy].volumeMounts.[name:workload-socket]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;workload-socket&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;mountPath&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/run/secrets/workload-spiffe-uds&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;readOnly&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;l&#34;&gt;EOF&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™å°†ä¸ Ingress Gateway å’Œå°†è¢«æ³¨å…¥å·¥ä½œè´Ÿè½½ pod çš„ sidecars å…±äº« &lt;code&gt;spiffe-csi-driver&lt;/code&gt;ï¼Œå…è®¸å®ƒä»¬è®¿é—® SPIRE Agent çš„ UNIX åŸŸå¥—æ¥å­—ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä½¿ç”¨ &lt;a href=&#34;https://istio.io/latest/docs/setup/additional-setup/sidecar-injection&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;sidecar æ³¨å…¥&lt;/a&gt;ï¼Œå°† &lt;code&gt;istio-proxy&lt;/code&gt; å®¹å™¨æ³¨å…¥åˆ°ç½‘æ ¼å†…çš„ pod ä¸­ã€‚å…³äºå¦‚ä½•å°†è‡ªå®šä¹‰çš„ &lt;code&gt;spire&lt;/code&gt; æ¨¡æ¿åº”ç”¨åˆ° &lt;code&gt;istio-proxy&lt;/code&gt; ä¸­çš„ä¿¡æ¯ï¼Œè¯·å‚è§&lt;a href=&#34;https://istio.io/latest/docs/setup/additional-setup/sidecar-injection/#custom-templates-experimental&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è‡ªå®šä¹‰æ¨¡æ¿&lt;/a&gt;ã€‚è¿™ä½¿å¾— CSI é©±åŠ¨èƒ½å¤Ÿåœ¨ sidecar ä¸Šå®‰è£… UDSã€‚&lt;/p&gt;
&lt;p&gt;æ£€æŸ¥ Ingress-gateway pod çŠ¶æ€ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ kubectl get pods -n istio-system
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;NAME                                    READY   STATUS    RESTARTS   AGE
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;istio-ingressgateway-5b45864fd4-lgrxs   0/1     Running   &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;          17s
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;istiod-989f54d9c-sg7sn                  1/1     Running   &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;          23s
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;åªæœ‰åœ¨ SPIRE æœåŠ¡å™¨ä¸Šä¸ºå®ƒä»¬åˆ›å»ºäº†ç›¸åº”çš„æ³¨å†Œæ¡ç›®æ—¶ï¼Œæ•°æ®å¹³é¢å®¹å™¨æ‰ä¼šåˆ°è¾¾ &lt;code&gt;Ready&lt;/code&gt;ã€‚ç„¶åï¼ŒEnvoy å°†èƒ½å¤Ÿä» SPIRE è·å–åŠ å¯†èº«ä»½ã€‚è¯·å‚é˜…&lt;a href=&#34;#register-workloads&#34;&gt;æ³¨å†Œå·¥ä½œè´Ÿè½½&lt;/a&gt; ï¼Œä¸ºä½ çš„ç½‘æ ¼ä¸­çš„æœåŠ¡æ³¨å†Œæ¡ç›®ã€‚&lt;/p&gt;
&lt;h2 id=&#34;register-workloads&#34;&gt;æ³¨å†Œå·¥ä½œè´Ÿè½½&lt;/h2&gt;
&lt;p&gt;æœ¬èŠ‚ä»‹ç»åœ¨ SPIRE æœåŠ¡å™¨ä¸­æ³¨å†Œå·¥ä½œè´Ÿè½½çš„å¯ç”¨é€‰é¡¹ã€‚&lt;/p&gt;
&lt;h3 id=&#34;é€‰é¡¹-1ä½¿ç”¨-spire-å·¥ä½œè´Ÿè½½æ³¨å†Œå™¨è‡ªåŠ¨ç™»è®°&#34;&gt;é€‰é¡¹ 1ï¼šä½¿ç”¨ SPIRE å·¥ä½œè´Ÿè½½æ³¨å†Œå™¨è‡ªåŠ¨ç™»è®°&lt;/h3&gt;
&lt;p&gt;é€šè¿‡å°† &lt;a href=&#34;https://github.com/spiffe/spire/tree/main/support/k8s/k8s-workload-registrar&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SPIRE Kubernetes Workload Registrar&lt;/a&gt; ä¸ SPIRE æœåŠ¡å™¨ä¸€èµ·éƒ¨ç½²ï¼Œæ¯åˆ›å»ºä¸€ä¸ªæ–°çš„ podï¼Œå°±ä¼šè‡ªåŠ¨æ³¨å†Œæ–°çš„æ¡ç›®ã€‚&lt;/p&gt;
&lt;p&gt;è¯·å‚é˜…â€ &lt;a href=&#34;https://istio.io/latest/docs/ops/integrations/spire/#verifying-that-identities-were-created-for-workloads&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;éªŒè¯èº«ä»½æ˜¯å¦ä¸ºå·¥ä½œè´Ÿè½½åˆ›å»º&lt;/a&gt; &amp;ldquo;ï¼Œä»¥æ£€æŸ¥å·²å‘å¸ƒçš„èº«ä»½ã€‚&lt;/p&gt;
&lt;p&gt;è¯·æ³¨æ„ï¼Œåœ¨&lt;a href=&#34;https://istio.io/latest/docs/ops/integrations/spire/#option-1:-quick-start&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¿«é€Ÿå¯åŠ¨&lt;/a&gt;éƒ¨åˆ†ä½¿ç”¨äº† &lt;code&gt;SPIREå·¥ä½œè´Ÿè½½æ³¨å†Œå™¨&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;é€‰é¡¹-2æ‰‹åŠ¨æ³¨å†Œ&#34;&gt;é€‰é¡¹ 2ï¼šæ‰‹åŠ¨æ³¨å†Œ&lt;/h3&gt;
&lt;p&gt;ä¸ºäº†æé«˜å·¥ä½œè´Ÿè½½è¯æ˜çš„å®‰å…¨ç¨³å¥æ€§ï¼ŒSPIRE èƒ½å¤Ÿæ ¹æ®ä¸åŒçš„å‚æ•°ï¼Œé’ˆå¯¹ä¸€ç»„é€‰æ‹©å™¨çš„å€¼è¿›è¡ŒéªŒè¯ã€‚å¦‚æœä½ æŒ‰ç…§&lt;a href=&#34;https://istio.io/latest/docs/ops/integrations/spire/#option-1:-quick-start&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¿«é€Ÿå¯åŠ¨&lt;/a&gt;å®‰è£… &lt;code&gt;SPIRE&lt;/code&gt;ï¼Œåˆ™è·³è¿‡è¿™äº›æ­¥éª¤ï¼Œå› ä¸ºå®ƒä½¿ç”¨è‡ªåŠ¨æ³¨å†Œã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;ä¸º Ingress Gateway ç”Ÿæˆä¸€ä¸ªæ¡ç›®ï¼Œå…¶ä¸­æœ‰ä¸€ç»„é€‰æ‹©å™¨ï¼Œå¦‚ pod åç§°å’Œ pod UIDï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ &lt;span class=&#34;nv&#34;&gt;INGRESS_POD&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;kubectl get pod -l &lt;span class=&#34;nv&#34;&gt;istio&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;ingressgateway -n istio-system -o &lt;span class=&#34;nv&#34;&gt;jsonpath&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;{.items[0].metadata.name}&amp;#34;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ &lt;span class=&#34;nv&#34;&gt;INGRESS_POD_UID&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;kubectl get pods -n istio-system &lt;span class=&#34;nv&#34;&gt;$INGRESS_POD&lt;/span&gt; -o &lt;span class=&#34;nv&#34;&gt;jsonpath&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;{.metadata.uid}&amp;#39;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è·å– spire-server podï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ &lt;span class=&#34;nv&#34;&gt;SPIRE_SERVER_POD&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;kubectl get pod -l &lt;span class=&#34;nv&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;spire-server -n spire -o &lt;span class=&#34;nv&#34;&gt;jsonpath&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;{.items[0].metadata.name}&amp;#34;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä¸ºèŠ‚ç‚¹ä¸Šè¿è¡Œçš„ SPIRE ä»£ç†æ³¨å†Œä¸€ä¸ªæ¡ç›®ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;l&#34;&gt;$ kubectl exec -n spire $SPIRE_SERVER_POD -- \&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;l&#34;&gt;/opt/spire/bin/spire-server entry create \&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;-&lt;span class=&#34;l&#34;&gt;spiffeID spiffe://example.org/ns/spire/sa/spire-agent \&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;-&lt;span class=&#34;l&#34;&gt;selector k8s_psat:cluster:demo-cluster \&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;-&lt;span class=&#34;l&#34;&gt;selector k8s_psat:agent_ns:spire \&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;-&lt;span class=&#34;l&#34;&gt;selector k8s_psat:agent_sa:spire-agent \&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;-&lt;span class=&#34;l&#34;&gt;node -socketPath /run/spire/sockets/server.sock&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;Entry ID         &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;d38c88d0-7d7a-4957-933c-361a0a3b039c&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;SPIFFE ID        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;spiffe://example.org/ns/spire/sa/spire-agent&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;Parent ID        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;spiffe://example.org/spire/server&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;Revision         &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;TTL              &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;default&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;Selector         &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;k8s_psat:agent_ns:spire&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;Selector         &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;k8s_psat:agent_sa:spire-agent&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;Selector         &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;k8s_psat:cluster:demo-cluster&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä¸º Ingress-gateway pod æ³¨å†Œä¸€ä¸ªæ¡ç›®ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ kubectl &lt;span class=&#34;nb&#34;&gt;exec&lt;/span&gt; -n spire &lt;span class=&#34;nv&#34;&gt;$SPIRE_SERVER_POD&lt;/span&gt; -- &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;/opt/spire/bin/spire-server entry create &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;    -spiffeID spiffe://example.org/ns/istio-system/sa/istio-ingressgateway-service-account &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;    -parentID spiffe://example.org/ns/spire/sa/spire-agent &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;    -selector k8s:sa:istio-ingressgateway-service-account &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;    -selector k8s:ns:istio-system &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;    -selector k8s:pod-uid:&lt;span class=&#34;nv&#34;&gt;$INGRESS_POD_UID&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;    -dns &lt;span class=&#34;nv&#34;&gt;$INGRESS_POD&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;    -dns istio-ingressgateway.istio-system.svc &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;    -socketPath /run/spire/sockets/server.sock
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Entry ID         : 6f2fe370-5261-4361-ac36-10aae8d91ff7
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;SPIFFE ID        : spiffe://example.org/ns/istio-system/sa/istio-ingressgateway-service-account
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Parent ID        : spiffe://example.org/ns/spire/sa/spire-agent
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Revision         : &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;TTL              : default
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Selector         : k8s:ns:istio-system
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Selector         : k8s:pod-uid:63c2bbf5-a8b1-4b1f-ad64-f62ad2a69807
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Selector         : k8s:sa:istio-ingressgateway-service-account
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;DNS name         : istio-ingressgateway.istio-system.svc
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;DNS name         : istio-ingressgateway-5b45864fd4-lgrxs
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;éƒ¨ç½²ä¸€ä¸ªå·¥ä½œè´Ÿè½½çš„ä¾‹å­ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ istioctl kube-inject --filename @samples/security/spire/sleep-spire.yaml &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; kubectl apply -f -
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¯·æ³¨æ„ï¼Œå·¥ä½œè´Ÿè½½å°†éœ€è¦ SPIFFE CSI é©±åŠ¨å·æ¥è®¿é—® SPIRE ä»£ç†å¥—æ¥å­—ã€‚è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œä½ å¯ä»¥åˆ©ç”¨&lt;a href=&#34;https://istio.io/latest/docs/ops/integrations/spire/#install-istio&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å®‰è£… Istio&lt;/a&gt; éƒ¨åˆ†çš„ &lt;code&gt;spire &lt;/code&gt;pod æ³¨é‡Šæ¨¡æ¿ï¼Œæˆ–å°† CSI å·æ·»åŠ åˆ°å·¥ä½œè´Ÿè½½çš„éƒ¨ç½²è§„èŒƒä¸­ã€‚è¿™ä¸¤ç§æ–¹æ³•åœ¨ä¸‹é¢çš„ç¤ºä¾‹ç‰‡æ®µä¸­éƒ½æœ‰å¼ºè°ƒã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;apps/v1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Deployment&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;sleep&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;replicas&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;selector&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;matchLabels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;sleep&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;template&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;labels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;sleep&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# Injects custom sidecar template&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;annotations&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;inject.istio.io/templates&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;sidecar,spire&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;terminationGracePeriodSeconds&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;serviceAccountName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;sleep&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;containers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;sleep&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;image&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;curlimages/curl&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;command&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/bin/sleep&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;3650d&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;imagePullPolicy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;IfNotPresent&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;volumeMounts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;tmp&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;mountPath&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;/tmp&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;securityContext&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;runAsUser&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1000&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;volumes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;tmp&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;emptyDir&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;{}&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# CSI volume&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;workload-socket&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;csi&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;driver&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;csi.spiffe.io&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è·å– pod ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ &lt;span class=&#34;nv&#34;&gt;SLEEP_POD&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;kubectl get pod -l &lt;span class=&#34;nv&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;sleep -o &lt;span class=&#34;nv&#34;&gt;jsonpath&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;{.items[0].metadata.name}&amp;#34;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ &lt;span class=&#34;nv&#34;&gt;SLEEP_POD_UID&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;kubectl get pods &lt;span class=&#34;nv&#34;&gt;$SLEEP_POD&lt;/span&gt; -o &lt;span class=&#34;nv&#34;&gt;jsonpath&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;{.metadata.uid}&amp;#39;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ³¨å†Œå·¥ä½œè´Ÿè½½ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ kubectl &lt;span class=&#34;nb&#34;&gt;exec&lt;/span&gt; -n spire spire-server-0 -- &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;/opt/spire/bin/spire-server entry create &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;    -spiffeID spiffe://example.org/ns/default/sa/sleep &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;    -parentID spiffe://example.org/ns/spire/sa/spire-agent &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;    -selector k8s:ns:default &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;    -selector k8s:pod-uid:&lt;span class=&#34;nv&#34;&gt;$SLEEP_POD_UID&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;    -dns &lt;span class=&#34;nv&#34;&gt;$SLEEP_POD&lt;/span&gt; &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;    -socketPath /run/spire/sockets/server.sock
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å·¥ä½œè´Ÿè½½çš„ SPIFFE ID å¿…é¡»éµå¾ª Istio SPIFFE ID æ¨¡å¼ï¼š&lt;code&gt;spiffe://&amp;lt;trust.domain&amp;gt;/ns/&amp;lt;namespace&amp;gt;/sa/&amp;lt;service-account&amp;gt;ã€‚&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;è¯·å‚é˜… &lt;a href=&#34;https://spiffe.io/docs/latest/deploying/registering/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SPIRE å…³äºæ³¨å†Œå·¥ä½œè´Ÿè½½çš„å¸®åŠ©&lt;/a&gt;ï¼Œäº†è§£å¦‚ä½•ä¸ºå·¥ä½œè´Ÿè½½åˆ›å»ºæ–°æ¡ç›®ï¼Œå¹¶ä½¿ç”¨å¤šä¸ªé€‰æ‹©å™¨åŠ å¼ºéªŒè¯æ ‡å‡†ï¼Œä½¿å…¶å¾—åˆ°éªŒè¯ã€‚&lt;/p&gt;
&lt;h2 id=&#34;éªŒè¯æ˜¯å¦ä¸ºå·¥ä½œè´Ÿè½½åˆ›å»ºäº†èº«ä»½&#34;&gt;éªŒè¯æ˜¯å¦ä¸ºå·¥ä½œè´Ÿè½½åˆ›å»ºäº†èº«ä»½&lt;/h2&gt;
&lt;p&gt;ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤æ¥ç¡®è®¤ä¸ºå·¥ä½œè´Ÿè½½åˆ›å»ºäº†èº«ä»½ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ kubectl &lt;span class=&#34;nb&#34;&gt;exec&lt;/span&gt; -i -t &lt;span class=&#34;nv&#34;&gt;$SPIRE_SERVER_POD&lt;/span&gt; -n spire -c spire-server -- /bin/sh -c &lt;span class=&#34;s2&#34;&gt;&amp;#34;bin/spire-server entry show -socketPath /run/spire/sockets/server.sock&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Found &lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; entries
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Entry ID         : c8dfccdc-9762-4762-80d3-5434e5388ae7
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;SPIFFE ID        : spiffe://example.org/ns/istio-system/sa/istio-ingressgateway-service-account
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Parent ID        : spiffe://example.org/ns/spire/sa/spire-agent
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Revision         : &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;TTL              : default
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Selector         : k8s:ns:istio-system
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Selector         : k8s:pod-uid:88b71387-4641-4d9c-9a89-989c88f7509d
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Selector         : k8s:sa:istio-ingressgateway-service-account
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;DNS name         : istio-ingressgateway-5b45864fd4-lgrxs
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Entry ID         : af7b53dc-4cc9-40d3-aaeb-08abbddd8e54
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;SPIFFE ID        : spiffe://example.org/ns/default/sa/sleep
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Parent ID        : spiffe://example.org/ns/spire/sa/spire-agent
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Revision         : &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;TTL              : default
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Selector         : k8s:ns:default
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Selector         : k8s:pod-uid:ee490447-e502-46bd-8532-5a746b0871d6
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;DNS name         : sleep-5f4d47c948-njvpk
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Entry ID         : f0544fd7-1945-4bd1-88dc-0a5513fdae1c
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;SPIFFE ID        : spiffe://example.org/ns/spire/sa/spire-agent
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Parent ID        : spiffe://example.org/spire/server
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Revision         : &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;TTL              : default
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Selector         : k8s_psat:agent_ns:spire
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Selector         : k8s_psat:agent_sa:spire-agent
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Selector         : k8s_psat:cluster:demo-cluster
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ£€æŸ¥ Ingress-gateway pod çŠ¶æ€ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ kubectl get pods -n istio-system
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;NAME                                    READY   STATUS    RESTARTS   AGE
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;istio-ingressgateway-5b45864fd4-lgrxs   1/1     Running   &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;          60s
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;istiod-989f54d9c-sg7sn                  1/1     Running   &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;          45s
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åœ¨ä¸º Ingress-gateway pod æ³¨å†Œæ¡ç›®åï¼ŒEnvoy ä¼šæ”¶åˆ°ç”± SPIRE ç­¾å‘çš„èº«ä»½ï¼Œå¹¶å°†å…¶ç”¨äºæ‰€æœ‰ TLS å’Œ mTLS é€šä¿¡ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ£€æŸ¥å·¥ä½œè´Ÿè½½èº«ä»½æ˜¯å¦æ˜¯ç”±-spire-ç­¾å‘çš„&#34;&gt;æ£€æŸ¥å·¥ä½œè´Ÿè½½èº«ä»½æ˜¯å¦æ˜¯ç”± SPIRE ç­¾å‘çš„&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;ä½¿ç”¨ &lt;code&gt;istioctl proxy-config secret&lt;/code&gt; å‘½ä»¤æ£€ç´¢ sleep çš„ SVID èº«ä»½æ–‡ä»¶ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ istioctl proxy-config secret &lt;span class=&#34;nv&#34;&gt;$SLEEP_POD&lt;/span&gt; -o json &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; jq -r &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;.dynamicActiveSecrets[0].secret.tlsCertificate.certificateChain.inlineBytes&amp;#39;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; base64 --decode &amp;gt; chain.pem
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ£€æŸ¥è¯ä¹¦å¹¶æ ¸å® SPIRE æ˜¯å‘è¡Œäººã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ openssl x509 -in chain.pem -text &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; grep SPIRE
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Subject: &lt;span class=&#34;nv&#34;&gt;C&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; US, &lt;span class=&#34;nv&#34;&gt;O&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; SPIRE, &lt;span class=&#34;nv&#34;&gt;CN&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; sleep-5f4d47c948-njvpk
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;spiffe-è”é‚¦&#34;&gt;SPIFFE è”é‚¦&lt;/h2&gt;
&lt;p&gt;SPIRE æœåŠ¡å™¨èƒ½å¤Ÿå¯¹æ¥è‡ªä¸åŒä¿¡ä»»åŸŸçš„ SPIFFE èº«ä»½è¿›è¡Œè®¤è¯ã€‚è¿™è¢«ç§°ä¸º SPIFFE è”é‚¦ã€‚&lt;/p&gt;
&lt;p&gt;SPIRE Agent å¯ä»¥è¢«é…ç½®ä¸ºé€šè¿‡ Envoy SDS API å‘ Envoy æ¨é€è”åˆèº«ä»½åŒ…ï¼Œå…è®¸ Envoy ä½¿ç”¨&lt;a href=&#34;https://spiffe.io/docs/latest/microservices/envoy/#validation-context&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;éªŒè¯ä¸Šä¸‹æ–‡&lt;/a&gt;æ¥éªŒè¯å¯¹ç­‰çš„è¯ä¹¦å¹¶ä¿¡ä»»æ¥è‡ªå¦ä¸€ä¸ªä¿¡ä»»åŸŸçš„å·¥ä½œè´Ÿè½½ã€‚ä¸ºäº†ä½¿ Istio èƒ½å¤Ÿé€šè¿‡ SPIRE é›†æˆæ¥è”åˆ SPIFFE èº«ä»½ï¼Œè¯·æŸ¥é˜… &lt;a href=&#34;https://github.com/spiffe/spire/blob/main/doc/spire_agent.md#sds-configuration&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SPIRE Agent SDS é…ç½®&lt;/a&gt;ï¼Œå¹¶ä¸ºä½ çš„ SPIRE Agent é…ç½®æ–‡ä»¶è®¾ç½®ä»¥ä¸‹ SDS é…ç½®å€¼ã€‚&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left&#34;&gt;é…ç½®&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;æè¿°&lt;/th&gt;
&lt;th style=&#34;text-align:left&#34;&gt;èµ„æºåç§°&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;&lt;code&gt;default_svid_name&lt;/code&gt;&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;TLS è¯ä¹¦èµ„æºåç§°ï¼Œç”¨äº Envoy SDS çš„é»˜è®¤ X509-SVIDã€‚&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;default&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;&lt;code&gt;default_bundle_name&lt;/code&gt;&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ç”¨äº Envoy SDS çš„é»˜è®¤ X.509 æ†ç»‘åŒ…çš„éªŒè¯ä¸Šä¸‹æ–‡èµ„æºåç§°ã€‚&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;null&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left&#34;&gt;&lt;code&gt;default_all_bundles_name&lt;/code&gt;&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;æ‰€æœ‰ä½¿ç”¨ Envoy SDS çš„æ†ç»‘åŒ…ï¼ˆåŒ…æ‹¬è”åˆåŒ…ï¼‰æ‰€ä½¿ç”¨çš„éªŒè¯ä¸Šä¸‹æ–‡èµ„æºåç§°ã€‚&lt;/td&gt;
&lt;td style=&#34;text-align:left&#34;&gt;ROOTCA&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;è¿™è®© Envoy å¯ä»¥ç›´æ¥ä» SPIRE è·å¾—è”åˆæ†ç»‘åŒ…ã€‚&lt;/p&gt;
&lt;h3 id=&#34;åˆ›å»ºè”åˆæ³¨å†Œæ¡ç›®&#34;&gt;åˆ›å»ºè”åˆæ³¨å†Œæ¡ç›®&lt;/h3&gt;
&lt;p&gt;å¦‚æœä½¿ç”¨ SPIRE Kubernetes å·¥ä½œè´Ÿè½½æ³¨å†Œå™¨ï¼Œé€šè¿‡å‘æœåŠ¡éƒ¨ç½²è§„èŒƒæ·»åŠ  pod æ³¨é‡Š &lt;code&gt;spiffe.io/federatesWith&lt;/code&gt;ï¼ŒæŒ‡å®šä½ å¸Œæœ› pod ä¸ä¹‹è”åˆçš„ä¿¡ä»»åŸŸï¼Œä¸ºå·¥ä½œè´Ÿè½½åˆ›å»ºè”åˆæ¡ç›®ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;podAnnotations&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spiffe.io/federatesWith&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;lt;trust.domain&amp;gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å…³äºæ‰‹åŠ¨æ³¨å†Œï¼Œè¯·å‚è§&lt;a href=&#34;https://spiffe.io/docs/latest/architecture/federation/readme/#create-registration-entries-for-federation&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä¸ºè”é‚¦åˆ›å»ºæ³¨å†Œæ¡ç›®&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ¸…ç†-spire&#34;&gt;æ¸…ç† SPIRE&lt;/h2&gt;
&lt;p&gt;å¦‚æœä½ ä½¿ç”¨ Istio æä¾›çš„å¿«é€Ÿå¯åŠ¨ SPIRE éƒ¨ç½²æ¥å®‰è£… SPIREï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ¥åˆ é™¤è¿™äº› Kubernetes èµ„æºï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ kubectl delete CustomResourceDefinition spiffeids.spiffeid.spiffe.io
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ kubectl delete -n spire serviceaccount spire-agent
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ kubectl delete -n spire configmap spire-agent
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ kubectl delete -n spire deployment spire-agent
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ kubectl delete csidriver csi.spiffe.io
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ kubectl delete -n spire configmap spire-server
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ kubectl delete -n spire service spire-server
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ kubectl delete -n spire serviceaccount spire-server
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ kubectl delete -n spire statefulset spire-server
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ kubectl delete clusterrole spire-server-trust-role spire-agent-cluster-role
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ kubectl delete clusterrolebinding spire-server-trust-role-binding spire-agent-cluster-role-binding
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ kubectl delete namespace spire
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</description>
    </item>
    
    <item>
      <title>ä¸€é”®å¼€å¯ Kubernetes å¯è§‚æµ‹æ€§â€”â€”å¦‚ä½•è‡ªåŠ¨ç”Ÿæˆå’Œå­˜å‚¨ OpenTelemetry è¿½è¸ª</title>
      <link>https://lib.jimmysong.io/blog/generate-and-store-opentelemetry-traces-automatically/</link>
      <pubDate>Mon, 30 May 2022 11:00:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/generate-and-store-opentelemetry-traces-automatically/</guid>
      <description>&lt;h2 id=&#34;å‰è¨€&#34;&gt;å‰è¨€&lt;/h2&gt;
&lt;p&gt;OpenTelemetry è¿½è¸ªåŒ…å«äº†ç†è§£åˆ†å¸ƒå¼ç³»ç»Ÿå’Œæ’é™¤æ•…éšœçš„ä¿¡æ¯å®åº“ â€”â€” ä½†ä½ çš„æœåŠ¡å¿…é¡»é¦–å…ˆè¢«æŒ‡æ ‡åŒ–ï¼Œä»¥å‘å°„ OpenTelemetry è¿½è¸ªæ¥å®ç°è¿™ä¸€ä»·å€¼ã€‚ç„¶åï¼Œè¿™äº›è¿½è¸ªä¿¡æ¯éœ€è¦è¢«å‘é€åˆ°ä¸€ä¸ªå¯è§‚å¯Ÿçš„åç«¯ï¼Œä½¿ä½ èƒ½å¤Ÿè·å¾—å…³äºè¿™äº›æ•°æ®çš„ä»»æ„é—®é¢˜çš„ç­”æ¡ˆã€‚å¯è§‚æµ‹æ€§æ˜¯ä¸€ä¸ªåˆ†æé—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬å‘¨æ—©äº›æ—¶å€™ï¼Œæˆ‘ä»¬éƒ¨åˆ†è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œå®£å¸ƒ&lt;a href=&#34;https://www.timescale.com/blog/observability-powered-by-sql-understand-your-systems-like-never-before-with-opentelemetry-traces-and-postgresql/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;åœ¨ Promscale ä¸­æ™®éæä¾› OpenTelemetry è¿½è¸ªæ”¯æŒ&lt;/a&gt;ï¼Œå°†ç”± SQL é©±åŠ¨çš„å¯è§‚æµ‹æ€§å¸¦ç»™æ‰€æœ‰å¼€å‘è€…ã€‚éšç€å¯¹åˆ†æè¯­è¨€ â€”â€”SQL çš„å…¨é¢æ”¯æŒï¼Œæˆ‘ä»¬è§£å†³äº†åˆ†æçš„é—®é¢˜ã€‚ä½†æˆ‘ä»¬ä»ç„¶éœ€è¦è§£å†³ç¬¬ä¸€éƒ¨åˆ†çš„é—®é¢˜ï¼šæµ‹é‡ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†è®©ä½ çš„æœåŠ¡å‘å‡ºè¿½è¸ªæ•°æ®ï¼Œä½ å¿…é¡»æ‰‹åŠ¨æ·»åŠ  OpenTelemetry æµ‹é‡å·¥å…·åˆ°ä»£ç ä¸­ã€‚è€Œä¸”ä½ å¿…é¡»é’ˆå¯¹æ‰€æœ‰æœåŠ¡å’Œä½ ä½¿ç”¨çš„æ‰€æœ‰æ¡†æ¶æ¥åšï¼Œå¦åˆ™ä½ å°†æ— æ³•çœ‹åˆ°æ¯ä¸ªè¯·æ±‚çš„æ‰§è¡Œæƒ…å†µã€‚ä½ è¿˜éœ€è¦éƒ¨ç½² OpenTelemetry æ”¶é›†å™¨æ¥æ¥æ”¶æ‰€æœ‰æ–°çš„è¿½è¸ªï¼Œå¤„ç†å®ƒä»¬ï¼Œæ‰¹å¤„ç†å®ƒä»¬ï¼Œå¹¶æœ€ç»ˆå°†å®ƒä»¬å‘é€åˆ°ä½ çš„å¯è§‚æµ‹æ€§åç«¯ã€‚è¿™éœ€è¦èŠ±è´¹å¤§é‡çš„æ—¶é—´å’Œç²¾åŠ›ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ ä¸éœ€è¦åšæ‰€æœ‰è¿™äº›æ‰‹å·¥å·¥ä½œï¼Œå¹¶ä¸”å¯ä»¥åœ¨å‡ åˆ†é’Ÿå†…è€Œä¸æ˜¯å‡ å°æ—¶ç”šè‡³å‡ å¤©å†…å¯åŠ¨å’Œè¿è¡Œå‘¢ï¼Ÿå¦‚æœä½ è¿˜èƒ½å»ºç«‹ä¸€ä¸ªå®Œæ•´çš„å¯è§‚æµ‹æ€§æŠ€æœ¯æ ˆå¹¶è‡ªåŠ¨è¿æ¥æ‰€æœ‰çš„ç»„ä»¶å‘¢ï¼Ÿå¦‚æœæˆ‘å‘Šè¯‰ä½ ï¼Œä½ å¯ä»¥ç”¨ä¸€ä¸ªå‘½ä»¤å®Œæˆæ‰€æœ‰è¿™äº›å·¥ä½œå‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;æˆ‘ä¸æ˜¯ç–¯å­ã€‚æˆ‘åªæ˜¯ä¸€ä¸ª &lt;a href=&#34;https://docs.timescale.com/promscale/latest/tobs/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tobs&lt;/a&gt; ç”¨æˆ·ğŸ˜ã€‚&lt;/p&gt;
&lt;p&gt;Tobs æ˜¯ Kubernetes çš„å¯è§‚æµ‹æ€§æŠ€æœ¯æ ˆï¼Œæ˜¯ä¸€ä¸ªå¯ä»¥ç”¨æ¥&lt;a href=&#34;https://www.timescale.com/blog/introducing-tobs-deploy-a-full-observability-suite-for-kubernetes-in-two-minutes/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;åœ¨å‡ åˆ†é’Ÿå†…åœ¨ Kubernetes é›†ç¾¤ä¸­éƒ¨ç½²ä¸€ä¸ªå®Œæ•´çš„å¯è§‚æµ‹æ€§æŠ€æœ¯æ ˆ&lt;/a&gt;çš„å·¥å…·ã€‚è¯¥æ ˆåŒ…æ‹¬ OpenTelemetry Operatorã€OpenTelemetry Collectorã€Promscale å’Œ Grafanaã€‚å®ƒè¿˜éƒ¨ç½²äº†å…¶ä»–å‡ ä¸ªå·¥å…·ï¼Œå¦‚ Prometheusï¼Œä»¥æ”¶é›† Kubernetes é›†ç¾¤çš„æŒ‡æ ‡ï¼Œå¹¶å°†å…¶å‘é€åˆ° Promscaleã€‚&lt;a href=&#34;https://github.com/timescale/tobs/releases/tag/0.10.1&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;åœ¨æˆ‘ä»¬çš„æœ€æ–°ç‰ˆæœ¬ä¸­&lt;/a&gt;ï¼Œtobs åŒ…æ‹¬æ”¯æŒé€šè¿‡ OpenTelemetry Operator ç”¨ OpenTelemetry è¿½è¸ªè‡ªåŠ¨æ£€æµ‹ä½ çš„ Pythonã€Java å’Œ Node.js æœåŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;æ˜¯çš„ï¼Œä½ æ²¡çœ‹é”™ï¼šè‡ªåŠ¨ï¼ä½ ä¸éœ€è¦æ”¹å˜æœåŠ¡ä¸­çš„ä»»ä½•ä¸€è¡Œä»£ç ï¼Œå°±å¯ä»¥è®©å®ƒä»¬è¢«æ£€æµ‹å‡ºæ¥ã€‚é”¦ä¸Šæ·»èŠ±çš„æ˜¯ä»€ä¹ˆï¼Ÿä½ å¯ä»¥é€šè¿‡æ‰§è¡Œ helm å‘½ä»¤æ¥éƒ¨ç½²ä¸€åˆ‡ã€‚&lt;/p&gt;
&lt;p&gt;æœ‰äº† tobsï¼Œä½ å¯ä»¥å®‰è£…ä½ çš„å¯è§‚æµ‹æ€§æŠ€æœ¯æ ˆï¼Œåªéœ€å‡ æ­¥å°±èƒ½æå®šä½ çš„ OpenTelemetry æŒ‡æ ‡åŒ–çš„ç¬¬ä¸€å±‚ã€‚å‘Šåˆ«ç¹ççš„é…ç½®å·¥ä½œï¼Œå› ä¸ºä½ çš„æ¡†æ¶ä¼šè‡ªå·±æ£€æµ‹ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ æƒ³äº†è§£å¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹ï¼Œè¯·ç»§ç»­é˜…è¯»æœ¬åšæ–‡ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å°†è§£é‡Šä¸€åˆ‡æ˜¯å¦‚ä½•è¿ä½œçš„ï¼Œå‰–æ OpenTelemetry Operator åœ¨å†…éƒ¨çš„çœŸæ­£ä½œç”¨ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†é€šè¿‡ä¸€ä¸ªä¾‹å­æ¼”ç¤ºå¦‚ä½•å°†å…¶ç›´æ¥ä»˜è¯¸å®è·µã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æˆ‘ä»¬å°†é€šè¿‡ tobs åœ¨æˆ‘ä»¬çš„ Kubernetes é›†ç¾¤ä¸­å®‰è£…ä¸€ä¸ªå®Œæ•´çš„å¯è§‚æµ‹æ€§æŠ€æœ¯æ ˆã€‚&lt;/li&gt;
&lt;li&gt;æˆ‘ä»¬å°†éƒ¨ç½²ä¸€ä¸ªäº‘åŸç”Ÿ Python åº”ç”¨ç¨‹åºã€‚&lt;/li&gt;
&lt;li&gt;æˆ‘ä»¬å°†æ£€æŸ¥æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºæ˜¯å¦‚ä½•è¢« OpenTelemetry è¿½è¸ªå™¨è‡ªåŠ¨æ£€æµ‹åˆ°çš„ï¼Œè¿™è¦å½’åŠŸäº tobs å’Œ OpenTelemetry Operator æ‰€åšçš„é­”æœ¯ğŸª„ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;opentelemetry-operator&#34;&gt;OpenTelemetry Operator&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://opentelemetry.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;OpenTelemetry&lt;/a&gt; æ˜¯ä¸€ä¸ªå¼€æºçš„æ¡†æ¶ï¼Œå¯ä»¥æ•è·ã€è½¬æ¢å’Œè·¯ç”±æ‰€æœ‰ç±»å‹çš„ä¿¡å·ï¼ˆè¿½è¸ªã€æ—¥å¿—å’ŒæŒ‡æ ‡ï¼‰ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä½ ä¼šä½¿ç”¨ &lt;a href=&#34;https://open-telemetry.github.io/opentelemetry-js/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;OpenTelemetry SDK&lt;/a&gt; æ¥åœ¨ä½ çš„åº”ç”¨ç¨‹åºä»£ç ä¸­ç”Ÿæˆè¿™äº›ä¿¡å·ã€‚ä½†æ˜¯ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼ŒOpenTelemetry å¯ä»¥è‡ªåŠ¨æ£€æµ‹ä½ çš„ä»£ç  â€”â€” ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ä½ çš„åº”ç”¨æ¡†æ¶è¢«æ”¯æŒï¼Œå¹¶ä¸”ä½ ä½¿ç”¨çš„è¯­è¨€æ˜¯ OpenTelemetry å¯ä»¥æ³¨å…¥ä»£ç çš„ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ çš„ç³»ç»Ÿå°†å¼€å§‹äº§ç”Ÿé¥æµ‹ï¼Œè€Œä¸éœ€è¦æ‰‹åŠ¨å·¥ä½œã€‚&lt;/p&gt;
&lt;p&gt;è¦äº†è§£ OpenTelemetry æ˜¯å¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹çš„ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦ç†Ÿæ‚‰ &lt;a href=&#34;https://github.com/open-telemetry/opentelemetry-operator&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;OpenTelemetry Operator&lt;/a&gt;ã€‚OpenTelemetry Operator æ˜¯ä¸€ä¸ªå®ç° &lt;a href=&#34;https://kubernetes.io/docs/concepts/extend-kubernetes/operator/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Kubernetes Operator æ¨¡å¼&lt;/a&gt;çš„åº”ç”¨ç¨‹åºï¼Œä¸ Kubernetes é›†ç¾¤ä¸­çš„ä¸¤ä¸ª CustomResourceDefinitionsï¼ˆCRDï¼‰äº’åŠ¨ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾ç¤ºè¯´æ˜-opentelemetry-operator-å¦‚ä½•ä¸-kubernetes-äº’åŠ¨&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ç¤ºè¯´æ˜ OpenTelemetry Operator å¦‚ä½•ä¸ Kubernetes äº’åŠ¨&#34; srcset=&#34;
               /blog/generate-and-store-opentelemetry-traces-automatically/otel-operator-kubernetes_hu9eaea35c1c3da37ce10befac350865f4_54425_89510390ea80e6b60d8a5067819ad3e1.webp 400w,
               /blog/generate-and-store-opentelemetry-traces-automatically/otel-operator-kubernetes_hu9eaea35c1c3da37ce10befac350865f4_54425_67c2a525aead983718379ac249f37412.webp 760w,
               /blog/generate-and-store-opentelemetry-traces-automatically/otel-operator-kubernetes_hu9eaea35c1c3da37ce10befac350865f4_54425_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/generate-and-store-opentelemetry-traces-automatically/otel-operator-kubernetes_hu9eaea35c1c3da37ce10befac350865f4_54425_89510390ea80e6b60d8a5067819ad3e1.webp&#34;
               width=&#34;760&#34;
               height=&#34;481&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ç¤ºè¯´æ˜ OpenTelemetry Operator å¦‚ä½•ä¸ Kubernetes äº’åŠ¨
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;åŸºäº CustomResourceDefinitionsï¼ˆCRD&lt;/a&gt;ï¼‰å®ä¾‹çš„å˜åŒ–ï¼ŒOperator ä¸ºæˆ‘ä»¬ç®¡ç†ä»¥ä¸‹ä¸¤ç‚¹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åˆ›å»ºå’Œåˆ é™¤ OpenTelemetry Collector å®ä¾‹&lt;/li&gt;
&lt;li&gt;å°† OpenTelemetry è‡ªåŠ¨æµ‹é‡æ‰€éœ€çš„åº“å’ŒäºŒè¿›åˆ¶æ–‡ä»¶ç›´æ¥æ³¨å…¥åˆ°ä½ çš„ pod ä¸­&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è®©æˆ‘ä»¬æ›´è¯¦ç»†åœ°è§£è¯»è¿™ä¸¤é¡¹ä»»åŠ¡ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç®¡ç†-opentelemetry-collector&#34;&gt;ç®¡ç† OpenTelemetry Collector&lt;/h2&gt;
&lt;p&gt;OpenTelemetry Operator çš„é¦–è¦ä»»åŠ¡æ˜¯éƒ¨ç½² &lt;a href=&#34;https://opentelemetry.io/docs/collector/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;OpenTelemetry Collector&lt;/a&gt; å®ä¾‹ã€‚è¿™äº›å®ä¾‹å°†è¢«ç”¨æ¥æŠŠä¿¡å·ä»æºå¤´ï¼ˆä½ çš„å·¥ä½œè´Ÿè½½å’Œ Kubernetes æœ¬èº«ï¼‰è·¯ç”±åˆ°å®ƒä»¬çš„ç›®æ ‡ï¼ˆæ”¯æŒ OpenTelemetry åè®®çš„å­˜å‚¨ç³»ç»Ÿæˆ–é›†ç¾¤å¤–çš„å¦ä¸€ä¸ªé‡‡é›†å™¨ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;é‡‡é›†å™¨å¯ä»¥ä»¥ä¸‰ç§ä¸åŒçš„æ–¹å¼éƒ¨ç½²ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä½œä¸º Kubernetes Deploymentï¼šè¿™æ˜¯é»˜è®¤é€‰é¡¹ï¼Œå®ƒå…è®¸é‡‡é›†å™¨æ ¹æ®éœ€è¦åœ¨èŠ‚ç‚¹ä¹‹é—´ç§»åŠ¨ï¼Œæ”¯æŒå‘ä¸Šå’Œå‘ä¸‹æ‰©å±•ã€‚&lt;/li&gt;
&lt;li&gt;ä½œä¸º Kubernetes Daemonsetï¼šè¿™ä¸ªé€‰é¡¹å°†åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šéƒ¨ç½²ä¸€ä¸ªé‡‡é›†å™¨ï¼Œå½“ä½ æƒ³ç¡®ä¿ä½ çš„ä¿¡å·åœ¨æ²¡æœ‰ä»»ä½•ç½‘ç»œå¼€é”€çš„æƒ…å†µä¸‹è¢«å¤„ç†æ—¶ï¼Œå®ƒå¯èƒ½å¾ˆæœ‰ç”¨ã€‚&lt;/li&gt;
&lt;li&gt;ä½œä¸ºä¸€ä¸ª Sidecarï¼šè¢«æ³¨å…¥åˆ°ä»»ä½•æ–°çš„æ³¨é‡Šçš„ pod ä¸­ï¼ˆä½¿ç”¨ &lt;code&gt;sidecar.opentelemetry.io/inject: true&lt;/code&gt;ï¼‰ã€‚å½“é‡‡é›†å™¨éœ€è¦ä¸€ä¸ª pod çš„ç‰¹å®šé…ç½®æ—¶ï¼Œè¿™å¯èƒ½æ˜¯å¾ˆå¥½çš„ï¼ˆä¾‹å¦‚ï¼Œä¹Ÿè®¸å®ƒéœ€è¦ä¸€äº›ä¸“é—¨çš„è½¬æ¢ï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å¦‚æœä½ æ„¿æ„ï¼Œä½ å¯ä»¥æ··åˆå’ŒåŒ¹é…è¿™äº›æ”¶é›†å™¨æ¨¡å¼ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥è®¾ç½®ä¸€ä¸ª sidecarï¼Œä¸ºéƒ¨ç½²ä¸­çš„ pod åšä¸€äº›è½¬æ¢ï¼Œç„¶åå°†å®ƒä»¬å‘é€åˆ°ä¸€ä¸ªå…¨å±€æ”¶é›†å™¨ï¼Œä¸ä½ çš„å…¶ä»–å·¥ä½œè´Ÿè½½å…±äº«ã€‚&lt;/p&gt;
&lt;p&gt;å®šä¹‰è¿™äº›æ”¶é›†å™¨å®ä¾‹çš„é…ç½®åœ¨æ”¶é›†å™¨ CRDï¼ˆ&lt;code&gt;opentelemetrycollectors.opentelemetry.io&lt;/code&gt;ï¼‰ä¸­è¿›è¡Œå»ºæ¨¡ã€‚å…è®¸å¤šä¸ªå®ä¾‹æ¥å®ç°æ›´å¤æ‚çš„æ¨¡å¼ã€‚éƒ¨ç½²ç±»å‹æ˜¯é€šè¿‡ &lt;code&gt;mode&lt;/code&gt; è®¾ç½®æ¥é€‰æ‹©çš„ï¼Œä¼´éšç€ä¸€ä¸ªåŸå§‹çš„é…ç½®å­—ç¬¦ä¸²ï¼Œå®ƒè¢«é€å­—ä¼ é€’ç»™æ§åˆ¶å™¨ï¼Œå¹¶ä½œä¸ºé…ç½®åŠ è½½ã€‚ä¸‹é¢æ˜¯ä½¿ç”¨ Deployment æ¨¡å¼åˆ›å»º Operator çš„ CRD çš„ä¾‹å­ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;opentelemetry.io/v1alpha1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;OpenTelemetryCollector&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;tobs-tobs-opentelemetry&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;default&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;Spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;mode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;deployment&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;config&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;    receivers:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;      jaeger:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;        protocols:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;          grpc:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;          thrift_http:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;      otlp:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;        protocols:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;          grpc:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;          http:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;    exporters:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;      logging:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;      otlp:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;        endpoint: &amp;#34;tobs-promscale-connector.default.svc:9202&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;        compression: none
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;        tls:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;          insecure: true
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;      prometheusremotewrite:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;        endpoint: &amp;#34;tobs-promscale-connector.default.svc:9201/write&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;        tls:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;          insecure: true
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;    processors:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;      batch:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;    service:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;      pipelines:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;        traces:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;          receivers: [jaeger, otlp]
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;          exporters: [logging, otlp]
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;          processors: [batch]
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;        metrics:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;          receivers: [otlp]
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;          processors: [batch]
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;          exporters: [prometheusremotewrite]    &lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ­£å¦‚æˆ‘ä»¬åœ¨åé¢çš„ä¾‹å­ä¸­çœ‹åˆ°çš„ï¼Œå½“ä½ ä½¿ç”¨ &lt;a href=&#34;https://docs.timescale.com/promscale/latest/tobs/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;tobs&lt;/a&gt; æ—¶ï¼Œä½ ä¸éœ€è¦æ‹…å¿ƒæ‰€æœ‰è¿™äº›é…ç½®ç»†èŠ‚ã€‚tobs çš„å¥½å¤„ä¹‹ä¸€æ˜¯å®ƒä¼šä¸ºä½ å®‰è£…ä¸€ä¸ªé‡‡é›†å™¨ï¼Œå®ƒå°†ç›´æ¥æŠŠæ•°æ®å‘é€åˆ°æœ¬åœ°çš„ Promscale å®ä¾‹ã€‚&lt;/p&gt;
&lt;h2 id=&#34;åœ¨-kubernetes-ä¸­æ·»åŠ -opentelemetry-è‡ªåŠ¨ç›‘æµ‹ç³»ç»Ÿ&#34;&gt;åœ¨ Kubernetes ä¸­æ·»åŠ  OpenTelemetry è‡ªåŠ¨ç›‘æµ‹ç³»ç»Ÿ&lt;/h2&gt;
&lt;p&gt;Operator çš„ç¬¬äºŒä¸ªå…³æ³¨ç‚¹æ˜¯å°† OpenTelemetry è‡ªåŠ¨æµ‹é‡æ‰€éœ€çš„åº“å’ŒäºŒè¿›åˆ¶æ–‡ä»¶æ³¨å…¥åˆ° pod ä¸­ã€‚è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œè¿™äº› pod éœ€è¦å®¹çº³ Javaã€Python æˆ– Node.js åº”ç”¨ç¨‹åºï¼ˆOpenTelemetry å°†æ¥ä¼šæ”¯æŒæ›´å¤šè¯­è¨€ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;ç”¨äºéƒ¨ç½²è¿™äº› pod çš„ Kubernetes æ¸…å•æ–‡ä»¶å¿…é¡»åŒ…æ‹¬ä¸€ä¸ªæ³¨é‡Šï¼Œä»¥æŒ‡ç¤º OpenTelemetry Operator å¯¹å…¶è¿›è¡Œæ£€æµ‹ã€‚&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;instrumentation.opentelemetry.io/inject-&amp;lt;language&amp;gt;: &amp;#34;true&amp;#34;   
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å…¶ä¸­ &lt;code&gt;language&lt;/code&gt; å¯ä»¥æ˜¯ &lt;code&gt;python&lt;/code&gt;ã€&lt;code&gt;java&lt;/code&gt; æˆ– &lt;code&gt;nodejs&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å½“æ³¨è§£çš„ pod å¯åŠ¨æ—¶ï¼Œä¼šåˆ›å»ºä¸€ä¸ª &lt;code&gt;init&lt;/code&gt; å®¹å™¨ï¼Œæ³¨å…¥æ‰€éœ€çš„ä»£ç å¹¶æ”¹å˜ pod è¿è¡Œä»£ç çš„æ–¹å¼ï¼Œä½¿ç”¨æ­£ç¡®çš„ OpenTelemetry è‡ªåŠ¨æ¢æµ‹æ–¹æ³•ã€‚å®é™…ä¸Šï¼Œè¿™æ„å‘³ç€åœ¨ä½¿ç”¨ Kubernetes æ—¶ï¼Œä¸éœ€è¦ä¿®æ”¹ä»»ä½•ä»£ç å°±å¯ä»¥è·å¾—è‡ªåŠ¨ç›‘æµ‹çš„å¥½å¤„ã€‚è¯¥é…ç½®è¿˜å®šä¹‰äº† OpenTelemetry Collector ç«¯ç‚¹ï¼Œè¿™äº›è¿½è¸ªå°†è¢«å‘é€åˆ°è¯¥ç«¯ç‚¹ï¼Œä¼ æ’­çš„ä¿¡æ¯ç±»å‹ï¼Œä»¥åŠæˆ‘ä»¬ç”¨æ¥é‡‡æ ·è¿½è¸ªçš„æ–¹æ³•ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰(å…³äº &lt;a href=&#34;https://github.com/open-telemetry/opentelemetry-operator/blob/main/docs/api.md&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;CRD çš„å…¨éƒ¨ç»†èŠ‚ï¼Œè¯·çœ‹æ–‡æ¡£&lt;/a&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;ä¸º Pythonã€Java å’Œ Node.js åº”ç”¨ç¨‹åºæä¾›è‡ªåŠ¨æµ‹é‡çš„è‡ªå®šä¹‰èµ„æºçš„ä¾‹å­æ˜¯è¿™æ ·çš„ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;opentelemetry.io/v1alpha1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Instrumentation&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;tobs-auto-instrumentation&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;default&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;exporter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;endpoint&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;http://tobs-opentelemetry-collector.default.svc:4318 &lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;propagators&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;tracecontext&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;baggage&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;b3&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;sampler&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;argument&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;0.25&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;parentbased_traceidratio&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å†ä¸€æ¬¡ï¼Œå¦‚æœä½ ä½¿ç”¨ &lt;a href=&#34;https://docs.timescale.com/promscale/latest/tobs/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;tobs&lt;/a&gt;ï¼Œä½ å°†ä¸éœ€è¦è‡ªå·±åˆ›å»ºè¿™äº›è‡ªå®šä¹‰èµ„æºã€‚Tobs å°†ç¡®ä¿é›†ç¾¤è¢«è‡ªåŠ¨é…ç½®æˆå¯¹ä»»ä½•æœ‰æ³¨é‡Šçš„ pod è¿›è¡Œæ£€æµ‹ï¼Œè€Œä¸éœ€è¦ä½ åšä»»ä½•æ“ä½œã€‚ä½ æ‰€éœ€è¦åšçš„å°±æ˜¯åœ¨ä½ æƒ³æ”¶é›†è¿½è¸ªçš„ pod ä¸­æ·»åŠ ä»¥ä¸‹æ³¨é‡Šä¹‹ä¸€ã€‚&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;instrumentation.opentelemetry.io/inject-java: &amp;#34;true&amp;#34;
instrumentation.opentelemetry.io/inject-nodejs: &amp;#34;true&amp;#34;
instrumentation.opentelemetry.io/inject-python:&amp;#34;true&amp;#34;
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªä¾‹å­çœ‹çœ‹è¿™åœ¨å®è·µä¸­æ˜¯å¦‚ä½•è¿ä½œçš„ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä½¿ç”¨-opentelemetry-operator-å’Œ-tobs&#34;&gt;ä½¿ç”¨ OpenTelemetry Operator å’Œ Tobs&lt;/h2&gt;
&lt;p&gt;åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æˆ‘ä»¬çš„&lt;a href=&#34;https://github.com/timescale/opentelemetry-demo&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¾®æœåŠ¡æ¼”ç¤ºåº”ç”¨ç¨‹åº&lt;/a&gt;ï¼Œå®ƒç”±ä¸€ä¸ªè¿‡åº¦å·¥ç¨‹åŒ–çš„å¯†ç ç”Ÿæˆå™¨åº”ç”¨ç¨‹åºç»„æˆã€‚&lt;a href=&#34;https://github.com/timescale/opentelemetry-demo&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;åœ¨ repo ä¸­&lt;/a&gt;ï¼Œä½ å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªå·²æµ‹é‡çš„ç‰ˆæœ¬å’Œä¸€ä¸ªæœªæµ‹é‡çš„ç‰ˆæœ¬ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬åœ¨è¿™ä¸ªä¾‹å­ä¸­è¦ä½¿ç”¨çš„ç‰ˆæœ¬ã€‚&lt;/p&gt;
&lt;p&gt;è¦è¿è¡Œè¿™ä¸ªï¼Œä½ é¦–å…ˆéœ€è¦ä¸€ä¸ª Kubernetes é›†ç¾¤ï¼Œå®‰è£…äº† cert-managerï¼Œé…ç½®äº†é€šè¿‡ &lt;code&gt;kubectl&lt;/code&gt;ï¼ˆè‡³å°‘éœ€è¦ 1.21.0 ç‰ˆæœ¬ï¼‰çš„è®¿é—®ï¼Œå¹¶å®‰è£…äº† &lt;a href=&#34;https://helm.sh/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;helm&lt;/a&gt;ã€‚ä¸ºäº†éƒ¨ç½²å’Œè¿è¡Œæ‰€æœ‰ä¸åŒçš„ç»„ä»¶ï¼Œä½ å°†éœ€è¦åœ¨ä½ çš„ Kubernetes é›†ç¾¤ä¸­æä¾›å¤§çº¦ 4 æ ¸ CPU å’Œ 8GB çš„å†…å­˜ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ çš„é›†ç¾¤ä¸­æ²¡æœ‰ cert-managerï¼Œä½ å°†éœ€è¦ä½¿ç”¨è¿™ä¸ªå‘½ä»¤æ¥å®‰è£…å®ƒã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl apply -f 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;https://github.com/cert-manager/cert-manager/releases/download/v1.8.0/cert-manager.yaml
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å‡†å¤‡å¥½åï¼Œè®©æˆ‘ä»¬ä½¿ç”¨ Timescale Helm Chart æ¥å®‰è£… tobsã€‚åœ¨å‘½ä»¤æç¤ºç¬¦ä¸‹è¿è¡Œä»¥ä¸‹å‘½ä»¤ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;helm repo add timescale https://charts.timescale.com/ --force-update
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;helm install --wait --timeout 10m tobs timescale/tobs
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Tobs éœ€è¦å‡ åˆ†é’Ÿçš„æ—¶é—´æ¥å®‰è£…ï¼Œä½†æœ€ç»ˆï¼Œä½ ä¼šçœ‹åˆ°ç±»ä¼¼è¿™æ ·çš„è¾“å‡ºã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;#helm install --wait tobs timescale/tobs&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;NAME: tobs
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;LAST DEPLOYED: Thu May &lt;span class=&#34;m&#34;&gt;19&lt;/span&gt; 11:22:19 &lt;span class=&#34;m&#34;&gt;2022&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;NAMESPACE: default
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;STATUS: deployed
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;REVISION: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;NOTES:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;###############################################################################&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ğŸ‘‹ğŸ½ Welcome to tobs, The Observability Stack &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; Kubernetes
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;âœ¨ Auto-configured and deployed:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ğŸ”¥ Kube-Prometheus
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ğŸ¯ TimescaleDB
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ğŸ¤ Promscale
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ğŸ§ PromLens
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ğŸ“ˆ Grafana
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ğŸš€ OpenTelemetry
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ğŸ¯ Jaeger
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;###################################&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ğŸ‘‰ æ•…éšœæ’é™¤æç¤ºï¼šå¦‚æœä½ å¾—åˆ°è¿™ä¸ªé”™è¯¯ä¿¡æ¯ &lt;code&gt;INSTALLATION FAILED: rate:Wait(n=1) would exceed context deadline&lt;/code&gt;ï¼Œè¿™å¾ˆå¯èƒ½è¡¨æ˜ä½ çš„é›†ç¾¤ä¸­æ²¡æœ‰è¶³å¤Ÿçš„å¯ç”¨èµ„æºã€‚&lt;/p&gt;
&lt;p&gt;ä¸€æ—¦ tobs çš„å®‰è£…å®Œæˆï¼Œæ£€æŸ¥ä½ çš„ Kubernetes é›†ç¾¤ï¼Œç¡®è®¤æ‰€æœ‰çš„ç»„ä»¶éƒ½å·²æ­£ç¡®éƒ¨ç½²ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl get podes --all-namespaces &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; grep &lt;span class=&#34;s2&#34;&gt;&amp;#34;tobs-&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ğŸ‘‰æ•…éšœæ’é™¤æç¤ºï¼šå¦‚æœæŸäº› pod å¤„äºå¾…å®šæˆ–é”™è¯¯çŠ¶æ€ï¼Œä½ å¯ä»¥ä½¿ç”¨ &lt;code&gt;kubectl describe pod &amp;lt;pod-name&amp;gt;&lt;/code&gt; æˆ– &lt;code&gt;kubectl logs &amp;lt;pod-name&amp;gt;&lt;/code&gt; æ¥äº†è§£å¯èƒ½å­˜åœ¨çš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥ä» &lt;a href=&#34;https://github.com/timescale/opentelemetry-demo&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;OpenTelemetry Demo GitHub repo&lt;/a&gt; ä¸­å¯¼å…¥æœªæµ‹é‡çš„ Kubernetes å¾®æœåŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ å›é¡¾ä¸€ä¸‹ &lt;code&gt;uninstrumented&lt;/code&gt; æ–‡ä»¶å¤¹ä¸­çš„ä»£ç ï¼Œä½ ä¼šå‘ç°å®ƒæ²¡æœ‰æåˆ° OpenTelemetryã€‚ä¾‹å¦‚ï¼Œçœ‹ä¸€ä¸‹ &lt;code&gt;load&lt;/code&gt; å¾®æœåŠ¡çš„ Python æ–‡ä»¶ï¼ˆè¿™ä¸ªæœåŠ¡é€šè¿‡å‘å‡ºå¯†ç è¯·æ±‚æ¥é©±åŠ¨å…¶ä»–æœåŠ¡çš„æµé‡ï¼‰ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;vm&#34;&gt;__name__&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;__main__&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;é€šè¿‡å°†è¿™äº›å¾®æœåŠ¡å¯¼å…¥å®‰è£…äº† tobs çš„é›†ç¾¤ä¸­ï¼Œå®ƒä»¬å°†è‡ªåŠ¨è·å¾— OpenTelemetry è¿½è¸ªçš„æµ‹é‡å·¥å…·ã€‚&lt;/p&gt;
&lt;p&gt;è¦è°ƒå‡ºæ¼”ç¤ºåº”ç”¨ç¨‹åºï¼Œè¯·è¿è¡Œï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl apply -k &lt;span class=&#34;s1&#34;&gt;&amp;#39;http://github.com/timescale/opentelemetry-demo/yaml/app&amp;#39;&lt;/span&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å½“è¿™ä¸ªè¿‡ç¨‹ç»“æŸï¼Œåº”ç”¨ç¨‹åºè¢«éƒ¨ç½²æ—¶ï¼Œå®ƒå°†å·²ç»è¢« OpenTelemetry è¿½è¸ªå™¨æ‰€è®°å½•ã€‚è¿½è¸ªç°åœ¨æ­£åœ¨ç”Ÿæˆå¹¶è‡ªåŠ¨å‘é€åˆ° Promscaleã€‚&lt;/p&gt;
&lt;p&gt;è¿™ç§é­”æ³•æ˜¯å¦‚ä½•å‘ç”Ÿçš„ï¼Ÿ&lt;/p&gt;
&lt;p&gt;è¿™é‡Œæœ‰ä¸€ä¸ªæ€»ç»“æ€§çš„è§£é‡Šï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ¯ä¸ª pod éƒ½è¢«æ³¨è§£ä¸º &lt;code&gt;instrumentation.opentelemetry.io/inject-python: &amp;quot;true&amp;quot;&lt;/code&gt;ï¼Œæ‰€ä»¥å½“å®ƒä»¬å¯åŠ¨æ—¶ï¼Œä¼šè¢« OpenTelemetry Operator æ³¨æ„åˆ°ã€‚&lt;/li&gt;
&lt;li&gt;æ¥ä¸‹æ¥ï¼Œä½¿ç”¨ä¸€ä¸ªçªå˜çš„ webhook æ·»åŠ ä¸€ä¸ª init å®¹å™¨ï¼Œæ³¨å…¥ Python åº“å’Œå¯ç”¨æµ‹é‡å·¥å…·æ‰€éœ€çš„ä»£ç ã€‚&lt;/li&gt;
&lt;li&gt;ç„¶åï¼Œè¿½è¸ªæ•°æ®è¢«å‘é€åˆ° Instrumentation CRD ä¸­æ³¨æ˜çš„ OpenTelemetry Collectorã€‚&lt;/li&gt;
&lt;li&gt;OpenTelemetry Collector å°†æ•°æ®å‘é€åˆ° Promscaleï¼ˆå’Œ TimescaleDBï¼‰ï¼Œä»é‚£é‡Œå¯ä»¥ç›´æ¥ç”¨ SQL æŸ¥è¯¢æˆ–ç”¨ Grafana ç­‰å·¥å…·è¿›è¡Œå¯è§†åŒ–è®¿é—®ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è®©æˆ‘ä»¬çœ‹çœ‹æˆ‘ä»¬ç›´æ¥ä» Grafanaï¼ˆtobs ä¹Ÿè‡ªåŠ¨å®‰è£…åœ¨æˆ‘ä»¬çš„é›†ç¾¤ä¸­ï¼‰è‡ªåŠ¨ç”Ÿæˆçš„è¿½è¸ªã€‚&lt;/p&gt;
&lt;p&gt;è¦è·å¾— Grafana å®ä¾‹çš„ç®¡ç†ç”¨æˆ·çš„å¯†ç ï¼Œè¯·è¿è¡Œä»¥ä¸‹å‘½ä»¤ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl get secret tobs-grafana -o &lt;span class=&#34;nv&#34;&gt;jsonpath&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;{.data.admin-password}&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; base64 -d 
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl port-forward svc/tobs-grafana 3000:80
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç„¶åï¼Œå¯¼èˆªåˆ° http://localhost:3000/d/vBhEewLnkï¼Œä½¿ç”¨ä½ åˆšåˆšæ‰¾å›çš„å¯†ç ï¼Œä»¥ç®¡ç†å‘˜ç”¨æˆ·èº«ä»½ç™»å½•ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://docs.timescale.com/promscale/latest/visualize-data/apm-experience/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Promscale åº”ç”¨æ€§èƒ½ç›‘æ§ï¼ˆAPMï¼‰ä»ªè¡¨ç›˜&lt;/a&gt;å°†æ˜¾ç¤ºå‡ºæ¥ï¼Œå‘ä½ å±•ç¤ºå…³äºæ¼”ç¤ºåº”ç”¨çš„æ´å¯ŸåŠ›ã€‚Tobs ç›´æ¥å¯¼å…¥è¿™å¥—å¼€ç®±å³ç”¨ã€å¯ç”¨äºç”Ÿäº§çš„ä»ªè¡¨ç›˜ï¼Œæˆ‘ä»¬åœ¨ Grafana ä¸­ä½¿ç”¨ SQL æŸ¥è¯¢å¯¹è¿½è¸ªæ•°æ®è¿›è¡Œæ„å»ºï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®ƒæ˜¯ç”±æ¼”ç¤ºå¾®æœåŠ¡è‡ªåŠ¨ç”Ÿæˆçš„ã€‚ä¸‹å›¾æ˜¾ç¤ºäº†å…¶ä¸­ä¸€ä¸ªä»ªè¡¨ç›˜ â€”â€”â€œæœåŠ¡è¯¦æƒ…â€ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-ç”¨æ¼”ç¤ºåº”ç”¨ç¨‹åºçš„è¿½è¸ªæ•°æ®å¡«å……çš„æœåŠ¡ç»†èŠ‚ä»ªè¡¨ç›˜&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;ç”¨æ¼”ç¤ºåº”ç”¨ç¨‹åºçš„è¿½è¸ªæ•°æ®å¡«å……çš„&amp;lt;a href=&amp;#34;https://docs.timescale.com/promscale/latest/visualize-data/apm-experience/&amp;#34; target=&amp;#34;_blank&amp;#34; rel=&amp;#34;noopener&amp;#34;&amp;gt;æœåŠ¡ç»†èŠ‚ä»ªè¡¨ç›˜&amp;lt;/a&amp;gt;&#34; srcset=&#34;
               /blog/generate-and-store-opentelemetry-traces-automatically/service-overview_hu7b2370ea432b5684d50aba5f5c723790_152700_e987cee28e5586d3309d943b90593978.webp 400w,
               /blog/generate-and-store-opentelemetry-traces-automatically/service-overview_hu7b2370ea432b5684d50aba5f5c723790_152700_38fa9f225f71344d9cc7cadc07a0349a.webp 760w,
               /blog/generate-and-store-opentelemetry-traces-automatically/service-overview_hu7b2370ea432b5684d50aba5f5c723790_152700_1200x1200_fit_q75_h2_lanczos_3.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/generate-and-store-opentelemetry-traces-automatically/service-overview_hu7b2370ea432b5684d50aba5f5c723790_152700_e987cee28e5586d3309d943b90593978.webp&#34;
               width=&#34;760&#34;
               height=&#34;390&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      ç”¨æ¼”ç¤ºåº”ç”¨ç¨‹åºçš„è¿½è¸ªæ•°æ®å¡«å……çš„&amp;lt;a href=&amp;#34;https://docs.timescale.com/promscale/latest/visualize-data/apm-experience/&amp;#34; target=&amp;#34;_blank&amp;#34; rel=&amp;#34;noopener&amp;#34;&amp;gt;æœåŠ¡ç»†èŠ‚ä»ªè¡¨ç›˜&amp;lt;/a&amp;gt;
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;å…³äºè¿™äº›é¢„å»ºä»ªè¡¨ç›˜çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·&lt;a href=&#34;https://www.timescale.com/blog/observability-powered-by-sql-understand-your-systems-like-never-before-with-opentelemetry-traces-and-postgresql/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æŸ¥çœ‹è¿™ç¯‡åšæ–‡&lt;/a&gt;ï¼ˆå¯¼èˆªåˆ° â€œé›†æˆåˆ° Grafana çš„ç°ä»£ APM ä½“éªŒâ€ ä¸€èŠ‚ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å·²ç»å¾—åˆ°äº†æ‰€æœ‰è¿™äº›ä¿¡æ¯ï¼Œè€Œåœ¨ä»»ä½• Python æœåŠ¡ä¸­éƒ½æ²¡æœ‰æµ‹é‡å·¥å…·ä»£ç ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;OpenTelemetry è¿½è¸ªä»æœªåƒç°åœ¨è¿™æ ·æ–¹ä¾¿ã€‚&lt;a href=&#34;https://opentelemetry.io/docs/collector/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¦‚æœä½ çš„å¾®æœåŠ¡æ˜¯ç”¨ OpenTelemetry Operator ç›®å‰æ”¯æŒçš„è¯­è¨€ä¹‹ä¸€ç¼–å†™çš„&lt;/a&gt;ï¼Œä½ å¯ä»¥ç«‹å³å¼€å§‹æ”¶é›†å’Œå­˜å‚¨è¿½è¸ªæ•°æ®ï¼Œåªéœ€è¦å¾ˆå°‘çš„æ‰‹åŠ¨å·¥ä½œã€‚ä½ åªéœ€é‡‡å–ä»¥ä¸‹ä¸¤ä¸ªæ­¥éª¤ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/timescale/tobs/blob/master/chart/README.md#install&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;é€šè¿‡ Helm åœ¨ä½ çš„ Kubernetes é›†ç¾¤ä¸­å®‰è£… tobs&lt;/a&gt;(è¯·æ³¨æ„ï¼Œä½ å¿…é¡»ä½¿ç”¨ Helm æ¥å®‰è£… tobsï¼Œæ‰èƒ½ä½¿è¿™ä¸ªæœ€æ–°ç‰ˆæœ¬å‘æŒ¥ä½œç”¨ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ CLI)ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨éƒ¨ç½²ä¹‹å‰ï¼Œç»™ä½ æƒ³æ”¶é›†è¿½è¸ªæ•°æ®çš„å¾®æœåŠ¡ pods æ·»åŠ &lt;a href=&#34;https://github.com/open-telemetry/opentelemetry-operator#opentelemetry-auto-instrumentation-injection&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ³¨è§£&lt;/a&gt;ï¼ˆä¾‹å¦‚ &lt;code&gt;instrumentation.opentelemetry.io/inject-python: &amp;quot;true&amp;quot;&lt;/code&gt;ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä½ çš„å¾®æœåŠ¡å°†è‡ªåŠ¨è¢« OpenTelemetry è¿½è¸ªå™¨æ£€æµ‹ï¼Œä½ çš„è¿½è¸ªå™¨å°†è‡ªåŠ¨å­˜å‚¨åœ¨ Promscale ä¸­ï¼ŒPromscale æ˜¯å»ºç«‹åœ¨ PostgreSQL å’Œ TimescaleDB ä¸Šçš„ç»Ÿä¸€çš„æŒ‡æ ‡å’Œè¿½è¸ªå™¨çš„å¯è§‚æµ‹æ€§åç«¯ã€‚&lt;/p&gt;
&lt;p&gt;é€šè¿‡ &lt;a href=&#34;https://docs.timescale.com/promscale/latest/visualize-data/apm-experience/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Promscale é¢„å…ˆå»ºç«‹çš„ APM ä»ªè¡¨ç›˜&lt;/a&gt;ï¼Œä½ å°†ç«‹å³äº†è§£åˆ°ä½ çš„ç³»ç»Ÿæ€§èƒ½å¦‚ä½•ï¼Œå¹¶ä¸”ä½ å°†èƒ½å¤Ÿ&lt;a href=&#34;https://www.timescale.com/blog/observability-powered-by-sql-understand-your-systems-like-never-before-with-opentelemetry-traces-and-postgresql/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä½¿ç”¨ SQL æŸ¥è¯¢ä½ çš„è¿½è¸ª&lt;/a&gt;ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>æ··æ²Œå·¥ç¨‹å’Œè§†è§‰éšå–»çš„å¯è§‚æµ‹æ€§</title>
      <link>https://lib.jimmysong.io/blog/chaos-engineering-observability-visual-metaphors/</link>
      <pubDate>Tue, 24 May 2022 10:00:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/chaos-engineering-observability-visual-metaphors/</guid>
      <description>&lt;h2 id=&#34;ä¸»è¦æ”¶è·&#34;&gt;ä¸»è¦æ”¶è·&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;å¯¹äºç°ä»£è½¯ä»¶ç³»ç»Ÿæ¥è¯´ï¼Œå¯è§‚æµ‹æ€§ä¸æ˜¯å…³äºæ•°å­¦æ–¹ç¨‹ã€‚å®ƒæ˜¯å…³äºäººç±»å¦‚ä½•ä¸å¤æ‚çš„ç³»ç»Ÿäº’åŠ¨å¹¶è¯•å›¾ç†è§£å®ƒä»¬ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æ··æ²Œå·¥ç¨‹åˆ©ç”¨äº†å¯è§‚æµ‹æ€§ï¼Œå› ä¸ºå®ƒå¯ä»¥æ£€æµ‹åˆ°ç³»ç»Ÿç¨³å®šçŠ¶æ€çš„åå·®ã€‚æ··æ²Œå·¥ç¨‹å€ŸåŠ©å¯è§‚æµ‹æ€§å¯ä»¥å‘ç°å’Œå…‹æœç³»ç»Ÿçš„å¼±ç‚¹ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å¯è§‚æµ‹æ€§ä¾èµ–äºç³»ç»Ÿæ‰€å‘å‡ºçš„ä¿¡å·ï¼Œè¿™äº›ä¿¡å·æä¾›äº†å…³äºç³»ç»Ÿè¡Œä¸ºçš„åŸå§‹æ•°æ®ã€‚ç„¶è€Œï¼Œå¯è§‚æµ‹æ€§ä¸ä»…å—é™äºè¿™äº›ä¿¡å·çš„è´¨é‡ï¼Œè¿˜å—é™äºè¿™äº›ä¿¡å·çš„å¯è§†åŒ–å’Œè§£é‡Šçš„æ–¹å¼ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è€ƒè™‘åˆ°æ··æ²Œå·¥ç¨‹ã€å¯è§‚æµ‹æ€§å’Œå¯è§†åŒ–æ¶‰åŠåˆ°äººç±»è‡ªæˆ‘çš„è§£é‡Šï¼Œä»ªè¡¨ç›˜çš„è®¾è®¡è€…å¯èƒ½ä¼šå¯¹è¿™äº›è§£é‡Šäº§ç”Ÿåå·®ï¼Œè¿™æ˜¯ä¸€ä¸ªäº‹å®ã€‚åœ¨è¿™ä¸ªæ„ä¹‰ä¸Šï¼Œè§†è§‰éšå–»å¹¶ä¸èƒ½ä¿è¯æˆ‘ä»¬ä»¥æ­£ç¡®çš„æ–¹å¼è§£é‡Šè¿™äº›æ•°æ®ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åŸºäºè§†è§‰éšå–»çš„ä»ªè¡¨ç›˜å¯ä»¥æä¾›æ¯”ç»å…¸çš„å¯è§†åŒ–æ›´æœ‰ç”¨çš„æ•°æ®ã€‚ç„¶è€Œï¼Œè¿™ä¸¤ç§ç­–ç•¥éƒ½å¾ˆå®¹æ˜“äº§ç”Ÿåå·®ï¼›ä¾‹å¦‚ï¼Œåœ¨ä¸€é¡¹ç ”ç©¶ä¸­ï¼Œå¤§å¤šæ•°å‚ä¸è€…éƒ½æ³¨æ„åˆ°ï¼Œç”±äºæ˜¾ç¤ºäº†ç³Ÿç³•çš„æŸ±çŠ¶å›¾å’Œçº¿çŠ¶å›¾ï¼Œæ²¡æœ‰åœ¨å›¾ä¸­æ˜¾ç¤ºå‡ºé‡è¦çš„åˆ†ç•Œç‚¹ï¼Œå› æ­¤æ•´ä½“ç»“æœæ˜¯æœ‰åå·®çš„ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è‡ªä» Netflixã€Slack å’Œ Linkedin ç­‰é¢†å…ˆçš„æŠ€æœ¯å…¬å¸é‡‡ç”¨æ··æ²Œå·¥ç¨‹æ¥æŠµå¾¡ç”Ÿäº§ä¸­çš„æ„å¤–ä¸­æ–­åï¼Œè¿™é—¨å­¦ç§‘åœ¨è¿‘æ¥å·²ç»æˆä¸ºä¸»æµã€‚åœ¨è¿™æ¡é“è·¯ä¸Šï¼Œå¯è§‚æµ‹æ€§å‘æŒ¥äº†å…³é”®ä½œç”¨ï¼Œä¸ºå·¥ç¨‹å¸ˆä»¬å¸¦æ¥äº†æ•°æ®å’Œç›‘æ§çš„åŠ›é‡ï¼Œä»–ä»¬ç°åœ¨æœ‰äº†äº†è§£è‡ªå·±ç³»ç»Ÿçš„ç­–ç•¥ï¼Œç¡®å®šå½“æŸäº›ä¸œè¥¿å‘ç”Ÿæ•…éšœæ—¶å®ƒä»¬å°†å¦‚ä½•è¡¨ç°ï¼Œå¹¶å¢åŠ å¤åŸåŠ›å’Œå¯é æ€§ã€‚&lt;/p&gt;
&lt;p&gt;æ··æ²Œå·¥ç¨‹å’Œå¯è§‚æµ‹æ€§æ˜¯ä¸¤ä¸ªå¯†åˆ‡ç›¸å…³çš„å­¦ç§‘ã€‚æ ¹æ® Russ Miles çš„è¯´æ³•ï¼Œ&amp;quot;å¯è§‚æµ‹æ€§åŸåˆ™å°†ç³»ç»Ÿå˜æˆäº†å¯æ£€æŸ¥å’Œå¯è°ƒè¯•çš„æ¡ˆå‘ç°åœºï¼Œè€Œæ··æ²Œå·¥ç¨‹é¼“åŠ±å¹¶åˆ©ç”¨å¯è§‚æµ‹æ€§ï¼Œå› ä¸ºå®ƒè¯•å›¾å¸®åŠ©é¢„å…ˆå‘ç°å¹¶å…‹æœç³»ç»Ÿçš„å¼±ç‚¹ &amp;quot;ã€‚æ··æ²Œå·¥ç¨‹é¼“åŠ±å¹¶è¦æ±‚å¯è§‚æµ‹æ€§ï¼Œå› ä¸ºè¦è‡ªä¿¡åœ°æ‰§è¡Œæ··æ²Œå®éªŒï¼Œå¯è§‚æµ‹æ€§å¿…é¡»æ£€æµ‹ç³»ç»Ÿä½•æ—¶æ­£å¸¸ï¼Œä»¥åŠåœ¨æ‰§è¡Œæ–¹æ³•å®éªŒæ—¶å¦‚ä½•åç¦»è¯¥ç¨³å®šçŠ¶æ€ã€‚è§å›¾ 1 ä¸­çš„è¯´æ˜ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-1-æ··æ²Œå·¥ç¨‹å’Œå¯è§‚æµ‹æ€§&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 1. æ··æ²Œå·¥ç¨‹å’Œå¯è§‚æµ‹æ€§&#34; srcset=&#34;
               /blog/chaos-engineering-observability-visual-metaphors/f1_huf280a69d36e74c95041d917268dd5fcf_36322_5d7fb018e0e824d2448996f75ff4f637.webp 400w,
               /blog/chaos-engineering-observability-visual-metaphors/f1_huf280a69d36e74c95041d917268dd5fcf_36322_b2bb9661845b41200cb05c69a2d66c51.webp 760w,
               /blog/chaos-engineering-observability-visual-metaphors/f1_huf280a69d36e74c95041d917268dd5fcf_36322_1200x1200_fit_q75_h2_lanczos_2.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/chaos-engineering-observability-visual-metaphors/f1_huf280a69d36e74c95041d917268dd5fcf_36322_5d7fb018e0e824d2448996f75ff4f637.webp&#34;
               width=&#34;760&#34;
               height=&#34;399&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 1. æ··æ²Œå·¥ç¨‹å’Œå¯è§‚æµ‹æ€§
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;å­¦æœ¯ç•Œå’Œç§‘æŠ€ç•Œéƒ½åšå‡ºäº†å·¨å¤§çš„åŠªåŠ›ï¼Œä¸ºå®è·µæ··æ²Œå·¥ç¨‹å’Œå¯è§‚æµ‹æ€§æä¾›äº†å·¥å…·ã€‚ç„¶è€Œï¼ŒæŒ‡æ ‡çš„å¯è§†åŒ–å’Œè§†è§‰ç­–ç•¥çš„é€‚å½“é€‰æ‹©ä»ç„¶æ˜¯æœ‰é™çš„ã€‚æœ¬æ–‡å¼•å…¥äº†ä¸€ä¸ªæ–°çš„è§’è‰²ï¼šè§†è§‰éšå–»ã€‚å…·ä½“æ¥è¯´ï¼Œå®ƒæä¾›äº†æ··æ²Œå·¥ç¨‹å’Œå¯è§‚æµ‹æ€§çš„æ¦‚å¿µåŸºç¡€ï¼Œä»‹ç»äº†å¸‚åœºä¸Šå¯ç”¨çš„å¯è§†åŒ–æŠ€æœ¯çš„ç°çŠ¶ï¼Œå¹¶å±•ç¤ºäº†æ ‘çŠ¶å›¾ã€ä»ªè¡¨å›¾ã€åœ°ç†å›¾å’ŒåŸå¸‚éšå–»æ˜¯å¦‚ä½•ä¸°å¯Œè§‚å¯Ÿæ··æ²Œçš„è§†è§‰ç­–ç•¥çš„ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ··æ²Œå·¥ç¨‹å’Œå¯è§‚æµ‹æ€§çš„åŸºç¡€&#34;&gt;æ··æ²Œå·¥ç¨‹å’Œå¯è§‚æµ‹æ€§çš„åŸºç¡€&lt;/h2&gt;
&lt;p&gt;å…³äºæ··æ²Œå·¥ç¨‹ï¼šæ··æ²Œã€å¼¹æ€§å’Œå¯é æ€§æ˜¯å…³é”®çš„æ¦‚å¿µï¼Œè€Œå…³äºå¯è§‚æµ‹æ€§ï¼Œå½“äººç±»æƒ³è¦è§‚å¯Ÿä»–ä»¬çš„ç³»ç»Ÿæ—¶ï¼Œç›‘æ§ã€åº¦é‡å’Œä»ªè¡¨ç›˜æ˜¯è‡³å…³é‡è¦çš„ã€‚å› æ­¤ï¼Œåœ¨æ·±å…¥ç ”ç©¶æ··æ²Œå·¥ç¨‹å’Œå¯è§‚æµ‹æ€§ä¹‹é—´çš„å…³ç³»ä¹‹å‰ï¼Œæ˜ç¡®è¿™äº›å®šä¹‰å¾ˆé‡è¦ã€‚&lt;/p&gt;
&lt;p&gt;æ··æ²Œå·¥ç¨‹æ ¹æ®æ··æ²ŒåŸç†å®šä¹‰ä¸ºä¸€é—¨åœ¨ç³»ç»Ÿä¸Šè¿›è¡Œå®éªŒçš„å­¦ç§‘ï¼Œä»¥å»ºç«‹å¯¹ç³»ç»Ÿåœ¨ç”Ÿäº§ä¸­æ‰¿å—åŠ¨è¡æ¡ä»¶èƒ½åŠ›çš„ä¿¡å¿ƒã€‚ä¸ºäº†å…·ä½“è§£å†³å¤§è§„æ¨¡åˆ†å¸ƒå¼ç³»ç»Ÿçš„ä¸ç¡®å®šæ€§ï¼Œæ··æ²Œå·¥ç¨‹æä¾›äº†ä¸€ç§åŸºäºå®éªŒçš„æ–¹æ³•ï¼ŒåŒ…æ‹¬å››ä¸ªæ­¥éª¤ï¼šç¬¬ä¸€ä¸ªæ­¥éª¤åŒ…æ‹¬å®šä¹‰ç¨³å®šçŠ¶æ€ï¼Œè¿™æ˜¯ç³»ç»Ÿçš„ä¸€ä¸ªå¯æµ‹é‡çš„è¾“å‡ºï¼Œè¡¨ç¤ºæ­£å¸¸è¡Œä¸ºã€‚ç¬¬äºŒæ­¥æ˜¯ä¸å‡è®¾ç›¸å…³çš„ï¼Œå®ƒæå‡ºäº†ä¸€ä¸ªæ”¹å˜ç¨³æ€çš„åæœçš„å¥å­ã€‚æœ‰äº†è¿™ä¸ªå‡è®¾ï¼Œå°±è¯¥å¼•å…¥ç°å®ä¸–ç•Œçš„äº‹ä»¶ï¼Œå¦‚æœåŠ¡å™¨å´©æºƒæˆ–ç¡¬ç›˜æ•…éšœï¼Œä»¥è¯å®æˆ–åé©³è¿™ä¸ªå‡è®¾ã€‚æœ€åï¼Œç›®æ ‡æ˜¯å»ºç«‹æ§åˆ¶ç»„å’Œå®éªŒç»„ä¹‹é—´ç¨³å®šçŠ¶æ€çš„å·®å¼‚åˆ†æã€‚&lt;/p&gt;
&lt;p&gt;å¯è§‚æµ‹æ€§æ˜¯æŒ‡èƒ½å¤Ÿå®Œå…¨ç†è§£ä¸€ä¸ªç³»ç»Ÿã€‚åœ¨æ§åˆ¶ç†è®ºä¸­ï¼Œå®ƒè¢«å®šä¹‰ä¸ºè¡¡é‡ä¸€ä¸ªç³»ç»Ÿçš„å†…éƒ¨çŠ¶æ€å¯ä»¥ä»å…¶å¤–éƒ¨è¾“å‡ºçš„çŸ¥è¯†ä¸­æ¨æ–­å‡ºæ¥çš„ç¨‹åº¦ã€‚ç‰¹åˆ«æ˜¯åœ¨è½¯ä»¶å·¥ç¨‹ä¸­ï¼Œå¯è§‚æµ‹æ€§å¯ä»¥è¢«æè¿°ä¸ºæå‡ºé€‚å½“çš„é—®é¢˜ã€æä¾›æ­£ç¡®çš„ç­”æ¡ˆä»¥åŠç”¨æ”¶é›†åˆ°çš„æ•°æ®å»ºç«‹çŸ¥è¯†çš„è‰ºæœ¯ã€‚&lt;/p&gt;
&lt;p&gt;ç›‘æ§ä¸å¯è§‚æµ‹æ€§æ˜¯ä¸åŒçš„ï¼Œç†è§£ä¸¤è€…çš„åŒºåˆ«å¾ˆé‡è¦ã€‚ç›‘æ§æ˜¯å…³äºæ”¶é›†ã€å¤„ç†ã€æ±‡æ€»å’Œæ˜¾ç¤ºç³»ç»Ÿçš„å®æ—¶å®šé‡æ•°æ®ï¼›è€Œå¯è§‚æµ‹æ€§æ˜¯å…³äºå¤„ç†å’Œåˆ†æè¿™äº›æ•°æ®ï¼Œè®©å›¢é˜Ÿä¸»åŠ¨ç†è§£å’Œè°ƒè¯•ç³»ç»Ÿçš„è¡Œä¸ºã€‚å¯¹äºç°ä»£è½¯ä»¶ç³»ç»Ÿæ¥è¯´ï¼Œå¯è§‚æµ‹æ€§ä¸æ˜¯å…³äºæ•°å­¦å…¬å¼ã€‚å®ƒæ˜¯å…³äºäººä»¬å¦‚ä½•ä¸å¤æ‚çš„ç³»ç»Ÿäº’åŠ¨å¹¶è¯•å›¾ç†è§£å®ƒä»¬ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿™ä¸ªæ„ä¹‰ä¸Šï¼Œç›‘æ§æ¶‰åŠåˆ°é€šè¿‡æ•°å­—è¯»å–ç³»ç»Ÿå‘å‡ºçš„ä¿¡å·ï¼Œè¿™äº›æ•°å­—è¢«å‘½åä¸ºåº¦é‡ã€‚æŒ‡æ ‡æ˜¯ä¸€ä¸ªå•ä¸€çš„æ•°å­—ï¼Œå¯ä»¥é€‰æ‹©é™„åŠ æ ‡ç­¾è¿›è¡Œåˆ†ç»„å’Œæœç´¢ï¼Œæ¯”å¦‚æŸ¥è¯¢æ¬¡æ•°å’Œç±»å‹ã€é”™è¯¯æ¬¡æ•°å’Œç±»å‹ã€å¤„ç†æ—¶é—´æˆ–æœåŠ¡å™¨å¯¿å‘½ã€‚è¿™äº›æ•°å€¼åœ¨ä»ªè¡¨ç›˜ä¸­è¢«å¯è§†åŒ–ï¼Œä»ªè¡¨ç›˜æ˜¯æä¾›æœåŠ¡æ ¸å¿ƒæŒ‡æ ‡çš„æ‘˜è¦è§†å›¾çš„åº”ç”¨ç¨‹åºã€‚&lt;/p&gt;
&lt;p&gt;ä¼ ç»Ÿçš„ä»ªè¡¨ç›˜æ˜¯å»ºç«‹åœ¨æŠ˜çº¿å›¾ã€é¥¼å›¾æˆ–æŸ±çŠ¶å›¾ä¸Šçš„ã€‚è€ƒè™‘åˆ°å¯è§‚æµ‹æ€§å–å†³äºç³»ç»Ÿå‘å‡ºçš„ä¿¡å·ä»¥åŠè¿™äº›ä¿¡å·è¢«å¯è§†åŒ–å’Œè§£é‡Šçš„è´¨é‡ï¼Œæä¾›æœ€å¥½çš„å·¥å…·å’Œè®¾è®¡æ˜¯å¾ˆé‡è¦çš„ã€‚å¦‚æœé¢œè‰²ã€å›¾ä¾‹å’Œæ¯”ä¾‹ä½¿ç”¨ä¸å½“ï¼Œä¸€äº›å¯è§†åŒ–å¯èƒ½ä¼šå¯¹æ“ä½œè€…é€ æˆé™åˆ¶å’Œå›°æƒ‘ã€‚ä¸‹ä¸€èŠ‚æä¾›äº†ç›‘æ§å’Œå¯è§‚æµ‹æ€§çš„æŠ€æœ¯çŠ¶å†µï¼Œå¹¶æ›´è¯¦ç»†åœ°æè¿°äº†å…¶ä¸­çš„ä¸€äº›é™åˆ¶ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç›‘æ§å’Œå¯è§‚æµ‹æ€§&#34;&gt;ç›‘æ§å’Œå¯è§‚æµ‹æ€§&lt;/h2&gt;
&lt;p&gt;ç›‘æ§å’Œå¯è§‚æµ‹æ€§å·²ç»æˆä¸ºå·¥ç¨‹å›¢é˜Ÿå’Œä¸€èˆ¬ç°ä»£æ•°å­—ä¼ä¸šæœ€åŸºæœ¬çš„èƒ½åŠ›ä¹‹ä¸€ï¼Œä»–ä»¬å¸Œæœ›åœ¨ä»–ä»¬çš„è§£å†³æ–¹æ¡ˆä¸­æä¾›å“è¶Šã€‚ç”±äºç›‘æ§å’Œè§‚å¯Ÿç³»ç»Ÿæœ‰å¾ˆå¤šåŸå› ï¼Œè°·æ­Œè®°å½•äº†å››ä¸ªé»„é‡‘ä¿¡å·æˆ–æŒ‡æ ‡ï¼Œå®ƒä»¬å®šä¹‰äº†ç³»ç»Ÿå¥åº·çš„å«ä¹‰ï¼Œæ˜¯å¯è§‚æµ‹æ€§å’Œç›‘æ§å¹³å°ç°çŠ¶çš„åŸºç¡€ã€‚è¿™å››ä¸ªæŒ‡æ ‡æè¿°å¦‚ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;å»¶è¿Ÿï¼ˆLatencyï¼‰æ˜¯æŒ‡ä¸€ä¸ªæœåŠ¡ä¸ºä¸€ä¸ªè¯·æ±‚æä¾›æœåŠ¡æ‰€éœ€çš„æ—¶é—´ã€‚å®ƒåŒ…æ‹¬ç”±äºä¸æ•°æ®åº“æˆ–å…¶ä»–å…³é”®åç«¯å¤±å»è¿æ¥è€Œè§¦å‘çš„ HTTP 500 é”™è¯¯ï¼Œè¿™äº›é”™è¯¯å¯èƒ½ä¸ä¼šå¾ˆå¿«å¾—åˆ°æœåŠ¡ã€‚å»¶è¿Ÿæ˜¯ä¸€ä¸ªåŸºæœ¬æŒ‡æ ‡ï¼Œå› ä¸ºæ…¢çš„é”™è¯¯ç”šè‡³æ¯”å¿«çš„é”™è¯¯æ›´ç³Ÿç³•ã€‚&lt;/p&gt;
&lt;p&gt;æµé‡ï¼ˆTrafficï¼‰æ˜¯è¡¡é‡å¯¹ç³»ç»Ÿçš„éœ€æ±‚æœ‰å¤šå¤§ã€‚å®ƒå†³å®šäº†ç³»ç»Ÿåœ¨æŸä¸€ç‰¹å®šæ—¶é—´å†…ä»ç”¨æˆ·æˆ–é€šè¿‡æœåŠ¡è¿è¡Œçš„äº‹åŠ¡ä¸­æ‰¿å—å¤šå¤§çš„å‹åŠ›ã€‚ä»¥ç½‘ç»œæœåŠ¡ä¸ºä¾‹ï¼Œè¿™ç§æµ‹é‡é€šå¸¸æ˜¯æ¯ç§’çš„ HTTP è¯·æ±‚ã€‚é€šè¿‡ç›‘æ§åº”ç”¨ç¨‹åºæˆ–æœåŠ¡ä¸­çš„çœŸå®ç”¨æˆ·äº’åŠ¨å’Œæµé‡ï¼Œå·¥ç¨‹å›¢é˜Ÿå¯ä»¥çœ‹åˆ°ç³»ç»Ÿå¦‚ä½•æ”¯æŒéœ€æ±‚çš„å˜åŒ–ï¼Œä»¥åŠä»–ä»¬åº”è¯¥å¦‚ä½•æ‰©å±•èµ„æºä»¥æ»¡è¶³éœ€æ±‚ã€‚&lt;/p&gt;
&lt;p&gt;é”™è¯¯ï¼ˆErrorï¼‰ä¸è¯·æ±‚å¤±è´¥çš„æ¯”ç‡æœ‰å…³ï¼Œæ— è®ºæ˜¯æ˜¾æ€§çš„è¿˜æ˜¯éšæ€§çš„ã€‚æ ¹æ®ç³»ç»Ÿå’Œå‘ç”Ÿæ•…éšœçš„ç»„ä»¶ï¼Œç›‘æ§é”™è¯¯æƒ…å†µå¯èƒ½ä¼šæœ‰å¾ˆå¤§çš„ä¸åŒã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå·¥ç¨‹å›¢é˜Ÿéœ€è¦ç›‘æ§æ•´ä¸ªç³»ç»Ÿçš„é”™è¯¯å‘ç”Ÿç‡ï¼Œä½†ä¹Ÿéœ€è¦ç›‘æ§å•ä¸ªæœåŠ¡å±‚é¢çš„é”™è¯¯å‘ç”Ÿç‡çš„åŸå› ã€‚åŒæ ·é‡è¦çš„æ˜¯ï¼Œè¦ä¼˜å…ˆè€ƒè™‘å“ªäº›é”™è¯¯æ˜¯å…³é”®çš„ï¼Œå“ªäº›é”™è¯¯æ˜¯ä¸å¤ªå±é™©çš„ã€‚&lt;/p&gt;
&lt;p&gt;æœ€åï¼Œé¥±å’Œåº¦ï¼ˆSaturationï¼‰æ˜¯ç³»ç»Ÿå¯¹èµ„æºåˆ©ç”¨çš„ä¿¡å·ï¼Œå¦‚å†…å­˜ã€I/O æˆ– CPUã€‚è€ƒè™‘åˆ°è®¸å¤šç³»ç»Ÿåœ¨è¾¾åˆ° 100% çš„åˆ©ç”¨ç‡ä¹‹å‰å°±ä¼šå‡ºç°æ€§èƒ½ä¸‹é™çš„æƒ…å†µï¼Œæ‹¥æœ‰ä¸€ä¸ªé¥±å’Œåº¦ç›®æ ‡æ˜¯éå¸¸é‡è¦çš„ã€‚å®ƒå…è®¸æˆ‘ä»¬å›ç­”è¿™æ ·çš„é—®é¢˜ï¼šæœåŠ¡è¿˜æœ‰å¤šå°‘å®¹é‡ï¼Ÿä»€ä¹ˆæ°´å¹³çš„é¥±å’Œåº¦èƒ½ä¿è¯å®¢æˆ·çš„æœåŠ¡æ€§èƒ½å’Œå¯ç”¨æ€§ï¼Ÿ&lt;/p&gt;
&lt;h2 id=&#34;ç”¨äºç›‘æ§çš„ä¼ ç»Ÿå¯è§†åŒ–æ–¹æ³•&#34;&gt;ç”¨äºç›‘æ§çš„ä¼ ç»Ÿå¯è§†åŒ–æ–¹æ³•&lt;/h2&gt;
&lt;p&gt;ç°åœ¨ï¼Œä¸Šä¸€èŠ‚æ‰€è¿°çš„å››ä¸ªé»„é‡‘ä¿¡å·æ˜¯ç”¨ä¼ ç»Ÿæ–¹æ³•ç›‘æ§çš„ï¼Œå¦‚æŠ˜çº¿å›¾ã€æŸ±çŠ¶å›¾æˆ–é¥¼çŠ¶å›¾ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚å›¾ 2 æ‰€ç¤ºï¼ŒæŠ˜çº¿å›¾æ˜¯å°†ç³»ç»Ÿçš„å››ä¸ªé»„é‡‘ä¿¡å·çš„è¡Œä¸ºåœ¨æ—¶é—´ä¸Šå¯è§†åŒ–çš„æœ€å¸¸ç”¨ç­–ç•¥ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-2-è™šæ„é¡¹ç›®ä¸­çš„æŠ˜çº¿å›¾&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 2. è™šæ„é¡¹ç›®ä¸­çš„æŠ˜çº¿å›¾&#34; srcset=&#34;
               /blog/chaos-engineering-observability-visual-metaphors/f2_hu88aeb9acab18176e9eb3c67caa5e4d41_26588_a7071667ac1f1e2b91f04ef67672971c.webp 400w,
               /blog/chaos-engineering-observability-visual-metaphors/f2_hu88aeb9acab18176e9eb3c67caa5e4d41_26588_0c8c4496e612c4a2c59bdf77da85218f.webp 760w,
               /blog/chaos-engineering-observability-visual-metaphors/f2_hu88aeb9acab18176e9eb3c67caa5e4d41_26588_1200x1200_fit_q75_h2_lanczos_2.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/chaos-engineering-observability-visual-metaphors/f2_hu88aeb9acab18176e9eb3c67caa5e4d41_26588_a7071667ac1f1e2b91f04ef67672971c.webp&#34;
               width=&#34;760&#34;
               height=&#34;362&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 2. è™šæ„é¡¹ç›®ä¸­çš„æŠ˜çº¿å›¾
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;çº¿å½¢å›¾åœ¨é¢œè‰²ã€å›¾ä¾‹ã€è½´å’Œç³»åˆ—çš„æ ‡é¢˜æ–¹é¢æå‡ºäº†ä¸åŒçš„æŒ‘æˆ˜ï¼Œå› ä¸ºå˜é‡ä¼šèšã€äº¤å‰ï¼Œè€Œä¸”é€šå¸¸ä¼šçº ç¼ åœ¨ä¸€èµ·ã€‚å¦‚æœä»ªè¡¨ç›˜çš„åˆ›å»ºè€…æ²¡æœ‰ä½¿ç”¨é€‚å½“çš„è§†è§‰èµ„äº§ï¼Œè¿™ç§ç±»å‹çš„å›¾å½¢å¯èƒ½ä¼šå˜æˆæœ€ä»¤äººå›°æƒ‘çš„å›¾è¡¨ä¹‹ä¸€ã€‚&lt;/p&gt;
&lt;p&gt;å¦ä¸€ä¸ªå¸¸è§çš„å›¾è¡¨æ˜¯æŸ±çŠ¶å›¾ï¼Œå®ƒæ˜¯ç”¨é«˜åº¦æˆ–é•¿åº¦ä¸æ‰€ä»£è¡¨çš„æ•°å€¼æˆæ­£æ¯”çš„çŸ©å½¢æ¡æ¥è¡¨ç¤ºåˆ†ç±»æ•°æ®ã€‚å¦‚å›¾ 3 æ‰€ç¤ºï¼Œä¸€äº›äº‘ä¾›åº”å•†ç”¨å®ƒä»¬æ¥è¡¨ç¤ºæ—¥å¿—çš„åˆ†ç±»æ•°æ®ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-3-ä¸€ä¸ªè™šæ„çš„é¡¹ç›®ä¸­çš„æŸ±çŠ¶å›¾&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 3. ä¸€ä¸ªè™šæ„çš„é¡¹ç›®ä¸­çš„æŸ±çŠ¶å›¾&#34; srcset=&#34;
               /blog/chaos-engineering-observability-visual-metaphors/f3_huec1427940dfdc13893b83265e8be3044_20366_f171ab2438faaf52e91c84f8323a02f9.webp 400w,
               /blog/chaos-engineering-observability-visual-metaphors/f3_huec1427940dfdc13893b83265e8be3044_20366_5bb59c44a456b6ffb7869609155d97d6.webp 760w,
               /blog/chaos-engineering-observability-visual-metaphors/f3_huec1427940dfdc13893b83265e8be3044_20366_1200x1200_fit_q75_h2_lanczos_2.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/chaos-engineering-observability-visual-metaphors/f3_huec1427940dfdc13893b83265e8be3044_20366_f171ab2438faaf52e91c84f8323a02f9.webp&#34;
               width=&#34;760&#34;
               height=&#34;315&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 3. ä¸€ä¸ªè™šæ„çš„é¡¹ç›®ä¸­çš„æŸ±çŠ¶å›¾
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;æœ€åï¼Œå°½ç®¡è¾ƒå°‘ä½¿ç”¨ï¼Œé¥¼å›¾æ˜¯è¡¨ç¤ºå’Œæ¯”è¾ƒæ•°æ®åˆ†å¸ƒä¸­çš„æ¯”ä¾‹çš„ä¸€ç§ç®€å•æ–¹æ³•ã€‚å½“ä¸€ä¸ªæ¯”ä¾‹å ä¸»å¯¼åœ°ä½â€”â€”ä¸€åŠæˆ–å››åˆ†ä¹‹ä¸‰æ—¶ï¼Œå®ƒä»¬æ˜¯æœ€æœ‰æ•ˆçš„ã€‚è¶…è¿‡å‡ ç§é¢œè‰²çš„æ¥”å½¢å›¾ä¼šåœ¨æ¥”å½¢å›¾ä¹‹é—´äº§ç”ŸåŒä¸€æ€§ï¼Œä½¿å…¶éš¾ä»¥æ¯”è¾ƒæ•°å€¼ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘åˆ°è¿™äº›å±€é™æ€§ï¼Œä¸‹ä¸€èŠ‚å°†ä»‹ç»ä¸€ç§ä¸åŒçš„æ–¹å¼æ¥å¯è§†åŒ–è¿™å››ä¸ªé»„é‡‘æŒ‡æ ‡ã€‚ç”±äºæœ¬æ–‡æ˜¯å…³äºæ··æ²Œå·¥ç¨‹çš„ï¼Œè¿™ç§æŠ€æœ¯æ˜¯åœ¨æŠ¥å‘Šäº‹ä»¶çš„æƒ…å†µä¸‹è¿›è¡Œåˆ†æçš„ã€‚&lt;/p&gt;
&lt;h2 id=&#34;è§†è§‰éšå–»ä½œä¸ºè§†è§‰åŒ–æ··æ²Œçš„ä¸€ç§å»ºè®®&#34;&gt;è§†è§‰éšå–»ä½œä¸ºè§†è§‰åŒ–æ··æ²Œçš„ä¸€ç§å»ºè®®&lt;/h2&gt;
&lt;p&gt;ä¸ºäº†å…‹æœå‰é¢æåˆ°çš„å±€é™æ€§ï¼Œæœ¬æ–‡æå‡ºäº†ä¸€ç§æ–°çš„ç­–ç•¥ï¼Œå°†ç”Ÿäº§ä¸­çš„æ··ä¹±ç°è±¡å¯è§†åŒ–ã€‚è¿™ä¸ªå»ºè®®æ˜¯åŸºäºå…¶ä»–ç§‘å­¦é¢†åŸŸçš„ä¸€ä¸ªæ¦‚å¿µï¼šè§†è§‰éšå–»ã€‚è§†è§‰éšå–»æ˜¯ä¸€ç§ç­–ç•¥ï¼Œå°†ä¸€ä¸ªåº”ç”¨é¢†åŸŸçš„æ¦‚å¿µå’Œå¯¹è±¡æ˜ å°„åˆ°ä¸€ä¸ªç›¸ä¼¼æ€§å’Œç±»æ¯”çš„ç³»ç»Ÿä¸­ã€‚è®¡ç®—æœºéšå–»æ˜¯äº¤äº’å¼è§†è§‰å¯¹è±¡å’Œæ¨¡å‹å¯¹è±¡ä¹‹é—´åŒåŒ–çš„åŸºæœ¬æ€æƒ³ã€‚å®ƒçš„ä½œç”¨æ˜¯ä¿ƒè¿›å¯¹å¯¹è±¡çš„è¯­ä¹‰çš„æ›´å¥½ç†è§£ã€‚ä¸€ä¸ªç†Ÿæ‚‰çš„ä¾‹å­å¯ä»¥æ˜¯åœ¨è·‘è½¦çš„å›¾ç‰‡å‰ä½¿ç”¨ä¸€åªè±¹å­ï¼Œæš—ç¤ºè¯¥äº§å“å…·æœ‰é€Ÿåº¦ã€åŠ›é‡å’Œè€åŠ›ç­‰å¯æ¯”æ€§ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€äº›ä¾‹å­åŒ…æ‹¬ï¼šåœ°å›¾ã€åŸå¸‚å’Œå‡ ä½•åœºæ™¯ï¼Œå¦‚å›¾ 3 æ‰€ç¤ºã€‚è¯¥å›¾æ˜¾ç¤ºäº†åŸå¸‚éšå–»ï¼Œè¿™æ˜¯ä¸€ç§ç”¨äºå¯è§†åŒ–ç¨‹åºä»£ç å±æ€§çš„æµè¡Œæ–¹æ³•ã€‚è®¸å¤šé¡¹ç›®éƒ½é‡‡ç”¨äº†è¿™ç§éšå–»æ¥å¯è§†åŒ–è½¯ä»¶åº“çš„å±æ€§ï¼Œæ¯”å¦‚è¯´ã€‚ç°æœ‰çš„ç ”ç©¶å·²ç»è¢«ç”¨æ¥ç”¨åŒ…æ¥æ˜ å°„è¡—åŒºï¼Œç”¨å»ºç­‘æ¥æ˜ å°„ç±»ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-4-ä¸€ä¸ªè™šæ„é¡¹ç›®ä¸­çš„åŸå¸‚éšå–»æ¥è‡ªè¿™é‡Œ&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 4. ä¸€ä¸ªè™šæ„é¡¹ç›®ä¸­çš„åŸå¸‚éšå–»ï¼Œæ¥è‡ª&amp;lt;a href=&amp;#34;https://www.researchgate.net/publication/224503826_Visual_Exploration_of_Large-Scale_Evolving_Software&amp;#34; target=&amp;#34;_blank&amp;#34; rel=&amp;#34;noopener&amp;#34;&amp;gt;è¿™é‡Œ&amp;lt;/a&amp;gt;&#34; srcset=&#34;
               /blog/chaos-engineering-observability-visual-metaphors/f4_hu88c9b151cfdb4b13fa315b0869397f32_20182_639d60ca309b4fa0a9f1d6248f19003d.webp 400w,
               /blog/chaos-engineering-observability-visual-metaphors/f4_hu88c9b151cfdb4b13fa315b0869397f32_20182_aa172a266c11157371240586a8a2dc60.webp 760w,
               /blog/chaos-engineering-observability-visual-metaphors/f4_hu88c9b151cfdb4b13fa315b0869397f32_20182_1200x1200_fit_q75_h2_lanczos_2.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/chaos-engineering-observability-visual-metaphors/f4_hu88c9b151cfdb4b13fa315b0869397f32_20182_639d60ca309b4fa0a9f1d6248f19003d.webp&#34;
               width=&#34;500&#34;
               height=&#34;384&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 4. ä¸€ä¸ªè™šæ„é¡¹ç›®ä¸­çš„åŸå¸‚éšå–»ï¼Œæ¥è‡ª&amp;lt;a href=&amp;#34;https://www.researchgate.net/publication/224503826_Visual_Exploration_of_Large-Scale_Evolving_Software&amp;#34; target=&amp;#34;_blank&amp;#34; rel=&amp;#34;noopener&amp;#34;&amp;gt;è¿™é‡Œ&amp;lt;/a&amp;gt;
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè¿™ä¸ªéšå–»æŠŠç±»è¡¨ç¤ºä¸ºå»ºç­‘ç‰©ï¼ŒæŠŠåŒ…è¡¨ç¤ºä¸ºå»ºç­‘ç‰©æ‰€å¤„çš„é‚»åŸŸã€‚å»ºç­‘ç‰©çš„æ¯ä¸ªè¾¹ç¼˜éƒ½è¢«ç”¨æ¥æ˜ å°„ç±»çš„å±æ€§ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æå‡ºä¸€ä¸ªå°†äº‹ä»¶å¯è§†åŒ–çš„å®éªŒ&#34;&gt;æå‡ºä¸€ä¸ªå°†äº‹ä»¶å¯è§†åŒ–çš„å®éªŒ&lt;/h2&gt;
&lt;p&gt;ä¸ºäº†ç¡®å®šå‚ä¸è¿è¥æ´»åŠ¨çš„å·¥ç¨‹å›¢é˜Ÿçš„çœ‹æ³•ï¼Œæˆ‘ä»¬å¯¹ä»–ä»¬ä¸­çš„ 28 äººè¿›è¡Œäº†å…³äºä¼ ç»Ÿä»ªè¡¨ç›˜å’Œè§†è§‰éšå–»çš„è°ƒæŸ¥ã€‚å…·ä½“æ¥è¯´ï¼Œä»–ä»¬è¢«é—®åŠä½¿ç”¨ç»å…¸ä»ªè¡¨ç›˜å’Œè§†è§‰éšå–»å¯¹å››ä¸ªé»„é‡‘æŒ‡æ ‡ï¼ˆé”™è¯¯ã€å»¶è¿Ÿã€æµé‡å’Œé¥±å’Œåº¦ï¼‰è¿›è¡Œå¯è§†åŒ–çš„äº‹ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é¡¹ç ”ç©¶ç”±å…³äºä¸€ä¸ªäº‹ä»¶çš„å…·ä½“é—®é¢˜ç»„æˆï¼Œå…¶ä¸­æä¾›äº†ä¸¤ç§å¯è§†åŒ–ï¼šä¸€ç§æ˜¯ä¼ ç»Ÿçš„å›¾è¡¨ï¼Œå¦ä¸€ç§æ˜¯è§†è§‰éšå–»ã€‚å¯¹äºæ¯ä¸€ç§æƒ…å†µï¼Œéƒ½åˆ†æäº†æ¯ç§å¯è§†åŒ–çš„ä»·å€¼ã€‚åœ¨æ¥ä¸‹æ¥çš„æ®µè½ä¸­ï¼Œå°†ä»‹ç»æ¯ä¸ªé—®é¢˜å’Œåˆ†æã€‚&lt;/p&gt;
&lt;p&gt;å…³äºäººå£ç»Ÿè®¡å­¦ï¼Œå…±æœ‰ 28 åå‚ä¸è€…ï¼Œå…¶èƒŒæ™¯åˆ†å¸ƒåœ¨åç«¯ã€å‰ç«¯å’Œå…¨æ ˆå·¥ç¨‹å¸ˆã€è½¯ä»¶æ¶æ„å¸ˆã€æ•°æ®å·¥ç¨‹å¸ˆå’Œç½‘ç«™å¯é æ€§å·¥ç¨‹å¸ˆã€‚å¦‚å›¾ 5 æ‰€ç¤ºï¼Œå‚ä¸äººæ•°æœ€å¤šçš„æ˜¯åç«¯å¼€å‘å·¥ç¨‹å¸ˆã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-5-äººå£ç»Ÿè®¡å­¦æ•°æ®&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 5. äººå£ç»Ÿè®¡å­¦æ•°æ®&#34; srcset=&#34;
               /blog/chaos-engineering-observability-visual-metaphors/f5_hud694102797a2daf59095aa51e0491a3e_41428_6fc1f3923bd515b4cb18185818326384.webp 400w,
               /blog/chaos-engineering-observability-visual-metaphors/f5_hud694102797a2daf59095aa51e0491a3e_41428_ca77edf6b3ca05bf5b1d10acd1c83280.webp 760w,
               /blog/chaos-engineering-observability-visual-metaphors/f5_hud694102797a2daf59095aa51e0491a3e_41428_1200x1200_fit_q75_h2_lanczos_2.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/chaos-engineering-observability-visual-metaphors/f5_hud694102797a2daf59095aa51e0491a3e_41428_6fc1f3923bd515b4cb18185818326384.webp&#34;
               width=&#34;760&#34;
               height=&#34;424&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 5. äººå£ç»Ÿè®¡å­¦æ•°æ®
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;ç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯å…³äº é¥±å’Œä¿¡å·ã€‚åŸºæœ¬ä¸Šï¼Œä½¿ç”¨äº†ä¸¤ä¸ªä»ªè¡¨ç›˜â€”â€”ä¸€ä¸ªæŠ˜çº¿å›¾å’Œä¸€ä¸ªåŸå¸‚éšå–»æ¥è¯¢é—®äº”ä¸ªå¾®æœåŠ¡çš„çŠ¶æ€ï¼š&lt;code&gt;ms_authentication&lt;/code&gt;ã€&lt;code&gt;ms_patients&lt;/code&gt;ã€&lt;code&gt;ms_payments&lt;/code&gt;ã€&lt;code&gt;ms_medications&lt;/code&gt; å’Œ &lt;code&gt;ms_appointments&lt;/code&gt;ã€‚è¿™äº›å¾®æœåŠ¡æ˜¯ä¸€ä¸ªè™šæ„çš„åŒ»ç–—ç³»ç»Ÿçš„ä¸€éƒ¨åˆ†ã€‚&lt;/p&gt;
&lt;p&gt;å…·ä½“æ¥è¯´ï¼Œé—®é¢˜æ˜¯ï¼šä½¿ç”¨ä¼ ç»Ÿçš„ä»ªè¡¨æ¿ï¼ˆè§å›¾ 6ï¼‰å’Œè§†è§‰éšå–»ï¼ˆè§å›¾ 7ï¼‰ï¼Œå“ªä¸ªå¾®æœåŠ¡å—åˆ°å½±å“ï¼Ÿæ­£ç¡®ç­”æ¡ˆæ˜¯ &lt;code&gt;ms_authentication&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-6-ä¼ ç»Ÿçš„æŠ˜çº¿å›¾&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 6. ä¼ ç»Ÿçš„æŠ˜çº¿å›¾&#34; srcset=&#34;
               /blog/chaos-engineering-observability-visual-metaphors/f6_hu5590d6aeee985513de58bd4f08a66814_30036_1ee9e729212ec6cb4d9f654db74dd193.webp 400w,
               /blog/chaos-engineering-observability-visual-metaphors/f6_hu5590d6aeee985513de58bd4f08a66814_30036_13da0e1ea8b702da78230414f4c32386.webp 760w,
               /blog/chaos-engineering-observability-visual-metaphors/f6_hu5590d6aeee985513de58bd4f08a66814_30036_1200x1200_fit_q75_h2_lanczos_2.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/chaos-engineering-observability-visual-metaphors/f6_hu5590d6aeee985513de58bd4f08a66814_30036_1ee9e729212ec6cb4d9f654db74dd193.webp&#34;
               width=&#34;760&#34;
               height=&#34;470&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 6. ä¼ ç»Ÿçš„æŠ˜çº¿å›¾
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-7-å¯è§†åŒ–çš„åŸå¸‚æ¯”å–»&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 7. å¯è§†åŒ–çš„åŸå¸‚æ¯”å–»&#34; srcset=&#34;
               /blog/chaos-engineering-observability-visual-metaphors/f7_hu06c9486b33bb5f5571cb6cfa8753345a_53008_849a632ac66913cbb50b1d54977118c9.webp 400w,
               /blog/chaos-engineering-observability-visual-metaphors/f7_hu06c9486b33bb5f5571cb6cfa8753345a_53008_f5caa61c40cac053a9e8748f658fc86b.webp 760w,
               /blog/chaos-engineering-observability-visual-metaphors/f7_hu06c9486b33bb5f5571cb6cfa8753345a_53008_1200x1200_fit_q75_h2_lanczos_2.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/chaos-engineering-observability-visual-metaphors/f7_hu06c9486b33bb5f5571cb6cfa8753345a_53008_849a632ac66913cbb50b1d54977118c9.webp&#34;
               width=&#34;760&#34;
               height=&#34;570&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 7. å¯è§†åŒ–çš„åŸå¸‚æ¯”å–»
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;å¦‚å›¾ 8 æ‰€ç¤ºï¼Œå½“ä»–ä»¬ä½¿ç”¨è§†è§‰éšå–»æ—¶ï¼Œä¸€äº›å‚ä¸è€…çš„ç­”æ¡ˆæ”¹å˜äº†ï¼Œé€‰æ‹©äº†æ­£ç¡®çš„ç­”æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-8-ä½¿ç”¨ä¼ ç»Ÿå›¾è¡¨ä¸è§†è§‰éšå–»çš„å‚ä¸è€…çš„å›ç­”&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 8. ä½¿ç”¨ä¼ ç»Ÿå›¾è¡¨ä¸è§†è§‰éšå–»çš„å‚ä¸è€…çš„å›ç­”&#34; srcset=&#34;
               /blog/chaos-engineering-observability-visual-metaphors/f8_hu5bcc871e02eba00554a68ce49cf38a36_18330_ca0ae0f9fd58663980ac08bb34025b9a.webp 400w,
               /blog/chaos-engineering-observability-visual-metaphors/f8_hu5bcc871e02eba00554a68ce49cf38a36_18330_179f3b49e5d007a9cd7dd4c0e446ddbe.webp 760w,
               /blog/chaos-engineering-observability-visual-metaphors/f8_hu5bcc871e02eba00554a68ce49cf38a36_18330_1200x1200_fit_q75_h2_lanczos_2.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/chaos-engineering-observability-visual-metaphors/f8_hu5bcc871e02eba00554a68ce49cf38a36_18330_ca0ae0f9fd58663980ac08bb34025b9a.webp&#34;
               width=&#34;760&#34;
               height=&#34;320&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 8. ä½¿ç”¨ä¼ ç»Ÿå›¾è¡¨ä¸è§†è§‰éšå–»çš„å‚ä¸è€…çš„å›ç­”
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;æ‰€æœ‰å‚ä¸è€…éƒ½è®¤ä¸ºï¼Œå— CPU é«˜åˆ©ç”¨ç‡å½±å“çš„å¾®æœåŠ¡æ˜¯è®¤è¯ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè§†è§‰éšå–»æ¯”ä¼ ç»Ÿçš„å›¾è¡¨æ›´æœ‰ç”¨ï¼Œå› ä¸ºå›¾è¡¨çº¿å¾ˆæ··ä¹±ï¼Œè€Œä¸”é¢œè‰²ã€å½¢çŠ¶å’Œå¤§å°éƒ½ä¸å¥½ï¼Œæ”¹å˜äº†å‚ä¸è€…çš„çœ‹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;å…³äºé”™è¯¯ä¿¡å·ï¼Œæˆ‘ä»¬ç”¨ç»å…¸çš„æŸ±çŠ¶å›¾å’Œæ ‘çŠ¶å›¾æ¥è¦æ±‚å‚ä¸è€…è®¡ç®—æ¯ä¸ªå¾®æœåŠ¡çš„å¹³å‡é”™è¯¯ï¼Œå¦‚å›¾ 9 æ‰€ç¤ºã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-9-ç”¨äºå¯è§†åŒ–è¯¯å·®çš„ä¼ ç»ŸæŸ±çŠ¶å›¾&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 9. ç”¨äºå¯è§†åŒ–è¯¯å·®çš„ä¼ ç»ŸæŸ±çŠ¶å›¾&#34; srcset=&#34;
               /blog/chaos-engineering-observability-visual-metaphors/f9_hu559d840f31751b1167744030403ab852_30166_971d7e48c9f2a61b10d467821226c341.webp 400w,
               /blog/chaos-engineering-observability-visual-metaphors/f9_hu559d840f31751b1167744030403ab852_30166_b77ff086fff6e5f915ee9a79adec1483.webp 760w,
               /blog/chaos-engineering-observability-visual-metaphors/f9_hu559d840f31751b1167744030403ab852_30166_1200x1200_fit_q75_h2_lanczos_2.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/chaos-engineering-observability-visual-metaphors/f9_hu559d840f31751b1167744030403ab852_30166_971d7e48c9f2a61b10d467821226c341.webp&#34;
               width=&#34;760&#34;
               height=&#34;570&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 9. ç”¨äºå¯è§†åŒ–è¯¯å·®çš„ä¼ ç»ŸæŸ±çŠ¶å›¾
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-10-ç”¨äºå¯è§†åŒ–é”™è¯¯çš„å¯è§†åŒ–æ ‘çŠ¶å›¾éšå–»&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 10. ç”¨äºå¯è§†åŒ–é”™è¯¯çš„å¯è§†åŒ–æ ‘çŠ¶å›¾éšå–»&#34; srcset=&#34;
               /blog/chaos-engineering-observability-visual-metaphors/f10_hua3195c7c96c70dd3c846b12d78cb14a9_18716_ddc62a921dc2aff3227ae56fdc16329d.webp 400w,
               /blog/chaos-engineering-observability-visual-metaphors/f10_hua3195c7c96c70dd3c846b12d78cb14a9_18716_fb541186e99cf3cc9b08ae4cfe7f652b.webp 760w,
               /blog/chaos-engineering-observability-visual-metaphors/f10_hua3195c7c96c70dd3c846b12d78cb14a9_18716_1200x1200_fit_q75_h2_lanczos_2.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/chaos-engineering-observability-visual-metaphors/f10_hua3195c7c96c70dd3c846b12d78cb14a9_18716_ddc62a921dc2aff3227ae56fdc16329d.webp&#34;
               width=&#34;760&#34;
               height=&#34;570&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 10. ç”¨äºå¯è§†åŒ–é”™è¯¯çš„å¯è§†åŒ–æ ‘çŠ¶å›¾éšå–»
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;æ­£ç¡®çš„ç­”æ¡ˆæ˜¯ &lt;code&gt;ms_appointments&lt;/code&gt;ï¼Œè™½ç„¶æœ‰äº›å‚ä¸è€…æ²¡æœ‰é€‰æ‹©å®ƒï¼Œä½†å½“ä»–ä»¬ä½¿ç”¨è§†è§‰éšå–»æ—¶ï¼Œè®¸å¤šäººæ”¹å˜äº†ä»–ä»¬çš„ç­”æ¡ˆã€‚å›¾ 11 è¯´æ˜äº†è¿™ä¸€ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-11-å‚ä¸è€…ä½¿ç”¨ä¼ ç»Ÿå›¾è¡¨ä¸è§†è§‰éšå–»æ¥å¯è§†åŒ–é”™è¯¯çš„ç­”æ¡ˆ&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 11. å‚ä¸è€…ä½¿ç”¨ä¼ ç»Ÿå›¾è¡¨ä¸è§†è§‰éšå–»æ¥å¯è§†åŒ–é”™è¯¯çš„ç­”æ¡ˆ&#34; srcset=&#34;
               /blog/chaos-engineering-observability-visual-metaphors/f11_hufb52c87f4f746414a891e3a6678ca879_17740_1872b7f97e3073fc67fc96da84d3ebef.webp 400w,
               /blog/chaos-engineering-observability-visual-metaphors/f11_hufb52c87f4f746414a891e3a6678ca879_17740_9eeb70bde9ec5d18ae643d93f31f345f.webp 760w,
               /blog/chaos-engineering-observability-visual-metaphors/f11_hufb52c87f4f746414a891e3a6678ca879_17740_1200x1200_fit_q75_h2_lanczos_2.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/chaos-engineering-observability-visual-metaphors/f11_hufb52c87f4f746414a891e3a6678ca879_17740_1872b7f97e3073fc67fc96da84d3ebef.webp&#34;
               width=&#34;760&#34;
               height=&#34;320&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 11. å‚ä¸è€…ä½¿ç”¨ä¼ ç»Ÿå›¾è¡¨ä¸è§†è§‰éšå–»æ¥å¯è§†åŒ–é”™è¯¯çš„ç­”æ¡ˆ
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;å…³äºæµé‡ä¿¡å·ï¼Œæˆ‘ä»¬ç”¨ä¸€ä¸ªç»å…¸çš„æŸ±çŠ¶å›¾å’Œä¸€ä¸ªåœ°ç†ä¸­å¿ƒçš„éšå–»æ¥è¯¢é—®å‚ä¸è€…å“ªä¸ªç¬¬ä¸‰æ–¹æœåŠ¡çš„æµé‡æ›´å¤§ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒåŸæœ‰çš„å¾®æœåŠ¡å’Œæ–°çš„å››ä¸ªç¬¬ä¸‰æ–¹æœåŠ¡ï¼š&lt;code&gt;srv_ldap&lt;/code&gt;ã€&lt;code&gt;srv_goverment&lt;/code&gt;ã€&lt;code&gt;srv_assurance&lt;/code&gt; å’Œ &lt;code&gt;srv_authentication&lt;/code&gt; ä¹‹é—´çš„äº’åŠ¨è¢«åˆ†æäº†ã€‚å›¾ 12 ç”¨æŸ±çŠ¶å›¾æ˜¾ç¤ºäº†è¿™ç§æ•´åˆï¼Œå›¾ 13 ç”¨åœ°ç†ä¸­å¿ƒçš„éšå–»æ˜¾ç¤ºäº†ç›¸åŒçš„æµé‡å€¼ã€‚åœ¨è¿™ä¸ªæ¯”å–»ä¸­ï¼Œåœ†åœˆä»£è¡¨æœåŠ¡å’Œå¾®æœåŠ¡ï¼Œçº¿æ¡è¿æ¥å®ƒä»¬ä¹‹é—´çš„å…³ç³»ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-12-ç”¨äºå¯è§†åŒ–å¾®æœåŠ¡å’Œç¬¬ä¸‰æ–¹æœåŠ¡ä¹‹é—´æµé‡çš„ä¼ ç»ŸæŸ±çŠ¶å›¾&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 12. ç”¨äºå¯è§†åŒ–å¾®æœåŠ¡å’Œç¬¬ä¸‰æ–¹æœåŠ¡ä¹‹é—´æµé‡çš„ä¼ ç»ŸæŸ±çŠ¶å›¾&#34; srcset=&#34;
               /blog/chaos-engineering-observability-visual-metaphors/f12_hu1e2b96f432e1eb414b09ea0182bcbb6b_16406_6dd60bbb299279159e708431f5278dc5.webp 400w,
               /blog/chaos-engineering-observability-visual-metaphors/f12_hu1e2b96f432e1eb414b09ea0182bcbb6b_16406_5e76b95d1820fd6044312887fa31e2e6.webp 760w,
               /blog/chaos-engineering-observability-visual-metaphors/f12_hu1e2b96f432e1eb414b09ea0182bcbb6b_16406_1200x1200_fit_q75_h2_lanczos_2.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/chaos-engineering-observability-visual-metaphors/f12_hu1e2b96f432e1eb414b09ea0182bcbb6b_16406_6dd60bbb299279159e708431f5278dc5.webp&#34;
               width=&#34;760&#34;
               height=&#34;570&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 12. ç”¨äºå¯è§†åŒ–å¾®æœåŠ¡å’Œç¬¬ä¸‰æ–¹æœåŠ¡ä¹‹é—´æµé‡çš„ä¼ ç»ŸæŸ±çŠ¶å›¾
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-13-ç”¨äºå¯è§†åŒ–å¾®æœåŠ¡å’Œç¬¬ä¸‰æ–¹æœåŠ¡ä¹‹é—´æµé‡çš„å¯è§†åŒ–åœ°ç†ä¸­å¿ƒéšå–»&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 13. ç”¨äºå¯è§†åŒ–å¾®æœåŠ¡å’Œç¬¬ä¸‰æ–¹æœåŠ¡ä¹‹é—´æµé‡çš„å¯è§†åŒ–åœ°ç†ä¸­å¿ƒéšå–»&#34; srcset=&#34;
               /blog/chaos-engineering-observability-visual-metaphors/f13_hua57f5e5c08bf33cf890b28d0bdfb0e25_21180_dd7b9d20afbc634fbd73d38f1b50ac84.webp 400w,
               /blog/chaos-engineering-observability-visual-metaphors/f13_hua57f5e5c08bf33cf890b28d0bdfb0e25_21180_fc95584fa2e09b78c209d0382eebdaa5.webp 760w,
               /blog/chaos-engineering-observability-visual-metaphors/f13_hua57f5e5c08bf33cf890b28d0bdfb0e25_21180_1200x1200_fit_q75_h2_lanczos_2.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/chaos-engineering-observability-visual-metaphors/f13_hua57f5e5c08bf33cf890b28d0bdfb0e25_21180_dd7b9d20afbc634fbd73d38f1b50ac84.webp&#34;
               width=&#34;760&#34;
               height=&#34;570&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 13. ç”¨äºå¯è§†åŒ–å¾®æœåŠ¡å’Œç¬¬ä¸‰æ–¹æœåŠ¡ä¹‹é—´æµé‡çš„å¯è§†åŒ–åœ°ç†ä¸­å¿ƒéšå–»
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;å°½ç®¡æœ‰çº¿æ¡å’Œå¤§å°æ¥ä»£è¡¨å¾®æœåŠ¡å’Œç¬¬ä¸‰æ–¹æœåŠ¡ä¹‹é—´çš„è¿æ¥å’Œæµé‡è´Ÿè½½ï¼Œä½†è¿™ä¸ªæ¯”å–»å¯¹å‚ä¸è€…æ¥è¯´æ˜¯æ··ä¹±çš„ã€‚åœ†åœˆçš„å¤§å°å¯èƒ½ä¸ &lt;code&gt;srv_ldap&lt;/code&gt; çš„æœ€å°ç™¾åˆ†æ¯”æœ‰å…³ï¼Œè€Œ &lt;code&gt;srv_ldap&lt;/code&gt; æ˜¯æ­£ç¡®çš„ç­”æ¡ˆï¼Œå®ƒåœ¨é¥¼ä¸­ç”±ç»¿è‰²éƒ¨åˆ†è¡¨ç¤ºï¼ˆè§å›¾ 14ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-14-å‚ä¸è€…ä½¿ç”¨ä¼ ç»Ÿå›¾è¡¨ä¸è§†è§‰éšå–»å¯¹å¾®æœåŠ¡å’Œç¬¬ä¸‰æ–¹æœåŠ¡ä¹‹é—´çš„æµé‡è¿›è¡Œå¯è§†åŒ–çš„ç­”æ¡ˆ&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 14. å‚ä¸è€…ä½¿ç”¨ä¼ ç»Ÿå›¾è¡¨ä¸è§†è§‰éšå–»å¯¹å¾®æœåŠ¡å’Œç¬¬ä¸‰æ–¹æœåŠ¡ä¹‹é—´çš„æµé‡è¿›è¡Œå¯è§†åŒ–çš„ç­”æ¡ˆã€‚&#34; srcset=&#34;
               /blog/chaos-engineering-observability-visual-metaphors/f14_hu1b3794456f447f451be1b6c121834963_14664_775bfa66179990f0526e69b01cceb5a9.webp 400w,
               /blog/chaos-engineering-observability-visual-metaphors/f14_hu1b3794456f447f451be1b6c121834963_14664_5f79a6e8736454681951a1a343353fde.webp 760w,
               /blog/chaos-engineering-observability-visual-metaphors/f14_hu1b3794456f447f451be1b6c121834963_14664_1200x1200_fit_q75_h2_lanczos_2.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/chaos-engineering-observability-visual-metaphors/f14_hu1b3794456f447f451be1b6c121834963_14664_775bfa66179990f0526e69b01cceb5a9.webp&#34;
               width=&#34;760&#34;
               height=&#34;320&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 14. å‚ä¸è€…ä½¿ç”¨ä¼ ç»Ÿå›¾è¡¨ä¸è§†è§‰éšå–»å¯¹å¾®æœåŠ¡å’Œç¬¬ä¸‰æ–¹æœåŠ¡ä¹‹é—´çš„æµé‡è¿›è¡Œå¯è§†åŒ–çš„ç­”æ¡ˆã€‚
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;æœ€åï¼Œæˆ‘ä»¬ç”¨æŸ±çŠ¶å›¾çš„è§†è§‰åŒ–å’Œä»ªè¡¨çš„æ¯”å–»æ¥åˆ†æ&lt;strong&gt;å»¶è¿Ÿä¿¡å·&lt;/strong&gt;ã€‚å›¾ 15 å’Œå›¾ 16 åˆ†åˆ«è¯´æ˜äº†è¿™ä¸¤ç§å¯è§†åŒ–æ–¹å¼ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-15-ç”¨äºå¯è§†åŒ–å»¶è¿Ÿä¿¡å·çš„ä¼ ç»ŸæŸ±çŠ¶å›¾&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 15. ç”¨äºå¯è§†åŒ–å»¶è¿Ÿä¿¡å·çš„ä¼ ç»ŸæŸ±çŠ¶å›¾ã€‚&#34; srcset=&#34;
               /blog/chaos-engineering-observability-visual-metaphors/f15_hu6c80e74a88a6647574d6d6d203cf39b3_12496_a7a2aa61d99536a844016d68f20d893e.webp 400w,
               /blog/chaos-engineering-observability-visual-metaphors/f15_hu6c80e74a88a6647574d6d6d203cf39b3_12496_4e9ed215760e368102e54b9329ea069e.webp 760w,
               /blog/chaos-engineering-observability-visual-metaphors/f15_hu6c80e74a88a6647574d6d6d203cf39b3_12496_1200x1200_fit_q75_h2_lanczos_2.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/chaos-engineering-observability-visual-metaphors/f15_hu6c80e74a88a6647574d6d6d203cf39b3_12496_a7a2aa61d99536a844016d68f20d893e.webp&#34;
               width=&#34;760&#34;
               height=&#34;570&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 15. ç”¨äºå¯è§†åŒ–å»¶è¿Ÿä¿¡å·çš„ä¼ ç»ŸæŸ±çŠ¶å›¾ã€‚
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-16-ç”¨äºå¯è§†åŒ–å¾®æœåŠ¡çš„å»¶è¿Ÿçš„å¯è§†åŒ–ä»ªè¡¨éšå–»&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 16. ç”¨äºå¯è§†åŒ–å¾®æœåŠ¡çš„å»¶è¿Ÿçš„å¯è§†åŒ–ä»ªè¡¨éšå–»ã€‚&#34; srcset=&#34;
               /blog/chaos-engineering-observability-visual-metaphors/f16_hu4d6fbb306e89aee71862c91585351943_13066_2ca0bbcf6f7b32d0e1594dd7c8ba72ac.webp 400w,
               /blog/chaos-engineering-observability-visual-metaphors/f16_hu4d6fbb306e89aee71862c91585351943_13066_b5edc29fe68b56aa6464afa5dbba7c14.webp 760w,
               /blog/chaos-engineering-observability-visual-metaphors/f16_hu4d6fbb306e89aee71862c91585351943_13066_1200x1200_fit_q75_h2_lanczos_2.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/chaos-engineering-observability-visual-metaphors/f16_hu4d6fbb306e89aee71862c91585351943_13066_2ca0bbcf6f7b32d0e1594dd7c8ba72ac.webp&#34;
               width=&#34;500&#34;
               height=&#34;375&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 16. ç”¨äºå¯è§†åŒ–å¾®æœåŠ¡çš„å»¶è¿Ÿçš„å¯è§†åŒ–ä»ªè¡¨éšå–»ã€‚
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;å¯¹äºè¿™ç§æƒ…å†µï¼Œè¿™ä¸ªéšå–»è‚¯å®šæ²¡æœ‰ä¸ºå‚ä¸è€…æä¾›ä»·å€¼ï¼Œå› ä¸ºæ­£ç¡®çš„ç­”æ¡ˆæ˜¯ &lt;code&gt;ms_patients&lt;/code&gt;ï¼Œè¿™åœ¨å›¾ 17 ä¸­æœ‰è¯´æ˜ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-å›¾-17-å‚ä¸è€…ä½¿ç”¨ä¼ ç»Ÿå›¾è¡¨ä¸è§†è§‰éšå–»æ¥å¯è§†åŒ–å¾®æœåŠ¡å’Œç¬¬ä¸‰æ–¹æœåŠ¡ä¹‹é—´çš„å»¶è¿Ÿçš„ç­”æ¡ˆ&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;å›¾ 17. å‚ä¸è€…ä½¿ç”¨ä¼ ç»Ÿå›¾è¡¨ä¸è§†è§‰éšå–»æ¥å¯è§†åŒ–å¾®æœåŠ¡å’Œç¬¬ä¸‰æ–¹æœåŠ¡ä¹‹é—´çš„å»¶è¿Ÿçš„ç­”æ¡ˆã€‚&#34; srcset=&#34;
               /blog/chaos-engineering-observability-visual-metaphors/f17_huf3269a68215f055f9e1d893057adf56a_15438_e9e4644b5b090d4ff1d18293e733753e.webp 400w,
               /blog/chaos-engineering-observability-visual-metaphors/f17_huf3269a68215f055f9e1d893057adf56a_15438_b34fee8578d57da90b06724ec34cabfd.webp 760w,
               /blog/chaos-engineering-observability-visual-metaphors/f17_huf3269a68215f055f9e1d893057adf56a_15438_1200x1200_fit_q75_h2_lanczos_2.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/chaos-engineering-observability-visual-metaphors/f17_huf3269a68215f055f9e1d893057adf56a_15438_e9e4644b5b090d4ff1d18293e733753e.webp&#34;
               width=&#34;760&#34;
               height=&#34;320&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      å›¾ 17. å‚ä¸è€…ä½¿ç”¨ä¼ ç»Ÿå›¾è¡¨ä¸è§†è§‰éšå–»æ¥å¯è§†åŒ–å¾®æœåŠ¡å’Œç¬¬ä¸‰æ–¹æœåŠ¡ä¹‹é—´çš„å»¶è¿Ÿçš„ç­”æ¡ˆã€‚
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h2 id=&#34;å¼•å…¥è§†è§‰éšå–»çš„ç»“è®º&#34;&gt;å¼•å…¥è§†è§‰éšå–»çš„ç»“è®º&lt;/h2&gt;
&lt;p&gt;æ··æ²Œçš„å¯è§†åŒ–ï¼Œç‰¹åˆ«æ˜¯ç”Ÿäº§äº‹æ•…çš„å¯è§†åŒ–ï¼Œç»™ä¸“æ³¨äºå¯è§‚æµ‹æ€§çš„å·¥ä¸šå’Œå­¦æœ¯ç•Œå¸¦æ¥äº†ä¸€äº›æŒ‘æˆ˜ã€‚æ­£å¦‚æˆ‘ä»¬åœ¨è¿™ç¯‡æ–‡ç« ä¸­æ‰€å±•ç¤ºçš„ï¼Œç”±äºæ··æ²Œå·¥ç¨‹ã€å¯è§‚æµ‹æ€§å’Œå¯è§†åŒ–æ¶‰åŠåˆ°äººä¸æœºå™¨çš„äº’åŠ¨ï¼Œè§£é‡Šä¸­çš„åå·®æ˜¯ä¸€ä¸ªæŒç»­çš„é£é™©ã€‚é€šè¿‡ä¸€é¡¹ç ”ç©¶ï¼Œ28 ä½å·¥ç¨‹å¸ˆå›ç­”äº†ä¸ç»å…¸ä»ªè¡¨ç›˜å’Œè§†è§‰éšå–»æœ‰å…³çš„ 12 ä¸ªé—®é¢˜ï¼Œå¯ä»¥å¾—å‡ºç»“è®ºï¼Œå¯è§‚æµ‹æ€§ä¸ä»…å—åˆ°è¿™äº›ä¿¡å·çš„æ•°é‡å’Œè´¨é‡çš„é™åˆ¶ï¼Œè€Œä¸”å—åˆ°è¿™äº›ä¿¡å·çš„å¯è§†åŒ–å’Œè§£é‡Šæ–¹å¼çš„é™åˆ¶ã€‚ç»“è®ºæ˜¯ï¼Œè§†è§‰éšå–»å¯èƒ½æ¯”ä¼ ç»Ÿçš„ä»ªè¡¨ç›˜è¡¨ç°å¾—æ›´å¥½ï¼Œç„¶è€Œï¼Œç”±äºä¸¤è€…éƒ½æ¶‰åŠåˆ°äººï¼Œæ‰€ä»¥éƒ½ä¸èƒ½ä¿è¯æ“ä½œäººå‘˜ä»¥æ­£ç¡®çš„æ–¹å¼è§£é‡Šäº‹æ•…ä¸­çš„æ•°æ®ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æœ‰å…´è¶£äº†è§£æ›´å¤šå…³äºæ··æ²Œå·¥ç¨‹ä¸­çš„å¯è§‚æµ‹æ€§å—&#34;&gt;æœ‰å…´è¶£äº†è§£æ›´å¤šå…³äºæ··æ²Œå·¥ç¨‹ä¸­çš„å¯è§‚æµ‹æ€§å—ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;æˆ‘æƒ³æ¨èè¿™ä¸‰æœ¬ä¹¦ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;æˆ‘çš„ç¬¬ä¸€ä¸ªæ¨èæ˜¯ Russ Miles çš„ã€Š&lt;a href=&#34;https://www.humio.com/chaos-observability/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ··æ²Œå·¥ç¨‹å¯è§‚æµ‹æ€§&lt;/a&gt;ã€‹ä¸€ä¹¦ã€‚åœ¨è¿™æœ¬ä¹¦ä¸­ï¼Œä½œè€…æ¼”ç¤ºäº†å¦‚ä½•å°†ä½ çš„æ··æ²Œå®éªŒå¸¦å…¥ç³»ç»Ÿå¯è§‚æµ‹æ€§çš„ä¸–ç•Œã€‚æ··æ²Œå¯è§‚æµ‹æ€§èƒ½å¤Ÿä½¿æ•´ä¸ªç³»ç»Ÿçš„æ··æ²Œå®éªŒå®æ—¶åœ°æµ®ç°ã€è°ƒè¯•å’Œå¯è§†åŒ–ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å¦ä¸€ä¸ªå¾ˆå¥½çš„å‚è€ƒæ˜¯ Charity Majorsã€Liz Fong-Jones å’Œ George
Miranda çš„ã€Š&lt;a href=&#34;https://learning.oreilly.com/library/view/observability-engineering/9781492076438/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¯è§‚æµ‹æ€§å·¥ç¨‹&lt;/a&gt;ã€‹ä¸€ä¹¦ï¼Œä»–ä»¬åœ¨ä¸€å®¶åä¸º Honeycomb çš„å…¬å¸å·¥ä½œï¼Œæ­£æ˜¯ä¸“é—¨ä»äº‹å¯è§‚æµ‹æ€§çš„å·¥ä½œã€‚æˆ‘å–œæ¬¢è¿™æœ¬ä¹¦ï¼Œå› ä¸ºåœ¨ä¹¦ä¸­ï¼Œå¯è§‚æµ‹æ€§è¢«å½“ä½œä¸€ä¸ªå·¥ç¨‹é¢†åŸŸã€‚å¦‚ä½ æ‰€çŸ¥ï¼Œå¯è§‚æµ‹æ€§å¯¹äºå·¥ç¨‹ã€ç®¡ç†å’Œæ”¹è¿›å¤æ‚çš„å…³é”®ä¸šåŠ¡ç³»ç»Ÿè‡³å…³é‡è¦ï¼Œæ‰€ä»¥å®ƒåº”è¯¥è¢«è§†ä¸ºä¸€é—¨å­¦ç§‘ï¼Œç”šè‡³æ˜¯ä¸€ä¸ªç»„ç»‡å†…éƒ¨çš„è§’è‰²ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;æœ€åï¼Œæˆ‘æƒ³æåˆ°ä¸€æœ¬ä¸“æ³¨äº &lt;a href=&#34;https://www.manning.com/books/chaos-engineering&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ··æ²Œå·¥ç¨‹&lt;/a&gt; çš„å‚è€ƒä¹¦ã€‚æˆ‘è¯´çš„æ˜¯ Mikolaj
Pawlikowski çš„ä¸€æœ¬å®ç”¨ä¹¦ï¼Œç”±æ›¼å®å…¬å¸å‡ºç‰ˆã€‚è¯¥ä¹¦è®°å½•äº†æ¨¡æ‹Ÿç°å®ç”Ÿæ´»ä¸­çš„å¤±è´¥çš„å®éªŒå®¤å’Œå®é™…å®éªŒã€‚ä½œè€…é€šè¿‡å­¦ä¹ åƒæ··æ²Œå·¥ç¨‹å¸ˆé‚£æ ·æ€è€ƒï¼Œæœ€å¤§é™åº¦åœ°å‘æŒ¥äº†æ··æ²Œå·¥ç¨‹çš„ä¼˜åŠ¿ï¼Œæä¾›äº†æ¶µç›–æ•´ä¸ªè½¯ä»¶é¢†åŸŸçš„ä¾‹å­ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>Envoy API Gatewayâ€”â€”æ¨åŠ¨ç½‘å…³çš„è¿›ä¸€æ­¥å‘å±•</title>
      <link>https://lib.jimmysong.io/blog/the-gateway-to-a-new-frontier/</link>
      <pubDate>Tue, 17 May 2022 11:00:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/the-gateway-to-a-new-frontier/</guid>
      <description>&lt;h2 id=&#34;å‰è¨€&#34;&gt;å‰è¨€&lt;/h2&gt;
&lt;p&gt;ä»Šå¤©ï¼ŒEnvoy ç¤¾åŒº&lt;a href=&#34;https://www.cncf.io/blog/2022/05/16/introducing-envoy-gateway/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å®£å¸ƒäº†&lt;/a&gt;ä¸€ä¸ªä»¤äººå…´å¥‹çš„æ–°é¡¹ç›®ï¼š&lt;a href=&#34;https://github.com/envoyproxy/gateway&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Envoy Gateway&lt;/a&gt;ã€‚è¯¥é¡¹ç›®å°†è¡Œä¸šé¢†å¯¼è€…è”åˆèµ·æ¥ï¼Œç²¾ç®€ç”± Envoy é©±åŠ¨çš„åº”ç”¨ç½‘å…³çš„å¥½å¤„ã€‚è¿™ç§æ–¹æ³•ä½¿ Envoy Gateway èƒ½å¤Ÿç«‹å³ä¸ºå¿«é€Ÿåˆ›æ–°æ‰“ä¸‹åšå®çš„åŸºç¡€ã€‚è¯¥é¡¹ç›®å°†æä¾›ä¸€å¥—æœåŠ¡æ¥ç®¡ç† Envoy ä»£ç†æœºç¾¤ï¼Œé€šè¿‡æ˜“ç”¨æ€§æ¥æ¨åŠ¨é‡‡ç”¨ï¼Œå¹¶é€šè¿‡å®šä¹‰æ˜ç¡®çš„æ‰©å±•æœºåˆ¶æ¥æ”¯æŒä¼—å¤šçš„ç”¨ä¾‹ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦è¿™æ ·åš&#34;&gt;æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦è¿™æ ·åšï¼Ÿ&lt;/h2&gt;
&lt;p&gt;Tetrate æ˜¯ Envoy Proxy çš„ç¬¬ä¸€è´¡çŒ®è€…ï¼ˆæŒ‰æäº¤é‡è®¡ç®—ï¼‰ï¼Œä¹Ÿæ˜¯ Envoy Gateway æŒ‡å¯¼å°ç»„çš„æˆå‘˜ï¼Œå…¶è´¡çŒ®è€…æ¶µç›–æŠ€æœ¯å’Œç®¡ç†é¢†åŸŸã€‚æˆ‘ä»¬ç›¸ä¿¡ï¼Œæˆ‘ä»¬å¼ºå¤§çš„ä¼™ä¼´å…³ç³»å’Œåœ¨å¼€æºè½¯ä»¶æ–¹é¢çš„æ·±åšç»éªŒå°†æœ‰åŠ©äºç¡®ä¿ Envoy Gateway çš„æˆåŠŸã€‚Tetrate æ¨åŠ¨äº† EG è®¡åˆ’ï¼Œå› ä¸ºæˆ‘ä»¬è‡´åŠ›äºä¸Šæ¸¸é¡¹ç›®ï¼Œå› ä¸ºæˆ‘ä»¬ç›¸ä¿¡è¿™å°†é™ä½ Envoy Proxy ç”¨æˆ·çš„è¿›å…¥é—¨æ§›ï¼Œä¹Ÿå› ä¸ºè¿™ä¸æˆ‘ä»¬å¼€å‘æœåŠ¡ç½‘æ ¼ä½œä¸ºé›¶ä¿¡ä»»æ¶æ„åŸºç¡€çš„ä½¿å‘½ç›¸ä¸€è‡´ã€‚Tetrate å°†å¤§åŠ›æŠ•èµ„å»ºè®¾ Envoy Gateway çš„å®‰å…¨åŠŸèƒ½ï¼ŒåŒ…æ‹¬æ”¯æŒ OAuth2 å’Œ &lt;a href=&#34;https://letsencrypt.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Letâ€™s Encrypt&lt;/a&gt; é›†æˆç­‰ API åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å¯¹ä¸Šæ¸¸é¡¹ç›®çš„æ‰¿è¯º&#34;&gt;å¯¹ä¸Šæ¸¸é¡¹ç›®çš„æ‰¿è¯º&lt;/h3&gt;
&lt;p&gt;Tetrate ä»ç¬¬ä¸€å¤©èµ·å°±ç«™åœ¨æœåŠ¡ç½‘æ ¼çš„æœ€å‰æ²¿ï¼Œå§‹ç»ˆç›¸ä¿¡ä¸Šæ¸¸é¡¹ç›®å’Œå®ƒä»¬çš„ç¤¾åŒºã€‚å› æ­¤ï¼Œæˆ‘ä»¬ä¸€ç›´åœ¨ä¸º Istio å’Œ Envoy çš„ä¸Šæ¸¸é¡¹ç›®æä¾›å¸®åŠ©å’Œæ”¯æŒã€‚æˆ‘ä»¬çœ‹åˆ°ä¸åŒçš„äººåœ¨ä½¿ç”¨ Envoyï¼Œå¹¶åˆ›å»ºä»–ä»¬è‡ªå·±çš„æ§åˆ¶å¹³é¢å’Œ API ç½‘å…³å®ç°ï¼Œå¯¼è‡´ç¢ç‰‡åŒ–ï¼Œåˆ›æ–°é€Ÿåº¦æ…¢ï¼ŒåŠŸèƒ½å·®è·å¤§ï¼Œä»¥åŠç¼ºä¹å¯¹ä¸€ä¸ªä»£ç åº“çš„æ”¯æŒã€‚ç”±äºæˆ‘ä»¬ä¸ Matt Klein å’Œ Envoy ç¤¾åŒºé•¿æœŸä»¥æ¥å…³ç³»å¯†åˆ‡ï¼Œå½“æˆ‘ä»¬æè®®å°†å…¶çº³å…¥ Envoy çš„æ ‡å‡†åŒ–å®ç°ï¼Œå¹¶å°†å…¶æ•´åˆåˆ°ä¸€ä¸ªå®˜æ–¹çš„ä¸Šæ¸¸å®ç°ä¸­æ—¶ï¼Œæˆ‘ä»¬å¾—åˆ°äº† Matt å’Œå…¶ä»– CNCF é¡¹ç›®çš„å¼ºçƒˆæ”¯æŒã€‚æˆ‘ä»¬ä¸€ç›´åœ¨å¹•åä¸å…¶ä»–æŒ‡å¯¼å§”å‘˜ä¼šæˆå‘˜ï¼ˆ&lt;a href=&#34;https://www.getambassador.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Ambassador Labs&lt;/a&gt;ã€&lt;a href=&#34;https://www.fidelity.com/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Fidelity Investments&lt;/a&gt;ã€&lt;a href=&#34;https://projectcontour.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Project Contour&lt;/a&gt; å’Œ &lt;a href=&#34;https://www.vmware.com/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;VMware&lt;/a&gt; è¾›å‹¤å·¥ä½œï¼Œä»¥å®šä¹‰ Envoy Gatewayã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬çŸ¥é“ï¼Œè‰°è‹¦çš„å·¥ä½œæ‰åˆšåˆšå¼€å§‹ï¼Œæˆ‘ä»¬è‡´åŠ›äºè¿™ä¸ªé¡¹ç›®ä»¥åŠ CNCF å†…å…¶ä»–å‡ ä¸ªé¡¹ç›®çš„é•¿æœŸæˆåŠŸã€‚&lt;/p&gt;
&lt;h3 id=&#34;å®ç°æ§åˆ¶å¹³é¢çš„æ ‡å‡†åŒ–&#34;&gt;å®ç°æ§åˆ¶å¹³é¢çš„æ ‡å‡†åŒ–&lt;/h3&gt;
&lt;p&gt;åœ¨å¾ˆçŸ­çš„æ—¶é—´å†…ï¼ŒEnvoy å·²ç»æˆä¸ºç°ä»£äº‘åŸç”Ÿåº”ç”¨çš„é¦–é€‰ç½‘ç»œå±‚ã€‚éšç€ Envoy è·å¾—å…³æ³¨ï¼Œå¤§é‡çš„ä¸Šæ¸¸é¡¹ç›®å¼€å§‹åˆ©ç”¨å®ƒæ¥å®ç°æœåŠ¡ç½‘æ ¼ã€å…¥å£ã€å‡ºå£å’Œ API ç½‘å…³åŠŸèƒ½ã€‚è¿™äº›é¡¹ç›®ä¸­æœ‰è®¸å¤šèƒ½åŠ›é‡å ã€åŠŸèƒ½å·®è·ã€ä¸“æœ‰ç‰¹æ€§ï¼Œæˆ–è€…ç¼ºä¹ç¤¾åŒºå¤šæ ·æ€§ã€‚è¿™ç§æ”¯ç¦»ç ´ç¢çš„çŠ¶æ€æ˜¯ç”±äº Envoy ç¤¾åŒºæ²¡æœ‰æä¾›æ§åˆ¶å¹³é¢çš„å®ç°è€Œäº§ç”Ÿçš„å‰¯ä½œç”¨ã€‚&lt;/p&gt;
&lt;p&gt;å› æ­¤ï¼Œåˆ›æ–°çš„é€Ÿåº¦é™ä½äº†ï¼Œä¼ä¸šè¢«è¦æ±‚è¾¨åˆ«åˆ©ç”¨ Envoy ä½œä¸ºå…¶åº”ç”¨ç½‘ç»œæ•°æ®å¹³é¢çš„æœ€ä½³æ–¹æ³•ã€‚ç°åœ¨ï¼Œç¤¾åŒºæ­£åœ¨æä¾› Envoy Gatewayï¼Œæ›´å¤šçš„ç”¨æˆ·å¯ä»¥äº«å— Envoy çš„å¥½å¤„ï¼Œè€Œæ— éœ€å†³å®šæ§åˆ¶å¹³é¢ã€‚Envoy Gateway çš„&lt;a href=&#34;https://github.com/envoyproxy/gateway/blob/main/GOALS.md#goals&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç›®æ ‡&lt;/a&gt;æ˜¯ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&amp;ldquo;&amp;hellip;&amp;hellip; é€šè¿‡æ”¯æŒä¼—å¤šå…¥å£å’Œ L7/L4 æµé‡è·¯ç”±ä½¿ç”¨æ¡ˆä¾‹çš„è¡¨è¾¾å¼ã€å¯æ‰©å±•ã€é¢å‘è§’è‰²çš„ APIï¼Œé™ä½é‡‡ç”¨éšœç¢ï¼Œå¸å¼•æ›´å¤šç”¨æˆ·ä½¿ç”¨ Envoyï¼›å¹¶ä¸ºä¾›åº”å•†å»ºç«‹å¢å€¼äº§å“æä¾›å…±åŒåŸºç¡€ï¼Œè€Œæ— éœ€é‡æ–°è®¾è®¡åŸºæœ¬äº¤äº’ã€‚&amp;rdquo;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;æ˜“ç”¨æ€§å’Œè¿è¥æ•ˆç‡&#34;&gt;æ˜“ç”¨æ€§å’Œè¿è¥æ•ˆç‡&lt;/h3&gt;
&lt;p&gt;Envoy Proxy æ˜¯ç”± &lt;a href=&#34;https://github.com/cncf/xds&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;xDS API&lt;/a&gt; é©±åŠ¨çš„ï¼Œè¿™äº› APIs æš´éœ²äº†å¤§é‡çš„åŠŸèƒ½ï¼Œå¹¶è¢«æ§åˆ¶å¹³é¢å¹¿æ³›é‡‡ç”¨ã€‚è™½ç„¶è¿™äº› API åŠŸèƒ½ä¸°å¯Œï¼Œä½†å¯¹äºç”¨æˆ·æ¥è¯´ï¼Œè¦å¿«é€Ÿå­¦ä¹ å¹¶å¼€å§‹åˆ©ç”¨ Envoy çš„åŠŸèƒ½æ˜¯éå¸¸å›°éš¾çš„ã€‚Envoy Gateway å°†ä¸ºç”¨æˆ·æŠ½è±¡å‡ºè¿™äº›å¤æ‚çš„åŠŸèƒ½ï¼ŒåŒæ—¶æ”¯æŒç°æœ‰çš„è¿è¥å’Œåº”ç”¨ç®¡ç†æ¨¡å¼ã€‚&lt;/p&gt;
&lt;p&gt;Envoy Gateway å°†åˆ©ç”¨ &lt;a href=&#34;https://gateway-api.sigs.k8s.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Gateway API&lt;/a&gt; æ¥å®ç°è¿™äº›ç›®æ ‡ï¼Œè€Œä¸æ˜¯å¼€å‘ä¸€ä¸ªæ–°çš„é¡¹ç›®ä¸“ç”¨ APIã€‚Gateway API æ˜¯ä¸€ä¸ªç”± &lt;a href=&#34;https://github.com/kubernetes/community/tree/master/sig-network&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Kubernetes ç½‘ç»œç‰¹åˆ«å…´è¶£å°ç»„&lt;/a&gt;ç®¡ç†çš„é¡¹ç›®ï¼Œæ­£åœ¨è¿…é€Ÿæˆä¸ºæä¾›ç”¨æˆ·æ¥å£ä»¥ç®¡ç†åº”ç”¨ç½‘ç»œåŸºç¡€è®¾æ–½å’Œæµé‡è·¯ç”±çš„é¦–é€‰æ–¹æ³•ã€‚è¿™ä¸ªå¼€æºé¡¹ç›®æœ‰ä¸€ä¸ªä¸°å¯Œã€å¤šæ ·çš„ç¤¾åŒºï¼Œæœ‰å‡ ä¸ªçŸ¥åçš„å®æ–½æ–¹æ¡ˆã€‚æˆ‘ä»¬æœŸå¾…ç€ä½œä¸ºç¤¾åŒºçš„ä¸€éƒ¨åˆ†å¼€å±•å·¥ä½œï¼Œä½¿ Envoy Gateway æˆä¸ºä¸šç•Œé¦–é€‰çš„ç½‘å…³ API å®ç°ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä¸ºä»€ä¹ˆè¿™æ¯”ä¼ ç»Ÿçš„-api-ç½‘å…³æ›´å¥½&#34;&gt;ä¸ºä»€ä¹ˆè¿™æ¯”ä¼ ç»Ÿçš„ API ç½‘å…³æ›´å¥½ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;ä¼ ç»Ÿçš„ä»£ç†ä¸æ˜¯è½»é‡çº§çš„ã€å¼€æ”¾çš„ï¼Œä¹Ÿä¸æ˜¯åŠ¨æ€å¯ç¼–ç¨‹çš„ã€ç±»ä¼¼ xDS çš„ APIï¼Œå› æ­¤ Envoy å¾ˆé€‚åˆæˆä¸ºå½“ä»ŠåŠ¨æ€åç«¯çš„ API ç½‘å…³ â€”â€” å°¤å…¶æ˜¯åœ¨å¢åŠ å®‰å…¨åŠŸèƒ½çš„æƒ…å†µä¸‹ã€‚æˆ‘ä»¬è®¾æƒ³å°† Envoy ç½‘å…³ä½œä¸ºä¸æ–­å‘å±•çš„ API ç®¡ç†é¢†åŸŸçš„ä¸€ä¸ªå…³é”®ç»„æˆéƒ¨åˆ†ã€‚API ç½‘å…³æ˜¯ API ç®¡ç†çš„æ ¸å¿ƒç»„ä»¶ï¼Œæä¾›é€æ˜åœ°ç­–ç•¥æ‰§è¡Œå’Œç”Ÿæˆè¯¦ç»†é¥æµ‹æ•°æ®çš„åŠŸèƒ½ã€‚è¿™ç§é¥æµ‹æŠ€æœ¯æä¾›äº†å¼ºå¤§çš„å¯è§‚æµ‹æ€§ï¼Œä¸ºä¼ä¸šæä¾›äº†æ›´å¥½çš„æ´å¯ŸåŠ›ï¼Œä»¥æ’é™¤æ•…éšœã€ç»´æŠ¤å’Œä¼˜åŒ–å…¶ APIã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æˆ‘ä»¬çœ‹æ¥ï¼Œç”±äº Envoy çš„è®¾è®¡ã€åŠŸèƒ½è®¾ç½®ã€å®‰è£…åŸºç¡€å’Œç¤¾åŒºï¼Œå®ƒæ˜¯ä¸šå†…æœ€å¥½çš„ API ç½‘å…³ã€‚æœ‰äº† Envoy Gatewayï¼Œä¼ä¸šå¯ä»¥åœ¨å°† Envoy åµŒå…¥å…¶ API ç®¡ç†ç­–ç•¥æ–¹é¢å¢åŠ ä¿¡å¿ƒã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ— è¾¹ç•Œçš„é›¶ä¿¡ä»»&#34;&gt;æ— è¾¹ç•Œçš„é›¶ä¿¡ä»»&lt;/h3&gt;
&lt;p&gt;å½“ä½ çš„æ‰€æœ‰åº”ç”¨æœåŠ¡éƒ½åœ¨ä¸€ä¸ªæœåŠ¡ç½‘æ ¼ä¸­è¿è¡Œæ—¶ï¼Œå®ç°&lt;a href=&#34;https://www.tetrate.io/zero-trust/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;é›¶ä¿¡ä»»æ¶æ„&lt;/a&gt;å°±ä¸é‚£ä¹ˆéš¾äº†ã€‚ç„¶è€Œï¼Œç°å®ä¸­ä¸éƒ½æ˜¯æœåŠ¡ç½‘æ ¼ã€‚æœåŠ¡åœ¨è™šæ‹Ÿæœºä¸Šè¿è¡Œï¼Œåœ¨æ— ä»£ç†å®¹å™¨ä¸­è¿è¡Œï¼Œä½œä¸ºæ— æœåŠ¡å™¨å‡½æ•°è¿è¡Œï¼Œç­‰ç­‰ã€‚Envoy Gateway å°†çªç ´è¿™äº›è¿è¡Œæ—¶çš„ç•Œé™ï¼Œä¸ºè·¨å¼‚æ„ç¯å¢ƒçš„ç»Ÿä¸€ç­–ç•¥æ‰§è¡Œæä¾›åŸºç¡€ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸€åŸºç¡€çš„å…³é”®æ˜¯ Envoy Gateway çš„å¯æ‰©å±•æ€§ï¼Œå®ƒæä¾›äº†æš´éœ² Envoy å’Œé Envoy å®‰å…¨åŠŸèƒ½çš„çµæ´»æ€§ã€‚è¿™äº›æ‰©å±•ç‚¹å°†è¢«ç”¨æ¥æä¾›å®ç°é›¶ä¿¡ä»»æ¶æ„æ‰€éœ€çš„åŠŸèƒ½ï¼ŒåŒ…æ‹¬ç”¨æˆ·å’Œåº”ç”¨è®¤è¯ã€æˆæƒã€åŠ å¯†å’Œé€Ÿç‡é™åˆ¶ã€‚Envoy Gateway å°†å¾ˆå¿«æˆä¸ºå¯»æ±‚å®ç°é›¶ä¿¡ä»»æ¶æ„çš„ç»„ç»‡çš„ä¸€ä¸ªå…³é”®ç»„ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;åŒæ ·ï¼ŒTetrate è‡´åŠ›äºä¸Šæ¸¸é¡¹ç›®å’Œå®ƒä»¬çš„é•¿æœŸå¯è¡Œæ€§ã€‚è¿™ä¸€ä¸¾æªåˆä¸€æ¬¡è¯æ˜äº†è¿™ä¸€ç‚¹ï¼Œå¹¶è¡¨æ˜ä¸Šæ¸¸çš„ Envoy å’Œ Istio ç°åœ¨æ­£æˆä¸ºæ„å»ºæœåŠ¡ç½‘æ ¼çš„äº‹å®ä¸Šçš„æ”¯æŸ±ã€‚Envoy Gateway å°†ä½¿æœåŠ¡ç½‘æ ¼æˆä¸ºä¸»æµï¼Œæ¶æ„å¸ˆä»¬åº”è¯¥æŠŠç½‘æ ¼çœ‹ä½œæ˜¯ ZTA çš„åŸºç¡€ã€‚ä¸ºäº†å¸®åŠ©æ¶æ„å¸ˆè¿›è¡Œè®ºè¯ï¼Œæˆ‘ä»¬æœ€è¿‘å‡ºç‰ˆäº†ã€Š&lt;a href=&#34;https://www.tetrate.io/service-mesh-handbook/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æœåŠ¡ç½‘æ ¼æ‰‹å†Œ&lt;/a&gt;ã€‹ã€‚æˆ‘ä»¬å¾ˆå¿«å°±ä¼šå‘å¸ƒä¸€ç§å¸¦æœ‰ä¸Šæ¸¸ Envoy Gateway å’Œ Istio çš„æ¶æ„æ–¹æ³•ï¼Œå¯ä»¥çœ‹ä½œæ˜¯ä½ çš„åº”ç”¨ç½‘ç»œçš„åŸºç¡€ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ¢ç´¢-envoy-gateway&#34;&gt;æ¢ç´¢ Envoy Gateway&lt;/h3&gt;
&lt;p&gt;åœ¨ Tetrateï¼Œæˆ‘ä»¬æ­£åœ¨é¢†å¯¼åŸºäº Envoy Gateway å’Œ Istio çš„é›¶ä¿¡ä»»æ¶æ„çš„å®šä¹‰ï¼Œå¹¶å°†åœ¨åç»­åšæ–‡ä¸­é˜è¿°è®¾æƒ³çš„æ¶æ„ã€‚å¦‚æœä½ æƒ³å’Œæˆ‘ä»¬ä¸€èµ·è®¨è®ºæ¶æ„ï¼Œå¹¶äº†è§£æ›´å¤šå…³äºå¦‚ä½•ä¸ºä¼ ç»Ÿå’Œäº‘åŸç”Ÿåº”ç”¨ç¨‹åºè¿›è¡Œæ¶æ„ï¼Œè¯·åŠ å…¥ &lt;a href=&#34;http://tetrate-community.slack.com/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;tetrate-community&lt;/a&gt; Slack é¢‘é“ã€‚&lt;/p&gt;
&lt;p&gt;è¦äº†è§£æ›´å¤šå…³äº Tetrate çš„ä¿¡æ¯ï¼Œè¯·è®¿é—® &lt;a href=&#34;https://www.tetrate.io/envoy-gateway/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;tetrate.io&lt;/a&gt;ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>å¼€æºé¡¹ç›® Envoy Gateway ç®€ä»‹</title>
      <link>https://lib.jimmysong.io/blog/introducing-envoy-gateway/</link>
      <pubDate>Mon, 16 May 2022 13:00:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/introducing-envoy-gateway/</guid>
      <description>&lt;h2 id=&#34;å‰è¨€&#34;&gt;å‰è¨€&lt;/h2&gt;
&lt;p&gt;ä»Šå¤©ï¼Œæˆ‘ä»¬å¾ˆé«˜å…´åœ°å®£å¸ƒ &lt;a href=&#34;https://github.com/envoyproxy/gateway&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Envoy Gateway&lt;/a&gt; æˆä¸º Envoy ä»£ç†å®¶æ—çš„æ–°æˆå‘˜ï¼Œè¯¥é¡¹ç›®æ—¨åœ¨å¤§å¹…é™ä½å°† Envoy ä½œä¸º API ç½‘å…³çš„ä½¿ç”¨é—¨æ§›ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å†å²&#34;&gt;å†å²&lt;/h2&gt;
&lt;p&gt;Envoy &lt;a href=&#34;https://medium.com/lyft-engineering/announcing-envoy-c-l7-proxy-and-communication-bus-92520b6c8191&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;åœ¨ 2016 å¹´ç§‹å¤©å¼€æº&lt;/a&gt;ï¼Œä»¤æˆ‘ä»¬æƒŠè®¶çš„æ˜¯ï¼Œå®ƒå¾ˆå¿«å°±å¼•é¢†äº†æ•´ä¸ªè¡Œä¸šã€‚ç”¨æˆ·è¢«è¿™ä¸ªé¡¹ç›®çš„è®¸å¤šä¸åŒæ–¹é¢æ‰€å¸å¼•ï¼ŒåŒ…æ‹¬å®ƒçš„åŒ…å®¹æ€§ç¤¾åŒºã€å¯æ‰©å±•æ€§ã€API é©±åŠ¨çš„é…ç½®æ¨¡å‹ã€å¼ºå¤§çš„å¯è§‚æµ‹æ€§è¾“å‡ºå’Œè¶Šæ¥è¶Šå¹¿æ³›çš„åŠŸèƒ½é›†ã€‚&lt;/p&gt;
&lt;p&gt;å°½ç®¡åœ¨å…¶æ—©æœŸå†å²ä¸­ï¼ŒEnvoy æˆä¸ºäº†&lt;strong&gt;æœåŠ¡ç½‘æ ¼&lt;/strong&gt;çš„ä»£åè¯ï¼Œä½†å®ƒåœ¨ Lyft çš„é¦–æ¬¡ä½¿ç”¨å®é™…ä¸Šæ˜¯ä½œä¸º API ç½‘å…³ / è¾¹ç¼˜ä»£ç†ï¼Œæä¾›æ·±å…¥çš„å¯è§‚æµ‹æ€§è¾“å‡ºï¼Œå¸®åŠ© Lyft ä»å•ä½“æ¶æ„è¿ç§»åˆ°å¾®æœåŠ¡æ¶æ„ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿‡å»çš„ 5 å¹´å¤šæ—¶é—´é‡Œï¼Œæˆ‘ä»¬çœ‹åˆ° Envoy è¢«å¤§é‡çš„ç»ˆç«¯ç”¨æˆ·é‡‡ç”¨ï¼Œæ—¢å¯ä»¥ä½œä¸º API ç½‘å…³ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºæœåŠ¡ç½‘æ ¼ä¸­çš„ sidecar ä»£ç†ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬çœ‹åˆ°å›´ç»• Envoy å‡ºç°äº†ä¸€ä¸ªåºå¤§çš„ä¾›åº”å•†ç”Ÿæ€ç³»ç»Ÿï¼Œåœ¨å¼€æºå’Œä¸“æœ‰é¢†åŸŸæä¾›äº†å¤§é‡çš„è§£å†³æ–¹æ¡ˆã€‚Envoy çš„ä¾›åº”å•†ç”Ÿæ€ç³»ç»Ÿå¯¹é¡¹ç›®çš„æˆåŠŸè‡³å…³é‡è¦ï¼›å¦‚æœæ²¡æœ‰å¯¹æ‰€æœ‰åœ¨ Envoy ä¸Šå…¼èŒæˆ–å…¨èŒå·¥ä½œçš„å‘˜å·¥çš„èµ„åŠ©ï¼Œè¿™ä¸ªé¡¹ç›®è‚¯å®šä¸ä¼šæœ‰ä»Šå¤©çš„æˆå°±ã€‚&lt;/p&gt;
&lt;p&gt;Envoy ä½œä¸ºè®¸å¤šä¸åŒçš„æ¶æ„ç±»å‹å’Œä¾›åº”å•†è§£å†³æ–¹æ¡ˆçš„ç»„æˆéƒ¨åˆ†ï¼Œå…¶æˆåŠŸçš„å¦ä¸€é¢æ˜¯å®ƒæœ¬è´¨ä¸Šä½äºæ¶æ„åº•å±‚ï¼›Envoy å¹¶ä¸æ˜¯ä¸€ä¸ªå®¹æ˜“å­¦ä¹ çš„è½¯ä»¶ã€‚è™½ç„¶è¯¥é¡¹ç›®åœ¨ä¸–ç•Œå„åœ°çš„å¤§å‹å·¥ç¨‹ç»„ç»‡ä¸­å–å¾—äº†å·¨å¤§çš„æˆåŠŸï¼Œä½†åœ¨è¾ƒå°å’Œè¾ƒç®€å•çš„ç”¨ä¾‹ä¸­ï¼Œå®ƒåªè¢«è½»åº¦é‡‡ç”¨ï¼Œåœ¨è¿™äº›ç”¨ä¾‹ä¸­ï¼Œ&lt;a href=&#34;https://nginx.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;nginx&lt;/a&gt; å’Œ &lt;a href=&#34;http://www.haproxy.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;HAProxy&lt;/a&gt; ä»å ä¸»å¯¼åœ°ä½ã€‚&lt;/p&gt;
&lt;p&gt;Envoy Gateway é¡¹ç›®çš„è¯ç”Ÿæ˜¯å‡ºäºè¿™æ ·çš„ä¿¡å¿µï¼šå°† Envoy ä½œä¸º API ç½‘å…³çš„è§’è‰²æ¨å‘å¤§ä¼—éœ€è¦ä¸¤ä¸ªä¸»è¦æ¡ä»¶ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸€ä¸ªç®€åŒ–çš„éƒ¨ç½²æ¨¡å‹å’Œ API å±‚ï¼Œæ—¨åœ¨æ»¡è¶³è½»é‡çº§ä½¿ç”¨&lt;/li&gt;
&lt;li&gt;å°†ç°æœ‰çš„ &lt;a href=&#34;https://www.cncf.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;CNCF&lt;/a&gt; API ç½‘å…³é¡¹ç›®ï¼ˆ&lt;a href=&#34;https://projectcontour.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Contour&lt;/a&gt; å’Œ &lt;a href=&#34;https://github.com/emissary-ingress/emissary&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Emissary&lt;/a&gt;ï¼‰åˆå¹¶ä¸ºä¸€ä¸ªå…±åŒçš„æ ¸ï¼Œå¯ä»¥æä¾›æœ€å¥½çš„ç”¨æˆ·ä½“éªŒï¼ŒåŒæ—¶ä»ç„¶å…è®¸ä¾›åº”å•†åœ¨ Envoy Proxy å’Œ Envoy Gateway çš„åŸºç¡€ä¸Šå»ºç«‹å¢å€¼è§£å†³æ–¹æ¡ˆã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æˆ‘ä»¬åšä¿¡ï¼Œå¦‚æœç¤¾åŒºæ±‡èšåœ¨å•ä¸€çš„ä»¥ Envoy ä¸ºæ ¸å¿ƒçš„ API ç½‘å…³å‘¨å›´ï¼Œå®ƒå°†ä¼šï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å‡å°‘å›´ç»•å®‰å…¨ã€æ§åˆ¶å¹³é¢æŠ€æœ¯ç»†èŠ‚å’Œå…¶ä»–å…±åŒå…³åˆ‡çš„é‡å¤å·¥ä½œã€‚&lt;/li&gt;
&lt;li&gt;å…è®¸ä¾›åº”å•†ä¸“æ³¨äºåœ¨ Envoy Proxy å’Œ Envoy Gateway çš„åŸºç¡€ä¸Šä»¥æ‰©å±•ã€ç®¡ç†å¹³é¢ UI ç­‰å½¢å¼åˆ†å±‚æä¾›å¢å€¼åŠŸèƒ½ã€‚&lt;/li&gt;
&lt;li&gt;ä¼—äººæ‹¾æŸ´ç«ç„°é«˜ï¼Œè®©å…¨ä¸–ç•Œæ›´å¤šçš„ç”¨æˆ·äº«å—åˆ° Envoy çš„å¥½å¤„ï¼Œæ— è®ºç»„ç»‡çš„å¤§å°ã€‚æ›´å¤šçš„ç”¨æˆ·ä¸ºæ›´å¤šçš„æ½œåœ¨å®¢æˆ·æä¾›äº†è‰¯æ€§å¾ªç¯ï¼Œä¸º Envoy çš„æ ¸å¿ƒé¡¹ç›®æä¾›äº†æ›´å¤šçš„æ”¯æŒï¼Œä¹Ÿä¸ºæ‰€æœ‰äººæä¾›äº†æ›´å¥½çš„æ•´ä½“ä½“éªŒã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;é¡¹ç›®æ¦‚è¦&#34;&gt;é¡¹ç›®æ¦‚è¦&lt;/h2&gt;
&lt;p&gt;æ€»å¾—æ¥è¯´ï¼ŒEnvoy Gateway å¯ä»¥è¢«è®¤ä¸ºæ˜¯ Envoy Proxy æ ¸å¿ƒçš„ä¸€ä¸ªå°è£…å™¨ã€‚å®ƒä¸ä¼šä»¥ä»»ä½•æ–¹å¼æ”¹å˜æ ¸å¿ƒä»£ç†ã€&lt;a href=&#34;https://www.envoyproxy.io/docs/envoy/latest/api-docs/xds_protocol&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;xDS&lt;/a&gt;ã€&lt;a href=&#34;https://github.com/envoyproxy/go-control-plane&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;go-control-plane&lt;/a&gt; ç­‰ï¼ˆé™¤äº†æ½œåœ¨çš„é©±åŠ¨åŠŸèƒ½ã€bug ä¿®å¤å’Œä¸€èˆ¬æ”¹è¿›ä»¥å¤–ï¼‰ã€‚å®ƒå°†æä¾›ä»¥ä¸‹åŠŸèƒ½ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸ºç½‘å…³ç”¨ä¾‹æä¾›ç®€åŒ–çš„ APIã€‚è¯¥ API å°†æ˜¯å¸¦æœ‰ä¸€äº› Envoy ç‰¹å®šæ‰©å±•çš„ &lt;a href=&#34;https://gateway-api.sigs.k8s.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Kubernetes Gateway API&lt;/a&gt;ã€‚ä¹‹æ‰€ä»¥é€‰æ‹©è¿™ä¸ª APIï¼Œæ˜¯å› ä¸ºåœ¨ Kubernetes ä¸Šä½œä¸º Ingress Controller éƒ¨ç½²æ˜¯è¯¥é¡¹ç›®æœ€åˆçš„é‡ç‚¹ï¼Œè€Œä¸”è¯¥ API å¾—åˆ°äº†ä¸šç•Œçš„å¹¿æ³›è®¤å¯ã€‚&lt;/li&gt;
&lt;li&gt;å¼€ç®±å³ç”¨ï¼Œè®©ç”¨æˆ·èƒ½å¤Ÿå°½å¯èƒ½å¿«åœ°å¯åŠ¨å’Œè¿è¡Œã€‚è¿™åŒ…æ‹¬æä¾›æ§åˆ¶å™¨èµ„æºã€æ§åˆ¶å¹³é¢èµ„æºã€ä»£ç†å®ä¾‹ç­‰çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†åŠŸèƒ½ã€‚&lt;/li&gt;
&lt;li&gt;å¯æ‰©å±•çš„ API å¹³é¢ã€‚è™½ç„¶è¯¥é¡¹ç›®å°†è‡´åŠ›äºä½¿å¸¸è§çš„ API ç½‘å…³åŠŸèƒ½å¼€ç®±å³ç”¨ï¼ˆä¾‹å¦‚ï¼Œé€Ÿç‡é™åˆ¶ã€è®¤è¯ã€&lt;a href=&#34;https://letsencrypt.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Letâ€™s Encrypt&lt;/a&gt; é›†æˆç­‰ï¼‰ï¼Œä½†ä¾›åº”å•†å°†èƒ½å¤Ÿæä¾›æ‰€æœ‰ API çš„ SaaS ç‰ˆæœ¬ï¼Œæä¾›é¢å¤–çš„ API å’Œå¢å€¼åŠŸèƒ½ï¼Œå¦‚ WAFã€å¢å¼ºçš„å¯è§‚æµ‹æ€§ã€æ··ä¹±å·¥ç¨‹ç­‰ã€‚&lt;/li&gt;
&lt;li&gt;é«˜è´¨é‡çš„æ–‡æ¡£å’Œå…¥é—¨æŒ‡å—ã€‚æˆ‘ä»¬å¯¹ Envoy Gateway çš„ä¸»è¦ç›®æ ‡æ˜¯ä½¿æœ€å¸¸è§çš„ç½‘å…³ç”¨ä¾‹å¯¹æ™®é€šç”¨æˆ·æ¥è¯´å¯ä»¥ä¿¡æ‰‹æ‹ˆæ¥ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å…³äº APIï¼Œæˆ‘ä»¬è®¤ä¸ºå¯¼è‡´æ··ä¹±çš„ä¸»è¦æ˜¯åœ¨é’ˆå¯¹é«˜çº§ç”¨ä¾‹æ—¶ï¼Œåœ¨å…¶ä»–é¡¹ç›®ä¸­æœ‰æ•ˆåœ°é‡æ–°å®ç° Envoy çš„ &lt;a href=&#34;https://www.envoyproxy.io/docs/envoy/latest/api-docs/xds_protocol&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;xDS&lt;/a&gt; APIã€‚è¿™ç§æ¨¡å¼å¯¼è‡´ç”¨æˆ·ä¸å¾—ä¸å­¦ä¹ å¤šä¸ªå¤æ‚çš„ APIï¼ˆæœ€ç»ˆè½¬åŒ–ä¸º xDSï¼‰ï¼Œæ‰èƒ½å®Œæˆå·¥ä½œã€‚å› æ­¤ï¼ŒEnvoy Gateway è‡´åŠ›äº &amp;ldquo;ç¡¬æ€§è§„å®š&amp;rdquo;ï¼Œå³ Kubernetes Gateway APIï¼ˆä»¥åŠè¯¥ API ä¸­ä»»ä½•å…è®¸çš„æ‰©å±•ï¼‰æ˜¯&lt;strong&gt;å”¯ä¸€&lt;/strong&gt;è¢«æ”¯æŒçš„é¢å¤– APIã€‚æ›´é«˜çº§çš„ç”¨ä¾‹å°†ç”± &amp;ldquo;xDS æ¨¡å¼&amp;rdquo; æä¾›æœåŠ¡ï¼Œå…¶ä¸­ç°æœ‰çš„ API èµ„æºå°†ä¸ºæœ€ç»ˆç”¨æˆ·è‡ªåŠ¨ç¿»è¯‘ï¼Œç„¶åä»–ä»¬å¯ä»¥åˆ‡æ¢åˆ°ç›´æ¥åˆ©ç”¨ xDS APIã€‚è¿™å°†å¯¼è‡´ä¸€ä¸ªæ›´æ¸…æ™°çš„ä¸» APIï¼ŒåŒæ—¶ä¸ºé‚£äº›å¯èƒ½è¶…è¶Šä¸» API çš„è¡¨è¾¾èƒ½åŠ›å¹¶å¸Œæœ›é€šè¿‡ xDS åˆ©ç”¨ Envoy çš„å…¨éƒ¨åŠŸèƒ½çš„ç»„ç»‡æä¾›äº†è·¯å¾„ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å…³äº-api-çš„æ ‡å‡†åŒ–&#34;&gt;å…³äº API çš„æ ‡å‡†åŒ–&lt;/h2&gt;
&lt;p&gt;è™½ç„¶ Envoy Gateway çš„ç›®æ ‡æ˜¯æä¾›ä¸€ä¸ªå‚è€ƒå®ç°ï¼Œä»¥ä¾¿åœ¨ Kubernetes ä¸­ä½œä¸º Ingress Controller è½»æ¾è¿è¡Œ Envoyï¼Œä½†è¿™é¡¹å·¥ä½œæœ€ä¸»è¦çš„ç›®çš„æ˜¯ &lt;strong&gt;API æ ‡å‡†åŒ–&lt;/strong&gt;ã€‚éšç€è¡Œä¸šåœ¨ç‰¹å®šçš„ Envoy Kubernetes Gateway API æ‰©å±•ä¸Šçš„è¶‹åŒï¼Œå®ƒå°†å…è®¸ä¾›åº”å•†è½»æ¾åœ°æä¾›æ›¿ä»£çš„ SaaS å®ç°ï¼Œå¦‚æœç”¨æˆ·è¶…è¶Šäº†å‚è€ƒå®ç°ï¼Œæƒ³è¦é¢å¤–çš„æ”¯æŒå’ŒåŠŸèƒ½ç­‰ï¼Œè¿™å¯èƒ½æ˜¯æœ€å¥½çš„ã€‚æ˜¾ç„¶ï¼Œå›´ç»•å®šä¹‰ API æ‰©å±•ï¼Œç¡®å®šå“ªäº› API æ˜¯å¿…éœ€çš„ï¼Œå“ªäº›æ˜¯å¯é€‰çš„ï¼Œç­‰ç­‰ï¼Œè¿˜æœ‰å¾ˆå¤šå·¥ä½œè¦åšã€‚è¿™æ˜¯æˆ‘ä»¬æ ‡å‡†åŒ–ä¹‹æ—…çš„å¼€å§‹ï¼Œæˆ‘ä»¬æ¸´æœ›ä¸æ‰€æœ‰æ„Ÿå…´è¶£çš„äººä¸€èµ·æ·±å…¥ç ”ç©¶ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ¥ä¸‹æ¥çš„è®¡åˆ’&#34;&gt;æ¥ä¸‹æ¥çš„è®¡åˆ’&lt;/h2&gt;
&lt;p&gt;ä»Šå¤©ï¼Œæˆ‘ä»¬æ„Ÿè°¢ Envoy Gateway çš„æœ€åˆèµåŠ©å•†ï¼ˆ&lt;a href=&#34;https://www.getambassador.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Ambassador Labs&lt;/a&gt;ã€&lt;a href=&#34;https://www.fidelity.com/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Fidelity&lt;/a&gt;ã€&lt;a href=&#34;https://www.tetrate.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tetrate&lt;/a&gt; å’Œ &lt;a href=&#34;https://www.vmware.com/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;VMware&lt;/a&gt;ï¼‰ï¼Œå¾ˆé«˜å…´èƒ½ä¸å¤§å®¶ä¸€èµ·å¼€å§‹è¿™ä¸ªæ–°çš„æ—…ç¨‹ã€‚è¯¥é¡¹ç›®æ˜¯éå¸¸æ—©æœŸçš„ï¼Œåˆ°ç›®å‰ä¸ºæ­¢çš„é‡ç‚¹æ˜¯å•†å®š &lt;a href=&#34;https://github.com/envoyproxy/gateway/blob/main/GOALS.md&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç›®æ ‡&lt;/a&gt;å’Œ&lt;a href=&#34;https://github.com/envoyproxy/gateway/blob/main/docs/design/SYSTEM_DESIGN.md&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;é«˜æ°´å¹³çš„è®¾è®¡&lt;/a&gt;ï¼Œæ‰€ä»¥ç°åœ¨æ˜¯å‚ä¸çš„å¥½æ—¶æœºï¼Œæ— è®ºæ˜¯ä½œä¸ºç»ˆç«¯ç”¨æˆ·è¿˜æ˜¯ä½œä¸ºç³»ç»Ÿé›†æˆå•†ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬è¿˜æƒ³éå¸¸æ¸…æ¥šåœ°è¯´æ˜ï¼ŒContour å’Œ Emissary çš„ç°æœ‰ç”¨æˆ·ä¸ä¼šè¢«æŠ›åœ¨åé¢ã€‚è¯¥é¡¹ç›®ï¼ˆä»¥åŠ &lt;a href=&#34;https://www.vmware.com/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;VMware&lt;/a&gt; å’Œ &lt;a href=&#34;https://www.getambassador.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Ambassador Labs&lt;/a&gt;ï¼‰å®Œå…¨è‡´åŠ›äºç¡®ä¿è¿™äº›é¡¹ç›®çš„ç”¨æˆ·æœ€ç»ˆèƒ½å¤Ÿé¡ºåˆ©åœ°è¿ç§»åˆ° Envoy Gatewayï¼Œæ— è®ºæ˜¯é€šè¿‡ç¿»è¯‘å’Œæ›¿æ¢ï¼Œè¿˜æ˜¯é€šè¿‡è¿™äº›é¡¹ç›®æˆä¸º Envoy Gateway æ ¸å¿ƒçš„åŒ…è£…ç‰©ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¯¹é€šè¿‡ Envoy Gateway é¡¹ç›®å°† Envoy å¸¦ç»™æ›´å¤§çš„ç”¨æˆ·ç¾¤æ„Ÿåˆ°éå¸¸å…´å¥‹ï¼Œæˆ‘ä»¬å¸Œæœ›ä½ èƒ½&lt;a href=&#34;https://github.com/envoyproxy/gateway#contact&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;åŠ å…¥æˆ‘ä»¬&lt;/a&gt;çš„æ—…ç¨‹ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>ä½¿ç”¨ WebAssembly éªŒè¯è¯·æ±‚è´Ÿè½½</title>
      <link>https://lib.jimmysong.io/blog/validating-a-request-payload-with-wasm/</link>
      <pubDate>Fri, 13 May 2022 13:00:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/validating-a-request-payload-with-wasm/</guid>
      <description>&lt;h2 id=&#34;ä»€ä¹ˆæ˜¯-wasm-æ’ä»¶&#34;&gt;ä»€ä¹ˆæ˜¯ Wasm æ’ä»¶ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;ä½ å¯ä»¥ä½¿ç”¨ Wasm æ’ä»¶åœ¨æ•°æ®è·¯å¾„ä¸Šæ·»åŠ è‡ªå®šä¹‰ä»£ç ï¼Œè½»æ¾åœ°æ‰©å±•æœåŠ¡ç½‘æ ¼çš„åŠŸèƒ½ã€‚å¯ä»¥ç”¨ä½ é€‰æ‹©çš„è¯­è¨€ç¼–å†™æ’ä»¶ã€‚ç›®å‰ï¼Œæœ‰ AssemblyScriptï¼ˆTypeScript-ishï¼‰ã€C++ã€Rustã€Zig å’Œ Go è¯­è¨€çš„ Proxy-Wasm SDKã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿™ç¯‡åšæ–‡ä¸­ï¼Œæˆ‘ä»¬æè¿°äº†å¦‚ä½•ä½¿ç”¨ Wasm æ’ä»¶æ¥éªŒè¯ä¸€ä¸ªè¯·æ±‚çš„æœ‰æ•ˆè½½è·ã€‚è¿™æ˜¯ Wasm ä¸ Istio çš„ä¸€ä¸ªé‡è¦ç”¨ä¾‹ï¼Œä¹Ÿæ˜¯ä½ å¯ä»¥ä½¿ç”¨ Wasm æ‰©å±• Istio çš„è®¸å¤šæ–¹æ³•çš„ä¸€ä¸ªä¾‹å­ã€‚æ‚¨å¯èƒ½æœ‰å…´è¶£é˜…è¯»æˆ‘ä»¬å…³äº&lt;a href=&#34;https://www.tetrate.io/blog/category/wasm/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;åœ¨ Istio ä¸­ä½¿ç”¨ Wasm çš„åšæ–‡&lt;/a&gt;ï¼Œå¹¶è§‚çœ‹æˆ‘ä»¬å…³äºåœ¨ Istio å’Œ Envoy ä¸­ä½¿ç”¨ Wasm çš„å…è´¹ç ”è®¨ä¼šçš„å½•éŸ³ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä½•æ—¶ä½¿ç”¨-wasm-æ’ä»¶&#34;&gt;ä½•æ—¶ä½¿ç”¨ Wasm æ’ä»¶ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;å½“ä½ éœ€è¦æ·»åŠ  Envoy æˆ– Istio ä¸æ”¯æŒçš„è‡ªå®šä¹‰åŠŸèƒ½æ—¶ï¼Œä½ åº”è¯¥ä½¿ç”¨ Wasm æ’ä»¶ã€‚ä½¿ç”¨ Wasm æ’ä»¶æ¥æ·»åŠ è‡ªå®šä¹‰éªŒè¯ã€è®¤è¯ã€æ—¥å¿—æˆ–ç®¡ç†é…é¢ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†æ„å»ºå’Œè¿è¡Œä¸€ä¸ª Wasm æ’ä»¶ï¼ŒéªŒè¯è¯·æ±‚ body æ˜¯ JSONï¼Œå¹¶åŒ…å«ä¸¤ä¸ªå¿…è¦çš„é”® â€”â€”&lt;code&gt;id&lt;/code&gt; å’Œ &lt;code&gt;token&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç¼–å†™-wasm-æ’ä»¶&#34;&gt;ç¼–å†™ Wasm æ’ä»¶&lt;/h2&gt;
&lt;p&gt;è¿™ä¸ªç¤ºä¾‹ä½¿ç”¨ &lt;a href=&#34;https://tinygo.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;tinygo&lt;/a&gt; æ¥ç¼–è¯‘æˆ Wasmã€‚ç¡®ä¿ä½ å·²ç»å®‰è£…äº† &lt;a href=&#34;https://tinygo.org/getting-started/install/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;tinygo ç¼–è¯‘å™¨&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;é…ç½®-wasm-ä¸Šä¸‹æ–‡&#34;&gt;é…ç½® Wasm ä¸Šä¸‹æ–‡&lt;/h3&gt;
&lt;p&gt;é¦–å…ˆé…ç½® Wasm ä¸Šä¸‹æ–‡ï¼Œè¿™æ · tinygo æ–‡ä»¶æ‰èƒ½æ“ä½œ HTTP è¯·æ±‚ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;package&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;main&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;s&#34;&gt;&amp;#34;github.com/tetratelabs/proxy-wasm-go-sdk/proxywasm&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;s&#34;&gt;&amp;#34;github.com/tetratelabs/proxy-wasm-go-sdk/proxywasm/types&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;s&#34;&gt;&amp;#34;github.com/tidwall/gjson&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;c1&#34;&gt;// SetVMContext æ˜¯é…ç½®æ•´ä¸ª Wasm VM çš„å…¥å£ã€‚è¯·ç¡®ä¿è¯¥å…¥å£åœ¨ main å‡½æ•°ä¸­è°ƒç”¨ï¼Œå¦åˆ™ VM å°†å¯åŠ¨å¤±è´¥ã€‚
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;proxywasm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;SetVMContext&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;vmContext&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{})&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// vmContext å®ç° proxy-wasm-go SDK çš„ types.VMContext æ¥å£ã€‚
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;vmContext&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;c1&#34;&gt;// åœ¨è¿™é‡ŒåµŒå…¥é»˜è®¤çš„è™šæ‹Ÿæœºç¯å¢ƒï¼Œæˆ‘ä»¬ä¸éœ€è¦å®ç°æ‰€æœ‰æ–¹æ³•ã€‚
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;types&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;DefaultVMContext&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// å¤å†™ types.DefaultVMContext
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;vmContext&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;NewPluginContext&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;contextID&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;uint32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;types&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;PluginContext&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;pluginContext&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// pluginContext å®ç° proxy-wasm-go SDK çš„ types.PluginContext æ¥å£
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;pluginContext&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;c1&#34;&gt;// åœ¨è¿™é‡Œä¾µå…¥é»˜è®¤çš„æ’ä»¶ä¸Šä¸‹æ–‡ï¼Œæˆ‘ä»¬ä¸éœ€è¦å®ç°æ‰€æœ‰æ–¹æ³•ã€‚
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;types&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;DefaultPluginContext&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// å¤å†™ types.DefaultPluginContext
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ctx&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;pluginContext&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;NewHttpContext&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;contextID&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;uint32&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;types&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;HttpContext&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;payloadValidationContext&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// payloadValidationContext å®ç° proxy-wasm-go SDK çš„ types.HttpContext æ¥å£
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;payloadValidationContext&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;c1&#34;&gt;// åœ¨è¿™é‡ŒåµŒå…¥é»˜è®¤çš„æ ¹ http ä¸Šä¸‹æ–‡ï¼Œæˆ‘ä»¬ä¸éœ€è¦å®ç°æ‰€æœ‰æ–¹æ³•ã€‚
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;types&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;DefaultHttpContext&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;totalRequestBodySize&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;éªŒè¯è´Ÿè½½&#34;&gt;éªŒè¯è´Ÿè½½&lt;/h3&gt;
&lt;p&gt;å†…å®¹ç±»å‹å¤´æ˜¯é€šè¿‡å®ç° &lt;code&gt;OnHttpRequestHeaders&lt;/code&gt; æ¥éªŒè¯çš„ï¼Œä¸€æ—¦ä»å®¢æˆ·ç«¯æ”¶åˆ°è¯·æ±‚å¤´ï¼Œå°±ä¼šè°ƒç”¨è¯¥å¤´ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;proxywasm.SendHttpResponse&lt;/code&gt; ç”¨äºå“åº” 403 forbidden çš„é”™è¯¯ä»£ç å’Œä¿¡æ¯ï¼Œå¦‚æœå†…å®¹ç±»å‹ä¸¢å¤±çš„è¯ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ctx&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;payloadValidationContext&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;OnHttpRequestHeaders&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;numHeaders&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;endOfStream&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;bool&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;types&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Action&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;contentType&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;proxywasm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;GetHttpRequestHeader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;content-type&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;||&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;contentType&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;application/json&amp;#34;&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;c1&#34;&gt;// å¦‚æœ header æ²¡æœ‰æœŸæœ›çš„ content typeï¼Œè¿”å› 403 å“åº”
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;		&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;proxywasm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;SendHttpResponse&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;403&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;byte&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;content-type must be provided&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;nx&#34;&gt;proxywasm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;LogErrorf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;failed to send the 403 response: %v&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;c1&#34;&gt;// ç»ˆæ­¢ ActionPause å¯¹æµé‡çš„è¿›ä¸€æ­¥å¤„ç†
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;		&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;types&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ActionPause&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;c1&#34;&gt;// ActionContinue è®©ä¸»æœºç»§ç»­å¤„ç† body
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;types&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ActionContinue&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¯·æ±‚ä¸»ä½“æ˜¯é€šè¿‡å®ç° &lt;code&gt;OnHttpRequestBody&lt;/code&gt; æ¥éªŒè¯çš„ï¼Œæ¯æ¬¡ä»å®¢æˆ·ç«¯æ¥æ”¶åˆ°è¯·æ±‚çš„ä¸€ä¸ªå—æ—¶ï¼Œéƒ½ä¼šè°ƒç”¨è¯¥è¯·æ±‚ã€‚è¿™æ˜¯é€šè¿‡ç­‰å¾…ç›´åˆ° &lt;code&gt;endOfStream&lt;/code&gt; ä¸ºçœŸå¹¶è®°å½•æ‰€æœ‰æ”¶åˆ°çš„å—çš„æ€»å¤§å°æ¥å®Œæˆçš„ã€‚ä¸€æ—¦æ”¶åˆ°æ•´ä¸ªä¸»ä½“ï¼Œå°±ä¼šä½¿ç”¨ &lt;code&gt;proxywasm.GetHttpRequestBody&lt;/code&gt; è¯»å–ï¼Œç„¶åå¯ä»¥ä½¿ç”¨ golang è¿›è¡ŒéªŒè¯ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªä¾‹å­ä½¿ç”¨ &lt;code&gt;gjson&lt;/code&gt;ï¼Œå› ä¸º tinygo ä¸æ”¯æŒ golang çš„é»˜è®¤ JSON åº“ã€‚å®ƒæ£€æŸ¥æœ‰æ•ˆè½½è·æ˜¯å¦æ˜¯æœ‰æ•ˆçš„ JSONï¼Œä»¥åŠé”® &lt;code&gt;id&lt;/code&gt; å’Œ &lt;code&gt;token&lt;/code&gt; æ˜¯å¦å­˜åœ¨ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ctx&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;payloadValidationContext&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;OnHttpRequestBody&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;bodySize&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;endOfStream&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;bool&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;types&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Action&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;ctx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;totalRequestBodySize&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;bodySize&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;endOfStream&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;c1&#34;&gt;// OnHttpRequestBody ç­‰å¾…æ”¶åˆ°åˆ° body çš„å…¨éƒ¨æ‰å¼€å§‹å¤„ç†ã€‚
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;		&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;types&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ActionPause&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;proxywasm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;GetHttpRequestBody&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ctx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;totalRequestBodySize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;nx&#34;&gt;proxywasm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;LogErrorf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;failed to get request body: %v&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;types&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ActionContinue&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;validatePayload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;c1&#34;&gt;// å¦‚æœéªŒè¯å¤±è´¥ï¼Œå‘é€ 403 å“åº”ã€‚
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;		&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;proxywasm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;SendHttpResponse&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;403&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;byte&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;invalid payload&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;nx&#34;&gt;proxywasm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;LogErrorf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;failed to send the 403 response: %v&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;c1&#34;&gt;// ç»ˆæ­¢æµé‡
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;		&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;types&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ActionPause&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;types&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ActionContinue&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// validatePayload éªŒè¯ç»™å®šçš„ json è´Ÿè½½
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// æ³¨æ„è¯¥å‡½æ•°ä½¿ç”¨ gjson è§£æ jsonï¼Œå› ä¸º TinyGo ä¸æ”¯æŒ encoding/json
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;validatePayload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;body&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;byte&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;bool&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;gjson&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;ValidBytes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;nx&#34;&gt;proxywasm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;LogErrorf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;body is not a valid json: %v&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;false&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;jsonData&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;gjson&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;ParseBytes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;c1&#34;&gt;// éªŒè¯ jsonã€‚æ£€æŸ¥ç¤ºä¾‹ä¸­æ˜¯å¦å­˜åœ¨å¿…é¡»çš„é”®
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;_&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;requiredKey&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;range&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;id&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;token&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;jsonData&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;requiredKey&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Exists&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;nx&#34;&gt;proxywasm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;LogErrorf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;required key (%v) is missing: %v&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;requiredKey&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;jsonData&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;false&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;ç¼–è¯‘æˆ-wasm&#34;&gt;ç¼–è¯‘æˆ Wasm&lt;/h3&gt;
&lt;p&gt;ä½¿ç”¨ tinygo ç¼–è¯‘å™¨ç¼–è¯‘æˆ Wasmï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;tinygo build -o main.wasm -scheduler&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;none -target&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;wasi main.go
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;éƒ¨ç½²-wasm-æ’ä»¶&#34;&gt;éƒ¨ç½² Wasm æ’ä»¶&lt;/h2&gt;
&lt;h3 id=&#34;æ‰“åŒ…åˆ°-docker-ä¸­éƒ¨ç½²åˆ°-envoy&#34;&gt;æ‰“åŒ…åˆ° Docker ä¸­éƒ¨ç½²åˆ° Envoy&lt;/h3&gt;
&lt;p&gt;å¯¹äºå¼€å‘ï¼Œè¿™ä¸ªæ’ä»¶å¯ä»¥åœ¨ Docker ä¸­éƒ¨ç½²åˆ° Envoyã€‚ä¸‹é¢çš„ Envoy é…ç½®æ–‡ä»¶å°†è®¾ç½® Envoy ç›‘å¬ &lt;code&gt;localhost:18000&lt;/code&gt;ï¼Œè¿è¡Œæ‰€æä¾›çš„ Wasm æ’ä»¶ï¼Œå¹¶åœ¨æˆåŠŸåå“åº” HTTP 200 å’Œæ–‡æœ¬ &lt;code&gt;hello from server&lt;/code&gt;ã€‚çªå‡ºæ˜¾ç¤ºçš„éƒ¨åˆ†æ˜¯é…ç½® Wasm æ’ä»¶ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;static_resources&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;listeners&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;address&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;socket_address&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;address&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0.0.0.0&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;port_value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;18000&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;filter_chains&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;filters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;envoy.http_connection_manager&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;typed_config&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;@type&amp;#34;: &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;type.googleapis.com/envoy.extensions.filters.network.http_connection_manager.v3.HttpConnectionManager&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;stat_prefix&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;ingress_http&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;codec_type&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;auto&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;route_config&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;local_route&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;virtual_hosts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;local_service&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;domains&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                        &lt;/span&gt;- &lt;span class=&#34;s2&#34;&gt;&amp;#34;*&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;routes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                        &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;match&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;prefix&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;route&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;cluster&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;web_service&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt; 
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;http_filters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                 &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;envoy.filters.http.wasm&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;typed_config&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;@type&amp;#34;: &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;type.googleapis.com/udpa.type.v1.TypedStruct&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;type_url&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;type.googleapis.com/envoy.extensions.filters.http.wasm.v3.Wasm&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;config&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;vm_config&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;runtime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;envoy.wasm.runtime.v8&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;code&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                              &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;local&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                                &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;filename&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;./main.wasm&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;envoy.filters.http.router&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;staticreply&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;address&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;socket_address&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;address&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;127.0.0.1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;port_value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;8099&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;filter_chains&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;filters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;envoy.http_connection_manager&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;typed_config&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;@type&amp;#34;: &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;type.googleapis.com/envoy.extensions.filters.network.http_connection_manager.v3.HttpConnectionManager&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;stat_prefix&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;ingress_http&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;codec_type&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;auto&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;route_config&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;local_route&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;virtual_hosts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;local_service&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;domains&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                        &lt;/span&gt;- &lt;span class=&#34;s2&#34;&gt;&amp;#34;*&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;routes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                        &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;match&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;prefix&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;direct_response&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;status&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                              &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;inline_string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;hello from the server\n&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;http_filters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;envoy.filters.http.router&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;typed_config&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;{}&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;clusters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;web_service&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;connect_timeout&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0.&lt;/span&gt;&lt;span class=&#34;l&#34;&gt;25s&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;STATIC&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;lb_policy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;ROUND_ROBIN&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;load_assignment&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;cluster_name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;mock_service&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;endpoints&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;lb_endpoints&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;endpoint&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;address&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;socket_address&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;address&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;127.0.0.1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;port_value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;8099&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;admin&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;access_log_path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;/dev/null&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;address&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;socket_address&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;address&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0.0.0.0&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;port_value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;8001&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿è¡Œ Docker å®¹å™¨ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker run --rm -p 18000:18000 &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  -v &lt;span class=&#34;nv&#34;&gt;$PWD&lt;/span&gt;/envoy.yaml:/envoy.yaml &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  -v &lt;span class=&#34;nv&#34;&gt;$PWD&lt;/span&gt;/main.wasm:/main.wasm &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  --entrypoint envoy containers.istio.tetratelabs.com/proxyv2:1.9.7-tetrate-v0 &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  -l debug &lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;se&#34;&gt;&lt;/span&gt;  -c /envoy.yaml
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;é€šè¿‡ curl æµ‹è¯•ã€‚é¦–å…ˆï¼Œæ²¡æœ‰è®¾ç½®å†…å®¹ç±»å‹ï¼Œå°†è¿”å› 403ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;% curl -i -X POST localhost:18000
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;HTTP/1.1 &lt;span class=&#34;m&#34;&gt;403&lt;/span&gt; Forbidden
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;content-length: &lt;span class=&#34;m&#34;&gt;29&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;content-type: text/plain
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;date: Sun, &lt;span class=&#34;m&#34;&gt;13&lt;/span&gt; Mar &lt;span class=&#34;m&#34;&gt;2022&lt;/span&gt; 22:13:37 GMT
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;server: envoy
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;content-type must be provided
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç„¶åï¼Œè¯·æ±‚ body ä¸æ˜¯ JSONï¼ŒåŒæ ·è¿”å› 403ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;% curl -i -X POST localhost:18000 -H &lt;span class=&#34;s1&#34;&gt;&amp;#39;Content-Type: application/json&amp;#39;&lt;/span&gt; --data &lt;span class=&#34;s1&#34;&gt;&amp;#39;not JSON&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;HTTP/1.1 &lt;span class=&#34;m&#34;&gt;403&lt;/span&gt; Forbidden
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;content-length: &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;content-type: text/plain
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;date: Sun, &lt;span class=&#34;m&#34;&gt;13&lt;/span&gt; Mar &lt;span class=&#34;m&#34;&gt;2022&lt;/span&gt; 22:15:53 GMT
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;server: envoy
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;invalid payload
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;JSON è´Ÿè½½ä¸­æ²¡æœ‰ &lt;code&gt;token&lt;/code&gt; å­—æ®µï¼Œè¿˜æ˜¯è¿”å› 403ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;% curl -i -X POST localhost:18000 -H &lt;span class=&#34;s1&#34;&gt;&amp;#39;Content-Type: application/json&amp;#39;&lt;/span&gt; --data &lt;span class=&#34;s1&#34;&gt;&amp;#39;{&amp;#34;id&amp;#34;: &amp;#34;xxx&amp;#34;}&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;HTTP/1.1 &lt;span class=&#34;m&#34;&gt;403&lt;/span&gt; Forbidden
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;content-length: &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;content-type: text/plain
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;date: Sun, &lt;span class=&#34;m&#34;&gt;13&lt;/span&gt; Mar &lt;span class=&#34;m&#34;&gt;2022&lt;/span&gt; 22:17:18 GMT
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;server: envoy
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;invalid payload
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å½“ id å’Œ token å­—æ®µéƒ½è¢«æä¾›æ—¶ï¼Œå°†è¿”å›ä¸€ä¸ªæˆåŠŸçš„å“åº”ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;% curl -i -X POST localhost:18000 -H &lt;span class=&#34;s1&#34;&gt;&amp;#39;Content-Type: application/json&amp;#39;&lt;/span&gt; --data &lt;span class=&#34;s1&#34;&gt;&amp;#39;{&amp;#34;id&amp;#34;: &amp;#34;xxx&amp;#34;, &amp;#34;token&amp;#34;: &amp;#34;xxx&amp;#34;, &amp;#34;anotherField&amp;#34;: &amp;#34;yyy&amp;#34;}&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;HTTP/1.1 &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;content-length: &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;content-type: text/plain
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;date: Sun, &lt;span class=&#34;m&#34;&gt;13&lt;/span&gt; Mar &lt;span class=&#34;m&#34;&gt;2022&lt;/span&gt; 22:18:37 GMT
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;server: envoy
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;x-envoy-upstream-service-time: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;hello from the server
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;éƒ¨ç½²åˆ°-istio&#34;&gt;éƒ¨ç½²åˆ° Istio&lt;/h2&gt;
&lt;h3 id=&#34;éƒ¨ç½²-istio-å’Œ-httpbin-ç¤ºä¾‹åº”ç”¨&#34;&gt;éƒ¨ç½² Istio å’Œ httpbin ç¤ºä¾‹åº”ç”¨&lt;/h3&gt;
&lt;p&gt;æˆ‘ä»¬ä½¿ç”¨ &lt;a href=&#34;https://kind.sigs.k8s.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;kind&lt;/a&gt; æ¥åˆ›å»ºæµ‹è¯•é›†ç¾¤ï¼Œå¯¹äºå…¶ä»–æ–¹å¼åˆ›å»ºçš„ Kubernetes é›†ç¾¤åŒæ ·é€‚ç”¨ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kind create cluster
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;é›†ç¾¤åˆ›å»ºå®Œæ¯•åï¼Œå®‰è£… Istioï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ Istio 1.12.3ï¼Œå®‰è£… &lt;a href=&#34;https://github.com/istio/istio/tree/master/samples/httpbin&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Istio httpbin ç¤ºä¾‹åº”ç”¨&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;istioctl install --set &lt;span class=&#34;nv&#34;&gt;profile&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;demo
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl label namespace default istio-injection&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;enabled
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl apply -f https://raw.githubusercontent.com/istio/istio/release-1.12/samples/httpbin/httpbin.yaml
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl apply -f https://raw.githubusercontent.com/istio/istio/release-1.12/samples/httpbin/httpbin-gateway.yaml
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åœ¨å¦ä¸€ä¸ªç»ˆç«¯ä¸­ï¼Œå°† Ingress ç½‘å…³çš„ 80 ç«¯å£è½¬å‘åˆ°ä½ æœ¬åœ°æœºå™¨çš„ 8080 ç«¯å£ä¸Šã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl port-forward -n istio-system svc/istio-ingressgateway 8080:80
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å‘é€ curl è¯·æ±‚ï¼Œæ£€æŸ¥æœåŠ¡æ˜¯å¦æ­£å¸¸å¯åŠ¨ï¼Œä½ åº”è¯¥åº”è¯¥çœ‹åˆ°æˆåŠŸçš„å“åº”ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;curl -X POST -i http://localhost:8080/post
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æœ‰ä¸¤ç§æ–¹å¼åœ¨ Istio ä¸­å®‰è£… Wasm æ¨¡å—ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å¯¹äº Istio 1.12 å’Œæ›´æ–°ç‰ˆæœ¬çš„ Istioï¼Œæ”¯æŒ &lt;a href=&#34;https://istio.io/latest/docs/reference/config/proxy_extensions/wasm-plugin/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;WasmPlugin&lt;/a&gt; èµ„æº&lt;/li&gt;
&lt;li&gt;å¯¹äºè€ç‰ˆæœ¬çš„ Istioï¼Œå¯ä»¥ä½¿ç”¨ &lt;a href=&#34;https://istio.io/latest/docs/reference/config/networking/envoy-filter/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;EnvoyFilter&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;ä½¿ç”¨-wasmplugin-å®‰è£…&#34;&gt;ä½¿ç”¨ WasmPlugin å®‰è£…&lt;/h3&gt;
&lt;p&gt;WasmPlugin èµ„æºä»é•œåƒä»“åº“ä¸­æå– wasm æ¨¡å—ã€‚å› æ­¤ï¼Œè®©æˆ‘ä»¬é¦–å…ˆä¸ºæˆ‘ä»¬çš„ wasm æ¨¡å—æ„å»ºå¹¶æ¨é€ä¸€ä¸ª Docker é•œåƒã€‚ä¸‹é¢çš„ Docker æ–‡ä»¶å…è®¸ä»ä½ çš„ wasm æ¨¡å—å»ºç«‹ä¸€ä¸ª Docker é•œåƒã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-Docker&#34; data-lang=&#34;Docker&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;FROM&lt;/span&gt;&lt;span class=&#34;s&#34;&gt; scratch&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;COPY&lt;/span&gt; main.wasm ./&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ„å»ºé•œåƒï¼Œæ¨é€åˆ°é•œåƒä»“åº“ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;export&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;HUB&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;your_registry &lt;span class=&#34;c1&#34;&gt;# e.g. docker.io/tetrate&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker build . -t &lt;span class=&#34;nv&#34;&gt;$HUB&lt;/span&gt;/json-validation:v1
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker push &lt;span class=&#34;nv&#34;&gt;$HUB&lt;/span&gt;/json-validation:v1
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç°åœ¨æˆ‘ä»¬åˆ›å»º &lt;a href=&#34;https://istio.io/latest/docs/reference/config/proxy_extensions/wasm-plugin/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;WasmPlugin&lt;/a&gt; èµ„æºã€‚è¿™å°†é€‚ç”¨äºæ‰€æœ‰é€šè¿‡ Istio Ingress ç½‘å…³æš´éœ²çš„è·¯ç”±ï¼Œå¹¶å¯¹å…¶åº”ç”¨æˆ‘ä»¬çš„éªŒè¯ã€‚ç¡®ä¿ä½ æŠŠ &lt;code&gt;{your_registry}&lt;/code&gt; æ›¿æ¢ä¸ºä½ ä¸Šä¼  wasm é•œåƒçš„é•œåƒä»“åº“ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;extensions.istio.io/v1alpha1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;WasmPlugin&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;json-validation&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;istio-system&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;selector&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;matchLabels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;istio&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;ingressgateway&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;url&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;oci://{your_registry}/json-validation:v3&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;imagePullPolicy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;IfNotPresent&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;phase&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;AUTHN&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;ä½¿ç”¨-envoyfilter-å®‰è£…&#34;&gt;ä½¿ç”¨ EnvoyFilter å®‰è£…&lt;/h3&gt;
&lt;p&gt;ä¸ºäº†ä½¿ç”¨ EnvoyFilterï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåŒ…å«å·²ç¼–è¯‘çš„ Wasm æ’ä»¶çš„ ConfigMapï¼Œå°† ConfigMap æŒ‚è½½åˆ°ç½‘å…³ pod ä¸­ï¼Œç„¶åé€šè¿‡ EnvoyFilter é…ç½® Envoyï¼Œä»æœ¬åœ°æ–‡ä»¶åŠ è½½ Wasm æ’ä»¶ã€‚è¿™ç§æ–¹æ³•çš„é™åˆ¶æ˜¯ï¼Œæ›´å¤§å’Œæ›´å¤æ‚çš„ Wasm æ¨¡å—å¯èƒ½è¶…å‡º ConfigMap 1MB çš„å¤§å°é™åˆ¶ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªåŒ…å«ç¼–è¯‘å¥½çš„ Wasm æ¨¡å—çš„ ConfigMapï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl -n istio-system create configmap wasm-plugins --from-file&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;main.wasm
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç„¶ååœ¨ Istio Ingress ç½‘å…³éƒ¨ç½²ä¸­æ‰“è¡¥ä¸ï¼ŒæŒ‚è½½è¿™ä¸ª ConfigMapã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl -n istio-system patch deployment istio-ingressgateway --patch&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;spec:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;  template:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;    spec:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;      containers:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;        - name: istio-proxy
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;          volumeMounts:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;            - name: wasm-plugins
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;              mountPath: /var/local/lib/wasm-plugins
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;              readOnly: true
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;      volumes:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;        - name: wasm-plugins
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;          configMap:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;            name: wasm-plugins&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç°åœ¨ Wasm æ¨¡å—å°±æŒ‚è½½åˆ°äº†ç½‘å…³ Pod ä¸­ï¼Œåº”ç”¨è¿™ä¸ª EnvoyFilterã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;networking.istio.io/v1alpha3&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;EnvoyFilter&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;json-validation&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;istio-system&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;configPatches&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;applyTo&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;HTTP_FILTER&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;match&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;GATEWAY&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;patch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;operation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;INSERT_BEFORE&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;json-validation&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;typed_config&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#39;@type&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;type.googleapis.com/envoy.extensions.filters.http.wasm.v3.Wasm&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;config&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;vm_config&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;code&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;local&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;filename&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;/var/local/lib/wasm-plugins/main.wasm&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;runtime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;envoy.wasm.runtime.v8&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;vm_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;json-validation&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;æµ‹è¯•-wasm-æ’ä»¶&#34;&gt;æµ‹è¯• Wasm æ’ä»¶&lt;/h3&gt;
&lt;p&gt;é‡å¤ä¹‹å‰çš„ curl è¯·æ±‚ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;% curl -X POST -i http://localhost:8080/post
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;HTTP/1.1 &lt;span class=&#34;m&#34;&gt;403&lt;/span&gt; Forbidden
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;content-length: &lt;span class=&#34;m&#34;&gt;29&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;content-type: text/plain
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;date: Tue, &lt;span class=&#34;m&#34;&gt;15&lt;/span&gt; Mar &lt;span class=&#34;m&#34;&gt;2022&lt;/span&gt; 22:04:35 GMT
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;server: istio-envoy
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;content-type must be provided
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¦‚æœæä¾›äº†å†…å®¹ç±»å‹å’Œ json è´Ÿè½½çš„è¯ï¼Œè¯·æ±‚å°†ä¼šæˆåŠŸã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;curl -i http://localhost:8080/post  -H &lt;span class=&#34;s1&#34;&gt;&amp;#39;Content-Type: application/json&amp;#39;&lt;/span&gt; --data &lt;span class=&#34;s1&#34;&gt;&amp;#39;{&amp;#34;id&amp;#34;: &amp;#34;xxx&amp;#34;, &amp;#34;token&amp;#34;: &amp;#34;xxx&amp;#34;}&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;è®©å¿…å¡«å­—æ®µå¯é…ç½®&#34;&gt;è®©å¿…å¡«å­—æ®µå¯é…ç½®&lt;/h2&gt;
&lt;p&gt;ä¸å…¶åœ¨ç¼–è¯‘çš„ golang ä»£ç ä¸­ç¡¬ç¼–ç æ‰€éœ€çš„ JSON å­—æ®µï¼Œä¸å¦‚å…è®¸é€šè¿‡ Envoy é…ç½®æ¥é…ç½®è¿™äº›å­—æ®µã€‚&lt;/p&gt;
&lt;p&gt;å½“åœ¨ Docker ä¸­è¿è¡Œ Envoy æ—¶ï¼Œå¯ä»¥é€šè¿‡å‘ä¹‹å‰åˆ›å»ºçš„ Wasm &lt;code&gt;http_filter&lt;/code&gt; æ·»åŠ é…ç½®æ¥å®ç°ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;http_filters&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;envoy.filters.http.wasm&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;typed_config&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;@type&amp;#34;: &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;type.googleapis.com/udpa.type.v1.TypedStruct&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;type_url&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;type.googleapis.com/envoy.extensions.filters.http.wasm.v3.Wasm&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;config&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;configuration&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;@type&amp;#34;: &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;type.googleapis.com/google.protobuf.StringValue&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;                                                            &lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                                                            &lt;/span&gt;{&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;requiredKeys&amp;#34;: &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;id&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;token&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;}&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;vm_config&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;runtime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;envoy.wasm.runtime.v8&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;code&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                              &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;local&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                                &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;filename&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;./main.wasm&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å½“ä½¿ç”¨ WasmPluginï¼Œåœ¨ &lt;code&gt;pluginConfig&lt;/code&gt; å­—æ®µä¸­é…ç½®ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;extensions.istio.io/v1alpha1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;WasmPlugin&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;json-validation&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;istio-system&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;selector&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;matchLabels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;istio&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;ingressgateway&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;url&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;oci://{your_registry}/json-validation:v3&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;imagePullPolicy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;IfNotPresent&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;phase&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;AUTHN&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;pluginConfig&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;requiredKeys&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;id&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;token&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æœ€åï¼Œå½“ä½¿ç”¨ EnvoyFilter æ—¶ï¼Œå°†å®ƒæ·»åŠ åˆ° filter é…ç½®ä¸­ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;json-validation&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;typed_config&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#39;@type&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;type.googleapis.com/envoy.extensions.filters.http.wasm.v3.Wasm&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;config&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;configuration&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;@type&amp;#34;: &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;type.googleapis.com/google.protobuf.StringValue&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;                                &lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                                &lt;/span&gt;{&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;requiredKeys&amp;#34;: &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;id&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;token&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;}&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;vm_config&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;code&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;local&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;                  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;filename&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;/var/local/lib/wasm-plugins/main.wasm&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;runtime&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;envoy.wasm.runtime.v8&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;vm_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;json-validation&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åœ¨ä»£ç ä¸­ï¼Œå®ç° &lt;code&gt;OnPluginStart&lt;/code&gt;ï¼Œä½¿ç”¨ &lt;code&gt;proxywasm.GetPluginConfiguration&lt;/code&gt; åŠ è½½ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// pluginContext å®ç° proxy-wasm-go SDK ä¸­çš„ types.PluginContext æ¥å£
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;pluginContext&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;c1&#34;&gt;// åœ¨è¿™é‡ŒåµŒå…¥é»˜è®¤çš„ plugin ä¸Šä¸‹æ–‡ï¼Œè¿™æ ·å°±ä¸ç”¨å®ç°æ‰€æœ‰æ–¹æ³•
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;types&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;DefaultPluginContext&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;configuration&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;pluginConfiguration&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// pluginConfiguration ä»£è¡¨è¿™ä¸ª wasm æ’ä»¶ä¸­çš„ç¤ºä¾‹é…ç½®
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;type&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;pluginConfiguration&lt;/span&gt; &lt;span class=&#34;kd&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;c1&#34;&gt;// ç¤ºä¾‹é…ç½®å­—æ®µï¼Œæ’ä»¶å°†éªŒè¯ json è´Ÿè½½ä¸­æ˜¯å¦å­˜åœ¨è¿™äº›å­—æ®µã€‚
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;nx&#34;&gt;requiredKeys&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// å¤å†™ types.DefaultPluginContext
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ctx&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;pluginContext&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;OnPluginStart&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;pluginConfigurationSize&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;types&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;OnPluginStartStatus&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;proxywasm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;GetPluginConfiguration&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;nx&#34;&gt;proxywasm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;LogCriticalf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;error reading plugin configuration: %v&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;types&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;OnPluginStartStatusFailed&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;config&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;parsePluginConfiguration&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;nx&#34;&gt;proxywasm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;LogCriticalf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;error parsing plugin configuration: %v&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;types&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;OnPluginStartStatusFailed&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;ctx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;configuration&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;config&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;types&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;OnPluginStartStatusOK&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// parsePluginConfiguration è§£æ json æ’ä»¶é…ç½®å¹¶è¿”å› pluginConfiguration
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// æ³¨æ„ä½¿ç”¨ gjson è§£æ jsonï¼Œå› ä¸º TinyGo ä¸æ”¯æŒ encoding/json
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ https://github.com/mailru/easyjsonï¼Œæ”¯æŒè§£æä¸ºç»“æ„ä½“
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;parsePluginConfiguration&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;byte&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;pluginConfiguration&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;error&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;config&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;pluginConfiguration&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;gjson&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;ValidBytes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;fmt&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Errorf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;the plugin configuration is not a valid json: %v&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;jsonData&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;gjson&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;ParseBytes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;requiredKeys&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;jsonData&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;requiredKeys&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Array&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;_&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;requiredKey&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;range&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;requiredKeys&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;nx&#34;&gt;config&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;requiredKeys&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;config&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;requiredKeys&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;requiredKey&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;config&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç°åœ¨å®ƒä»¬è¢«åŒ…å«åœ¨ &lt;code&gt;pluginConfiguration&lt;/code&gt; ç»“æ„ä¸­ï¼Œå®ƒä»¬å¯ä»¥åƒå…¶ä»–å­—æ®µä¸€æ ·åœ¨éªŒè¯è¿‡ç¨‹ä¸­è¢«ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// validatePayload éªŒè¯ç»™å®šçš„ json è´Ÿè½½
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// æ³¨æ„è¯¥å‡½æ•°ä½¿ç”¨ gjson è§£æ jsonï¼Œå› ä¸º TinyGo ä¸æ”¯æŒ encoding/json
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ctx&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;payloadValidationContext&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;validatePayload&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;body&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;byte&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;bool&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;gjson&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;ValidBytes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;nx&#34;&gt;proxywasm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;LogErrorf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;body is not a valid json: %v&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;false&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;jsonData&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;gjson&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;ParseBytes&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;body&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;c1&#34;&gt;// éªŒè¯ jsonã€‚æ£€æŸ¥ç¤ºä¾‹ä¸­æ˜¯å¦åŒ…å«å¿…é¡»çš„é”®ã€‚
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;c1&#34;&gt;// å¿…é¡»çš„é”®é€šè¿‡æ’ä»¶é…ç½®ã€‚
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;_&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;requiredKey&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;range&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ctx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;requiredKeys&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;jsonData&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Get&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;requiredKey&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Exists&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;nx&#34;&gt;proxywasm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;LogErrorf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;required key (%v) is missing: %v&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;requiredKey&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;jsonData&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;false&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;true&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç„¶åå¯ä»¥ä½¿ç”¨ä¸ä¹‹å‰ç›¸åŒçš„å‘½ä»¤å¯¹å…¶è¿›è¡Œç¼–è¯‘å’Œæµ‹è¯•ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;æ€»è€Œè¨€ä¹‹ï¼Œè¦åœ¨ Istio 1.12 å’Œæ›´æ–°çš„ç‰ˆæœ¬ä¸Šä½¿ç”¨ Wasm æ’ä»¶ï¼Œéœ€è¦ä¸‰ä¸ªæ­¥éª¤ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åœ¨ä½ é€‰æ‹©çš„è¯­è¨€ä¸­å®ç°æ’ä»¶çš„åŠŸèƒ½ã€‚æˆ‘åœ¨æœ¬æ•™ç¨‹ä¸­ä½¿ç”¨ Golangã€‚&lt;/li&gt;
&lt;li&gt;ç¼–è¯‘ Wasm æ’ä»¶å¹¶æ¨é€åˆ°é•œåƒä»“åº“ã€‚&lt;/li&gt;
&lt;li&gt;é…ç½® Istio ä»¥åŠ è½½å’Œä½¿ç”¨é•œåƒä»“åº“ä¸­çš„æ’ä»¶ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è¯¥æ•™ç¨‹è¿˜è¯¦ç»†ä»‹ç»äº†å¦‚ä½•ä½¿ç”¨ Docker åœ¨ Envoy å®¹å™¨ä¸­è¿è¡Œ Wasm æ’ä»¶ï¼Œä»¥åŠ å¿«å¼€å‘é€Ÿåº¦ï¼Œä»¥åŠå¦‚ä½•å°†å…¶éƒ¨ç½²åˆ°æ—§çš„ Istio ç‰ˆæœ¬ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Slack å°†æ•°ç™¾ä¸‡ä¸ªå¹¶å‘çš„ Websockets è¿ç§»åˆ° Envoy ä¸Šç»éªŒåˆ†äº«</title>
      <link>https://lib.jimmysong.io/blog/migrating-millions-of-concurrent-websockets-to-envoy/</link>
      <pubDate>Fri, 08 Apr 2022 13:00:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/migrating-millions-of-concurrent-websockets-to-envoy/</guid>
      <description>&lt;h2 id=&#34;å‰è¨€&#34;&gt;å‰è¨€&lt;/h2&gt;
&lt;p&gt;Slack æœ‰ä¸€ä¸ªå…¨çƒå®¢æˆ·ç¾¤ï¼Œåœ¨é«˜å³°æœŸæœ‰æ•°ç™¾ä¸‡åŒæ—¶è¿æ¥çš„ç”¨æˆ·ã€‚ç”¨æˆ·ä¹‹é—´çš„å¤§éƒ¨åˆ†é€šä¿¡æ¶‰åŠåˆ°å‘å¯¹æ–¹å‘é€å¤§é‡çš„å¾®å°ä¿¡æ¯ã€‚åœ¨ Slack çš„å¤§éƒ¨åˆ†å†å²ä¸­ï¼Œæˆ‘ä»¬ä¸€ç›´ä½¿ç”¨ &lt;a href=&#34;https://www.haproxy.com/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;HAProxy&lt;/a&gt; ä½œä¸ºæ‰€æœ‰ä¼ å…¥æµé‡çš„è´Ÿè½½å‡è¡¡å™¨ã€‚ä»Šå¤©ï¼Œæˆ‘ä»¬å°†è®¨è®ºæˆ‘ä»¬åœ¨ä½¿ç”¨ HAProxy æ—¶æ‰€é¢ä¸´çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¦‚ä½•ç”¨ &lt;a href=&#34;https://www.envoyproxy.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Envoy Proxy&lt;/a&gt; æ¥è§£å†³è¿™äº›é—®é¢˜ï¼Œè¿ç§»æ‰€æ¶‰åŠçš„æ­¥éª¤ï¼Œä»¥åŠç»“æœæ˜¯ä»€ä¹ˆã€‚è®©æˆ‘ä»¬å¼€å§‹å§ï¼&lt;/p&gt;
&lt;h2 id=&#34;slack-çš„-websockets&#34;&gt;Slack çš„ Websockets&lt;/h2&gt;
&lt;p&gt;ä¸ºäº†å³æ—¶ä¼ é€’ä¿¡æ¯ï¼Œæˆ‘ä»¬ä½¿ç”¨ &lt;a href=&#34;https://tools.ietf.org/html/rfc6455&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;websocket è¿æ¥&lt;/a&gt;ï¼Œè¿™æ˜¯ä¸€ç§åŒå‘çš„é€šä¿¡é“¾æ¥ï¼Œè´Ÿè´£è®©ä½ çœ‹åˆ° &amp;ldquo;æœ‰å‡ ä¸ªäººåœ¨æ‰“å­—&amp;hellip;&amp;hellip;&amp;quot;ï¼Œç„¶åæ˜¯ä»–ä»¬æ‰“çš„ä¸œè¥¿ï¼Œé€Ÿåº¦å‡ ä¹æ˜¯å…‰é€Ÿçš„ã€‚websocket è¿æ¥è¢«æ‘„å–åˆ°ä¸€ä¸ªå«åš &amp;ldquo;wss&amp;rdquo;ï¼ˆWebSocket æœåŠ¡ï¼‰çš„ç³»ç»Ÿä¸­ï¼Œå¯ä»¥é€šè¿‡ &lt;code&gt;wss-primary.slack.com&lt;/code&gt; å’Œ &lt;code&gt;wss-backup.slack.com&lt;/code&gt;ï¼ˆè¿™ä¸æ˜¯ç½‘ç«™ï¼Œå¦‚æœå»è®¿é—®ï¼Œåªä¼šå¾—åˆ°ä¸€ä¸ª HTTP 404ï¼‰ä»äº’è”ç½‘ä¸Šè®¿é—®ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-æ˜¾ç¤ºwebsocketså·¥ä½œåŸç†çš„å›¾è¡¨&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;æ˜¾ç¤ºwebsocketså·¥ä½œåŸç†çš„å›¾è¡¨&#34; srcset=&#34;
               /blog/migrating-millions-of-concurrent-websockets-to-envoy/e6c9d24ely1h1277posyqj20cg0b8dfz_hu7458e3ce3021aedb0c1d1cc83687f4c6_15076_2a20b78aa8df46485340ee7bf498c68b.webp 400w,
               /blog/migrating-millions-of-concurrent-websockets-to-envoy/e6c9d24ely1h1277posyqj20cg0b8dfz_hu7458e3ce3021aedb0c1d1cc83687f4c6_15076_781b2428de2b829327547b72bb64879e.webp 760w,
               /blog/migrating-millions-of-concurrent-websockets-to-envoy/e6c9d24ely1h1277posyqj20cg0b8dfz_hu7458e3ce3021aedb0c1d1cc83687f4c6_15076_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/migrating-millions-of-concurrent-websockets-to-envoy/e6c9d24ely1h1277posyqj20cg0b8dfz_hu7458e3ce3021aedb0c1d1cc83687f4c6_15076_2a20b78aa8df46485340ee7bf498c68b.webp&#34;
               width=&#34;448&#34;
               height=&#34;404&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      æ˜¾ç¤ºwebsocketså·¥ä½œåŸç†çš„å›¾è¡¨
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;Websocket è¿æ¥ä¸€å¼€å§‹æ˜¯æ™®é€šçš„ HTTPS è¿æ¥ï¼Œç„¶åå®¢æˆ·ç«¯å‘å‡ºåè®®åˆ‡æ¢è¯·æ±‚ï¼Œå°†è¿æ¥å‡çº§ä¸º Websocketã€‚åœ¨ Slackï¼Œæˆ‘ä»¬æœ‰ä¸åŒçš„ websocket æœåŠ¡ï¼Œä¸“é—¨ç”¨äºæ¶ˆæ¯ã€åœ¨çº¿ï¼ˆåˆ—å‡ºå“ªäº›è”ç³»äººåœ¨çº¿ï¼‰å’Œå…¶ä»–æœåŠ¡ã€‚å…¶ä¸­ä¸€ä¸ª websocket ç«¯ç‚¹æ˜¯ä¸“é—¨ä¸ºéœ€è¦ä¸ Slack äº’åŠ¨çš„åº”ç”¨ç¨‹åºåˆ¶ä½œçš„ï¼ˆå› ä¸ºåº”ç”¨ç¨‹åºä¹Ÿæƒ³è¦å®æ—¶é€šä¿¡ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-è§£é‡Šæµé‡å¦‚ä½•è¢«è·¯ç”±åˆ°åç«¯æœåŠ¡çš„æµç¨‹å›¾&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;è§£é‡Šæµé‡å¦‚ä½•è¢«è·¯ç”±åˆ°åç«¯æœåŠ¡çš„æµç¨‹å›¾&#34; srcset=&#34;
               /blog/migrating-millions-of-concurrent-websockets-to-envoy/e6c9d24ely1h1277nk5l3j20hr0bbq3e_hu6c596f20948c0eb170c82391812cb7ee_26299_ac7a9665cdcf26846a29601422c04bdc.webp 400w,
               /blog/migrating-millions-of-concurrent-websockets-to-envoy/e6c9d24ely1h1277nk5l3j20hr0bbq3e_hu6c596f20948c0eb170c82391812cb7ee_26299_143cad29b11983523c6bbda9a9b7c2ad.webp 760w,
               /blog/migrating-millions-of-concurrent-websockets-to-envoy/e6c9d24ely1h1277nk5l3j20hr0bbq3e_hu6c596f20948c0eb170c82391812cb7ee_26299_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/migrating-millions-of-concurrent-websockets-to-envoy/e6c9d24ely1h1277nk5l3j20hr0bbq3e_hu6c596f20948c0eb170c82391812cb7ee_26299_ac7a9665cdcf26846a29601422c04bdc.webp&#34;
               width=&#34;639&#34;
               height=&#34;407&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      è§£é‡Šæµé‡å¦‚ä½•è¢«è·¯ç”±åˆ°åç«¯æœåŠ¡çš„æµç¨‹å›¾
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;è¿‡å»ï¼Œæˆ‘ä»¬åœ¨å¤šä¸ª &lt;a href=&#34;https://aws.amazon.com/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;AWS&lt;/a&gt; Region æœ‰ä¸€ç»„ä¸“é—¨ç”¨äº websockets çš„ HAProxy å®ä¾‹ï¼Œä»¥ç»ˆæ­¢é è¿‘ç”¨æˆ·çš„ websocket è¿æ¥ï¼Œå¹¶å°†è¯·æ±‚è½¬å‘ç»™ç›¸åº”çš„åç«¯æœåŠ¡ã€‚&lt;/p&gt;
&lt;h2 id=&#34;è¿ç§»åˆ°-envoy-proxy-çš„åŠ¨æœº&#34;&gt;è¿ç§»åˆ° Envoy Proxy çš„åŠ¨æœº&lt;/h2&gt;
&lt;p&gt;è™½ç„¶æˆ‘ä»¬ä» Slack å¼€å§‹å°±ä¸€ç›´åœ¨ä½¿ç”¨ HAproxyï¼Œå¹¶ä¸”çŸ¥é“å¦‚ä½•å¤§è§„æ¨¡åœ°æ“ä½œå®ƒï¼Œä½†æœ‰ä¸€äº›æ“ä½œä¸Šçš„æŒ‘æˆ˜è®©æˆ‘ä»¬è€ƒè™‘æ›¿ä»£æ–¹æ¡ˆï¼Œæ¯”å¦‚ Envoy Proxyã€‚&lt;/p&gt;
&lt;h3 id=&#34;çƒ­é‡å¯&#34;&gt;çƒ­é‡å¯&lt;/h3&gt;
&lt;p&gt;åœ¨ Slackï¼Œåç«¯æœåŠ¡ç«¯ç‚¹åˆ—è¡¨çš„å˜åŒ–æ˜¯ä¸€ä¸ªå¸¸è§çš„äº‹ä»¶ï¼ˆç”±äºå®ä¾‹è¢«æ·»åŠ æˆ–åˆ é™¤ï¼‰ã€‚HAProxy æä¾›ä¸¤ç§æ–¹æ³•æ¥æ›´æ–°å…¶é…ç½®ï¼Œä»¥é€‚åº”ç«¯ç‚¹åˆ—è¡¨çš„å˜åŒ–ã€‚ä¸€ç§æ˜¯ä½¿ç”¨ HAProxy Runtime APIã€‚æˆ‘ä»¬åœ¨å…¶ä¸­ä¸€å¥— HAProxy å®ä¾‹ä¸­ä½¿ç”¨äº†è¿™ç§æ–¹æ³•ï¼Œæˆ‘ä»¬çš„ç»éªŒåœ¨å¦ä¸€ç¯‡åšæ–‡ä¸­æœ‰æ‰€æè¿° â€”â€” &lt;a href=&#34;https://slack.engineering/a-terrible-horrible-no-good-very-bad-day-at-slack/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;åœ¨ Slack çš„å¯æ€•çš„ã€ææ€–çš„ã€æ²¡æœ‰å¥½å¤„çš„ã€éå¸¸ç³Ÿç³•çš„ä¸€å¤©&lt;/a&gt;ã€‚å¦ä¸€ç§æ–¹æ³•ï¼Œæˆ‘ä»¬ç”¨äº websockets è´Ÿè½½å‡è¡¡å™¨ï¼ˆLBï¼‰ï¼Œæ˜¯å°†åç«¯æ¸²æŸ“åˆ° HAProxy é…ç½®æ–‡ä»¶ä¸­ï¼Œç„¶åé‡æ–°åŠ è½½ HAProxyã€‚&lt;/p&gt;
&lt;p&gt;æ¯æ¬¡ HAProxy é‡è½½æ—¶ï¼Œéƒ½ä¼šåˆ›å»ºä¸€ç»„æ–°çš„è¿›ç¨‹æ¥å¤„ç†æ–°è¿›å…¥çš„è¿æ¥ã€‚æˆ‘ä»¬ä¼šè®©æ—§çš„è¿›ç¨‹æŒç»­è¿è¡Œå¾ˆå¤šå°æ—¶ï¼Œä»¥ä¾¿è®©é•¿å¯¿çš„ websocket è¿æ¥è€—å°½ï¼Œé¿å…ç”¨æˆ·é¢‘ç¹æ–­å¼€è¿æ¥ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬ä¸èƒ½æœ‰å¤ªå¤šçš„ HAProxy è¿›ç¨‹ï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½è¿è¡Œç€å®ƒè‡ªå·± &amp;ldquo;å½“æ—¶&amp;rdquo; çš„é…ç½®å‰¯æœ¬ â€”â€” æˆ‘ä»¬å¸Œæœ›å®ä¾‹èƒ½æ›´å¿«åœ°æ±‡èšåˆ°æ–°ç‰ˆæœ¬çš„é…ç½®ä¸Šã€‚æˆ‘ä»¬ä¸å¾—ä¸å®šæœŸæ”¶å‰²æ—§çš„ HAProxy è¿›ç¨‹ï¼Œå¹¶é™åˆ¶ HAProxy é‡æ–°åŠ è½½çš„é¢‘ç‡ï¼Œä»¥é˜²åº•å±‚åç«¯å‡ºç°æ··ä¹±ã€‚&lt;/p&gt;
&lt;p&gt;æ— è®ºæˆ‘ä»¬ä½¿ç”¨å“ªç§æ–¹æ³•ï¼Œéƒ½éœ€è¦ä¸€äº›é¢å¤–çš„åŸºç¡€è®¾æ–½æ¥ç®¡ç† HAProxy çš„é‡æ–°åŠ è½½ã€‚&lt;/p&gt;
&lt;p&gt;Envoy å…è®¸æˆ‘ä»¬ä½¿ç”¨&lt;a href=&#34;https://www.envoyproxy.io/docs/envoy/latest/intro/arch_overview/upstream/service_discovery#arch-overview-service-discovery-types-eds&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;åŠ¨æ€é…ç½®çš„é›†ç¾¤å’Œç«¯ç‚¹&lt;/a&gt;ï¼Œè¿™æ„å‘³ç€å¦‚æœç«¯ç‚¹åˆ—è¡¨å‘ç”Ÿå˜åŒ–ï¼Œå®ƒä¸éœ€è¦é‡æ–°åŠ è½½ã€‚å¦‚æœä»£ç æˆ–é…ç½®ç¡®å®å‘ç”Ÿäº†å˜åŒ–ï¼ŒEnvoy æœ‰èƒ½åŠ›åœ¨ä¸æ”¾å¼ƒä»»ä½•è¿æ¥çš„æƒ…å†µä¸‹&lt;a href=&#34;https://www.envoyproxy.io/docs/envoy/latest/intro/arch_overview/operations/hot_restart&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;çƒ­é‡å¯&lt;/a&gt;è‡ªå·±ã€‚Envoy é€šè¿‡ &lt;a href=&#34;https://en.wikipedia.org/wiki/Inotify&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;inotify&lt;/a&gt; è§‚å¯Ÿæ–‡ä»¶ç³»ç»Ÿé…ç½®çš„æ›´æ–°ã€‚åœ¨çƒ­é‡å¯è¿‡ç¨‹ä¸­ï¼ŒEnvoy è¿˜å°†ç»Ÿè®¡æ•°æ®ä»çˆ¶è¿›ç¨‹å¤åˆ¶åˆ°å­è¿›ç¨‹ä¸­ï¼Œå› æ­¤ä»ªè¡¨å’Œè®¡æ•°å™¨ä¸ä¼šè¢«é‡ç½®ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸€åˆ‡éƒ½ä½¿ Envoy çš„è¿è¥å¼€é”€å¤§å¤§å‡å°‘ï¼Œè€Œä¸”ä¸éœ€è¦é¢å¤–çš„æœåŠ¡æ¥ç®¡ç†é…ç½®å˜åŒ–æˆ–é‡æ–°å¯åŠ¨ã€‚&lt;/p&gt;
&lt;h3 id=&#34;è´Ÿè½½å‡è¡¡åŠŸèƒ½&#34;&gt;è´Ÿè½½å‡è¡¡åŠŸèƒ½&lt;/h3&gt;
&lt;p&gt;Envoy æä¾›äº†ä¸€äº›å…ˆè¿›çš„è´Ÿè½½å‡è¡¡åŠŸèƒ½ï¼Œå¦‚ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å†…ç½®æ”¯æŒåŒºåŸŸæ„ŸçŸ¥è·¯ç”±çš„åŠŸèƒ½&lt;/li&gt;
&lt;li&gt;é€šè¿‡&lt;a href=&#34;https://www.envoyproxy.io/docs/envoy/latest/intro/arch_overview/upstream/outlier#arch-overview-outlier-detection&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¼‚å¸¸å€¼æ£€æµ‹&lt;/a&gt;è¿›è¡Œè¢«åŠ¨å¥åº·æ£€æŸ¥&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.envoyproxy.io/docs/envoy/latest/intro/arch_overview/upstream/load_balancing/panic_threshold&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ææ…Œè·¯ç”±&lt;/a&gt;ï¼šEnvoy é€šå¸¸åªå°†æµé‡è·¯ç”±åˆ°å¥åº·çš„åç«¯ï¼Œä½†æ˜¯å¦‚æœå¥åº·ä¸»æœºçš„ç™¾åˆ†æ¯”ä½äºæŸä¸ªé˜ˆå€¼ï¼Œå®ƒå¯ä»¥è¢«é…ç½®ä¸ºå°†æµé‡å‘é€åˆ°æ‰€æœ‰çš„åç«¯ï¼Œä¸ç®¡æ˜¯å¥åº·çš„è¿˜æ˜¯ä¸å¥åº·çš„ã€‚è¿™åœ¨æˆ‘ä»¬ &lt;a href=&#34;https://slack.engineering/slacks-outage-on-january-4th-2021/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;2021 å¹´ 1 æœˆ 4 æ—¥çš„æ•…éšœ&lt;/a&gt;ä¸­éå¸¸æœ‰å¸®åŠ©ï¼Œè¿™æ¬¡æ•…éšœæ˜¯ç”±æˆ‘ä»¬åŸºç¡€è®¾æ–½ä¸­çš„ä¸€ä¸ªå¹¿æ³›çš„ç½‘ç»œé—®é¢˜å¼•èµ·çš„ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç”±äºä¸Šè¿°åŸå› ï¼Œåœ¨ 2019 å¹´ï¼Œæˆ‘ä»¬å†³å®šå°†æˆ‘ä»¬çš„å…¥å£è´Ÿè½½å‡è¡¡å±‚ä» HAproxy è¿ç§»åˆ° Envoy Proxyï¼Œä» websockets å †æ ˆå¼€å§‹ã€‚è¿ç§»çš„ä¸»è¦ç›®æ ‡æ˜¯æé«˜å¯æ“ä½œæ€§ï¼Œè·å¾— Envoy æä¾›çš„æ–°åŠŸèƒ½ï¼Œä»¥åŠæ›´åŠ æ ‡å‡†åŒ–ã€‚é€šè¿‡åœ¨æ•´ä¸ª Slack ä¸­ä» HAProxy è¿ç§»åˆ° Envoyï¼Œæˆ‘ä»¬çš„å›¢é˜Ÿå°†ä¸å†éœ€è¦äº†è§£ä¸¤ä¸ªè½¯ä»¶çš„æ€ªå¼‚ä¹‹å¤„ï¼Œä¸å†éœ€è¦ç»´æŠ¤ä¸¤ç§ä¸åŒçš„é…ç½®ï¼Œä¸å†éœ€è¦ç®¡ç†ä¸¤ä¸ªæ„å»ºå’Œå‘å¸ƒç®¡é“ï¼Œè¯¸å¦‚æ­¤ç±»ã€‚é‚£æ—¶ï¼Œæˆ‘ä»¬å·²ç»åœ¨ä½¿ç”¨ Envoy Proxy ä½œä¸ºæˆ‘ä»¬æœåŠ¡ç½‘æ ¼ä¸­çš„&lt;a href=&#34;https://blog.envoyproxy.io/service-mesh-data-plane-vs-control-plane-2774e720f7fc&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ•°æ®å¹³é¢&lt;/a&gt;ã€‚æˆ‘ä»¬å†…éƒ¨ä¹Ÿæœ‰ç»éªŒä¸°å¯Œçš„ Envoy å¼€å‘äººå‘˜ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥éšæ—¶è·å¾— Envoy çš„ä¸“ä¸šçŸ¥è¯†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç”Ÿæˆ-envoy-é…ç½®&#34;&gt;ç”Ÿæˆ Envoy é…ç½®&lt;/h2&gt;
&lt;p&gt;è¿™æ¬¡è¿ç§»çš„ç¬¬ä¸€æ­¥æ˜¯å®¡æŸ¥æˆ‘ä»¬ç°æœ‰çš„ websocket å±‚é…ç½®ï¼Œå¹¶ç”Ÿæˆä¸€ä¸ªåŒç­‰çš„ Envoy é…ç½®ã€‚åœ¨è¿ç§»è¿‡ç¨‹ä¸­ï¼Œç®¡ç† Envoy é…ç½®æ˜¯æˆ‘ä»¬æœ€å¤§çš„æŒ‘æˆ˜ä¹‹ä¸€ã€‚Envoy æœ‰ä¸°å¯Œçš„åŠŸèƒ½é›†ï¼Œå…¶é…ç½®ä¸ HAProxy çš„é…ç½®æœ‰å¾ˆå¤§çš„ä¸åŒã€‚Envoy é…ç½®æ¶‰åŠå››ä¸ªä¸»è¦æ¦‚å¿µï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Listener&lt;/strong&gt;ï¼Œæ¥æ”¶è¯·æ±‚ï¼Œåˆç§° TCP å¥—æ¥å­—ã€SSL å¥—æ¥å­—æˆ– unix åŸŸå¥—æ¥å­—ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Cluster&lt;/strong&gt;ï¼Œä»£è¡¨æˆ‘ä»¬å‘é€è¯·æ±‚çš„å†…éƒ¨æœåŠ¡ï¼Œå¦‚æ¶ˆæ¯æœåŠ¡å™¨å’Œå­˜åœ¨æœåŠ¡å™¨&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Route&lt;/strong&gt;ï¼Œå°† Listener å’Œ Cluster è¿æ¥åœ¨ä¸€èµ·&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Filter&lt;/strong&gt;ï¼Œå®ƒå¯¹è¯·æ±‚è¿›è¡Œæ“ä½œ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Slack çš„é…ç½®ç®¡ç†ä¸»è¦æ˜¯é€šè¿‡ &lt;a href=&#34;https://www.chef.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Chef&lt;/a&gt; å®Œæˆçš„ã€‚å½“æˆ‘ä»¬å¼€å§‹ä½¿ç”¨ Envoy æ—¶ï¼Œæˆ‘ä»¬æŠŠ Envoy é…ç½®ä½œä¸º &lt;a href=&#34;https://docs.chef.io/resources/template/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;chef æ¨¡æ¿æ–‡ä»¶&lt;/a&gt;æ¥éƒ¨ç½²ï¼Œä½†å®ƒçš„ç®¡ç†å˜å¾—å¾ˆéº»çƒ¦ï¼Œè€Œä¸”å®¹æ˜“å‡ºé”™ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å»ºç«‹äº† chef åº“å’Œ&lt;a href=&#34;https://docs.chef.io/custom_resources_notes/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è‡ªå®šä¹‰èµ„æº&lt;/a&gt;æ¥ç”Ÿæˆ Envoy é…ç½®ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-chef-èµ„æºçš„ç»“æ„å’Œæµç¨‹å›¾&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Chef èµ„æºçš„ç»“æ„å’Œæµç¨‹å›¾&#34; srcset=&#34;
               /blog/migrating-millions-of-concurrent-websockets-to-envoy/e6c9d24ely1h1277ob5drj20hs07wq2z_hu1a8a6e23511e109899703f5399d437e1_11452_ed8077e3cbc9a68c6ebcb54e4a282838.webp 400w,
               /blog/migrating-millions-of-concurrent-websockets-to-envoy/e6c9d24ely1h1277ob5drj20hs07wq2z_hu1a8a6e23511e109899703f5399d437e1_11452_3d8eaad58a869ab183ad8adf659b179f.webp 760w,
               /blog/migrating-millions-of-concurrent-websockets-to-envoy/e6c9d24ely1h1277ob5drj20hs07wq2z_hu1a8a6e23511e109899703f5399d437e1_11452_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/migrating-millions-of-concurrent-websockets-to-envoy/e6c9d24ely1h1277ob5drj20hs07wq2z_hu1a8a6e23511e109899703f5399d437e1_11452_ed8077e3cbc9a68c6ebcb54e4a282838.webp&#34;
               width=&#34;640&#34;
               height=&#34;284&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      Chef èµ„æºçš„ç»“æ„å’Œæµç¨‹å›¾
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;åœ¨ Chef å†…éƒ¨ï¼Œé…ç½®æ˜¯ä¸€ä¸ª&lt;a href=&#34;https://en.wikipedia.org/wiki/Singleton_pattern&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å•ä¾‹&lt;/a&gt;ï¼Œæ¨¡æ‹Ÿäº†æ¯ä¸ªä¸»æœºåªæœ‰ä¸€ä¸ª Envoy é…ç½®çš„æƒ…å†µã€‚æ‰€æœ‰çš„ Chef èµ„æºéƒ½åœ¨è¿™ä¸ªå•ä¾‹ä¸Šæ“ä½œï¼Œæ·»åŠ ç›‘å¬å™¨ã€è·¯ç”±æˆ–é›†ç¾¤ã€‚åœ¨ Chef è¿è¡Œçš„æœ€åï¼Œ&lt;code&gt;envoy.yaml&lt;/code&gt; è¢«ç”Ÿæˆã€éªŒè¯ï¼Œç„¶åå®‰è£… â€”â€” æˆ‘ä»¬ä»ä¸å†™ä¸­é—´é…ç½®ï¼Œå› ä¸ºè¿™äº›é…ç½®å¯èƒ½æ˜¯æ— æ•ˆçš„ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªä¾‹å­å±•ç¤ºäº†æˆ‘ä»¬å¦‚ä½•åˆ›å»ºä¸€ä¸ªæœ‰ä¸¤æ¡è·¯ç”±çš„ HTTP ç›‘å¬å™¨ï¼Œå°†æµé‡è·¯ç”±åˆ°ä¸¤ä¸ª&lt;a href=&#34;https://www.envoyproxy.io/docs/envoy/latest/intro/arch_overview/upstream/service_discovery#endpoint-discovery-service-eds&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;åŠ¨æ€&lt;/a&gt;é›†ç¾¤ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-è°ƒç”¨chefèµ„æºä»¥åˆ›å»ºå¸¦æœ‰é›†ç¾¤å’Œè·¯ç”±çš„ç›‘å¬å™¨çš„ä¾‹å­&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;è°ƒç”¨Chefèµ„æºä»¥åˆ›å»ºå¸¦æœ‰é›†ç¾¤å’Œè·¯ç”±çš„ç›‘å¬å™¨çš„ä¾‹å­&#34; srcset=&#34;
               /blog/migrating-millions-of-concurrent-websockets-to-envoy/e6c9d24ely1h1277otk25j20hs0ao74o_hud2ebd77a55ed41b5f8de579721b3ba03_23114_32e50a982040c604228080e85164bf26.webp 400w,
               /blog/migrating-millions-of-concurrent-websockets-to-envoy/e6c9d24ely1h1277otk25j20hs0ao74o_hud2ebd77a55ed41b5f8de579721b3ba03_23114_2cdc116dd2cbbc9049f235c69f90387b.webp 760w,
               /blog/migrating-millions-of-concurrent-websockets-to-envoy/e6c9d24ely1h1277otk25j20hs0ao74o_hud2ebd77a55ed41b5f8de579721b3ba03_23114_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/migrating-millions-of-concurrent-websockets-to-envoy/e6c9d24ely1h1277otk25j20hs0ao74o_hud2ebd77a55ed41b5f8de579721b3ba03_23114_32e50a982040c604228080e85164bf26.webp&#34;
               width=&#34;640&#34;
               height=&#34;384&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      è°ƒç”¨Chefèµ„æºä»¥åˆ›å»ºå¸¦æœ‰é›†ç¾¤å’Œè·¯ç”±çš„ç›‘å¬å™¨çš„ä¾‹å­
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;è¦åœ¨ Envoy ä¸­å¤åˆ¶æˆ‘ä»¬å¤æ‚çš„ HAProxy é…ç½®éœ€è¦ä¸€äº›åŠªåŠ›ã€‚å¤§éƒ¨åˆ†éœ€è¦çš„åŠŸèƒ½åœ¨ Envoy ä¸­å·²ç»æœ‰äº†ï¼Œæ‰€ä»¥åªéœ€è¦åœ¨ chef åº“ä¸­åŠ å…¥å¯¹å®ƒçš„æ”¯æŒå°±å¯ä»¥äº†ã€‚æˆ‘ä»¬å®ç°äº†ä¸€äº›ç¼ºå¤±çš„ Envoy åŠŸèƒ½ï¼ˆæœ‰äº›æ˜¯&lt;a href=&#34;https://github.com/envoyproxy/envoy/pull/12206&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä¸Šæ¸¸&lt;/a&gt;è´¡çŒ®çš„ï¼Œæœ‰äº›æ˜¯å†…éƒ¨ç»´æŠ¤çš„æ‰©å±•ï¼‰ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å¯¹æˆ‘ä»¬çš„æ–°é…ç½®è¿›è¡Œæµ‹è¯•å’ŒéªŒè¯&#34;&gt;å¯¹æˆ‘ä»¬çš„æ–°é…ç½®è¿›è¡Œæµ‹è¯•å’ŒéªŒè¯&lt;/h2&gt;
&lt;p&gt;æµ‹è¯•æ–°çš„ Envoy websockets å±‚æ˜¯ä¸€ä¸ªè¿­ä»£çš„è¿‡ç¨‹ã€‚æˆ‘ä»¬ç»å¸¸ç”¨æ‰‹å·¥ç¼–ç çš„ Envoy é…ç½®åšåŸå‹ï¼Œå¹¶åœ¨æœ¬åœ°çš„å¼€å‘æœºå™¨ä¸Šæµ‹è¯•ï¼Œæ¯ä¸ªç›‘å¬å™¨ã€è·¯ç”±å’Œé›†ç¾¤éƒ½æœ‰ä¸€ä¸ªã€‚æ‰‹å·¥ç¼–ç çš„ä¿®æ”¹ä¸€æ—¦æˆåŠŸï¼Œå°±ä¼šè¢«ç§»åˆ° chef åº“ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;HTTP è·¯ç”±æ˜¯ç”¨ &lt;a href=&#34;https://curl.se/docs/manpage.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;curl&lt;/a&gt; æµ‹è¯•çš„ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åŸºäºå¤´å’Œ cookie çš„ç‰¹å®šè·¯ç”±åˆ°ç‰¹å®šåç«¯&lt;/li&gt;
&lt;li&gt;åŸºäºè·¯å¾„ã€å‰ç¼€å’ŒæŸ¥è¯¢å‚æ•°çš„è·¯ç”±åˆ°ç‰¹å®šåç«¯&lt;/li&gt;
&lt;li&gt;SSL è¯ä¹¦&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å½“äº‹æƒ…æ²¡æœ‰è¾¾åˆ°é¢„æœŸæ•ˆæœæ—¶ï¼Œæˆ‘ä»¬åœ¨æœºå™¨ä¸Šä½¿ç”¨ Envoy è°ƒè¯•æ—¥å¿—ã€‚è°ƒè¯•æ—¥å¿—æ¸…æ¥šåœ°è§£é‡Šäº†ä¸ºä»€ä¹ˆ Envoy é€‰æ‹©å°†ä¸€ä¸ªç‰¹å®šçš„è¯·æ±‚è·¯ç”±åˆ°ä¸€ä¸ªç‰¹å®šçš„é›†ç¾¤ã€‚Envoy çš„è°ƒè¯•æ—¥å¿—éå¸¸æœ‰ç”¨ï¼Œä½†ä¹Ÿå¾ˆå†—é•¿ï¼Œè€Œä¸”å¾ˆæ˜‚è´µï¼ˆä½ çœŸçš„ä¸æƒ³åœ¨ç”Ÿäº§ç¯å¢ƒä¸­å¯ç”¨è¿™ä¸ªåŠŸèƒ½ï¼‰ã€‚è°ƒè¯•æ—¥å¿—å¯ä»¥é€šè¿‡ Curl å¯ç”¨ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;curl -X POST http://localhost:&amp;lt;envoy_admin_port&amp;gt;/logging?level&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;debug
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Envoy ç®¡ç†æ¥å£åœ¨åˆå§‹è°ƒè¯•æ—¶ä¹Ÿå¾ˆæœ‰ç”¨ï¼Œç‰¹åˆ«æ˜¯è¿™äº›ç«¯ç‚¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;clusters&lt;/strong&gt;ï¼šæ˜¾ç¤ºæ‰€æœ‰é…ç½®çš„é›†ç¾¤ï¼ŒåŒ…æ‹¬æ¯ä¸ªé›†ç¾¤ä¸­æ‰€æœ‰ä¸Šæ¸¸ä¸»æœºçš„ä¿¡æ¯ä»¥åŠæ¯ä¸ªä¸»æœºçš„ç»Ÿè®¡æ•°æ®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;/certs&lt;/strong&gt;ï¼šä»¥ JSON æ ¼å¼æ˜¾ç¤ºæ‰€æœ‰åŠ è½½çš„ TLS è¯ä¹¦ï¼ŒåŒ…æ‹¬æ–‡ä»¶åã€åºåˆ—å·ã€ä¸»ä½“æ›¿ä»£åç§°å’Œåˆ°æœŸå‰çš„å¤©æ•°ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;/listeners&lt;/strong&gt;ï¼šæ˜¾ç¤ºæ‰€æœ‰é…ç½®çš„ç›‘å¬å™¨åŠå…¶åç§°å’Œåœ°å€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æˆ‘ä»¬çš„ Chef åº“ä½¿ç”¨ &lt;code&gt;-mode validate&lt;/code&gt; å‘½ä»¤è¡Œé€‰é¡¹è¿è¡Œ Envoyï¼Œä½œä¸ºä¸€ä¸ªéªŒè¯æ­¥éª¤ï¼Œä»¥é˜²æ­¢å®‰è£…æ— æ•ˆçš„é…ç½®ã€‚è¿™ä¹Ÿå¯ä»¥æ‰‹åŠ¨å®Œæˆã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;sudo /path/to/envoy/binary -c &amp;lt;/path/to/envoy.yaml&amp;gt; --mode validate
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Envoy æä¾› JSON æ ¼å¼çš„ç›‘å¬å™¨æ—¥å¿—ã€‚æˆ‘ä»¬å°†è¿™äº›æ—¥å¿—å½•å…¥æˆ‘ä»¬çš„æ—¥å¿—ç®¡é“ï¼ˆå½“ç„¶æ˜¯åœ¨å¯¹æ—¥å¿—è¿›è¡Œ &lt;a href=&#34;https://en.wikipedia.org/wiki/Personal_data&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;PII&lt;/a&gt; å¤„ç†åï¼‰ï¼Œè¿™å¯¹è°ƒè¯•å·¥ä½œç»å¸¸å¾ˆæœ‰å¸®åŠ©ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€æ—¦å¯¹å¼€å‘ç¯å¢ƒä¸­çš„é…ç½®æœ‰ä¿¡å¿ƒï¼Œæˆ‘ä»¬å°±å‡†å¤‡åšä¸€äº›æ›´å¤šçš„æµ‹è¯• &amp;ndash; åœ¨ç”Ÿäº§ä¸­ï¼&amp;quot;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;è¿ç§»è‡³ç”Ÿäº§&#34;&gt;è¿ç§»è‡³ç”Ÿäº§&lt;/h2&gt;
&lt;p&gt;ä¸ºäº†å°†è¿ç§»è¿‡ç¨‹ä¸­çš„é£é™©é™åˆ°æœ€ä½ï¼Œæˆ‘ä»¬å»ºç«‹äº†ä¸€ä¸ªæ–°çš„ Envoy websocket æ ˆï¼Œå…¶é…ç½®ä¸ç°æœ‰çš„ HAProxy å±‚ç›¸å½“ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥é€æ­¥ã€æœ‰æ§åˆ¶åœ°å°†æµé‡è½¬ç§»åˆ°æ–°çš„ Envoy å †æ ˆï¼Œå¹¶ä¸”åœ¨å¿…è¦æ—¶å¯ä»¥å¿«é€Ÿåˆ‡æ¢å› HAProxyã€‚ç¼ºç‚¹æ˜¯æˆ‘ä»¬çš„ AWS æˆæœ¬ â€”â€” æˆ‘ä»¬åœ¨è¿ç§»è¿‡ç¨‹ä¸­ä½¿ç”¨äº†åŒå€çš„èµ„æºï¼Œä½†æˆ‘ä»¬æ„¿æ„èŠ±è´¹æ—¶é—´å’Œèµ„æºä¸ºæˆ‘ä»¬çš„å®¢æˆ·é€æ˜åœ°è¿›è¡Œè¿ç§»ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬é€šè¿‡ &lt;a href=&#34;https://ns1.com/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;NS1&lt;/a&gt; ç®¡ç†æˆ‘ä»¬çš„ DNS è®°å½• &lt;strong&gt;wss-primary.slack.com&lt;/strong&gt; å’Œ &lt;strong&gt;wss-backup.slack.com&lt;/strong&gt;ã€‚æˆ‘ä»¬ä½¿ç”¨åŠ æƒè·¯ç”±å°†æµé‡ä» &lt;strong&gt;haproxy-wss&lt;/strong&gt; è½¬ç§»åˆ° &lt;strong&gt;envoy-wss&lt;/strong&gt; &lt;a href=&#34;https://docs.aws.amazon.com/elasticloadbalancing/latest/network/introduction.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;NLB&lt;/a&gt; DNS åç§°ã€‚ç¬¬ä¸€æ‰¹åŒºåŸŸæ˜¯ä»¥ 10%ã€25%ã€50%ã€75% å’Œ 100% çš„æ­¥éª¤å•ç‹¬ä¸Šçº¿çš„ã€‚ç”±äºæˆ‘ä»¬å¯¹æ–°çš„ Envoy å±‚å’Œä¸Šçº¿è¿‡ç¨‹æœ‰ä¿¡å¿ƒï¼Œæ‰€ä»¥æœ€åçš„åŒºåŸŸä¸Šçº¿é€Ÿåº¦æ›´å¿«ï¼ˆ25%ã€50%ã€75%ã€100% åªéœ€ä¸¤å¤©ï¼Œè€Œä¹‹å‰çš„ä¸€ä¸ªåŒºåŸŸéœ€è¦ä¸€å‘¨çš„æ—¶é—´ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å°½ç®¡è¿ç§»å·¥ä½œå¾ˆé¡ºåˆ©ï¼Œæ²¡æœ‰å‡ºç°æ•…éšœï¼Œä½†è¿˜æ˜¯å‡ºç°äº†ä¸€äº›å°é—®é¢˜ï¼Œæ¯”å¦‚è¶…æ—¶å€¼å’Œ header çš„å·®å¼‚ã€‚åœ¨è¿ç§»è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¤šæ¬¡æ¢å¤ã€ä¿®å¤ï¼Œå¹¶å†æ¬¡ä¸Šçº¿ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-æµç¨‹å›¾æ˜¾ç¤ºdnsè¿ç§»è¿‡ç¨‹ä¸­æ¶‰åŠçš„ç»„ä»¶å’Œæ­¥éª¤&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;æµç¨‹å›¾æ˜¾ç¤ºDNSè¿ç§»è¿‡ç¨‹ä¸­æ¶‰åŠçš„ç»„ä»¶å’Œæ­¥éª¤&#34; srcset=&#34;
               /blog/migrating-millions-of-concurrent-websockets-to-envoy/e6c9d24ely1h1277p8k19j20hs07c3yp_hu8dbdeb8b10fd6b75b776536dab81c36d_16804_f56f3b4b7df6d9bab4f21c0b62d40875.webp 400w,
               /blog/migrating-millions-of-concurrent-websockets-to-envoy/e6c9d24ely1h1277p8k19j20hs07c3yp_hu8dbdeb8b10fd6b75b776536dab81c36d_16804_15a07482708b9585e83ff83d618596d9.webp 760w,
               /blog/migrating-millions-of-concurrent-websockets-to-envoy/e6c9d24ely1h1277p8k19j20hs07c3yp_hu8dbdeb8b10fd6b75b776536dab81c36d_16804_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/migrating-millions-of-concurrent-websockets-to-envoy/e6c9d24ely1h1277p8k19j20hs07c3yp_hu8dbdeb8b10fd6b75b776536dab81c36d_16804_f56f3b4b7df6d9bab4f21c0b62d40875.webp&#34;
               width=&#34;640&#34;
               height=&#34;264&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      æµç¨‹å›¾æ˜¾ç¤ºDNSè¿ç§»è¿‡ç¨‹ä¸­æ¶‰åŠçš„ç»„ä»¶å’Œæ­¥éª¤
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;ç»è¿‡æ¼«é•¿è€Œæ¿€åŠ¨äººå¿ƒçš„ 6 ä¸ªæœˆï¼Œè¿ç§»å®Œæˆäº†ï¼Œæ•´ä¸ª HAProxy websocket å †æ ˆåœ¨å…¨çƒèŒƒå›´å†…è¢« Envoy Proxy å–ä»£ï¼Œå¯¹å®¢æˆ·çš„&lt;strong&gt;å½±å“ä¸ºé›¶&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å“ªäº›è¿›å±•é¡ºåˆ©å“ªäº›ä¸é¡ºåˆ©&#34;&gt;å“ªäº›è¿›å±•é¡ºåˆ©ï¼Œå“ªäº›ä¸é¡ºåˆ©&lt;/h2&gt;
&lt;p&gt;è¿ç§»æœ¬èº«æ˜¯ç›¸å¯¹å¹³æ·¡å’Œæ— èŠçš„ã€‚&lt;strong&gt;æ¯ç‡¥æ˜¯ä¸€ä»¶å¥½äº‹&lt;/strong&gt;ï¼šåˆºæ¿€æ„å‘³ç€äº‹æƒ…çš„ä¸­æ–­ï¼Œæ¯ç‡¥æ„å‘³ç€ä¸€åˆ‡é¡ºåˆ©ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å‘ç°ï¼Œæ—§çš„ HAProxy é…ç½®éšç€æ—¶é—´çš„æ¨ç§»è€Œæœ‰æœºåœ°å¢é•¿ã€‚å®ƒåœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šæ˜¯ç”± HAProxy ä½¿ç”¨çš„æ¨¡å‹å½¢æˆçš„ â€”â€” ä¸€ä¸ªåŒ…æ‹¬æ‰€æœ‰ç›‘å¬å™¨çš„å¤§å‹é…ç½®ã€‚Envoy çš„é…ç½®æ¨¡å‹æ¯” HAProxy çš„æ¨¡å‹ä½¿ç”¨æ›´å¤šçš„å®šä¹‰èŒƒå›´ã€‚ä¸€æ—¦ä¸€ä¸ªç›‘å¬å™¨è¢«è¾“å…¥ï¼Œåªæœ‰è¯¥ç›‘å¬å™¨å†…çš„è§„åˆ™é€‚ç”¨äºè¯·æ±‚ã€‚ä¸€æ—¦è¾“å…¥ä¸€ä¸ªè·¯ç”±ï¼Œåªæœ‰è¯¥è·¯ç”±ä¸Šçš„è§„åˆ™é€‚ç”¨ã€‚è¿™ä½¿å¾—å°†è§„åˆ™ä¸ç›¸å…³çš„è¯·æ±‚è”ç³»èµ·æ¥æ›´åŠ å®¹æ˜“ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬èŠ±äº†å¾ˆé•¿æ—¶é—´ä»æ—§çš„ HAProxy é…ç½®ä¸­æå–é‡è¦çš„ä¸œè¥¿ï¼Œè¿™å®é™…ä¸Šæ˜¯æŠ€æœ¯å€ºåŠ¡ã€‚é€šå¸¸å¾ˆéš¾å¼„æ¸…æ¥šä¸ºä»€ä¹ˆä¼šæœ‰æŸä¸ªè§„åˆ™ï¼Œå“ªäº›æ˜¯æœ‰æ„çš„ï¼Œå“ªäº›æ˜¯æ— æ„çš„ï¼Œä»¥åŠå…¶ä»–æœåŠ¡æ‰€ä¾èµ–çš„è¡Œä¸ºæ˜¯ä»€ä¹ˆã€‚ä¾‹å¦‚ï¼Œæœ‰äº›æœåŠ¡åº”è¯¥åªåœ¨ä¸¤ä¸ªè™šæ‹Ÿä¸»æœºï¼ˆvhostsï¼‰ä¸­çš„ä¸€ä¸ªä¸‹ï¼Œä½†å®é™…ä¸Šåœ¨ HAProxy çš„ä¸¤ä¸ª vhosts ä¸‹éƒ½å¯ç”¨ã€‚æˆ‘ä»¬ä¸å¾—ä¸å¤åˆ¶è¿™ä¸ªé”™è¯¯ï¼Œå› ä¸ºç°æœ‰çš„ä»£ç ä¾èµ–äºè¿™ç§è¡Œä¸ºã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬åœ¨ HAProxy å †æ ˆä¸­é”™è¿‡äº†ä¸€äº›ç»†å¾®çš„ä¸œè¥¿ã€‚æœ‰æ—¶è¿™äº›æ˜¯å¾ˆé‡è¦çš„ â€”â€” æˆ‘ä»¬ç ´åäº† Slack çš„æ¯æ—¥æ´»è·ƒç”¨æˆ·ï¼ˆDAUï¼‰æŒ‡æ ‡ï¼ˆå“å‘€ï¼ï¼‰ã€‚ä¹Ÿæœ‰å¾ˆå¤šå°é—®é¢˜éœ€è¦è§£å†³ã€‚è´Ÿè½½å‡è¡¡å™¨çš„è¡Œä¸ºå¾ˆå¤æ‚ï¼Œé™¤äº†èŠ±æ—¶é—´è°ƒè¯•å¤–ï¼Œæ²¡æœ‰çœŸæ­£çš„åŠæ³•è§£å†³è¿™ä¸ªé—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¼€å§‹è¿ç§»æ—¶ï¼Œæ²¡æœ‰ä¸ºè´Ÿè½½å‡è¡¡å™¨çš„é…ç½®æä¾›æµ‹è¯•æ¡†æ¶ã€‚æˆ‘ä»¬æ²¡æœ‰è‡ªåŠ¨æµ‹è¯•æ¥éªŒè¯æµ‹è¯•çš„ URL è·¯ç”±åˆ°æ­£ç¡®çš„ç«¯ç‚¹ä»¥åŠä¸è¯·æ±‚å’Œå“åº”å¤´ç›¸å…³çš„è¡Œä¸ºï¼Œè€Œæ˜¯æœ‰&amp;hellip;&amp;hellip; ä¸€ä¸ª HAProxy é…ç½®ã€‚åœ¨è¿ç§»è¿‡ç¨‹ä¸­ï¼Œæµ‹è¯•æ˜¯å¾ˆæœ‰å¸®åŠ©çš„ï¼Œå› ä¸ºå®ƒä»¬å¯ä»¥æä¾›å¾ˆå¤šå…³äºé¢„æœŸè¡Œä¸ºçš„åŸå› çš„èƒŒæ™¯ã€‚å› ä¸ºæˆ‘ä»¬ç¼ºä¹æµ‹è¯•ï¼Œæ‰€ä»¥æˆ‘ä»¬ç»å¸¸ä¸å¾—ä¸å‘æœåŠ¡æ‰€æœ‰è€…è¯¢é—®ï¼Œä»¥äº†è§£ä»–ä»¬æ‰€ä¾èµ–çš„è¡Œä¸ºã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å»ºç«‹çš„ Chef èµ„æºæœ‰æ„åªæ”¯æŒ Envoy åŠŸèƒ½çš„ä¸€ä¸ªå­é›†ã€‚è¿™ä½¿æˆ‘ä»¬çš„åº“æ›´ç®€å• â€”â€” æˆ‘ä»¬åªéœ€è¦è€ƒè™‘æˆ‘ä»¬å®é™…ä½¿ç”¨çš„åŠŸèƒ½ã€‚ç¼ºç‚¹æ˜¯ï¼Œæ¯æ¬¡æˆ‘ä»¬æƒ³ä½¿ç”¨æ–°çš„ Envoy åŠŸèƒ½æ—¶ï¼Œéƒ½å¿…é¡»åœ¨æˆ‘ä»¬çš„ Chef åº“ä¸­æ·»åŠ å¯¹è¿™äº›åŠŸèƒ½çš„æ”¯æŒã€‚ä¾‹å¦‚ï¼Œ&lt;a href=&#34;https://en.wikipedia.org/wiki/Server_Name_Indication&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SNI&lt;/a&gt;ï¼ˆhttpsï¼‰ç›‘å¬å™¨æ˜¯åœ¨å¼€å‘è¿‡ç¨‹ä¸­ç¼–å†™çš„ï¼Œå½“æ—¶æˆ‘ä»¬è®¤ä¸ºè¿™æ¯”å‘ç°æœ‰çš„ç›‘å¬å™¨æ·»åŠ æ”¯æŒæ›´ç®€å•ã€‚ç„¶è€Œï¼Œå½“æ¶‰åŠåˆ° vhost æ”¯æŒæ—¶ï¼Œæˆ‘ä»¬å·²ç»å¼€å‘äº†å¾ˆå¤šä»£ç å¹¶åœ¨ä½¿ç”¨ä¸­ï¼Œé‡æ„æ•´ä¸ªå…¬å¸å…¶ä»–åœ°æ–¹æ­£åœ¨ä½¿ç”¨çš„èµ„æºå°†èŠ±è´¹å¾ˆé•¿æ—¶é—´ã€‚æˆ‘ä»¬çš„ Chef åº“ä¸­çš„ vhost æ”¯æŒæ˜¯ä¸€ä¸ª hackï¼ˆå¾ˆå¿«æœ‰ä¸€å¤©æˆ‘ä»¬ä¼šä¿®å¤å®ƒï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†ä½¿æ”¹å˜ Envoy èµ„æº Chef åº“æ›´åŠ å®‰å…¨ï¼Œæ¢å¥è¯è¯´ï¼Œç¡®ä¿æˆ‘ä»¬ä¸ä¼šç ´åå…¶ä»–ä½¿ç”¨æˆ‘ä»¬åº“çš„å›¢é˜Ÿï¼Œæˆ‘ä»¬å¼•å…¥äº†ä¸€å¥—å…¨é¢çš„æµ‹è¯•ï¼Œç”Ÿæˆè¿™äº›å›¢é˜Ÿçš„æ•´ä¸ªé…ç½®ã€‚è¿™ä½¿å¾—æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°çŸ¥é“ï¼Œå½“æˆ‘ä»¬æ›´æ–° Envoy Chef èµ„æºæ—¶ï¼Œæˆ‘ä»¬ç”Ÿæˆçš„æ‰€æœ‰ Envoy é…ç½®ä¼šï¼ˆæˆ–ä¸ä¼šï¼‰å—åˆ°ä»€ä¹ˆå½±å“ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ¬¡è¿ç§»ï¼ˆå’Œå…¶ä»–è¿ç§»ä¸€æ ·ï¼‰çš„å…³é”®äº‹é¡¹ä¹‹ä¸€æ˜¯æ²Ÿé€šã€‚æˆ‘ä»¬åŠªåŠ›è®©æ¯ä¸ªäººéƒ½äº†è§£å¹¶é…åˆæˆ‘ä»¬æ­£åœ¨è¿›è¡Œçš„æ”¹å˜ã€‚æˆ‘ä»¬çš„å®¢æˆ·ä½“éªŒï¼ˆCEï¼‰å›¢é˜Ÿæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„åˆä½œä¼™ä¼´ â€”â€” ä»–ä»¬èƒ½å¤Ÿç›‘æ§ä¼ å…¥çš„å·¥å•ï¼Œä»¥å‘ç°ä»»ä½•å¯èƒ½è¡¨æ˜ç”¨æˆ·å› è¿™æ¬¡è¿ç§»è€Œå—åˆ°å½±å“çš„æƒ…å†µã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä¸‹ä¸€æ­¥æ˜¯ä»€ä¹ˆ&#34;&gt;ä¸‹ä¸€æ­¥æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/h2&gt;
&lt;p&gt;å°½ç®¡å¶å°”ä¼šé‡åˆ°ä¸€äº›å°æŒ«æŠ˜ï¼Œä½† envoy websocket çš„è¿ç§»è¿˜æ˜¯éå¸¸æˆåŠŸçš„ã€‚æˆ‘ä»¬å·²ç»è·Ÿè¿›ï¼Œå°†å¦ä¸€ä¸ªå…³é”®çš„ Slack æœåŠ¡ï¼Œå³æˆ‘ä»¬çš„è½¯ä»¶å®¢æˆ·ç«¯æŒ‡æ ‡æ‘„å–ç®¡é“ â€”â€” ä¸æˆ‘ä»¬çš„å…¶ä»–å…¥å£è´Ÿè½½å‡è¡¡å™¨éš”ç¦» â€”â€” è¿ç§»åˆ° Envoy Proxyã€‚æˆ‘ä»¬å‡ ä¹å·²ç»å®Œæˆäº†å°†æˆ‘ä»¬çš„ç½‘ç»œå’Œ API æµé‡çš„å†…éƒ¨è´Ÿè½½å‡è¡¡å™¨è¿ç§»åˆ° Envoyã€‚è¿™åœºå²è¯—èˆ¬çš„è¿ç§»çš„æœ€åä¸€éƒ¨åˆ†æ˜¯å°†æˆ‘ä»¬çš„ï¼ˆå¸¸è§„çš„ã€é websocket çš„ï¼‰HTTP å †æ ˆä» HAProxy è¿ç§»åˆ° Envoyï¼Œè¿™ä¹Ÿæ˜¯æ­£åœ¨è¿›è¡Œçš„ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬çš„æœ€ç»ˆç›®æ ‡æ˜¯åœ¨å…¥å£è´Ÿè½½å‡è¡¡å™¨å’ŒæœåŠ¡ç½‘æ ¼æ•°æ®å¹³é¢ä¸Šå®ç° Envoy Proxy çš„æ ‡å‡†åŒ–ï¼Œè¿™å°†å¤§å¤§é™ä½å›¢é˜Ÿçš„è®¤çŸ¥è´Ÿè·å’Œæ“ä½œå¤æ‚æ€§ï¼Œå¹¶ä½¿ Envoy çš„å…ˆè¿›åŠŸèƒ½åœ¨æˆ‘ä»¬çš„è´Ÿè½½å‡è¡¡åŸºç¡€è®¾æ–½ä¸­å¾—åˆ°åº”ç”¨ã€‚è‡ªä»è¿ç§»åˆ° Envoy åï¼Œæˆ‘ä»¬å·²ç»å¤§å¤§è¶…è¿‡äº†ä»¥å‰çš„å³°å€¼è´Ÿè½½ï¼Œæ²¡æœ‰ä»»ä½•é—®é¢˜ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>å‘Šåˆ« Sidecarâ€”â€”ä½¿ç”¨ eBPF è§£é”å†…æ ¸çº§æœåŠ¡ç½‘æ ¼</title>
      <link>https://lib.jimmysong.io/blog/ebpf-solve-service-mesh-sidecar/</link>
      <pubDate>Thu, 09 Dec 2021 21:03:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/ebpf-solve-service-mesh-sidecar/</guid>
      <description>&lt;h2 id=&#34;ç¼–è€…çš„è¯&#34;&gt;ç¼–è€…çš„è¯&lt;/h2&gt;
&lt;p&gt;æœ¬æ–‡ä½œè€…æ˜¯ Isovalent è”åˆåˆ›å§‹äºº&amp;amp;CTOï¼ŒåŸæ–‡æ ‡é¢˜ &lt;a href=&#34;https://isovalent.com/blog/post/2021-12-08-ebpf-servicemesh&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;How eBPF will solve Service Mesh - Goodbye Sidecars&lt;/a&gt;ï¼Œä½œè€…å›é¡¾äº†Linux å†…æ ¸çš„è¿æ¥æ€§ï¼Œå®ç°æœåŠ¡ç½‘æ ¼çš„å‡ ç§æ¨¡å¼ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨ eBPF å®ç°æ—  Sidecar çš„æœåŠ¡ç½‘æ ¼ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä»€ä¹ˆæ˜¯æœåŠ¡ç½‘æ ¼&#34;&gt;ä»€ä¹ˆæ˜¯æœåŠ¡ç½‘æ ¼ï¼Ÿ&lt;/h2&gt;
&lt;p&gt;éšç€åˆ†å¸ƒå¼åº”ç”¨çš„å¼•å…¥ï¼Œé¢å¤–çš„å¯è§†æ€§ã€è¿æ¥æ€§å’Œå®‰å…¨æ€§è¦æ±‚ä¹Ÿæµ®å‡ºæ°´é¢ã€‚åº”ç”¨ç¨‹åºç»„ä»¶é€šè¿‡ä¸å—ä¿¡ä»»çš„ç½‘ç»œè·¨è¶Šäº‘å’Œé›†ç¾¤è¾¹ç•Œè¿›è¡Œé€šä¿¡ï¼Œè´Ÿè½½å‡è¡¡ã€å¼¹æ€§å˜å¾—è‡³å…³é‡è¦ï¼Œå®‰å…¨å¿…é¡»å‘å±•åˆ°å‘é€è€…å’Œæ¥æ”¶è€…éƒ½å¯ä»¥éªŒè¯å½¼æ­¤çš„èº«ä»½çš„æ¨¡å¼ã€‚åœ¨åˆ†å¸ƒå¼åº”ç”¨çš„æ—©æœŸï¼Œè¿™äº›è¦æ±‚æ˜¯é€šè¿‡ç›´æ¥å°†æ‰€éœ€çš„é€»è¾‘åµŒå…¥åˆ°åº”ç”¨ä¸­æ¥è§£å†³çš„ã€‚æœåŠ¡ç½‘æ ¼å°†è¿™äº›åŠŸèƒ½ä»åº”ç”¨ç¨‹åºä¸­æå–å‡ºæ¥ï¼Œä½œä¸ºåŸºç¡€è®¾æ–½çš„ä¸€éƒ¨åˆ†æä¾›ç»™æ‰€æœ‰åº”ç”¨ç¨‹åºä½¿ç”¨ï¼Œå› æ­¤ä¸å†éœ€è¦ä¿®æ”¹æ¯ä¸ªåº”ç”¨ç¨‹åºã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-æœåŠ¡ç½‘æ ¼ç¤ºæ„å›¾&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;æœåŠ¡ç½‘æ ¼ç¤ºæ„å›¾&#34; srcset=&#34;
               /blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7wyna8jsj32e20sojtx_hu6485f23e60e2e8e9568294bae27898e8_102977_2f4c949f5635907beff63e8337d6f76c.webp 400w,
               /blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7wyna8jsj32e20sojtx_hu6485f23e60e2e8e9568294bae27898e8_102977_17137669c2ea72adc4c86b6f1c92847f.webp 760w,
               /blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7wyna8jsj32e20sojtx_hu6485f23e60e2e8e9568294bae27898e8_102977_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7wyna8jsj32e20sojtx_hu6485f23e60e2e8e9568294bae27898e8_102977_2f4c949f5635907beff63e8337d6f76c.webp&#34;
               width=&#34;760&#34;
               height=&#34;253&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      æœåŠ¡ç½‘æ ¼ç¤ºæ„å›¾
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;çºµè§‚ä»Šå¤©æœåŠ¡ç½‘æ ¼çš„åŠŸèƒ½è®¾ç½®ï¼Œå¯ä»¥æ€»ç»“ä¸ºä»¥ä¸‹å‡ ç‚¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¼¹æ€§è¿æ¥&lt;/strong&gt;ï¼šæœåŠ¡ä¸æœåŠ¡ä¹‹é—´çš„é€šä¿¡å¿…é¡»èƒ½å¤Ÿè·¨è¶Šè¾¹ç•Œï¼Œå¦‚äº‘ã€é›†ç¾¤å’Œåœºæ‰€ã€‚é€šä¿¡å¿…é¡»æ˜¯æœ‰å¼¹æ€§çš„å’Œå®¹é”™çš„ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;L7 æµé‡ç®¡ç†&lt;/strong&gt;ï¼šè´Ÿè½½å‡è¡¡ã€é€Ÿç‡é™åˆ¶å’Œå¼¹æ€§å¿…é¡»æ˜¯ L7 æ„ŸçŸ¥çš„ï¼ˆHTTPã€RESTã€gRPCã€WebSocket ç­‰ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;åŸºäºèº«ä»½çš„å®‰å…¨&lt;/strong&gt;ï¼šä¾é ç½‘ç»œæ ‡è¯†ç¬¦æ¥å®ç°å®‰å…¨å·²ç»ä¸å¤Ÿäº†ï¼Œå‘é€å’Œæ¥æ”¶æœåŠ¡éƒ½å¿…é¡»èƒ½å¤Ÿæ ¹æ®èº«ä»½è€Œä¸æ˜¯ç½‘ç»œæ ‡è¯†ç¬¦æ¥éªŒè¯å¯¹æ–¹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¯è§‚æµ‹æ€§å’Œè·Ÿè¸ª&lt;/strong&gt;ï¼šè¿½è¸ªå’ŒæŒ‡æ ‡å½¢å¼çš„å¯è§‚æµ‹æ€§å¯¹äºç†è§£ã€ç›‘æ§å’Œæ’é™¤åº”ç”¨ç¨‹åºçš„ç¨³å®šæ€§ã€æ€§èƒ½å’Œå¯ç”¨æ€§è‡³å…³é‡è¦ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;é€æ˜&lt;/strong&gt;ï¼šè¯¥åŠŸèƒ½å¿…é¡»ä»¥é€æ˜çš„æ–¹å¼æä¾›ç»™åº”ç”¨ç¨‹åºï¼Œå³ä¸éœ€è¦æ”¹å˜åº”ç”¨ç¨‹åºä»£ç ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åœ¨æ—©æœŸï¼ŒæœåŠ¡ç½‘æ ¼çš„åŠŸèƒ½é€šå¸¸æ˜¯ä»¥åº“çš„å½¢å¼å®ç°çš„ï¼Œè¦æ±‚ç½‘æ ¼ä¸­çš„æ¯ä¸ªåº”ç”¨ç¨‹åºéƒ½è¦é“¾æ¥åˆ°ä»¥åº”ç”¨ç¨‹åºçš„è¯­è¨€æ¡†æ¶ç¼–å†™çš„åº“ã€‚ç±»ä¼¼çš„äº‹æƒ…ä¹Ÿå‘ç”Ÿåœ¨äº’è”ç½‘çš„æ—©æœŸï¼šæ›¾å‡ ä½•æ—¶ï¼Œåº”ç”¨ç¨‹åºè¿˜éœ€è¦è¿è¡Œè‡ªå·±çš„ TCP/IP åè®®æ ˆï¼æ­£å¦‚æˆ‘ä»¬å°†åœ¨è¿™ç¯‡æ–‡ç« ä¸­è®¨è®ºçš„é‚£æ ·ï¼ŒæœåŠ¡ç½‘æ ¼æ­£åœ¨å‘å±•æˆä¸ºä¸€ç§å†…æ ¸è´£ä»»ï¼Œå°±åƒç½‘ç»œå †æ ˆä¸€æ ·ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-åŸºäºåº“çš„æœåŠ¡ç½‘æ ¼æ¨¡å‹&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;åŸºäºåº“çš„æœåŠ¡ç½‘æ ¼æ¨¡å‹&#34; srcset=&#34;
               /blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7wyowb55j31pi0k076p_hu50a747d0fe993bbedeb4bea6655ecd4b_95490_dc28956fcdaa8533c1e80646c297a1af.webp 400w,
               /blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7wyowb55j31pi0k076p_hu50a747d0fe993bbedeb4bea6655ecd4b_95490_95551f04e0dbe65f3378e151db58034e.webp 760w,
               /blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7wyowb55j31pi0k076p_hu50a747d0fe993bbedeb4bea6655ecd4b_95490_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7wyowb55j31pi0k076p_hu50a747d0fe993bbedeb4bea6655ecd4b_95490_dc28956fcdaa8533c1e80646c297a1af.webp&#34;
               width=&#34;760&#34;
               height=&#34;247&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      åŸºäºåº“çš„æœåŠ¡ç½‘æ ¼æ¨¡å‹
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;ä»Šå¤©ï¼ŒæœåŠ¡ç½‘æ ¼é€šå¸¸ä½¿ç”¨ä¸€ç§å«åš sidecar æ¨¡å‹çš„æ¶æ„æ¥å®ç°ã€‚è¿™ç§æ¶æ„å°†å®ç°ä¸Šè¿°åŠŸèƒ½çš„ä»£ç å°è£…åˆ°ç¬¬å››å±‚ä»£ç†ä¸­ï¼ŒæœåŠ¡é—´çš„æµé‡è¢«é‡å®šå‘åˆ°è¿™ä¸ªæ‰€è°“çš„ sidecar ä»£ç†ã€‚å®ƒä¹‹æ‰€ä»¥è¢«ç§°ä¸º â€œæŒæ–—â€ï¼Œæ˜¯å› ä¸ºæ¯ä¸ªåº”ç”¨ç¨‹åºéƒ½æœ‰ä¸€ä¸ªä»£ç†ï¼Œå°±åƒæŒæ–—é™„ç€åœ¨æ‘©æ‰˜è½¦ä¸Šä¸€æ ·ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-åŸºäº-sidecar-çš„æœåŠ¡ç½‘æ ¼æ¨¡å‹&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;åŸºäº Sidecar çš„æœåŠ¡ç½‘æ ¼æ¨¡å‹&#34; srcset=&#34;
               /blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7wyqsefhj31pe0moq5h_hu4fd9e548e6d25e6c485bbd6b10898244_100939_0d600138e96a481444eae67391d42740.webp 400w,
               /blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7wyqsefhj31pe0moq5h_hu4fd9e548e6d25e6c485bbd6b10898244_100939_a407f59981107c732d11d0d70af1a165.webp 760w,
               /blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7wyqsefhj31pe0moq5h_hu4fd9e548e6d25e6c485bbd6b10898244_100939_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7wyqsefhj31pe0moq5h_hu4fd9e548e6d25e6c485bbd6b10898244_100939_0d600138e96a481444eae67391d42740.webp&#34;
               width=&#34;760&#34;
               height=&#34;281&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      åŸºäº Sidecar çš„æœåŠ¡ç½‘æ ¼æ¨¡å‹
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;è¿™ç§æ¶æ„çš„ä¼˜ç‚¹æ˜¯ï¼ŒæœåŠ¡ä¸å†éœ€è¦è‡ªå·±å®ç°æœåŠ¡ç½‘æ ¼çš„åŠŸèƒ½ã€‚å¦‚æœè®¸å¤šæœåŠ¡æ˜¯ç”¨ä¸åŒçš„è¯­è¨€ç¼–å†™éƒ¨ç½²çš„ï¼Œæˆ–è€…å¦‚æœä½ æ­£åœ¨è¿è¡Œä¸å¯å˜çš„ç¬¬ä¸‰æ–¹åº”ç”¨ç¨‹åºï¼Œè¿™å°±å¾ˆæœ‰å¥½å¤„ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ç§æ¨¡å¼çš„ç¼ºç‚¹æ˜¯æœ‰å¤§é‡çš„ä»£ç†ï¼Œè®¸å¤šé¢å¤–çš„ç½‘ç»œè¿æ¥ï¼Œä»¥åŠå¤æ‚çš„é‡å®šå‘é€»è¾‘ï¼Œå°†ç½‘ç»œæµé‡è¾“å…¥ä»£ç†ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œåœ¨ä»€ä¹ˆç±»å‹çš„ç½‘ç»œæµé‡å¯ä»¥è¢«é‡å®šå‘åˆ°ç¬¬å››å±‚ä»£ç†ä¸Šä¹Ÿæœ‰é™åˆ¶ã€‚ä»£ç†ï¼ˆProxyï¼‰åœ¨å…¶èƒ½æ”¯æŒçš„ç½‘ç»œåè®®æ–¹é¢æ˜¯æœ‰é™çš„ã€‚&lt;/p&gt;
&lt;h2 id=&#34;è¿æ¥æ€§è½¬ç§»åˆ°å†…æ ¸ä¸­çš„å†å²&#34;&gt;è¿æ¥æ€§è½¬ç§»åˆ°å†…æ ¸ä¸­çš„å†å²&lt;/h2&gt;
&lt;p&gt;å‡ åå¹´æ¥ï¼Œåœ¨åº”ç”¨ç¨‹åºä¹‹é—´æä¾›å®‰å…¨å¯é çš„è¿æ¥ä¸€ç›´æ˜¯æ“ä½œç³»ç»Ÿçš„è´£ä»»ã€‚æœ‰äº›äººå¯èƒ½è¿˜è®°å¾—æ—©æœŸ Unix å’Œ Linux æ—¶ä»£çš„ &lt;a href=&#34;https://en.wikipedia.org/wiki/TCP_Wrappers&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;TCP åŒ…è£…å™¨&lt;/a&gt;å’Œ tcpdã€‚tcpd å…è®¸ç”¨æˆ·åœ¨ä¸ä¿®æ”¹åº”ç”¨ç¨‹åºçš„æƒ…å†µä¸‹é€æ˜åœ°æ·»åŠ æ—¥å¿—ã€è®¿é—®æ§åˆ¶ã€ä¸»æœºåéªŒè¯å’Œæ¬ºéª—ä¿æŠ¤ã€‚å®ƒä½¿ç”¨äº† libwrapï¼Œè€Œä¸”ï¼Œåœ¨ä¸€ä¸ªæœ‰è¶£çš„å¹³è¡ŒäºæœåŠ¡ç½‘æ ¼çš„æ•…äº‹ä¸­ï¼Œè¿™ä¸ªåº“ä¹Ÿæ˜¯ä»¥å‰åº”ç”¨ç¨‹åºæä¾›è¿™äº›åŠŸèƒ½çš„é“¾æ¥å¯¹è±¡ã€‚tcpd æ‰€å¸¦æ¥çš„æ˜¯èƒ½å¤Ÿåœ¨ä¸ä¿®æ”¹ç°æœ‰åº”ç”¨ç¨‹åºçš„æƒ…å†µä¸‹å°†è¿™äº›åŠŸèƒ½é€æ˜åœ°æ·»åŠ åˆ°ç°æœ‰åº”ç”¨ç¨‹åºä¸­ã€‚æœ€ç»ˆï¼Œæ‰€æœ‰è¿™äº›åŠŸèƒ½éƒ½è¿›å…¥äº† Linux æœ¬èº«ï¼Œå¹¶ä»¥ä¸€ç§æ›´æœ‰æ•ˆã€æ›´å¼ºå¤§çš„æ–¹å¼æä¾›ç»™æ‰€æœ‰åº”ç”¨ç¨‹åºã€‚ä»Šå¤©ï¼Œè¿™å·²ç»å‘å±•åˆ°äº†æˆ‘ä»¬æ‰€çŸ¥é“çš„ iptablesã€‚&lt;/p&gt;
&lt;p&gt;ç„¶è€Œï¼Œiptables æ˜¾ç„¶ä¸é€‚åˆè§£å†³ç°ä»£åº”ç”¨çš„è¿æ¥æ€§ã€å®‰å…¨æ€§å’Œå¯è§‚æµ‹æ€§è¦æ±‚ï¼Œå› ä¸ºå®ƒåªåœ¨ç½‘ç»œå±‚é¢ä¸Šæ“ä½œï¼Œå¯¹åº”ç”¨åè®®å±‚ç¼ºä¹ä»»ä½•äº†è§£ã€‚è‡ªç„¶ï¼Œé˜»åŠ›æœ€å°çš„è·¯å¾„æ˜¯å›åˆ°åº“æ¨¡å‹ï¼Œç„¶åæ˜¯ sidecar æ¨¡å‹ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬æ­£å¤„äºè¿™æ ·ä¸€ä¸ªé˜¶æ®µï¼šä¸ºäº†æœ€ä½³çš„é€æ˜åº¦ã€æ•ˆç‡å’Œå®‰å…¨æ€§ï¼Œåœ¨æ“ä½œç³»ç»Ÿä¸­åŸç”Ÿåœ°æ”¯æŒè¿™ç§æ¨¡å¼æ˜¯æœ‰æ„ä¹‰çš„ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-æœåŠ¡ç½‘æ ¼çš„è¿›åŒ–&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;æœåŠ¡ç½‘æ ¼çš„è¿›åŒ–&#34; srcset=&#34;
               /blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7y8ybphhj31h30u041s_hu6485f23e60e2e8e9568294bae27898e8_129365_9bd5af9f2b4e222bd3c4020df3f9c9da.webp 400w,
               /blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7y8ybphhj31h30u041s_hu6485f23e60e2e8e9568294bae27898e8_129365_8944ed8b5c9c12d06d4e019d777f3674.webp 760w,
               /blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7y8ybphhj31h30u041s_hu6485f23e60e2e8e9568294bae27898e8_129365_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7y8ybphhj31h30u041s_hu6485f23e60e2e8e9568294bae27898e8_129365_9bd5af9f2b4e222bd3c4020df3f9c9da.webp&#34;
               width=&#34;760&#34;
               height=&#34;429&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      æœåŠ¡ç½‘æ ¼çš„è¿›åŒ–
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;åœ¨ tcpd æ—¶ä»£ï¼Œæ›¾ç»çš„è¿æ¥è®°å½•ç°åœ¨æ˜¯è¿½è¸ªã€‚IP å±‚é¢çš„è®¿é—®æ§åˆ¶å·²ç»æ¼”å˜æˆåº”ç”¨åè®®å±‚é¢çš„æˆæƒï¼Œä¾‹å¦‚ä½¿ç”¨ JWTã€‚ä¸»æœºåéªŒè¯å·²è¢«æ›´å¼ºå¤§çš„è®¤è¯æ‰€å–ä»£ï¼Œå¦‚ mTLSã€‚ç½‘ç»œè´Ÿè½½å‡è¡¡å·²ç»æ‰©å±•åˆ° L7 æµé‡ç®¡ç†ã€‚HTTP é‡è¯•æ˜¯æ–°çš„ TCP é‡ä¼ ã€‚è¿‡å»ç”¨é»‘æ´è·¯ç”±è§£å†³çš„é—®é¢˜ä»Šå¤©è¢«ç§°ä¸ºæ–­è·¯ã€‚è¿™äº›éƒ½ä¸æ˜¯æ ¹æœ¬æ€§çš„æ–°é—®é¢˜ï¼Œä½†æ‰€éœ€çš„ç¯å¢ƒå’Œæ§åˆ¶å·²ç»å‘ç”Ÿäº†å˜åŒ–ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ‰©å±•å†…æ ¸å‘½åç©ºé—´æ¦‚å¿µ&#34;&gt;æ‰©å±•å†…æ ¸å‘½åç©ºé—´æ¦‚å¿µ&lt;/h2&gt;
&lt;p&gt;Linux å†…æ ¸å·²ç»æœ‰ä¸€ä¸ªæ¦‚å¿µï¼Œå¯ä»¥å…±äº«å…±åŒçš„åŠŸèƒ½ï¼Œå¹¶ä½¿å…¶å¯¹ç³»ç»Ÿä¸Šè¿è¡Œçš„è®¸å¤šåº”ç”¨ç¨‹åºå¯ç”¨ã€‚è¿™ä¸ªæ¦‚å¿µè¢«ç§°ä¸ºå‘½åç©ºé—´ï¼ˆNamespaceï¼‰ï¼Œå®ƒæ„æˆäº†æˆ‘ä»¬ä»Šå¤©æ‰€çŸ¥çš„å®¹å™¨æŠ€æœ¯çš„åŸºç¡€ã€‚å‘½åç©ºé—´ï¼ˆå†…æ ¸çš„é‚£ç§ï¼Œä¸æ˜¯ Kubernetes çš„å‘½åç©ºé—´ï¼‰å­˜åœ¨äºå„ç§æŠ½è±¡ä¸­ï¼ŒåŒ…æ‹¬æ–‡ä»¶ç³»ç»Ÿã€ç”¨æˆ·ç®¡ç†ã€æŒ‚è½½è®¾å¤‡ã€è¿›ç¨‹ã€ç½‘ç»œç­‰ã€‚è¿™å°±æ˜¯å…è®¸å•ä¸ªå®¹å™¨å‘ˆç°ä¸åŒçš„æ–‡ä»¶ç³»ç»Ÿè§†å›¾ã€ä¸åŒçš„ç”¨æˆ·é›†ï¼Œä»¥åŠå…è®¸å¤šä¸ªå®¹å™¨ç»‘å®šåˆ°å•ä¸ªä¸»æœºä¸Šçš„åŒä¸€ç½‘ç»œç«¯å£ã€‚åœ¨ cgroups çš„å¸®åŠ©ä¸‹ï¼Œè¿™ä¸ªæ¦‚å¿µå¾—åˆ°äº†æ‰©å±•ï¼Œå¯ä»¥å¯¹ CPUã€å†…å­˜å’Œç½‘ç»œç­‰èµ„æºè¿›è¡Œç®¡ç†å’Œä¼˜å…ˆæ’åºã€‚ä»äº‘åŸç”Ÿåº”ç”¨å¼€å‘è€…çš„è§’åº¦æ¥çœ‹ï¼Œcgroups å’Œèµ„æºè¢«ç´§å¯†åœ°æ•´åˆåˆ°æˆ‘ä»¬æ‰€çŸ¥çš„ &amp;ldquo;å®¹å™¨&amp;rdquo; æ¦‚å¿µä¸­ã€‚&lt;/p&gt;
&lt;p&gt;ç¬¦åˆé€»è¾‘çš„æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬è®¤ä¸ºæœåŠ¡ç½‘æ ¼æ˜¯æ“ä½œç³»ç»Ÿçš„è´£ä»»ï¼Œé‚£ä¹ˆå®ƒå¿…é¡»ç¬¦åˆå¹¶æ•´åˆå‘½åç©ºé—´å’Œ cgroup çš„æ¦‚å¿µã€‚è¿™çœ‹èµ·æ¥ä¼šæ˜¯è¿™æ ·çš„ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-service-mesh-namespace&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Service Mesh Namespace&#34; srcset=&#34;
               /blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7wypvr2zj31p20q0q75_hu0135ea1d7ebbf6b8a4e6efa3962cc545_164573_16f30dbdeb4ebf1dd12714c687c97308.webp 400w,
               /blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7wypvr2zj31p20q0q75_hu0135ea1d7ebbf6b8a4e6efa3962cc545_164573_ca4f06178231f71ce281e8690fd8ece5.webp 760w,
               /blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7wypvr2zj31p20q0q75_hu0135ea1d7ebbf6b8a4e6efa3962cc545_164573_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7wypvr2zj31p20q0q75_hu0135ea1d7ebbf6b8a4e6efa3962cc545_164573_16f30dbdeb4ebf1dd12714c687c97308.webp&#34;
               width=&#34;760&#34;
               height=&#34;324&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      Service Mesh Namespace
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;ä¸å‡ºæ‰€æ–™ï¼Œè¿™çœ‹èµ·æ¥éå¸¸è‡ªç„¶ï¼Œè€Œä¸”å¯èƒ½æ˜¯å¤§å¤šæ•°ç”¨æˆ·ä»ç®€å•çš„è§’åº¦æ‰€æœŸæœ›çš„ã€‚åº”ç”¨ç¨‹åºä¿æŒä¸å˜ï¼Œå®ƒä»¬ç»§ç»­ä½¿ç”¨å¥—æ¥å­—è¿›è¡Œé€šä¿¡ï¼Œå°±åƒä»¥å‰é‚£æ ·ã€‚ç†æƒ³çš„æœåŠ¡ç½‘æ ¼æ˜¯ä½œä¸º Linux çš„ä¸€éƒ¨åˆ†é€æ˜åœ°æä¾›çš„ã€‚å®ƒå°±åœ¨é‚£é‡Œï¼Œå°±åƒä»Šå¤©çš„ TCP ä¸€æ ·ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ³¨å…¥-sidecar-çš„æˆæœ¬&#34;&gt;æ³¨å…¥ Sidecar çš„æˆæœ¬&lt;/h3&gt;
&lt;p&gt;å¦‚æœæˆ‘ä»¬ä»”ç»†ç ”ç©¶ä¸€ä¸‹ sidecar æ¨¡å‹ï¼Œæˆ‘ä»¬ä¼šå‘ç°å®ƒå®é™…ä¸Šæ˜¯åœ¨è¯•å›¾æ¨¡ä»¿è¿™ç§æ¨¡å‹ã€‚åº”ç”¨ç¨‹åºç»§ç»­ä½¿ç”¨å¥—æ¥å­—ï¼Œä¸€åˆ‡éƒ½è¢«å¡è¿› Linux å†…æ ¸çš„ç½‘ç»œå‘½åç©ºé—´ã€‚ç„¶è€Œï¼Œè¿™æ¯”å®ƒçœ‹èµ·æ¥è¦å¤æ‚å¾—å¤šï¼Œéœ€è¦è®¸å¤šé¢å¤–çš„æ­¥éª¤æ¥é€æ˜åœ°æ³¨å…¥ sidecar ä»£ç†ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-æ³¨å…¥-sidecar-çš„æˆæœ¬&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;æ³¨å…¥ Sidecar çš„æˆæœ¬&#34; srcset=&#34;
               /blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7y8nu479j31h30u041s_hu6485f23e60e2e8e9568294bae27898e8_129365_73d4c803cb891797200a45777fbad536.webp 400w,
               /blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7y8nu479j31h30u041s_hu6485f23e60e2e8e9568294bae27898e8_129365_230fa8022744b20b7f78ac0299625e07.webp 760w,
               /blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7y8nu479j31h30u041s_hu6485f23e60e2e8e9568294bae27898e8_129365_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7y8nu479j31h30u041s_hu6485f23e60e2e8e9568294bae27898e8_129365_73d4c803cb891797200a45777fbad536.webp&#34;
               width=&#34;760&#34;
               height=&#34;429&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      æ³¨å…¥ Sidecar çš„æˆæœ¬
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;è¿™ç§é¢å¤–çš„å¤æ‚æ€§åœ¨å»¶è¿Ÿå’Œé¢å¤–èµ„æºæ¶ˆè€—æ–¹é¢ä»˜å‡ºäº†å·¨å¤§çš„ä»£ä»·ã€‚æ—©æœŸçš„åŸºå‡†æµ‹è¯•è¡¨æ˜ï¼Œè¿™å¯¹å»¶è¿Ÿçš„å½±å“é«˜è¾¾ 3-4 å€ï¼Œè€Œä¸”æ‰€æœ‰ä»£ç†éƒ½éœ€è¦å¤§é‡çš„é¢å¤–å†…å­˜ã€‚åœ¨è¿™ç¯‡æ–‡ç« çš„åé¢ï¼Œæˆ‘ä»¬å°†ç ”ç©¶è¿™ä¸¤ç‚¹ï¼Œå› ä¸ºæˆ‘ä»¬å°†å…¶ä¸åŸºäº eBPF çš„æ¨¡å‹è¿›è¡Œæ¯”è¾ƒã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç”¨-ebpf-è§£é”å†…æ ¸æœåŠ¡ç½‘æ ¼&#34;&gt;ç”¨ eBPF è§£é”å†…æ ¸æœåŠ¡ç½‘æ ¼&lt;/h2&gt;
&lt;p&gt;ä¸ºä»€ä¹ˆæˆ‘ä»¬ä»¥å‰æ²¡æœ‰åœ¨å†…æ ¸ä¸­åˆ›å»ºä¸€ä¸ªæœåŠ¡ç½‘æ ¼ï¼Ÿæœ‰äº›äººåŠå¼€ç©ç¬‘åœ°è¯´ï¼Œkube-proxy æ˜¯æœ€åˆçš„æœåŠ¡ç½‘æ ¼ï¼ˆè§&lt;a href=&#34;https://www.youtube.com/watch?v=lUF88T16YqY&amp;amp;ab_channel=CloudNativeRejekts&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æˆ‘ä»¬å·²ç»æ„å»ºäº†ç›¸å½“å¤šçš„æœåŠ¡ç½‘æ ¼ - Tim Hockin, Google&lt;/a&gt;ï¼‰ã€‚è¿™å¥è¯æ˜¯æœ‰ä¸€å®šé“ç†çš„ã€‚Kube-proxy æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ï¼Œè¯´æ˜äº† Linux å†…æ ¸åœ¨ä¾é ä¼ ç»Ÿçš„åŸºäºç½‘ç»œçš„ iptables åŠŸèƒ½å®ç°æœåŠ¡ç½‘æ ¼æ—¶ï¼Œå¯ä»¥è¾¾åˆ°å¤šä¹ˆæ¥è¿‘ã€‚ç„¶è€Œï¼Œè¿™è¿˜ä¸å¤Ÿï¼ŒL7 ä¸Šä¸‹æ–‡æ˜¯ç¼ºå¤±çš„ã€‚Kube-proxy å®Œå…¨åœ¨ç½‘ç»œæ•°æ®åŒ…å±‚é¢è¿ä½œã€‚ç°ä»£åº”ç”¨éœ€è¦ L7 æµé‡ç®¡ç†ã€è·Ÿè¸ªã€è®¤è¯å’Œé¢å¤–çš„å¯é æ€§ä¿è¯ã€‚Kube-proxy ä¸èƒ½åœ¨ç½‘ç»œå±‚é¢ä¸Šæä¾›è¿™äº›ã€‚&lt;/p&gt;
&lt;p&gt;eBPF æ”¹å˜äº†è¿™ä¸ªæ¨¡å¼ã€‚å®ƒå…è®¸åŠ¨æ€åœ°æ‰©å±• Linux å†…æ ¸çš„åŠŸèƒ½ã€‚æˆ‘ä»¬ä¸€ç›´åœ¨ä½¿ç”¨ eBPF ä¸º Cilium å»ºç«‹ä¸€ä¸ªé«˜æ•ˆçš„ç½‘ç»œã€å®‰å…¨å’Œå¯è§‚æµ‹æ€§æ•°æ®é€šè·¯ï¼Œå¹¶å°†å…¶ç›´æ¥åµŒå…¥åˆ° Linux å†…æ ¸ã€‚åº”ç”¨è¿™ä¸ªç›¸åŒçš„æ¦‚å¿µï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨å†…æ ¸å±‚é¢ä¸Šè§£å†³æœåŠ¡ç½‘æ ¼çš„è¦æ±‚ã€‚äº‹å®ä¸Šï¼ŒCilium å·²ç»å®ç°äº†å„ç§æ‰€éœ€çš„æ¦‚å¿µï¼Œå¦‚åŸºäºèº«ä»½çš„å®‰å…¨ã€L3-L7 å¯è§‚æµ‹æ€§å’Œæˆæƒã€åŠ å¯†å’Œè´Ÿè½½å‡è¡¡ã€‚ç¼ºå°‘çš„éƒ¨åˆ†ç°åœ¨æ­£åœ¨å‘ Cilium æ¶Œæ¥ã€‚åœ¨æœ¬åšå®¢çš„æœ«å°¾ï¼Œä½ ä¼šå‘ç°å¦‚ä½•åŠ å…¥ç”± Cilium ç¤¾åŒºæ¨åŠ¨çš„ Cilium æœåŠ¡ç½‘æ ¼æµ‹è¯•é¡¹ç›®çš„ç»†èŠ‚ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-ebpf-æœåŠ¡ç½‘æ ¼æ¶æ„&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;eBPF æœåŠ¡ç½‘æ ¼æ¶æ„&#34; srcset=&#34;
               /blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7wyrufdyj31w90u0q6o_hu445db7688add13f894a9eb7f25ded5d7_145770_ec64207fe64f13ddab54f26766098829.webp 400w,
               /blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7wyrufdyj31w90u0q6o_hu445db7688add13f894a9eb7f25ded5d7_145770_0b120b1c08842e3408423ebcee010fc8.webp 760w,
               /blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7wyrufdyj31w90u0q6o_hu445db7688add13f894a9eb7f25ded5d7_145770_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7wyrufdyj31w90u0q6o_hu445db7688add13f894a9eb7f25ded5d7_145770_ec64207fe64f13ddab54f26766098829.webp&#34;
               width=&#34;760&#34;
               height=&#34;334&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      eBPF æœåŠ¡ç½‘æ ¼æ¶æ„
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æœ‰äººå¯èƒ½æƒ³çŸ¥é“ä¸ºä»€ä¹ˆ Linux å†…æ ¸ç¤¾åŒºä¸ç›´æ¥è§£å†³è¿™äº›éœ€æ±‚&lt;/strong&gt;ã€‚eBPF æœ‰ä¸€ä¸ªå·¨å¤§çš„ä¼˜åŠ¿ï¼ŒeBPF ä»£ç å¯ä»¥åœ¨è¿è¡Œæ—¶æ’å…¥åˆ°ç°æœ‰çš„ Linux å†…æ ¸ä¸­ï¼Œç±»ä¼¼äº Linux å†…æ ¸æ¨¡å—ï¼Œä½†ä¸å†…æ ¸æ¨¡å—ä¸åŒï¼Œå®ƒå¯ä»¥ä»¥å®‰å…¨å’Œå¯ç§»æ¤çš„æ–¹å¼è¿›è¡Œã€‚è¿™ä½¿å¾— eBPF çš„å®ç°èƒ½å¤Ÿéšç€æœåŠ¡ç½‘æ ¼ç¤¾åŒºçš„å‘å±•è€Œç»§ç»­å‘å±•ã€‚&lt;strong&gt;æ–°çš„å†…æ ¸ç‰ˆæœ¬éœ€è¦å‡ å¹´æ—¶é—´æ‰èƒ½è¿›å…¥ç”¨æˆ·æ‰‹ä¸­&lt;/strong&gt;ã€‚eBPF æ˜¯ä¸€é¡¹å…³é”®æŠ€æœ¯ï¼Œå®ƒä½¿ Linux å†…æ ¸èƒ½å¤Ÿè·Ÿä¸Šå¿«é€Ÿå‘å±•çš„äº‘åŸç”ŸæŠ€æœ¯æ ˆã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ— -sidecar-çš„åŸºäº-ebpf-çš„-l7-è¿½è¸ªå’Œåº¦é‡&#34;&gt;æ—  Sidecar çš„åŸºäº eBPF çš„ L7 è¿½è¸ªå’Œåº¦é‡&lt;/h2&gt;
&lt;p&gt;è®©æˆ‘ä»¬çœ‹çœ‹ L7 è¿½è¸ªå’ŒæŒ‡æ ‡å¯è§‚æµ‹æ€§ï¼Œä½œä¸ºä¸€ä¸ªå…·ä½“çš„ä¾‹å­ï¼Œè¯´æ˜åŸºäº eBPF çš„æœåŠ¡ç½‘æ ¼å¯¹ä¿æŒä½å»¶è¿Ÿå’Œæé«˜è§‚å¯Ÿæ€§æœ‰å·¨å¤§çš„å½±å“ã€‚åº”ç”¨ç¨‹åºå›¢é˜Ÿä¾é åº”ç”¨ç¨‹åºçš„å¯è§†æ€§å’Œç›‘æ§ä½œä¸ºåŸºæœ¬è¦æ±‚è¿™äº›ï¼Œè¿™åŒ…æ‹¬è¯·æ±‚è·Ÿè¸ªã€HTTP å“åº”ç‡å’ŒæœåŠ¡å»¶è¿Ÿä¿¡æ¯ç­‰èƒ½åŠ›ã€‚ç„¶è€Œï¼Œè¿™ç§å¯è§‚æµ‹æ€§åº”è¯¥æ²¡æœ‰æ˜æ˜¾çš„æˆæœ¬ï¼ˆå»¶è¿Ÿã€å¤æ‚æ€§ã€èµ„æºâ€¦ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-åŸºäº-ebpf-çš„å¯è§†æ€§&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;åŸºäº eBPF çš„å¯è§†æ€§&#34; srcset=&#34;
               /blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7wysxpr4j31ne0iugq1_hufd2b0ecfb4e71144719ce40203bf6eba_169325_3c5ffec4c37ab13904b7ad3f8850c40b.webp 400w,
               /blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7wysxpr4j31ne0iugq1_hufd2b0ecfb4e71144719ce40203bf6eba_169325_9df96ff7ec97749415a91faf059c43e6.webp 760w,
               /blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7wysxpr4j31ne0iugq1_hufd2b0ecfb4e71144719ce40203bf6eba_169325_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7wysxpr4j31ne0iugq1_hufd2b0ecfb4e71144719ce40203bf6eba_169325_3c5ffec4c37ab13904b7ad3f8850c40b.webp&#34;
               width=&#34;760&#34;
               height=&#34;241&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      åŸºäº eBPF çš„å¯è§†æ€§
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;åœ¨ä¸‹é¢çš„åŸºå‡†æµ‹è¯•ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ—©æœŸçš„æµ‹é‡ç»“æœï¼Œå³é€šè¿‡ eBPF æˆ– sidecar æ–¹æ³•å®ç° HTTP å¯è§†æ€§å¯¹å»¶è¿Ÿçš„å½±å“ã€‚è¯¥è®¾ç½®æ˜¯åœ¨ä¸¤ä¸ªä¸åŒèŠ‚ç‚¹ä¸Šè¿è¡Œçš„ä¸¤ä¸ª pod ä¹‹é—´é€šè¿‡å›ºå®šæ•°é‡çš„è¿æ¥æ¯ç§’ç¨³å®šè¿è¡Œ 10K ä¸ª HTTP è¯·æ±‚ï¼Œå¹¶æµ‹é‡è¯·æ±‚çš„å¹³å‡å»¶æ—¶ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-åŸºäº-ebpf-çš„å»¶è¿ŸåŸºå‡†æµ‹è¯•-vs-åŸºäº-sidecar-çš„-l7-å¯è§†æ€§&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;åŸºäº eBPF çš„å»¶è¿ŸåŸºå‡†æµ‹è¯• vs åŸºäº Sidecar çš„ L7 å¯è§†æ€§&#34; srcset=&#34;
               /blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7wyt6izdj31ns0rawfw_hu7a5bfe8bc9fa18fe7dc7457a21c91d33_61285_7cf7567252f38f870003e2bdc6cfef48.webp 400w,
               /blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7wyt6izdj31ns0rawfw_hu7a5bfe8bc9fa18fe7dc7457a21c91d33_61285_9a381eb32592d94bdcc1720e2bf4a21c.webp 760w,
               /blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7wyt6izdj31ns0rawfw_hu7a5bfe8bc9fa18fe7dc7457a21c91d33_61285_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7wyt6izdj31ns0rawfw_hu7a5bfe8bc9fa18fe7dc7457a21c91d33_61285_7cf7567252f38f870003e2bdc6cfef48.webp&#34;
               width=&#34;760&#34;
               height=&#34;347&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      åŸºäº eBPF çš„å»¶è¿ŸåŸºå‡†æµ‹è¯• vs åŸºäº Sidecar çš„ L7 å¯è§†æ€§
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æ•…æ„ä¸æè¿™äº›æµ‹é‡ä¸­ä½¿ç”¨çš„å…·ä½“ä»£ç†ï¼Œå› ä¸ºå®ƒå¹¶ä¸é‡è¦ã€‚å¯¹äºæˆ‘ä»¬æµ‹è¯•è¿‡çš„æ‰€æœ‰ä»£ç†ï¼Œç»“æœå‡ ä¹éƒ½æ˜¯ä¸€æ ·çš„ã€‚è¦æ˜ç¡®çš„æ˜¯ï¼Œè¿™ä¸æ˜¯å…³äº Envoyã€Linkerdã€Nginx æˆ–å…¶ä»–ä»£ç†æ˜¯å¦æ›´å¿«ã€‚æ‰€æåˆ°çš„ä»£ç†æœ‰å·®å¼‚ï¼Œä½†ä¸é¦–å…ˆæ³¨å…¥ä»£ç†çš„æˆæœ¬ç›¸æ¯”ï¼Œå®ƒä»¬æ˜¯å¾®ä¸è¶³é“çš„ã€‚&lt;strong&gt;å‡ ä¹æ²¡æœ‰å¼€é”€æ˜¯æ¥è‡ªä»£ç†æœ¬èº«çš„é€»è¾‘ã€‚å¼€é”€æ˜¯é€šè¿‡æ³¨å…¥ä»£ç†ï¼Œå°†ç½‘ç»œæµé‡é‡å®šå‘åˆ°å®ƒï¼Œç»ˆæ­¢è¿æ¥å’Œå¯åŠ¨æ–°çš„è¿æ¥è€Œå¢åŠ çš„ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è¿™äº›æ—©æœŸçš„æµ‹é‡ç»“æœè¡¨æ˜ï¼ŒåŸºäº eBPF çš„å†…æ ¸æ–¹æ³•æ˜¯éå¸¸æœ‰å‰é€”çš„ï¼Œå¯ä»¥å®ç°å®Œå…¨é€æ˜çš„æœåŠ¡ç½‘æ ¼çš„æ„¿æœ›ï¼Œè€Œä¸”æ²¡æœ‰æ˜æ˜¾çš„å¼€é”€ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä½¿ç”¨-ebpf-åŠ é€Ÿçš„-per-node-ä»£ç†&#34;&gt;ä½¿ç”¨ eBPF åŠ é€Ÿçš„ per-node ä»£ç†&lt;/h2&gt;
&lt;p&gt;è¶Šæ¥è¶Šå¤šçš„ç”¨ä¾‹å¯ä»¥ç”¨è¿™ç§ä»…æœ‰ eBPF çš„æ–¹æ³•æ¥è¦†ç›–ï¼Œä»è€Œå®Œå…¨å–æ¶ˆ L4 ä»£ç†ã€‚æœ‰äº›ç”¨ä¾‹ï¼Œä»ç„¶éœ€è¦ä»£ç†ã€‚ä¾‹å¦‚ï¼Œå½“è¿æ¥éœ€è¦æ‹¼æ¥æ—¶ï¼Œå½“ TLS ç»ˆæ­¢è¢«æ‰§è¡Œæ—¶ï¼Œæˆ–å¯¹äºæŸäº›å½¢å¼çš„ HTTP æˆæƒã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬çš„ eBPF æœåŠ¡ç½‘æ ¼å·¥ä½œå°†ç»§ç»­å…³æ³¨é‚£äº›ä»æ€§èƒ½è§’åº¦å¯ä»¥è·å¾—æœ€å¤§æ”¶ç›Šçš„é¢†åŸŸã€‚å¦‚æœä½ å¿…é¡»æ‰§è¡Œ TLS ç»ˆæ­¢ï¼Œä½ å¯èƒ½ä¸ä»‹æ„åœ¨æµé‡æµå…¥é›†ç¾¤æ—¶ç”¨ä»£ç†ç»ˆæ­¢ä¸€æ¬¡è¿æ¥ã€‚ç„¶è€Œï¼Œä½ ä¼šæ›´å…³å¿ƒåœ¨æ¯ä¸ªè¿æ¥çš„è·¯å¾„ä¸­æ³¨å…¥ä¸¤ä¸ªä»£ç†çš„å½±å“ï¼Œä»¥æå– HTTP æŒ‡æ ‡å’Œè·Ÿè¸ªæ•°æ®ã€‚&lt;/p&gt;
&lt;p&gt;å½“ä¸€ä¸ªç”¨ä¾‹ä¸èƒ½ç”¨çº¯ eBPF çš„æ–¹æ³•æ¥å®ç°æ—¶ï¼Œç½‘æ ¼å¯ä»¥å›é€€åˆ°æ¯ä¸ªèŠ‚ç‚¹çš„ä»£ç†æ¨¡å‹ï¼Œç›´æ¥å°†ä»£ç†ä¸å†…æ ¸çš„å¥—æ¥å­—å±‚ç»“åˆèµ·æ¥ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-ebpf-per-node-proxy&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;eBPF per-node Proxy&#34; srcset=&#34;
               /blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7wyvrfmfj31vq0u0q87_hu7eadff7af9f47974f13c9174791de55f_203134_cae09a072642115218e86546c57c2871.webp 400w,
               /blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7wyvrfmfj31vq0u0q87_hu7eadff7af9f47974f13c9174791de55f_203134_bd76ad40fcfd5a162be8d7e6e709f964.webp 760w,
               /blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7wyvrfmfj31vq0u0q87_hu7eadff7af9f47974f13c9174791de55f_203134_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7wyvrfmfj31vq0u0q87_hu7eadff7af9f47974f13c9174791de55f_203134_cae09a072642115218e86546c57c2871.webp&#34;
               width=&#34;760&#34;
               height=&#34;337&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      eBPF per-node Proxy
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;eBPF ä¸ä¾èµ–ç½‘ç»œçº§çš„é‡å®šå‘ï¼Œè€Œæ˜¯ç›´æ¥åœ¨å¥—æ¥å­—çº§åˆ«æ³¨å…¥ä»£ç†ï¼Œä¿æŒè·¯å¾„çŸ­ã€‚åœ¨ Cilium çš„æ¡ˆä¾‹ä¸­ï¼Œæ­£åœ¨ä½¿ç”¨ Envoy ä»£ç†ï¼Œå°½ç®¡ä»æ¶æ„çš„è§’åº¦æ¥çœ‹ï¼Œä»»ä½•ä»£ç†éƒ½å¯ä»¥è¢«æ•´åˆåˆ°è¿™ä¸ªæ¨¡å‹ã€‚ä»æ¦‚å¿µä¸Šè®²ï¼Œè¿™å…è®¸å°† Linux å†…æ ¸ç½‘ç»œå‘½åç©ºé—´çš„æ¦‚å¿µç›´æ¥æ‰©å±•åˆ° Envoy ç›‘å¬å™¨é…ç½®çš„æ¦‚å¿µï¼Œå¹¶å°† Envoy å˜æˆä¸€ä¸ªå¤šç”¨æˆ·ä»£ç†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;sidecar-ä¸-per-node-ä»£ç†&#34;&gt;Sidecar ä¸ per-Node ä»£ç†&lt;/h2&gt;
&lt;p&gt;å³ä½¿éœ€è¦ä»£ç†ï¼Œä»£ç†çš„æˆæœ¬ä¹Ÿä¼šæ ¹æ®éƒ¨ç½²çš„æ¶æ„è€Œæœ‰æ‰€ä¸åŒã€‚è®©æˆ‘ä»¬æ¥çœ‹çœ‹æ¯ä¸ªèŠ‚ç‚¹çš„ä»£ç†æ¨¡å¼ä¸ sidecar æ¨¡å¼çš„æ¯”è¾ƒã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ¯ä¸ªè¿æ¥çš„ä»£ç†&#34;&gt;æ¯ä¸ªè¿æ¥çš„ä»£ç†&lt;/h3&gt;
&lt;p&gt;æ‰€éœ€çš„ç½‘ç»œè¿æ¥æ•°å°†å› æ˜¯å¦æœ‰ä»£ç†è€Œä¸åŒã€‚æœ€ç®€å•çš„æƒ…å†µæ˜¯æ—  sidecar æ¨¡å¼ï¼Œè¿™æ„å‘³ç€ç½‘ç»œè¿æ¥çš„æ•°é‡æ²¡æœ‰å˜åŒ–ã€‚ä¸€ä¸ªå•ä¸€çš„è¿æ¥å°†ä¸ºè¯·æ±‚æä¾›æœåŠ¡ï¼ŒeBPF å°†æä¾›æœåŠ¡ç½‘æ ¼åŠŸèƒ½ï¼Œå¦‚è·Ÿè¸ªæˆ–ç°æœ‰è¿æ¥ä¸Šçš„è´Ÿè½½å‡è¡¡ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-åŸºäº-ebpf-çš„æ¨¡å‹&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;åŸºäº eBPF çš„æ¨¡å‹&#34; srcset=&#34;
               /blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7wyy16o4j32960kcwg9_hua57ac0fec04afe9a17972f7f65b18710_75274_b1bb728478bd4a1d987e48d14e04251b.webp 400w,
               /blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7wyy16o4j32960kcwg9_hua57ac0fec04afe9a17972f7f65b18710_75274_a955581f54b7ac14d5395e3d87b55296.webp 760w,
               /blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7wyy16o4j32960kcwg9_hua57ac0fec04afe9a17972f7f65b18710_75274_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7wyy16o4j32960kcwg9_hua57ac0fec04afe9a17972f7f65b18710_75274_b1bb728478bd4a1d987e48d14e04251b.webp&#34;
               width=&#34;760&#34;
               height=&#34;191&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      åŸºäº eBPF çš„æ¨¡å‹
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;ç”¨ sidecar æ¨¡å‹æä¾›åŒæ ·çš„åŠŸèƒ½éœ€è¦åœ¨è¿æ¥ä¸­æ³¨å…¥ä¸¤æ¬¡ä»£ç†ï¼Œè¿™å¯¼è‡´éœ€è¦ç»´æŠ¤ä¸‰ä¸ªè¿æ¥ã€‚è¿™å¯¼è‡´äº†å¼€é”€çš„å¢åŠ å’Œæ‰€æœ‰é¢å¤–çš„å¥—æ¥å­—ç¼“å†²åŒºæ‰€éœ€å†…å­˜çš„å€å¢ï¼Œè¡¨ç°ä¸ºæ›´é«˜çš„æœåŠ¡é—´å»¶è¿Ÿã€‚è¿™å°±æ˜¯æˆ‘ä»¬ä¹‹å‰åœ¨æ—  sidecar L7 å¯è§†æ€§éƒ¨åˆ†çœ‹åˆ°çš„ sidecar å¼€é”€ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-åŸºäº-sidecar-ä»£ç†çš„æ¨¡å‹&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;åŸºäº Sidecar ä»£ç†çš„æ¨¡å‹&#34; srcset=&#34;
               /blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7wz3o1f6j32860lego3_hu773322c04982bb804c1017287914b0af_101275_47704abc0bc4ccd15f3e324e29995d3e.webp 400w,
               /blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7wz3o1f6j32860lego3_hu773322c04982bb804c1017287914b0af_101275_186ea6bca077e39bf5fb3791fc9b7d14.webp 760w,
               /blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7wz3o1f6j32860lego3_hu773322c04982bb804c1017287914b0af_101275_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7wz3o1f6j32860lego3_hu773322c04982bb804c1017287914b0af_101275_47704abc0bc4ccd15f3e324e29995d3e.webp&#34;
               width=&#34;760&#34;
               height=&#34;203&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      åŸºäº Sidecar ä»£ç†çš„æ¨¡å‹
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;åˆ‡æ¢åˆ° per-node çš„ä»£ç†æ¨¡å¼ä½¿æˆ‘ä»¬èƒ½å¤Ÿæ‘†è„±å…¶ä¸­ä¸€ä¸ªä»£ç†ï¼Œå› ä¸ºæˆ‘ä»¬ä¸å†ä¾èµ–åœ¨æ¯ä¸ªå·¥ä½œè´Ÿè½½ä¸­è¿è¡Œä¸€ä¸ª sidecarã€‚æ¯”èµ·ä¸éœ€è¦é¢å¤–çš„è¿æ¥ï¼Œè¿™è¿˜æ˜¯ä¸å¤Ÿç†æƒ³ï¼Œä½†æ¯”èµ·æ€»æ˜¯éœ€è¦ä¸¤ä¸ªé¢å¤–çš„è¿æ¥è¦å¥½ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-per-node-ä»£ç†æ¨¡å¼&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Per-node ä»£ç†æ¨¡å¼&#34; srcset=&#34;
               /blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7wyx2lulj32980o4dhz_hu15d35ae3518e01d6235ec2f122222c42_89210_7bde5738f26376430d21264bb186b5f0.webp 400w,
               /blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7wyx2lulj32980o4dhz_hu15d35ae3518e01d6235ec2f122222c42_89210_7ce78a2664dc15bb076096454262f429.webp 760w,
               /blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7wyx2lulj32980o4dhz_hu15d35ae3518e01d6235ec2f122222c42_89210_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7wyx2lulj32980o4dhz_hu15d35ae3518e01d6235ec2f122222c42_89210_7bde5738f26376430d21264bb186b5f0.webp&#34;
               width=&#34;760&#34;
               height=&#34;225&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      Per-node ä»£ç†æ¨¡å¼
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h3 id=&#34;æ‰€éœ€çš„ä»£ç†æ€»æ•°&#34;&gt;æ‰€éœ€çš„ä»£ç†æ€»æ•°&lt;/h3&gt;
&lt;p&gt;åœ¨æ¯ä¸ªå·¥ä½œè´Ÿè½½ä¸­è¿è¡Œä¸€ä¸ª sidecar ä¼šå¯¼è‡´å¤§é‡çš„ä»£ç†ã€‚å³ä½¿æ¯ä¸ªå•ç‹¬çš„ä»£ç†å®ä¾‹åœ¨å…¶å†…å­˜å ç”¨æ–¹é¢æ˜¯ç›¸å½“ä¼˜åŒ–çš„ï¼Œä½†å®ä¾‹çš„æ•°é‡ä¹‹å¤šå°†å¯¼è‡´æ€»çš„å½±å“å¾ˆå¤§ã€‚æ­¤å¤–ï¼Œæ¯ä¸ªä»£ç†ç»´æŠ¤çš„æ•°æ®ç»“æ„ï¼Œå¦‚è·¯ç”±å’Œç«¯ç‚¹è¡¨ï¼Œéšç€é›†ç¾¤çš„å¢é•¿è€Œå¢é•¿ï¼Œæ‰€ä»¥é›†ç¾¤è¶Šå¤§ï¼Œæ¯ä¸ªä»£ç†çš„å†…å­˜æ¶ˆè€—å°±è¶Šé«˜ã€‚ä»Šå¤©ï¼Œä¸€äº›æœåŠ¡ç½‘æ ¼è¯•å›¾é€šè¿‡å°†éƒ¨åˆ†è·¯ç”±è¡¨æ¨é€ç»™å•ä¸ªä»£ç†æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œé™åˆ¶å®ƒä»¬å¯ä»¥è·¯ç”±åˆ°å“ªé‡Œã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-ä»£ç†æ•°é‡&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;ä»£ç†æ•°é‡&#34; srcset=&#34;
               /blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7y8synvej31z40oiq6n_hu6485f23e60e2e8e9568294bae27898e8_147190_e5e6f2c7d1de4f5108e2f0c65c63633b.webp 400w,
               /blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7y8synvej31z40oiq6n_hu6485f23e60e2e8e9568294bae27898e8_147190_2648ed10ae21eaef48205e7b5665caec.webp 760w,
               /blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7y8synvej31z40oiq6n_hu6485f23e60e2e8e9568294bae27898e8_147190_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7y8synvej31z40oiq6n_hu6485f23e60e2e8e9568294bae27898e8_147190_e5e6f2c7d1de4f5108e2f0c65c63633b.webp&#34;
               width=&#34;760&#34;
               height=&#34;262&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      ä»£ç†æ•°é‡
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;è®©æˆ‘ä»¬å‡è®¾åœ¨ä¸€ä¸ª 500 ä¸ªèŠ‚ç‚¹çš„é›†ç¾¤ä¸­ï¼Œæ¯ä¸€ä¸ªèŠ‚ç‚¹æœ‰ 30 ä¸ª podï¼Œä¸€ä¸ªåŸºäº sidecar çš„æ¶æ„å°†éœ€è¦è¿è¡Œ 15K ä¸ªä»£ç†ã€‚åœ¨æ¯ä¸ªä»£ç†æ¶ˆè€— 70MB å†…å­˜çš„æƒ…å†µä¸‹ï¼ˆå‡è®¾å·²ç»ç»è¿‡æè‡´ä¼˜åŒ–è¿‡çš„è·¯ç”±è¡¨ï¼‰ï¼Œè¿™ä»ç„¶å¯¼è‡´é›†ç¾¤ä¸­æ‰€æœ‰ sidecar æ¶ˆè€— 1.5TB çš„å†…å­˜ã€‚åœ¨ per-node æ¨¡å‹ä¸­ï¼Œå‡è®¾æ¯ä¸ªä»£ç†çš„å†…å­˜è¶³è¿¹ç›¸åŒï¼Œ500 ä¸ªä»£ç†å°†æ¶ˆè€—ä¸è¶…è¿‡ 34GB çš„å†…å­˜ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å¤šç§Ÿæˆ·&#34;&gt;å¤šç§Ÿæˆ·&lt;/h3&gt;
&lt;p&gt;å½“æˆ‘ä»¬ä» sidecar æ¨¡å‹è½¬å‘ per-node æ¨¡å‹æ—¶ï¼Œä»£ç†å°†ä¸ºå¤šä¸ªåº”ç”¨ç¨‹åºæä¾›è¿æ¥ã€‚ä»£ç†å¿…é¡»å…·æœ‰å¤šç§Ÿæˆ·æ„ŸçŸ¥ã€‚è¿™ä¸æˆ‘ä»¬ä»ä½¿ç”¨å•ä¸ªè™šæ‹Ÿæœºè½¬å‘ä½¿ç”¨å®¹å™¨æ—¶å‘ç”Ÿçš„è¿‡æ¸¡å®Œå…¨ç›¸åŒã€‚ç”±äºæˆ‘ä»¬ä¸å†ä½¿ç”¨åœ¨æ¯ä¸ªè™šæ‹Ÿæœºä¸­è¿è¡Œçš„å®Œå…¨ç‹¬ç«‹çš„æ“ä½œç³»ç»Ÿå‰¯æœ¬ï¼Œè€Œå¼€å§‹ä¸å¤šä¸ªåº”ç”¨ç¨‹åºå…±äº«æ“ä½œç³»ç»Ÿï¼ŒLinux å¿…é¡»å…·æœ‰å¤šç§Ÿæˆ·æ„ŸçŸ¥ã€‚è¿™å°±æ˜¯å‘½åç©ºé—´å’Œ cgroup å­˜åœ¨çš„åŸå› ã€‚å¦‚æœæ²¡æœ‰å®ƒä»¬ï¼Œä¸€ä¸ªå®¹å™¨å¯èƒ½ä¼šæ¶ˆè€—ä¸€ä¸ªç³»ç»Ÿçš„æ‰€æœ‰èµ„æºï¼Œå®¹å™¨å¯èƒ½ä¼šä»¥ä¸å—æ§åˆ¶çš„æ–¹å¼è®¿é—®å¯¹æ–¹çš„æ–‡ä»¶ç³»ç»Ÿã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-envoy-namespace&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Envoy Namespace&#34; srcset=&#34;
               /blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7z3klyfhj31hx0u0djs_hu343c7ddad575180196b4717ceccff05e_154426_4c59051f9b916a64e84a2f5ffc02b30e.webp 400w,
               /blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7z3klyfhj31hx0u0djs_hu343c7ddad575180196b4717ceccff05e_154426_ea1a9152506ca77c4c47844ffafb9563.webp 760w,
               /blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7z3klyfhj31hx0u0djs_hu343c7ddad575180196b4717ceccff05e_154426_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7z3klyfhj31hx0u0djs_hu343c7ddad575180196b4717ceccff05e_154426_4c59051f9b916a64e84a2f5ffc02b30e.webp&#34;
               width=&#34;760&#34;
               height=&#34;423&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      Envoy Namespace
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;å¦‚æœè¿™åœ¨æœåŠ¡ç½‘æ ¼çº§åˆ«çš„ç½‘ç»œèµ„æºä¸Šè¡¨ç°å¾—å®Œå…¨ä¸€æ ·ï¼Œé‚£ä¸æ˜¯å¾ˆå¥½å—ï¼ŸEnvoy å·²ç»æœ‰äº†å‘½åç©ºé—´çš„åˆæ­¥æ¦‚å¿µï¼Œå®ƒä»¬è¢«ç§°ä¸ºç›‘å¬å™¨ã€‚ç›‘å¬å™¨å¯ä»¥æºå¸¦å•ç‹¬çš„é…ç½®å¹¶ç‹¬ç«‹è¿è¡Œã€‚è¿™å°†å¼€å¯å…¨æ–°çš„å¯èƒ½æ€§ï¼šçªç„¶é—´ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°æ§åˆ¶èµ„æºæ¶ˆè€—ï¼Œå»ºç«‹å…¬å¹³çš„æ’é˜Ÿè§„åˆ™ï¼Œå¹¶å°†å¯ç”¨çš„èµ„æºå¹³ç­‰åœ°åˆ†é…ç»™æ‰€æœ‰çš„åº”ç”¨ç¨‹åºï¼Œæˆ–è€…æŒ‰ç…§æŒ‡å®šçš„è§„åˆ™åˆ†é…ã€‚è¿™å¯ä»¥è€Œä¸”åº”è¯¥ä¸æˆ‘ä»¬ä»Šå¤©åœ¨ Kubernetes ä¸­å®šä¹‰åº”ç”¨ç¨‹åºçš„ CPU å’Œå†…å­˜çº¦æŸçš„æ–¹å¼å®Œå…¨ä¸€æ ·ã€‚å¦‚æœä½ æƒ³äº†è§£è¿™ä¸ªè¯é¢˜ï¼Œæˆ‘æ›¾åœ¨ EnvoyCon ä¸Šè®²è¿‡è¿™ä¸ªé—®é¢˜ï¼ˆ&lt;a href=&#34;https://www.youtube.com/watch?v=08opgZkdYIw&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Envoy Namespace - ä»¥æ›´å°çš„ä»£ä»·è¿ç»´åŸºäº Envoy çš„æœåŠ¡ç½‘æ ¼ï¼ŒThomas Grafï¼ŒEnvoyCon 2019&lt;/a&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æƒ³å‚ä¸å…¶ä¸­å—--åŠ å…¥-cilium-æœåŠ¡ç½‘æ ¼æµ‹è¯•ç‰ˆ&#34;&gt;æƒ³å‚ä¸å…¶ä¸­å—ï¼Ÿ- åŠ å…¥ Cilium æœåŠ¡ç½‘æ ¼æµ‹è¯•ç‰ˆ&lt;/h2&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-æµ‹è¯•ç‰ˆ&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;æµ‹è¯•ç‰ˆ&#34; srcset=&#34;
               /blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7wz1obexj327t0u0dkm_huba226543b9600e73651fc49ff93da841_178422_e129888b36894c5dfc6f5bdbaa5f88c3.webp 400w,
               /blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7wz1obexj327t0u0dkm_huba226543b9600e73651fc49ff93da841_178422_5fa12c343403dc5a4a5172ebff80348b.webp 760w,
               /blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7wz1obexj327t0u0dkm_huba226543b9600e73651fc49ff93da841_178422_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/ebpf-solve-service-mesh-sidecar/008i3skNly1gx7wz1obexj327t0u0dkm_huba226543b9600e73651fc49ff93da841_178422_e129888b36894c5dfc6f5bdbaa5f88c3.webp&#34;
               width=&#34;760&#34;
               height=&#34;286&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      æµ‹è¯•ç‰ˆ
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;ä¼´éšç€å³å°†å‘å¸ƒçš„ Cilium 1.11 ç‰ˆæœ¬ï¼ŒCilium ç¤¾åŒºæ­£åœ¨ä¸¾åŠä¸€ä¸ªæ–°çš„ Cilium Service Mesh æµ‹è¯•è®¡åˆ’ã€‚å®ƒçš„ç‰¹ç‚¹æ˜¯ä¸€ä¸ªæ–°çš„æ„å»ºï¼Œå°†ä½¿ä»¥ä¸‹åŠŸèƒ½å¯ç”¨ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;L7 æµé‡ç®¡ç†å’Œè´Ÿè½½å‡è¡¡ï¼ˆHTTPï¼ŒgRPCï¼Œâ€¦ï¼‰&lt;/li&gt;
&lt;li&gt;è·¨é›†ç¾¤ã€äº‘å’Œé›†ç¾¤çš„æ‹“æ‰‘æ„ŸçŸ¥è·¯ç”±&lt;/li&gt;
&lt;li&gt;TLS ç»ˆæ­¢&lt;/li&gt;
&lt;li&gt;é€šè¿‡ Envoy é…ç½®çš„é‡‘ä¸é›€å‘å¸ƒã€é‡è¯•ã€é€Ÿç‡é™åˆ¶ã€æ–­è·¯ç­‰&lt;/li&gt;
&lt;li&gt;ç”¨ OpenTelemetry å’Œ Jaeger é›†æˆè¿›è¡Œè¿½è¸ª&lt;/li&gt;
&lt;li&gt;å†…ç½® Kubernetes Ingress æ”¯æŒ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸Šè¿°æ‰€æœ‰åŠŸèƒ½éƒ½å¯ä»¥åœ¨ &lt;a href=&#34;https://github.com/cilium/cilium&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;github.com/cilium/cilium&lt;/a&gt; åŠŸèƒ½åˆ†æ”¯ä¸­æ‰¾åˆ°ã€‚æµ‹è¯•è®¡åˆ’å…è®¸ Cilium ç»´æŠ¤è€…ç›´æ¥ä¸ç”¨æˆ·æ¥è§¦ï¼Œäº†è§£ä»–ä»¬çš„éœ€æ±‚ã€‚è¦æ³¨å†Œï¼Œä½ å¯ä»¥ç›´æ¥å¡«å†™ &lt;a href=&#34;https://forms.gle/j9fwhAC6HnHRJQKeA&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è¿™ä¸ªè¡¨æ ¼&lt;/a&gt;ï¼Œæˆ–è€…ä½ å¯ä»¥åœ¨ Cilium ç¤¾åŒºçš„&lt;a href=&#34;https://cilium.io/blog/2021/12/01/cilium-service-mesh-beta&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å…¬å‘Š&lt;/a&gt;ä¸­é˜…è¯»æ›´å¤šå…³äºè¯¥è®¡åˆ’çš„ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;eBPF æ˜¯æä¾›æœ¬åœ°å’Œé«˜æ•ˆçš„æœåŠ¡ç½‘æ ¼å®ç°çš„ç­”æ¡ˆã€‚å®ƒå°†æŠŠæˆ‘ä»¬ä» sidecar æ¨¡å‹ä¸­è§£æ”¾å‡ºæ¥ï¼Œå¹¶å…è®¸å°†ç°æœ‰çš„ä»£ç†æŠ€æœ¯æ•´åˆåˆ°ç°æœ‰çš„å†…æ ¸å‘½åæ¦‚å¿µä¸­ï¼Œä½¿å®ƒä»¬æˆä¸ºæˆ‘ä»¬æ¯å¤©éƒ½åœ¨ä½¿ç”¨çš„å®¹å™¨æŠ½è±¡çš„ä¸€éƒ¨åˆ†ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒeBPF å°†èƒ½å¤Ÿå¸è½½è¶Šæ¥è¶Šå¤šçš„ç›®å‰ç”±ä»£ç†æ‰§è¡Œçš„åŠŸèƒ½ï¼Œä»¥è¿›ä¸€æ­¥å‡å°‘å¼€é”€å’Œå¤æ‚æ€§ã€‚é€šè¿‡æ•´åˆå‡ ä¹ä»»ä½•ç°æœ‰çš„ä»£ç†ï¼Œè¯¥æ¶æ„ä¹Ÿå…è®¸ä¸å¤§å¤šæ•°ç°æœ‰çš„æœåŠ¡ç½‘æ ¼æ§åˆ¶å¹³é¢ï¼ˆIstioã€SMIã€Linkerdâ€¦ï¼‰æ•´åˆã€‚è¿™å¯ä»¥å°† eBPF çš„å¥½å¤„æä¾›ç»™å¹¿å¤§çš„ç»ˆç«¯ç”¨æˆ·ï¼ŒåŒæ—¶å°†æ•°æ®é€šè·¯çš„æ•ˆç‡å’Œå¼€é”€çš„è®¨è®ºä¸æ§åˆ¶å¹³é¢æ–¹é¢ç›¸åˆ†ç¦»ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ æœ‰å…´è¶£æ¢ç´¢è¿™ä¸ªè¯é¢˜ï¼Œæˆ‘ä»¬å¾ˆæƒ³å¬åˆ°ä½ çš„æ„è§ã€‚è¯·éšæ—¶é€šè¿‡ &lt;a href=&#34;https://twitter.com/tgraf__&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Twitter&lt;/a&gt; æˆ– &lt;a href=&#34;http://ebpf.io/slack&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;eBPF &amp;amp; Cilium Slack è”ç³»æˆ‘ä»¬&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;è¿›ä¸€æ­¥é˜…è¯»&#34;&gt;è¿›ä¸€æ­¥é˜…è¯»&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://lib.jimmysong.io/blog/how-ebpf-streamlines-the-service-mesh/&#34;&gt;eBPF å¦‚ä½•ç®€åŒ–æœåŠ¡ç½‘æ ¼&lt;/a&gt;ï¼ŒLiz Riceï¼ŒThe New Stack&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://cilium.io/blog/2021/12/01/cilium-service-mesh-beta&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Cilium æœåŠ¡ç½‘æ ¼æµ‹è¯•è®¡åˆ’&lt;/a&gt;ï¼ŒCilium ç¤¾åŒº&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://cilium.io/learn&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;äº†è§£æ›´å¤šå…³äº Cilium çš„ä¿¡æ¯&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>Istio 1.12 å¼•å…¥ Wasm æ’ä»¶é…ç½® API ç”¨äºæ‰©å±• Istio ç”Ÿæ€</title>
      <link>https://lib.jimmysong.io/blog/istio-wasm-extensions-and-ecosystem/</link>
      <pubDate>Wed, 24 Nov 2021 18:03:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/istio-wasm-extensions-and-ecosystem/</guid>
      <description>&lt;h2 id=&#34;å‰è¨€&#34;&gt;å‰è¨€&lt;/h2&gt;
&lt;p&gt;Istio 1.12 ä¸­æ–°çš„ WebAssembly åŸºç¡€è®¾æ–½ä½¿å…¶èƒ½å¤Ÿè½»æ¾åœ°å°†é¢å¤–çš„åŠŸèƒ½æ³¨å…¥ç½‘æ ¼éƒ¨ç½²ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;ç»è¿‡ä¸‰å¹´çš„åŠªåŠ›ï¼ŒIstio ç°åœ¨æœ‰äº†ä¸€ä¸ªå¼ºå¤§çš„æ‰©å±•æœºåˆ¶ï¼Œå¯ä»¥å°†è‡ªå®šä¹‰å’Œç¬¬ä¸‰æ–¹ Wasm æ¨¡å—æ·»åŠ åˆ°ç½‘æ ¼ä¸­çš„ sidecarã€‚Tetrate å·¥ç¨‹å¸ˆ&lt;a href=&#34;https://github.com/mathetake&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç±³ç”°æ­¦ï¼ˆTakeshi Yonedaï¼‰&lt;/a&gt;å’Œ&lt;a href=&#34;https://github.com/lizan&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å‘¨ç¤¼èµï¼ˆLizan Zhouï¼‰&lt;/a&gt;åœ¨å®ç°è¿™ä¸€ç›®æ ‡æ–¹é¢å‘æŒ¥äº†é‡è¦ä½œç”¨ã€‚è¿™ç¯‡æ–‡ç« å°†ä»‹ç» Istio ä¸­ Wasm çš„åŸºç¡€çŸ¥è¯†ï¼Œä»¥åŠä¸ºä»€ä¹ˆå®ƒå¾ˆé‡è¦ï¼Œç„¶åæ˜¯å…³äºå»ºç«‹è‡ªå·±çš„ Wasm æ’ä»¶å¹¶å°†å…¶éƒ¨ç½²åˆ°ç½‘æ ¼çš„ç®€çŸ­æ•™ç¨‹ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä¸ºä»€ä¹ˆ-istio-ä¸­çš„-wasm-å¾ˆé‡è¦&#34;&gt;ä¸ºä»€ä¹ˆ Istio ä¸­çš„ Wasm å¾ˆé‡è¦&lt;/h2&gt;
&lt;p&gt;ä½¿ç”¨ Wasmï¼Œå¼€å‘äººå‘˜å¯ä»¥æ›´å®¹æ˜“çš„æ‰©å±•ç½‘æ ¼å’Œç½‘å…³ã€‚åœ¨ Tetrateï¼Œæˆ‘ä»¬ç›¸ä¿¡è¿™é¡¹æŠ€æœ¯æ­£åœ¨è¿…é€Ÿæˆç†Ÿï¼Œå› æ­¤æˆ‘ä»¬ä¸€ç›´åœ¨æŠ•èµ„ä¸Šæ¸¸çš„ Istioï¼Œä½¿é…ç½® APIã€åˆ†å‘æœºåˆ¶å’Œä» Go å¼€å§‹çš„å¯æ‰©å±•æ€§ä½“éªŒæ›´åŠ å®¹æ˜“ã€‚æˆ‘ä»¬è®¤ä¸ºè¿™å°†ä½¿ Istio æœ‰ä¸€ä¸ªå…¨æ–°çš„æ–¹å‘ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æœ‰ä½•æœŸå¾…æ–°çš„æ’ä»¶é…ç½®-apiå¯é çš„è·å–å’Œå®‰è£…æœºåˆ¶&#34;&gt;æœ‰ä½•æœŸå¾…ï¼šæ–°çš„æ’ä»¶é…ç½® APIï¼Œå¯é çš„è·å–å’Œå®‰è£…æœºåˆ¶&lt;/h2&gt;
&lt;p&gt;æœ‰ä¸€ä¸ªæ–°çš„é¡¶çº§ APIï¼Œå«åš &lt;a href=&#34;https://istio.io/latest/docs/reference/config/proxy_extensions/wasm-plugin/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;WasmPlugin&lt;/a&gt;ï¼Œå¯ä»¥è®©ä½ é…ç½®è¦å®‰è£…å“ªäº›æ’ä»¶ï¼Œä»å“ªé‡Œè·å–å®ƒä»¬ï¼ˆOCI é•œåƒã€å®¹å™¨æœ¬åœ°æ–‡ä»¶æˆ–è¿œç¨‹ HTTP èµ„æºï¼‰ï¼Œåœ¨å“ªé‡Œå®‰è£…å®ƒä»¬ï¼ˆé€šè¿‡ &lt;a href=&#34;https://istio.io/latest/docs/reference/config/type/workload-selector/#WorkloadSelector&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Workload é€‰æ‹©å™¨&lt;/a&gt;ï¼‰ï¼Œä»¥åŠä¸€ä¸ªé…ç½®ç»“æ„ä½“æ¥ä¼ é€’ç»™æ’ä»¶å®ä¾‹ã€‚&lt;/p&gt;
&lt;p&gt;istio-agent ä¸­çš„é•œåƒæå–æœºåˆ¶ï¼ˆåœ¨ Istio 1.9 ä¸­å¼•å…¥ï¼‰ï¼Œä»è¿œç¨‹ HTTP æºå¯é åœ°æ£€ç´¢ Wasm äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå·²è¢«æ‰©å±•åˆ°æ”¯æŒä»ä»»ä½• OCI æ³¨å†Œå¤„æ£€ç´¢ Wasm OCI é•œåƒï¼ŒåŒ…æ‹¬ Docker Hubã€Google Container Registryï¼ˆGCRï¼‰ã€Amazon Elastic Container Registryï¼ˆAmazon ECRï¼‰å’Œå…¶ä»–åœ°æ–¹ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ„å‘³ç€ä½ å¯ä»¥åˆ›å»ºè‡ªå·±çš„ Wasm æ’ä»¶ï¼Œæˆ–è€…ä»ä»»ä½•æ³¨å†Œå¤„é€‰æ‹©ç°æˆçš„æ’ä»¶ï¼Œåªéœ€å‡ è¡Œé…ç½®å°±å¯ä»¥æ‰©å±• Istio çš„åŠŸèƒ½ã€‚Istio ä¼šåœ¨å¹•ååšæ‰€æœ‰çš„å·¥ä½œï¼Œä¸ºä½ è·å–ã€éªŒè¯ã€å®‰è£…å’Œé…ç½®å®ƒä»¬ã€‚&lt;/p&gt;
&lt;h2 id=&#34;istio-wasm-æ‰©å±•&#34;&gt;Istio Wasm æ‰©å±•&lt;/h2&gt;
&lt;p&gt;Istio çš„æ‰©å±•æœºåˆ¶ä½¿ç”¨ &lt;a href=&#34;https://github.com/proxy-wasm/spec&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Proxy-Wasm åº”ç”¨äºŒè¿›åˆ¶æ¥å£ï¼ˆABIï¼‰&lt;/a&gt;è§„èŒƒï¼Œè¯¥è§„èŒƒç”±å‘¨ç¤¼èµå’Œç±³ç”°æ­¦å¸¦å¤´åˆ¶å®šï¼Œæä¾›äº†ä¸€å¥—ä»£ç†æ— å…³çš„æµåª’ä½“ API å’Œå®ç”¨åŠŸèƒ½ï¼Œå¯ä»¥ç”¨ä»»ä½•æœ‰åˆé€‚ SDK çš„è¯­è¨€æ¥å®ç°ã€‚æˆªè‡³ç›®å‰ï¼ŒProxy-Wasm çš„ SDK æœ‰ AssemblyScriptï¼ˆç±»ä¼¼ TypeScriptï¼‰ã€C++ã€Rustã€Zig å’Œ Goï¼ˆä½¿ç”¨ TinyGo WebAssembly ç³»ç»Ÿæ¥å£ã€ŒWASIã€ï¼Œç±³ç”°æ­¦ä¹Ÿæ˜¯å…¶ä¸»è¦è´¡çŒ®è€…ï¼‰ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å¦‚ä½•è·å–tetrate-istio-distro&#34;&gt;å¦‚ä½•è·å–ï¼šTetrate Istio Distro&lt;/h2&gt;
&lt;p&gt;è·å¾— Istio çš„æœ€ç®€å•æ–¹æ³•æ˜¯ä½¿ç”¨ Tetrate çš„å¼€æº &lt;a href=&#34;https://istio.tetratelabs.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;code&gt;get-mesh&lt;/code&gt; CLI å’Œ Tetrate Istio Distro&lt;/a&gt;ï¼Œè¿™æ˜¯ä¸€ä¸ªç®€å•ã€å®‰å…¨çš„ä¸Šæ¸¸ Istio çš„ä¼ä¸šçº§å‘è¡Œç‰ˆã€‚&lt;/p&gt;
&lt;h2 id=&#34;wasm-å®æˆ˜æ„å»ºä½ è‡ªå·±çš„é€Ÿç‡é™åˆ¶-webassembly-æ’ä»¶&#34;&gt;Wasm å®æˆ˜ï¼šæ„å»ºä½ è‡ªå·±çš„é€Ÿç‡é™åˆ¶ WebAssembly æ’ä»¶&lt;/h2&gt;
&lt;p&gt;åœ¨æˆ‘ä»¬ä¹‹å‰å…³äº &lt;a href=&#34;https://www.tetrate.io/blog/wasm-modules-and-envoy-extensibility-explained-part-1/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Envoy ä¸­çš„ Wasm æ‰©å±•&lt;/a&gt;çš„åšå®¢ä¸­ï¼Œæˆ‘ä»¬å±•ç¤ºäº†å¦‚ä½•å¼€å‘ WebAssembly æ’ä»¶æ¥å¢å¼ºæœåŠ¡ç½‘æ ¼çš„èƒ½åŠ›ã€‚æ–°çš„ Wasm æ‰©å±• API è®©å®ƒå˜å¾—æ›´åŠ ç®€å•ã€‚æœ¬æ•™ç¨‹å°†è§£é‡Šå¦‚ä½•ä½¿ç”¨ Istio Wasm æ‰©å±• API æ¥å®ç° Golang ä¸­çš„é€Ÿç‡é™åˆ¶ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å…ˆå†³æ¡ä»¶&#34;&gt;å…ˆå†³æ¡ä»¶&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ç†Ÿæ‚‰ &lt;a href=&#34;https://www.tetrate.io/blog/wasm-modules-and-envoy-extensibility-explained-part-1/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Istio å’Œ Envoy ä¸­çš„ Wasm&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å®‰è£… &lt;a href=&#34;https://tinygo.org/getting-started/install/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;TinyGo 0.21.0&lt;/a&gt; å¹¶ä½¿ç”¨ Golang æ„å»º Wasm æ‰©å±•ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;è¯´æ˜&#34;&gt;è¯´æ˜&lt;/h3&gt;
&lt;p&gt;åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†åœ¨é›†ç¾¤ä¸­éƒ¨ç½²ä¸¤ä¸ªåº”ç”¨ç¨‹åºï¼ˆsleep å’Œ httpbinï¼‰ã€‚æˆ‘ä»¬å°†ä»ä¸€ä¸ªå®¹å™¨å‘å¦ä¸€ä¸ªå®¹å™¨å‘é€å‡ ä¸ªè¯·æ±‚ï¼Œè€Œä¸éƒ¨ç½²ä»»ä½• Wasm æ‰©å±•ã€‚&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†åœ¨ Go ä¸­åˆ›å»ºä¸€ä¸ª Wasm æ¨¡å—ï¼Œä¸ºå“åº”æ·»åŠ ä¸€ä¸ªè‡ªå®šä¹‰å¤´ï¼Œå¹¶æ‹’ç»ä»»ä½•è¯·æ±‚ç‡è¶…è¿‡æ¯ç§’ä¸¤ä¸ªçš„è¯·æ±‚ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å°†æŠŠ Wasm æ¨¡å—æ¨é€åˆ° Docker é•œåƒä»“åº“ï¼Œå¹¶ä½¿ç”¨æ–°çš„ WasmPlugin èµ„æºï¼Œå‘Šè¯‰ Istio ä»å“ªé‡Œä¸‹è½½ Wasm æ¨¡å—ï¼Œä»¥åŠå°†è¯¥æ¨¡å—åº”ç”¨äºå“ªäº›å·¥ä½œè´Ÿè½½ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ç¬¬-1-æ­¥å®‰è£…-istio-å¹¶éƒ¨ç½²åº”ç”¨ç¨‹åº&#34;&gt;ç¬¬ 1 æ­¥ï¼šå®‰è£… Istio å¹¶éƒ¨ç½²åº”ç”¨ç¨‹åº&lt;/h3&gt;
&lt;p&gt;é¦–å…ˆï¼Œæˆ‘ä»¬å°†ä¸‹è½½å¹¶å®‰è£… Istio 1.12ï¼Œå¹¶æ ‡è®° Kubernetes çš„ default å‘½åç©ºé—´ï¼Œä»¥ä¾¿è‡ªåŠ¨æ³¨å…¥ sidecarã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;curl -L https://git.io/getLatestIstio &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;ISTIO_VERSION&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;1.12 sh
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; istio-1.12/
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;./bin/istioctl install --set &lt;span class=&#34;nv&#34;&gt;profile&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;demo -y
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl label namespace default istio-injection&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;enabled --overwrite
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†éƒ¨ç½² httpbin å’Œ sleep åº”ç”¨ç¨‹åºçš„ç¤ºä¾‹ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl apply -f samples/httpbin/httpbin.yaml
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;kubectl apply -f samples/sleep/sleep.yaml
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åº”ç”¨ç¨‹åºéƒ¨ç½²å¹¶è¿è¡Œåï¼Œæˆ‘ä»¬å°†æ¯ç§’ä» &lt;strong&gt;sleep&lt;/strong&gt; å®¹å™¨å‘ &lt;strong&gt;httpbin&lt;/strong&gt; å®¹å™¨å‘é€ 4 ä¸ªè¯·æ±‚ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ &lt;span class=&#34;nv&#34;&gt;SLEEP_POD&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;kubectl get pod -l &lt;span class=&#34;nv&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;sleep -o &lt;span class=&#34;nv&#34;&gt;jsonpath&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;={&lt;/span&gt;.items..metadata.name&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ kubectl &lt;span class=&#34;nb&#34;&gt;exec&lt;/span&gt; &lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;SLEEP_POD&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt; -c sleep -- sh -c &lt;span class=&#34;s1&#34;&gt;&amp;#39;for i in $(seq 1 3); do curl --head -s httpbin:8000/headers; sleep 0.25; done&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;HTTP/1.1 &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;server: envoy
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;date: Tue, &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; Nov &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; 22:18:32 GMT
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;content-type: application/json
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;content-length: &lt;span class=&#34;m&#34;&gt;523&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;access-control-allow-origin: *
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;access-control-allow-credentials: &lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;x-envoy-upstream-service-time: &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;HTTP/1.1 &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;server: envoy
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;date: Tue, &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; Nov &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; 22:18:32 GMT
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;content-type: application/json
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;content-length: &lt;span class=&#34;m&#34;&gt;523&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;access-control-allow-origin: *
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;access-control-allow-credentials: &lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;x-envoy-upstream-service-time: &lt;span class=&#34;m&#34;&gt;4&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;HTTP/1.1 &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;server: envoy
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;date: Tue, &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; Nov &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; 22:18:32 GMT
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;content-type: application/json
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;content-length: &lt;span class=&#34;m&#34;&gt;523&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;access-control-allow-origin: *
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;access-control-allow-credentials: &lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;x-envoy-upstream-service-time: &lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä½ ä¼šå‘ç°æ‰€æœ‰çš„è¯·æ±‚éƒ½æˆåŠŸäº†ï¼Œå¹¶è¿”å›äº† HTTP 200ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ç¬¬-2-æ­¥å¼€å‘ç¼–è¯‘å’Œæ¨é€-wasm-æ¨¡å—&#34;&gt;ç¬¬ 2 æ­¥ï¼šå¼€å‘ã€ç¼–è¯‘å’Œæ¨é€ Wasm æ¨¡å—&lt;/h3&gt;
&lt;p&gt;æˆ‘ä»¬å°†ä½¿ç”¨ Golang å’Œ Proxy Wasm Golang SDK æ¥å¼€å‘ Wasm æ¨¡å—ã€‚æˆ‘ä»¬å°†ä½¿ç”¨ SDK èµ„æºåº“ä¸­çš„ä¸€ä¸ªç°æœ‰ä¾‹å­ï¼Œå«åš istio-rate-limitingã€‚è¦å¼€å§‹ï¼Œè¯·å…ˆå…‹éš† Github ä»“åº“ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;git clone https://github.com/tetratelabs/wasm-rate-limiting
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; wasm-rate-limiting/
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æˆ‘ä»¬æ¥çœ‹çœ‹ &lt;code&gt;main.go&lt;/code&gt; ä¸­çš„ä»£ç ã€‚è¿™å°±æ˜¯æˆ‘ä»¬ä½¿ç”¨ Proxy Wasm Golang SDK å®ç°é€Ÿç‡é™åˆ¶é€»è¾‘çš„åœ°æ–¹ã€‚Wasm æ¨¡å—åšäº†ä¸¤ä»¶äº‹ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åœ¨å“åº”ä¸­æ·»åŠ ä¸€ä¸ªè‡ªå®šä¹‰çš„å¤´ã€‚&lt;/li&gt;
&lt;li&gt;æ‰§è¡Œ 2 ä¸ªè¯·æ±‚ / ç§’çš„é€Ÿç‡é™åˆ¶ï¼Œæ‹’ç»è¶…é¢çš„è¯·æ±‚ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸‹é¢æ˜¯ &lt;code&gt;main.go&lt;/code&gt; çš„ç‰‡æ®µï¼Œæ˜¾ç¤ºäº†åŠŸèƒ½æ˜¯å¦‚ä½•å®ç°çš„ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// Modify the header
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ctx&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;httpHeaders&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;OnHttpResponseHeaders&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;numHeaders&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;endOfStream&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;bool&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;types&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Action&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;value&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;range&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;additionalHeaders&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;nx&#34;&gt;proxywasm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;AddHttpResponseHeader&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;key&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;types&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ActionContinue&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// Perform rate limiting
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ctx&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;httpHeaders&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;OnHttpRequestHeaders&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;int&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;kt&#34;&gt;bool&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;types&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;Action&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;current&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;time&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Now&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;UnixNano&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;c1&#34;&gt;// We use nanoseconds() rather than time.Second() because the proxy-wasm has the known limitation.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;c1&#34;&gt;// TODO(incfly): change to time.Second() once https://github.com/proxy-wasm/proxy-wasm-cpp-host/issues/199
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;c1&#34;&gt;// is resolved and released.
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;current&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ctx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;pluginContext&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;lastRefillNanoSec&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mf&#34;&gt;1e9&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;nx&#34;&gt;ctx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;pluginContext&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;remainToken&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;nx&#34;&gt;ctx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;pluginContext&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;lastRefillNanoSec&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;current&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;proxywasm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;LogCriticalf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;Current time %v, last refill time %v, the remain token %v&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;nx&#34;&gt;current&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ctx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;pluginContext&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;lastRefillNanoSec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ctx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;pluginContext&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;remainToken&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ctx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;pluginContext&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;remainToken&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;proxywasm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;SendHttpResponse&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;403&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[][&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;powered-by&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;proxy-wasm-go-sdk!!&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;},&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;p&#34;&gt;},&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;byte&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;rate limited, wait and retry.&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;nil&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;nx&#34;&gt;proxywasm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;LogErrorf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;failed to send local response: %v&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;			&lt;span class=&#34;nx&#34;&gt;proxywasm&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;ResumeHttpRequest&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;		&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;types&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ActionPause&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;nx&#34;&gt;ctx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;pluginContext&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;remainToken&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;	&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;types&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ActionContinue&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åœ¨ &lt;code&gt;OnHttpResponseHeaders&lt;/code&gt; å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬æ­£åœ¨è¿­ä»£ &lt;code&gt;extraHeaders&lt;/code&gt; å˜é‡ï¼Œå¹¶å°†å¤´æ–‡ä»¶æ·»åŠ åˆ°å“åº”ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ &lt;code&gt;OnHttpRequestHeaders&lt;/code&gt; å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬å¾—åˆ°å½“å‰çš„æ—¶é—´æˆ³ï¼Œå°†å…¶ä¸æœ€åä¸€æ¬¡è¡¥ç»™æ—¶é—´çš„æ—¶é—´æˆ³è¿›è¡Œæ¯”è¾ƒï¼ˆå¯¹äºé€Ÿç‡é™åˆ¶å™¨ï¼‰ï¼Œå¦‚æœéœ€è¦çš„è¯ï¼Œå°±è¡¥ç»™ä»¤ç‰Œã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæ²¡æœ‰å‰©ä½™çš„ä»¤ç‰Œï¼Œæˆ‘ä»¬å°±å‘é€ä¸€ä¸ªå¸¦æœ‰é¢å¤–å¤´çš„ 403 å“åº”ï¼ˆ&lt;strong&gt;powered-by: proxy-wasm-go-sdk!!&lt;/strong&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;è®©æˆ‘ä»¬ç”¨ tinygo å°† Golang ç¨‹åºç¼–è¯‘æˆ Wasm æ¨¡å—ï¼Œå¹¶å°†å…¶æ‰“åŒ…æˆä¸€ä¸ª Docker é•œåƒã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;tinygo build -o main.wasm -scheduler&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;none -target&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;wasi main.go
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç¼–å†™ Dockfileï¼Œå°†ç¼–è¯‘å‡ºæ¥çš„ Wasm æ¨¡å—æ·»åŠ åˆ° Docker é•œåƒä¸­ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-dockerfile&#34; data-lang=&#34;dockerfile&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;FROM&lt;/span&gt;&lt;span class=&#34;s&#34;&gt; scratch&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;ADD&lt;/span&gt; main.wasm .&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;err&#34;&gt;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;CMD&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;main.wasm&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;alert-note-title&#34;&gt;
    &lt;p&gt;è¯‘è€…æ³¨&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;alert alert-note&#34;&gt;
    åŸæ–‡ä¸­æ¼æ‰äº†åˆ›å»º Dockerfile è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬ç›´æ¥ä» scratch åˆ›å»ºé•œåƒï¼Œå¯ä»¥ä¿è¯é•œåƒæœ€å°åŒ–ã€‚
&lt;/div&gt;

&lt;p&gt;æ„å»º Docker é•œåƒï¼Œå¹¶å°†å…¶æ¨é€åˆ°é•œåƒä»“åº“ï¼ˆç”¨ä½ è‡ªå·±çš„ Docker é•œåƒä»“åº“å’Œé•œåƒåç§°æ›¿æ¢ &lt;code&gt;${YOUR_DOCKER_REGISTRY_IMAGE}&lt;/code&gt;ï¼‰ã€‚åœ¨è¿™ä¹‹åï¼Œä½ çš„ Wasm æ’ä»¶å°±å¯ä»¥åœ¨ä½ çš„æœåŠ¡ç½‘æ ¼ä¸­ä½¿ç”¨äº†ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker build -t &lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;YOUR_DOCKER_REGISTRY_IMAGE&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;:v1 .
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;docker push -t &lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;YOUR_DOCKER_REGISTRY_IMAGE&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;:v1 
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¦å¤–ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸€ä¸ªé¢„æ„å»ºçš„ Docker é•œåƒï¼Œå®ƒæœ‰ç›¸åŒçš„ä»£ç ï¼Œä½äº &lt;a href=&#34;http://ghcr.io/tetratelabs/wasm-rate-limiting:v1&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ghcr.io/tetratelabs/wasm-rate-limiting:v1&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ç¬¬-3-æ­¥é…ç½®-istio-wasm-æ‰©å±•-api&#34;&gt;ç¬¬ 3 æ­¥ï¼šé…ç½® Istio Wasm æ‰©å±• API&lt;/h3&gt;
&lt;p&gt;Istio Wasm Extension API å’Œæ–°çš„ WasmPlugin èµ„æºå…è®¸æˆ‘ä»¬å°†æˆ‘ä»¬æ¨é€åˆ° Docker é•œåƒä»“åº“çš„é€Ÿç‡é™åˆ¶ Wasm æ¨¡å—æ·»åŠ åˆ° httpbin å·¥ä½œè´Ÿè½½ä¸­ã€‚ä¸‹é¢æ˜¯ WasmPlugin èµ„æºçš„ YAML é…ç½®ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;extensions.istio.io/v1alpha1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;WasmPlugin&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;httpbin-rate-limiting&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;default&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;selector&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;matchLabels&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;httpbin&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;url&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;oci://ghcr.io/tetratelabs/wasm-rate-limiting:v1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™ä¸ªé…ç½®éƒ¨ç½²åï¼ŒIstiod å°±ä¼šæŠŠç›¸åº”çš„é…ç½®æ¨é€åˆ° Envoy sidecarï¼ˆä¸æˆ‘ä»¬åœ¨ &lt;code&gt;matchLabels&lt;/code&gt; å­—æ®µä¸­æŒ‡å®šçš„æ ‡ç­¾ç›¸åŒ¹é…çš„é‚£äº›ï¼‰ã€‚Sidecar ä¸­çš„ Istio ä»£ç†å°†æ‰§è¡Œè¿œç¨‹è·å–ï¼Œä¸‹è½½æˆ‘ä»¬åˆšåˆšæ¨é€çš„ Wasm æ¨¡å—ï¼Œç„¶åå°†å…¶åŠ è½½åˆ° Envoy è¿è¡Œæ—¶çš„ Wasm å¼•æ“ä¸­æ‰§è¡Œã€‚&lt;/p&gt;
&lt;p&gt;è®©æˆ‘ä»¬æŠŠä¸Šè¿° YAML ä¿å­˜ä¸º wasm.yamlï¼Œå¹¶å°†å…¶éƒ¨ç½²åˆ°é›†ç¾¤ä¸­ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ kubectl apply -f ./wasm.yaml
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;wasmplugin.extensions.istio.io/httpbin-rate-limiting created
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;ç¬¬-4-æ­¥éªŒè¯é€Ÿç‡é™åˆ¶çš„æ•ˆæœ&#34;&gt;ç¬¬ 4 æ­¥ï¼šéªŒè¯é€Ÿç‡é™åˆ¶çš„æ•ˆæœ&lt;/h3&gt;
&lt;p&gt;åœ¨æˆ‘ä»¬éƒ¨ç½²äº† WasmPlugin èµ„æºå’Œ Istio ä»æ³¨å†Œè¡¨ä¸­è·å–äº† Wasm æ¨¡å—åï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥éªŒè¯ Wasm æ’ä»¶ä¸­å®ç°çš„é€Ÿç‡é™åˆ¶æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ &lt;span class=&#34;nv&#34;&gt;SLEEP_POD&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;kubectl get pod -l &lt;span class=&#34;nv&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;sleep -o &lt;span class=&#34;nv&#34;&gt;jsonpath&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;={&lt;/span&gt;.items..metadata.name&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ kubectl &lt;span class=&#34;nb&#34;&gt;exec&lt;/span&gt; &lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;SLEEP_POD&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt; -c sleep -- sh -c &lt;span class=&#34;s1&#34;&gt;&amp;#39;for i in $(seq 1 3); do curl --head -s httpbin:8000/headers; sleep 0.25; done&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;HTTP/1.1 &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;server: envoy
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;date: Tue, &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; Nov &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; 22:16:34 GMT
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;content-type: application/json
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;content-length: &lt;span class=&#34;m&#34;&gt;523&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;access-control-allow-origin: *
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;access-control-allow-credentials: &lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;x-envoy-upstream-service-time: &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;who-am-i: wasm-extension
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;injected-by: istio-api!
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;HTTP/1.1 &lt;span class=&#34;m&#34;&gt;200&lt;/span&gt; OK
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;server: envoy
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;date: Tue, &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; Nov &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; 22:16:35 GMT
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;content-type: application/json
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;content-length: &lt;span class=&#34;m&#34;&gt;523&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;access-control-allow-origin: *
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;access-control-allow-credentials: &lt;span class=&#34;nb&#34;&gt;true&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;x-envoy-upstream-service-time: &lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;who-am-i: wasm-extension
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;injected-by: istio-api!
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;HTTP/1.1 &lt;span class=&#34;m&#34;&gt;403&lt;/span&gt; Forbidden
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;powered-by: proxy-wasm-go-sdk!!
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;content-length: &lt;span class=&#34;m&#34;&gt;29&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;content-type: text/plain
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;who-am-i: wasm-extension
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;injected-by: istio-api!
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;date: Tue, &lt;span class=&#34;m&#34;&gt;16&lt;/span&gt; Nov &lt;span class=&#34;m&#34;&gt;2021&lt;/span&gt; 22:16:35 GMT
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;server: envoy
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;x-envoy-upstream-service-time: &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å°±åƒä»¥å‰ä¸€æ ·ï¼Œæˆ‘ä»¬ä» sleep å®¹å™¨å‘ httpbin å®¹å™¨å‘é€ 3 ä¸ªè¯·æ±‚ã€‚è¿™ä¸€æ¬¡ï¼ŒWasm æ’ä»¶ä»£ç è¢«æ‰§è¡Œï¼Œæˆ‘ä»¬å¯ä»¥æ³¨æ„åˆ°è¾“å‡ºä¸­çš„ä¸€äº›å·®å¼‚ã€‚é¦–å…ˆï¼Œ&lt;code&gt;who-am-i&lt;/code&gt; å¤´è¢« Wasm æ’ä»¶æ³¨å…¥äº†ã€‚å‰ä¸¤ä¸ªè¯·æ±‚ä»¥ HTTP 200 çš„å“åº”ä»£ç æˆåŠŸï¼Œå‰©ä¸‹çš„è¯·æ±‚åˆ™ä»¥ HTTP 429 å¤±è´¥ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬å¯ä»¥æ³¨æ„åˆ°ä¸€ä¸ªåä¸º &lt;code&gt;powered-by&lt;/code&gt; çš„é¢å¤–å¤´ï¼Œå®ƒä¹Ÿè¢« Wasm æ’ä»¶æ³¨å…¥äº†ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ•™ç¨‹æ‘˜è¦&#34;&gt;æ•™ç¨‹æ‘˜è¦&lt;/h2&gt;
&lt;p&gt;æ€»è€Œè¨€ä¹‹ï¼Œæœ¬æ•™ç¨‹æ¼”ç¤ºäº†å¦‚ä½•è½»æ¾å®ç°æ’ä»¶åŠŸèƒ½ï¼Œä»¥æ‰©å±• Istio çš„åŠŸèƒ½ï¼Œæ»¡è¶³ä½ çš„ç‰¹å®šéœ€æ±‚ã€‚è¿™éœ€è¦ä¸‰ä¸ªæ­¥éª¤ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åœ¨ Golang ä¸­å®ç°ä½ çš„æ’ä»¶åŠŸèƒ½ã€‚&lt;/li&gt;
&lt;li&gt;ç¼–è¯‘ã€æ„å»ºï¼Œå¹¶å°† Wasm æ¨¡å—æ¨é€åˆ°ç¬¦åˆ OCI æ ‡å‡†çš„ Docker é•œåƒä»“åº“ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨ WasmPlugin èµ„æºé…ç½®æœåŠ¡ç½‘æ ¼å·¥ä½œè´Ÿè½½ï¼Œä»¥ä¾¿ä»è¿œç¨‹é•œåƒä»“åº“ä¸­æ‹‰å– Wasm æ¨¡å—ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è¯¥æ•™ç¨‹å®ç°äº†ä¸€ä¸ªå•ä¸€çš„ Wasm æ’ä»¶æ¥å¤„ç† HTTP è¯·æ±‚ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œä½ å¯ä»¥æœ‰å¤šä¸ª Wasm æ’ä»¶ï¼Œæ¯ä¸ªå•ç‹¬çš„æ’ä»¶è´Ÿè´£æŸä¸€éƒ¨åˆ†çš„åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œ&lt;a href=&#34;https://github.com/istio/api/blob/master/extensions/v1alpha1/wasm.proto#L254&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;AUTHN&lt;/a&gt; é˜¶æ®µçš„ä¸€ä¸ªæ’ä»¶è·å–æˆ–éªŒè¯è®¤è¯å‡­è¯ï¼›&lt;a href=&#34;https://github.com/istio/api/blob/master/extensions/v1alpha1/wasm.proto#L257&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;AUTHZ&lt;/a&gt; é˜¶æ®µçš„å¦ä¸€ä¸ªæ’ä»¶å®ç°ä½ è‡ªå·±å®šåˆ¶çš„æˆæƒé€»è¾‘ï¼Œç­‰ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;Istio Wasm æ‰©å±•è¿˜å…è®¸æˆ‘ä»¬ç”Ÿæˆæ’ä»¶æŒ‡æ ‡ï¼Œæˆ–åœ¨å¤šä¸ª Wasm æ’ä»¶ä¸­æ±‡æ€»ã€‚è¯¥æ’ä»¶æä¾›äº†ä¸€ä¸ªæ—¥å¿—åŠŸèƒ½ï¼Œå…è®¸æˆ‘ä»¬å°†æ—¥å¿—ä¿¡æ¯å†™åˆ° Envoy sidecarã€‚è¿™å¯¹ Wasm æ’ä»¶çš„è°ƒè¯•å’Œå¼€å‘ç‰¹åˆ«æœ‰å¸®åŠ©ã€‚&lt;/p&gt;
&lt;p&gt;ç›®å‰çš„ Istio Wasm API å¤„äº alpha é˜¶æ®µï¼Œå°†åœ¨æœªæ¥çš„ Istio ç‰ˆæœ¬ä¸­å¾—åˆ°å¢å¼ºå’Œç¨³å®šã€‚è¿™åŒ…æ‹¬é€šè¿‡éªŒè¯ç­¾åæ¥å®‰å…¨åœ°éªŒè¯ Wasm æ’ä»¶æœ¬èº«ï¼Œæ”¯æŒç”¨å­˜å‚¨ä¸º Kubernetes Secret çš„ç§˜å¯†æ¥æ‹‰å– Wasm æ’ä»¶ç­‰ã€‚&lt;/p&gt;
&lt;h2 id=&#34;è¿›ä¸€æ­¥é˜…è¯»å’Œè¡¥å……èµ„æº&#34;&gt;è¿›ä¸€æ­¥é˜…è¯»å’Œè¡¥å……èµ„æº&lt;/h2&gt;
&lt;p&gt;åœ¨ Tetrateï¼Œæˆ‘ä»¬æ­£åœ¨åŠªåŠ›æ”¹å–„å¼€å‘è€…çš„ä½“éªŒï¼Œ&lt;a href=&#34;https://github.com/tetratelabs/proxy-wasm-go-sdk/tree/main/examples&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;tetratelabs/proxy-wasm-golang-sdk&lt;/a&gt; åŒ…å«æœ¬æ•™ç¨‹ä½¿ç”¨çš„ Golang SDK åº“ã€‚ä½ å¯ä»¥æ‰¾åˆ°æ›´å¤šçš„ä¾‹å­ï¼Œå¦‚ http &lt;a href=&#34;https://github.com/tetratelabs/proxy-wasm-go-sdk/blob/main/examples/http_routing/main.go#L70-L80&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¤´çš„æ“ä½œ&lt;/a&gt;ã€æ ·ä¾‹&lt;a href=&#34;https://github.com/tetratelabs/proxy-wasm-go-sdk/tree/main/examples/http_auth_random&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æˆæƒ&lt;/a&gt;ã€&lt;a href=&#34;https://github.com/tetratelabs/proxy-wasm-go-sdk/tree/main/examples/http_routing&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ”¹å˜è·¯ç”±&lt;/a&gt;è¡Œä¸ºç­‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://istio.tetratelabs.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tetrate Istio Distro&lt;/a&gt; æ˜¯å®‰è£…ã€æ“ä½œå’Œå‡çº§ Istio çš„æœ€ç®€å•æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.tetrate.io/istio-wasm-workshop/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æŠ¥åå‚åŠ  Tetrate çš„ Istio Wasm æ’ä»¶ç ”è®¨ä¼šï¼Œå‘ Istio ä¸­çš„ Wasm æ’ä»¶çš„åˆ›é€ è€…å­¦ä¹ &lt;/a&gt;ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>åŸºäº gRPC å’Œ Istio çš„æ—  sidecar ä»£ç†çš„æœåŠ¡ç½‘æ ¼</title>
      <link>https://lib.jimmysong.io/blog/grpc-proxyless-service-mesh/</link>
      <pubDate>Tue, 23 Nov 2021 10:03:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/grpc-proxyless-service-mesh/</guid>
      <description>&lt;h2 id=&#34;ç¼–è€…çš„è¯&#34;&gt;ç¼–è€…çš„è¯&lt;/h2&gt;
&lt;p&gt;æœ¬æ–‡è¯‘è‡ª Istio å®˜æ–¹åšå®¢ï¼Œåšå®¢åŸæ ‡é¢˜ &lt;a href=&#34;https://istio.io/latest/blog/2021/proxyless-grpc/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;gRPC Proxyless Service Mesh&lt;/a&gt;ï¼Œå…¶å®æ˜¯ Istio 1.11 ç‰ˆæœ¬ä¸­æ”¯æŒçš„å®éªŒç‰¹æ€§ï¼Œå¯ä»¥ç›´æ¥å°† gRPC æœåŠ¡æ·»åŠ åˆ° Istio ä¸­ï¼Œè€Œä¸éœ€è¦å†å‘ Pod ä¸­æ³¨å…¥ Envoy ä»£ç†ã€‚æœ¬æ–‡ä¸­è¿˜ç»™å‡ºäº†ä¸€ä¸ª Demo æ€§èƒ½æµ‹è¯•æ•°æ®ï¼Œè¿™ç§åšæ³•å¯ä»¥æå¤§çš„æå‡åº”ç”¨æ€§èƒ½ï¼Œé™ä½ç½‘ç»œå»¶è¿Ÿã€‚&lt;/p&gt;
&lt;p&gt;Istio ä½¿ç”¨ä¸€ç»„å‘ç° APIï¼ˆç»Ÿç§°ä¸º &lt;a href=&#34;https://www.envoyproxy.io/docs/envoy/latest/intro/arch_overview/operations/dynamic_configuration&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;xDS API&lt;/a&gt; æ¥åŠ¨æ€é…ç½®å…¶ Envoy sidecar ä»£ç†ã€‚è¿™äº› API çš„ç›®æ ‡æ˜¯æˆä¸ºä¸€ä¸ª &lt;a href=&#34;https://blog.envoyproxy.io/the-universal-data-plane-api-d15cec7a?gi=64aa2eea0283&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;é€šç”¨çš„æ•°æ®å¹³é¢ API&lt;/a&gt;ã€‚gRPC é¡¹ç›®å¯¹ xDS API æœ‰å¾ˆå¥½çš„æ”¯æŒï¼Œä¹Ÿå°±æ˜¯è¯´ä½ å¯ä»¥ç®¡ç† gRPC å·¥ä½œè´Ÿè½½ï¼Œè€Œä¸éœ€è¦åŒæ—¶éƒ¨ç½² Envoy sidecarã€‚ä½ å¯ä»¥åœ¨ &lt;a href=&#34;https://www.youtube.com/watch?v=cGJXkZ7jiDk&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Megan Yahya çš„ KubeCon EU 2021 æ¼”è®²&lt;/a&gt;ä¸­äº†è§£æ›´å¤šå…³äºè¯¥é›†æˆçš„ä¿¡æ¯ã€‚å…³äº gRPC æ”¯æŒçš„æœ€æ–°æƒ…å†µï¼Œå¯ä»¥åœ¨ä»–ä»¬çš„&lt;a href=&#34;https://github.com/grpc/proposal/search?q=xds&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ææ¡ˆ&lt;/a&gt;ä¸­æ‰¾åˆ°ï¼Œè¿˜æœ‰å®ç°çŠ¶æ€ã€‚&lt;/p&gt;
&lt;p&gt;Istio 1.11 å¢åŠ äº†å®éªŒæ€§æ”¯æŒï¼Œå¯ä»¥ç›´æ¥å°† gRPC æœåŠ¡æ·»åŠ åˆ°ç½‘æ ¼ä¸­ã€‚æˆ‘ä»¬æ”¯æŒåŸºæœ¬çš„æœåŠ¡å‘ç°ï¼Œä¸€äº›åŸºäº VirtualService çš„æµé‡ç­–ç•¥ï¼Œä»¥åŠåŒå‘ TLSã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ”¯æŒçš„åŠŸèƒ½&#34;&gt;æ”¯æŒçš„åŠŸèƒ½&lt;/h2&gt;
&lt;p&gt;ä¸ Envoy ç›¸æ¯”ï¼Œç›®å‰ gRPC å†…çš„ xDS API çš„å®ç°åœ¨æŸäº›æ–¹é¢æ˜¯æœ‰é™çš„ã€‚ä»¥ä¸‹åŠŸèƒ½åº”è¯¥å¯ä»¥ä½¿ç”¨ï¼Œå°½ç®¡è¿™ä¸æ˜¯ä¸€ä¸ªè¯¦å°½çš„åˆ—è¡¨ï¼Œå…¶ä»–åŠŸèƒ½å¯èƒ½éƒ¨åˆ†å¯ç”¨ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åŸºæœ¬çš„æœåŠ¡å‘ç°ã€‚ä½ çš„ gRPC æœåŠ¡å¯ä»¥æ¥è§¦åˆ°åœ¨ç½‘æ ¼ä¸­æ³¨å†Œçš„å…¶ä»– pod å’Œè™šæ‹Ÿæœºã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;DestinationRule&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Subset&lt;/code&gt;ï¼šä½ çš„ gRPC æœåŠ¡å¯ä»¥æ ¹æ®æ ‡ç­¾é€‰æ‹©å™¨å°†æµé‡åˆ†å‰²åˆ°ä¸åŒçš„å®ä¾‹ç»„ã€‚&lt;/li&gt;
&lt;li&gt;ç›®å‰å”¯ä¸€æ”¯æŒçš„ Istio &lt;code&gt;loadBalancer&lt;/code&gt; æ˜¯ &lt;code&gt;ROUND_ROBIN&lt;/code&gt;ï¼Œ&lt;code&gt;consistentHash&lt;/code&gt; å°†åœ¨æœªæ¥çš„ Istio ç‰ˆæœ¬ä¸­åŠ å…¥ï¼ˆæ”¯æŒ gRPCï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;tls&lt;/code&gt; è®¾ç½®è¢«é™åˆ¶ä¸º &lt;code&gt;DISABLE&lt;/code&gt; æˆ– &lt;code&gt;ISTIO_MUTUAL&lt;/code&gt;ã€‚å…¶ä»–æ¨¡å¼å°†è¢«è§†ä¸º &lt;code&gt;DISABLE&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;VirtualService&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;Header åŒ¹é…å’Œ URI åŒ¹é…çš„æ ¼å¼ä¸º &lt;code&gt;/ServiceName/RPCName&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;è¦†ç›–ç›®æ ‡ä¸»æœºå’Œå­é›†ã€‚&lt;/li&gt;
&lt;li&gt;åŠ æƒçš„æµé‡è½¬ç§»ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;code&gt;PeerAuthentication&lt;/code&gt;
&lt;ul&gt;
&lt;li&gt;åªæ”¯æŒ &lt;code&gt;DISABLE&lt;/code&gt; å’Œ &lt;code&gt;STRICT&lt;/code&gt;ã€‚å…¶ä»–æ¨¡å¼å°†è¢«è§†ä¸º &lt;code&gt;DISABLE&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨æœªæ¥çš„ç‰ˆæœ¬ä¸­å¯èƒ½ä¼šæœ‰å¯¹ auto-mTLS çš„æ”¯æŒã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å…¶ä»–åŠŸèƒ½åŒ…æ‹¬æ•…éšœã€é‡è¯•ã€è¶…æ—¶ã€é•œåƒå’Œé‡å†™è§„åˆ™ï¼Œå¯èƒ½ä¼šåœ¨æœªæ¥çš„ç‰ˆæœ¬ä¸­æ”¯æŒã€‚å…¶ä¸­ä¸€äº›åŠŸèƒ½æ­£ç­‰å¾…åœ¨ gRPC ä¸­å®ç°ï¼Œè€Œå…¶ä»–åŠŸèƒ½åˆ™éœ€è¦åœ¨ Istio ä¸­æ”¯æŒã€‚gRPC ä¸­ xDS åŠŸèƒ½çš„çŠ¶æ€å¯ä»¥&lt;a href=&#34;https://github.com/grpc/grpc/blob/master/doc/grpc_xds_features.md&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;åœ¨è¿™é‡Œ&lt;/a&gt;æ‰¾åˆ°ã€‚Istio çš„æ”¯æŒçŠ¶å†µå°†å­˜åœ¨äºæœªæ¥çš„å®˜æ–¹æ–‡æ¡£ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªåŠŸèƒ½æ˜¯&lt;a href=&#34;https://istio.io/latest/docs/releases/feature-stages/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å®éªŒæ€§çš„&lt;/a&gt;ã€‚æ ‡å‡†çš„ Istio åŠŸèƒ½å°†éšç€æ—¶é—´çš„æ¨ç§»å’Œæ•´ä½“è®¾è®¡çš„æ”¹è¿›è€Œå¾—åˆ°æ”¯æŒã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ¶æ„æ¦‚è¿°&#34;&gt;æ¶æ„æ¦‚è¿°&lt;/h2&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-grpcæœåŠ¡å¦‚ä½•ä¸istiodé€šä¿¡çš„ç¤ºæ„å›¾&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;gRPCæœåŠ¡å¦‚ä½•ä¸istiodé€šä¿¡çš„ç¤ºæ„å›¾&#34; srcset=&#34;
               /blog/grpc-proxyless-service-mesh/008i3skNly1gwp3lh9za5j311q0hm75n_hub13183ce8bf635668b5180d6a8999e71_59258_93b5fc3be37bb2885005a55419c3b69e.webp 400w,
               /blog/grpc-proxyless-service-mesh/008i3skNly1gwp3lh9za5j311q0hm75n_hub13183ce8bf635668b5180d6a8999e71_59258_865bf197a56648593ab7bcb88c72344f.webp 760w,
               /blog/grpc-proxyless-service-mesh/008i3skNly1gwp3lh9za5j311q0hm75n_hub13183ce8bf635668b5180d6a8999e71_59258_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/grpc-proxyless-service-mesh/008i3skNly1gwp3lh9za5j311q0hm75n_hub13183ce8bf635668b5180d6a8999e71_59258_93b5fc3be37bb2885005a55419c3b69e.webp&#34;
               width=&#34;760&#34;
               height=&#34;355&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      gRPCæœåŠ¡å¦‚ä½•ä¸istiodé€šä¿¡çš„ç¤ºæ„å›¾
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;è™½ç„¶ä¸ä½¿ç”¨ proxy è¿›è¡Œæ•°æ®é¢é€šä¿¡ï¼Œä½†å®ƒä»ç„¶éœ€è¦ä¸€ä¸ª agent æ¥è¿›è¡Œåˆå§‹åŒ–å’Œä¸æ§åˆ¶é¢çš„é€šä¿¡ã€‚é¦–å…ˆï¼Œagent åœ¨å¯åŠ¨æ—¶ç”Ÿæˆä¸€ä¸ª&lt;a href=&#34;https://github.com/grpc/proposal/blob/master/A27-xds-global-load-balancing.md#xdsclient-and-bootstrap-file&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¼•å¯¼æ–‡ä»¶&lt;/a&gt;ï¼Œä¸ä¸º Envoy ç”Ÿæˆå¼•å¯¼æ–‡ä»¶çš„æ–¹å¼ç›¸åŒã€‚è¿™å‘Šè¯‰ gRPC åº“å¦‚ä½•è¿æ¥åˆ° istiodï¼Œåœ¨å“ªé‡Œå¯ä»¥æ‰¾åˆ°æ•°æ®é¢é€šä¿¡çš„è¯ä¹¦ï¼Œä»¥åŠå‘æ§åˆ¶é¢å‘é€ä»€ä¹ˆå…ƒæ•°æ®ã€‚æ¥ä¸‹æ¥ï¼Œagent ä½œä¸ºä¸€ä¸ª xDS proxyï¼Œä»£è¡¨åº”ç”¨ç¨‹åºä¸ istiod è¿›è¡Œè¿æ¥å’Œè®¤è¯ã€‚æœ€åï¼Œagent è·å–å¹¶è½®æ¢æ•°æ®å¹³é¢é€šä¿¡ä¸­ä½¿ç”¨çš„è¯ä¹¦ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å¯¹åº”ç”¨ç¨‹åºä»£ç çš„ä¿®æ”¹&#34;&gt;å¯¹åº”ç”¨ç¨‹åºä»£ç çš„ä¿®æ”¹&lt;/h2&gt;
&lt;p&gt;æœ¬èŠ‚ä»‹ç»äº† gRPC åœ¨ Go ä¸­çš„ xDS æ”¯æŒã€‚å…¶ä»–è¯­è¨€ä¹Ÿæœ‰ç±»ä¼¼çš„ APIã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†å¯ç”¨ gRPC ä¸­çš„ xDS åŠŸèƒ½ï¼Œä½ çš„åº”ç”¨ç¨‹åºå¿…é¡»åšä¸€äº›å¿…è¦çš„ä¿®æ”¹ã€‚ä½ çš„ gRPC ç‰ˆæœ¬åº”è¯¥è‡³å°‘æ˜¯ 1.39.0ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å®¢æˆ·ç«¯&#34;&gt;å®¢æˆ·ç«¯&lt;/h3&gt;
&lt;p&gt;ä¸‹é¢çš„å¯¼å…¥å°†åœ¨ gRPC ä¸­æ³¨å†Œ xDS è§£æå™¨å’Œå‡è¡¡å™¨ã€‚å®ƒåº”è¯¥è¢«æ·»åŠ åˆ°ä½ çš„ä¸»åŒ…æˆ–è°ƒç”¨ &lt;code&gt;grpc.Dial&lt;/code&gt; çš„åŒä¸€ä¸ªåŒ…ä¸­ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;_&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;google.golang.org/grpc/xds&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å½“åˆ›å»ºä¸€ä¸ª gRPC è¿æ¥æ—¶ï¼ŒURL å¿…é¡»ä½¿ç”¨ &lt;code&gt;xds:///&lt;/code&gt; schemeã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;conn&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;grpc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;DialContext&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ctx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;xds:///foo.ns.svc.cluster.local:7070&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ­¤å¤–ï¼Œä¸ºäº†æ”¯æŒï¼ˆmï¼‰TLSï¼Œå¿…é¡»å‘ &lt;code&gt;DialContext&lt;/code&gt; ä¼ é€’ä¸€ä¸ªç‰¹æ®Šçš„ &lt;code&gt;TransportCredentials&lt;/code&gt; é€‰é¡¹ã€‚&lt;code&gt;FallbackCreds&lt;/code&gt; å…è®¸æˆ‘ä»¬åœ¨ istiod ä¸å‘é€å®‰å…¨é…ç½®æ—¶æˆåŠŸã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;google.golang.org/grpc/credentials/xds&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;creds&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;xds&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;NewClientCredentials&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;xds&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ClientOptions&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;FallbackCreds&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;insecure&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;NewCredentials&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;})&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// handle err
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;conn&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;grpc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;DialContext&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;ctx&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;xds:///foo.ns.svc.cluster.local:7070&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;grpc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;WithTransportCredentials&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;creds&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;æœåŠ¡ç«¯&#34;&gt;æœåŠ¡ç«¯&lt;/h3&gt;
&lt;p&gt;ä¸ºäº†æ”¯æŒæœåŠ¡å™¨ç«¯çš„é…ç½®ï¼Œå¦‚ mTLSï¼Œå¿…é¡»åšä¸€äº›ä¿®æ”¹ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªç‰¹æ®Šçš„æ„é€ å‡½æ•°æ¥åˆ›å»º &lt;code&gt;GRPCServer&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;s&#34;&gt;&amp;#34;google.golang.org/grpc/xds&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;...&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;server&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;xds&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;NewGRPCServer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nf&#34;&gt;RegisterFooServer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;server&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;fooServerImpl&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¦‚æœä½ çš„ &lt;code&gt;protoc&lt;/code&gt; ç”Ÿæˆçš„ Go ä»£ç å·²ç»è¿‡æœŸï¼Œä½ å¯èƒ½éœ€è¦é‡æ–°ç”Ÿæˆï¼Œä»¥ä¾¿ä¸ xDS æœåŠ¡å™¨å…¼å®¹ã€‚ä½ ç”Ÿæˆçš„ &lt;code&gt;RegisterFooServer&lt;/code&gt; å‡½æ•°åº”è¯¥åƒä¸‹é¢è¿™æ ·ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;RegisterFooServer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;s&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;grpc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ServiceRegistrar&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;srv&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;FooServer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;RegisterService&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;FooServer_ServiceDesc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;srv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æœ€åï¼Œä¸å®¢æˆ·ç«¯çš„å˜åŒ–ä¸€æ ·ï¼Œæˆ‘ä»¬å¿…é¡»å¯ç”¨å®‰å…¨æ”¯æŒã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nx&#34;&gt;creds&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;err&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;xds&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;NewServerCredentials&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;xdscreds&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ServerOptions&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;FallbackCreds&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;insecure&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;NewCredentials&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()})&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;// handle err
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;server&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;xds&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;NewGRPCServer&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;grpc&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nf&#34;&gt;Creds&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;creds&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;åœ¨ä½ çš„-kubernetes-éƒ¨ç½²ä¸­&#34;&gt;åœ¨ä½ çš„ Kubernetes éƒ¨ç½²ä¸­&lt;/h3&gt;
&lt;p&gt;å‡è®¾ä½ çš„åº”ç”¨ä»£ç æ˜¯å…¼å®¹çš„ï¼ŒPod åªéœ€è¦æ³¨é‡Š &lt;code&gt;inject.istio.io/templatesï¼šgrpc-agent&lt;/code&gt;ã€‚è¿™å¢åŠ äº†ä¸€ä¸ªè¿è¡Œä¸Šè¿°ä»£ç†çš„ sidecar å®¹å™¨ï¼Œä»¥åŠä¸€äº›ç¯å¢ƒå˜é‡ï¼ŒgRPC ä½¿ç”¨è¿™äº›å˜é‡æ¥å¯»æ‰¾å¼•å¯¼æ–‡ä»¶å¹¶å¯ç”¨æŸäº›åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äº gRPC æœåŠ¡ç«¯ï¼Œä½ çš„ Pod ä¹Ÿåº”è¯¥ç”¨ &lt;code&gt;proxy.istio.io/config: &#39;{&amp;quot;holdApplicationUntilProxyStarts&amp;quot;: true}&#39;&lt;/code&gt; æ¥æ³¨é‡Šï¼Œä»¥ç¡®ä¿åœ¨ä½ çš„ gRPC æœåŠ¡ç«¯åˆå§‹åŒ–ä¹‹å‰ï¼Œä»£ç†ä¸­çš„ xDS ä»£ç†å’Œå¼•å¯¼æ–‡ä»¶å·²ç»å‡†å¤‡å°±ç»ªã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä¾‹å­&#34;&gt;ä¾‹å­&lt;/h2&gt;
&lt;p&gt;åœ¨æœ¬æŒ‡å—ä¸­ï¼Œä½ å°†éƒ¨ç½² echoï¼Œä¸€ä¸ªå·²ç»æ”¯æŒæœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯æ— ä»£ç†çš„ gRPC çš„åº”ç”¨ã€‚é€šè¿‡è¿™ä¸ªåº”ç”¨ç¨‹åºï¼Œä½ å¯ä»¥å°è¯•ä¸€äº›æ”¯æŒçš„æµé‡ç­–ç•¥ï¼Œå¯ç”¨ mTLSã€‚&lt;/p&gt;
&lt;h3 id=&#34;å…ˆå†³æ¡ä»¶&#34;&gt;å…ˆå†³æ¡ä»¶&lt;/h3&gt;
&lt;p&gt;æœ¬æŒ‡å—è¦æ±‚åœ¨è¿›è¡Œä¹‹å‰&lt;a href=&#34;https://istio.io/latest/docs/setup/install/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å®‰è£…&lt;/a&gt; Istioï¼ˆ1.11+ï¼‰æ§åˆ¶å¹³é¢ã€‚&lt;/p&gt;
&lt;h3 id=&#34;éƒ¨ç½²åº”ç”¨ç¨‹åº&#34;&gt;éƒ¨ç½²åº”ç”¨ç¨‹åº&lt;/h3&gt;
&lt;p&gt;åˆ›å»ºä¸€ä¸ªæ”¯æŒæ³¨å…¥çš„å‘½åç©ºé—´ &lt;code&gt;echo-grpc&lt;/code&gt;ã€‚æ¥ä¸‹æ¥éƒ¨ç½²ä¸¤ä¸ª &lt;code&gt;echo&lt;/code&gt; åº”ç”¨ç¨‹åºçš„å®ä¾‹ä»¥åŠæœåŠ¡ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ kubectl create namespace echo-grpc
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ kubectl label namespace echo-grpc istio-injection&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;enabled
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ kubectl -n echo-grpc apply -f samples/grpc-echo/grpc-echo.yaml
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç¡®ä¿ä¸¤ä¸ª Pod æ­£åœ¨è¿è¡Œã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ kubectl -n echo-grpc get pods
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;NAME                       READY   STATUS    RESTARTS   AGE
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;echo-v1-69d6d96cb7-gpcpd   2/2     Running   &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;          58s
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;echo-v2-5c6cbf6dc7-dfhcb   2/2     Running   &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;          58s
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;æµ‹è¯•-grpc-è§£æå™¨&#34;&gt;æµ‹è¯• gRPC è§£æå™¨&lt;/h3&gt;
&lt;p&gt;é¦–å…ˆï¼Œå°† 17171 ç«¯å£è½¬å‘åˆ°å…¶ä¸­ä¸€ä¸ª Pod ä¸Šã€‚è¿™ä¸ªç«¯å£æ˜¯ä¸€ä¸ªé xDS æ”¯æŒçš„ gRPC æœåŠ¡ç«¯ï¼Œå…è®¸ä»ç«¯å£è½¬å‘çš„ Pod å‘å‡ºè¯·æ±‚ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ kubectl -n echo-grpc port-forward &lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;kubectl -n echo-grpc get pods -l &lt;span class=&#34;nv&#34;&gt;version&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;v1 -ojsonpath&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;{.items[0].metadata.name}&amp;#39;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;17171&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥å‘é€ä¸€æ‰¹ 5 ä¸ªè¯·æ±‚ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ grpcurl -plaintext -d &lt;span class=&#34;s1&#34;&gt;&amp;#39;{&amp;#34;url&amp;#34;: &amp;#34;xds:///echo.echo-grpc.svc.cluster.local:7070&amp;#34;, &amp;#34;count&amp;#34;: 5}&amp;#39;&lt;/span&gt; :17171 proto.EchoTestService/ForwardEcho &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; jq -r &lt;span class=&#34;s1&#34;&gt;&amp;#39;.output | join(&amp;#34;&amp;#34;)&amp;#39;&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; grep Hostname
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Handling connection &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;17171&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; body&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;Hostname&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;echo-v1-7cf5b76586-bgn6t
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt; body&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;Hostname&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;echo-v2-cf97bd94d-qf628
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;2&lt;/span&gt; body&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;Hostname&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;echo-v1-7cf5b76586-bgn6t
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;3&lt;/span&gt; body&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;Hostname&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;echo-v2-cf97bd94d-qf628
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;4&lt;/span&gt; body&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;Hostname&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;echo-v1-7cf5b76586-bgn6t
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ç±»ä¼¼ Kubernetes åç§°è§£æçš„çŸ­åç§°ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ grpcurl -plaintext -d &lt;span class=&#34;s1&#34;&gt;&amp;#39;{&amp;#34;url&amp;#34;: &amp;#34;xds:///echo:7070&amp;#34;}&amp;#39;&lt;/span&gt; :17171 proto.EchoTestService/ForwardEcho &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; jq -r &lt;span class=&#34;s1&#34;&gt;&amp;#39;.output | join
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;(&amp;#34;&amp;#34;)&amp;#39;&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; grep Hostname
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; body&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;Hostname&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;echo-v1-7cf5b76586-ltr8q
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ grpcurl -plaintext -d &lt;span class=&#34;s1&#34;&gt;&amp;#39;{&amp;#34;url&amp;#34;: &amp;#34;xds:///echo.echo-grpc:7070&amp;#34;}&amp;#39;&lt;/span&gt; :17171 proto.EchoTestService/ForwardEcho &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; jq -r
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;.output | join(&amp;#34;&amp;#34;)&amp;#39;&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; grep Hostname
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; body&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;Hostname&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;echo-v1-7cf5b76586-ltr8q
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ grpcurl -plaintext -d &lt;span class=&#34;s1&#34;&gt;&amp;#39;{&amp;#34;url&amp;#34;: &amp;#34;xds:///echo.echo-grpc.svc:7070&amp;#34;}&amp;#39;&lt;/span&gt; :17171 proto.EchoTestService/ForwardEcho &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; jq -r
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;.output | join(&amp;#34;&amp;#34;)&amp;#39;&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; grep Hostname
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; body&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;Hostname&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;echo-v2-cf97bd94d-jt5mf
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;ç”¨ç›®çš„åœ°è§„åˆ™åˆ›å»ºå­é›†&#34;&gt;ç”¨ç›®çš„åœ°è§„åˆ™åˆ›å»ºå­é›†&lt;/h3&gt;
&lt;p&gt;é¦–å…ˆï¼Œä¸ºæ¯ä¸ªç‰ˆæœ¬çš„å·¥ä½œè´Ÿè½½åˆ›å»ºä¸€ä¸ªå­é›†ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ cat &lt;span class=&#34;s&#34;&gt;&amp;lt;&amp;lt;EOF | kubectl apply -f -
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;apiVersion: networking.istio.io/v1alpha3
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;kind: DestinationRule
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;metadata:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  name: echo-versions
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  namespace: echo-grpc
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;spec:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  host: echo.echo-grpc.svc.cluster.local
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  subsets:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  - name: v1
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    labels:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;      version: v1
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  - name: v2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    labels:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;      version: v2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;EOF&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;æµé‡è½¬ç§»&#34;&gt;æµé‡è½¬ç§»&lt;/h3&gt;
&lt;p&gt;ä½¿ç”¨ä¸Šé¢å®šä¹‰çš„å­é›†ï¼Œä½ å¯ä»¥æŠŠ 80% çš„æµé‡å‘é€åˆ°ä¸€ä¸ªç‰¹å®šçš„ç‰ˆæœ¬ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ cat &lt;span class=&#34;s&#34;&gt;&amp;lt;&amp;lt;EOF | kubectl apply -f -
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;apiVersion: networking.istio.io/v1beta1
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;kind: VirtualService
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;metadata:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  name: echo-weights
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  namespace: echo-grpc
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;spec:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  hosts:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  - echo.echo-grpc.svc.cluster.local
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  http:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  - route:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    - destination:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;        host: echo.echo-grpc.svc.cluster.local
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;        subset: v1
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;      weight: 20
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    - destination:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;        host: echo.echo-grpc.svc.cluster.local
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;        subset: v2
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;      weight: 80
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;EOF&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç°åœ¨ï¼Œå‘é€ä¸€ç»„ 10 ä¸ªè¯·æ±‚ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;grpcurl -plaintext -d &lt;span class=&#34;s1&#34;&gt;&amp;#39;{&amp;#34;url&amp;#34;: &amp;#34;xds:///echo.echo-grpc.svc.cluster.local:7070&amp;#34;, &amp;#34;count&amp;#34;: 10}&amp;#39;&lt;/span&gt; :17171 proto.EchoTestService/ForwardEcho &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; jq -r &lt;span class=&#34;s1&#34;&gt;&amp;#39;.output | join(&amp;#34;&amp;#34;)&amp;#39;&lt;/span&gt;  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; grep ServiceVersion
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å“åº”åº”ä¸»è¦åŒ…å« v2 å“åº”ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-plain&#34; data-lang=&#34;plain&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;[0 body] ServiceVersion=v2
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;[1 body] ServiceVersion=v2
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;[2 body] ServiceVersion=v1
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;[3 body] ServiceVersion=v2
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;[4 body] ServiceVersion=v1
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;[5 body] ServiceVersion=v2
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;[6 body] ServiceVersion=v2
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;[7 body] ServiceVersion=v2
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;[8 body] ServiceVersion=v2
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;[9 body] ServiceVersion=v2
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;å¯ç”¨-mtls&#34;&gt;å¯ç”¨ mTLS&lt;/h3&gt;
&lt;p&gt;ç”±äºåœ¨ gRPC ä¸­å¯ç”¨å®‰å…¨æ‰€éœ€çš„åº”ç”¨ç¨‹åºæœ¬èº«çš„å˜åŒ–ï¼ŒIstio çš„è‡ªåŠ¨æ£€æµ‹ mTLS æ”¯æŒçš„ä¼ ç»Ÿæ–¹æ³•æ˜¯ä¸å¯é çš„ã€‚å‡ºäºè¿™ä¸ªåŸå› ï¼Œåˆå§‹ç‰ˆæœ¬éœ€è¦åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¸Šæ˜ç¡®å¯ç”¨ mTLSã€‚&lt;/p&gt;
&lt;p&gt;è¦å¯ç”¨å®¢æˆ·ç«¯çš„ mTLSï¼Œè¯·åº”ç”¨å¸¦æœ‰ &lt;code&gt;tls&lt;/code&gt; è®¾ç½®çš„ &lt;code&gt;DestinationRule&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ cat &lt;span class=&#34;s&#34;&gt;&amp;lt;&amp;lt;EOF | kubectl apply -f -
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;apiVersion: networking.istio.io/v1alpha3
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;kind: DestinationRule
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;metadata:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  name: echo-mtls
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  namespace: echo-grpc
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;spec:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  host: echo.echo-grpc.svc.cluster.local
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  trafficPolicy:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    tls:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;      mode: ISTIO_MUTUAL
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;EOF&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç°åœ¨ï¼Œè¯•å›¾è°ƒç”¨å°šæœªé…ç½® mTLS çš„æœåŠ¡å™¨å°†ä¼šå¤±è´¥ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ grpcurl -plaintext -d &lt;span class=&#34;s1&#34;&gt;&amp;#39;{&amp;#34;url&amp;#34;: &amp;#34;xds:///echo.echo-grpc.svc.cluster.local:7070&amp;#34;}&amp;#39;&lt;/span&gt; :17171 proto.EchoTestService/ForwardEcho &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; jq -r &lt;span class=&#34;s1&#34;&gt;&amp;#39;.output | join(&amp;#34;&amp;#34;)&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Handling connection &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;17171&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;ERROR:
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Code: Unknown
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Message: 1/1 requests had errors&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt; first error: rpc error: &lt;span class=&#34;nv&#34;&gt;code&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; Unavailable &lt;span class=&#34;nv&#34;&gt;desc&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; all SubConns are in TransientFailure
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¸ºäº†å¯ç”¨æœåŠ¡å™¨ç«¯çš„ mTLSï¼Œåº”ç”¨ä¸€ä¸ª &lt;code&gt;PeerAuthentication&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä»¥ä¸‹ç­–ç•¥å¯¹æ•´ä¸ªå‘½åç©ºé—´å¼ºåˆ¶é‡‡ç”¨ STRICT mTLSã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ cat &lt;span class=&#34;s&#34;&gt;&amp;lt;&amp;lt;EOF | kubectl apply -f -
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;apiVersion: security.istio.io/v1beta1
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;kind: PeerAuthentication
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;metadata:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  name: echo-mtls
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  namespace: echo-grpc
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;spec:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;  mtls:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;    mode: STRICT
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s&#34;&gt;EOF&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åº”ç”¨è¯¥æ”¿ç­–åï¼Œè¯·æ±‚å°†å¼€å§‹æˆåŠŸã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ grpcurl -plaintext -d &lt;span class=&#34;s1&#34;&gt;&amp;#39;{&amp;#34;url&amp;#34;: &amp;#34;xds:///echo.echo-grpc.svc.cluster.local:7070&amp;#34;}&amp;#39;&lt;/span&gt; :17171 proto.EchoTestService/ForwardEcho &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; jq -r &lt;span class=&#34;s1&#34;&gt;&amp;#39;.output | join(&amp;#34;&amp;#34;)&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;Handling connection &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;17171&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;0&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; grpcecho.Echo&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;xds:///echo.echo-grpc.svc.cluster.local:7070 map&lt;span class=&#34;o&#34;&gt;[]&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;  5s &lt;span class=&#34;nb&#34;&gt;false&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;})&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; body&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; x-request-id&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; body&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;Host&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;echo.echo-grpc.svc.cluster.local:7070
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; body&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; content-type&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;application/grpc
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; body&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; user-agent&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;grpc-go/1.39.1
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; body&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;StatusCode&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;200&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; body&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;ServiceVersion&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;v1
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; body&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;ServicePort&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;17070&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; body&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;Cluster&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; body&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;IP&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;10.68.1.18
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; body&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;IstioVersion&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; body&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;Echo&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;0&lt;/span&gt; body&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;nv&#34;&gt;Hostname&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;echo-v1-7cf5b76586-z5p8l
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;é™åˆ¶æ¡ä»¶&#34;&gt;é™åˆ¶æ¡ä»¶&lt;/h2&gt;
&lt;p&gt;æœ€åˆçš„ç‰ˆæœ¬æœ‰å‡ ä¸ªé™åˆ¶ï¼Œå¯èƒ½ä¼šåœ¨æœªæ¥çš„ç‰ˆæœ¬ä¸­ä¿®å¤ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸æ”¯æŒè‡ªåŠ¨ mTLSï¼Œä¹Ÿä¸æ”¯æŒè®¸å¯æ¨¡å¼ã€‚ç›¸åï¼Œæˆ‘ä»¬éœ€è¦åœ¨æœåŠ¡å™¨ä¸Šä½¿ç”¨ &lt;code&gt;STRICT&lt;/code&gt;ï¼Œåœ¨å®¢æˆ·ç«¯ä½¿ç”¨ &lt;code&gt;ISTIO_MUTUAL&lt;/code&gt; çš„æ˜ç¡® mTLS é…ç½®ã€‚åœ¨è¿ç§»åˆ° &lt;code&gt;STRICT&lt;/code&gt; çš„è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ Envoyã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;grpc.Serve(listener)&lt;/code&gt; æˆ– &lt;code&gt;grpc.Dial(&amp;quot;xds://...&amp;quot;)&lt;/code&gt; åœ¨ bootstrap è¢«å†™å…¥æˆ– xDS ä»£ç†å‡†å¤‡å¥½ä¹‹å‰è¢«è°ƒç”¨ä¼šå¯¼è‡´å¤±è´¥ã€‚ &lt;code&gt;holdApplicationUntilProxyStarts&lt;/code&gt; å¯ä»¥ç”¨æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ–è€…åº”ç”¨ç¨‹åºå¯ä»¥å¯¹è¿™äº›å¤±è´¥æ›´åŠ ç¨³å¥ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœæ”¯æŒ xDS çš„ gRPC æœåŠ¡å™¨ä½¿ç”¨ mTLSï¼Œé‚£ä¹ˆä½ å°†éœ€è¦ç¡®ä¿ä½ çš„å¥åº·æ£€æŸ¥å¯ä»¥ç»•è¿‡è¿™ä¸ªé—®é¢˜ã€‚è¦ä¹ˆä½¿ç”¨ä¸€ä¸ªå•ç‹¬çš„ç«¯å£ï¼Œè¦ä¹ˆä½ çš„å¥åº·æ£€æŸ¥å®¢æˆ·ç«¯éœ€è¦ä¸€ç§æ–¹æ³•æ¥è·å¾—é€‚å½“çš„å®¢æˆ·ç«¯è¯ä¹¦ã€‚&lt;/li&gt;
&lt;li&gt;gRPC ä¸­ xDS çš„å®ç°ä¸ Envoy ä¸ä¸€è‡´ã€‚æŸäº›è¡Œä¸ºå¯èƒ½ä¸åŒï¼ŒæŸäº›åŠŸèƒ½å¯èƒ½ç¼ºå¤±ã€‚&lt;a href=&#34;https://github.com/grpc/grpc/blob/master/doc/grpc_xds_features.md&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;gRPC çš„åŠŸèƒ½çŠ¶æ€&lt;/a&gt;æä¾›äº†æ›´å¤šç»†èŠ‚ã€‚è¯·ç¡®ä¿æµ‹è¯•ä»»ä½• Istio é…ç½®æ˜¯å¦çœŸæ­£é€‚ç”¨äºä½ çš„æ— ä»£ç†çš„ gRPC åº”ç”¨ç¨‹åºã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;æ€§èƒ½&#34;&gt;æ€§èƒ½&lt;/h2&gt;
&lt;h3 id=&#34;å®éªŒè®¾ç½®&#34;&gt;å®éªŒè®¾ç½®&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ä½¿ç”¨ Fortioï¼Œä¸€ä¸ªåŸºäº Go çš„è´Ÿè½½æµ‹è¯•åº”ç”¨ç¨‹åº
&lt;ul&gt;
&lt;li&gt;ç¨ä½œä¿®æ”¹ï¼Œä»¥æ”¯æŒ gRPC çš„ XDS åŠŸèƒ½ (PR)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;èµ„æºï¼š
&lt;ul&gt;
&lt;li&gt;GKE 1.20 é›†ç¾¤æœ‰ 3 ä¸ª &lt;code&gt;e2-standard-16&lt;/code&gt; èŠ‚ç‚¹ï¼ˆæ¯ä¸ªèŠ‚ç‚¹æœ‰ 16 ä¸ª CPU+64GB å†…å­˜ï¼‰&lt;/li&gt;
&lt;li&gt;Fortio å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨åº”ç”¨ç¨‹åºï¼š1.5 vCPUï¼Œ1000 MiB å†…å­˜&lt;/li&gt;
&lt;li&gt;Sidecarï¼ˆistio-agent å’Œå¯èƒ½çš„ Envoy ä»£ç†ï¼‰ï¼š1 vCPUï¼Œ512 MiB å†…å­˜&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;æµ‹è¯•çš„å·¥ä½œè´Ÿè½½ç±»å‹ï¼š
&lt;ul&gt;
&lt;li&gt;åŸºçº¿ï¼šå¸¸è§„çš„ gRPCï¼Œæ²¡æœ‰ä½¿ç”¨ Envoy ä»£ç†æˆ– Proxyless xDS&lt;/li&gt;
&lt;li&gt;Envoyï¼šæ ‡å‡†çš„ istio-agent + Envoy proxy sidecar&lt;/li&gt;
&lt;li&gt;æ— ä»£ç†ï¼šä½¿ç”¨ xDS gRPC æœåŠ¡å™¨å®ç°çš„ gRPC å’Œå®¢æˆ·ç«¯çš„ &lt;code&gt;xds:///&lt;/code&gt; è§£æå™¨ã€‚&lt;/li&gt;
&lt;li&gt;é€šè¿‡ &lt;code&gt;PeerAuthentication&lt;/code&gt; å’Œ &lt;code&gt;DestinationRule&lt;/code&gt; å¯ç”¨ / åœç”¨ mTLS&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;å»¶è¿Ÿ&#34;&gt;å»¶è¿Ÿ&lt;/h3&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-p50å»¶è¿Ÿå¯¹æ¯”å›¾&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;P50å»¶è¿Ÿå¯¹æ¯”å›¾&#34; srcset=&#34;
               /blog/grpc-proxyless-service-mesh/008i3skNly1gwp512szlvj31260rgq57_hud5c09da40d95e95911a10d442fdf1c43_91356_f0c76512696b26ddd8e19da497734612.webp 400w,
               /blog/grpc-proxyless-service-mesh/008i3skNly1gwp512szlvj31260rgq57_hud5c09da40d95e95911a10d442fdf1c43_91356_da37d4b02ce09f50eb75aed6f535dd18.webp 760w,
               /blog/grpc-proxyless-service-mesh/008i3skNly1gwp512szlvj31260rgq57_hud5c09da40d95e95911a10d442fdf1c43_91356_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/grpc-proxyless-service-mesh/008i3skNly1gwp512szlvj31260rgq57_hud5c09da40d95e95911a10d442fdf1c43_91356_f0c76512696b26ddd8e19da497734612.webp&#34;
               width=&#34;760&#34;
               height=&#34;547&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      P50å»¶è¿Ÿå¯¹æ¯”å›¾
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-p99å»¶è¿Ÿå¯¹æ¯”å›¾&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;P99å»¶è¿Ÿå¯¹æ¯”å›¾&#34; srcset=&#34;
               /blog/grpc-proxyless-service-mesh/008i3skNly1gwp51zjxqaj312q0r2jtl_hu547659c633be4fb1b9f48f5325ea357d_89875_1e2c0a5a55cdc024ed19cf1769a16061.webp 400w,
               /blog/grpc-proxyless-service-mesh/008i3skNly1gwp51zjxqaj312q0r2jtl_hu547659c633be4fb1b9f48f5325ea357d_89875_bad6ddf9387104a5bc25014ce56eaeee.webp 760w,
               /blog/grpc-proxyless-service-mesh/008i3skNly1gwp51zjxqaj312q0r2jtl_hu547659c633be4fb1b9f48f5325ea357d_89875_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/grpc-proxyless-service-mesh/008i3skNly1gwp51zjxqaj312q0r2jtl_hu547659c633be4fb1b9f48f5325ea357d_89875_1e2c0a5a55cdc024ed19cf1769a16061.webp&#34;
               width=&#34;760&#34;
               height=&#34;531&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      P99å»¶è¿Ÿå¯¹æ¯”å›¾
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;åœ¨ä½¿ç”¨æ— ä»£ç†çš„ gRPC è§£æå™¨æ—¶ï¼Œå»¶è¿Ÿä¼šæœ‰å¾®å°çš„å¢åŠ ã€‚ä¸ Envoy ç›¸æ¯”ï¼Œè¿™æ˜¯ä¸€ä¸ªå·¨å¤§çš„æ”¹è¿›ï¼Œä»ç„¶å¯ä»¥å®ç°å…ˆè¿›çš„æµé‡ç®¡ç†åŠŸèƒ½å’Œ mTLSã€‚&lt;/p&gt;
&lt;h3 id=&#34;istio-proxy-å®¹å™¨çš„èµ„æºä½¿ç”¨æƒ…å†µ&#34;&gt;istio-proxy å®¹å™¨çš„èµ„æºä½¿ç”¨æƒ…å†µ&lt;/h3&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ç±»åˆ«&lt;/th&gt;
&lt;th&gt;å®¢æˆ·ç«¯ mCPU&lt;/th&gt;
&lt;th&gt;å®¢æˆ·ç«¯å†…å­˜ (MiB)&lt;/th&gt;
&lt;th&gt;æœåŠ¡ç«¯ mCPU&lt;/th&gt;
&lt;th&gt;æœåŠ¡ç«¯å†…å­˜ (MiB)&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Envoy æ˜æ–‡&lt;/td&gt;
&lt;td&gt;320.44&lt;/td&gt;
&lt;td&gt;66.93&lt;/td&gt;
&lt;td&gt;243.78&lt;/td&gt;
&lt;td&gt;64.91&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;Envoy mTLS&lt;/td&gt;
&lt;td&gt;340.87&lt;/td&gt;
&lt;td&gt;66.76&lt;/td&gt;
&lt;td&gt;309.82&lt;/td&gt;
&lt;td&gt;64.82&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æ— ä»£ç†æ˜æ–‡&lt;/td&gt;
&lt;td&gt;0.72&lt;/td&gt;
&lt;td&gt;23.54&lt;/td&gt;
&lt;td&gt;0.84&lt;/td&gt;
&lt;td&gt;24.31&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æ— ä»£ç† mTLS&lt;/td&gt;
&lt;td&gt;0.73&lt;/td&gt;
&lt;td&gt;25.05&lt;/td&gt;
&lt;td&gt;0.78&lt;/td&gt;
&lt;td&gt;25.43&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;å°½ç®¡æˆ‘ä»¬ä»ç„¶éœ€è¦ä¸€ä¸ªä»£ç†ï¼Œä½†ä»£ç†ä½¿ç”¨çš„å†…å­˜ä¸åˆ°å®Œæ•´ vCPU çš„ 0.1%ï¼Œè€Œä¸”åªæœ‰ 25 MiBï¼Œè¿™è¿˜ä¸åˆ°è¿è¡Œ Envoy æ‰€éœ€å†…å­˜çš„ä¸€åŠã€‚&lt;/p&gt;
&lt;p&gt;è¿™äº›æŒ‡æ ‡ä¸åŒ…æ‹¬åº”ç”¨å®¹å™¨ä¸­ gRPC çš„é¢å¤–èµ„æºä½¿ç”¨é‡ï¼Œä½†æœ‰åŠ©äºå±•ç¤º istio-agent åœ¨æ­¤æ¨¡å¼ä¸‹è¿è¡Œæ—¶çš„èµ„æºä½¿ç”¨å½±å“ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>eBPF å¦‚ä½•ç®€åŒ–æœåŠ¡ç½‘æ ¼</title>
      <link>https://lib.jimmysong.io/blog/how-ebpf-streamlines-the-service-mesh/</link>
      <pubDate>Wed, 27 Oct 2021 13:00:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/how-ebpf-streamlines-the-service-mesh/</guid>
      <description>&lt;h2 id=&#34;å‰è¨€&#34;&gt;å‰è¨€&lt;/h2&gt;
&lt;p&gt;ä»Šå¤©æœ‰å‡ ä¸ªæœåŠ¡ç½‘æ ¼çš„äº§å“å’Œé¡¹ç›®ï¼Œæ‰¿è¯ºç®€åŒ–åº”ç”¨å¾®æœåŠ¡ä¹‹é—´çš„è¿æ¥ï¼ŒåŒæ—¶æä¾›é¢å¤–çš„åŠŸèƒ½ï¼Œå¦‚å®‰å…¨è¿æ¥ã€å¯è§‚æµ‹æ€§å’Œæµé‡ç®¡ç†ã€‚ä½†æ­£å¦‚æˆ‘ä»¬åœ¨è¿‡å»å‡ å¹´ä¸­åå¤çœ‹åˆ°çš„é‚£æ ·ï¼Œå¯¹æœåŠ¡ç½‘æ ¼çš„å…´å¥‹å·²ç»è¢«å¯¹&lt;a href=&#34;https://nowei.github.io/projects/svc_mesh_measurement_final_report.pdf&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;é¢å¤–çš„&lt;/a&gt;&lt;a href=&#34;https://engineering.hellofresh.com/everything-we-learned-running-istio-in-production-part-2-ff4c26844bfb&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¤æ‚æ€§&lt;/a&gt;å’Œ&lt;a href=&#34;https://pklinker.medium.com/performance-impacts-of-an-istio-service-mesh-63957a0000b&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¼€é”€çš„&lt;/a&gt;å®é™…&lt;a href=&#34;https://medium.com/geekculture/watch-out-for-this-istio-proxy-sidecar-memory-pitfall-8dbd99ea7e9d&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ‹…å¿§æ‰€æŠ‘åˆ¶&lt;/a&gt;ã€‚è®©æˆ‘ä»¬æ¥æ¢è®¨ä¸€ä¸‹ &lt;a href=&#34;https://ebpf.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;eBPF&lt;/a&gt; æ˜¯å¦‚ä½•è®©æˆ‘ä»¬ç²¾ç®€&lt;a href=&#34;https://thenewstack.io/category/service-mesh/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æœåŠ¡ç½‘æ ¼&lt;/a&gt;ï¼Œä½¿æœåŠ¡ç½‘æ ¼çš„æ•°æ®å¹³é¢æ›´æœ‰æ•ˆç‡ï¼Œæ›´å®¹æ˜“éƒ¨ç½²ã€‚&lt;/p&gt;
&lt;h2 id=&#34;sidecar-é—®é¢˜&#34;&gt;Sidecar é—®é¢˜&lt;/h2&gt;
&lt;p&gt;ä»Šå¤©çš„ Kubernetes æœåŠ¡ç½‘æ ¼è§£å†³æ–¹æ¡ˆè¦æ±‚ä½ åœ¨æ¯ä¸€ä¸ªåº”ç”¨ pod ä¸Šæ·»åŠ ä¸€ä¸ªä»£ç† sidecar å®¹å™¨ï¼Œå¦‚ &lt;a href=&#34;https://www.envoyproxy.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Envoy&lt;/a&gt; æˆ– &lt;a href=&#34;https://linkerd.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Linkerd-proxy&lt;/a&gt;ã€‚è¿™æ˜¯æ­£ç¡®çš„ï¼šå³ä½¿åœ¨ä¸€ä¸ªéå¸¸å°çš„ç¯å¢ƒä¸­ï¼Œæ¯”å¦‚è¯´æœ‰ 20 ä¸ªæœåŠ¡ï¼Œæ¯ä¸ªæœåŠ¡è¿è¡Œäº”ä¸ª podï¼Œåˆ†å¸ƒåœ¨ä¸‰ä¸ªèŠ‚ç‚¹ä¸Šï¼Œä½ ä¹Ÿæœ‰ 100 ä¸ªä»£ç†å®¹å™¨ã€‚æ— è®ºä»£ç†çš„å®ç°å¤šä¹ˆå°å’Œæœ‰æ•ˆï¼Œè¿™ç§çº¯ç²¹çš„é‡å¤éƒ½ä¼šè€—è´¹èµ„æºã€‚&lt;/p&gt;
&lt;p&gt;æ¯ä¸ªä»£ç†ä½¿ç”¨çš„å†…å­˜ä¸å®ƒéœ€è¦èƒ½å¤Ÿé€šä¿¡çš„æœåŠ¡æ•°é‡æœ‰å…³ã€‚Pranay Singhal å†™äº†ä»–é…ç½® Istio çš„&lt;a href=&#34;https://medium.com/geekculture/watch-out-for-this-istio-proxy-sidecar-memory-pitfall-8dbd99ea7e9d&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç»éªŒ&lt;/a&gt;ï¼Œå°†æ¯ä¸ªä»£ç†çš„æ¶ˆè€—ä» 1GB å·¦å³å‡å°‘åˆ°æ›´åˆç†çš„ 60-70MBã€‚ä½†æ˜¯ï¼Œå³ä½¿åœ¨æˆ‘ä»¬çš„å°ç¯å¢ƒä¸­ï¼Œåœ¨ä¸‰ä¸ªèŠ‚ç‚¹ä¸Šæœ‰ 100 ä¸ªä»£ç†ï¼Œè¿™ç§ä¼˜åŒ–é…ç½®ä»ç„¶éœ€è¦æ¯ä¸ªèŠ‚ç‚¹ 2GB å·¦å³ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-æ¥è‡ªredhatcomarchitectwhy-when-service-meshæ¯ä¸ªå¾®æœåŠ¡éƒ½æœ‰è‡ªå·±çš„ä»£ç†sidecar&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;æ¥è‡ª&amp;lt;a href=&amp;#34;https://redhat.com/architect/why-when-service-mesh&amp;#34; target=&amp;#34;_blank&amp;#34; rel=&amp;#34;noopener&amp;#34;&amp;gt;redhat.com/architect/why-when-service-mesh&amp;lt;/a&amp;gt;â€”â€”æ¯ä¸ªå¾®æœåŠ¡éƒ½æœ‰è‡ªå·±çš„ä»£ç†sidecar&#34; srcset=&#34;
               /blog/how-ebpf-streamlines-the-service-mesh/008i3skNly1gvtp69o74jj31w50u0jy8_hu75cdf8ad6ac0b3f98f9051bf67fd2e5c_260906_e82772dc16b0798bb43fb88f2ac134cc.webp 400w,
               /blog/how-ebpf-streamlines-the-service-mesh/008i3skNly1gvtp69o74jj31w50u0jy8_hu75cdf8ad6ac0b3f98f9051bf67fd2e5c_260906_fb23a1ea63de7ecc49e5bdb7fd35317a.webp 760w,
               /blog/how-ebpf-streamlines-the-service-mesh/008i3skNly1gvtp69o74jj31w50u0jy8_hu75cdf8ad6ac0b3f98f9051bf67fd2e5c_260906_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/how-ebpf-streamlines-the-service-mesh/008i3skNly1gvtp69o74jj31w50u0jy8_hu75cdf8ad6ac0b3f98f9051bf67fd2e5c_260906_e82772dc16b0798bb43fb88f2ac134cc.webp&#34;
               width=&#34;760&#34;
               height=&#34;334&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      æ¥è‡ª&amp;lt;a href=&amp;#34;https://redhat.com/architect/why-when-service-mesh&amp;#34; target=&amp;#34;_blank&amp;#34; rel=&amp;#34;noopener&amp;#34;&amp;gt;redhat.com/architect/why-when-service-mesh&amp;lt;/a&amp;gt;â€”â€”æ¯ä¸ªå¾®æœåŠ¡éƒ½æœ‰è‡ªå·±çš„ä»£ç†sidecar
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦æ‰€æœ‰è¿™äº› sidecarï¼Ÿè¿™ç§æ¨¡å¼å…è®¸ä»£ç†å®¹å™¨ä¸ pod ä¸­çš„åº”ç”¨å®¹å™¨å…±äº«ä¸€ä¸ªç½‘ç»œå‘½åç©ºé—´ã€‚ç½‘ç»œå‘½åç©ºé—´æ˜¯ Linux å†…æ ¸çš„ç»“æ„ï¼Œå®ƒå…è®¸å®¹å™¨å’Œ pod æ‹¥æœ‰è‡ªå·±ç‹¬ç«‹çš„ç½‘ç»œå †æ ˆï¼Œå°†å®¹å™¨åŒ–çš„åº”ç”¨ç¨‹åºç›¸äº’éš”ç¦»ã€‚è¿™ä½¿å¾—åº”ç”¨ä¹‹é—´äº’ä¸ç›¸å¹²ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆä½ å¯ä»¥è®©å°½å¯èƒ½å¤šçš„ pod åœ¨ 80 ç«¯å£ä¸Šè¿è¡Œä¸€ä¸ª web åº”ç”¨ â€”â€” ç½‘ç»œå‘½åç©ºé—´æ„å‘³ç€å®ƒä»¬å„è‡ªæ‹¥æœ‰è‡ªå·±çš„ 80 ç«¯å£ã€‚ä»£ç†å¿…é¡»å…±äº«ç›¸åŒçš„ç½‘ç»œå‘½åç©ºé—´ï¼Œè¿™æ ·å®ƒå°±å¯ä»¥æ‹¦æˆªå’Œå¤„ç†è¿›å‡ºåº”ç”¨å®¹å™¨çš„æµé‡ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å¼•å…¥-ebpf&#34;&gt;å¼•å…¥ eBPF&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;http://ebpf.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;eBPF&lt;/a&gt; æ˜¯ä¸€ç§å†…æ ¸æŠ€æœ¯ï¼Œå…è®¸è‡ªå®šä¹‰ç¨‹åºåœ¨å†…æ ¸ä¸­è¿è¡Œã€‚è¿™äº›ç¨‹åºåœ¨å“åº”äº‹ä»¶æ—¶è¿è¡Œï¼Œæœ‰æˆåƒä¸Šä¸‡ä¸ªå¯èƒ½çš„äº‹ä»¶ï¼ŒeBPF ç¨‹åºå¯ä»¥è¢«é™„åŠ åˆ°è¿™äº›äº‹ä»¶ä¸Šã€‚è¿™äº›äº‹ä»¶åŒ…æ‹¬è½¨è¿¹ç‚¹ã€è¿›å…¥æˆ–é€€å‡ºä»»ä½•åŠŸèƒ½ï¼ˆåœ¨å†…æ ¸æˆ–ç”¨æˆ·ç©ºé—´ï¼‰æˆ–å¯¹æœåŠ¡ç½‘æ ¼æ¥è¯´å¾ˆé‡è¦çš„ â€”â€” æŠµè¾¾çš„ç½‘ç»œæ•°æ®åŒ…ã€‚&lt;/p&gt;
&lt;p&gt;é‡è¦çš„æ˜¯ï¼Œ&lt;strong&gt;æ¯ä¸ªèŠ‚ç‚¹åªæœ‰ä¸€ä¸ªå†…æ ¸&lt;/strong&gt;ï¼›åœ¨ä¸€ä¸ªèŠ‚ç‚¹ä¸Šè¿è¡Œçš„æ‰€æœ‰å®¹å™¨ï¼ˆä¹Ÿå°±æ˜¯æ‰€æœ‰çš„ podï¼‰å…±äº«åŒä¸€ä¸ªå†…æ ¸ã€‚å¦‚æœä½ åœ¨å†…æ ¸ä¸­æ·»åŠ ä¸€ä¸ª eBPF ç¨‹åºåˆ°ä¸€ä¸ªäº‹ä»¶ä¸­ï¼Œå®ƒå°†è¢«è§¦å‘ï¼Œæ— è®ºå“ªä¸ªè¿›ç¨‹å¼•èµ·è¯¥äº‹ä»¶ï¼Œæ— è®ºå®ƒæ˜¯åœ¨åº”ç”¨å®¹å™¨ä¸­è¿è¡Œè¿˜æ˜¯ç›´æ¥è¿è¡Œåœ¨ä¸»æœºä¸Šã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-æ¯å°ä¸»æœºä¸€ä¸ªå†…æ ¸&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;æ¯å°ä¸»æœºä¸€ä¸ªå†…æ ¸&#34; srcset=&#34;
               /blog/how-ebpf-streamlines-the-service-mesh/008i3skNly1gvtp6c8mn9j31ea0u0n0t_huccdd52df4dca33c37eced58c2e8ea8ae_143240_847d0bf365ee18cfcdd849278134a758.webp 400w,
               /blog/how-ebpf-streamlines-the-service-mesh/008i3skNly1gvtp6c8mn9j31ea0u0n0t_huccdd52df4dca33c37eced58c2e8ea8ae_143240_db8f980112e5dfb449eac44c9bb97115.webp 760w,
               /blog/how-ebpf-streamlines-the-service-mesh/008i3skNly1gvtp6c8mn9j31ea0u0n0t_huccdd52df4dca33c37eced58c2e8ea8ae_143240_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/how-ebpf-streamlines-the-service-mesh/008i3skNly1gvtp6c8mn9j31ea0u0n0t_huccdd52df4dca33c37eced58c2e8ea8ae_143240_847d0bf365ee18cfcdd849278134a758.webp&#34;
               width=&#34;760&#34;
               height=&#34;453&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      æ¯å°ä¸»æœºä¸€ä¸ªå†…æ ¸
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ eBPF å¯¹äº Kubernetes ä¸­çš„ä»»ä½•ä¸€ç§ instrumentation æ¥è¯´éƒ½æ˜¯å¦‚æ­¤ä»¤äººå…´å¥‹çš„æŠ€æœ¯ â€”â€” ä½ åªéœ€è¦åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šæ·»åŠ ä¸€æ¬¡ instrumentation ï¼Œæ‰€æœ‰çš„åº”ç”¨ç¨‹åº pod éƒ½ä¼šè¢«è¦†ç›–ã€‚æ— è®ºä½ æ˜¯åœ¨å¯»æ±‚å¯è§‚æµ‹æ€§ã€å®‰å…¨æ€§è¿˜æ˜¯ç½‘ç»œï¼Œç”± eBPF é©±åŠ¨çš„è§£å†³æ–¹æ¡ˆéƒ½å¯ä»¥åœ¨ä¸éœ€è¦ sidecar çš„æƒ…å†µä¸‹å¯¹åº”ç”¨è¿›è¡Œæ£€æµ‹ã€‚&lt;/p&gt;
&lt;p&gt;åŸºäº eBPF çš„ &lt;a href=&#34;http://cilium.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Cilium&lt;/a&gt; é¡¹ç›®ï¼ˆæœ€è¿‘ &lt;a href=&#34;https://www.cncf.io/blog/2021/10/13/cilium-joins-cncf-as-an-incubating-project/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä»¥å­µåŒ–çº§åˆ«åŠ å…¥äº‘è®¡ç®—åŸºé‡‘ä¼š&lt;/a&gt;ï¼‰å°†è¿™ç§ â€œæ—  sidecar&amp;quot; æ¨¡å¼å¸¦åˆ°äº†æœåŠ¡ç½‘æ ¼çš„ä¸–ç•Œã€‚é™¤äº†ä¼ ç»Ÿçš„ sidecar æ¨¡å‹ï¼ŒCilium è¿˜æ”¯æŒæ¯ä¸ªèŠ‚ç‚¹ä½¿ç”¨ä¸€ä¸ª Envoy ä»£ç†å®ä¾‹è¿è¡ŒæœåŠ¡ç½‘æ ¼çš„æ•°æ®å¹³é¢ã€‚ä½¿ç”¨æˆ‘ä»¬å‰é¢çš„ä¾‹å­ï¼Œè¿™å°±æŠŠä»£ç†å®ä¾‹çš„æ•°é‡ä» 100 ä¸ªå‡å°‘åˆ°åªæœ‰ 3 ä¸ªã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-ç”¨æ— sidecarä»£ç†æ¨¡å¼å‡å°‘ä»£ç†å®ä¾‹&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;ç”¨æ— sidecarä»£ç†æ¨¡å¼å‡å°‘ä»£ç†å®ä¾‹&#34; srcset=&#34;
               /blog/how-ebpf-streamlines-the-service-mesh/008i3skNly1gvtp67ocjkj31xt0u0jvp_hu3d32db78b48b2e257874198dc348cb5b_165479_b7de8ef9d83f49c194072ed86daeb771.webp 400w,
               /blog/how-ebpf-streamlines-the-service-mesh/008i3skNly1gvtp67ocjkj31xt0u0jvp_hu3d32db78b48b2e257874198dc348cb5b_165479_df1496e3029f185d02ebf3eb8de2416b.webp 760w,
               /blog/how-ebpf-streamlines-the-service-mesh/008i3skNly1gvtp67ocjkj31xt0u0jvp_hu3d32db78b48b2e257874198dc348cb5b_165479_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/how-ebpf-streamlines-the-service-mesh/008i3skNly1gvtp67ocjkj31xt0u0jvp_hu3d32db78b48b2e257874198dc348cb5b_165479_b7de8ef9d83f49c194072ed86daeb771.webp&#34;
               width=&#34;760&#34;
               height=&#34;327&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      ç”¨æ— sidecarä»£ç†æ¨¡å¼å‡å°‘ä»£ç†å®ä¾‹
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h2 id=&#34;å‡å°‘-yaml&#34;&gt;å‡å°‘ YAML&lt;/h2&gt;
&lt;p&gt;åœ¨ sidecar æ¨¡å‹ä¸­ï¼ŒæŒ‡å®šæ¯ä¸ªåº”ç”¨ pod çš„ YAML éœ€è¦è¢«ä¿®æ”¹ä»¥æ·»åŠ  sidecar å®¹å™¨ã€‚è¿™é€šå¸¸æ˜¯è‡ªåŠ¨åŒ–çš„ â€”â€” ä¾‹å¦‚ï¼Œä½¿ç”¨ä¸€ä¸ª mutating webhookï¼Œåœ¨æ¯ä¸ªåº”ç”¨ pod éƒ¨ç½²çš„æ—¶å€™æ³¨å…¥ sidecarã€‚&lt;/p&gt;
&lt;p&gt;ä»¥ Istio ä¸ºä¾‹ï¼Œè¿™éœ€è¦&lt;a href=&#34;https://istio.io/latest/docs/setup/additional-setup/sidecar-injection/#controlling-the-injection-policy&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ ‡è®°&lt;/a&gt; Kubernetes å‘½åç©ºé—´å’Œ / æˆ– podï¼Œä»¥å®šä¹‰æ˜¯å¦åº”è¯¥æ³¨å…¥ sidecarâ€”â€” å½“ç„¶ä¹Ÿéœ€è¦ä¸ºé›†ç¾¤å¯ç”¨ mutating webhookã€‚&lt;/p&gt;
&lt;p&gt;ä½†å¦‚æœå‡ºäº†é—®é¢˜æ€ä¹ˆåŠï¼Ÿå¦‚æœå‘½åç©ºé—´æˆ– pod çš„æ ‡ç­¾ä¸æ­£ç¡®ï¼Œé‚£ä¹ˆ sidecar å°†ä¸ä¼šè¢«æ³¨å…¥ï¼Œpod å°†ä¸ä¼šè¢«è¿æ¥åˆ°æœåŠ¡ç½‘æ ¼ã€‚æ›´ç³Ÿç³•çš„æ˜¯ï¼Œå¦‚æœæ”»å‡»è€…ç ´åäº†é›†ç¾¤ï¼Œå¹¶èƒ½å¤Ÿè¿è¡Œä¸€ä¸ªæ¶æ„çš„å·¥ä½œè´Ÿè½½ â€”â€” ä¾‹å¦‚ï¼Œä¸€ä¸ªåŠ å¯†è´§å¸çŸ¿å·¥ï¼Œä»–ä»¬å°†ä¸å¤ªå¯èƒ½æ ‡è®°å®ƒï¼Œä»¥ä¾¿å®ƒåŠ å…¥æœåŠ¡ç½‘æ ¼ã€‚å®ƒä¸ä¼šé€šè¿‡æœåŠ¡ç½‘æ ¼æä¾›çš„æµé‡è§‚å¯Ÿèƒ½åŠ›è€Œè¢«å‘ç°ã€‚&lt;/p&gt;
&lt;p&gt;ç›¸æ¯”ä¹‹ä¸‹ï¼Œåœ¨æ”¯æŒ eBPF çš„æ—  sidecar ä»£ç†æ¨¡å‹ä¸­ï¼Œpod ä¸éœ€è¦ä»»ä½•é¢å¤–çš„ YAML å°±å¯ä»¥è¢«æ£€æµ‹ã€‚ç›¸åï¼Œä¸€ä¸ª CRD è¢«ç”¨æ¥åœ¨é›†ç¾¤èŒƒå›´å†…é…ç½®æœåŠ¡ç½‘æ ¼ã€‚å³ä½¿æ˜¯å·²ç»å­˜åœ¨çš„ pod ä¹Ÿå¯ä»¥æˆä¸ºæœåŠ¡ç½‘æ ¼çš„ä¸€éƒ¨åˆ†ï¼Œè€Œä¸éœ€è¦é‡æ–°å¯åŠ¨ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæ”»å‡»è€…è¯•å›¾é€šè¿‡ç›´æ¥åœ¨ä¸»æœºä¸Šè¿è¡Œå·¥ä½œè´Ÿè½½æ¥ç»•è¿‡ Kubernetes ç¼–æ’ï¼ŒeBPF ç¨‹åºå¯ä»¥æ£€æµ‹å¹¶æ§åˆ¶è¿™ä¸€æ´»åŠ¨ï¼Œå› ä¸ºè¿™ä¸€åˆ‡éƒ½å¯ä»¥ä»å†…æ ¸çœ‹åˆ°ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ebpf-æ”¯æŒçš„ç½‘ç»œæ•ˆç‡&#34;&gt;eBPF æ”¯æŒçš„ç½‘ç»œæ•ˆç‡&lt;/h2&gt;
&lt;p&gt;æ”¯æŒ eBPF çš„ç½‘ç»œå…è®¸æ•°æ®åŒ…èµ°æ·å¾„ï¼Œç»•è¿‡å†…æ ¸çš„éƒ¨åˆ†ç½‘ç»œå †æ ˆï¼Œè¿™å¯ä»¥ä½¿ Kubernetes ç½‘ç»œçš„&lt;a href=&#34;https://cilium.io/blog/2021/05/11/cni-benchmark&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ€§èƒ½å¾—åˆ°æ˜¾è‘—æ”¹å–„&lt;/a&gt;ã€‚è®©æˆ‘ä»¬çœ‹çœ‹è¿™åœ¨æœåŠ¡ç½‘æ ¼æ•°æ®å¹³é¢ä¸­æ˜¯å¦‚ä½•åº”ç”¨çš„ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-åœ¨ebpfåŠ é€Ÿæ— sidecarçš„æœåŠ¡ç½‘æ ¼æ¨¡å‹ä¸­ç½‘ç»œæ•°æ®åŒ…é€šè¿‡çš„è·¯å¾„è¦çŸ­å¾—å¤š&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;åœ¨eBPFåŠ é€Ÿã€æ— sidecarçš„æœåŠ¡ç½‘æ ¼æ¨¡å‹ä¸­ï¼Œç½‘ç»œæ•°æ®åŒ…é€šè¿‡çš„è·¯å¾„è¦çŸ­å¾—å¤š&#34; srcset=&#34;
               /blog/how-ebpf-streamlines-the-service-mesh/008i3skNly1gvtp6ao3lqj31q90u0gqw_hu2dc6a1f8e53eb927656788db4b31bc51_202323_7a9a484930ac06c27ab63979ee78513d.webp 400w,
               /blog/how-ebpf-streamlines-the-service-mesh/008i3skNly1gvtp6ao3lqj31q90u0gqw_hu2dc6a1f8e53eb927656788db4b31bc51_202323_f6be66e36d0a6d7b08ee504b51dfc6b7.webp 760w,
               /blog/how-ebpf-streamlines-the-service-mesh/008i3skNly1gvtp6ao3lqj31q90u0gqw_hu2dc6a1f8e53eb927656788db4b31bc51_202323_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/how-ebpf-streamlines-the-service-mesh/008i3skNly1gvtp6ao3lqj31q90u0gqw_hu2dc6a1f8e53eb927656788db4b31bc51_202323_7a9a484930ac06c27ab63979ee78513d.webp&#34;
               width=&#34;760&#34;
               height=&#34;366&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      åœ¨eBPFåŠ é€Ÿã€æ— sidecarçš„æœåŠ¡ç½‘æ ¼æ¨¡å‹ä¸­ï¼Œç½‘ç»œæ•°æ®åŒ…é€šè¿‡çš„è·¯å¾„è¦çŸ­å¾—å¤š
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;åœ¨æœåŠ¡ç½‘æ ¼çš„æƒ…å†µä¸‹ï¼Œä»£ç†åœ¨ä¼ ç»Ÿç½‘ç»œä¸­ä½œä¸º sidecar è¿è¡Œï¼Œæ•°æ®åŒ…åˆ°è¾¾åº”ç”¨ç¨‹åºçš„è·¯å¾„ç›¸å½“æ›²æŠ˜ï¼šå…¥ç«™æ•°æ®åŒ…å¿…é¡»ç©¿è¶Šä¸»æœº TCP/IP æ ˆï¼Œé€šè¿‡è™šæ‹Ÿä»¥å¤ªç½‘è¿æ¥åˆ°è¾¾ pod çš„ç½‘ç»œå‘½åç©ºé—´ã€‚ä»é‚£é‡Œï¼Œæ•°æ®åŒ…å¿…é¡»ç©¿è¿‡ pod çš„ç½‘ç»œå †æ ˆåˆ°è¾¾ä»£ç†ï¼Œä»£ç†å°†æ•°æ®åŒ…é€šè¿‡å›ç¯æ¥å£è½¬å‘åˆ°åº”ç”¨ç¨‹åºã€‚è€ƒè™‘åˆ°æµé‡å¿…é¡»åœ¨è¿æ¥çš„ä¸¤ç«¯æµç»ä»£ç†ï¼Œä¸éæœåŠ¡ç½‘æ ¼æµé‡ç›¸æ¯”ï¼Œè¿™å°†å¯¼è‡´å»¶è¿Ÿçš„&lt;a href=&#34;https://linkerd.io/2021/05/27/linkerd-vs-istio-benchmarks/#latency-at-20-rps&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ˜¾è‘—å¢åŠ &lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;åŸºäº eBPF çš„ Kubernetes CNI å®ç°ï¼Œå¦‚ Ciliumï¼Œå¯ä»¥ä½¿ç”¨ eBPF ç¨‹åºï¼Œæ˜æ™ºåœ°é’©ä½å†…æ ¸ä¸­çš„ç‰¹å®šç‚¹ï¼Œæ²¿ç€æ›´ç›´æ¥çš„è·¯çº¿é‡å®šå‘æ•°æ®åŒ…ã€‚è¿™æ˜¯å¯èƒ½çš„ï¼Œå› ä¸º Cilium çŸ¥é“æ‰€æœ‰çš„ Kubernetes ç«¯ç‚¹å’ŒæœåŠ¡çš„èº«ä»½ã€‚å½“æ•°æ®åŒ…åˆ°è¾¾ä¸»æœºæ—¶ï¼ŒCilium å¯ä»¥å°†å…¶ç›´æ¥åˆ†é…åˆ°å®ƒæ‰€è¦å»çš„ä»£ç†æˆ– Pod ç«¯ç‚¹ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç½‘ç»œä¸­çš„åŠ å¯†&#34;&gt;ç½‘ç»œä¸­çš„åŠ å¯†&lt;/h2&gt;
&lt;p&gt;å¦‚æœä¸€ä¸ªç½‘ç»œè§£å†³æ–¹æ¡ˆèƒ½å¤Ÿæ„è¯†åˆ° Kubernetes æœåŠ¡ï¼Œå¹¶åœ¨è¿™äº›æœåŠ¡çš„ç«¯ç‚¹ä¹‹é—´æä¾›ç½‘ç»œè¿æ¥ï¼Œé‚£ä¹ˆå®ƒèƒ½å¤Ÿæä¾›æœåŠ¡ç½‘æ ¼æ•°æ®å¹³é¢çš„èƒ½åŠ›å°±ä¸è¶³ä¸ºå¥‡ã€‚ä½†è¿™äº›èƒ½åŠ›å¯ä»¥è¶…è¶ŠåŸºæœ¬çš„è¿æ¥ã€‚ä¸€ä¸ªä¾‹å­æ˜¯é€æ˜åŠ å¯†ã€‚&lt;/p&gt;
&lt;p&gt;é€šå¸¸ä½¿ç”¨æœåŠ¡ç½‘æ ¼æ¥ç¡®ä¿æ‰€æœ‰çš„åº”ç”¨æµé‡éƒ½æ˜¯ç»è¿‡è®¤è¯å’ŒåŠ å¯†çš„ã€‚è¿™æ˜¯é€šè¿‡åŒå‘ TLSï¼ˆmTLSï¼‰å®ç°çš„ï¼›æœåŠ¡ç½‘æ ¼ä»£ç†ç»„ä»¶ä½œä¸ºç½‘ç»œè¿æ¥çš„ç«¯ç‚¹ï¼Œå¹¶ä¸å…¶è¿œç¨‹å¯¹ç­‰ç‰©åå•†ä¸€ä¸ªå®‰å…¨çš„ TLS è¿æ¥ã€‚è¿™ç§è¿æ¥å¯¹ä»£ç†ä¹‹é—´çš„é€šä¿¡è¿›è¡ŒåŠ å¯†ï¼Œè€Œä¸éœ€è¦å¯¹åº”ç”¨ç¨‹åºåšä»»ä½•æ”¹å˜ã€‚&lt;/p&gt;
&lt;p&gt;ä½†åœ¨åº”ç”¨å±‚ç®¡ç†çš„ TLS å¹¶ä¸æ˜¯å®ç°ç»„ä»¶é—´è®¤è¯å’ŒåŠ å¯†æµé‡çš„å”¯ä¸€æ–¹æ³•ã€‚å¦ä¸€ä¸ªé€‰æ‹©æ˜¯åœ¨ç½‘ç»œå±‚åŠ å¯†æµé‡ï¼Œä½¿ç”¨ &lt;a href=&#34;https://cilium.io/blog/2021/05/11/cni-benchmark#the-cost-of-encryption---wireguard-vs-ipsec&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;IPSec æˆ– WireGuard&lt;/a&gt;ã€‚å› ä¸ºå®ƒåœ¨ç½‘ç»œå±‚æ“ä½œï¼Œè¿™ç§åŠ å¯†ä¸ä»…å¯¹åº”ç”¨ç¨‹åºå®Œå…¨é€æ˜ï¼Œè€Œä¸”å¯¹ä»£ç†ä¹Ÿæ˜¯é€æ˜çš„ â€”â€” å®ƒå¯ä»¥åœ¨æœ‰æˆ–æ²¡æœ‰æœåŠ¡ç½‘æ ¼æ—¶å¯ç”¨ã€‚å¦‚æœä½ ä½¿ç”¨æœåŠ¡ç½‘æ ¼çš„å”¯ä¸€åŸå› æ˜¯æä¾›åŠ å¯†ï¼Œä½ å¯èƒ½æƒ³è€ƒè™‘ç½‘ç»œçº§åŠ å¯†ã€‚å®ƒä¸ä»…æ›´ç®€å•ï¼Œè€Œä¸”è¿˜å¯ä»¥ç”¨æ¥éªŒè¯å’ŒåŠ å¯†èŠ‚ç‚¹ä¸Šçš„ä»»ä½•æµé‡ â€”â€” å®ƒä¸åªé™äºé‚£äº›å¯ç”¨äº† sidecar çš„å·¥ä½œè´Ÿè½½ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ebpf-æ˜¯æœåŠ¡ç½‘æ ¼çš„æ•°æ®å¹³é¢&#34;&gt;eBPF æ˜¯æœåŠ¡ç½‘æ ¼çš„æ•°æ®å¹³é¢&lt;/h2&gt;
&lt;p&gt;ç°åœ¨ï¼ŒeBPF åœ¨ Linux ç”Ÿäº§å‘è¡Œç‰ˆä½¿ç”¨çš„å†…æ ¸ç‰ˆæœ¬ä¸­å¾—åˆ°å¹¿æ³›æ”¯æŒï¼Œä¼ä¸šå¯ä»¥åˆ©ç”¨å®ƒæ¥è·å¾—æ›´æœ‰æ•ˆçš„ç½‘ç»œè§£å†³æ–¹æ¡ˆï¼Œå¹¶ä½œä¸ºæœåŠ¡ç½‘æ ¼çš„æ›´æœ‰æ•ˆçš„æ•°æ®å¹³é¢ã€‚&lt;/p&gt;
&lt;p&gt;å»å¹´ï¼Œæˆ‘ä»£è¡¨ &lt;a href=&#34;https://cncf.io/?utm_content=inline-mention&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;CNCF&lt;/a&gt; çš„æŠ€æœ¯ç›‘ç£å§”å‘˜ä¼šï¼Œå¯¹æœåŠ¡ç½‘æ ¼é¢†åŸŸçš„æ•´åˆå’Œæ¸…æ™°åŒ–åšäº†ä¸€äº› &lt;a href=&#34;https://youtu.be/bESogtuHwX0&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;é¢„æµ‹&lt;/a&gt;ã€‚åœ¨åŒä¸€ä¸»é¢˜æ¼”è®²ä¸­ï¼Œæˆ‘è°ˆåˆ° eBPF æœ‰å¯èƒ½æˆä¸ºæ›´å¤šé¡¹ç›®å’Œæ›´å¹¿æ³›éƒ¨ç½²èƒ½åŠ›çš„åŸºç¡€ã€‚è¿™ä¸¤ä¸ªæƒ³æ³•ç°åœ¨æ­£ç»“åˆåœ¨ä¸€èµ·ï¼Œå› ä¸º eBPF ä¼¼ä¹æ˜¯æœåŠ¡ç½‘æ ¼æ•°æ®å¹³é¢çš„è‡ªç„¶è·¯å¾„ã€‚&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>æœåŠ¡ç½‘æ ¼ç»ˆææŒ‡å—ç¬¬äºŒç‰ˆâ€”â€”ä¸‹ä¸€ä»£å¾®æœåŠ¡å¼€å‘</title>
      <link>https://lib.jimmysong.io/blog/service-mesh-ultimate-guide-e2/</link>
      <pubDate>Mon, 11 Oct 2021 10:00:00 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/service-mesh-ultimate-guide-e2/</guid>
      <description>&lt;h2 id=&#34;ä¸»è¦æ”¶è·&#34;&gt;ä¸»è¦æ”¶è·&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;äº†è§£é‡‡ç”¨æœåŠ¡ç½‘æ ¼æŠ€æœ¯çš„æ–°å…´æ¶æ„è¶‹åŠ¿ï¼Œç‰¹åˆ«æ˜¯å¤šäº‘ã€å¤šé›†ç¾¤å’Œå¤šç§Ÿæˆ·æ¨¡å¼ï¼Œå¦‚ä½•åœ¨å¼‚æ„åŸºç¡€è®¾æ–½ï¼ˆè£¸æœºã€è™šæ‹Ÿæœºå’Œ Kubernetesï¼‰ä¸­éƒ¨ç½²æœåŠ¡ç½‘æ ¼è§£å†³æ–¹æ¡ˆï¼Œä»¥åŠä»è¾¹ç¼˜è®¡ç®—å±‚åˆ°ç½‘æ ¼çš„åº”ç”¨ / æœåŠ¡è¿æ¥ã€‚&lt;/li&gt;
&lt;li&gt;äº†è§£æœåŠ¡ç½‘æ ¼ç”Ÿæ€ç³»ç»Ÿä¸­çš„ä¸€äº›æ–°æ¨¡å¼ï¼Œå¦‚å¤šé›†ç¾¤æœåŠ¡ç½‘æ ¼ã€åª’ä½“æœåŠ¡ç½‘æ ¼ï¼ˆMedia Service Meshï¼‰å’Œæ··æ²Œç½‘æ ¼ï¼Œä»¥åŠç»å…¸çš„å¾®æœåŠ¡åæ¨¡å¼ï¼Œå¦‚ â€œæ­»æ˜Ÿï¼ˆDeath Starï¼‰ â€œæ¶æ„ã€‚&lt;/li&gt;
&lt;li&gt;è·å–æœ€æ–°çš„å…³äºåœ¨éƒ¨ç½²é¢†åŸŸä½¿ç”¨æœåŠ¡ç½‘æ ¼çš„åˆ›æ–°æ€»ç»“ï¼Œåœ¨ Podï¼ˆK8s é›†ç¾¤ï¼‰å’Œ VMï¼ˆé K8s é›†ç¾¤ï¼‰ä¹‹é—´è¿›è¡Œå¿«é€Ÿå®éªŒã€æ··ä¹±å·¥ç¨‹å’Œé‡‘ä¸é›€éƒ¨ç½²ã€‚&lt;/li&gt;
&lt;li&gt;æ¢ç´¢æœåŠ¡ç½‘æ ¼æ‰©å±•é¢†åŸŸçš„åˆ›æ–°ï¼ŒåŒ…æ‹¬ï¼šå¢å¼ºèº«ä»½ç®¡ç†ï¼Œä»¥ç¡®ä¿å¾®æœåŠ¡è¿æ¥çš„å®‰å…¨æ€§ï¼ŒåŒ…æ‹¬è‡ªå®šä¹‰è¯ä¹¦æˆæƒæ’ä»¶ï¼Œè‡ªé€‚åº”è·¯ç”±åŠŸèƒ½ï¼Œä»¥æé«˜æœåŠ¡çš„å¯ç”¨æ€§å’Œå¯æ‰©å±•æ€§ï¼Œä»¥åŠå¢å¼º sidecar ä»£ç†ã€‚&lt;/li&gt;
&lt;li&gt;äº†è§£æ“ä½œæ–¹é¢å³å°†å‡ºç°çš„æƒ…å†µï¼Œå¦‚é…ç½®å¤šé›†ç¾¤åŠŸèƒ½å’Œå°† Kubernetes å·¥ä½œè´Ÿè½½è¿æ¥åˆ°æ‰˜ç®¡åœ¨è™šæ‹ŸæœºåŸºç¡€è®¾æ–½ä¸Šçš„æœåŠ¡å™¨ï¼Œä»¥åŠç®¡ç†å¤šé›†ç¾¤æœåŠ¡ç½‘æ ¼ä¸­æ‰€æœ‰åŠŸèƒ½å’Œ API çš„å¼€å‘è€…é—¨æˆ·ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åœ¨è¿‡å»çš„å‡ å¹´é‡Œï¼ŒæœåŠ¡ç½‘æ ¼æŠ€æœ¯æœ‰äº†é•¿è¶³çš„å‘å±•ã€‚æœåŠ¡ç½‘æ ¼åœ¨å„ç»„ç»‡é‡‡ç”¨äº‘åŸç”ŸæŠ€æœ¯æ–¹é¢å‘æŒ¥ç€é‡è¦ä½œç”¨ã€‚é€šè¿‡æä¾›å››ç§ä¸»è¦èƒ½åŠ› â€”â€” è¿æ¥æ€§ã€å¯é æ€§ã€å¯è§‚æµ‹æ€§å’Œå®‰å…¨æ€§ï¼ŒæœåŠ¡ç½‘æ ¼å·²ç»æˆä¸º IT ç»„ç»‡çš„æŠ€æœ¯å’ŒåŸºç¡€è®¾æ–½ç°ä»£åŒ–å·¥ä½œçš„æ ¸å¿ƒç»„æˆéƒ¨åˆ†ã€‚æœåŠ¡ç½‘æ ¼ä½¿å¼€å‘å’Œè¿ç»´å›¢é˜Ÿèƒ½å¤Ÿåœ¨åŸºç¡€è®¾æ–½å±‚é¢å®ç°è¿™äº›èƒ½åŠ›ï¼Œå› æ­¤ï¼Œå½“æ¶‰åŠåˆ°è·¨é¢†åŸŸçš„éåŠŸèƒ½éœ€æ±‚æ—¶ï¼Œåº”ç”¨å›¢é˜Ÿä¸éœ€è¦é‡æ–°å‘æ˜è½®å­ã€‚&lt;/p&gt;
&lt;p&gt;è‡ªæœ¬æ–‡&lt;a href=&#34;https://www.infoq.com/articles/service-mesh-ultimate-guide/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç¬¬ä¸€ç‰ˆ&lt;/a&gt;äº 2020 å¹´ 2 æœˆå‘è¡¨ä»¥æ¥ï¼ŒæœåŠ¡ç½‘æ ¼æŠ€æœ¯ç»å†äº†é‡å¤§åˆ›æ–°ï¼Œåœ¨ä¸æ–­å‘å±•çš„æœåŠ¡ç½‘æ ¼é¢†åŸŸå‡ºç°äº†ä¸€äº›æ–°çš„æ¶æ„è¶‹åŠ¿ã€æŠ€æœ¯èƒ½åŠ›å’ŒæœåŠ¡ç½‘æ ¼é¡¹ç›®ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿‡å»çš„ä¸€å¹´é‡Œï¼ŒæœåŠ¡ç½‘æ ¼äº§å“çš„å‘å±•è¿œè¿œè¶…è¿‡äº†åŸæœ‰çš„ Kubernetes è§£å†³æ–¹æ¡ˆï¼Œæ²¡æœ‰æ‰˜ç®¡åœ¨ Kubernetes å¹³å°ä¸Šçš„åº”ç”¨æ— æ³•åˆ©ç”¨æœåŠ¡ç½‘æ ¼ã€‚å¹¶éæ‰€æœ‰çš„ç»„ç»‡éƒ½å°†å…¶æ‰€æœ‰çš„ä¸šåŠ¡å’Œ IT åº”ç”¨ç¨‹åºè¿‡æ¸¡åˆ° Kubernetes äº‘å¹³å°ã€‚å› æ­¤ï¼Œè‡ªæœåŠ¡ç½‘æ ¼è¯ç”Ÿä»¥æ¥ï¼Œä¸€ç›´éœ€è¦è¿™é¡¹æŠ€æœ¯åœ¨ä¸åŒçš„ IT åŸºç¡€è®¾æ–½ç¯å¢ƒä¸­å·¥ä½œã€‚&lt;/p&gt;
&lt;p&gt;éšç€å¾®æœåŠ¡æ¶æ„çš„ä¸æ–­é‡‡ç”¨ï¼Œåº”ç”¨ç³»ç»Ÿåœ¨äº‘ä¾›åº”å•†ã€åŸºç¡€è®¾æ–½ï¼ˆKubernetesã€è™šæ‹Ÿæœºã€è£¸æœºæœåŠ¡å™¨ï¼‰ã€åœ°åŸŸï¼Œç”šè‡³åœ¨æœåŠ¡ç½‘æ ¼é›†æˆç¯å¢ƒä¸­è¦ç®¡ç†çš„å·¥ä½œè´Ÿè½½ç±»å‹æ–¹é¢ï¼Œéƒ½å·²å®ç°è§£è€¦å’Œåˆ†å¸ƒå¼ã€‚&lt;/p&gt;
&lt;p&gt;è®©æˆ‘ä»¬ä»æœåŠ¡ç½‘æ ¼çš„å†å²å¼€å§‹è¯´èµ·ï¼Œäº†è§£æœåŠ¡ç½‘æ ¼æ˜¯å¦‚ä½•äº§ç”Ÿçš„ã€‚&lt;/p&gt;
&lt;p&gt;2016 å¹´å‰åï¼Œâ€œæœåŠ¡ç½‘æ ¼ &amp;quot; è¿™ä¸ªè¯å‡ºç°åœ¨å¾®æœåŠ¡ã€äº‘è®¡ç®—å’Œ DevOps çš„é¢†åŸŸã€‚Buoyant å›¢é˜Ÿåœ¨ 2016 å¹´ç”¨&lt;a href=&#34;https://twitter.com/wm/status/1383061764938469377?s=20&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è¿™ä¸ª&lt;/a&gt;è¯æ¥è§£é‡Šä»–ä»¬çš„äº§å“ Linkerdã€‚å’Œäº‘è®¡ç®—é¢†åŸŸçš„è®¸å¤šæ¦‚å¿µä¸€æ ·ï¼Œç›¸å…³çš„æ¨¡å¼å’ŒæŠ€æœ¯å…¶å®æœ‰å¾ˆé•¿çš„å†å²ã€‚&lt;/p&gt;
&lt;p&gt;æœåŠ¡ç½‘æ ¼çš„åˆ°æ¥ä¸»è¦æ˜¯ç”±äº IT é¢†åŸŸå†…çš„ä¸€åœºé£æš´ã€‚å¼€å‘äººå‘˜å¼€å§‹ä½¿ç”¨å¤šè¯­è¨€ï¼ˆpolyglotï¼‰æ–¹æ³•æ„å»ºåˆ†å¸ƒå¼ç³»ç»Ÿï¼Œå¹¶éœ€è¦åŠ¨æ€æœåŠ¡å‘ç°ã€‚è¿ç»´éƒ¨é—¨å¼€å§‹ä½¿ç”¨çŸ­æš‚çš„åŸºç¡€è®¾æ–½ï¼Œå¹¶å¸Œæœ›ä¼˜é›…åœ°å¤„ç†ä¸å¯é¿å…çš„é€šä¿¡æ•…éšœå’Œæ‰§è¡Œç½‘ç»œç­–ç•¥ã€‚å¹³å°å›¢é˜Ÿå¼€å§‹æ¥å—åƒ Kubernetes è¿™æ ·çš„å®¹å™¨ç¼–æ’ç³»ç»Ÿï¼Œå¹¶å¸Œæœ›ä½¿ç”¨ç°ä»£ API é©±åŠ¨çš„ç½‘ç»œä»£ç†ï¼ˆå¦‚ Envoyï¼‰åœ¨ç³»ç»Ÿä¸­å’Œå‘¨å›´åŠ¨æ€åœ°è·¯ç”±æµé‡ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡æ—¨åœ¨å›ç­”è½¯ä»¶æ¶æ„å¸ˆå’ŒæŠ€æœ¯è´Ÿè´£äººçš„ç›¸å…³é—®é¢˜ï¼Œå¦‚ï¼šä»€ä¹ˆæ˜¯æœåŠ¡ç½‘æ ¼ï¼Ÿæˆ‘æ˜¯å¦éœ€è¦æœåŠ¡ç½‘æ ¼ï¼Ÿå¦‚ä½•è¯„ä¼°ä¸åŒçš„æœåŠ¡ç½‘æ ¼äº§å“ï¼Ÿ&lt;/p&gt;
&lt;h2 id=&#34;æœåŠ¡ç½‘æ ¼æ¨¡å¼&#34;&gt;æœåŠ¡ç½‘æ ¼æ¨¡å¼&lt;/h2&gt;
&lt;p&gt;æœåŠ¡ç½‘æ ¼æ¨¡å¼ä¸“æ³¨äºç®¡ç†åˆ†å¸ƒå¼è½¯ä»¶ç³»ç»Ÿä¸­æ‰€æœ‰æœåŠ¡ä¹‹é—´çš„é€šä¿¡ã€‚&lt;/p&gt;
&lt;h3 id=&#34;èƒŒæ™¯ä»‹ç»&#34;&gt;èƒŒæ™¯ä»‹ç»&lt;/h3&gt;
&lt;p&gt;è¯¥æ¨¡å¼çš„èƒŒæ™¯æœ‰ä¸¤ä¸ªæ–¹é¢ã€‚é¦–å…ˆï¼Œå·¥ç¨‹å¸ˆä»¬å·²ç»é‡‡ç”¨äº†å¾®æœåŠ¡æ¶æ„æ¨¡å¼ï¼Œå¹¶é€šè¿‡å°†å¤šä¸ªï¼ˆç†æƒ³æƒ…å†µä¸‹æ˜¯å•ä¸€ç”¨é€”ä¸”å¯ç‹¬ç«‹éƒ¨ç½²çš„ï¼‰æœåŠ¡ç»„åˆåœ¨ä¸€èµ·æ„å»ºä»–ä»¬çš„åº”ç”¨ã€‚ç¬¬äºŒï¼Œç»„ç»‡å·²ç»æ¥å—äº†äº‘åŸç”Ÿå¹³å°æŠ€æœ¯ï¼Œå¦‚å®¹å™¨ï¼ˆå¦‚ Dockerï¼‰ã€ç¼–æ’å™¨ï¼ˆå¦‚ Kubernetesï¼‰å’Œç½‘å…³ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ„å›¾&#34;&gt;æ„å›¾&lt;/h3&gt;
&lt;p&gt;æœåŠ¡ç½‘æ ¼æ¨¡å¼è¯•å›¾è§£å†³çš„é—®é¢˜åŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ¶ˆé™¤äº†å°†ç‰¹å®šè¯­è¨€çš„é€šä¿¡åº“ç¼–è¯‘åˆ°å•ä¸ªæœåŠ¡ä¸­çš„éœ€æ±‚ï¼Œä»¥å¤„ç†æœåŠ¡å‘ç°ã€è·¯ç”±å’Œåº”ç”¨å±‚ï¼ˆç¬¬ 7 å±‚ï¼‰éåŠŸèƒ½é€šä¿¡è¦æ±‚ã€‚&lt;/li&gt;
&lt;li&gt;å¤–éƒ¨åŒ–æœåŠ¡é€šä¿¡é…ç½®ï¼ŒåŒ…æ‹¬å¤–éƒ¨æœåŠ¡çš„ç½‘ç»œä½ç½®ã€å®‰å…¨å‡­è¯å’ŒæœåŠ¡è´¨é‡ç›®æ ‡ã€‚&lt;/li&gt;
&lt;li&gt;æä¾›å¯¹å…¶ä»–æœåŠ¡çš„è¢«åŠ¨å’Œä¸»åŠ¨ç›‘æµ‹ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨æ•´ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿä¸­åˆ†å¸ƒå¼åœ°æ‰§è¡Œç­–ç•¥ã€‚&lt;/li&gt;
&lt;li&gt;æä¾›å¯è§‚æµ‹æ€§çš„é»˜è®¤å€¼ï¼Œå¹¶ä½¿ç›¸å…³æ•°æ®çš„æ”¶é›†æ ‡å‡†åŒ–ã€‚
&lt;ul&gt;
&lt;li&gt;å¯ç”¨è¯·æ±‚è®°å½•&lt;/li&gt;
&lt;li&gt;é…ç½®åˆ†å¸ƒå¼è¿½è¸ª&lt;/li&gt;
&lt;li&gt;æ”¶é›†æŒ‡æ ‡&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;ç»“æ„&#34;&gt;ç»“æ„&lt;/h3&gt;
&lt;p&gt;æœåŠ¡ç½‘æ ¼æ¨¡å¼ä¸»è¦ä¾§é‡äºå¤„ç†ä¼ ç»Ÿä¸Šè¢«ç§°ä¸º â€œä¸œè¥¿å‘ â€œçš„åŸºäºè¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼ˆRPCï¼‰çš„æµé‡ï¼šè¯·æ±‚ / å“åº”ç±»å‹çš„é€šä¿¡ï¼Œæºè‡ªæ•°æ®ä¸­å¿ƒå†…éƒ¨ï¼Œåœ¨æœåŠ¡ä¹‹é—´ä¼ æ’­ã€‚è¿™ä¸ API ç½‘å…³æˆ–è¾¹ç¼˜ä»£ç†ç›¸åï¼Œåè€…è¢«è®¾è®¡ä¸ºå¤„ç† â€œå—åŒ— â€œæµé‡ã€‚æ¥è‡ªå¤–éƒ¨çš„é€šä¿¡ï¼Œè¿›å…¥æ•°æ®ä¸­å¿ƒå†…çš„ä¸€ä¸ªç»ˆç«¯æˆ–æœåŠ¡ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æœåŠ¡ç½‘æ ¼çš„ç‰¹ç‚¹&#34;&gt;æœåŠ¡ç½‘æ ¼çš„ç‰¹ç‚¹&lt;/h2&gt;
&lt;p&gt;æœåŠ¡ç½‘æ ¼çš„å®æ–½é€šå¸¸ä¼šæä¾›ä»¥ä¸‹ä¸€ä¸ªæˆ–å¤šä¸ªåŠŸèƒ½ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è§„èŒƒåŒ–å‘½åå¹¶å¢åŠ é€»è¾‘è·¯ç”±ï¼Œï¼ˆä¾‹å¦‚ï¼Œå°†ä»£ç çº§åç§° â€œç”¨æˆ·æœåŠ¡ &amp;quot; æ˜ å°„åˆ°å¹³å°ç‰¹å®šä½ç½® â€œAWS-us-east-1a/prod/users/v4â€ã€‚&lt;/li&gt;
&lt;li&gt;æä¾›æµé‡æ•´å½¢å’Œæµé‡è½¬ç§»&lt;/li&gt;
&lt;li&gt;ä¿æŒè´Ÿè½½å‡è¡¡ï¼Œé€šå¸¸é‡‡ç”¨å¯é…ç½®çš„ç®—æ³•&lt;/li&gt;
&lt;li&gt;æä¾›æœåŠ¡å‘å¸ƒæ§åˆ¶ï¼ˆä¾‹å¦‚ï¼Œé‡‘ä¸é›€é‡Šæ”¾å’Œæµé‡åˆ†å‰²ï¼‰&lt;/li&gt;
&lt;li&gt;æä¾›æŒ‰è¯·æ±‚çš„è·¯ç”±ï¼ˆä¾‹å¦‚ï¼Œå½±å­æµé‡ã€æ•…éšœæ³¨å…¥å’Œè°ƒè¯•é‡æ–°è·¯ç”±ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å¢åŠ åŸºçº¿å¯é æ€§ï¼Œå¦‚å¥åº·æ£€æŸ¥ã€è¶…æ—¶ / æˆªæ­¢æ—¥æœŸã€æ–­è·¯å’Œé‡è¯•ï¼ˆé¢„ç®—ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;é€šè¿‡é€æ˜çš„åŒå‘ä¼ è¾“çº§å®‰å…¨ï¼ˆTLSï¼‰å’Œè®¿é—®æ§åˆ¶åˆ—è¡¨ï¼ˆACLï¼‰ç­‰ç­–ç•¥ï¼Œæé«˜å®‰å…¨æ€§&lt;/li&gt;
&lt;li&gt;æä¾›é¢å¤–çš„å¯è§‚æµ‹æ€§å’Œç›‘æµ‹ï¼Œå¦‚é¡¶çº¿æŒ‡æ ‡ï¼ˆè¯·æ±‚é‡ã€æˆåŠŸç‡å’Œå»¶è¿Ÿï¼‰ï¼Œæ”¯æŒåˆ†å¸ƒå¼è¿½è¸ªï¼Œä»¥åŠ &amp;ldquo;æŒ–æ˜&amp;rdquo; å’Œæ£€æŸ¥å®æ—¶æœåŠ¡é—´é€šä¿¡çš„èƒ½åŠ›ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿å¾—å¹³å°å›¢é˜Ÿèƒ½å¤Ÿé…ç½® &amp;quot; ç†æ™ºçš„é»˜è®¤å€¼â€ï¼Œä»¥ä¿æŠ¤ç³»ç»Ÿå…å—ä¸è‰¯é€šä¿¡çš„å½±å“ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æœåŠ¡ç½‘æ ¼çš„èƒ½åŠ›å¯åˆ†ä¸ºä»¥ä¸‹å››ä¸ªæ–¹é¢ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è¿æ¥æ€§&lt;/li&gt;
&lt;li&gt;å¯é æ€§&lt;/li&gt;
&lt;li&gt;å®‰å…¨æ€§&lt;/li&gt;
&lt;li&gt;å¯è§‚æµ‹æ€§&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è®©æˆ‘ä»¬çœ‹çœ‹æœåŠ¡ç½‘æ ¼æŠ€æœ¯åœ¨è¿™äº›é¢†åŸŸéƒ½èƒ½æä¾›å“ªäº›åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;è¿æ¥æ€§&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æµé‡æ§åˆ¶ï¼ˆè·¯ç”±ï¼Œåˆ†æµï¼‰&lt;/li&gt;
&lt;li&gt;ç½‘å…³ï¼ˆå…¥å£ã€å‡ºå£ï¼‰&lt;/li&gt;
&lt;li&gt;æœåŠ¡å‘ç°&lt;/li&gt;
&lt;li&gt;A/B æµ‹è¯•ã€é‡‘ä¸é›€&lt;/li&gt;
&lt;li&gt;æœåŠ¡è¶…æ—¶ã€é‡è¯•&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;å¯é æ€§&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ–­è·¯å™¨&lt;/li&gt;
&lt;li&gt;æ•…éšœæ³¨å…¥ / æ··æ²Œæµ‹è¯•&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;å®‰å…¨æ€§&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æœåŠ¡é—´è®¤è¯ï¼ˆmTLSï¼‰&lt;/li&gt;
&lt;li&gt;è¯ä¹¦ç®¡ç†&lt;/li&gt;
&lt;li&gt;ç”¨æˆ·è®¤è¯ï¼ˆJWTï¼‰&lt;/li&gt;
&lt;li&gt;ç”¨æˆ·æˆæƒï¼ˆRBACï¼‰&lt;/li&gt;
&lt;li&gt;åŠ å¯†&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;å¯è§‚æµ‹æ€§&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç›‘æµ‹&lt;/li&gt;
&lt;li&gt;é¥æµ‹ã€ä»ªè¡¨ã€è®¡é‡&lt;/li&gt;
&lt;li&gt;åˆ†å¸ƒå¼è¿½è¸ª&lt;/li&gt;
&lt;li&gt;æœåŠ¡å›¾è¡¨&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;æœåŠ¡ç½‘æ ¼æ¶æ„å†…éƒ¨åŸç†&#34;&gt;æœåŠ¡ç½‘æ ¼æ¶æ„ï¼šå†…éƒ¨åŸç†&lt;/h2&gt;
&lt;p&gt;æœåŠ¡ç½‘æ ¼ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼šæ•°æ®å¹³é¢å’Œæ§åˆ¶å¹³é¢ã€‚Matt Kleinï¼Œ&lt;a href=&#34;https://www.envoyproxy.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Envoy Proxy&lt;/a&gt; çš„ä½œè€…ï¼Œå†™äº†ä¸€ç¯‡å…³äº â€œ &lt;a href=&#34;https://blog.envoyproxy.io/service-mesh-data-plane-vs-control-plane-2774e720f7fc&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æœåŠ¡ç½‘æ ¼æ•°æ®å¹³é¢ä¸æ§åˆ¶å¹³é¢ &lt;/a&gt;â€œçš„æ·±å…¥æ¢è®¨ã€‚&lt;/p&gt;
&lt;p&gt;å¹¿ä¹‰ä¸Šè®²ï¼Œæ•°æ®å¹³é¢ â€œæ‰§è¡Œå·¥ä½œâ€ï¼Œè´Ÿè´£ â€œæœ‰æ¡ä»¶åœ°ç¿»è¯‘ã€è½¬å‘å’Œè§‚å¯Ÿæµå‘å’Œæ¥è‡ª [ç½‘ç»œç»ˆç«¯] çš„æ¯ä¸ªç½‘ç»œæ•°æ®åŒ…â€ã€‚åœ¨ç°ä»£ç³»ç»Ÿä¸­ï¼Œæ•°æ®å¹³é¢é€šå¸¸ä»¥ä»£ç†çš„å½¢å¼å®ç°ï¼Œï¼ˆå¦‚ Envoyã€&lt;a href=&#34;http://www.haproxy.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;HAProxy&lt;/a&gt; æˆ– &lt;a href=&#34;https://github.com/mosn/mosn&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;MOSN&lt;/a&gt;ï¼‰ï¼Œå®ƒä½œä¸º &amp;ldquo;sidecar&amp;rdquo; ä¸æ¯ä¸ªæœåŠ¡ä¸€èµ·åœ¨è¿›ç¨‹å¤–è¿è¡Œã€‚Linkerd ä½¿ç”¨äº†ä¸€ç§ &lt;a href=&#34;https://linkerd.io/2020/12/03/why-linkerd-doesnt-use-envoy/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¾®å‹ä»£ç†&lt;/a&gt;æ–¹æ³•ï¼Œè¯¥æ–¹æ³•é’ˆå¯¹æœåŠ¡ç½‘æ ¼çš„ä½¿ç”¨æƒ…å†µè¿›è¡Œäº†ä¼˜åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;æ§åˆ¶å¹³é¢ â€œç›‘ç£å·¥ä½œâ€ï¼Œå¹¶å°†æ•°æ®å¹³é¢çš„æ‰€æœ‰å•ä¸ªå®ä¾‹ â€”â€” ä¸€ç»„å­¤ç«‹çš„æ— çŠ¶æ€ sidecar ä»£ç†å˜æˆä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿã€‚æ§åˆ¶å¹³é¢ä¸æ¥è§¦ç³»ç»Ÿä¸­çš„ä»»ä½•æ•°æ®åŒ… / è¯·æ±‚ï¼Œç›¸åï¼Œå®ƒå…è®¸äººç±»è¿ç»´äººå‘˜ä¸ºç½‘æ ¼ä¸­æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„æ•°æ®å¹³é¢æä¾›ç­–ç•¥å’Œé…ç½®ã€‚æ§åˆ¶å¹³é¢è¿˜èƒ½å¤Ÿæ”¶é›†å’Œé›†ä¸­æ•°æ®å¹³é¢çš„é¥æµ‹æ•°æ®ï¼Œä¾›è¿ç»´äººå‘˜ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;æ§åˆ¶å¹³é¢å’Œæ•°æ®å¹³é¢çš„ç»“åˆæä¾›äº†ä¸¤æ–¹é¢çš„ä¼˜åŠ¿ï¼Œå³ç­–ç•¥å¯ä»¥é›†ä¸­å®šä¹‰å’Œç®¡ç†ï¼ŒåŒæ—¶ï¼ŒåŒæ ·çš„æ”¿ç­–å¯ä»¥ä»¥åˆ†æ•£çš„æ–¹å¼ï¼Œåœ¨ Kubernetes é›†ç¾¤çš„æ¯ä¸ª pod ä¸­æœ¬åœ°æ‰§è¡Œã€‚è¿™äº›ç­–ç•¥å¯ä»¥ä¸å®‰å…¨ã€è·¯ç”±ã€æ–­è·¯å™¨æˆ–ç›‘æ§æœ‰å…³ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹å›¾å–è‡ª Istio æ¶æ„æ–‡æ¡£ï¼Œè™½ç„¶æ ‡æ³¨çš„æŠ€æœ¯æ˜¯ Istio ç‰¹æœ‰çš„ï¼Œä½†è¿™äº›ç»„ä»¶å¯¹æ‰€æœ‰æœåŠ¡ç½‘æ ¼çš„å®ç°éƒ½æ˜¯é€šç”¨çš„ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-istio-æ¶æ„&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Istio æ¶æ„&#34; srcset=&#34;
               /blog/service-mesh-ultimate-guide-e2/arch_hu649180fa1fdd766ef9a9fb265f9f683c_96072_42d3413582627a153c287b8a99601f69.webp 400w,
               /blog/service-mesh-ultimate-guide-e2/arch_hu649180fa1fdd766ef9a9fb265f9f683c_96072_e124a62615957f94d8058c3f26e57206.webp 760w,
               /blog/service-mesh-ultimate-guide-e2/arch_hu649180fa1fdd766ef9a9fb265f9f683c_96072_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/service-mesh-ultimate-guide-e2/arch_hu649180fa1fdd766ef9a9fb265f9f683c_96072_42d3413582627a153c287b8a99601f69.webp&#34;
               width=&#34;760&#34;
               height=&#34;538&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      Istio æ¶æ„
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;Istio æ¶æ„ï¼Œå±•ç¤ºäº†æ§åˆ¶å¹³é¢å’Œä»£ç†æ•°æ®å¹³é¢çš„äº¤äº’æ–¹å¼ï¼ˆç”± &lt;a href=&#34;https://istio.io/docs/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Istio æ–‡æ¡£æä¾›&lt;/a&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä½¿ç”¨æ¡ˆä¾‹&#34;&gt;ä½¿ç”¨æ¡ˆä¾‹&lt;/h2&gt;
&lt;p&gt;æœåŠ¡ç½‘æ ¼å¯ä»¥å®ç°æˆ–æ”¯æŒå¤šç§ç”¨ä¾‹ã€‚&lt;/p&gt;
&lt;h3 id=&#34;åŠ¨æ€æœåŠ¡å‘ç°å’Œè·¯ç”±&#34;&gt;åŠ¨æ€æœåŠ¡å‘ç°å’Œè·¯ç”±&lt;/h3&gt;
&lt;p&gt;æœåŠ¡ç½‘æ ¼æä¾›åŠ¨æ€æœåŠ¡å‘ç°å’Œæµé‡ç®¡ç†ï¼ŒåŒ…æ‹¬ç”¨äºæµ‹è¯•çš„æµé‡å½±å­ï¼ˆå¤åˆ¶ï¼‰ï¼Œä»¥åŠç”¨äºé‡‘ä¸é›€å‘å¸ƒå’Œ A/B å®éªŒçš„æµé‡åˆ†å‰²ã€‚&lt;/p&gt;
&lt;p&gt;æœåŠ¡ç½‘æ ¼ä¸­ä½¿ç”¨çš„ä»£ç†é€šå¸¸æ˜¯ â€œåº”ç”¨å±‚ &amp;quot; æ„ŸçŸ¥çš„ï¼ˆåœ¨ OSI ç½‘ç»œå †æ ˆçš„ç¬¬ 7 å±‚è¿è¡Œï¼‰ã€‚è¿™æ„å‘³ç€æµé‡è·¯ç”±å†³ç­–å’ŒæŒ‡æ ‡çš„æ ‡è®°å¯ä»¥åˆ©ç”¨ HTTP å¤´æˆ–å…¶ä»–åº”ç”¨å±‚åè®®å…ƒæ•°æ®ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æœåŠ¡é—´é€šä¿¡å¯é æ€§&#34;&gt;æœåŠ¡é—´é€šä¿¡å¯é æ€§&lt;/h3&gt;
&lt;p&gt;æœåŠ¡ç½‘æ ¼æ”¯æŒè·¨é¢†åŸŸçš„å¯é æ€§è¦æ±‚çš„å®æ–½å’Œæ‰§è¡Œï¼Œå¦‚è¯·æ±‚é‡è¯•ã€è¶…æ—¶ã€é€Ÿç‡é™åˆ¶å’Œæ–­è·¯ã€‚æœåŠ¡ç½‘æ ¼ç»å¸¸è¢«ç”¨æ¥è¡¥å¿ï¼ˆæˆ–å°è£…ï¼‰å¤„ç†&lt;a href=&#34;https://en.wikipedia.org/wiki/Fallacies_of_distributed_computing&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;åˆ†å¸ƒå¼è®¡ç®—çš„å…«ä¸ªè°¬è¯¯&lt;/a&gt;ã€‚åº”è¯¥æ³¨æ„çš„æ˜¯ï¼ŒæœåŠ¡ç½‘æ ¼åªèƒ½æä¾› wire-level çš„å¯é æ€§æ”¯æŒï¼ˆå¦‚é‡è¯• HTTP è¯·æ±‚ï¼‰ï¼Œæœ€ç»ˆæœåŠ¡åº”è¯¥å¯¹ç›¸å…³çš„ä¸šåŠ¡å½±å“è´Ÿè´£ï¼Œå¦‚é¿å…å¤šä¸ªï¼ˆéå¹‚ç­‰çš„ï¼‰HTTP POST è¯·æ±‚ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æµé‡çš„å¯è§‚æµ‹æ€§&#34;&gt;æµé‡çš„å¯è§‚æµ‹æ€§&lt;/h3&gt;
&lt;p&gt;ç”±äºæœåŠ¡ç½‘æ ¼å¤„äºç³»ç»Ÿå†…å¤„ç†çš„æ¯ä¸ªè¯·æ±‚çš„å…³é”®è·¯å¾„ä¸Šï¼Œå®ƒè¿˜å¯ä»¥æä¾›é¢å¤–çš„ â€œå¯è§‚æµ‹æ€§â€ï¼Œä¾‹å¦‚è¯·æ±‚çš„åˆ†å¸ƒå¼è¿½è¸ªã€HTTP é”™è¯¯ä»£ç çš„é¢‘ç‡ä»¥åŠå…¨å±€å’ŒæœåŠ¡é—´çš„å»¶è¿Ÿã€‚è™½ç„¶åœ¨ä¼ä¸šé¢†åŸŸæ˜¯ä¸€ä¸ªè¢«è¿‡åº¦ä½¿ç”¨çš„çŸ­è¯­ï¼Œä½†æœåŠ¡ç½‘æ ¼ç»å¸¸è¢«æè®®ä½œä¸ºä¸€ç§æ–¹æ³•æ¥æ•è·æ‰€æœ‰å¿…è¦çš„æ•°æ®ï¼Œä»¥å®ç°æ•´ä¸ªç³»ç»Ÿå†…æµé‡çš„ç»Ÿä¸€ç•Œé¢è§†å›¾ã€‚&lt;/p&gt;
&lt;h3 id=&#34;é€šä¿¡å®‰å…¨&#34;&gt;é€šä¿¡å®‰å…¨&lt;/h3&gt;
&lt;p&gt;æœåŠ¡ç½‘æ ¼è¿˜æ”¯æŒè·¨é¢†åŸŸå®‰å…¨è¦æ±‚çš„å®æ–½å’Œæ‰§è¡Œï¼Œå¦‚æä¾›æœåŠ¡èº«ä»½ï¼ˆé€šè¿‡ x509 è¯ä¹¦ï¼‰ï¼Œå®ç°åº”ç”¨çº§æœåŠ¡ / ç½‘ç»œåˆ†å‰²ï¼ˆä¾‹å¦‚ï¼Œâ€œæœåŠ¡ A&amp;quot; å¯ä»¥ä¸ â€œæœåŠ¡ B â€œé€šä¿¡ï¼Œä½†ä¸èƒ½ä¸ â€œæœåŠ¡ C â€œé€šä¿¡ï¼‰ï¼Œç¡®ä¿æ‰€æœ‰é€šä¿¡éƒ½ç»è¿‡åŠ å¯†ï¼ˆé€šè¿‡ TLSï¼‰ï¼Œå¹¶ç¡®ä¿å­˜åœ¨æœ‰æ•ˆçš„ç”¨æˆ·çº§èº«ä»½ä»¤ç‰Œæˆ– â€œ&lt;a href=&#34;https://qconsf.com/sf2019/presentation/user-device-identity-microservices-netflix-scale&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æŠ¤ç…§&lt;/a&gt; &amp;ldquo;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;åæ¨¡å¼&#34;&gt;åæ¨¡å¼&lt;/h2&gt;
&lt;p&gt;å½“åæ¨¡å¼çš„ä½¿ç”¨å‡ºç°æ—¶ï¼Œè¿™å¾€å¾€æ˜¯ä¸€ä¸ªæŠ€æœ¯æˆç†Ÿçš„æ ‡å¿—ã€‚æœåŠ¡ç½‘æ ¼ä¹Ÿä¸ä¾‹å¤–ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å¤ªå¤šçš„æµé‡ç®¡ç†å±‚æ¬¡&#34;&gt;å¤ªå¤šçš„æµé‡ç®¡ç†å±‚æ¬¡&lt;/h3&gt;
&lt;p&gt;å½“å¼€å‘äººå‘˜ä¸ä¸å¹³å°æˆ–è¿ç»´å›¢é˜Ÿåå•†ï¼Œå¹¶åœ¨ç°åœ¨é€šè¿‡æœåŠ¡ç½‘æ ¼å®ç°çš„ä»£ç ä¸­é‡å¤ç°æœ‰çš„é€šä¿¡å¤„ç†é€»è¾‘æ—¶ï¼Œå°±ä¼šå‡ºç°è¿™ç§åæ¨¡å¼ã€‚ä¾‹å¦‚ï¼Œé™¤äº†æœåŠ¡ç½‘æ ¼æä¾›çš„ wire-level é‡è¯•ç­–ç•¥å¤–ï¼Œåº”ç”¨ç¨‹åºè¿˜åœ¨ä»£ç ä¸­è¿˜å®ç°äº†é‡è¯•ç­–ç•¥ã€‚è¿™ç§åæ¨¡å¼ä¼šå¯¼è‡´é‡å¤çš„äº‹åŠ¡ç­‰é—®é¢˜ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æœåŠ¡ç½‘æ ¼é“¶å¼¹&#34;&gt;æœåŠ¡ç½‘æ ¼é“¶å¼¹&lt;/h3&gt;
&lt;p&gt;åœ¨ IT é¢†åŸŸæ²¡æœ‰ â€œé“¶å¼¹ â€œè¿™æ ·çš„ä¸œè¥¿ï¼Œä½†ä¾›åº”å•†æœ‰æ—¶ä¼šè¢«è¯±æƒ‘ç»™æ–°æŠ€æœ¯è´´ä¸Šè¿™ä¸ªæ ‡ç­¾ã€‚æœåŠ¡ç½‘æ ¼ä¸ä¼šè§£å†³å¾®æœåŠ¡ã€Kubernetes ç­‰å®¹å™¨ç¼–æ’å™¨æˆ–äº‘ç½‘ç»œçš„æ‰€æœ‰é€šä¿¡é—®é¢˜ã€‚æœåŠ¡ç½‘æ ¼çš„ç›®çš„åªæ˜¯ä¿ƒè¿›æœåŠ¡ä»¶ï¼ˆä¸œè¥¿å‘ï¼‰çš„é€šä¿¡ï¼Œè€Œä¸”éƒ¨ç½²å’Œè¿è¡ŒæœåŠ¡ç½‘æ ¼æœ‰æ˜æ˜¾çš„è¿è¥æˆæœ¬ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä¼ä¸šæœåŠ¡æ€»çº¿esb20&#34;&gt;ä¼ä¸šæœåŠ¡æ€»çº¿ï¼ˆESBï¼‰2.0&lt;/h3&gt;
&lt;p&gt;åœ¨å‰å¾®æœåŠ¡é¢å‘æœåŠ¡æ¶æ„ï¼ˆSOAï¼‰æ—¶ä»£ï¼Œä¼ä¸šæœåŠ¡æ€»çº¿ï¼ˆESBï¼‰å®ç°äº†è½¯ä»¶ç»„ä»¶ä¹‹é—´çš„é€šä¿¡ç³»ç»Ÿã€‚æœ‰äº›äººæ‹…å¿ƒ ESB æ—¶ä»£çš„è®¸å¤šé”™è¯¯ä¼šéšç€æœåŠ¡ç½‘æ ¼çš„ä½¿ç”¨è€Œé‡æ¼”ã€‚&lt;/p&gt;
&lt;p&gt;é€šè¿‡ ESB æä¾›çš„é›†ä¸­çš„é€šä¿¡æ§åˆ¶æ˜¾ç„¶æœ‰ä»·å€¼ã€‚ç„¶è€Œï¼Œè¿™äº›æŠ€æœ¯çš„å‘å±•æ˜¯ç”±ä¾›åº”å•†æ¨åŠ¨çš„ï¼Œè¿™å¯¼è‡´äº†å¤šç§é—®é¢˜ï¼Œä¾‹å¦‚ï¼šESB ä¹‹é—´ç¼ºä¹äº’æ“ä½œæ€§ï¼Œè¡Œä¸šæ ‡å‡†çš„å®šåˆ¶æ‰©å±•ï¼ˆä¾‹å¦‚ï¼Œå°†ä¾›åº”å•†çš„ç‰¹å®šé…ç½®æ·»åŠ åˆ° WS-* å…¼å®¹æ¨¡å¼ä¸­ï¼‰ï¼Œä»¥åŠé«˜æˆæœ¬ã€‚ESB ä¾›åº”å•†ä¹Ÿæ²¡æœ‰åšä»»ä½•äº‹æƒ…æ¥é˜»æ­¢ä¸šåŠ¡é€»è¾‘ä¸é€šä¿¡æ€»çº¿çš„é›†æˆå’Œç´§è€¦åˆã€‚&lt;/p&gt;
&lt;h3 id=&#34;å¤§çˆ†ç‚¸éƒ¨ç½²&#34;&gt;å¤§çˆ†ç‚¸éƒ¨ç½²&lt;/h3&gt;
&lt;p&gt;åœ¨æ•´ä¸ª IT ç•Œæœ‰ä¸€ç§è¯±æƒ‘ï¼Œè®¤ä¸ºå¤§çˆ†ç‚¸å¼çš„éƒ¨ç½²æ–¹æ³•æ˜¯æœ€å®¹æ˜“ç®¡ç†çš„æ–¹æ³•ï¼Œä½†æ­£å¦‚ &lt;a href=&#34;https://itrevolution.com/book/accelerate/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Accelerate&lt;/a&gt; å’Œ &lt;a href=&#34;https://puppet.com/resources/report/state-of-devops-report/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;DevOps æŠ¥å‘Š&lt;/a&gt;çš„ç ”ç©¶ï¼Œäº‹å®å¹¶éå¦‚æ­¤ã€‚ç”±äºæœåŠ¡ç½‘æ ¼çš„å…¨é¢æ¨å¹¿æ„å‘³ç€è¿™é¡¹æŠ€æœ¯å¤„äºå¤„ç†æ‰€æœ‰ç»ˆç«¯ç”¨æˆ·è¯·æ±‚çš„å…³é”®è·¯å¾„ä¸Šï¼Œå¤§çˆ†ç‚¸å¼çš„éƒ¨ç½²æ˜¯éå¸¸å±é™©çš„ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ­»æ˜Ÿå»ºç­‘&#34;&gt;æ­»æ˜Ÿå»ºç­‘&lt;/h3&gt;
&lt;p&gt;å½“ä¼ä¸šé‡‡ç”¨å¾®æœåŠ¡æ¶æ„ï¼Œå¼€å‘å›¢é˜Ÿå¼€å§‹åˆ›å»ºæ–°çš„å¾®æœåŠ¡æˆ–åœ¨åº”ç”¨ä¸­åˆ©ç”¨ç°æœ‰çš„æœåŠ¡æ—¶ï¼ŒæœåŠ¡é—´çš„é€šä¿¡æˆä¸ºæ¶æ„çš„ä¸€ä¸ªå…³é”®éƒ¨åˆ†ã€‚å¦‚æœæ²¡æœ‰ä¸€ä¸ªè‰¯å¥½çš„æ²»ç†æ¨¡å¼ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´ä¸åŒæœåŠ¡ä¹‹é—´çš„ç´§å¯†è€¦åˆã€‚å½“æ•´ä¸ªç³»ç»Ÿåœ¨ç”Ÿäº§ä¸­å‡ºç°é—®é¢˜æ—¶ï¼Œä¹Ÿå°†å¾ˆéš¾ç¡®å®šå“ªä¸ªæœåŠ¡å‡ºç°äº†é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœç¼ºä¹æœåŠ¡æ²Ÿé€šæˆ˜ç•¥å’Œæ²»ç†æ¨¡å¼ï¼Œè¯¥æ¶æ„å°±ä¼šå˜æˆæ‰€è°“çš„ â€œæ­»æ˜Ÿæ¶æ„â€ã€‚&lt;/p&gt;
&lt;p&gt;å…³äºè¿™ç§æ¶æ„åæ¨¡å¼çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹å…³äºäº‘åŸç”Ÿæ¶æ„é‡‡ç”¨çš„&lt;a href=&#34;https://www.infoq.com/articles/cloud-native-architecture-adoption-part1/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç¬¬ä¸€éƒ¨åˆ†&lt;/a&gt;ã€&lt;a href=&#34;https://www.infoq.com/articles/cloud-native-architecture-adoption-part2/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç¬¬äºŒéƒ¨åˆ†&lt;/a&gt;å’Œ&lt;a href=&#34;https://www.infoq.com/articles/cloud-native-architecture-adoption-part3/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç¬¬ä¸‰éƒ¨åˆ†çš„&lt;/a&gt;æ–‡ç« ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ç‰¹å®šé¢†åŸŸçš„æœåŠ¡ç½‘æ ¼&#34;&gt;ç‰¹å®šé¢†åŸŸçš„æœåŠ¡ç½‘æ ¼&lt;/h3&gt;
&lt;p&gt;æœåŠ¡ç½‘æ ¼çš„æœ¬åœ°å®ç°å’Œè¿‡åº¦ä¼˜åŒ–æœ‰æ—¶ä¼šå¯¼è‡´æœåŠ¡ç½‘æ ¼éƒ¨ç½²èŒƒå›´è¿‡çª„ã€‚å¼€å‘äººå‘˜å¯èƒ½æ›´å–œæ¬¢é’ˆå¯¹è‡ªå·±çš„ä¸šåŠ¡é¢†åŸŸçš„æœåŠ¡ç½‘æ ¼ï¼Œä½†è¿™ç§æ–¹æ³•å¼Šå¤§äºåˆ©ã€‚æˆ‘ä»¬ä¸å¸Œæœ›å®ç°è¿‡äºç»†åŒ–çš„æœåŠ¡ç½‘æ ¼èŒƒå›´ï¼Œæ¯”å¦‚ä¸ºç»„ç»‡ä¸­çš„æ¯ä¸ªä¸šåŠ¡æˆ–åŠŸèƒ½åŸŸï¼ˆå¦‚è´¢åŠ¡ã€äººåŠ›èµ„æºã€ä¼šè®¡ç­‰ï¼‰æä¾›ä¸“ç”¨çš„æœåŠ¡ç½‘æ ¼ã€‚è¿™å°±è¿èƒŒäº†æ‹¥æœ‰åƒæœåŠ¡ç½‘æ ¼è¿™æ ·çš„é€šç”¨æœåŠ¡åè°ƒè§£å†³æ–¹æ¡ˆçš„ç›®çš„ï¼Œå³ä¼ä¸šçº§æœåŠ¡å‘ç°æˆ–è·¨åŸŸæœåŠ¡è·¯ç”±ç­‰åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æœåŠ¡ç½‘æ ¼çš„å®ç°å’Œäº§å“&#34;&gt;æœåŠ¡ç½‘æ ¼çš„å®ç°å’Œäº§å“&lt;/h2&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯ä¸€ä»½éè¯¦å°½çš„å½“å‰æœåŠ¡ç½‘æ ¼å®æ–½æ¸…å•ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://linkerd.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Linkerd &lt;/a&gt;(CNCF æ¯•ä¸šé¡¹ç›®)&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://istio.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Istio&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.consul.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Consul&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://kuma.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Kuma&lt;/a&gt;ï¼ˆCNCF æ²™ç›’é¡¹ç›®ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://aws.amazon.com/app-mesh/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;AWS App Mesh&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.nginx.com/products/nginx-service-mesh/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;NGINX Service Mesh&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://aspenmesh.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;AspenMesh&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://konghq.com/kong-mesh/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Kong&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.solo.io/products/gloo-mesh/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Solo Gloo Mesh&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.tetrate.io/tetrate-service-bridge/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tetrate Service Bridge&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://traefik.io/traefik-mesh&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Traefik Mesh&lt;/a&gt;ï¼ˆåŸå Maeshï¼‰&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://layer5.io/meshery&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Meshery&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://openservicemesh.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Open Service MEsh&lt;/a&gt;ï¼ˆCNCF æ²™ç›’é¡¹ç›®ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¦å¤–ï¼Œåƒ &lt;a href=&#34;https://www.datadoghq.com/blog/tag/service-mesh/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;DataDog&lt;/a&gt; è¿™æ ·çš„å…¶ä»–äº§å“ä¹Ÿå¼€å§‹æä¾›ä¸ &lt;a href=&#34;https://docs.datadoghq.com/integrations/linkerd/?tab=host&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Linkerd&lt;/a&gt;ã€Istioã€Consul Connect å’Œ AWS App Mesh ç­‰æœåŠ¡ç½‘æ ¼æŠ€æœ¯çš„é›†æˆã€‚&lt;/p&gt;
&lt;h2 id=&#34;æœåŠ¡ç½‘æ ¼å¯¹æ¯”&#34;&gt;æœåŠ¡ç½‘æ ¼å¯¹æ¯”&lt;/h2&gt;
&lt;p&gt;æœåŠ¡ç½‘æ ¼é¢†åŸŸçš„å‘å±•æä¸ºè¿…é€Ÿï¼Œå› æ­¤ä»»ä½•è¯•å›¾åˆ›å»ºæ¯”è¾ƒçš„åŠªåŠ›éƒ½å¯èƒ½å¾ˆå¿«å˜å¾—è¿‡æ—¶ã€‚ç„¶è€Œï¼Œç¡®å®å­˜åœ¨ä¸€äº›æ¯”è¾ƒã€‚åº”è¯¥æ³¨æ„äº†è§£æ¥æºçš„åè§ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰å’Œè¿›è¡Œæ¯”è¾ƒçš„æ—¥æœŸã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://layer5.io/landscape&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://layer5.io/landscape&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://kubedex.com/istio-vs-linkerd-vs-linkerd2-vs-consul/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://kubedex.com/istio-vs-linkerd-vs-linkerd2-vs-consul/&lt;/a&gt;ï¼ˆæˆªè‡³ 2021 å¹´ 8 æœˆçš„æ­£ç¡®æ•°æ®ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://platform9.com/blog/kubernetes-service-mesh-a-comparison-of-istio-linkerd-and-consul/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://platform9.com/blog/kubernetes-service-mesh-a-comparison-of-istio-linkerd-and-consul/&lt;/a&gt;ï¼ˆæˆªè‡³ 2019 å¹´ 10 æœˆçš„æœ€æ–°æƒ…å†µï¼‰&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://servicemesh.es/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;https://servicemesh.es/ &lt;/a&gt;(æœ€åå‘è¡¨äº 2021 å¹´ 8 æœˆ)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;InfoQ ä¸€ç›´å»ºè®®æœåŠ¡ç½‘æ ¼çš„é‡‡ç”¨è€…å¯¹æ¯ä¸ªäº§å“è¿›è¡Œè‡ªå·±çš„å°½èŒè°ƒæŸ¥å’Œè¯•éªŒã€‚&lt;/p&gt;
&lt;h2 id=&#34;æœåŠ¡ç½‘æ ¼æ•™ç¨‹&#34;&gt;æœåŠ¡ç½‘æ ¼æ•™ç¨‹&lt;/h2&gt;
&lt;p&gt;å¯¹äºå¸Œæœ›è¯•éªŒå¤šæœåŠ¡ç½‘æ ¼çš„å·¥ç¨‹å¸ˆæˆ–å»ºç­‘å¸ˆæ¥è¯´ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ•™ç¨‹ã€æ¸¸æˆåœºå’Œå·¥å…·ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://layer5.io/meshery&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Layer 5 Meshery&lt;/a&gt;â€”â€” å¤šç½‘æ ¼ç®¡ç†å¹³é¢&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/solo-io/supergloo&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Solo çš„ Gloo Mesh&lt;/a&gt;â€”â€” æœåŠ¡ç½‘æ ¼ç¼–æ’å¹³å°&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.katacoda.com/courses/istio/deploy-istio-on-kubernetes&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;KataCoda Istio æ•™ç¨‹&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://learn.hashicorp.com/consul&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Consul æœåŠ¡ç½‘æ ¼æ•™ç¨‹&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://linkerd.io/2/getting-started/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Linkerd æ•™ç¨‹&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://docs.nginx.com/nginx-service-mesh/tutorials/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;NGINX æœåŠ¡ç½‘æ ¼æ•™ç¨‹&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://tetrate-academy.thinkific.com/courses/istio-fundamentals-zh&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Istio åŸºç¡€æ•™ç¨‹&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;æœåŠ¡ç½‘æ ¼çš„å†å²&#34;&gt;æœåŠ¡ç½‘æ ¼çš„å†å²&lt;/h2&gt;
&lt;p&gt;è‡ª 2013 å¹´åº• Airbnb å‘å¸ƒ &lt;a href=&#34;https://medium.com/airbnb-engineering/smartstack-service-discovery-in-the-cloud-4b8a080de619&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SmartStack&lt;/a&gt;ï¼Œä¸ºæ–°å…´çš„ â€œ &lt;a href=&#34;https://www.infoq.com/microservices/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¾®æœåŠ¡ &lt;/a&gt;â€œé£æ ¼æ¶æ„æä¾›è¿›ç¨‹å¤–æœåŠ¡å‘ç°æœºåˆ¶ï¼ˆä½¿ç”¨ &lt;a href=&#34;http://www.haproxy.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;HAProxy&lt;/a&gt;ï¼‰ä»¥æ¥ï¼ŒInfoQ ä¸€ç›´åœ¨è·Ÿè¸ªè¿™ä¸ªæˆ‘ä»¬ç°åœ¨ç§°ä¹‹ä¸º &lt;a href=&#34;https://www.infoq.com/servicemesh/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æœåŠ¡ç½‘æ ¼&lt;/a&gt;çš„è¯é¢˜ã€‚è®¸å¤šä¹‹å‰è¢«è´´ä¸Š â€œç‹¬è§’å…½ â€œæ ‡ç­¾çš„ç»„ç»‡åœ¨æ­¤ä¹‹å‰å°±åœ¨ç ”ç©¶ç±»ä¼¼çš„æŠ€æœ¯ã€‚ä» 21 ä¸–çºªåˆå¼€å§‹ï¼Œè°·æ­Œå°±åœ¨å¼€å‘å…¶ &lt;a href=&#34;https://grpc.io/blog/principles/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Stubby &lt;/a&gt;RPC æ¡†æ¶ï¼Œè¯¥æ¡†æ¶æ¼”å˜æˆäº† &lt;a href=&#34;https://cloud.google.com/blog/products/gcp/grpc-a-true-internet-scale-rpc-framework-is-now-1-and-ready-for-production-deployments&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;gRPC&lt;/a&gt;ï¼Œä»¥åŠ &lt;a href=&#34;https://landing.google.com/sre/sre-book/chapters/production-environment/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è°·æ­Œå‰ç«¯ï¼ˆGFEï¼‰&lt;/a&gt;å’Œå…¨å±€è½¯ä»¶è´Ÿè½½å‡è¡¡å™¨ï¼ˆGSLBï¼‰ï¼Œåœ¨ &lt;a href=&#34;https://istio.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Istio&lt;/a&gt; ä¸­å¯ä»¥çœ‹åˆ°å®ƒä»¬çš„ç‰¹è´¨ã€‚åœ¨ 2010 å¹´ä»£æ—©æœŸï¼ŒTwitter å¼€å§‹äº† Scala é©±åŠ¨çš„ &lt;a href=&#34;https://twitter.github.io/finagle/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Finagle&lt;/a&gt; çš„å·¥ä½œï¼Œ&lt;a href=&#34;https://linkerd.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Linkerd&lt;/a&gt; æœåŠ¡ç½‘æ ¼ç”±æ­¤äº§ç”Ÿã€‚&lt;/p&gt;
&lt;p&gt;2014 å¹´åº•ï¼ŒNetflix å‘å¸ƒäº†&lt;a href=&#34;https://netflix.github.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä¸€æ•´å¥—åŸºäº JVM çš„å®ç”¨ç¨‹åº&lt;/a&gt;ï¼ŒåŒ…æ‹¬ &lt;a href=&#34;https://www.infoq.com/news/2014/12/netflix-prana/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Prana&lt;/a&gt;ï¼Œä¸€ä¸ª â€œsidecar â€œç¨‹åºï¼Œå…è®¸ç”¨ä»»ä½•è¯­è¨€ç¼–å†™çš„åº”ç”¨æœåŠ¡é€šè¿‡ HTTP ä¸åº“çš„ç‹¬ç«‹å®ä¾‹è¿›è¡Œé€šä¿¡ã€‚2016 å¹´ï¼ŒNGINX å›¢é˜Ÿå¼€å§‹è°ˆè®º â€œ&lt;a href=&#34;https://www.nginx.com/blog/microservices-reference-architecture-nginx-fabric-model/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Fabric æ¨¡å‹&lt;/a&gt; &amp;ldquo;ï¼Œè¿™ä¸æœåŠ¡ç½‘æ ¼éå¸¸ç›¸ä¼¼ï¼Œä½†éœ€è¦ä½¿ç”¨ä»–ä»¬çš„å•†ä¸š NGINX Plus äº§å“æ¥å®ç°ã€‚å¦å¤–ï¼ŒLinkerd v0.2 åœ¨ 2016 å¹´ 2 æœˆ&lt;a href=&#34;https://linkerd.io/2016/02/18/linkerd-twitter-style-operability-for-microservices/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å‘å¸ƒ&lt;/a&gt;ï¼Œå°½ç®¡è¯¥å›¢é˜Ÿç›´åˆ°åæ¥æ‰å¼€å§‹ç§°å®ƒä¸ºæœåŠ¡ç½‘æ ¼ã€‚&lt;/p&gt;
&lt;p&gt;æœåŠ¡ç½‘æ ¼å†å²ä¸Šçš„å…¶ä»–äº®ç‚¹åŒ…æ‹¬ 2017 å¹´ 5 æœˆçš„ &lt;a href=&#34;https://istio.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Istio&lt;/a&gt;ã€2018 å¹´ 7 æœˆçš„ &lt;a href=&#34;https://linkerd.io/2018/09/18/announcing-linkerd-2-0/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Linkerd 2.0&lt;/a&gt;ã€2018 å¹´ 11 æœˆçš„ &lt;a href=&#34;https://www.hashicorp.com/products/consul/service-mesh&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Consul Connect&lt;/a&gt; å’Œ &lt;a href=&#34;https://github.com/solo-io/supergloo&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Gloo Mesh&lt;/a&gt;ã€2019 å¹´ 5 æœˆçš„ &lt;a href=&#34;https://smi-spec.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æœåŠ¡ç½‘æ ¼æ¥å£ï¼ˆSMIï¼‰&lt;/a&gt;ï¼Œä»¥åŠ 2019 å¹´ 9 æœˆçš„ Maeshï¼ˆç°åœ¨å« Traefik Meshï¼‰å’Œ Kumaã€‚&lt;/p&gt;
&lt;p&gt;å³ä½¿æ˜¯åœ¨ç‹¬è§’å…½ä¼ä¸šä¹‹å¤–å‡ºç°çš„æœåŠ¡ç½‘æ ¼ï¼Œå¦‚ HashiCorp çš„ &lt;a href=&#34;https://www.consul.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Consul&lt;/a&gt;ï¼Œä¹Ÿä»ä¸Šè¿°æŠ€æœ¯ä¸­è·å¾—äº†çµæ„Ÿï¼Œé€šå¸¸æ—¨åœ¨å®ç° CoreOS æå‡ºçš„ â€œ&lt;a href=&#34;https://github.com/linearregression/GIFEE&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;GIFEE &lt;/a&gt;â€œæ¦‚å¿µï¼›æ‰€æœ‰äººå¯ç”¨çš„ Google åŸºç¡€è®¾æ–½ï¼ˆGoogle infrastructure for everyone elseï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†æ·±å…¥äº†è§£ç°ä»£æœåŠ¡ç½‘æ ¼æ¦‚å¿µçš„æ¼”å˜å†å²ï¼Œ&lt;a href=&#34;https://philcalcado.com/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Phil CalÃ§ado&lt;/a&gt; å†™äº†ä¸€ç¯‡å…¨é¢çš„æ–‡ç«  â€œ &lt;a href=&#34;https://philcalcado.com/2017/08/03/pattern_service_mesh.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ¨¡å¼ï¼šæœåŠ¡ç½‘æ ¼&lt;/a&gt; &amp;ldquo;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æœåŠ¡ç½‘æ ¼æ ‡å‡†&#34;&gt;æœåŠ¡ç½‘æ ¼æ ‡å‡†&lt;/h2&gt;
&lt;p&gt;å°½ç®¡åœ¨è¿‡å»çš„å‡ å¹´é‡Œï¼ŒæœåŠ¡ç½‘æ ¼æŠ€æœ¯å¹´å¤ä¸€å¹´åœ°å‘ç”Ÿç€é‡å¤§è½¬å˜ï¼Œä½†æœåŠ¡ç½‘æ ¼çš„æ ‡å‡†è¿˜æ²¡æœ‰è·Ÿä¸Šåˆ›æ–°çš„æ­¥ä¼ã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨æœåŠ¡ç½‘æ ¼è§£å†³æ–¹æ¡ˆçš„ä¸»è¦æ ‡å‡†æ˜¯&lt;a href=&#34;https://smi-spec.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æœåŠ¡ç½‘æ ¼æ¥å£&lt;/a&gt;ï¼ˆSMIï¼‰ã€‚æœåŠ¡ç½‘æ ¼æ¥å£æ˜¯åœ¨ &lt;a href=&#34;https://kubernetes.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Kubernetes&lt;/a&gt; ä¸Šè¿è¡Œçš„æœåŠ¡ç½‘æ ¼çš„ä¸€ä¸ªè§„èŒƒã€‚å®ƒæœ¬èº«å¹¶æ²¡æœ‰å®ç°æœåŠ¡ç½‘æ ¼ï¼Œè€Œæ˜¯å®šä¹‰äº†ä¸€ä¸ªé€šç”¨çš„æ ‡å‡†ï¼Œå¯ä»¥ç”±å„ç§æœåŠ¡ç½‘æ ¼ä¾›åº”å•†æ¥å®ç°ã€‚&lt;/p&gt;
&lt;p&gt;SMI API çš„ç›®æ ‡æ˜¯æä¾›ä¸€å¥—é€šç”¨çš„ã€å¯ç§»æ¤çš„æœåŠ¡ç½‘æ ¼ APIï¼ŒKubernetes ç”¨æˆ·å¯ä»¥ä»¥ä¸€ç§ä¸æä¾›è€…æ— å…³çš„æ–¹å¼ä½¿ç”¨ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œäººä»¬å¯ä»¥å®šä¹‰ä½¿ç”¨æœåŠ¡ç½‘æ ¼æŠ€æœ¯çš„åº”ç”¨ç¨‹åºï¼Œè€Œä¸éœ€è¦ä¸ä»»ä½•ç‰¹å®šçš„å®ç°ç´§å¯†ç»“åˆã€‚&lt;/p&gt;
&lt;p&gt;SMI åŸºæœ¬ä¸Šæ˜¯ä¸€ä¸ª Kubernetes è‡ªå®šä¹‰èµ„æºå®šä¹‰ï¼ˆ&lt;a href=&#34;https://kubernetes.io/docs/tasks/extend-kubernetes/custom-resources/custom-resource-definitions/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;CRD&lt;/a&gt;ï¼‰å’Œæ‰©å±• API æœåŠ¡å™¨çš„é›†åˆã€‚è¿™äº› API å¯ä»¥å®‰è£…åˆ°ä»»ä½• Kubernetes é›†ç¾¤ï¼Œå¹¶ä½¿ç”¨æ ‡å‡†å·¥å…·è¿›è¡Œæ“ä½œã€‚ä¸ºäº†æ¿€æ´»è¿™äº› APIï¼Œéœ€è¦åœ¨ Kubernetes é›†ç¾¤ä¸­è¿è¡Œä¸€ä¸ª SMI æä¾›è€…ã€‚&lt;/p&gt;
&lt;p&gt;SMI è§„èŒƒæ—¢å…è®¸ç»ˆç«¯ç”¨æˆ·çš„æ ‡å‡†åŒ–ï¼Œä¹Ÿå…è®¸æœåŠ¡ç½‘æ ¼æŠ€æœ¯æä¾›å•†çš„åˆ›æ–°ã€‚SMI å®ç°äº†çµæ´»æ€§å’Œäº’æ“ä½œæ€§ï¼Œå¹¶æ¶µç›–äº†æœ€å¸¸è§çš„æœåŠ¡ç½‘æ ¼åŠŸèƒ½ã€‚ç›®å‰çš„&lt;a href=&#34;https://github.com/servicemeshinterface/smi-spec/tree/main/apis&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è§„èŒƒç»„ä»¶&lt;/a&gt;é›†ä¸­åœ¨æœåŠ¡ç½‘æ ¼èƒ½åŠ›çš„è¿æ¥æ–¹é¢ã€‚API è§„èŒƒåŒ…æ‹¬ä»¥ä¸‹å†…å®¹ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æµé‡è®¿é—®æ§åˆ¶&lt;/li&gt;
&lt;li&gt;æµé‡æŒ‡æ ‡&lt;/li&gt;
&lt;li&gt;æµé‡è§„æ ¼&lt;/li&gt;
&lt;li&gt;æµé‡åˆ†å‰²&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç›®å‰çš„ SMI &lt;a href=&#34;https://github.com/servicemeshinterface/smi-spec&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç”Ÿæ€ç³»ç»Ÿ&lt;/a&gt;åŒ…æ‹¬å¹¿æ³›çš„æœåŠ¡ç½‘æ ¼ï¼ŒåŒ…æ‹¬ Istioã€Linkerdã€Consul Connectã€Gloo Mesh ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;SMI è§„èŒƒæ˜¯åœ¨ &lt;a href=&#34;http://www.apache.org/licenses/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Apache License 2.0 ç‰ˆæœ¬ä¸‹&lt;/a&gt;&lt;a href=&#34;https://github.com/servicemeshinterface/smi-spec/blob/main/LICENSE&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è®¸å¯çš„&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äº SMI è§„èŒƒåŠå…¶ API ç»†èŠ‚ï¼Œè¯·æŸ¥çœ‹ä»¥ä¸‹é“¾æ¥ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/servicemeshinterface/smi-spec/blob/main/SPEC_LATEST_STABLE.md&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ ¸å¿ƒè§„èŒƒ&lt;/a&gt;ï¼ˆå½“å‰ç‰ˆæœ¬ï¼š0.6.0ï¼‰&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/servicemeshinterface/smi-spec&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è§„èŒƒ Github é¡¹ç›®&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/servicemeshinterface/smi-spec/blob/main/CONTRIBUTING.md&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¦‚ä½•è´¡çŒ®&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;æœåŠ¡ç½‘æ ¼åŸºå‡†æµ‹è¯•&#34;&gt;æœåŠ¡ç½‘æ ¼åŸºå‡†æµ‹è¯•&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://smp-spec.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æœåŠ¡ç½‘æ ¼æ€§èƒ½&lt;/a&gt;æ˜¯ä¸€ä¸ªæ•æ‰åŸºç¡€è®¾æ–½å®¹é‡ã€æœåŠ¡ç½‘é…ç½®å’Œå·¥ä½œè´Ÿè½½å…ƒæ•°æ®ç»†èŠ‚çš„æ ‡å‡†ã€‚SMP è§„èŒƒç”¨äºæ•æ‰ä»¥ä¸‹ç»†èŠ‚ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç¯å¢ƒå’ŒåŸºç¡€è®¾æ–½ç»†èŠ‚&lt;/li&gt;
&lt;li&gt;èŠ‚ç‚¹çš„æ•°é‡å’Œè§„æ¨¡ï¼Œç¼–æ’å™¨&lt;/li&gt;
&lt;li&gt;æœåŠ¡ç½‘æ ¼å’Œå®ƒçš„é…ç½®&lt;/li&gt;
&lt;li&gt;å·¥ä½œé‡ / åº”ç”¨ç»†èŠ‚&lt;/li&gt;
&lt;li&gt;è¿›è¡Œç»Ÿè®¡åˆ†æä»¥ç¡®å®šæ€§èƒ½ç‰¹å¾&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ¥è‡ª Linkerd å›¢é˜Ÿçš„ William Morgan &lt;a href=&#34;https://linkerd.io/2021/05/27/linkerd-vs-istio-benchmarks/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å†™äº†&lt;/a&gt;å…³äº Linkerd å’Œ Istio çš„æ€§èƒ½åŸºå‡†æµ‹è¯•ã€‚è¿˜æœ‰ä¸€ç¯‡æ¥è‡ª 2019 å¹´çš„&lt;a href=&#34;https://istio.io/latest/blog/2019/performance-best-practices/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ–‡ç« &lt;/a&gt;ï¼Œä»‹ç»äº† Istio å…³äºæœåŠ¡ç½‘æ ¼æ€§èƒ½åŸºå‡†æµ‹è¯•çš„æœ€ä½³å®è·µã€‚&lt;/p&gt;
&lt;p&gt;é‡è¦çš„æ˜¯è¦è®°ä½ï¼Œå°±åƒå…¶ä»–æ€§èƒ½åŸºå‡†æµ‹è¯•ä¸€æ ·ï¼Œä½ ä¸åº”è¯¥å¯¹ä»»ä½•è¿™äº›å¤–éƒ¨å‡ºç‰ˆç‰©æŠ•å…¥è¿‡å¤šçš„æ³¨æ„åŠ›ï¼Œç‰¹åˆ«æ˜¯äº§å“ä¾›åº”å•†å‘è¡¨çš„æ–‡ç« ã€‚è¯¥åœ¨ä½ çš„æœåŠ¡å™¨ç¯å¢ƒä¸­è®¾è®¡å’Œæ‰§è¡Œä½ è‡ªå·±çš„æ€§èƒ½æµ‹è¯•ï¼Œä»¥éªŒè¯å“ªä¸ªå…·ä½“äº§å“é€‚åˆä½ çš„åº”ç”¨ç¨‹åºçš„ä¸šåŠ¡å’ŒéåŠŸèƒ½è¦æ±‚ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ¢ç´¢æœåŠ¡ç½‘æ ¼çš„æœªæ¥&#34;&gt;æ¢ç´¢æœåŠ¡ç½‘æ ¼çš„æœªæ¥&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.infoq.com/profile/Kasun-Indrasiri/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Kasun Indrasiri&lt;/a&gt; æ¢è®¨äº† â€œ &lt;a href=&#34;https://www.infoq.com/articles/service-mesh-event-driven-messaging/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä¸ºäº‹ä»¶é©±åŠ¨çš„æ¶ˆæ¯ä¼ é€’ä½¿ç”¨æœåŠ¡ç½‘æ ¼çš„æ½œåŠ›&lt;/a&gt; &amp;ldquo;ï¼Œä»–åœ¨å…¶ä¸­è®¨è®ºäº†åœ¨æœåŠ¡ç½‘æ ¼ä¸­å®ç°æ¶ˆæ¯ä¼ é€’æ”¯æŒçš„ä¸¤ç§ä¸»è¦çš„æ–°å…´æ¶æ„æ¨¡å¼ï¼šåè®®ä»£ç† sidecar å’Œ HTTP æ¡¥æ¥ sidecarã€‚è¿™æ˜¯æœåŠ¡ç½‘æ ¼ç¤¾åŒºä¸­ä¸€ä¸ªæ´»è·ƒçš„å‘å±•é¢†åŸŸï¼Œåœ¨ &lt;a href=&#34;https://github.com/envoyproxy/envoy/issues/2852&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Envoy ä¸­&lt;/a&gt;æ”¯æŒ &lt;a href=&#34;https://github.com/envoyproxy/envoy/issues/2852&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Apache Kafka çš„&lt;/a&gt;å·¥ä½œå¼•èµ·äº†ç›¸å½“å¤šçš„å…³æ³¨ã€‚&lt;/p&gt;
&lt;p&gt;Christian Posta ä¹‹å‰åœ¨ â€œ&lt;a href=&#34;https://www.infoq.com/articles/service-mesh-api-federating/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Towards a Unified, Standard API for Consolidating Service Meshes &lt;/a&gt;ä¸­å†™è¿‡å…³äºæœåŠ¡ç½‘æ ¼ä½¿ç”¨æ ‡å‡†åŒ–çš„å°è¯•ã€‚è¿™ç¯‡æ–‡ç« è¿˜è®¨è®ºäº† 2019 å¹´å¾®è½¯å’Œåˆä½œä¼™ä¼´åœ¨ KubeCon EU ä¸Šå®£å¸ƒçš„&lt;a href=&#34;https://cloudblogs.microsoft.com/opensource/2019/05/21/service-mesh-interface-smi-release/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æœåŠ¡ç½‘æ ¼æ¥å£ï¼ˆSMIï¼‰&lt;/a&gt;ã€‚SMI å®šä¹‰äº†ä¸€å¥—é€šç”¨å’Œå¯ç§»æ¤çš„ APIï¼Œæ—¨åœ¨ä¸ºå¼€å‘äººå‘˜æä¾›ä¸åŒæœåŠ¡ç½‘æ ¼æŠ€æœ¯çš„äº’æ“ä½œæ€§ï¼ŒåŒ…æ‹¬ Istioã€Linkerd å’Œ Consul Connectã€‚&lt;/p&gt;
&lt;p&gt;å°†æœåŠ¡ç½‘æ ¼ä¸å¹³å°ç»“æ„æ•´åˆçš„ä¸»é¢˜å¯ä»¥è¿›ä¸€æ­¥åˆ†ä¸ºä¸¤ä¸ªå­ä¸»é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆï¼Œæ­£åœ¨è¿›è¡Œçš„å·¥ä½œæ˜¯å‡å°‘ç”±æœåŠ¡ç½‘æ ¼æ•°æ®å¹³é¢å¼•å…¥çš„ç½‘ç»œå¼€é”€ã€‚è¿™åŒ…æ‹¬&lt;a href=&#34;https://www.dpdk.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ•°æ®å¹³é¢å¼€å‘å·¥å…·åŒ…ï¼ˆDPDKï¼‰&lt;/a&gt;ï¼Œå®ƒæ˜¯ä¸€ä¸ª&lt;a href=&#34;https://www.linuxjournal.com/content/userspace-networking-dpdk&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç”¨æˆ·ç©ºé—´åº”ç”¨ç¨‹åº&lt;/a&gt;ï¼Œâ€œç»•è¿‡äº† Linux å†…æ ¸ç½‘ç»œå †æ ˆï¼Œç›´æ¥ä¸ç½‘ç»œç¡¬ä»¶å¯¹è¯â€ã€‚è¿˜æœ‰ &lt;a href=&#34;https://www.infoq.com/news/2018/03/cilium-linux-bpf/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Cilium å›¢é˜Ÿçš„&lt;/a&gt;åŸºäº Linux çš„ BPF è§£å†³æ–¹æ¡ˆï¼Œå®ƒåˆ©ç”¨ Linux å†…æ ¸ä¸­çš„æ‰©å±•&lt;a href=&#34;https://cilium.io/blog/istio/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä¼¯å…‹åˆ©åŒ…è¿‡æ»¤å™¨ï¼ˆeBPFï¼‰åŠŸèƒ½&lt;/a&gt;æ¥å®ç° â€œéå¸¸æœ‰æ•ˆçš„ç½‘ç»œã€ç­–ç•¥æ‰§è¡Œå’Œè´Ÿè½½å‡è¡¡åŠŸèƒ½â€ã€‚å¦ä¸€ä¸ªå›¢é˜Ÿæ­£åœ¨ç”¨&lt;a href=&#34;https://github.com/networkservicemesh/networkservicemesh/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç½‘ç»œæœåŠ¡ç½‘æ ¼ï¼ˆNetwork Service Meshï¼‰&lt;/a&gt;å°†æœåŠ¡ç½‘æ ¼çš„æ¦‚å¿µæ˜ å°„åˆ° L2/L3 æœ‰æ•ˆè½½è·ï¼Œè¯•å›¾ â€œä»¥äº‘åŸç”Ÿçš„æ–¹å¼é‡æ–°æƒ³è±¡ç½‘ç»œåŠŸèƒ½è™šæ‹ŸåŒ–ï¼ˆNFVï¼‰&amp;quot;ã€‚&lt;/p&gt;
&lt;p&gt;å…¶æ¬¡ï¼Œæœ‰å¤šé¡¹ä¸¾æªå°†æœåŠ¡ç½‘æ ¼ä¸å…¬å…±äº‘å¹³å°æ›´ç´§å¯†åœ°ç»“åˆåœ¨ä¸€èµ·ï¼Œä» &lt;a href=&#34;https://www.infoq.com/news/2019/01/aws-app-mesh/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;AWS App Mesh&lt;/a&gt;ã€&lt;a href=&#34;https://www.infoq.com/news/2019/04/google-traffic-director/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;GCP Traffic Director&lt;/a&gt; å’Œ &lt;a href=&#34;https://www.infoq.com/articles/azure-service-fabric-mesh/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Azure Service Fabric Mesh çš„&lt;/a&gt;å‘å¸ƒå¯è§ç«¯å€ªã€‚&lt;/p&gt;
&lt;p&gt;Buoyant å›¢é˜Ÿè‡´åŠ›äºä¸ºæœåŠ¡ç½‘æ ¼æŠ€æœ¯å¼€å‘æœ‰æ•ˆçš„ä»¥äººä¸ºæœ¬çš„æ§åˆ¶å¹³é¢ã€‚ä»–ä»¬æœ€è¿‘å‘å¸ƒäº† &lt;a href=&#34;https://buoyant.io/cloud/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Buoyant Cloud&lt;/a&gt;ï¼Œä¸€ä¸ªåŸºäº SaaS çš„ â€œå›¢é˜Ÿæ§åˆ¶å¹³é¢â€ï¼Œç”¨äºå¹³å°å›¢é˜Ÿæ“ä½œ Kubernetesã€‚è¿™ä¸ªäº§å“å°†åœ¨ä¸‹é¢çš„ç« èŠ‚ä¸­è¯¦ç»†è®¨è®ºã€‚&lt;/p&gt;
&lt;p&gt;è‡ªå»å¹´ä»¥æ¥ï¼Œåœ¨æœåŠ¡ç½‘æ ¼é¢†åŸŸä¹Ÿæœ‰ä¸€äº›åˆ›æ–°ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å¤šäº‘å¤šé›†ç¾¤å¤šç§Ÿæˆ·æœåŠ¡ç½‘æ ¼&#34;&gt;å¤šäº‘ã€å¤šé›†ç¾¤ã€å¤šç§Ÿæˆ·æœåŠ¡ç½‘æ ¼&lt;/h3&gt;
&lt;p&gt;è¿‘å¹´æ¥ï¼Œä¸åŒç»„ç»‡å¯¹äº‘çš„é‡‡ç”¨å·²ç»ä»å•ä¸€çš„äº‘è§£å†³æ–¹æ¡ˆï¼ˆç§æœ‰äº‘æˆ–å…¬å…±äº‘ï¼‰è½¬å˜ä¸ºç”±å¤šä¸ªä¸åŒä¾›åº”å•†ï¼ˆAWSã€è°·æ­Œã€å¾®è½¯ Azure ç­‰ï¼‰æ”¯æŒçš„åŸºäºå¤šäº‘ï¼ˆç§æœ‰ã€å…¬å…±å’Œæ··åˆï¼‰çš„æ–°åŸºç¡€è®¾æ–½ã€‚åŒæ—¶ï¼Œéœ€è¦æ”¯æŒä¸åŒçš„å·¥ä½œè´Ÿè½½ï¼ˆäº¤æ˜“ã€æ‰¹å¤„ç†å’Œæµåª’ä½“ï¼‰ï¼Œè¿™å¯¹å®ç°ç»Ÿä¸€çš„äº‘æ¶æ„è‡³å…³é‡è¦ã€‚&lt;/p&gt;
&lt;p&gt;è¿™äº›ä¸šåŠ¡å’ŒéåŠŸèƒ½éœ€æ±‚åè¿‡æ¥åˆå¯¼è‡´éœ€è¦åœ¨å¼‚æ„åŸºç¡€è®¾æ–½ï¼ˆè£¸æœºã€è™šæ‹Ÿæœºå’Œ Kubernetesï¼‰ä¸­éƒ¨ç½²æœåŠ¡ç½‘æ ¼è§£å†³æ–¹æ¡ˆã€‚æœåŠ¡ç½‘æ ¼éœ€è¦ç›¸åº”è½¬å˜ï¼Œä»¥æ”¯æŒè¿™äº›ä¸åŒçš„å·¥ä½œè´Ÿè½½å’ŒåŸºç¡€è®¾æ–½ã€‚&lt;/p&gt;
&lt;p&gt;åƒ &lt;a href=&#34;https://konghq.com/blog/multi-cluster-multi-cloud-service-meshes-with-cncfs-kuma-and-envoy/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Kuma&lt;/a&gt; å’Œ &lt;a href=&#34;https://www.tetrate.io/tetrate-service-bridge/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Tetrate Service Bridge&lt;/a&gt; è¿™æ ·çš„æŠ€æœ¯æ”¯æŒå¤šç½‘æ ¼æ§åˆ¶å¹³é¢ï¼Œä»¥ä½¿ä¸šåŠ¡åº”ç”¨åœ¨å¤šé›†ç¾¤å’Œå¤šäº‘æœåŠ¡ç½‘æ ¼ç¯å¢ƒä¸­å·¥ä½œã€‚è¿™äº›è§£å†³æ–¹æ¡ˆæŠ½è±¡å‡ºè·¨å¤šä¸ªåŒºåŸŸçš„æœåŠ¡ç½‘æ ¼ç­–ç•¥çš„åŒæ­¥ä»¥åŠè·¨è¿™äº›åŒºåŸŸçš„æœåŠ¡è¿æ¥ï¼ˆå’ŒæœåŠ¡å‘ç°ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å¤šé›†ç¾¤æœåŠ¡ç½‘æ ¼æŠ€æœ¯çš„å¦ä¸€ä¸ªæ–°è¶‹åŠ¿æ˜¯éœ€è¦ä»è¾¹ç¼˜è®¡ç®—å±‚ï¼ˆç‰©è”ç½‘è®¾å¤‡ï¼‰åˆ°ç½‘æ ¼å±‚çš„åº”ç”¨ / æœåŠ¡è¿æ¥ã€‚&lt;/p&gt;
&lt;h3 id=&#34;åª’ä½“æœåŠ¡ç½‘æ ¼&#34;&gt;åª’ä½“æœåŠ¡ç½‘æ ¼&lt;/h3&gt;
&lt;p&gt;æ€ç§‘ç³»ç»Ÿå…¬å¸å¼€å‘çš„&lt;a href=&#34;https://www.ciscotechblog.com/blog/introducing-media-streaming-mesh/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;åª’ä½“æµç½‘æ ¼ï¼ˆMedia Streaming Meshï¼‰&lt;/a&gt;æˆ–åª’ä½“æœåŠ¡ç½‘æ ¼ï¼Œç”¨äºåè°ƒå®æ—¶åº”ç”¨ç¨‹åºï¼Œå¦‚å¤šäººæ¸¸æˆã€å¤šæ–¹è§†é¢‘ä¼šè®®æˆ–åœ¨ Kubernetes äº‘å¹³å°ä¸Šä½¿ç”¨æœåŠ¡ç½‘æ ¼æŠ€æœ¯çš„ CCTV æµã€‚è¿™äº›åº”ç”¨æ­£è¶Šæ¥è¶Šå¤šåœ°ä»å•ä½“åº”ç”¨è½¬å‘å¾®æœåŠ¡æ¶æ„ã€‚æœåŠ¡ç½‘æ ¼å¯ä»¥é€šè¿‡æä¾›è´Ÿè½½å‡è¡¡ã€åŠ å¯†å’Œå¯è§‚æµ‹æ€§ç­‰åŠŸèƒ½æ¥å¸®åŠ©åº”ç”¨ç¨‹åºã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ··æ²Œç½‘æ ¼&#34;&gt;æ··æ²Œç½‘æ ¼&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://chaos-mesh.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Chaos Mesh&lt;/a&gt; æ˜¯ &lt;a href=&#34;https://community.cncf.io/chaos-mesh-community/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;CNCF æ‰˜ç®¡çš„é¡¹ç›®&lt;/a&gt;ï¼Œæ˜¯ä¸€ä¸ªå¼€æºçš„ã€äº‘åŸç”Ÿçš„æ··æ²Œå·¥ç¨‹å¹³å°ï¼Œç”¨äºæ‰˜ç®¡åœ¨ Kubernetes ä¸Šçš„åº”ç”¨ç¨‹åºã€‚è™½ç„¶ä¸æ˜¯ç›´æ¥çš„æœåŠ¡ç½‘æ ¼å®ç°ï¼Œä½† Chaos Mesh é€šè¿‡åè°ƒåº”ç”¨ç¨‹åºä¸­çš„æ•…éšœæ³¨å…¥è¡Œä¸ºæ¥å®ç°æ··æ²Œå·¥ç¨‹å®éªŒã€‚æ•…éšœæ³¨å…¥æ˜¯æœåŠ¡ç½‘æ ¼æŠ€æœ¯çš„ä¸€ä¸ªå…³é”®èƒ½åŠ›ã€‚&lt;/p&gt;
&lt;p&gt;Chaos Mesh éšè—äº†åº•å±‚çš„å®ç°ç»†èŠ‚ï¼Œå› æ­¤åº”ç”¨å¼€å‘è€…å¯ä»¥ä¸“æ³¨äºå®é™…çš„æ··æ²Œå®éªŒã€‚Chaos Mesh &lt;a href=&#34;https://chaos-mesh.org/blog/chaos-mesh-q&amp;amp;a/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¯ä»¥å’ŒæœåŠ¡ç½‘æ ¼ä¸€èµ·ä½¿ç”¨&lt;/a&gt;ã€‚è¯·çœ‹è¿™ä¸ª&lt;a href=&#34;https://github.com/sergioarmgpl/operating-systems-usac-course/blob/master/lang/en/projects/project1v3/project1.md&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç”¨ä¾‹&lt;/a&gt;ï¼Œè¯¥å›¢é˜Ÿå¦‚ä½•ä½¿ç”¨ Linkerd å’Œ Chaos Mesh æ¥ä¸ºä»–ä»¬çš„é¡¹ç›®è¿›è¡Œæ··æ²Œå®éªŒã€‚&lt;/p&gt;
&lt;h3 id=&#34;æœåŠ¡ç½‘æ ¼ä½œä¸ºä¸€ç§æœåŠ¡&#34;&gt;æœåŠ¡ç½‘æ ¼ä½œä¸ºä¸€ç§æœåŠ¡&lt;/h3&gt;
&lt;p&gt;ä¸€äº›æœåŠ¡ç½‘æ ¼ä¾›åº”å•†ï¼Œå¦‚ Buoyantï¼Œæ­£åœ¨æä¾›ç®¡ç†æœåŠ¡ç½‘æ ¼æˆ– â€œæœåŠ¡ç½‘æ ¼ä½œä¸ºä¸€ç§æœåŠ¡ â€œçš„è§£å†³æ–¹æ¡ˆã€‚ä»Šå¹´æ—©äº›æ—¶å€™ï¼ŒBuoyant &lt;a href=&#34;https://buoyant.io/newsroom/buoyant-cloud-offers-managed-service-mesh/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å®£å¸ƒ&lt;/a&gt;å…¬å¼€æµ‹è¯•å‘å¸ƒä¸€ä¸ªåä¸º &lt;a href=&#34;http://buoyant.io/cloud&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Buoyant Cloud çš„&lt;/a&gt; SaaS åº”ç”¨ç¨‹åºï¼Œå…è®¸å®¢æˆ·ç»„ç»‡åˆ©ç”¨ Linkerd æœåŠ¡ç½‘æ ¼çš„æŒ‰éœ€æ”¯æŒåŠŸèƒ½æ¥ç®¡ç†æœåŠ¡ç½‘æ ¼ã€‚&lt;/p&gt;
&lt;p&gt;Buoyant Cloud è§£å†³æ–¹æ¡ˆæä¾›çš„ä¸€äº›åŠŸèƒ½åŒ…æ‹¬å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è‡ªåŠ¨è·Ÿè¸ª Linkerd æ•°æ®å¹³é¢å’Œæ§åˆ¶å¹³é¢çš„å¥åº·çŠ¶å†µ&lt;/li&gt;
&lt;li&gt;åœ¨ Kubernetes å¹³å°ä¸Šç®¡ç†è·¨ podã€ä»£ç†å’Œé›†ç¾¤çš„æœåŠ¡ç½‘æ ¼ç”Ÿå‘½å‘¨æœŸå’Œç‰ˆæœ¬&lt;/li&gt;
&lt;li&gt;ä»¥ SRE ä¸ºé‡ç‚¹çš„å·¥å…·ï¼ŒåŒ…æ‹¬æœåŠ¡æ°´å¹³ç›®æ ‡ï¼ˆSLOï¼‰ã€å·¥ä½œè´Ÿè·é»„é‡‘æŒ‡æ ‡è·Ÿè¸ªå’Œå˜æ›´è·Ÿè¸ª&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;ç½‘ç»œæœåŠ¡ç½‘æ ¼nsm&#34;&gt;ç½‘ç»œæœåŠ¡ç½‘æ ¼ï¼ˆNSMï¼‰&lt;/h3&gt;
&lt;p&gt;ç½‘ç»œæœåŠ¡ç½‘æ ¼ï¼ˆ&lt;a href=&#34;https://networkservicemesh.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;NSM&lt;/a&gt;ï¼‰æ˜¯äº‘åŸç”Ÿè®¡ç®—åŸºé‡‘ä¼šçš„å¦ä¸€ä¸ªæ²™ç›’é¡¹ç›®ï¼Œæä¾›äº†ä¸€ä¸ªæ··åˆçš„ã€å¤šäº‘çš„ IP æœåŠ¡ç½‘æ ¼ã€‚NSM å®ç°äº†ç½‘ç»œæœåŠ¡è¿æ¥ã€å®‰å…¨å’Œå¯è§‚æµ‹æ€§ç­‰åŠŸèƒ½ï¼Œè¿™äº›éƒ½æ˜¯æœåŠ¡ç½‘æ ¼çš„æ ¸å¿ƒç‰¹å¾ã€‚NSM ä¸ç°æœ‰çš„å®¹å™¨ç½‘ç»œæ¥å£ï¼ˆ&lt;a href=&#34;https://github.com/containernetworking/cni&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;CNI&lt;/a&gt;ï¼‰å®ç°ååŒå·¥ä½œã€‚&lt;/p&gt;
&lt;h3 id=&#34;æœåŠ¡ç½‘æ ¼æ‰©å±•&#34;&gt;æœåŠ¡ç½‘æ ¼æ‰©å±•&lt;/h3&gt;
&lt;p&gt;æœåŠ¡ç½‘æ ¼æ‰©å±•æ˜¯å¦ä¸€ä¸ªå·²ç»çœ‹åˆ°å¾ˆå¤šåˆ›æ–°çš„é¢†åŸŸã€‚æœåŠ¡ç½‘æ ¼æ‰©å±•çš„ä¸€äº›å‘å±•åŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¢å¼ºçš„èº«ä»½ç®¡ç†ï¼Œä»¥ç¡®ä¿å¾®æœåŠ¡è¿æ¥çš„å®‰å…¨ï¼ŒåŒ…æ‹¬è‡ªå®šä¹‰è¯ä¹¦æˆæƒæ’ä»¶&lt;/li&gt;
&lt;li&gt;è‡ªé€‚åº”è·¯ç”±åŠŸèƒ½ï¼Œä»¥æé«˜æœåŠ¡çš„å¯ç”¨æ€§å’Œå¯æ‰©å±•æ€§&lt;/li&gt;
&lt;li&gt;åŠ å¼º sidecar ä»£ç†æƒ&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;æœåŠ¡ç½‘æ ¼ä¸šåŠ¡&#34;&gt;æœåŠ¡ç½‘æ ¼ä¸šåŠ¡&lt;/h3&gt;
&lt;p&gt;é‡‡ç”¨æœåŠ¡ç½‘æ ¼çš„å¦ä¸€ä¸ªé‡è¦é¢†åŸŸæ˜¯æœåŠ¡ç½‘æ ¼ç”Ÿå‘½å‘¨æœŸçš„è¿ç»´æ–¹é¢ã€‚æ“ä½œæ–¹é¢ â€”â€” å¦‚é…ç½®å¤šé›†ç¾¤åŠŸèƒ½å’Œå°† Kubernetes å·¥ä½œè´Ÿè½½è¿æ¥åˆ°è™šæ‹ŸæœºåŸºç¡€è®¾æ–½ä¸Šæ‰˜ç®¡çš„æœåŠ¡å™¨ï¼Œä»¥åŠç®¡ç†å¤šé›†ç¾¤æœåŠ¡ç½‘æ ¼ä¸­æ‰€æœ‰åŠŸèƒ½å’Œ API çš„å¼€å‘è€…é—¨æˆ· â€”â€” å°†åœ¨ç”Ÿäº§ä¸­æœåŠ¡ç½‘æ ¼è§£å†³æ–¹æ¡ˆçš„æ•´ä½“éƒ¨ç½²å’Œæ”¯æŒæ–¹é¢å‘æŒ¥é‡è¦ä½œç”¨ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å¸¸è§é—®é¢˜&#34;&gt;å¸¸è§é—®é¢˜&lt;/h2&gt;
&lt;h3 id=&#34;ä»€ä¹ˆæ˜¯æœåŠ¡ç½‘æ ¼&#34;&gt;ä»€ä¹ˆæ˜¯æœåŠ¡ç½‘æ ¼ï¼Ÿ&lt;/h3&gt;
&lt;p&gt;æœåŠ¡ç½‘æ ¼æ˜¯ä¸€ç§åœ¨åˆ†å¸ƒå¼ï¼ˆå¯èƒ½æ˜¯åŸºäºå¾®æœåŠ¡çš„ï¼‰è½¯ä»¶ç³»ç»Ÿå†…ç®¡ç†æ‰€æœ‰æœåŠ¡å¯¹æœåŠ¡ï¼ˆä¸œè¥¿å‘ï¼‰æµé‡çš„æŠ€æœ¯ã€‚å®ƒæ—¢æä¾›ä»¥ä¸šåŠ¡ä¸ºé‡ç‚¹çš„åŠŸèƒ½æ“ä½œï¼Œå¦‚è·¯ç”±ï¼Œä¹Ÿæä¾›éåŠŸèƒ½æ”¯æŒï¼Œå¦‚æ‰§è¡Œå®‰å…¨ç­–ç•¥ã€æœåŠ¡è´¨é‡å’Œé€Ÿç‡é™åˆ¶ã€‚å®ƒé€šå¸¸ï¼ˆå°½ç®¡ä¸æ˜¯å”¯ä¸€çš„ï¼‰ä½¿ç”¨ sidecar ä»£ç†æ¥å®ç°ï¼Œæ‰€æœ‰æœåŠ¡éƒ½é€šè¿‡ sidecar ä»£ç†è¿›è¡Œé€šä¿¡ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æœåŠ¡ç½‘æ ¼ä¸-api-ç½‘å…³æœ‰ä»€ä¹ˆä¸åŒ&#34;&gt;æœåŠ¡ç½‘æ ¼ä¸ API ç½‘å…³æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ&lt;/h3&gt;
&lt;p&gt;å…³äºæœåŠ¡ç½‘æ ¼çš„å®šä¹‰ï¼Œè§ä¸Šæ–‡ã€‚&lt;/p&gt;
&lt;p&gt;å¦ä¸€æ–¹é¢ï¼ŒAPI ç½‘å…³ç®¡ç†è¿›å…¥é›†ç¾¤çš„æ‰€æœ‰å…¥å£ï¼ˆå—åŒ—ï¼‰æµé‡ï¼Œå¹¶ä¸ºè·¨åŠŸèƒ½çš„é€šä¿¡è¦æ±‚æä¾›é¢å¤–æ”¯æŒã€‚å®ƒä½œä¸ºè¿›å…¥ç³»ç»Ÿçš„å•ä¸€å…¥å£ç‚¹ï¼Œä½¿å¤šä¸ª API æˆ–æœåŠ¡å‡èšåœ¨ä¸€èµ·ï¼Œä¸ºç”¨æˆ·æä¾›ç»Ÿä¸€çš„ä½“éªŒã€‚&lt;/p&gt;
&lt;h3 id=&#34;å¦‚æœæˆ‘æ­£åœ¨éƒ¨ç½²å¾®æœåŠ¡æˆ‘æ˜¯å¦éœ€è¦æœåŠ¡ç½‘æ ¼&#34;&gt;å¦‚æœæˆ‘æ­£åœ¨éƒ¨ç½²å¾®æœåŠ¡ï¼Œæˆ‘æ˜¯å¦éœ€è¦æœåŠ¡ç½‘æ ¼ï¼Ÿ&lt;/h3&gt;
&lt;p&gt;ä¸ä¸€å®šã€‚æœåŠ¡ç½‘æ ¼å¢åŠ äº†æŠ€æœ¯æ ˆçš„æ“ä½œå¤æ‚æ€§ï¼Œå› æ­¤é€šå¸¸åªæœ‰åœ¨ç»„ç»‡åœ¨æ‰©å±•æœåŠ¡ä¸æœåŠ¡ä¹‹é—´çš„é€šä¿¡æ–¹é¢é‡åˆ°å›°éš¾ï¼Œæˆ–è€…æœ‰ç‰¹å®šçš„ç”¨ä¾‹éœ€è¦è§£å†³æ—¶æ‰ä¼šéƒ¨ç½²ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æˆ‘æ˜¯å¦éœ€è¦æœåŠ¡ç½‘æ ¼æ¥å®ç°å¾®æœåŠ¡çš„æœåŠ¡å‘ç°&#34;&gt;æˆ‘æ˜¯å¦éœ€è¦æœåŠ¡ç½‘æ ¼æ¥å®ç°å¾®æœåŠ¡çš„æœåŠ¡å‘ç°ï¼Ÿ&lt;/h3&gt;
&lt;p&gt;ä¸ï¼ŒæœåŠ¡ç½‘æ ¼æä¾›äº†å®ç°æœåŠ¡å‘ç°çš„ä¸€ç§æ–¹å¼ã€‚å…¶ä»–è§£å†³æ–¹æ¡ˆåŒ…æ‹¬ç‰¹å®šè¯­è¨€çš„åº“ï¼ˆå¦‚ Ribbon å’Œ &lt;a href=&#34;https://www.infoq.com/news/2012/09/Eureka/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Eureka&lt;/a&gt; æˆ– &lt;a href=&#34;https://www.infoq.com/finagle/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Finagle&lt;/a&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æœåŠ¡ç½‘æ ¼æ˜¯å¦ä¼šç»™æˆ‘çš„æœåŠ¡ä¹‹é—´çš„é€šä¿¡å¢åŠ å¼€é”€--å»¶è¿Ÿ&#34;&gt;æœåŠ¡ç½‘æ ¼æ˜¯å¦ä¼šç»™æˆ‘çš„æœåŠ¡ä¹‹é—´çš„é€šä¿¡å¢åŠ å¼€é”€ / å»¶è¿Ÿï¼Ÿ&lt;/h3&gt;
&lt;p&gt;æ˜¯çš„ï¼Œå½“ä¸€ä¸ªæœåŠ¡ä¸å¦ä¸€ä¸ªæœåŠ¡è¿›è¡Œé€šä¿¡æ—¶ï¼ŒæœåŠ¡ç½‘æ ¼è‡³å°‘ä¼šå¢åŠ ä¸¤ä¸ªé¢å¤–çš„ç½‘ç»œè·³æ•°ï¼ˆç¬¬ä¸€ä¸ªæ˜¯æ¥è‡ªå¤„ç†æºçš„å‡ºç«™è¿æ¥çš„ä»£ç†ï¼Œç¬¬äºŒä¸ªæ˜¯æ¥è‡ªå¤„ç†ç›®çš„åœ°çš„å…¥ç«™è¿æ¥çš„ä»£ç†ï¼‰ã€‚ç„¶è€Œï¼Œè¿™ä¸ªé¢å¤–çš„ç½‘ç»œè·³è½¬é€šå¸¸å‘ç”Ÿåœ¨ &lt;a href=&#34;https://en.wikipedia.org/wiki/Localhost&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;localhost æˆ– loopback ç½‘ç»œæ¥å£&lt;/a&gt;ä¸Šï¼Œå¹¶ä¸”åªå¢åŠ äº†å°‘é‡çš„å»¶è¿Ÿï¼ˆåœ¨æ¯«ç§’çº§ï¼‰ã€‚å®éªŒå’Œäº†è§£è¿™å¯¹ç›®æ ‡ç”¨ä¾‹æ˜¯å¦æ˜¯ä¸€ä¸ªé—®é¢˜ï¼Œåº”è¯¥æ˜¯æœåŠ¡ç½‘æ ¼åˆ†æå’Œè¯„ä¼°çš„ä¸€éƒ¨åˆ†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æœåŠ¡ç½‘æ ¼ä¸åº”è¯¥æ˜¯-kubernetes-æˆ–åº”ç”¨ç¨‹åºè¢«éƒ¨ç½²åˆ°çš„-äº‘åŸç”Ÿå¹³å°-çš„ä¸€éƒ¨åˆ†å—&#34;&gt;æœåŠ¡ç½‘æ ¼ä¸åº”è¯¥æ˜¯ Kubernetes æˆ–åº”ç”¨ç¨‹åºè¢«éƒ¨ç½²åˆ°çš„ &amp;ldquo;äº‘åŸç”Ÿå¹³å°&amp;rdquo; çš„ä¸€éƒ¨åˆ†å—ï¼Ÿ&lt;/h3&gt;
&lt;p&gt;æ½œåœ¨çš„ã€‚æœ‰ä¸€ç§è¯´æ³•æ˜¯åœ¨äº‘åŸç”Ÿå¹³å°ç»„ä»¶å†…ä¿æŒå…³æ³¨ç‚¹çš„åˆ†ç¦»ï¼ˆä¾‹å¦‚ï¼ŒKubernetes è´Ÿè´£æä¾›å®¹å™¨ç¼–æ’ï¼Œè€ŒæœåŠ¡ç½‘æ ¼è´Ÿè´£æœåŠ¡é—´çš„é€šä¿¡ï¼‰ã€‚ç„¶è€Œï¼Œæ­£åœ¨è¿›è¡Œçš„å·¥ä½œæ˜¯å°†ç±»ä¼¼æœåŠ¡ç½‘æ ¼çš„åŠŸèƒ½æ¨å‘ç°ä»£å¹³å°å³æœåŠ¡ï¼ˆPaaSï¼‰äº§å“ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æˆ‘å¦‚ä½•å®æ–½éƒ¨ç½²æˆ–æ¨å¹¿æœåŠ¡ç½‘æ ¼&#34;&gt;æˆ‘å¦‚ä½•å®æ–½ã€éƒ¨ç½²æˆ–æ¨å¹¿æœåŠ¡ç½‘æ ¼ï¼Ÿ&lt;/h3&gt;
&lt;p&gt;æœ€å¥½çš„æ–¹æ³•æ˜¯åˆ†æå„ç§æœåŠ¡ç½‘æ ¼äº§å“ï¼ˆè§ä¸Šæ–‡ï¼‰ï¼Œå¹¶éµå¾ªæ‰€é€‰ç½‘æ ¼ç‰¹æœ‰çš„å®æ–½å‡†åˆ™ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæœ€å¥½æ˜¯ä¸æ‰€æœ‰åˆ©ç›Šç›¸å…³è€…åˆä½œï¼Œé€æ­¥å°†ä»»ä½•æ–°æŠ€æœ¯éƒ¨ç½²åˆ°ç”Ÿäº§ä¸­ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æˆ‘å¯ä»¥å»ºç«‹è‡ªå·±çš„æœåŠ¡ç½‘æ ¼å—&#34;&gt;æˆ‘å¯ä»¥å»ºç«‹è‡ªå·±çš„æœåŠ¡ç½‘æ ¼å—ï¼Ÿ&lt;/h3&gt;
&lt;p&gt;æ˜¯çš„ï¼Œä½†æ›´ç›¸å…³çš„é—®é¢˜æ˜¯ï¼Œä½ åº”è¯¥å—ï¼Ÿå»ºç«‹ä¸€ä¸ªæœåŠ¡ç½‘æ ¼æ˜¯ä½ ç»„ç»‡çš„æ ¸å¿ƒç«äº‰åŠ›å—ï¼Ÿä½ èƒ½å¦ä»¥æ›´æœ‰æ•ˆçš„æ–¹å¼ä¸ºä½ çš„å®¢æˆ·æä¾›ä»·å€¼ï¼Ÿä½ æ˜¯å¦ä¹Ÿè‡´åŠ›äºç»´æŠ¤ä½ è‡ªå·±çš„ç½‘ç»œï¼Œä¸ºå®‰å…¨é—®é¢˜æ‰“è¡¥ä¸ï¼Œå¹¶ä¸æ–­æ›´æ–°å®ƒä»¥åˆ©ç”¨æ–°æŠ€æœ¯ï¼Ÿç”±äºç°åœ¨æœ‰ä¸€ç³»åˆ—çš„å¼€æºå’Œå•†ä¸šæœåŠ¡ç½‘æ ¼äº§å“ï¼Œä½¿ç”¨ç°æœ‰çš„è§£å†³æ–¹æ¡ˆå¾ˆå¯èƒ½æ›´æœ‰æ•ˆã€‚&lt;/p&gt;
&lt;h3 id=&#34;åœ¨ä¸€ä¸ªè½¯ä»¶äº¤ä»˜ç»„ç»‡å†…å“ªä¸ªå›¢é˜Ÿæ‹¥æœ‰æœåŠ¡ç½‘æ ¼&#34;&gt;åœ¨ä¸€ä¸ªè½¯ä»¶äº¤ä»˜ç»„ç»‡å†…ï¼Œå“ªä¸ªå›¢é˜Ÿæ‹¥æœ‰æœåŠ¡ç½‘æ ¼ï¼Ÿ&lt;/h3&gt;
&lt;p&gt;é€šå¸¸ï¼Œå¹³å°æˆ–è¿ç»´å›¢é˜Ÿæ‹¥æœ‰æœåŠ¡ç½‘æ ¼ï¼Œä»¥åŠ Kubernetes å’ŒæŒç»­äº¤ä»˜ç®¡é“åŸºç¡€è®¾æ–½ã€‚ç„¶è€Œï¼Œå¼€å‘äººå‘˜å°†é…ç½®æœåŠ¡ç½‘æ ¼çš„å±æ€§ï¼Œå› æ­¤è¿™ä¸¤ä¸ªå›¢é˜Ÿåº”è¯¥ç´§å¯†åˆä½œã€‚è®¸å¤šä¼ä¸šæ­£åœ¨è¿½éšäº‘è®¡ç®—å…ˆé”‹çš„è„šæ­¥ï¼Œå¦‚ Netflixã€Spotify å’Œè°·æ­Œï¼Œå¹¶æ­£åœ¨åˆ›å»ºå†…éƒ¨å¹³å°å›¢é˜Ÿï¼Œä¸º&lt;a href=&#34;https://www.infoq.com/news/2018/06/netflix-full-cycle-developers/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä»¥äº§å“ä¸ºé‡ç‚¹çš„å…¨å‘¨æœŸå¼€å‘å›¢é˜Ÿ&lt;/a&gt;æä¾›å·¥å…·å’ŒæœåŠ¡ã€‚&lt;/p&gt;
&lt;h3 id=&#34;envoy-æ˜¯ä¸€ä¸ªæœåŠ¡ç½‘æ ¼å—&#34;&gt;Envoy æ˜¯ä¸€ä¸ªæœåŠ¡ç½‘æ ¼å—ï¼Ÿ&lt;/h3&gt;
&lt;p&gt;Envoy æ˜¯ä¸€ä¸ªäº‘åŸç”Ÿä»£ç†ï¼Œæœ€åˆæ˜¯ç”± Lyft å›¢é˜Ÿè®¾è®¡å’Œæ„å»ºçš„ã€‚Envoy ç»å¸¸è¢«ç”¨ä½œæœåŠ¡ç½‘æ ¼çš„æ•°æ®å¹³é¢ã€‚ç„¶è€Œï¼Œä¸ºäº†è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªæœåŠ¡ç½‘æ ¼ï¼ŒEnvoy å¿…é¡»ä¸æ§åˆ¶å¹³é¢ä¸€èµ·ä½¿ç”¨ï¼Œè¿™æ ·æ‰èƒ½ä½¿è¿™äº›æŠ€æœ¯é›†åˆæˆä¸ºä¸€ä¸ªæœåŠ¡ç½‘æ ¼ã€‚æ§åˆ¶å¹³é¢å¯ä»¥æ˜¯ç®€å•çš„é›†ä¸­å¼é…ç½®æ–‡ä»¶åº“å’ŒæŒ‡æ ‡æ”¶é›†å™¨ï¼Œä¹Ÿå¯ä»¥æ˜¯å…¨é¢ / å¤æ‚çš„ Istioã€‚&lt;/p&gt;
&lt;h3 id=&#34;istio-å’Œ-æœåŠ¡ç½‘æ ¼--è¿™ä¸¤ä¸ªè¯å¯ä»¥äº’æ¢ä½¿ç”¨å—&#34;&gt;Istio å’Œ â€œæœåŠ¡ç½‘æ ¼ &amp;quot; è¿™ä¸¤ä¸ªè¯å¯ä»¥äº’æ¢ä½¿ç”¨å—ï¼Ÿ&lt;/h3&gt;
&lt;p&gt;ä¸ï¼ŒIstio æ˜¯æœåŠ¡ç½‘æ ¼çš„ä¸€ç§ã€‚ç”±äº Istio åœ¨æœåŠ¡ç½‘æ ¼ç±»åˆ«å‡ºç°æ—¶å¾ˆå—æ¬¢è¿ï¼Œä¸€äº›äººå°† Istio å’ŒæœåŠ¡ç½‘æ ¼æ··ä¸ºä¸€è°ˆã€‚è¿™ä¸ªæ··æ·†çš„é—®é¢˜å¹¶ä¸æ˜¯æœåŠ¡ç½‘æ ¼æ‰€ç‹¬æœ‰çš„ï¼ŒåŒæ ·çš„æŒ‘æˆ˜å‘ç”Ÿåœ¨ Docker å’Œå®¹å™¨æŠ€æœ¯ä¸Šã€‚&lt;/p&gt;
&lt;h3 id=&#34;æˆ‘åº”è¯¥ä½¿ç”¨å“ªä¸ªæœåŠ¡ç½‘æ ¼&#34;&gt;æˆ‘åº”è¯¥ä½¿ç”¨å“ªä¸ªæœåŠ¡ç½‘æ ¼ï¼Ÿ&lt;/h3&gt;
&lt;p&gt;è¿™ä¸ªé—®é¢˜æ²¡æœ‰å”¯ä¸€çš„ç­”æ¡ˆã€‚å·¥ç¨‹å¸ˆå¿…é¡»äº†è§£ä»–ä»¬å½“å‰çš„éœ€æ±‚ï¼Œä»¥åŠä»–ä»¬çš„å®æ–½å›¢é˜Ÿçš„æŠ€èƒ½ã€èµ„æºå’Œæ—¶é—´ã€‚ä¸Šé¢çš„æœåŠ¡ç½‘æ ¼æ¯”è¾ƒé“¾æ¥å°†æä¾›ä¸€ä¸ªè‰¯å¥½çš„æ¢ç´¢èµ·ç‚¹ï¼Œä½†æˆ‘ä»¬å¼ºçƒˆå»ºè®®ä¼ä¸šè‡³å°‘å°è¯•ä¸¤ä¸ªç½‘æ ¼ï¼Œä»¥äº†è§£å“ªäº›äº§å“ã€æŠ€æœ¯å’Œå·¥ä½œæµç¨‹æœ€é€‚åˆä»–ä»¬ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æˆ‘å¯ä»¥åœ¨-kubernetes-ä¹‹å¤–ä½¿ç”¨æœåŠ¡ç½‘å—&#34;&gt;æˆ‘å¯ä»¥åœ¨ Kubernetes ä¹‹å¤–ä½¿ç”¨æœåŠ¡ç½‘å—ï¼Ÿ&lt;/h3&gt;
&lt;p&gt;æ˜¯çš„ã€‚è®¸å¤šæœåŠ¡ç½‘æ ¼å…è®¸åœ¨å„ç§åŸºç¡€è®¾æ–½ä¸Šå®‰è£…å’Œç®¡ç†æ•°æ®å¹³é¢ä»£ç†å’Œç›¸å…³æ§åˆ¶å¹³é¢ã€‚&lt;a href=&#34;https://www.hashicorp.com/resources/consul-service-mesh-kubernetes-and-beyond&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;HashiCorp çš„ Consul&lt;/a&gt; æ˜¯æœ€çŸ¥åçš„ä¾‹å­ï¼ŒIstio ä¹Ÿè¢«å®éªŒæ€§åœ°ç”¨äº Cloud Foundryã€‚&lt;/p&gt;
&lt;h2 id=&#34;å…¶ä»–èµ„æº&#34;&gt;å…¶ä»–èµ„æº&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.infoq.com/servicemesh/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;InfoQ æœåŠ¡ç½‘æ ¼ä¸»é¡µ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.infoq.com/minibooks/service-mesh/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;InfoQ eMagï¼šæœåŠ¡ç½‘æ ¼çš„è¿‡å»ã€ç°åœ¨å’Œæœªæ¥&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://servicemesh.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æœåŠ¡ç½‘æ ¼ï¼šæ¯ä½è½¯ä»¶å·¥ç¨‹å¸ˆéƒ½éœ€è¦äº†è§£çš„ä¸–ç•Œä¸Šæœ€å®¹æ˜“è¢«æ»¥ç”¨çš„æŠ€æœ¯&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://servicemesh.es/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æœåŠ¡ç½‘æ ¼çš„æ¯”è¾ƒ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://softwareengineeringdaily.com/2020/01/07/service-meshes/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æœåŠ¡ç½‘æ ¼&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.infoq.com/articles/cloud-native-architecture-adoption-part3/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;é‡‡ç”¨äº‘åŸç”Ÿæ¶æ„ï¼Œç¬¬ä¸‰éƒ¨åˆ†ï¼šæœåŠ¡åè°ƒå’ŒæœåŠ¡ç½‘æ ¼&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>ç½‘ç»œä»£ç† Envoy å¼€æºäº”å‘¨å¹´ï¼Œåˆ›å§‹äºº Matt Klein äº²è¿°å¼€æºå¿ƒè·¯å†ç¨‹åŠç»éªŒæ•™è®­</title>
      <link>https://lib.jimmysong.io/blog/envoy-oss-5-year/</link>
      <pubDate>Wed, 15 Sep 2021 10:41:54 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/envoy-oss-5-year/</guid>
      <description>&lt;h2 id=&#34;ç¼–è€…çš„è¯&#34;&gt;ç¼–è€…çš„è¯&lt;/h2&gt;
&lt;p&gt;æœ¬æ–‡è¯‘è‡ª Envoy ä»£ç†çš„åˆ›å§‹äºº Matt Klein äºæ˜¨æ™šåœ¨ä¸ªäººåšå®¢ä¸Šå‘å¸ƒçš„æ–‡ç«  &lt;a href=&#34;https://mattklein123.dev/2021/09/14/5-years-envoy-oss/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;5 year of Envoy OSS&lt;/a&gt;ã€‚ä»–åœ¨ Twitter å› ä¸ºè‡ªå·±çš„ç¨‹åº bug é€ æˆé‡å¤§äº‹æ•…è€Œç¦»èŒï¼ŒååŠ å…¥ Lyftï¼Œåœ¨å¼€æº Envoy ä¹‹å‰å‡ ä¹æ²¡æœ‰è´¡çŒ®å’Œç®¡ç†å¼€æºé¡¹ç›®çš„ç»éªŒï¼Œè¿™ç¯‡æ–‡ç« åˆ†äº«äº†ä»–ä¸ªäººåŠ Envoy å¼€æºçš„å¿ƒè·¯å†ç¨‹ï¼Œåœ¨æŠ•èº«å¼€æº Envoy è¿˜æ˜¯ä¸ºé›‡ä¸» Lyft æ•ˆå‘½ï¼Œè¯¥å¦‚ä½•æŠ‰æ‹©ï¼Ÿçœ‹å®Œæœ¬æ–‡ï¼Œç›¸ä¿¡å¯¹äºå¼€æºé¡¹ç›®çš„ç»´æŠ¤è€…ã€åˆ›ä¸šè€…åŠæŠ•èµ„äººéƒ½ä¼šå¤§æœ‰æ”¶è·ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å‰è¨€&#34;&gt;å‰è¨€&lt;/h2&gt;
&lt;p&gt;ä»Šå¤©æ˜¯ &lt;a href=&#34;https://www.envoyproxy.io/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Envoy Proxy å¼€æº&lt;/a&gt;çš„ &lt;a href=&#34;https://eng.lyft.com/announcing-envoy-c-l7-proxy-and-communication-bus-92520b6c8191&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;5 å‘¨å¹´&lt;/a&gt;ã€‚æ¯«ä¸å¤¸å¼ åœ°è¯´ï¼Œåœ¨ä¸“ä¸šæ–¹é¢ï¼Œè¿‡å»çš„ 5 å¹´æ˜¯ä¸€ä¸ªå²è¯—èˆ¬çš„è¿‡å±±è½¦ï¼Œæˆ‘çš„æƒ…ç»ªä»‹äºå…´å¥‹ã€è‡ªè±ªã€ç„¦è™‘ã€å°´å°¬ã€æ— èŠã€å€¦æ€ ä¹‹é—´ã€‚æˆ‘æƒ³åˆ†äº«ä¸€ä¸‹è¿™ä¸ªé¡¹ç›®çš„å‰ä¼ å’Œå†å²ï¼Œä»¥åŠæˆ‘åœ¨å‘å±•å¤§å‹å¼€æºè½¯ä»¶é¡¹ç›®çš„è¿‡ç¨‹ä¸­æ‰€å­¦åˆ°çš„ä¸€äº›ç»éªŒæ•™è®­ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å‰ä¼ å’Œå†å²&#34;&gt;å‰ä¼ å’Œå†å²&lt;/h2&gt;
&lt;h3 id=&#34;å‰ä¼ &#34;&gt;å‰ä¼ &lt;/h3&gt;
&lt;p&gt;é™¤äº†ä¸€äº›å°çš„å¼¯è·¯ï¼Œæˆ‘åœ¨æŠ€æœ¯è¡Œä¸šäºŒåå¹´çš„èŒä¸šç”Ÿæ¶¯ä¸€ç›´ä¸“æ³¨äºåº•å±‚ç³»ç»Ÿï¼šåµŒå…¥å¼ç³»ç»Ÿï¼Œæ“ä½œç³»ç»Ÿï¼Œè™šæ‹ŸåŒ–ï¼Œæ–‡ä»¶ç³»ç»Ÿï¼Œä»¥åŠæœ€è¿‘çš„åˆ†å¸ƒå¼ç³»ç»Ÿç½‘ç»œã€‚æˆ‘çš„åˆ†å¸ƒå¼ç³»ç»Ÿç½‘ç»œä¹‹æ—…å§‹äº 2010 å¹´åˆåœ¨äºšé©¬é€Šï¼Œæˆ‘æœ‰å¹¸å¸®åŠ©å¼€å‘äº†ç¬¬ä¸€æ‰¹é«˜æ€§èƒ½è®¡ç®—ï¼ˆHPCï¼‰EC2 å®ä¾‹ç±»å‹ã€‚æˆ‘å­¦åˆ°äº†å¤§é‡çš„åº•å±‚é«˜æ€§èƒ½è®¡ç®—æœºç½‘ç»œçŸ¥è¯†ï¼Œå°½ç®¡æˆ‘å¯¹åˆ†å¸ƒå¼ç³»ç»Ÿçš„æ¦‚å¿µæ¥è§¦æœ‰é™ã€‚&lt;/p&gt;
&lt;p&gt;2012 å¹´ï¼Œæˆ‘åŠ å…¥äº† Twitterï¼Œåœ¨ç»å†äº†å‡ æ¬¡é”™è¯¯çš„å¼€å§‹åï¼Œæˆ‘æœ€ç»ˆåŠ å…¥äº†è¾¹ç¼˜ç½‘ç»œå›¢é˜Ÿã€‚è¿™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡çœŸæ­£æ¥è§¦åˆ°åˆ†å¸ƒå¼ç³»ç»Ÿåº”ç”¨ç½‘ç»œæ¦‚å¿µã€‚æˆ‘é¢†å¯¼äº†ä¸€ä¸ªæ–°çš„ HTTP è¾¹ç¼˜ä»£ç†çš„å¼€å‘ï¼Œç§°ä¸º Twitter æµå¼èšåˆå™¨ï¼ˆTSAï¼‰ï¼Œå®ƒåœ¨ 2013 å¹´é¦–æ¬¡æ¨å‡ºï¼Œä»¥æ‰©å¤§ Twitter çš„ â€œfirehoseâ€ APIï¼ˆæµå¼æ‰€æœ‰æ¨æ–‡ï¼‰çš„äº¤ä»˜ã€‚åœ¨ 2014 å¹´ä¸–ç•Œæ¯å‰å¤•ï¼Œæˆ‘ä»¬å†³å®šå°† TSA ä½œä¸ºä¸€ä¸ªé€šç”¨çš„ HTTP/HTTP2/TLS è¾¹ç¼˜ä»£ç†ï¼Œåœ¨é è¿‘å·´è¥¿èµ›äº‹çš„å­˜åœ¨ç‚¹ï¼ˆPOPsï¼‰æ¨å‡ºã€‚è¿™æ ·åšçš„ä¸»è¦åŸå› æ˜¯ä¸å¯èƒ½åœ¨ POP çš„å°‘é‡ä¸»æœºæ‰˜ç®¡æœºæ¶ä¸Šéƒ¨ç½²ç°æœ‰çš„åŸºäº JVM çš„èµ„æºåŒ®ä¹çš„è¾¹ç¼˜ä»£ç†ã€‚é¡¹ç›®å‘¨æœŸç‰¹åˆ«ç´§å¼ ï¼Œæˆ‘çš„å›¢é˜ŸæˆåŠŸåœ°å®Œæˆäº†ä¸€å±Šæ²¡æœ‰äº‹æ•…çš„ä¸–ç•Œæ¯ã€‚ï¼ˆæˆ‘è¿˜æ¸…æ¥šåœ°è®°å¾—æœ‰ä¸€æ®µæ—¶é—´ï¼Œå½“è½¯ä»¶å´©æºƒæ—¶ï¼Œä¸ç®¡æ˜¯ä»€ä¹ˆæ—¶å€™ï¼Œæˆ‘éƒ½ä¼šç»™è‡ªå·±æ‰“ä¸Šä¸€é¡µï¼Œä¿®å¤é”™è¯¯ï¼Œç„¶åé‡æ–°è¿›è¡Œé‡‘ä¸é›€éƒ¨ç½²ï¼Œç»§ç»­æµ‹è¯•ï¼‰ã€‚åœ¨ Twitter å·¥ä½œæœŸé—´ï¼Œæˆ‘è¿˜æ¥è§¦åˆ°äº†è¯¥å…¬å¸é€šè¿‡ Finagle åº“è¿›è¡ŒæœåŠ¡é—´ç½‘ç»œé€šä¿¡çš„æ–¹å¼ï¼Œå¹¶å–å¾—äº†å·¨å¤§æˆåŠŸã€‚&lt;/p&gt;
&lt;p&gt;2015 å¹´å…ƒæ—¦å‰åï¼Œæˆ‘åœ¨ Twitter çš„æ—¥å­é‡Œï¼Œå› ä¸ºæˆ‘å†™çš„ä¸€ä¸ª bugï¼ŒTSA ç³»ç»Ÿæ•…éšœå¯¼è‡´æ•°ç™¾ä¸‡ Twitter çš„å®‰å“ç”¨æˆ·è¢«ä¸‹çº¿ï¼Œè¿™å°†æ˜¯æˆ‘åœ¨ Twitter å·¥ä½œçš„å°¾å£°ã€‚&lt;/p&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-matt-klein-å‘è¡¨çš„æ¨ç‰¹&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Matt Klein å‘è¡¨çš„æ¨ç‰¹&#34; srcset=&#34;
               /blog/envoy-oss-5-year/008i3skNly1guh3vblu9xj60tu0eu76p02_huf325008400e2ee78cef76533687242a3_50295_facd95aed2f3cf1809d59308700882a4.webp 400w,
               /blog/envoy-oss-5-year/008i3skNly1guh3vblu9xj60tu0eu76p02_huf325008400e2ee78cef76533687242a3_50295_dd5d122ba5b17fe4300fe1c2aaefa022.webp 760w,
               /blog/envoy-oss-5-year/008i3skNly1guh3vblu9xj60tu0eu76p02_huf325008400e2ee78cef76533687242a3_50295_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/envoy-oss-5-year/008i3skNly1guh3vblu9xj60tu0eu76p02_huf325008400e2ee78cef76533687242a3_50295_facd95aed2f3cf1809d59308700882a4.webp&#34;
               width=&#34;760&#34;
               height=&#34;378&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      Matt Klein å‘è¡¨çš„æ¨ç‰¹
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;h3 id=&#34;åŠ å…¥-lyft-å’Œåˆ›å»º-lyft-ä»£ç†&#34;&gt;åŠ å…¥ Lyft å’Œåˆ›å»º â€œLyft ä»£ç†â€&lt;/h3&gt;
&lt;p&gt;æˆ‘åœ¨ 2015 å¹´æ˜¥å¤©ç¦»å¼€äº† Twitterï¼Œéƒ¨åˆ†åŸå› æ˜¯ä¸‹çº¿äº‹ä»¶çš„å½±å“ï¼Œéƒ¨åˆ†åŸå› æ˜¯å¯¹æ²¡æœ‰å¾—åˆ°æ™‹å‡çš„æŒ«è´¥æ„Ÿï¼Œéƒ¨åˆ†åŸå› æ˜¯æƒ³å°è¯•æ–°çš„ä¸œè¥¿ã€‚æˆ‘è·Ÿç€æˆ‘çš„è€æ¿ä» Twitter åˆ°äº† Lyftï¼Œè¿˜æœ‰æˆ‘åœ¨ Twitter çš„å…¶ä»–åŒäº‹ã€‚&lt;/p&gt;
&lt;p&gt;å½“æˆ‘åŠ å…¥ Lyft æ—¶ï¼Œå…¬å¸è§„æ¨¡ç›¸å¯¹è¾ƒå°ï¼ˆå°‘äº 100 åå·¥ç¨‹å¸ˆï¼‰ï¼Œå¹¶ä¸”æ­£åœ¨åŠªåŠ›ä»å•ä½“æ¶æ„è¿ç§»åˆ°å¾®æœåŠ¡æ¶æ„ã€‚æˆ‘å·²ç»&lt;a href=&#34;https://mattklein123.dev/appearances/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å¤šæ¬¡&lt;/a&gt;è°ˆåˆ°äº† Envoy çš„è¿™éƒ¨åˆ†å†ç¨‹ï¼Œæ‰€ä»¥æˆ‘ä¸ä¼šå†é‡è¿°ï¼Œåœ¨æ­¤ç®€çŸ­çš„æ€»ç»“ä¸‹ï¼ŒLyft é‡åˆ°äº†æ‰€æœ‰å…¸å‹çš„å¾®æœåŠ¡è¿ç§»é—®é¢˜ï¼Œä¸»è¦æ˜¯æºäºç½‘ç»œå’Œå¯è§‚æµ‹æ€§ã€‚æ­¤å¤–ï¼ŒLyft å·²ç»æ˜¯ â€œå¤šé¢æ‰‹â€ï¼ˆä½¿ç”¨å¤šç§è¯­è¨€å’Œæ¡†æ¶ï¼‰ï¼Œæ‰€ä»¥ä½¿ç”¨åŸºäºåº“çš„è§£å†³æ–¹æ¡ˆæ¥è§£å†³è¿™äº›é—®é¢˜ä¼¼ä¹ä¸åˆ‡å®é™…ã€‚å› æ­¤ï¼Œæ ¹æ®æˆ‘ä»¥å‰å»ºç«‹ TSA çš„ç»éªŒå’Œè§‚å¯ŸæœåŠ¡é—´é€šä¿¡åœ¨ Twitter çš„å·¥ä½œæ–¹å¼ï¼Œç”±äºå¾—åˆ°åœ¨ Lyft çš„å‰ Twitter åŒäº‹ä»¬çš„ä¿¡ä»»ï¼Œæˆ‘æè®®å»ºç«‹ä¸€ä¸ªæ–°çš„åº”ç”¨ç½‘ç»œç³»ç»Ÿï¼Œç§°ä¸º â€œLyft ä»£ç†â€ã€‚&lt;/p&gt;
&lt;p&gt;ç»è¿‡ä¸€äº›æ¿€çƒˆçš„è®¨è®ºï¼ŒåŒ…æ‹¬æ–°çš„ä»£ç†æ˜¯å¦åº”è¯¥ç”¨ Python æ„å»ºï¼ˆæ˜¯çš„ï¼ŒçœŸçš„ï¼‰ï¼Œæˆ‘ä»¬å°±é¡¹ç›®çš„å¤§è‡´è½®å»“è¾¾æˆä¸€è‡´ï¼Œå¹¶å†³å®šä½¿ç”¨ C++ ä½œä¸ºå®ç°è¯­è¨€ã€‚åœ¨å½“æ—¶ï¼ŒC++ ä¼¼ä¹æ˜¯å”¯ä¸€åˆç†çš„é€‰æ‹©ã€‚ä»Šå¤©æˆ‘è¿˜ä¼šé€‰æ‹© C++ å—ï¼Ÿç„¶è€Œï¼Œå¦‚ä»Šå·²ç»ä¸æ˜¯ 2015 å¹´åˆäº†ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä¸è¯´ â€œEnvoy&amp;quot; è¿™ä¸ªåå­—çš„ç”±æ¥ï¼Œè¿™éƒ¨åˆ†çš„å†å²å°±ä¸å®Œæ•´äº†ã€‚æˆ‘ä»¬æ­£åœ¨ä¸ºè¿™ä¸ªé¡¹ç›®å»ºç«‹æœ€åˆçš„å¼€å‘è„šæ‰‹æ¶çš„æ—¶å€™ï¼Œä¸€ä¸ªæœ‰è¿œè§çš„åŒäº‹ï¼ˆRyan Laneï¼‰è¯´ï¼Œæˆ‘ä»¬ä¸èƒ½æŠŠè¿™ä¸ªæ–°é¡¹ç›®å«åš â€œLyft ä»£ç†â€ï¼Œæˆ‘ä»¬å¿…é¡»é€‰æ‹©ä¸€ä¸ªæ›´å¥½çš„åå­—ã€‚æˆ‘æ€»æ˜¯å¾ˆå®é™…ï¼Œå°±å»æ‰¾è¾å…¸ï¼ŒæŸ¥äº†ä¸€ä¸‹ â€œä»£ç†â€ï¼Œç„¶åå†³å®šç”¨ Envoy ä½œä¸ºæ–°åå­—ã€‚&lt;/p&gt;
&lt;h3 id=&#34;åœ¨-lyft-ä¸Šçº¿&#34;&gt;åœ¨ Lyft ä¸Šçº¿&lt;/h3&gt;
&lt;p&gt;ç›´åˆ° 2015 å¹´å¤å¤©ï¼Œæˆ‘æ‰å¼€å§‹è®¤çœŸåœ°ç ”ç©¶ Envoy çš„æºä»£ç ã€‚é‚£å‡ ä¸ªæœˆæ˜¯æˆ‘èŒä¸šç”Ÿæ¶¯ä¸­æœ€æœ‰è¶£çš„å‡ ä¸ªæœˆã€‚æˆ‘ä»¬åº”è¯¥çæƒœè¿™æ®µåˆåˆ›æ—¶æœŸï¼Œå› ä¸ºå®ƒä¸ä¼šæŒç»­å¾ˆä¹…ã€‚æˆ‘èŠ±äº†å¾ˆé•¿æ—¶é—´ï¼Œäº‰å–åœ¨åˆç†çš„æ—¶é—´å†…ï¼ˆæ ¹æ®æˆ‘çš„å®šä¹‰ï¼Œè¿™ç§ç±»å‹çš„é¡¹ç›®éœ€è¦ 3-4 ä¸ªæœˆçš„æ—¶é—´ï¼‰åšå‡ºèƒ½ç»™ Lyft å¸¦æ¥ä»·å€¼çš„ä¸œè¥¿ã€‚ä¿—è¯è¯´ï¼ŒLyft ç»™äº†æˆ‘å¤§é‡çš„ç»³å­æ¥åŠæ­»è‡ªå·±ï¼Œè€Œæˆ‘è‡´åŠ›äºç¡®ä¿è¿™ç§åŠæ­»ä¸ä¼šå‘ç”Ÿã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶ï¼Œæˆ‘çš„æ•ˆç‡ä¸»è¦å½’åŠŸäºåˆšä»å‹ç¼©çš„å¼€å‘æ—¶é—´è¡¨å’Œè®¸å¤šé”™è¯¯ï¼ˆä¸»è¦æ˜¯æˆ‘è‡ªå·±çš„ï¼‰ä¸­èµ°å‡ºæ¥ï¼Œåœ¨ Twitter çš„ TSAã€‚æˆ‘çŸ¥é“å“ªäº›é”™è¯¯æ˜¯ä¸èƒ½çŠ¯çš„ï¼Œå“ªäº›æŠ½è±¡æ˜¯éœ€è¦çš„ï¼Œå“ªäº›æµ‹è¯•æœ‰æ•ˆï¼Œå“ªäº›æ— æ•ˆï¼Œç­‰ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;2015 å¹´ç§‹å¤©å‡†å¤‡æŠ•å…¥ç”Ÿäº§çš„ Envoy çš„æœ€åˆç‰ˆæœ¬åªåŒ…å«äº†è¯¥é¡¹ç›®ä»Šå¤©æ‰€åŒ…å«çš„åŠŸèƒ½å’Œå¤æ‚æ€§çš„ä¸€å°éƒ¨åˆ†ã€‚å®ƒä¸æ”¯æŒ TLSï¼Œåªæ”¯æŒ HTTP/1ï¼Œå¹¶ä¸”æœ‰æå…¶ç®€å•çš„è·¯ç”±å’Œå¼¹æ€§åŠŸèƒ½ã€‚å®ƒæ‰€æ‹¥æœ‰çš„æ˜¯ä½ ä»Šå¤©æ‰€çœ‹åˆ°çš„ä¸œè¥¿çš„éª¨æ¶ã€‚åœ¨è¿™ä¸ªé¡¹ç›®çš„å†å²ä¸Šï¼Œå¾ˆå°‘æœ‰é‡å¤§çš„é‡æ„ï¼Œä¸»è¦æ˜¯å› ä¸ºï¼Œæ­£å¦‚æˆ‘ä¹‹å‰æ‰€è¯´çš„ï¼Œæˆ‘çŸ¥é“å°†è¦å‘ç”Ÿä»€ä¹ˆï¼Œä»¥åŠä¸ºäº†æ”¯æŒè¿™äº›åŠŸèƒ½ï¼Œéœ€è¦æœ‰å“ªäº›æŠ½è±¡ã€‚Envoy ä»ä¸€å¼€å§‹å°±æ‹¥æœ‰ä¸€æµçš„å¯è§‚æµ‹æ€§è¾“å‡ºï¼Œä»¥æŒ‡æ ‡å’Œæ—¥å¿—çš„å½¢å¼ã€‚åœ¨ 2021 å¹´ï¼Œè¿™ç§ç±»å‹çš„ç½‘ç»œå¯è§‚æµ‹æ€§æ˜¯æ¡Œé¢ä¸Šçš„èµŒæ³¨ï¼ˆè¿™åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šè¦å½’åŠŸäº Envoy çš„æˆåŠŸï¼‰ï¼Œä½†åœ¨å½“æ—¶å´ä¸æ˜¯è¿™æ ·ã€‚&lt;/p&gt;
&lt;p&gt;Envoy æœ€åˆæ˜¯ä½œä¸ºè¾¹ç¼˜ä»£ç†åœ¨ Lyft ä¸Šçº¿çš„ï¼Œä½äºæä¾› TLS ç»ˆæ­¢çš„ AWS ELB åé¢ã€‚åˆ° 2015 å¹´ç§‹æœ«ï¼ŒEnvoy ä¸º Lyft çš„ 100% æµé‡æä¾›æœåŠ¡ï¼Œè¯¥ç³»ç»Ÿäº§ç”Ÿçš„è¾¹ç¼˜ä»ªè¡¨ç›˜ç«‹å³å¾—åˆ°äº†å›æŠ¥ï¼ˆä¾‹å¦‚ï¼Œæä¾› API è°ƒç”¨ç™¾åˆ†ç‚¹å»¶è¿Ÿç›´æ–¹å›¾ï¼Œæ¯ä¸ªç»ˆç«¯çš„æˆåŠŸç‡å’Œè¯·æ±‚ç‡ç­‰ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æœ€åˆæ¨å‡ºåä¸ä¹…ï¼Œå¦ä¸€ä½ Twitter åŒäº‹ï¼ˆBill Gallagherï¼‰åŠ å…¥äº†æˆ‘çš„é¡¹ç›®ï¼Œæˆ‘ä»¬è¿…é€Ÿå¢åŠ äº†ä¸€äº›åŠŸèƒ½ï¼Œå¦‚ TLS ç»ˆæ­¢ã€HTTP/2 æ”¯æŒã€æ›´å¤šè·¯ç”±å’Œè´Ÿè½½å¹³è¡¡åŠŸèƒ½ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;ä¸æ­¤åŒæ—¶ï¼ŒLyft åŸºäº Envoy çš„ â€œæœåŠ¡ç½‘æ ¼ &amp;quot; ä¹Ÿå¼€å§‹æˆå½¢äº†ã€‚é¦–å…ˆï¼ŒEnvoy è¢«éƒ¨ç½²åœ¨ PHP å•ç‰‡æœºæ—è¾¹ï¼Œä»¥å–ä»£ HAProxy åŠå…¶ä¸€äº›å›ºæœ‰çš„è¿ç»´é—®é¢˜ï¼ˆä¾‹å¦‚ï¼Œå½“æ—¶ HAProxy ä»ç„¶æ˜¯å•çº¿ç¨‹çš„ï¼‰ï¼Œä»¥å¸®åŠ© MongoDB çš„ä»£ç†ã€‚å¯ä»¥æ¯«ä¸å¤¸å¼ åœ°è¯´ï¼ŒEnvoy çš„æ—©æœŸå¼€å‘æœ‰å¾ˆå¤§ä¸€éƒ¨åˆ†æ˜¯é’ˆå¯¹ MongoDB çš„ç¨³å®šæ€§ï¼ˆè´Ÿè½½å‡è¡¡ã€é€Ÿç‡é™åˆ¶ã€å¯è§‚æµ‹æ€§ç­‰ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;åŸºäº Envoy çš„è¾¹ç¼˜æœºç¾¤å’Œå•ä½“ä¹‹é—´çš„ç›´æ¥è§‚å¯Ÿèƒ½åŠ›çš„å¥½å¤„æ˜¯éå¸¸æ˜æ˜¾çš„ã€‚ä¸ä¹…ä¹‹åï¼Œæˆ‘ä»¬åœ¨ä¸€äº›é«˜ RPS åˆ†è§£çš„å¾®æœåŠ¡æ—è¾¹éƒ¨ç½²äº† Envoyï¼Œä»¥å¸®åŠ©æ’é™¤ç½‘ç»œé—®é¢˜ã€‚è¿™æ–¹é¢çš„ä»·å€¼ä¹Ÿå¾—åˆ°äº†è¯æ˜ã€‚éšç€æ—¶é—´çš„æ¨ç§»ï¼Œæˆ‘ä»¬è¶…è¶Šäº†å¯¹å¯è§‚æµ‹æ€§çš„å…³æ³¨ï¼Œå¢åŠ äº†å¸®åŠ©ç³»ç»Ÿå¯é æ€§çš„åŠŸèƒ½ï¼Œå¦‚ç›´æ¥è¿æ¥å’ŒæœåŠ¡å‘ç°ï¼ˆè·³è¿‡å†…éƒ¨ ELBï¼‰ã€å¼‚å¸¸å€¼æ£€æµ‹ã€å¥åº·æ£€æŸ¥ã€é‡è¯•ã€æ–­è·¯ç­‰ã€‚Lyft çš„åŸºäºè´Ÿè½½çš„é‡å¤§äº‹ä»¶çš„æ•°é‡ä»æ¯ 1-2 å‘¨ä¸€æ¬¡æ…¢æ…¢å‡å°‘ã€‚å½“ç„¶ï¼ŒEnvoy ä¸èƒ½å°†æ‰€æœ‰æ­¤ç±»äº‹ä»¶çš„å‡å°‘å½’åŠŸäºæ­¤ï¼Œä½†å®ƒæä¾›çš„ç½‘ç»œæŠ½è±¡ç¡®å®æœ‰å¾ˆå¤§çš„å¸®åŠ©ã€‚&lt;/p&gt;
&lt;p&gt;2016 å¹´åˆï¼Œæˆ‘ä»¬å†³å®šæ¨åŠ¨ä¸€ä¸ª 100% è¦†ç›–çš„æœåŠ¡ç½‘æ ¼ã€‚æœ€åˆï¼Œæˆ‘ä»¬è®¤ä¸ºè¿™å°†æ˜¯ä¸€ä¸ªè‰°éš¾çš„è¿‡ç¨‹ï¼Œéœ€è¦è‡ªä¸Šè€Œä¸‹çš„æˆæƒã€‚åœ¨å®è·µä¸­ï¼Œ&lt;strong&gt;å›¢é˜ŸæŠ¥åå‚åŠ äº†è¿ç§»ï¼Œå› ä¸ºä»–ä»¬å°†å¾—åˆ°çš„å¥½å¤„æ˜¯æ˜¾è€Œæ˜“è§çš„&lt;/strong&gt;ã€‚â€œèƒ¡èåœ &amp;ldquo;å¼çš„è¿ç§»å‡ ä¹æ€»æ˜¯æˆåŠŸçš„ã€‚è€Œ â€œå¤§æ£’&amp;rdquo; å¼çš„è¿ç§»åˆ™å¾ˆå°‘æˆåŠŸï¼Œæˆ–è€…å³ä½¿æˆåŠŸäº†ï¼Œä¹Ÿä¼šåœ¨ç»„ç»‡å†…ç•™ä¸‹çœ¼æ³ªå’Œæ„¤æ€’ã€‚&lt;/p&gt;
&lt;p&gt;åˆ° 2016 å¹´ä¸­æœŸï¼ŒEnvoy è¢«ç”¨äº Lyft çš„æ‰€æœ‰ç½‘ç»œé€šä¿¡ï¼ŒåŒ…æ‹¬è¾¹ç¼˜æœåŠ¡ã€æœåŠ¡é—´é€šä¿¡ã€æ•°æ®åº“ã€å¤–éƒ¨åˆä½œä¼™ä¼´ç­‰ã€‚æ— è®ºä»å“ªä¸ªè§’åº¦æ¥çœ‹ï¼Œè¯¥é¡¹ç›®éƒ½å–å¾—äº†å·¨å¤§çš„æˆåŠŸï¼Œå¸®åŠ© Lyft å®Œæˆäº†å¾®æœåŠ¡çš„è¿ç§»ï¼Œæé«˜äº†æ•´ä½“çš„å¯é æ€§ï¼Œå¹¶å¯¹ç½‘ç»œè¿›è¡Œäº†æŠ½è±¡ï¼Œä½¿å¤§å¤šæ•°å·¥ç¨‹å¸ˆä¸éœ€è¦äº†è§£çœŸå®çš„ç³»ç»Ÿæ‹“æ‰‘ç»“æ„ã€‚æ­¤åï¼ŒBill ç¦»å¼€äº†è¿™ä¸ªé¡¹ç›®ï¼Œåœ¨ Lyft ä»äº‹å…¶ä»–å·¥ä½œï¼Œæ¥æ›¿ä»–çš„æ˜¯ Roman Dzhabarov å’Œ Constance Caramanolis åŠ å…¥æˆ‘çš„å›¢é˜Ÿã€‚æˆ‘ä»¬çš„å°å›¢é˜Ÿä¸ºæ•´ä¸ª Lyft å¼€å‘å’Œè¿ç»´ Envoyã€‚&lt;/p&gt;
&lt;h3 id=&#34;å¼€æ”¾æºç &#34;&gt;å¼€æ”¾æºç &lt;/h3&gt;
&lt;p&gt;åˆ° 2016 å¹´å¤å¤©ï¼Œæˆ‘ä»¬å¼€å§‹è®¤çœŸè®¨è®ºå¼€æº Envoy çš„é—®é¢˜ã€‚æ—©æœŸçš„ Lyft å‘˜å·¥å¯¹å¼€æºå’Œå®ƒä¸ºå…¬å¸æ‰€åšçš„äº‹æƒ…å¾ˆæ¬£èµã€‚å¾ˆæ˜æ˜¾ï¼ŒEnvoy å¹¶ä¸æ˜¯ Lyft çš„ä¸»è¦ä¸šåŠ¡ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆä¸æŠŠå®ƒæ”¾åœ¨é‚£é‡Œå¹¶ç»™äºˆå›æŠ¥å‘¢ï¼Ÿæˆ‘å¯ä»¥å¦ç‡åœ°è¯´ï¼Œæˆ‘ä»¬éƒ½å¸¦ç€ä¸åŒçš„ç›®æ ‡å’ŒæœŸæœ›æ¥å¯¹å¾…å¼€æ”¾æºä»£ç çš„è¿‡ç¨‹ï¼Œä»¥åŠå¯¹é¡¹ç›®è·å¾—å·¨å¤§æˆåŠŸåä¼šå‘ç”Ÿä»€ä¹ˆæ„Ÿåˆ°éå¸¸å¤©çœŸã€‚&lt;/p&gt;
&lt;p&gt;åœ¨åŠ å…¥ Envoy ä¹‹å‰ï¼Œæˆ‘å·²ç»ä½¿ç”¨äº†ç›¸å½“å¤šçš„å¼€æºè½¯ä»¶ï¼Œä½†æˆ‘å‡ ä¹æ²¡æœ‰å¼€æºè´¡çŒ®çš„ç»éªŒï¼Œä¹Ÿæ²¡æœ‰ç»´æŠ¤è€…çš„ç»éªŒã€‚ï¼ˆè™½ç„¶æˆ‘åœ¨ Linux å†…æ ¸ä¸­æœ‰è¿‡&lt;a href=&#34;https://github.com/torvalds/linux/commit/00370b8f8dd6e3171b8202f9c5187a5f73e99497&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä¸€æ¬¡æäº¤&lt;/a&gt;ï¼ï¼‰å¼€æº Envoy ä¼¼ä¹æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„æœºä¼šï¼Œå¯ä»¥æ‰©å±•æˆ‘çš„æŠ€èƒ½ç»„åˆï¼Œå­¦ä¹ æ–°çš„ä¸œè¥¿ï¼Œå¯èƒ½ä¼šä¿ƒè¿›æˆ‘çš„èŒä¸šç”Ÿæ¶¯ï¼Œå¦ç‡åœ°è¯´ï¼Œæˆ‘ä¸å¸Œæœ›æœ‰ä¸€ä¸ª TSA v3 åœ¨ç¬¬ä¸‰å®¶å…¬å¸å‡ºç°ã€‚å¯¹äº Lyft æ¥è¯´ï¼ŒEnvoy æ˜¯ä¸€ä¸ªé‡è¦çš„å·¥ç¨‹é¡¹ç›®ï¼Œé¢†å¯¼å±‚è®¤ä¸ºï¼Œå¼€æ”¾æºä»£ç å°†ä½¿ Lyft ä½œä¸ºä¸€ä¸ªå·¥ç¨‹ç»„ç»‡å…·æœ‰å¯ä¿¡åº¦ï¼Œå¹¶æœ‰åŠ©äºæ‹›è˜å·¥ä½œã€‚æ­£å¦‚æˆ‘ä¹‹å‰æ‰€è¯´ï¼Œæˆ‘ä»¬æ‰€æœ‰äººéƒ½å¯¹åˆ›å»ºæˆåŠŸçš„å¼€æºï¼Œæ›´é‡è¦çš„æ˜¯åœ¨å®ƒè·å¾—æˆåŠŸçš„æƒ…å†µä¸‹åŸ¹è‚²å®ƒæ‰€éœ€è¦çš„ä¸œè¥¿æ„Ÿåˆ°å¤©çœŸã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ï¼Œæˆ‘ä»¬å†³å®šç»™å®ƒä¸€ä¸ªæœºä¼šã€‚æˆ‘ä»¬åœ¨ 2016 å¹´å¤å¤©èŠ±äº†å¾ˆå¤§ä¸€éƒ¨åˆ†æ—¶é—´æ¥ç¼–å†™æ–‡æ¡£ï¼ˆJose Nino åœ¨è¿™ä¸ªæ—¶å€™åŠ å…¥äº†å›¢é˜Ÿï¼Œä»–çš„ç¬¬ä¸€ä¸ªä»»åŠ¡å°±æ˜¯é˜…è¯»å¹¶å¸®åŠ©æ”¹è¿›æ‰€æœ‰çš„æ–‡æ¡£ï¼‰ï¼Œæ¸…ç†å­˜å‚¨åº“ï¼Œä½¿å…¶ &amp;quot; ä¸é‚£ä¹ˆå°´å°¬â€ï¼Œåˆ¶ä½œç½‘ç«™ï¼Œå‘å¸ƒåšæ–‡ç­‰ç­‰ã€‚æˆ‘çœŸçš„å¾ˆæ„Ÿè°¢è¿™æ®µæ—¶é—´é‡Œæˆ‘åœ¨ Lyft çš„åŒäº‹ï¼Œä»–ä»¬ä¸ä»…æ”¯æŒæˆ‘ä»¬ï¼Œè¿˜å¸®åŠ©æˆ‘ä»¬å®Œæˆäº†æ— æ•°çš„ä»»åŠ¡ï¼ŒåŒ…æ‹¬ç½‘ç«™è®¾è®¡ã€logo ç­‰ç­‰ã€‚å³ä½¿åœ¨è¿™ä¸ªæ—©æœŸé˜¶æ®µï¼Œæˆ‘ä»¬ä¹Ÿè§‰å¾—ç¬¬ä¸€å°è±¡å¾ˆé‡è¦ï¼Œå¦‚æœæˆ‘ä»¬è¦åœ¨å¼€æºé¢†åŸŸæœ‰æ‰€ä½œä¸ºï¼Œå°±å¿…é¡»é€šè¿‡é«˜è´¨é‡çš„æ–‡æ¡£ã€ç½‘ç«™ç­‰ç»™äººç•™ä¸‹è‰¯å¥½çš„ç¬¬ä¸€å°è±¡ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æ­¤æœŸé—´ï¼Œæˆ‘ä»¬è¿˜åˆ©ç”¨æˆ‘ä»¬çš„è¡Œä¸šå…³ç³»ï¼Œä¸ Lyft çš„ä¸€äº› â€œåŒè¡Œå…¬å¸â€ï¼ˆæ¹¾åŒºçš„ â€œç‹¬è§’å…½ &amp;quot; äº’è”ç½‘åˆ›ä¸šå…¬å¸ï¼‰ä¼šé¢ï¼Œå‘ä»–ä»¬å±•ç¤ºæˆ‘ä»¬åœ¨ Envoy æ–¹é¢æ‰€åšçš„å·¥ä½œï¼Œå¹¶è·å¾—ä»–ä»¬çš„åé¦ˆï¼Œæˆ‘ä»¬è®¤ä¸ºå¦‚æœæˆ‘ä»¬åœ¨æ­£å¼å¼€æºå‰æˆåŠŸè·å¾—ä¸€ä¸ªå¯åŠ¨åˆä½œä¼™ä¼´ï¼Œè¿™å°†æ˜¯å¯¹é¡¹ç›®çš„ä¸€ä¸ªé‡å¤§å¸®åŠ©ã€‚æ‰€æœ‰è¿™äº›ä¼šè®®éƒ½éå¸¸å‹å¥½ï¼Œæ€»çš„æ¥è¯´ï¼Œæ‰€æœ‰ä¸æˆ‘ä»¬ä¼šé¢çš„å…¬å¸éƒ½å¯¹æˆ‘ä»¬æ‰€å–å¾—çš„æˆå°±å°è±¡æ·±åˆ»ã€‚ä½†æ˜¯ï¼Œäº‹åçœ‹æ¥ï¼Œä»–ä»¬éƒ½è¡¨ç¤ºï¼Œä»¥ä»–ä»¬çš„å°å‹åŸºç¡€è®¾æ–½å›¢é˜Ÿï¼Œä¸å¯èƒ½é©¬ä¸Šé‡‡ç”¨ Envoyã€‚ä»–ä»¬ç¥æ„¿æˆ‘ä»¬åœ¨å¼€æ”¾æºä»£ç æ–¹é¢å–å¾—æœ€å¥½çš„æˆç»©ï¼Œå¹¶è¯´ä»–ä»¬ä»¥åä¼šå›æ¥çœ‹çœ‹ã€‚æˆ‘ä»¬ä¸ç¦å¯¹è¿™äº›ä¼šè®®çš„ç»“æœæ„Ÿåˆ°æ²®ä¸§ï¼Œä½†æˆ‘ä»¬è¿˜æ˜¯å‘å‰æ¨è¿›äº†ã€‚&lt;/p&gt;
&lt;p&gt;2015 å¹´ 8 æœˆï¼Œæˆ‘ä¸è°·æ­Œè¿›è¡Œäº†ç¬¬ä¸€æ¬¡å‹å¥½çš„ä¼šé¢ã€‚ä¸€ä¸ª Lyft çš„åŒäº‹ï¼ˆChris Burnettï¼‰åœ¨ä¸€ä¸ª gRPC èšä¼šä¸Šå‘è¨€ï¼Œæåˆ°äº† Envoyï¼Œå› ä¸ºå®ƒä¸ Envoy çš„ &lt;a href=&#34;https://www.envoyproxy.io/docs/envoy/latest/intro/arch_overview/other_protocols/grpc#grpc-bridging&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;gRPC æ¡¥æ¥&lt;/a&gt;æ”¯æŒæœ‰å…³ã€‚æˆ‘ä¸çŸ¥é“çš„æ˜¯ï¼Œè°·æ­Œåœ¨å‘ç° Envoy çš„æ—¶å€™ï¼Œæ­£å‡†å¤‡åœ¨ NGINX çš„åŸºç¡€ä¸Šæ¨å‡º Istioã€‚ä¸€æ¬¡ä¼šè®®å¼•å‡ºäº†å¦ä¸€æ¬¡ä¼šè®®ï¼Œç„¶åæ˜¯æ›´å¤šçš„ä¼šè®®ï¼Œåœ¨ Envoy å¼€æºä¹‹å‰ï¼Œå¤§é‡çš„è°·æ­Œå‘˜å·¥å·²ç»çœ‹åˆ°äº†æºä»£ç å’Œæ–‡æ¡£ã€‚(ç¨åä¼šæœ‰æ›´å¤šå…³äºè¿™æ–¹é¢çš„å†…å®¹ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;åˆ° 9 æœˆåˆï¼Œæˆ‘ä»¬å·²ç»å‡†å¤‡å¥½äº†ï¼Œå¹¶å°†å¼€æºæ—¥å®šä¸º 9 æœˆ 14 æ—¥ã€‚æ€»çš„æ¥è¯´ï¼Œæˆ‘æ˜¯ä¸€ä¸ªï¼ˆè¿‡åº¦ï¼Ÿï¼‰è‡ªä¿¡çš„äººï¼Œä½†åœ¨æˆ‘çš„ç”Ÿæ´»ä¸­ï¼Œæœ‰å‡ æ¬¡æˆ‘å¯¹è‡ªå·±æˆåŠŸçš„èƒ½åŠ›æœ‰å¾ˆå¤§çš„ç„¦è™‘ã€‚æˆ‘ç«‹å³æƒ³åˆ°çš„æ˜¯ï¼šå¼€å§‹ä¸Šé«˜ä¸­ï¼Œå¼€å§‹ä¸Šå¤§å­¦ï¼Œä»¥åŠå¤§å­¦æ¯•ä¸šååœ¨å¾®è½¯å·¥ä½œã€‚è€Œå¼€æºçš„ Envoy å°±æ˜¯å…¶ä¸­ä¹‹ä¸€ã€‚æˆ‘è®°å¾—æˆ‘è¢«å…¬ä¼—çš„ååº”å“åäº†ã€‚äººä»¬ä¼šæ€ä¹ˆè¯´ï¼Ÿåé¦ˆä¼šæ˜¯ç§¯æçš„è¿˜æ˜¯æ¶æ¯’çš„ï¼Ÿè™½ç„¶æˆ‘ä»¬åœ¨å¼€æºæ—¶æ˜¯ä¸€ä¸ªå°å›¢é˜Ÿï¼Œä½†æˆ‘ä»ç„¶å†™äº† 90% æˆ–æ›´å¤šçš„ä»£ç ï¼Œå¹¶ä¸”è§‰å¾—æŠŠå®ƒæ”¾åˆ°å…¬å…±é¢†åŸŸæ˜¯å¯¹æˆ‘è‡ªå·±å’Œæˆ‘çš„èƒ½åŠ›çš„ä¸€ç§åæ˜ ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœŸè€Œè‡³ï¼Œ&lt;a href=&#34;https://eng.lyft.com/announcing-envoy-c-l7-proxy-and-communication-bus-92520b6c8191&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Envoy&lt;/a&gt; åœ¨ 2016 å¹´ 9 æœˆ 14 æ—¥ &lt;a href=&#34;https://eng.lyft.com/announcing-envoy-c-l7-proxy-and-communication-bus-92520b6c8191&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æˆä¸ºå¼€æºäº§å“&lt;/a&gt;ã€‚æˆ‘è®°å¾—æˆ‘å’Œå¦»å­ä¸€èµ·åº†ç¥ï¼Œå¹¶è¯´äº†ä¸€äº›è¯ã€‚â€œå¦‚æœæˆ‘ä»¬èƒ½è®©å…¶ä»–å…¬å¸åƒ Lyft ä¸€æ ·ä½¿ç”¨ Envoyï¼Œæˆ‘å°±ä¼šå¾ˆé«˜å…´ã€‚â€&lt;/p&gt;
&lt;p&gt;å¯¹å¼€æ”¾æºç å‘å¸ƒçš„ååº”å‡ ä¹æ˜¯æ™®éçš„ç§¯æã€‚ä»¤æˆ‘ä»¬æƒŠè®¶çš„æ˜¯ï¼Œå‡ ä¹æ˜¯ç«‹åˆ»ï¼Œæˆ‘ä»¬å¼€å§‹å¬åˆ°å¤§å…¬å¸çš„å£°éŸ³ï¼Œè€Œä¸æ˜¯å°å…¬å¸ã€‚åœ¨å‡ å‘¨å†…ï¼Œæˆ‘ä»¬ä¸è‹¹æœã€å¾®è½¯è¿›è¡Œäº†äº¤è°ˆï¼Œä¸è°·æ­Œçš„å¯¹è¯ä¹Ÿä¸æ–­åŠ å¿«ã€‚å¤§å…¬å¸åœ¨ç°æœ‰çš„è§£å†³æ–¹æ¡ˆä¸­å­˜åœ¨é—®é¢˜ï¼Œå¹¶ä¸”æœ‰å¤§é‡çš„å›¢é˜Ÿå‡†å¤‡æŠ•å…¥åˆ°è§£å†³è¿™äº›é—®é¢˜çš„å·¥ä½œä¸­ã€‚å…·æœ‰è®½åˆºæ„å‘³çš„æ˜¯ï¼ˆè‡³å°‘åœ¨ Twitter çš„è§‚ç‚¹ä¸­ï¼‰ï¼ŒC++ åœ¨è¿™é‡Œæ˜¯ä¸€ç§å¸®åŠ©ï¼Œè€Œä¸æ˜¯ä¸€ç§é˜»ç¢ã€‚è¿™äº›å¤§å…¬å¸éƒ½å·²ç»æ‹¥æœ‰å……è¶³çš„ C/C++ å¼€å‘èµ„æºï¼Œä»¥åŠä»–ä»¬æƒ³è¦æ•´åˆçš„ç°æœ‰åº“ï¼Œç­‰ç­‰ã€‚å¯¹ä»–ä»¬æ¥è¯´ï¼ŒC++ æ˜¯ä¸€ä¸ªå–ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿™æ®µæ—¶é—´é‡Œï¼Œæ¯«ä¸å¥‡æ€ªï¼Œæˆ‘ä»¬ä¸è°·æ­Œçš„äººæœ‰æœ€å¤šçš„äº’åŠ¨ã€‚æœ€åˆä¸»è¦æ˜¯æ„å»º Istio çš„å›¢é˜Ÿï¼Œä½†æ¸æ¸åœ°ï¼Œæˆ‘ä»¬ä¸ Anna Berenberg èŠ±äº†æ›´å¤šæ—¶é—´ï¼Œå¥¹ç°åœ¨æ˜¯è°·æ­Œçš„æ°å‡ºå·¥ç¨‹å¸ˆï¼Œé¢†å¯¼å„ç§ç½‘ç»œå’Œè´Ÿè½½å‡è¡¡å·¥ä½œã€‚è¿™ç§å…³ç³»å°†äº§ç”Ÿ &amp;quot; å–·æ°”ç‡ƒæ–™â€ï¼Œåœ¨ 2017 å¹´åˆçœŸæ­£å¯åŠ¨è¯¥é¡¹ç›®ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å¼€å§‹èµ·é£&#34;&gt;å¼€å§‹èµ·é£&lt;/h3&gt;
&lt;p&gt;åˆ°äº† 2017 å¹´åˆï¼Œå¾ˆæ˜æ˜¾ï¼ŒEnvoy çš„å¼€å‘æ­£åœ¨åŠ é€Ÿã€‚è°·æ­Œæ‰¿è¯ºç”¨ Envoy å–ä»£ NGINXï¼Œç”¨äº Istioï¼ˆæœ€ç»ˆåœ¨ 2017 å¹´æ˜¥å­£æ¨å‡ºï¼‰ï¼Œå¯¹é¡¹ç›®çš„æœªæ¥æ¥è¯´æ›´é‡è¦çš„æ˜¯ï¼ŒAnna çš„å¤§å‹å›¢é˜Ÿè‡´åŠ›äº GCP äº‘è´Ÿè½½å‡è¡¡åŠŸèƒ½ï¼Œä»–ä»¬å¼€å§‹å‘ä½¿ç”¨ Envoy çš„å„ç§äº‘è´Ÿè½½å‡è¡¡äº§å“ä»¥åŠå†…éƒ¨ç”¨ä¾‹ï¼ˆè¿™åœ¨è¿™ä¸ªæ—¶æœŸéƒ½æ˜¯éå¸¸ç§˜å¯†çš„ï¼Œä½†ç°åœ¨å·²ç»ä¼—æ‰€å‘¨çŸ¥ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘å°†æ°¸è¿œè®°å¾—ä¸è°·æ­Œäº’åŠ¨çš„é‚£æ®µæ—¶é—´æ˜¯æˆ‘èŒä¸šç”Ÿæ¶¯ä¸­æœ€ç´§å¼ çš„æ—¶æœŸä¹‹ä¸€ã€‚è¯´å®è¯ï¼Œé‚£æ„Ÿè§‰å°±åƒä¸€ä¸ªæ”¶è´­ï¼ˆå®¡è®¯ï¼‰è¿‡ç¨‹ã€‚æˆ‘è®°å¾—é•¿é•¿çš„ä¼šè®®å’Œç”µå­é‚®ä»¶çº¿ç¨‹ï¼Œä»¥è¯æ˜æˆ‘ä»¬çš„æŠ€æœ¯å†³å®šï¼Œâ€œé¢è¯• &amp;ldquo;ä¸­ï¼Œè°·æ­Œè¯•å›¾ç¡®å®šæˆ‘ä»¬æ˜¯å¦ä¼šæˆä¸ºä¸€ä¸ªå¥½çš„å¼€æºé¡¹ç›®åˆä½œä¼™ä¼´ï¼Œç­‰ç­‰ã€‚å½“æ—¶æˆ‘ä»¬å¾ˆç—›è‹¦åœ°å‘ç°ï¼Œè¿™æ¬¡&amp;rdquo; æ”¶è´­ &amp;quot; å°†ä½¿ Envoy è¿›å…¥ä¸€ä¸ªæˆ‘ä»¬è‡ªå·±æ°¸è¿œæ— æ³•å®ç°çš„è½¨é“ï¼Œæ‰€ä»¥æˆ‘ä»¬å°½ä¸€åˆ‡åŠªåŠ›ä½¿å®ƒè·å¾—æˆåŠŸï¼Œæœ€ç»ˆä¹Ÿè·å¾—äº†æˆåŠŸã€‚è€Œä¸”ï¼Œåœ¨è¿‡å» 4 å¹´å¤šçš„æ—¶é—´é‡Œï¼Œæˆ‘ä»¬ä¸è°·æ­Œçš„åˆä½œç¡®å®æ˜¯ä¸€ç§æ°å‡ºçš„ä¼™ä¼´å…³ç³»ã€‚æ—©æœŸçš„è°·æ­Œäº‘å·¥ç¨‹å¸ˆæœ€ç»ˆæˆä¸ºç»´æŠ¤è€…ï¼ŒHarvey Tuch å’Œ Alyssa Wilkï¼Œä¸ºé¡¹ç›®å¸¦æ¥äº†å¤§é‡çš„äººæ‰ï¼ŒåŒ…æ‹¬æŠ€æœ¯ä¸Šçš„ï¼Œä»¥åŠå¯¹å¼€æºå’Œç¤¾åŒºçš„æ”¯æŒã€‚æˆ‘å¯¹ä»–ä»¬çš„æ„Ÿæ¿€ä¹‹æƒ…æº¢äºè¨€è¡¨ï¼Œæ²¡æœ‰ä»–ä»¬ï¼Œé¡¹ç›®å°±ä¸ä¼šæœ‰ä»Šå¤©çš„æˆå°±ã€‚å¤šå¹´æ¥ä¸ºè¯¥é¡¹ç›®åšå‡ºè´¡çŒ®çš„å…¶ä»–è°·æ­Œå·¥ç¨‹å¸ˆï¼ˆç°åœ¨æœ‰å¾ˆå¤šï¼‰ï¼Œé™¤äº†æ™®éæ˜¯ä¼˜ç§€çš„ç¤¾åŒºç®¡ç†è€…ä¹‹å¤–ï¼Œè¿˜ä¸ºè¯¥é¡¹ç›®å¢åŠ äº†å¤§é‡çš„å·¥ç¨‹åŠ›é‡ï¼Œå¦åˆ™è¯¥é¡¹ç›®å°±ä¸ä¼šæœ‰ã€‚æˆ‘å½“ç„¶å¯¹æœ€åˆçš„è°·æ­Œåˆä½œå…³ç³»æœ‰é¡¾è™‘ï¼ˆæŠ€æœ¯å’Œç†å¿µä¸Šçš„åˆ†æ­§ï¼Œç­‰ç­‰ï¼‰ï¼Œä½†æˆ‘å¯ä»¥è¯šå®åœ°è¯´ï¼Œè¿™äº›é¡¾è™‘éƒ½æ²¡æœ‰æˆä¸ºç°å®ã€‚&lt;/p&gt;
&lt;p&gt;é™¤äº†ç¡®ä¿ Istio å’Œ GCP å›¢é˜Ÿä¸è°·æ­Œåˆä½œçš„æˆåŠŸä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜èŠ±äº†å¤§é‡æ—¶é—´ä¸å…¶ä»–å…¬å¸å’Œç»´æŠ¤è€…åˆä½œå¹¶åŠ å…¥ä»–ä»¬ï¼Œå…¶ä¸­è®¸å¤šäººå¯¹é¡¹ç›®äº§ç”Ÿäº†å·¨å¤§çš„å½±å“ï¼Œè‡³ä»Šä»ä½œä¸ºç»´æŠ¤è€…ã€è´¡çŒ®è€…æˆ–ç”¨æˆ·å¤§é‡å‚ä¸ã€‚å¦‚æœæ²¡æœ‰è¿™äº›æ—©æœŸçš„ç¤¾åŒºæˆå‘˜ï¼Œè¿™ä¸ªé¡¹ç›®å°±ä¸ä¼šæœ‰ä»Šå¤©ï¼Œæˆ‘ä¹Ÿéå¸¸æ„Ÿè°¢ä»–ä»¬å¯¹é¡¹ç›®çš„ä¿¡ä»»ã€‚&lt;/p&gt;
&lt;p&gt;åŒæ—¶ï¼Œéšç€é¡¹ç›®çš„ä¸æ–­æ·±å…¥ï¼Œæˆ‘å¼€å§‹æ”¶åˆ°å¤§é‡æŠ•èµ„è€…å¯¹ Enovy çš„å…´è¶£ã€‚æœ‰å¼ºçƒˆçš„æ„¿æœ›è®©æˆ‘ç¦»å¼€ Lyftï¼Œå›´ç»•è¿™ä¸ªé¡¹ç›®å¼€ä¸€å®¶å…¬å¸ã€‚æˆ‘&lt;a href=&#34;https://medium.com/@mattklein123/optimizing-impact-why-i-will-not-start-an-envoy-platform-company-8904286658cb&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å†™è¿‡è¿™éƒ¨åˆ†çš„æ—…ç¨‹&lt;/a&gt;ï¼Œæ‰€ä»¥æˆ‘ä¸ä¼šåœ¨è¿™é‡Œé‡è¿°ï¼Œç•™åœ¨ Lyft æˆ‘ä¼šæœ‰å¤§é‡çš„æ—¶é—´å’Œç²¾åŠ›æ¥å¤„ç†æ‰€æœ‰è¿™äº›äº’åŠ¨ã€‚æ­£å¦‚é“¾æ¥çš„æ–‡ç« æ‰€æè¿°çš„ï¼Œæˆ‘æœ€ç»ˆå†³å®šç•™åœ¨ Lyftï¼Œä¸å¼€å…¬å¸ï¼Œä»¥æ”¯æŒ Envoy çš„æŒç»­æˆåŠŸã€‚&lt;/p&gt;
&lt;p&gt;ä¸æ­¤åŒæ—¶ï¼Œæˆ‘ä»ç„¶åœ¨ Lyft å·¥ä½œï¼Œæ­£å¦‚æˆ‘å°†åœ¨åé¢è¿›ä¸€æ­¥è®¨è®ºçš„é‚£æ ·ï¼Œæˆ‘è¶Šæ¥è¶Šå¤šåœ°ä»äº‹ä¸¤ä»½å·¥ä½œã€‚æˆ‘çš„ç¬¬ä¸€ä»½å·¥ä½œæ˜¯åœ¨å†…éƒ¨é¢†å¯¼ç½‘ç»œå›¢é˜Ÿï¼Œå¹¶åœ¨è¿è¥ä¸Šæ”¯æŒ Lyft çš„ Envoyã€‚æˆ‘çš„ç¬¬äºŒä»½å·¥ä½œæ˜¯ä½œä¸º Envoy çš„å…¬ä¼—å½¢è±¡ï¼ŒåŒ…æ‹¬ OSS é¢†å¯¼ï¼Œä»£ç å®¡æŸ¥ï¼Œä¿®å¤é”™è¯¯ï¼Œç¼–å†™å¯ä»¥ä¿ƒè¿›é¡¹ç›®çš„åŠŸèƒ½ï¼Œåœ¨ä¼šè®®ä¸Šå‘è¨€ï¼Œå¸®åŠ©å…¶ä»–å…¬å¸é‡‡ç”¨å’Œéƒ¨ç½² Envoyï¼Œç­‰ç­‰ã€‚æˆ‘å¼€å§‹å˜å¾—è¿‡äºåˆ†æ•£ï¼Œå¹¶å‡ºç°äº†å€¦æ€ çš„è¿¹è±¡ã€‚ç„¶è€Œï¼Œåˆ°äº† 2017 å¹´å¹´ä¸­ï¼Œä¸å¯å¦è®¤çš„äº‹å®æ˜¯ï¼ŒEnvoy çš„å‘å±•è½¨è¿¹æ˜¯å¤§å¤§çš„ â€œå‘ä¸Šå’Œå‘å³â€ã€‚å„å¤§å…¬å¸ã€â€œåŒè¡Œå…¬å¸â€ã€å‚ç›´äº§å“å’ŒæœåŠ¡ç­‰çš„é‡‡ç”¨ç‡ç»§ç»­æ”€å‡ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æèµ ç»™-cncf-ä¸”æ„Ÿåˆ°å€¦æ€ &#34;&gt;æèµ ç»™ CNCF ä¸”æ„Ÿåˆ°å€¦æ€ &lt;/h3&gt;
&lt;p&gt;åˆ° 2017 å¹´ç§‹å¤©ï¼Œæœ‰ä¸¤ä»¶äº‹æ˜¯æ¸…æ¥šçš„ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Envoy å·²ç»è¶…å‡ºäº† Lyft OSS è®¾å¤‡æ‰€èƒ½æä¾›çš„èŒƒå›´ã€‚è¯¥é¡¹ç›®éœ€è¦æ³•å¾‹ã€å…¬å…±å…³ç³»ã€è¥é”€ã€æ´»åŠ¨ç»„ç»‡ç­‰æ–¹é¢çš„å¸®åŠ©ã€‚&lt;/li&gt;
&lt;li&gt;æˆ‘å¾ˆå¿«å°±å®Œå…¨å€¦æ€ äº†ï¼Œéœ€è¦æ‰¾å‡ºä¸€æ¡å¯æŒç»­å‘å±•çš„é“è·¯ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä¸ºäº†è§£å†³ç¬¬ä¸€ç‚¹ï¼Œæˆ‘ä»¬æœ€ç»ˆåŒæ„è€ƒè™‘å°† Envoy è½¬äº¤åˆ° CNCFã€‚æ•°æœˆæ¥ï¼ŒCNCF ä¸€ç›´åœ¨è¿½æ±‚è¯¥é¡¹ç›®ï¼Œä½†ä¼¼ä¹ä»æ¥æ²¡æœ‰ä»»ä½•ä»¤äººä¿¡æœçš„ç†ç”±æ¥åŠ å…¥ã€‚åˆ° 2017 å¹´åº•ï¼Œå¾ˆæ˜æ˜¾ï¼ŒCNCF çš„èµ„æºå³ä½¿ä¸æ˜¯å‡€æ”¶ç›Šï¼Œä¹Ÿè‡³å°‘å¯¹é¡¹ç›®æ˜¯ä¸­æ€§çš„ã€‚æˆ‘ä»¬å¼€å§‹äº†æäº¤ç¨‹åºï¼Œå¹¶æœ€ç»ˆåœ¨æˆ‘ä»¬æœ€åˆå¼€æ”¾é¡¹ç›®èµ„æºçš„å‡ ä¹æ•´æ•´ä¸€å¹´å&lt;a href=&#34;https://eng.lyft.com/envoy-joins-the-cncf-dc18baefbc22&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;åŠ å…¥äº†è¯¥åŸºé‡‘ä¼š&lt;/a&gt;ã€‚æˆ‘å¾ˆæ„Ÿè°¢ Alexis Richardson å’Œ Chris Aniszczyk åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å¯¹é¡¹ç›®çš„æŒ‡å¯¼ã€‚&lt;/p&gt;
&lt;p&gt;ç¬¬äºŒç‚¹åˆ™è¦å¤æ‚å¾—å¤šã€‚ä»æ ¹æœ¬ä¸Šè¯´ï¼Œæˆ‘çš„å·¥ä½œæ—¶é—´è¶…è¿‡äº†æˆ‘çš„å·¥ä½œèƒ½åŠ›ï¼Œæœ‰æ•ˆåœ°è·¨è¶Šäº†ä¸¤ä¸ªä¸åŒçš„å·¥ä½œã€‚æ­¤å¤–ï¼Œæˆ‘æ­£åœ¨æœŸå¾…æˆ‘çš„ç¬¬ä¸€ä¸ªå­©å­ï¼Œé¢„äº§æœŸåœ¨ 2018 å¹´åˆï¼Œéšç€åˆ°æ¥çš„æ—¥æœŸè¶Šæ¥è¶Šè¿‘ï¼Œè¿™è®©æˆ‘è¶Šæ¥è¶Šç„¦è™‘ã€‚åˆ°è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘å·²ç»å¾ˆæ¸…æ¥šï¼Œæˆ‘åœ¨è®¾å®šæœŸæœ›å’Œç•Œé™æ–¹é¢åšå¾—ä¸å¤Ÿå¥½ï¼Œä¸çŸ¥é“è‡ªå·±èƒ½å¤Ÿä¸º Lyft æä¾›ä»€ä¹ˆï¼ŒåŒæ—¶ä¹Ÿæ²¡æœ‰ä»è¡Œä¸šçš„è§’åº¦å…³æ³¨ Envoy çš„æŒç»­å¢é•¿ã€‚åœ¨ Lyftï¼Œæˆ‘è¶Šæ¥è¶Šæ”¾ä»»è‡ªæµï¼Œé™·å…¥äººé™…å…³ç³»çš„äº‰åµï¼Œåœ¨ä¸ºæ›´å¤šçš„åˆçº§å›¢é˜Ÿæˆå‘˜æä¾›æŒ‡å¯¼å’Œé¢†å¯¼æ–¹é¢ï¼Œæ²¡æœ‰è¾¾åˆ°æˆ‘è¿™ä¸ªçº§åˆ«çš„æœŸæœ›ã€‚&lt;/p&gt;
&lt;p&gt;ç®€è€Œè¨€ä¹‹ï¼Œæˆ‘å½“æ—¶æ­£å¤„äºå´©æºƒçš„è¾¹ç¼˜ï¼Œæœ€ç»ˆæˆ‘é€‰æ‹©äº† Envoy è€Œä¸æ˜¯ Lyftï¼Œè¿™å¯¹æˆ‘çš„ Lyft åŒäº‹é€ æˆäº†ä¼¤å®³ã€‚æˆ‘æƒ³ï¼Œå¦‚æœæˆ‘åœ¨ 2017 å¹´åˆè‡³å¹´ä¸­å¯¹æˆ‘çš„å·¥ä½œé‡ä¸ Lyft çš„é¢†å¯¼å±‚æ›´åŠ é€æ˜ï¼Œæˆ‘å¯èƒ½ä¼šé¿å…ä¸€äº›æœ€ç³Ÿç³•çš„ç»“æœï¼Œä½†ä¸å¹¸çš„ç°å®æ˜¯ï¼Œ&lt;strong&gt;ä¸ºå¼€æºè½¯ä»¶è¡Œä¸šçš„å·¥ä½œæä¾›èµ„æºï¼Œè€Œè¿™äº›å·¥ä½œå¯¹é›‡ä¸»æ²¡æœ‰ç«‹å³æ˜æ˜¾çš„ä½œç”¨ï¼Œè¿™æ˜¯ä¸€ä¸ªå¤æ‚çš„åŠªåŠ›&lt;/strong&gt;ã€‚å®ƒå¯èƒ½ä¼šæ›´é¡ºåˆ©ï¼Œä¹Ÿå¯èƒ½ä¸ä¼šã€‚åœ¨ä»»ä½•æƒ…å†µä¸‹ï¼Œè™½ç„¶æˆ‘å¯¹ä¸€äº›æˆ‘æœ¬å¯ä»¥å¤„ç†å¾—æ›´å¥½çš„äººé™…å…³ç³»é—®é¢˜æ„Ÿåˆ°é—æ†¾ï¼Œä½†æ— è®ºå¥½åï¼Œ&lt;strong&gt;æˆ‘éƒ½ä¸åæ‚”æŠŠç²¾åŠ›æ”¾åœ¨ Envoy ä¸Šã€‚æˆ‘ä¼˜å…ˆè€ƒè™‘çš„æ˜¯ Envoyï¼Œè€Œä¸æ˜¯ Lyftï¼Œæˆ‘åšäº†æˆ‘è®¤ä¸ºå½“æ—¶å¿…é¡»åšçš„äº‹æƒ…ï¼Œä»¥ä½¿å®ƒæˆåŠŸ&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å¯æŒç»­å‘å±•é“è·¯&#34;&gt;å¯æŒç»­å‘å±•é“è·¯&lt;/h3&gt;
&lt;p&gt;æˆ‘çš„ç¬¬ä¸€ä¸ªå­©å­åœ¨ 2018 å¹´ 2 æœˆå‡ºç”Ÿï¼ŒLyft æå…¶æ…·æ…¨çš„é™ªäº§å‡æ”¿ç­–ä¸ºæˆ‘æä¾›äº†ä¼‘æ¯å’Œæ”¾ç©ºè‡ªå·±çš„æ—¶é—´ã€‚æˆ‘ä» Lyft è·å¾—äº†ä¸€äº›ç©ºé—´ï¼Œå¹¶å¼€å§‹æ›´æ·±å…¥åœ°æ€è€ƒæˆ‘æƒ³è¦ä»€ä¹ˆä»¥åŠä»€ä¹ˆå¯¹æˆ‘æ¥è¯´æ˜¯å¯æŒç»­çš„ã€‚&lt;/p&gt;
&lt;p&gt;å½“æˆ‘ä¼‘å®Œé™ªäº§å‡å›æ¥åï¼Œæˆ‘ä¸ Lyft é¢†å¯¼å±‚æ˜ç¡®è¡¨ç¤ºï¼Œæˆ‘ä¸èƒ½å†å‚ä¸ Lyft çš„ Envoy çš„ &amp;ldquo;æ—¥å¸¸&amp;rdquo; è¿ç»´ã€‚ç›¸åï¼Œç”±äº 2017 å¹´åº•çš„ä¸€äº›åæœï¼ŒåŸºç¡€è®¾æ–½å›¢é˜Ÿä¹Ÿå¸Œæœ›ä¸æˆ‘åˆ†å¼€ä¸€äº›ã€‚ç”±äºè¿™ä¸ªåŸå› ï¼Œ&lt;strong&gt;æˆ‘å¤§å¹…åé€€ï¼Œå®é™…ä¸Šå®Œå…¨åœæ­¢äº†åœ¨ Lyft çš„åŸºç¡€è®¾æ–½å·¥ä½œ&lt;/strong&gt;ï¼Œåœ¨ 2018 å¹´å¹´ä¸­è‡³å¹´æœ«çš„ Lyft Bikes å’Œ Scooters åˆå§‹ç‰ˆæœ¬ä¸­ç¼–å†™å›ºä»¶ç½‘ç»œä»£ç ã€‚è¿™æ˜¯ä¸€ä¸ªäº†ä¸èµ·çš„å›¢é˜ŸåŠªåŠ›ï¼Œåœ¨å‹ç¼©çš„æ—¶é—´èŒƒå›´å†…å¾—åˆ°äº†ä¸€äº›ä¸œè¥¿ï¼Œæˆ‘çœŸçš„å¾ˆå–œæ¬¢åœ¨å‡ ä¸ªæœˆå†…åšä¸€äº›å®Œå…¨ä¸åŒçš„äº‹æƒ…ã€‚&lt;/p&gt;
&lt;p&gt;2018 å¹´ä¹Ÿæ˜¯æˆ‘ç§¯æå¼€å§‹ç¢ç£¨åœ¨ Envoy OSS ç¤¾åŒºä¸­ &amp;ldquo;å–ä»£è‡ªå·±&amp;rdquo; çš„é‚£ä¸€å¹´ã€‚æˆ‘èŠ±äº†å¤§é‡çš„æ—¶é—´ï¼ˆå¹¶å°†ç»§ç»­èŠ±å¤§é‡çš„æ—¶é—´ï¼‰æ¥åŸ¹å…»ç»´æŠ¤è€…ã€æ–°çš„è´¡çŒ®è€…ï¼Œç»„ç»‡ç¬¬ä¸€æ¬¡ä¸“é—¨çš„ EnvoyConï¼Œç­‰ç­‰ã€‚ä»»ä½•é¢†å¯¼è€…éƒ½åº”è¯¥æœ‰ä¸€ä¸ªç›®æ ‡ï¼Œé‚£å°±æ˜¯ç¡®ä¿è¯¥ç»„ç»‡åœ¨æœ‰ä¸€å¤©è¯¥é¢†å¯¼è€…é€€ä½æ—¶èƒ½å¤Ÿç»§ç»­è‰¯å¥½åœ°è¿ä½œã€‚&lt;/p&gt;
&lt;p&gt;åˆ° 2018 å¹´åº•ï¼Œæˆ‘çš„ä¸»è¦èŒä¸šå€¦æ€ é£é™©å·²ç»å¾—åˆ°è§£å†³ï¼Œæˆ‘åˆå¼€å§‹äº†åˆç†çš„å·¥ä½œæ—¶é—´ï¼Œå¹¶èŠ±äº†å¾ˆå¤šæ—¶é—´ä¸æˆ‘çš„å¦»å­å’Œå„¿å­åœ¨ä¸€èµ·ï¼Œæˆ‘çš„æ—¶é—´å¤§è‡´åœ¨ Envoy OSS å·¥ä½œå’Œ Lyft çš„ä¸€èˆ¬åŸºç¡€è®¾æ–½é¢†å¯¼ä¹‹é—´å„å ä¸€åŠã€‚æ˜ç¡®åœ°è¯´ï¼ŒEnvoy çš„æˆåŠŸå¸¦æ¥çš„ç‰¹æƒä½¿æˆ‘èƒ½å¤Ÿåœ¨ Lyft çš„å·¥ä½œç”Ÿæ´»ä¸­å–å¾—è¿™ç§å¹³è¡¡ã€‚éšç€æ—¶é—´çš„æ¨ç§»ï¼Œéšç€æˆ‘çš„è¡Œä¸šåœ°ä½çš„æé«˜ï¼Œæˆ‘çš„å½±å“åŠ›ä¹Ÿåœ¨åŒæ­¥å¢åŠ ï¼Œè¿™ä½¿å¾—æˆ‘æ›´å®¹æ˜“æŒ‰ç…§è‡ªå·±çš„æ„æ„¿è®¾å®šå°±ä¸šæ¡æ¬¾ã€‚æ²¡æœ‰å¤šå°‘äººæœ‰è¿™æ ·çš„è¿æ°”ï¼Œæˆ‘æ˜ç™½æˆ‘æ˜¯å¤šä¹ˆå¹¸è¿ï¼Œèƒ½å¤Ÿ â€œçªç ´ â€œå€¦æ€ å¢™çš„å¦ä¸€è¾¹è€Œä¸å¿…ç¦»å¼€æˆ‘çš„å·¥ä½œã€‚&lt;/p&gt;
&lt;h3 id=&#34;envoy-é•¿å¤§äº†&#34;&gt;Envoy é•¿å¤§äº†&lt;/h3&gt;
&lt;p&gt;è‡ª 2019 å¹´ä»¥æ¥ï¼Œå› ä¸ºæ–°å† ç–«æƒ…ï¼Œæˆ‘åœ¨ Lyft çš„åŸºç¡€è®¾æ–½é¢†å¯¼å’Œ OSS é¢†å¯¼ä¹‹é—´ç»§ç»­ä¿æŒç€æˆ‘ä¸Šé¢æè¿°çš„äº”äº”å¼€çš„æ¯”ä¾‹ã€‚å½“ç„¶ä¹Ÿæœ‰å•è°ƒå’Œæ¸´æœ›ä¸åŒçš„æ—¶å€™ï¼ˆä»å†å²ä¸Šçœ‹ï¼Œæˆ‘æ˜¯ä¸€ä¸ªä¹ æƒ¯æ€§æ¢å·¥ä½œçš„äººï¼Œ6.5 å¹´æ˜¯è¿„ä»Šä¸ºæ­¢æˆ‘åœ¨ä¸€ä»¶äº‹æƒ…ä¸Šå·¥ä½œçš„æœ€é•¿æ—¶é—´ï¼‰ï¼Œä½†æ€»çš„æ¥è¯´ï¼Œæˆ‘å¾ˆé«˜å…´çœ‹åˆ° Envoy ä»ä¸€ä¸ª â€œæ–°ç§€ &amp;quot; å˜æˆæ›´å¤šçš„ â€œå°‘å¹´â€ã€‚æˆ‘ä¸å†ä¸“æ³¨äºåšæˆ‘æ‰€èƒ½æƒ³åˆ°çš„ä¸€åˆ‡ï¼Œä½¿ Envoy è·å¾—å·¨å¤§çš„æˆåŠŸï¼Œå› ä¸ºå¦ç‡åœ°è¯´ï¼ŒEnvoy æ˜¯ä¸€ä¸ªå·¨å¤§çš„æˆåŠŸï¼Œå·²ç»å¸­å·äº†å¸‚åœºï¼Œå¹¶æ”¹å˜äº†ç”¨æˆ·å¯¹åº”ç”¨è´Ÿè½½å‡è¡¡å·¥å…·çš„æœŸæœ›ã€‚ç›¸åï¼Œæˆ‘æ›´å…³æ³¨é¡¹ç›®çš„å¯æŒç»­æ€§ã€‚æˆ‘ä»¬æ˜¯åœ¨åšé•¿æœŸçš„å·¥ä½œï¼Œè¿™äº›å¤©æˆ‘è§‰å¾—è‡ªå·±æ›´åƒä¸€ä¸ª CEOï¼Œçœ‹å‡å‘˜äººæ•°ã€ä¼˜å…ˆçº§ã€é¢„ç®—ç¼–åˆ¶ã€å®‰å…¨é—®é¢˜ç­‰ç­‰ã€‚è¿™å¹¶ä¸æ˜¯è¯´è¿™ä¸æ˜¯æœ‰ç”¨çš„å·¥ä½œï¼›å®ƒæ˜¾ç„¶æ˜¯æœ‰ç”¨çš„ï¼Œå®ƒåªæ˜¯ä¸æ—©æœŸçš„å·¥ä½œä¸åŒï¼Œæ—©æœŸçš„å·¥ä½œæŠ€æœ¯æ€§æ›´å¼ºï¼ŒèŠ‚å¥æ›´å¿«ã€‚&lt;/p&gt;
&lt;p&gt;æˆªæ­¢åˆ° 2021 å¹´æœ«ï¼Œæˆ‘å¯¹ Envoy æœ€å¼•ä»¥ä¸ºè±ªçš„äº‹æƒ…æ˜¯ï¼Œåœ¨æˆ‘çœ‹æ¥ï¼Œè¿™ä¸ªç¤¾åŒºå·²ç»å¯ä»¥è‡ªæˆ‘ç»´æŒäº†ã€‚æˆ‘ä»¬æœ‰ä¸€ç¾¤ä»¤äººéš¾ä»¥ç½®ä¿¡çš„ç»´æŠ¤è€…ã€è´¡çŒ®è€…å’Œç”¨æˆ·ï¼Œä»–ä»¬å¯¹é¡¹ç›®çš„æˆåŠŸå……æ»¡çƒ­æƒ…ï¼Œå¹¶åœ¨ä½¿ Envoy æˆä¸ºä»Šå¤©çš„æ ·å­ä¸­å‘æŒ¥äº†ä½œç”¨ã€‚è¿™ç¡®å®æ˜¯ä¸€ä¸ªå›¢é˜Ÿçš„åŠªåŠ›ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç»éªŒæ•™è®­&#34;&gt;ç»éªŒæ•™è®­&lt;/h2&gt;
&lt;p&gt;è¿‡å»çš„ 5 å¹´æ˜¯ä¸€ä¸ªå²è¯—èˆ¬çš„æ—…ç¨‹ã€‚è™½ç„¶æˆ‘è§‰å¾—æˆ‘åœ¨æŠ€æœ¯ä¸Šå­¦åˆ°çš„ä¸œè¥¿ç›¸å¯¹è¾ƒå°‘ï¼Œä½†æˆ‘åœ¨é¢†å¯¼åŠ›ã€ç¤¾åŒºå»ºè®¾å’Œæ‰€æœ‰å…¶ä»–éæŠ€æœ¯æ€§çš„ä¸œè¥¿æ–¹é¢éƒ½å¾—åˆ°äº†æˆé•¿å’Œå­¦ä¹ ï¼Œè¿™äº›éƒ½æ˜¯å»ºç«‹ä¸€ä¸ªæˆåŠŸçš„ä¼ä¸šï¼Œæ— è®ºæ˜¯ä¼ä¸šè¿˜æ˜¯ä¸€ä¸ªä¸»è¦çš„å¼€æºæˆåŠŸæ•…äº‹ã€‚ä»¥ä¸‹æ˜¯æˆ‘å¯¹ä¸€äº›ä¸»è¦å­¦ä¹ å†…å®¹çš„ç®€çŸ­æ€»ç»“ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æˆåŠŸçš„å¼€æºè½¯ä»¶å°±åƒåˆ›åŠä¸€ä¸ªä¼ä¸š&#34;&gt;æˆåŠŸçš„å¼€æºè½¯ä»¶å°±åƒåˆ›åŠä¸€ä¸ªä¼ä¸š&lt;/h3&gt;
&lt;p&gt;ä¹Ÿè®¸æœ‰äº‰è®®çš„æ˜¯ï¼Œ&lt;strong&gt;æˆ‘è®¤ä¸ºå¦‚æœä¸€ä¸ªäººæœ‰ç›®æ ‡è¦åˆ›å»ºä¸€ä¸ªéå¸¸æˆåŠŸçš„å¼€æºè½¯ä»¶é¡¹ç›®ï¼Œä»–ä»¬éœ€è¦æŠŠå®ƒæƒ³æˆä¸€ä¸ªä¼ä¸š&lt;/strong&gt;ã€‚é™¤äº†æ ¸å¿ƒæŠ€æœ¯ä¹‹å¤–ï¼Œåˆ›ä¸šè¿˜æ¶‰åŠå¾ˆå¤šå› ç´ ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ‹›è˜ï¼ˆåœ¨å¼€æºè½¯ä»¶ä¸­ï¼Œè¿™æ„å‘³ç€æ‹›è˜è´¡çŒ®è€…å’Œç»´æŠ¤è€…ï¼‰&lt;/li&gt;
&lt;li&gt;è·å–å®¢æˆ·ï¼ˆåœ¨å¼€æºè½¯ä»¶ä¸­ï¼Œè¿™è¢«è½¬åŒ–ä¸ºç”¨æˆ·ï¼‰&lt;/li&gt;
&lt;li&gt;æ–‡æ¡£å’ŒæŠ€æœ¯å†™ä½œ&lt;/li&gt;
&lt;li&gt;å…¬å…±å…³ç³»&lt;/li&gt;
&lt;li&gt;å¸‚åœºè¥é”€&lt;/li&gt;
&lt;li&gt;æ³•å¾‹ï¼ˆå•†æ ‡ã€è®¸å¯ç­‰ï¼‰&lt;/li&gt;
&lt;li&gt;äººåŠ›èµ„æºï¼ˆåœ¨å¼€æºè½¯ä»¶ä¸­ï¼Œè¿™å°†è½¬åŒ–ä¸ºè§£å†³ç¤¾åŒºçº çº·å’Œåˆ¶å®šæ–‡åŒ–ï¼‰&lt;/li&gt;
&lt;li&gt;èµ„é‡‘ï¼ˆåœ¨å¼€æºè½¯ä»¶ä¸­ï¼Œè¿™è½¬åŒ–ä¸ºè¾…åŠ©è´¹ç”¨ï¼Œå¦‚ CIã€ä¸ºç»´æŠ¤è€…æ‰¾åˆ°å…è®¸ä»–ä»¬åœ¨é¡¹ç›®ä¸­éƒ¨åˆ†æˆ–å…¨éƒ¨æ—¶é—´å·¥ä½œçš„å·¥ä½œï¼Œç­‰ç­‰ï¼‰&lt;/li&gt;
&lt;li&gt;æ€»çš„è¯´æ¥ï¼Œå°±æ˜¯é¢†å¯¼å’Œæ–¹å‘çš„ç¡®å®šã€‚èµ„æºæœ‰é™ï¼Œæœ‰å¾ˆå¤šäº‹æƒ…å¯ä»¥åšã€‚ä¼ä¸š / é¡¹ç›®éœ€è¦ä¸“æ³¨äºæœ€é‡è¦çš„äº‹æƒ…ï¼Œä»¥å®ç°äº§å“çš„å¸‚åœºé€‚åº”æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç›´è§‚åœ°è¯´ï¼Œæˆ‘çŸ¥é“è¿™ä¸€ç‚¹ï¼Œåœ¨æœ€åˆä¸º Envoy è¿›è¡Œå¼€æºåŠªåŠ›æ—¶ï¼Œæˆ‘ç§¯æåœ°è¿½æ±‚ä¸Šè¿°æ‰€æœ‰çš„é¢†åŸŸï¼ŒåŠªåŠ›ä½¿é¡¹ç›®ä»å¼€å§‹å‘å±•åˆ°ä»Šå¤©çš„è§„æ¨¡ã€‚ä¸Šè¿°åˆ—è¡¨ä¸­çš„æ¯ä¸€é¡¹éƒ½å¾ˆå…³é”®ï¼Œå¦‚æœæ²¡æœ‰æ‰€æœ‰è¿™äº›ï¼Œä¸€ä¸ªé¡¹ç›®æ˜¯ä¸å¯èƒ½æˆåŠŸçš„ï¼Œå°¤å…¶æ˜¯åœ¨æŠ€æœ¯é¢†åŸŸæœ‰å¾ˆå¤šèµ„é‡‘é›„åšçš„å…¬å¸ç«äº‰å¯¹æ‰‹çš„æƒ…å†µä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘å¼ºçƒˆé¼“åŠ±é‚£äº›è€ƒè™‘è¿›è¡Œå¤§è§„æ¨¡å¼€æºå·¥ä½œçš„äººæå‰åœ¨ä¸Šè¿°é¢†åŸŸè¿›è¡ŒæŠ•èµ„ï¼Œä»¥ä¾¿åœ¨ç¬¬ä¸€å¤©å°±ç»™äººç•™ä¸‹æœ€ä½³å°è±¡ã€‚æ­¤å¤–ï¼Œæ–°çš„å¼€æºé¡¹ç›®åº”è¯¥å‡†å¤‡åœ¨é¡¹ç›®æˆé•¿å¹¶å¼€å§‹çœ‹åˆ°é‡‡ç”¨æ—¶ï¼Œåœ¨ä¸Šè¿°é¢†åŸŸè¿›è¡Œæ›´å¤šçš„æŠ•èµ„ã€‚&lt;/p&gt;
&lt;p&gt;æ¯«ä¸å¥‡æ€ªï¼Œè¿™äº›å¤©æˆ‘åœ¨ Envoy ä¸Šåšçš„ç¼–ç å·¥ä½œç›¸å¯¹è¾ƒå°‘ã€‚æˆ‘åœ¨é¡¹ç›®ä¸Šçš„æ—¶é—´ä¸»è¦æ˜¯ç®¡ç†é¡¹ç›®çš„æ‰€æœ‰éæŠ€æœ¯æ–¹é¢ï¼ˆä¸Šè¿°åˆ—è¡¨ä¸­çš„æ‰€æœ‰å†…å®¹ï¼Œç”šè‡³æ›´å¤šï¼ï¼‰ï¼Œå¹¶ç¡®ä¿äº‹æƒ…æŒ‰è®¡åˆ’è¿›è¡Œã€‚æˆ‘æ‰€åšçš„å¤§å¤šæ•°ç¼–ç é¡¹ç›®éƒ½æ˜¯ â€œæ¸…æ´ &amp;quot; çš„å¹•åé¡¹ç›®ï¼Œå¯¹é¡¹ç›®æœ‰å¥½å¤„ï¼Œä½†æ²¡æœ‰ä»€ä¹ˆä¹è¶£ï¼Œä¹Ÿä¸å¯èƒ½æ¿€åŠ±å…¶ä»–è´¡çŒ®è€…ï¼ˆå½“ç„¶ï¼Œæˆ‘å¯¹ä»–ä»¬æ¯å¤©çš„å·¥ä½œæ²¡æœ‰å‘è¨€æƒï¼Œæˆ‘æœ‰åŠ¨åŠ›è®©ä»–ä»¬å°½å¯èƒ½çš„å¼€å¿ƒï¼Œè¿™æ ·ä»–ä»¬å°±ä¸ä¼šç¦»å¼€ï¼‰ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ç»ˆç«¯ç”¨æˆ·é©±åŠ¨çš„å¼€æºè½¯ä»¶æ˜¯ä¸€ç§ç»“æ„æ€§ä¼˜åŠ¿&#34;&gt;ç»ˆç«¯ç”¨æˆ·é©±åŠ¨çš„å¼€æºè½¯ä»¶æ˜¯ä¸€ç§ç»“æ„æ€§ä¼˜åŠ¿&lt;/h3&gt;
&lt;p&gt;è¿™äº›å¤©æ¥ï¼Œå¾ˆå¤š â€œå¤§çš„å¼€æºè½¯ä»¶â€ï¼Œç‰¹åˆ«æ˜¯åœ¨åŸºç¡€è®¾æ–½é¢†åŸŸï¼Œæ˜¯ç”±å¤§å…¬å¸å’Œé£é™©æŠ•èµ„æ”¯æŒçš„åˆåˆ›å…¬å¸èµ„åŠ©çš„ã€‚æˆ‘ä¸ä¼šç»•åˆ°å…³äºå¼€æºè½¯ä»¶çš„å›°éš¾ç»æµçš„è®¨è®ºï¼Œå› ä¸ºæˆ‘&lt;a href=&#34;https://medium.com/@mattklein123/the-broken-economics-of-oss-5a1b31fc0182&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å·²ç»å†™è¿‡äº†&lt;/a&gt;ã€‚æˆ‘æƒ³è¯´çš„æ˜¯ï¼Œ&lt;strong&gt;æˆ‘åšä¿¡ç»ˆç«¯ç”¨æˆ·çš„å¼€æºè½¯ä»¶æ¯”ä¼ä¸šå’Œé£é™©æŠ•èµ„æ”¯æŒçš„å¼€æºè½¯ä»¶æœ‰å¾ˆå¤§çš„ä¼˜åŠ¿&lt;/strong&gt;ï¼šæœ€åˆçš„å®¢æˆ·å‡ ä¹è‚¯å®šä¼šä»è½¯ä»¶ä¸­è·å¾—ä»·å€¼ï¼Œå¦åˆ™è½¯ä»¶å°±ä¸ä¼šå¾—åˆ°èµ„åŠ©ã€‚è¿™ç§ä¸å®¢æˆ·ä¸€èµ·å»ºç«‹ä¸œè¥¿çš„è‰¯æ€§å¾ªç¯æ˜¯éå¸¸å¼ºå¤§çš„ã€‚å®ƒå‡ ä¹æ™®éå¯¼è‡´äº†æ›´å¥½çš„ç»“æœï¼šè½¯ä»¶æ›´å¯é ã€æ›´ä¸“æ³¨ã€åŠŸèƒ½æ›´å°‘ã€‚æœ‰å¾ˆå¤šç”±æœ€ç»ˆç”¨æˆ·é©±åŠ¨çš„å¼€æºè½¯ä»¶çš„ä¾‹å­ï¼Œç„¶åå–å¾—äº†å·¨å¤§çš„å•†ä¸šæˆåŠŸã€‚é‰´äºåšå®çš„åŸºç¡€å’Œå†…åœ¨çš„äº§å“å¸‚åœºé€‚åº”æ€§ï¼Œè¿™å¯¹æˆ‘æ¥è¯´å¹¶ä¸å¥‡æ€ªã€‚æˆ‘å¸Œæœ›çœ‹åˆ°æ¯”ä»Šå¤©æ›´å¤šçš„æœ€ç»ˆç”¨æˆ·é©±åŠ¨çš„å¼€æºè½¯ä»¶ï¼Œå°½ç®¡æˆ‘è®¤è¯†åˆ°ç»æµä¸Šæ˜¯å›°éš¾çš„ã€‚å¯¹äºé‚£äº›æœ‰æœºä¼šçš„äººæ¥è¯´ï¼Œè¯·å‘è¿™ç§ç±»å‹çš„è½¯ä»¶æ‰€å…·æœ‰çš„ç»“æ„æ€§ä¼˜åŠ¿é æ‹¢ï¼&lt;/p&gt;
&lt;h3 id=&#34;ä¸è¦è·Ÿé£è¦è·Ÿéšå®¢æˆ·&#34;&gt;ä¸è¦è·Ÿé£ï¼Œè¦è·Ÿéšå®¢æˆ·&lt;/h3&gt;
&lt;p&gt;è¿™ä¹Ÿè®¸æ˜¯ &amp;ldquo;æˆåŠŸçš„å¼€æºè½¯ä»¶å°±åƒåˆ›ä¸š&amp;rdquo; å’Œ &amp;ldquo;æœ€ç»ˆç”¨æˆ·é©±åŠ¨çš„å¼€æºè½¯ä»¶æ˜¯ä¸€ç§ç»“æ„æ€§ä¼˜åŠ¿&amp;rdquo; çš„å¿…ç„¶ç»“æœï¼Œä½†æˆ‘æ— æ³•å¼ºè°ƒåšæŒä¸æ‡ˆåœ°å…³æ³¨å®¢æˆ·çš„å®é™…éœ€æ±‚è€Œä¸æ˜¯ç‚’ä½œå‘¨æœŸæ‰€è®¤ä¸ºçš„å®¢æˆ·éœ€æ±‚æ˜¯å¤šä¹ˆå…³é”®ã€‚ä¾‹å¦‚ï¼Œ&lt;strong&gt;å¤šå¹´æ¥ï¼Œäººä»¬ä¸€ç›´åœ¨å˜²ç¬‘ Envoy æ˜¯ç”¨ C++ ç¼–å†™çš„ï¼Œè¿™å¼•èµ·äº†æ— æ•°çš„ç¬‘è¯&lt;/strong&gt;ã€‚æˆ‘å–œæ¬¢ C++ å—ï¼Ÿä¸ï¼Œä¸æ˜¯å¾ˆå–œæ¬¢ã€‚å®ƒæ˜¯å¦åœ¨ 2015 å¹´å®Œæˆäº†å·¥ä½œï¼Œå¹¶å¸å¼•äº†æœ€åˆçš„ä¸€æ‰¹ä¸»è¦ç”¨æˆ·ï¼Ÿè‚¯å®šæ˜¯çš„ã€‚è¿™æ˜¯ä¸€ä¸ªå…³æ³¨å®¢æˆ·å’Œå¸‚åœºçš„ä¾‹å­ï¼Œè€Œä¸æ˜¯å±ˆæœäºæ²¡æœ‰å®é™… â€œå•†ä¸š &amp;quot; å½±å“çš„ç‚’ä½œã€‚å¦‚æœä¸€ä¸ªäººæŠŠå¼€æºè½¯ä»¶å½“åšä¸€ä¸ªä¼ä¸šï¼Œå°±ä¼šç«‹åˆ»æ˜ç™½ï¼Œ&lt;strong&gt;ä»¥å®¢æˆ·å’Œå¸‚åœºä¸ºä¸­å¿ƒæ˜¯å–å¾—å·¨å¤§æˆåŠŸçš„å”¯ä¸€é€”å¾„&lt;/strong&gt;ã€‚åœ¨ Envoyï¼Œæˆ‘èŠ±äº†å¤§é‡çš„æ—¶é—´ä¸ºç»ˆç«¯ç”¨æˆ·äº‰è®ºï¼Œä»¥ç¡®ä¿æˆ‘ä»¬å»ºç«‹çš„ä¸œè¥¿èƒ½è®©æ‰€æœ‰äººå—ç›Šï¼Œè€Œä¸ä»…ä»…æ˜¯ä¸€å°éƒ¨åˆ†å°ä¼—ç”¨æˆ·ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å¯æ‰©å±•æ€§æ˜¯è‡³å…³é‡è¦çš„&#34;&gt;å¯æ‰©å±•æ€§æ˜¯è‡³å…³é‡è¦çš„&lt;/h3&gt;
&lt;p&gt;è·Ÿç€å®¢æˆ·èµ°å¾€å¾€ä¼šå¯¼è‡´å®¢æˆ·çš„è¦æ±‚ä¸èƒ½å¾ˆå¥½åœ°èå…¥é¡¹ç›®çš„æ¶æ„ä¸­ã€‚ä»å¼€æºè½¯ä»¶çš„è§’åº¦æ¥çœ‹ï¼Œå¤±å»å¯¹é¡¹ç›®ä¸»è¦ç›®æ ‡çš„å…³æ³¨ä¼šå¯¼è‡´åŠŸèƒ½è”“å»¶ã€è½¯ä»¶æ— æ³•ç»´æŠ¤å’Œç»´æŠ¤äººå‘˜è´Ÿæ‹…è¿‡é‡ã€‚åŒæ—¶ï¼Œè¯´ â€œä¸ &amp;quot; ä¹Ÿæ˜¯å¤±å»æ½œåœ¨ç”¨æˆ·çš„ä¸€ä¸ªä¿è¯ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äº Envoyï¼Œæˆ‘æƒ³ç¡®ä¿æˆ‘ä»¬è‡³å°‘å¯ä»¥è¯´ â€œæ˜¯çš„ï¼Œä½†æ˜¯â€¦â€¦&amp;quot;ï¼Œå³æä¾›ä¸€ä¸ªå¼ºå¤§çš„å¯æ‰©å±•æ€§æ¨¡å‹ï¼Œè®©ç”¨æˆ·å¯ä»¥æ»¡è¶³ä»–ä»¬çš„éœ€æ±‚ï¼Œè€Œä¸éœ€è¦å°†æ¯ä¸€ä¸ªæ”¹åŠ¨å’ŒåŠŸèƒ½éƒ½æ¨åˆ°ä¸Šæ¸¸ã€‚è¿™ç§ç­–ç•¥å·²ç»å¤šæ¬¡å¾—åˆ°å›æŠ¥ï¼Œå®ƒå‡è½»äº†ç»´æŠ¤è€…çš„è´Ÿæ‹…ï¼Œè®©ç”¨æˆ·èƒ½å¤Ÿè§£å†³ä»–ä»¬è‡ªå·±çš„é—®é¢˜ï¼Œæ›´é‡è¦çš„æ˜¯ï¼Œå°† Envoy æ¨å‘äº†æˆ‘åœ¨æœ€åˆè®¾è®¡è¯¥è½¯ä»¶æ—¶ä»æœªæƒ³è±¡è¿‡çš„ç”¨ä¾‹ã€‚&lt;/p&gt;
&lt;p&gt;å¯æ‰©å±•æ€§ï¼Œç‰¹åˆ«æ˜¯å¯¹äºå¼€æºè½¯ä»¶çš„æ„å»ºæ¨¡å—ï¼Œæ˜¯è‡³å…³é‡è¦çš„ã€‚&lt;/p&gt;
&lt;h3 id=&#34;è´¨é‡é—®é¢˜&#34;&gt;è´¨é‡é—®é¢˜&lt;/h3&gt;
&lt;p&gt;è·Ÿéšå®¢æˆ·çš„å¦ä¸€ä¸ªæ¨è®ºæ˜¯ï¼Œè´¨é‡ç¡®å®å¾ˆé‡è¦ã€‚ç”¨æˆ·å¸Œæœ›è½¯ä»¶æ˜“äºæ“ä½œï¼Œç›¸å¯¹æ¥è¯´æ²¡æœ‰é”™è¯¯ï¼Œå…³å¿ƒå®‰å…¨ï¼Œç­‰ç­‰ã€‚æ›¾å‡ ä½•æ—¶å¾ˆå¤šäººä¼šè§‰å¾—å› ä¸ºå¼€æºè½¯ä»¶æ˜¯ &amp;quot; å…è´¹çš„â€ï¼Œæ‰€ä»¥è´¨é‡å°±å¾—ä¸åˆ°ä¿è¯ã€‚è¿™åœ¨ç†è®ºä¸Šä¹Ÿè®¸æ˜¯æ­£ç¡®çš„ï¼Œä½†å®é™…ä¸Šï¼Œåœ¨ä¸€ä¸ªé¡¹ç›®å¯¹è½¯ä»¶è´¨é‡è®¤çœŸå¯¹å¾…ä¹‹å‰ï¼Œç”¨æˆ·ä¸ä¼šå¤§é‡åœ°èšé›†åœ¨ä¸€ä¸ªè½¯ä»¶ä¸Šã€‚å› ä¸ºè·å¾—ç”¨æˆ·æ˜¯ä¸€ä¸ªé£è½®ï¼Œå¯ä»¥è·å¾—æ›´å¤šçš„ç”¨æˆ·ï¼ˆç‰¹åˆ«æ˜¯å½“ä»æ—©æœŸé‡‡ç”¨è€…è½¬å‘æ™šæœŸé‡‡ç”¨è€…æ—¶ï¼‰ï¼Œæ‰€ä»¥ç¡®ä¿ä¸ºæ•´ä¸ªè½¯ä»¶è´¨é‡ç¼–åˆ—æ—¶é—´é¢„ç®—å°±æ›´åŠ å…³é”®äº†ã€‚&lt;/p&gt;
&lt;p&gt;å…³äº Envoyï¼Œæˆ‘ä¸€ç›´æœ‰ä¸€ä¸ª &amp;ldquo;é›¶ç¢°æ’&amp;rdquo; çš„ç†å¿µã€‚ä»»ä½•å´©æºƒéƒ½ä¼šè¢«è°ƒæŸ¥å’Œä¿®å¤ï¼Œæ— è®ºå¤šä¹ˆä¸é¢‘ç¹çš„é”™è¯¯ã€‚è¿™ç§å¯¹ç¨³å®šæ€§å’Œè´¨é‡çš„å…³æ³¨ä¸ä¼šè¢«å¿½è§†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ç¤¾åŒºæ˜¯æ‰©å¤§è§„æ¨¡çš„å”¯ä¸€é€”å¾„&#34;&gt;ç¤¾åŒºæ˜¯æ‰©å¤§è§„æ¨¡çš„å”¯ä¸€é€”å¾„&lt;/h3&gt;
&lt;p&gt;è¿™å¾ˆæ˜æ˜¾ï¼Œä½†æˆ‘è¿˜æ˜¯è¦è¯´ï¼šç¤¾åŒºæ˜¯æ‰©å±•å¼€æºè½¯ä»¶çš„å”¯ä¸€é€”å¾„ã€‚è¿™æ˜¯ä¸€ä¸ªç”±ç»´æŠ¤è€…ã€è´¡çŒ®è€…å’Œç”¨æˆ·ç»„æˆçš„ç¤¾åŒºã€‚æ­¤å¤–ï¼Œç¤¾åŒºçš„&lt;strong&gt;åŸºè°ƒ&lt;/strong&gt;åœ¨é¡¹ç›®å¼€å§‹æ—¶å°±å·²ç»ç¡®å®šï¼Œè€Œä¸”æéš¾æ”¹å˜ã€‚äººç±»å€¾å‘äºéµå¾ªè§„èŒƒã€‚ä¸€æ—¦è§„èŒƒè¢«ç¡®å®šä¸‹æ¥ï¼Œæ— è®ºè§„èŒƒæ˜¯ä»€ä¹ˆï¼Œä¸è¿™äº›è§„èŒƒä¸ä¸€è‡´çš„äººéƒ½ä¼šè¢«é¿å¼€ã€‚å› æ­¤ï¼Œ&lt;strong&gt;é¡¹ç›®æœ€åˆçš„å…¬å…±åŸºè°ƒå¯¹äºè®¾å®šå…¶é•¿æœŸçš„ç¤¾åŒºè½¨è¿¹æä¸ºå…³é”®&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å½“æˆ‘ä»¬æŠŠ Envoy åšæˆå¼€æºè½¯ä»¶æ—¶ï¼Œæˆ‘åœ¨ GitHub ä¸ŠæŠ•å…¥äº†å¤§é‡çš„ç²¾åŠ›ä¸äººä»¬ä¸€èµ·å·¥ä½œï¼Œä½¿ç”¨å»ºè®¾æ€§å’Œæ¬¢è¿æ€§çš„è¯­è¨€ã€‚æ€»çš„æ¥è¯´ï¼Œæˆ‘å°½æˆ‘æ‰€èƒ½è®© Envoy æˆä¸ºä¸€ä¸ªå—æ¬¢è¿çš„åœ°æ–¹ï¼Œè®©äººä»¬æ„¿æ„æ¥è´¡çŒ®è‡ªå·±çš„åŠ›é‡ï¼Œæ— è®ºæ˜¯ç»´æŠ¤ã€å¶å°”çš„è´¡çŒ®ï¼Œè¿˜æ˜¯ç”¨æˆ·å¸®åŠ©å…¶ä»–ç”¨æˆ·ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ Envoy æ‰€å–å¾—çš„æ‰€æœ‰ä¸åŒç±»å‹çš„æˆåŠŸä¸­ï¼Œåˆ°ç›®å‰ä¸ºæ­¢ï¼Œç»™æˆ‘å¸¦æ¥æœ€å¤šä¸ªäººæ»¡è¶³æ„Ÿçš„éƒ¨åˆ†æ˜¯ï¼Œæœ‰ç›¸å½“å¤šçš„äººå‘Šè¯‰æˆ‘ï¼Œä»–ä»¬å·²ç»å‘èª“ä¸å†ä½¿ç”¨å¼€æºè½¯ä»¶ï¼Œå°¤å…¶æ˜¯åŸºç¡€è®¾æ–½å¼€æºè½¯ä»¶ï¼Œå› ä¸ºä»–ä»¬è§‰å¾—å¤§å¤šæ•°é¡¹ç›®ä¸­çš„äººå¯¹å½¼æ­¤æ„Ÿè§‰éƒ½å¾ˆç³Ÿç³•ã€‚ç›¸åçš„ï¼Œä»–ä»¬å–œæ¬¢ä¸º Envoy åšè´¡çŒ®ï¼Œå› ä¸ºè¿™ä¸ªç¤¾åŒºæ˜¯å¦‚æ­¤çš„å°Šé‡å’Œæ¬¢è¿å½¼æ­¤ã€‚è¿™éœ€è¦å¤§é‡çš„åŠªåŠ›å’Œçºªå¾‹ï¼Œå°¤å…¶æ˜¯åœ¨é¡¹ç›®çš„æ—©æœŸï¼Œæ‰èƒ½è¾¾åˆ°è¿™æ ·çš„ç»“æœï¼Œè€Œè¿™å·²ç»å¾—åˆ°äº†ä¼—å¤šçš„å›æŠ¥ã€‚&lt;/p&gt;
&lt;p&gt;ä¸è¦ä½ä¼°ä»ä¸€å¼€å§‹å°±ç¡®å®šé¡¹ç›®çš„æ–‡åŒ–å’ŒåŸºè°ƒçš„å¤åˆæ•ˆåº”ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ··åˆå•†ä¸šå’Œå¼€æºè½¯ä»¶çš„åˆ©ç›Šæ˜¯éå¸¸å›°éš¾çš„&#34;&gt;æ··åˆå•†ä¸šå’Œå¼€æºè½¯ä»¶çš„åˆ©ç›Šæ˜¯éå¸¸å›°éš¾çš„&lt;/h3&gt;
&lt;p&gt;å·²ç»æœ‰å¾ˆå¤šå…³äºå¼€æºè½¯ä»¶çš„å›°éš¾ç»æµå­¦çš„æ–‡ç« ï¼ˆ&lt;a href=&#34;https://medium.com/@mattklein123/the-broken-economics-of-oss-5a1b31fc0182&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;åŒ…æ‹¬æˆ‘è‡ªå·±çš„æ–‡ç« &lt;/a&gt;ï¼Œæˆ‘åœ¨ä¸Šé¢æåˆ°çš„ï¼‰ã€‚æˆ‘åªæƒ³è¯´ï¼Œ&lt;strong&gt;è¯•å›¾å°†å•†ä¸šä¸Šçš„æˆåŠŸå’Œå¼€æ”¾æºç çš„æˆåŠŸç»“åˆèµ·æ¥æ˜¯éå¸¸å›°éš¾çš„ï¼Œä¸»è¦æ˜¯å› ä¸ºè¿™äº›æˆåŠŸå¾€å¾€æ˜¯ç›¸äº’çŸ›ç›¾çš„&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ç›¸ä¿¡ï¼ŒEnvoy é€šè¿‡å…¶å¼ºå¤§çš„ API å’Œå¯æ‰©å±•æ€§ç³»ç»Ÿç©¿é€äº†è¿™ä¸ªçŸ›ç›¾ã€‚ä»æœ¬è´¨ä¸Šè®²ï¼ŒEnvoy å·²ç»æˆä¸ºä¸€ä¸ªå·¥å…·ï¼Œç°åœ¨è¢«å¤§é‡çš„å‚ç›´äº§å“å’ŒæœåŠ¡æ‰€ä½¿ç”¨ã€‚è¿™å°±äº§ç”Ÿäº†ä¸€ä¸ªç¤¾åŒºï¼Œè¯¥ç¤¾åŒºå……æ»¡äº†é€‰æ‹©åœ¨ä¸€ä¸ªå…±åŒçš„åŸºåº•ä¸Šåˆä½œçš„å…¬å¸ï¼Œå³ä½¿æ˜¯é€šè¿‡åœ¨æ‰©å±• / API / æ§åˆ¶å¹³é¢ / UI/UX å±‚ä¸Šçš„åˆ›æ–°ï¼Œæ¨å‡ºç›¸äº’ç«äº‰çš„ä¸Šå±‚äº§å“ã€‚&lt;/p&gt;
&lt;p&gt;ä»»ä½•æˆåŠŸçš„å¼€æºé¡¹ç›®éƒ½ä¼šçœ‹åˆ°å¤§é‡çš„å•†ä¸š / æŠ•èµ„äººçš„å…´è¶£ã€‚å¦‚æœä¸€ä¸ªé¡¹ç›®çš„ç›®æ ‡æ˜¯ä¿æŒä¸€ä¸ªå……æ»¡æ´»åŠ›çš„ç¤¾åŒºï¼ŒåŒæ—¶åˆèƒ½å–å¾—å•†ä¸šä¸Šçš„æˆåŠŸï¼ˆæˆ‘è®¤ä¸ºè¿™å¯¹æ•´ä¸ªé¡¹ç›®çš„æˆåŠŸæ˜¯å¿…è¦çš„ï¼Œå› ä¸ºé’±å¿…é¡»æ¥è‡ªæŸå¤„ï¼‰ï¼Œ&lt;strong&gt;é‚£ä¹ˆé¢„å…ˆè€ƒè™‘å¦‚ä½•å°†æ ¸å¿ƒå±‚å’Œå•†ä¸šå±‚åˆ†å¼€æ˜¯æå…¶é‡è¦çš„&lt;/strong&gt;ã€‚è¿™æ ·åšçš„å®ç”¨æ€§å’Œç­–ç•¥ä¼šå› é¡¹ç›®å’ŒæŠ€æœ¯çš„ä¸åŒè€Œä¸åŒï¼Œä½†æˆ‘ç›¸ä¿¡ä¸“æ³¨äºå¼ºå¤§çš„ API / æ‰©å±•æ€§çš„åˆ†å‰²æ˜¯ä¸€ä¸ªå¯Œæœ‰æˆæ•ˆçš„ç­–ç•¥ã€‚&lt;/p&gt;
&lt;h3 id=&#34;åŸºé‡‘ä¼šæ˜¯å¾ˆæ£˜æ‰‹çš„&#34;&gt;åŸºé‡‘ä¼šæ˜¯å¾ˆæ£˜æ‰‹çš„&lt;/h3&gt;
&lt;p&gt;åœ¨ç°ä»£çš„å¼€æºè®¨è®ºä¸­ï¼Œæœ‰å¾ˆå¤šå…³äºåŸºé‡‘ä¼šçš„ä½œç”¨çš„è®¨è®ºã€‚æˆ‘ä¸æ‰“ç®—å¯¹è¿™ä¸€è¯é¢˜åšå¤§é‡çš„è¯„è®ºï¼Œ&lt;strong&gt;ä½†æˆ‘çš„ä¸»è¦å»ºè®®æ˜¯ä¸è¦è¢«åŸºé‡‘ä¼šå’Œå®ƒä»¬å¯èƒ½æä¾›çš„ç†è®ºåˆ©ç›Šæ‰€å¹²æ‰°&lt;/strong&gt;ã€‚ç›¸åï¼Œè¦ç§¯æåœ°å…³æ³¨äº§å“çš„å¸‚åœºé€‚åº”æ€§ï¼Œç”Ÿäº§é«˜è´¨é‡çš„è½¯ä»¶ï¼Œå¹¶ä¸ºç”¨æˆ·æä¾›ä»·å€¼ã€‚å¦‚æœè¿™äº›äº‹æƒ…å¾—ä»¥å®ç°ï¼Œå…¶ä½™çš„äº‹æƒ…å°±ä¼šè‡ªç„¶è€Œç„¶åœ°å‘ç”Ÿã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºéå¸¸æˆåŠŸçš„é¡¹ç›®æ¥è¯´ï¼ŒåŸºé‡‘ä¼šï¼Œæ›´ç¡®åˆ‡åœ°è¯´ï¼Œä¸­ç«‹çš„å•†æ ‡æŒæœ‰åœ°ï¼Œæ˜¯éå¸¸æœ‰ç”¨çš„ï¼Œæ‰€ä»¥æˆ‘è‚¯å®šä¼šåœ¨é‚£ä¸ªæ—¶å€™è€ƒè™‘åŠ å…¥ä¸€ä¸ªã€‚éšç€é¡¹ç›®çš„æˆç†Ÿï¼ŒEnvoy ä»æˆä¸º CNCF çš„ä¸€éƒ¨åˆ†æ‰€è·å¾—çš„ä»·å€¼ä¹Ÿåœ¨ä¸æ–­å¢åŠ ã€‚CNCF é›‡ä½£äº†å¼€æºè½¯ä»¶å¾‹å¸ˆã€è¥é”€äººå‘˜ã€å…¬å…±å…³ç³»äººå‘˜ã€ä¸€æµçš„æ´»åŠ¨äººå‘˜ç­‰ç­‰ã€‚è¿™äº›é¢å¤–çš„èµ„æºåœ¨ â€œç»è¥ä¸šåŠ¡ &amp;quot; æ–¹é¢æ˜¯éå¸¸å®è´µçš„ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æå‰è€ƒè™‘æ²»ç†é—®é¢˜&#34;&gt;æå‰è€ƒè™‘æ²»ç†é—®é¢˜&lt;/h3&gt;
&lt;p&gt;















&lt;figure  id=&#34;figure-matt-klein-å‘è¡¨çš„æ¨ç‰¹&#34;&gt;
  &lt;div class=&#34;d-flex justify-content-center&#34;&gt;
    &lt;div class=&#34;w-100&#34; &gt;&lt;img alt=&#34;Matt Klein å‘è¡¨çš„æ¨ç‰¹&#34; srcset=&#34;
               /blog/envoy-oss-5-year/008i3skNly1guh3vqvywcj60tw0h8go702_hu4d88e40b73c416c2f95bedcdcee50bad_54509_b15353fb9aab64b88fb9cdd25b030a34.webp 400w,
               /blog/envoy-oss-5-year/008i3skNly1guh3vqvywcj60tw0h8go702_hu4d88e40b73c416c2f95bedcdcee50bad_54509_61a404a79d75a2f19958db49222ebc41.webp 760w,
               /blog/envoy-oss-5-year/008i3skNly1guh3vqvywcj60tw0h8go702_hu4d88e40b73c416c2f95bedcdcee50bad_54509_1200x1200_fit_q75_h2_lanczos.webp 1200w&#34;
               src=&#34;https://lib.jimmysong.io/blog/envoy-oss-5-year/008i3skNly1guh3vqvywcj60tw0h8go702_hu4d88e40b73c416c2f95bedcdcee50bad_54509_b15353fb9aab64b88fb9cdd25b030a34.webp&#34;
               width=&#34;760&#34;
               height=&#34;438&#34;
               loading=&#34;lazy&#34; data-zoomable /&gt;&lt;/div&gt;
  &lt;/div&gt;&lt;figcaption&gt;
      Matt Klein å‘è¡¨çš„æ¨ç‰¹
    &lt;/figcaption&gt;&lt;/figure&gt;
&lt;/p&gt;
&lt;p&gt;å¼€æºæ²»ç†æ˜¯&lt;strong&gt;éå¸¸&lt;/strong&gt;å›°éš¾çš„ã€‚å°±å…¶æœ¬è´¨è€Œè¨€ï¼Œå¼€æ”¾æºä»£ç æ˜¯æ— æ”¿åºœçš„ï¼Œæ²¡æœ‰æ˜ç¡®çš„é¢†å¯¼ç»“æ„ã€‚æ²¡æœ‰ä¸€ä¸ªé€‚åˆæ‰€æœ‰é¡¹ç›®çš„æ²»ç†æ–¹æ³•ï¼Œæ¯ä¸ªé¡¹ç›®éƒ½å¿…é¡»æ‰¾åˆ°è‡ªå·±çš„å‰è¿›æ–¹å‘ï¼Œå¯ä»¥é€šè¿‡ â€œBDFLâ€/CEO ç±»å‹çš„æ¨¡å¼ã€æŒ‡å¯¼å§”å‘˜ä¼šã€ç±»ä¼¼ Apache PMC çš„ç¨‹åºç­‰ã€‚æ‰€æœ‰çš„æ²»ç†æ¨¡å¼éƒ½æœ‰ä¼˜ç‚¹å’Œç¼ºç‚¹ï¼Œå¹¶ä¸”æœ‰ä¸åŒçš„å¤±è´¥æ¨¡å¼ã€‚&lt;/p&gt;
&lt;p&gt;æœ€é‡è¦çš„æ˜¯ï¼Œåœ¨é¡¹ç›®å˜å¾—åºå¤§å’ŒæˆåŠŸä¹‹å‰ï¼Œå…ˆè®¤çœŸæ€è€ƒæ²»ç†é—®é¢˜ã€‚å†™ä¸‹ä¸€å¥—è§„åˆ™å’Œè§„èŒƒï¼Œç‰¹åˆ«æ˜¯èŠ±æ—¶é—´è®°å½•é¡¹ç›®çš„å†²çªè§£å†³è¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;åŒæ—¶ä¹Ÿè¦æ„è¯†åˆ°ï¼Œæ ¹æ®æˆ‘åœ¨ä¸Šé¢å…³äºç¤¾åŒºè§„èŒƒå¦‚ä½•åœ¨æ—©æœŸè®¾å®šçš„è¯„è®ºï¼Œæ—©æœŸçš„é¡¹ç›®ç»´æŠ¤è€…å°†å¯¹æ•´ä¸ªå¯¹è¯å’Œå†²çªè§£å†³çš„é£æ ¼äº§ç”Ÿå·¨å¤§çš„å½±å“ï¼Œå°±åƒå…¬å¸çš„æ—©æœŸå‘˜å·¥å¯¹å…¬å¸çš„æ–‡åŒ–äº§ç”Ÿå·¨å¤§çš„å½±å“ä¸€æ ·ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æˆ‘çš„å°è±¡ä¸­ï¼Œæˆ‘ä»¬åœ¨ Envoy å†…éƒ¨éå¸¸å¹¸è¿ï¼Œæ²¡æœ‰å‘ç”Ÿè¿‡ä»»ä½•é‡å¤§åˆ†æ­§ï¼Œå‡ºç°çš„é—®é¢˜ä¹Ÿå¯ä»¥è¿…é€Ÿå‹å¥½åœ°è§£å†³ã€‚åœ¨é¡¹ç›®çš„å†å²ä¸Šï¼Œæˆ‘ä»¬ä»æ¥æ²¡æœ‰éœ€è¦æ´å¼•&lt;a href=&#34;https://github.com/envoyproxy/envoy/blob/main/GOVERNANCE.md#conflict-resolution-and-voting&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç»´æŠ¤è€…æŠ•ç¥¨ç¨‹åºæ¥è§£å†³å†²çª&lt;/a&gt;ã€‚åœ¨æˆ‘çœ‹æ¥ï¼Œè¿™æ˜¯ä¸€ä¸ªå·¨å¤§çš„æˆå°±ï¼Œä¹Ÿæ˜¯å¯¹æ‰€æœ‰ç»´æŠ¤è€…çš„ç´ è´¨å’Œä¸“ä¸šæ€§çš„è¯æ˜ï¼Œå°¤å…¶æ˜¯è€ƒè™‘åˆ°è¯¥é¡¹ç›®å·²ç»å˜å¾—å¦‚æ­¤å—æ¬¢è¿ï¼Œä»¥åŠå›´ç»•å®ƒçš„æ‰€æœ‰å•†ä¸šåˆ©ç›Šã€‚&lt;/p&gt;
&lt;h3 id=&#34;å¯¹å¼€æºè´¡çŒ®çš„æœŸæœ›æ˜¯è‡³å…³é‡è¦çš„&#34;&gt;å¯¹å¼€æºè´¡çŒ®çš„æœŸæœ›æ˜¯è‡³å…³é‡è¦çš„&lt;/h3&gt;
&lt;p&gt;æˆ‘åœ¨ä¸Šé¢æåˆ°è¿‡è¿™ä¸ªé—®é¢˜ï¼Œä½†æˆ‘è‡ªå·±çš„èŒä¸šå€¦æ€ å¾ˆå¤§ç¨‹åº¦ä¸Šæ˜¯ç”±äºæˆ‘æ²¡æœ‰å¾ˆå¥½åœ°ä¸æˆ‘çš„é›‡ä¸»å°±æˆ‘éœ€è¦èŠ±å¤šå°‘æ—¶é—´æ¥ç®¡ç† Envoy çš„å¼€æºå¢é•¿è®¾å®šåˆç†çš„æœŸæœ›ã€‚æˆ‘ä¸ä¼šæ’’è°è¯´ï¼Œè¿›è¡Œè¿™æ ·çš„å¯¹è¯å°±èƒ½ç¥å¥‡åœ°ä½¿é›‡ä¸»ä¸ºæŸäººè…¾å‡ºå¤§é‡æ—¶é—´æ¥ä»äº‹å¼€æºå·¥ä½œï¼Œç‰¹åˆ«æ˜¯é‚£äº›å¯èƒ½ä¸ç›´æ¥é€‚ç”¨äºå…¶æ—¥å¸¸å·¥ä½œçš„é¡¹ç›®ã€‚è¯è™½å¦‚æ­¤ï¼Œæˆ‘ç¡®ä¿¡å¯¹æ‰€æœ‰å‚ä¸çš„äººæ¥è¯´ï¼Œå¯¹å¼€æºè¿‡ç¨‹æœ‰å…¬å¼€å’Œè¯šå®çš„æœŸæœ›æ˜¯éå¸¸é‡è¦çš„ã€‚ä»¥ä¸‹æ˜¯åœ¨å¼€æºé¡¹ç›®ä¹‹å‰æˆ–å¼€å§‹ä»¥å¼€æºèº«ä»½å·¥ä½œä¹‹å‰è¦é—®çš„åˆç†é—®é¢˜ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é›‡å‘˜åº”è¯¥é—®ä»–ä»¬çš„é›‡ä¸»ï¼Œä¸ºä»€ä¹ˆä»–ä»¬è¦å¼€æ”¾æºä»£ç ï¼Ÿ&lt;/li&gt;
&lt;li&gt;é›‡ä¸»åº”è¯¥é—®ä»–ä»¬çš„å‘˜å·¥ï¼Œä¸ºä»€ä¹ˆä»–ä»¬è¦å¼€æ”¾æºä»£ç ï¼Ÿ(è¿™ä¸ªé—®é¢˜çš„ç­”æ¡ˆå’Œå‰ä¸€ä¸ªé—®é¢˜çš„ç­”æ¡ˆä¸åŒæ˜¯å®Œå…¨åˆç†çš„ï¼Œä½†åº”è¯¥åœ¨å…¬å¼€åœºåˆè®¨è®º)ã€‚&lt;/li&gt;
&lt;li&gt;é›‡å‘˜åº”è¯¥é—®ä»–ä»¬çš„é›‡ä¸»ï¼Œå¦‚æœé¡¹ç›®æˆåŠŸäº†ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿè¯¥é¡¹ç›®å°†æœ‰å“ªäº›èµ„æºå¯ç”¨ï¼Ÿå‘˜å·¥å°†æœ‰å¤šå°‘æ—¶é—´å¯ä»¥åœ¨é€šç”¨çš„å¼€æºè½¯ä»¶é—®é¢˜ä¸Šå·¥ä½œï¼Œç›®çš„æ˜¯ç›´æ¥æ¨åŠ¨é¡¹ç›®çš„å‘å±•ï¼Ÿ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;é›‡ä¸»å’Œé›‡å‘˜ä¹‹é—´ä¸åŒ¹é…çš„æœŸæœ›æ˜¯æœªæ¥æ€¨æ¨å’Œå€¦æ€ çš„æ ¹æœ¬åŸå› ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&#34;ä»£ç†å®¹æ˜“api-éš¾&#34;&gt;ä»£ç†å®¹æ˜“ï¼ŒAPI éš¾&lt;/h3&gt;
&lt;p&gt;å¯¹ä¸€äº›äººæ¥è¯´ï¼ŒEnvoy æä¾›çš„åº•å±‚ç½‘ç»œä»£ç†æœºåˆ¶ä¼¼ä¹æ˜¯è¿™ä¸ªé¡¹ç›®çš„å¤æ‚éƒ¨åˆ†ã€‚äº‹å®è¯æ˜ï¼Œä¸ä¸º Envoy å‘å±•ä¸€ä¸ªç¨³å®šçš„ API ç”Ÿæ€ç³»ç»Ÿæ‰€åšçš„å·¥ä½œç›¸æ¯”ï¼Œä»£ç†éƒ¨åˆ†ï¼ˆåœ¨æˆ‘çœ‹æ¥ï¼‰ç›¸å¯¹ç®€å•ã€‚å¹³è¡¡äººç±»å’Œè®¡ç®—æœºæ¶ˆè´¹çš„ API äººä½“å·¥ç¨‹å­¦ï¼Œä¿æŒä¸åŒç‰ˆæœ¬çš„ç¨³å®šæ€§ï¼Œå‘å±• API ä»¥æ”¯æŒå…¶ä»–å®¢æˆ·ç«¯ï¼Œå¦‚ gRPCï¼ŒæŒ‡å®šåè®®è¯­ä¹‰ä»¥ä½¿ Envoy èƒ½å¤Ÿä¸æ•°ç™¾ï¼ˆå¯èƒ½æ˜¯æ•°åƒï¼‰ä¸ªä¸åŒçš„ç®¡ç†æœåŠ¡å™¨å¯¹è¯ï¼Œç­‰ç­‰ï¼Œéƒ½æ˜¯éå¸¸å¤æ‚çš„ã€‚æˆ‘ä¸ºå›¢é˜Ÿåœ¨è¿™ä¸€é¢†åŸŸå–å¾—çš„æˆå°±æ„Ÿåˆ°éª„å‚²ï¼ˆç‰¹åˆ«è¦æ„Ÿè°¢æ¨åŠ¨è¿™ä¸€å·¥ä½œçš„ Harveyï¼‰ï¼Œå³ä½¿åœ¨è¿™ä¸€è¿‡ç¨‹ä¸­å‡ºç°äº†ä¸€äº›é”™è¯¯ï¼ˆæ¯”å¦‚ä» API çš„ V2 ç‰ˆæœ¬å¼ºåˆ¶è¿ç§»åˆ° V3 ç‰ˆæœ¬ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä¸€ä¸ªè½¯ä»¶æä¾›äº†ä¸€ä¸ª APIï¼Œè€Œä¸”æ›´é‡è¦çš„æ˜¯å¸Œæœ›è¿™ä¸ª API æˆä¸ºå…¶ä»–ç³»ç»Ÿçš„å…³é”®ç»„ä»¶ï¼Œé‚£ä¹ˆä¸è¦ä½ä¼°æä¾›ä¸€ä¸ªç¨³å®šå’Œç¬¦åˆäººä½“å·¥ç¨‹å­¦çš„ API çš„æˆæœ¬å’Œå¤æ‚æ€§ã€‚åè¿‡æ¥è¯´ï¼Œ&lt;strong&gt;å¼ºå¤§çš„ API æ˜¯ä¸€ä¸ªç”Ÿæ€ç³»ç»Ÿé£è½®çš„é‡è¦ç»„æˆéƒ¨åˆ†&lt;/strong&gt;ï¼Œä¼šä»¥æ­¤äº§ç”Ÿæ›´å¤šçš„äº§å“å’Œç”¨æˆ·ï¼Œæ‰€ä»¥åœ¨æˆ‘çœ‹æ¥ï¼Œè¿™äº›åŠªåŠ›æ˜¯éå¸¸å€¼å¾—çš„ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä¸è¦å¿½è§†èŒä¸šå€¦æ€ &#34;&gt;ä¸è¦å¿½è§†èŒä¸šå€¦æ€ &lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;å¦‚æœä¸€ä¸ªäººæƒ³æˆå°±å¤§äº‹ä¸šï¼Œæˆ‘ä¸ç›¸ä¿¡ä»–å¯ä»¥ 100% å®ç°è‰¯å¥½çš„å·¥ä½œç”Ÿæ´»å¹³è¡¡&lt;/strong&gt;ã€‚ç°å®æƒ…å†µæ˜¯ï¼Œä»»ä½•æˆåŠŸéƒ½æ˜¯ç”±ç°æœ‰çš„ç‰¹æƒ / æœºä¼šã€ä¸€ä¸ªå¥½çš„æƒ³æ³•ã€è‰¯å¥½çš„æ‰§è¡ŒåŠ›å’Œå¤§é‡çš„è¿æ°”ï¼ˆåŒ…æ‹¬åœ¨æ­£ç¡®çš„æ—¶é—´å‡ºç°åœ¨æ­£ç¡®çš„åœ°ç‚¹ï¼‰ç»„æˆçš„ã€‚æ‰€æœ‰è¿™äº›ä¸œè¥¿éƒ½åœ¨ Envoy ä¸­å‘æŒ¥ä½œç”¨ï¼Œæˆ‘ä¸ä¼šå‡è£…æˆ‘æ²¡æœ‰æŠŠè‡ªå·±æå¾—å¾ˆç´¯ï¼Œç‰¹åˆ«æ˜¯åœ¨ 2017 å¹´ã€‚æˆ‘ä¹Ÿä¼šé‡æ–°åšä¸€é 2017 å¹´çš„å·¥ä½œï¼Œå› ä¸ºä»æˆ‘çš„è§’åº¦æ¥çœ‹ï¼Œæˆ‘åšäº†æˆ‘å¿…é¡»åšçš„äº‹æƒ…ï¼Œä½¿é¡¹ç›®è·å¾—æˆåŠŸã€‚(æœ‰æ—¶æˆ‘æƒ³ï¼Œå¦‚æœæˆ‘å·²ç»æœ‰äº†å­©å­ï¼ŒEnovy æ˜¯å¦è¿˜ä¼šè¯ç”Ÿã€‚æˆ‘ä¸ç¡®å®šå®ƒæ˜¯å¦ä¼šå‘ç”Ÿï¼Œä½†è¿™æ˜¯ä¸€ä¸ªæ›´é•¿çš„è°ˆè¯ä¸»é¢˜ï¼)&lt;/p&gt;
&lt;p&gt;ç»¼ä¸Šæ‰€è¿°ï¼Œæˆ‘åœ¨ 2017 å¹´æè¿°çš„é‚£ç§å²è¯—èˆ¬çš„æ¨åŠ¨åŠ›åªèƒ½æŒç»­è¿™ä¹ˆä¹…ï¼Œç›´åˆ°ä¸€ä¸ªäººå´©æºƒã€‚æˆ‘é¼“åŠ±å¤§å®¶ä¸æ–­åæ€è‡ªå·±çš„å·¥ä½œç”Ÿæ´»å¹³è¡¡ï¼Œå¹¶ä¸ºè‡ªå·±æ‰¾å‡ºä¸€æ¡å¯æŒç»­å‘å±•çš„é“è·¯ã€‚æ¯ä¸ªäººçš„æƒ…å†µéƒ½ä¸åŒï¼Œæˆ‘ä¸èƒ½æä¾›ä»»ä½•ä¸€ä¸ªé¿å…èŒä¸šå€¦æ€ çš„å»ºè®®ï¼Œä½†æˆ‘è®¤ä¸ºåæ€æ˜¯ä¸€ä¸ªå¥½çš„å¼€å§‹ï¼Œä¹Ÿæ˜¯æˆ‘è‡ªå·±ä¸å¾—ä¸åŠªåŠ›çš„äº‹æƒ…ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ„Ÿè°¢&#34;&gt;æ„Ÿè°¢&lt;/h2&gt;
&lt;p&gt;åœ¨è¿‡å» 6 å¹´åŠçš„æ—¶é—´é‡Œï¼Œåœ¨ Envoy ä¸Šå·¥ä½œï¼Œå…¶ä¸­ 5 å¹´æ˜¯ä½œä¸ºå¼€æºè½¯ä»¶ï¼Œè¿™æ˜¯æˆ‘èŒä¸šç”Ÿæ¶¯ä¸­çš„äº®ç‚¹ã€‚è¿™ä¸ªé¡¹ç›®çš„æˆåŠŸç¡®å®æ˜¯ä¸€ä¸ªå›¢é˜Ÿçš„åŠªåŠ›ï¼Œæˆ‘ä¸€ä¸ªäººæ˜¯ä¸å¯èƒ½å®Œæˆçš„ï¼Œæˆ‘ä¸ºæˆ‘ä»¬æ‰€æœ‰äººï¼ˆç»´æŠ¤è€…ã€è´¡çŒ®è€…å’Œç”¨æˆ·ï¼‰å…±åŒå®Œæˆçš„äº‹æƒ…æ„Ÿåˆ°éå¸¸è‡ªè±ªã€‚åœ¨è¿™ä¸ªé¡¹ç›®ä¸Šå·¥ä½œçš„ç»´æŠ¤è€…å’Œè´¡çŒ®è€…æ˜¯æˆ‘æ‰€å…±äº‹è¿‡çš„æœ€å¥½çš„å·¥ç¨‹å¸ˆç¾¤ä½“ï¼Œä»–ä»¬æ‰åæ¨ªæº¢ï¼Œä»–ä»¬å°±èŒåœ¨ä¸åŒå…¬å¸ï¼Œä½äºä¸åŒçš„åœ°ç†ä½ç½®ï¼Œè¿™çœŸæ˜¯å¼€æºçš„ç†è®ºæ½œåŠ›åœ¨å®è·µä¸­çš„ä½“ç°ã€‚ä½œä¸ºä¸€ä¸ªå›¢é˜Ÿï¼Œæˆ‘ä»¬å·²ç»äº§ç”Ÿäº†ä¸–ç•Œæ€§çš„å½±å“ï¼Œæ”¹å˜äº†ç”¨æˆ·å¯¹è½¯ä»¶è´Ÿè½½å‡è¡¡ç³»ç»Ÿçš„æœŸæœ›ï¼ŒåŒæ—¶ä¹Ÿå»ºç«‹äº†ä¸€ä¸ªå……æ»¡æ´»åŠ›å’Œçƒ­æƒ…çš„ç¤¾åŒºã€‚åœ¨æˆ‘æœ€ç–¯ç‹‚çš„æ¢¦æƒ³ä¸­ï¼Œæˆ‘ä»æœªæƒ³è¿‡è¿™ä¸ªé¡¹ç›®ä¼šæˆä¸ºä»Šå¤©çš„æ ·å­ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹æˆ‘æ¥è¯´ï¼Œæœªæ¥ä¼šå‘ç”Ÿä»€ä¹ˆå°±ä¸é‚£ä¹ˆæ¸…æ¥šäº†ã€‚æ­£å¦‚æˆ‘ä¸Šé¢æ‰€è¯´çš„ï¼Œæˆ‘çš„é‡ç‚¹å·²ç»è½¬ç§»åˆ°äº†å¯æŒç»­æ€§ä¸Šã€‚æˆ‘æƒ³ç¡®ä¿ï¼Œå¦‚æœæœ‰ä¸€å¤©æˆ‘ç¦»å¼€äº†ï¼Œè¿™ä¸ªé¡¹ç›®å°†ä¿æŒå¥åº·ã€‚å°½ç®¡å¦‚æ­¤ï¼Œè¿™ä¸€å¤©è¿˜æ²¡æœ‰åˆ°æ¥ï¼Œæˆ‘æœŸå¾…ç€åœ¨å¯é¢„è§çš„æœªæ¥å¸®åŠ©é¢†å¯¼é¡¹ç›®å‰è¿›ï¼Œå¸Œæœ›èƒ½å–å¾—æ›´å¤§çš„æˆåŠŸå’Œé‡‡ç”¨ã€‚å‘å‰è¿ˆè¿›ï¼&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Istio å®‰å…¨æœ€ä½³å®è·µ</title>
      <link>https://lib.jimmysong.io/blog/istio-security-best-practices/</link>
      <pubDate>Mon, 02 Aug 2021 13:05:42 +0800</pubDate>
      <guid>https://lib.jimmysong.io/blog/istio-security-best-practices/</guid>
      <description>&lt;h2 id=&#34;ç¼–è€…çš„è¯&#34;&gt;ç¼–è€…çš„è¯&lt;/h2&gt;
&lt;p&gt;æœ¬æ–‡è¯‘è‡ª Istio å®˜æ–¹åšå®¢ &lt;a href=&#34;https://istio.io/latest/docs/ops/best-practices/security/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Security Best Practices&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;Istio çš„å®‰å…¨åŠŸèƒ½æä¾›äº†å¼ºå¤§çš„èº«ä»½ã€ç­–ç•¥ã€é€æ˜çš„ TLS åŠ å¯†ä»¥åŠè®¤è¯ã€æˆæƒå’Œå®¡è®¡ï¼ˆAAAï¼‰å·¥å…·æ¥ä¿æŠ¤ä½ çš„æœåŠ¡å’Œæ•°æ®ã€‚ç„¶è€Œï¼Œä¸ºäº†å……åˆ†å®‰å…¨åœ°åˆ©ç”¨è¿™äº›åŠŸèƒ½ï¼Œå¿…é¡»æ³¨æ„éµå¾ªæœ€ä½³å®è·µã€‚å»ºè®®åœ¨ç»§ç»­é˜…è¯»ä¹‹å‰ï¼Œå…ˆå›é¡¾ä¸€ä¸‹&lt;a href=&#34;https://istio.io/latest/docs/concepts/security/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å®‰å…¨æ¦‚è¿°&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;åŒå‘-tls&#34;&gt;åŒå‘ TLS&lt;/h2&gt;
&lt;p&gt;Istio å°†å°½å¯èƒ½ä½¿ç”¨&lt;a href=&#34;https://istio.io/latest/docs/concepts/security/#mutual-tls-authentication&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;åŒå‘ TLS&lt;/a&gt; å¯¹æµé‡è¿›è¡Œ&lt;a href=&#34;https://istio.io/latest/docs/ops/configuration/traffic-management/tls-configuration/#auto-mtls&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è‡ªåŠ¨&lt;/a&gt;åŠ å¯†ã€‚ç„¶è€Œï¼Œä»£ç†åœ¨é»˜è®¤æƒ…å†µä¸‹è¢«é…ç½®ä¸º&lt;a href=&#34;https://istio.io/latest/docs/concepts/security/#permissive-mode&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è®¸å¯æ¨¡å¼ï¼ˆPermissive Modeï¼‰&lt;/a&gt;ï¼Œè¿™æ„å‘³ç€ä»–ä»¬å°†æ¥å—åŒå‘ TLS å’Œæ˜æ–‡æµé‡ã€‚&lt;/p&gt;
&lt;p&gt;è™½ç„¶è¿™æ˜¯ä¸ºäº†å¢é‡é‡‡ç”¨æˆ–å…è®¸æ¥è‡ªæ²¡æœ‰ Istio sidecar çš„å®¢æˆ·ç«¯çš„æµé‡çš„éœ€è¦ï¼Œä½†å®ƒä¹Ÿå‰Šå¼±äº†å®‰å…¨ç«‹åœºã€‚å»ºè®®åœ¨å¯èƒ½çš„æƒ…å†µä¸‹&lt;a href=&#34;https://istio.io/latest/docs/tasks/security/authentication/mtls-migration/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è¿ç§»åˆ°ä¸¥æ ¼æ¨¡å¼ï¼ˆStrict Modeï¼‰&lt;/a&gt;ï¼Œä»¥å¼ºåˆ¶ä½¿ç”¨åŒå‘ TLSã€‚&lt;/p&gt;
&lt;p&gt;ç„¶è€Œï¼Œä»…é åŒå‘ TLS å¹¶ä¸è¶³ä»¥ä¿è¯æµé‡çš„å®‰å…¨ï¼Œå› ä¸ºå®ƒåªæä¾›è®¤è¯ï¼Œè€Œä¸æ˜¯æˆæƒã€‚è¿™æ„å‘³ç€ï¼Œä»»ä½•æ‹¥æœ‰æœ‰æ•ˆè¯ä¹¦çš„äººä»ç„¶å¯ä»¥è®¿é—®ä¸€ä¸ªæœåŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†å®Œå…¨é”å®šæµé‡ï¼Œå»ºè®®é…ç½®&lt;a href=&#34;https://istio.io/latest/docs/tasks/security/authorization/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æˆæƒç­–ç•¥&lt;/a&gt;ã€‚è¿™å…è®¸åˆ›å»ºç»†ç²’åº¦çš„ç­–ç•¥æ¥å…è®¸æˆ–æ‹’ç»æµé‡ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥åªå…è®¸æ¥è‡ª &lt;code&gt;app&lt;/code&gt; å‘½åç©ºé—´çš„è¯·æ±‚è®¿é—® &lt;code&gt;hello-world&lt;/code&gt; æœåŠ¡ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æˆæƒç­–ç•¥&#34;&gt;æˆæƒç­–ç•¥&lt;/h2&gt;
&lt;p&gt;Istio &lt;a href=&#34;https://istio.io/latest/docs/concepts/security/#authorization&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æˆæƒ&lt;/a&gt;åœ¨ Istio å®‰å…¨ä¸­èµ·ç€å…³é”®ä½œç”¨ã€‚å®ƒéœ€è¦åŠªåŠ›é…ç½®æ­£ç¡®çš„æˆæƒç­–ç•¥ï¼Œä»¥æœ€å¥½åœ°ä¿æŠ¤ä½ çš„é›†ç¾¤ã€‚äº†è§£è¿™äº›é…ç½®çš„å½±å“æ˜¯å¾ˆé‡è¦çš„ï¼Œå› ä¸º Istio æ— æ³•ç¡®å®šæ‰€æœ‰ç”¨æˆ·çš„æ­£ç¡®æˆæƒã€‚è¯·å…¨ç¨‹å…³æ³¨æœ¬èŠ‚å†…å®¹ã€‚&lt;/p&gt;
&lt;h3 id=&#34;åº”ç”¨é»˜è®¤æ‹’ç»çš„æˆæƒç­–ç•¥&#34;&gt;åº”ç”¨é»˜è®¤æ‹’ç»çš„æˆæƒç­–ç•¥&lt;/h3&gt;
&lt;p&gt;æˆ‘ä»¬å»ºè®®ä½ æŒ‰ç…§ default-deny æ¨¡å¼å®šä¹‰ä½ çš„ Istio æˆæƒç­–ç•¥ï¼Œä»¥å¢å¼ºé›†ç¾¤çš„å®‰å…¨æ€åŠ¿ã€‚é»˜è®¤æ‹’ç»æˆæƒæ¨¡å¼æ„å‘³ç€ä½ çš„ç³»ç»Ÿé»˜è®¤æ‹’ç»æ‰€æœ‰è¯·æ±‚ï¼Œè€Œä½ å®šä¹‰äº†å…è®¸è¯·æ±‚çš„æ¡ä»¶ã€‚å¦‚æœä½ é”™è¿‡äº†ä¸€äº›æ¡ä»¶ï¼Œæµé‡å°†è¢«æ„å¤–åœ°æ‹’ç»ï¼Œè€Œä¸æ˜¯æµé‡è¢«æ„å¤–åœ°å…è®¸ã€‚åè€…é€šå¸¸æ˜¯ä¸€ä¸ªå®‰å…¨äº‹ä»¶ï¼Œè€Œå‰è€…å¯èƒ½ä¼šå¯¼è‡´ç³Ÿç³•çš„ç”¨æˆ·ä½“éªŒã€æœåŠ¡ä¸­æ–­æˆ–ä¸ç¬¦åˆä½ çš„ SLO/SLAã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œåœ¨ &lt;a href=&#34;https://istio.io/latest/docs/tasks/security/authorization/authz-http/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;HTTP æµé‡çš„æˆæƒä»»&lt;/a&gt;åŠ¡ä¸­ï¼Œåä¸º &lt;code&gt;allow-nothing&lt;/code&gt; çš„æˆæƒç­–ç•¥ç¡®ä¿æ‰€æœ‰æµé‡åœ¨é»˜è®¤æƒ…å†µä¸‹è¢«æ‹’ç»ã€‚ä»è¿™é‡Œå¼€å§‹ï¼Œå…¶ä»–æˆæƒç­–ç•¥æ ¹æ®ç‰¹å®šæ¡ä»¶å…è®¸æµé‡ã€‚&lt;/p&gt;
&lt;h3 id=&#34;åœ¨è·¯å¾„è§„èŒƒåŒ–ä¸Šå®šåˆ¶ä½ çš„ç³»ç»Ÿ&#34;&gt;åœ¨è·¯å¾„è§„èŒƒåŒ–ä¸Šå®šåˆ¶ä½ çš„ç³»ç»Ÿ&lt;/h3&gt;
&lt;p&gt;Istio æˆæƒç­–ç•¥å¯ä»¥åŸºäº HTTP è¯·æ±‚ä¸­çš„ URL è·¯å¾„ã€‚&lt;a href=&#34;https://en.wikipedia.org/wiki/URI_normalization&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è·¯å¾„è§„èŒƒåŒ–ï¼ˆåˆç§° URI è§„èŒƒåŒ–ï¼‰&lt;/a&gt;å¯¹ä¼ å…¥è¯·æ±‚çš„è·¯å¾„è¿›è¡Œä¿®æ”¹å’Œæ ‡å‡†åŒ–ï¼Œä»è€Œä½¿è§„èŒƒåŒ–åçš„è·¯å¾„èƒ½å¤Ÿä»¥æ ‡å‡†æ–¹å¼è¿›è¡Œå¤„ç†ã€‚è¯­æ³•ä¸Šä¸åŒçš„è·¯å¾„åœ¨è·¯å¾„è§„èŒƒåŒ–åå¯èƒ½æ˜¯ç­‰åŒçš„ã€‚&lt;/p&gt;
&lt;p&gt;Istio æ”¯æŒä»¥ä¸‹è¯·æ±‚è·¯å¾„çš„è§„èŒƒåŒ–æ–¹æ¡ˆï¼Œç„¶åå†æ ¹æ®æˆæƒç­–ç•¥è¿›è¡Œè¯„ä¼°å’Œè·¯ç”±è¯·æ±‚ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;é€‰é¡¹&lt;/th&gt;
&lt;th&gt;æè¿°&lt;/th&gt;
&lt;th&gt;ç¤ºä¾‹&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;NONE&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;ä¸åšä»»ä½•è§„èŒƒåŒ–å¤„ç†ã€‚Envoy æ”¶åˆ°çš„ä»»ä½•ä¿¡æ¯éƒ½ä¼šè¢«åŸå°ä¸åŠ¨åœ°è½¬å‘ç»™ä»»ä½•åç«¯æœåŠ¡ã€‚&lt;/td&gt;
&lt;td&gt;&lt;code&gt;../%2Fa../b&lt;/code&gt; ç”±æˆæƒæ”¿ç­–è¯„ä¼°å¹¶å‘é€ç»™ä½ çš„æœåŠ¡ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;BASE&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;è¿™æ˜¯ç›®å‰ Istio é»˜è®¤å®‰è£…ä¸­ä½¿ç”¨çš„é€‰é¡¹ã€‚è¿™åœ¨ Envoy ä»£ç†ä¸Šåº”ç”¨äº† &lt;a href=&#34;https://www.envoyproxy.io/docs/envoy/latest/api-v3/extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-normalize-path&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;code&gt;normalize_path&lt;/code&gt;&lt;/a&gt;é€‰é¡¹ï¼Œè¯¥é€‰é¡¹éµå¾ª &lt;a href=&#34;https://tools.ietf.org/html/rfc3986&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;RFC 3986&lt;/a&gt;ï¼Œæœ‰é¢å¤–çš„è§„èŒƒåŒ–å¤„ç†ï¼Œå°†åæ–œçº¿è½¬æ¢æˆæ­£æ–œçº¿ã€‚&lt;/td&gt;
&lt;td&gt;&lt;code&gt;/a/../b&lt;/code&gt; è¢«è§„èŒƒåŒ–ä¸º &lt;code&gt;/b&lt;/code&gt;ã€‚&lt;code&gt;\da&lt;/code&gt; è¢«è§„èŒƒåŒ–å¾® &lt;code&gt;/da&lt;/code&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;MERGE_SLASHES&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æ–œçº¿åœ¨ &lt;em&gt;BASE&lt;/em&gt; è§„èŒƒåŒ–ä¹‹åè¢«åˆå¹¶ã€‚&lt;/td&gt;
&lt;td&gt;&lt;code&gt;/a//b&lt;/code&gt; è¢«è§„èŒƒåŒ–ä¸º &lt;code&gt;/a/b&lt;/code&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;DECODE_AND_MERGE_SLASHES&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;æœ€ä¸¥æ ¼çš„è®¾ç½®ï¼Œå½“ä½ é»˜è®¤å…è®¸æ‰€æœ‰æµé‡ã€‚è¿™ä¸ªè®¾ç½®æ˜¯æ¨èçš„ï¼Œä½†è¦æ³¨æ„çš„æ˜¯ï¼Œä½ éœ€è¦å½»åº•æµ‹è¯•ä½ çš„æˆæƒç­–ç•¥è·¯å¾„ã€‚ç™¾åˆ†æ¯”ç¼–ç çš„æ–œçº¿å’Œåæ–œçº¿å­—ç¬¦ï¼ˆ&lt;code&gt;%2F&lt;/code&gt;ã€&lt;code&gt;%2f&lt;/code&gt;ã€&lt;code&gt;%5C&lt;/code&gt; å’Œ &lt;code&gt;%5c&lt;/code&gt;ï¼‰åœ¨ MERGE_SLASHES è¢«è§„èŒƒåŒ–ä¹‹å‰è¢«è§£ç ä¸º &lt;code&gt;/&lt;/code&gt; æˆ– &lt;code&gt;\&lt;/code&gt;ã€‚&lt;/td&gt;
&lt;td&gt;&lt;code&gt;/a%2fb&lt;/code&gt; è¢«è§„èŒƒåŒ–ä¸º &lt;code&gt;/a/b&lt;/code&gt;ã€‚&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;è¯¥é…ç½®æ˜¯é€šè¿‡ &lt;a href=&#34;https://istio.io/latest/docs/reference/config/istio.mesh.v1alpha1/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;mesh é…ç½®&lt;/a&gt;ä¸­çš„ &lt;a href=&#34;https://istio.io/latest/docs/reference/config/istio.mesh.v1alpha1/#MeshConfig-ProxyPathNormalization&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;code&gt;pathNormalization&lt;/code&gt;&lt;/a&gt;å­—æ®µæŒ‡å®šçš„ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†å¼ºè°ƒè¿™ä¸€ç‚¹ï¼Œè§„èŒƒåŒ–ç®—æ³•æ˜¯æŒ‰ç…§ä»¥ä¸‹é¡ºåºè¿›è¡Œçš„ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ç™¾åˆ†æ¯”è§£ç  &lt;code&gt;%2F&lt;/code&gt;ã€&lt;code&gt;%2f&lt;/code&gt;ã€&lt;code&gt;%5C&lt;/code&gt; å’Œ &lt;code&gt;%5c&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://tools.ietf.org/html/rfc3986&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;RFC 3986&lt;/a&gt; å’Œå…¶ä»–ç”± Envoy çš„ &lt;a href=&#34;https://www.envoyproxy.io/docs/envoy/latest/api-v3/extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-normalize-path&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;code&gt;normalize_path&lt;/code&gt;&lt;/a&gt;é€‰é¡¹å®ç°çš„è§„èŒƒåŒ–ã€‚&lt;/li&gt;
&lt;li&gt;åˆå¹¶æ–œçº¿&lt;/li&gt;
&lt;/ol&gt;
&lt;blockquote&gt;
&lt;p&gt;è™½ç„¶è¿™äº›è§„èŒƒåŒ–é€‰é¡¹ä»£è¡¨äº†æ¥è‡ª HTTP æ ‡å‡†å’Œå¸¸è§è¡Œä¸šæƒ¯ä¾‹çš„å»ºè®®ï¼Œä½†åº”ç”¨ç¨‹åºå¯ä»¥ä»¥å®ƒé€‰æ‹©çš„ä»»ä½•æ–¹å¼è§£é‡Šä¸€ä¸ª URLã€‚å½“ä½¿ç”¨æ‹’ç»ç­–ç•¥æ—¶ï¼Œè¯·ç¡®ä¿ä½ äº†è§£ä½ çš„åº”ç”¨ç¨‹åºçš„è¡Œä¸ºæ–¹å¼ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;é…ç½®çš„ä¾‹å­&#34;&gt;é…ç½®çš„ä¾‹å­&lt;/h3&gt;
&lt;p&gt;ç¡®ä¿ Envoy è§„èŒƒåŒ–è¯·æ±‚è·¯å¾„ä»¥ç¬¦åˆä½ çš„åç«¯æœåŠ¡çš„æœŸæœ›ï¼Œå¯¹ä½ çš„ç³»ç»Ÿå®‰å…¨è‡³å…³é‡è¦ã€‚ä¸‹é¢çš„ä¾‹å­å¯ä»¥ä½œä¸ºä½ é…ç½®ç³»ç»Ÿçš„å‚è€ƒã€‚è§„èŒƒåŒ–çš„ URL è·¯å¾„ï¼Œå¦‚æœé€‰æ‹©äº† &lt;code&gt;NONE&lt;/code&gt;ï¼Œåˆ™æ˜¯åŸå§‹çš„ URL è·¯å¾„å°†ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ç”¨æ¥å¯¹ç…§æˆæƒç­–ç•¥è¿›è¡Œæ£€æŸ¥&lt;/li&gt;
&lt;li&gt;è½¬å‘åˆ°åç«¯åº”ç”¨ç¨‹åº&lt;/li&gt;
&lt;/ol&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;ä½ çš„åº”ç”¨ç¨‹åº&lt;/th&gt;
&lt;th&gt;é€‰æ‹©&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;ä¾é ä»£ç†è¿›è¡Œè§„èŒƒåŒ–å¤„ç†&lt;/td&gt;
&lt;td&gt;&lt;code&gt;BASE&lt;/code&gt;, &lt;code&gt;MERGE_SLASHES&lt;/code&gt; or &lt;code&gt;DECODE_AND_MERGE_SLASHES&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æ ¹æ® &lt;a href=&#34;https://tools.ietf.org/html/rfc3986&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;RFC 3986&lt;/a&gt; è§„èŒƒåŒ–è¯·æ±‚è·¯å¾„ï¼Œä¸åˆå¹¶æ–œçº¿&lt;/td&gt;
&lt;td&gt;&lt;code&gt;BASE&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æ ¹æ® &lt;a href=&#34;https://tools.ietf.org/html/rfc3986&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;RFC 3986&lt;/a&gt; è§„èŒƒåŒ–è¯·æ±‚è·¯å¾„ï¼Œåˆå¹¶æ–œçº¿ï¼Œä½†ä¸å¯¹&lt;a href=&#34;https://tools.ietf.org/html/rfc3986#section-2.1&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç™¾åˆ†æ¯”ç¼–ç &lt;/a&gt;çš„æ–œçº¿è¿›è¡Œè§£ç &lt;/td&gt;
&lt;td&gt;&lt;code&gt;MERGE_SLASHES&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;æ ¹æ® &lt;a href=&#34;https://tools.ietf.org/html/rfc3986&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;RFC 3986&lt;/a&gt; è§„èŒƒåŒ–è¯·æ±‚è·¯å¾„ï¼Œåˆå¹¶æ–œçº¿ï¼Œå¹¶å¯¹&lt;a href=&#34;https://tools.ietf.org/html/rfc3986#section-2.1&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç™¾åˆ†æ¯”ç¼–ç &lt;/a&gt;çš„æ–œçº¿è¿›è¡Œè§£ç &lt;/td&gt;
&lt;td&gt;&lt;code&gt;DECODE_AND_MERGE_SLASHES&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;å¤„ç†è¯·æ±‚è·¯å¾„çš„æ–¹å¼ä¸ &lt;a href=&#34;https://tools.ietf.org/html/rfc3986&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;RFC 3986&lt;/a&gt; ä¸å…¼å®¹&lt;/td&gt;
&lt;td&gt;&lt;code&gt;NONE&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&#34;å¦‚ä½•é…ç½®&#34;&gt;å¦‚ä½•é…ç½®&lt;/h3&gt;
&lt;p&gt;ä½ å¯ä»¥ä½¿ç”¨ &lt;code&gt;istioctl&lt;/code&gt; æ¥æ›´æ–° &lt;a href=&#34;https://istio.io/latest/docs/reference/config/istio.mesh.v1alpha1/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;mesh é…ç½®&lt;/a&gt;ï¼š&lt;/p&gt;
&lt;pre tabindex=&#34;0&#34;&gt;&lt;code&gt;$ istioctl upgrade --set meshConfig.pathNormalization.normalization=DECODE_AND_MERGE_SLASHES
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æˆ–é€šè¿‡æ”¹å˜ä½ çš„ Operator é‡å†™æ–‡ä»¶&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;l&#34;&gt;$ cat &amp;lt;&amp;lt;EOF &amp;gt; iop.yaml&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;install.istio.io/v1alpha1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;IstioOperator&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;meshConfig&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;pathNormalization&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;normalization&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;DECODE_AND_MERGE_SLASHES&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;l&#34;&gt;EOF&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;l&#34;&gt;$ istioctl install -f iop.yaml&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¦å¤–ï¼Œå¦‚æœä½ æƒ³ç›´æ¥ç¼–è¾‘ Mesh é…ç½®ï¼Œä½ å¯ä»¥å°† &lt;a href=&#34;https://istio.io/latest/docs/reference/config/istio.mesh.v1alpha1/#MeshConfig-ProxyPathNormalization&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;code&gt;pathNormalization&lt;/code&gt;&lt;/a&gt;æ·»åŠ åˆ° &lt;a href=&#34;https://istio.io/latest/docs/reference/config/istio.mesh.v1alpha1/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;mesh é…ç½®&lt;/a&gt;ä¸­ï¼Œè¯¥é…ç½®æ˜¯ &lt;code&gt;istio-&amp;lt;REVISION_ID&amp;gt;&lt;/code&gt; çš„ CongfigMapï¼Œåœ¨ &lt;code&gt;istio-system&lt;/code&gt; å‘½åç©ºé—´ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ é€‰æ‹© &lt;code&gt;DECODE_AND_MERGE_SLASHES&lt;/code&gt; é€‰é¡¹ï¼Œä½ ä¿®æ”¹ mesh é…ç½®å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;v1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;mesh&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|-&lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;      ...
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;      pathNormalization:
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;        normalization: DECODE_AND_MERGE_SLASHES
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;      ...      &lt;/span&gt;&lt;span class=&#34;w&#34;&gt;      
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;ä¸å¤ªå¸¸è§çš„è§„èŒƒåŒ–é…ç½®&#34;&gt;ä¸å¤ªå¸¸è§çš„è§„èŒƒåŒ–é…ç½®&lt;/h3&gt;
&lt;h4 id=&#34;å¤§å°å†™è§„èŒƒåŒ–&#34;&gt;å¤§å°å†™è§„èŒƒåŒ–&lt;/h4&gt;
&lt;p&gt;åœ¨æŸäº›ç¯å¢ƒä¸­ï¼Œä»¥ä¸åŒºåˆ†å¤§å°å†™çš„æ–¹å¼æ¯”è¾ƒæˆæƒç­–ç•¥ä¸­çš„è·¯å¾„å¯èƒ½æ˜¯æœ‰ç”¨çš„ã€‚ä¾‹å¦‚ï¼Œå°† &lt;code&gt;https://myurl/get&lt;/code&gt; å’Œ &lt;code&gt;https://myurl/GeT&lt;/code&gt; ç­‰åŒå¯¹å¾…ã€‚åœ¨è¿™äº›æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ &lt;code&gt;EnvoyFilter&lt;/code&gt;ã€‚è¿™ä¸ªè¿‡æ»¤å™¨å°†æ”¹å˜ç”¨äºæ¯”è¾ƒçš„è·¯å¾„å’Œå‘ˆç°ç»™åº”ç”¨ç¨‹åºçš„è·¯å¾„ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;networking.istio.io/v1alpha3&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;EnvoyFilter&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;ingress-case-insensitive&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;namespace&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;istio-system&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;configPatches&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;applyTo&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;HTTP_FILTER&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;match&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;context&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;GATEWAY&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;listener&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;filterChain&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;filter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;envoy.filters.network.http_connection_manager&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;subFilter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;              &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;envoy.filters.http.router&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;patch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;operation&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;INSERT_BEFORE&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;envoy.lua&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;typed_config&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;&amp;#34;@type&amp;#34;: &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;type.googleapis.com/envoy.extensions.filters.http.lua.v3.Lua&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;inlineCode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;              function envoy_on_request(request_handle)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;                local path = request_handle:headers():get(&amp;#34;:path&amp;#34;)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;                request_handle:headers():replace(&amp;#34;:path&amp;#34;, string.lower(path))
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;sd&#34;&gt;              end              &lt;/span&gt;&lt;span class=&#34;w&#34;&gt;              
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;äº†è§£æµé‡é‡‡é›†çš„é™åˆ¶&#34;&gt;äº†è§£æµé‡é‡‡é›†çš„é™åˆ¶&lt;/h2&gt;
&lt;p&gt;Istio sidecar çš„å·¥ä½œåŸç†æ˜¯æ•è·å…¥ç«™æµé‡å’Œå‡ºç«™æµé‡ï¼Œå¹¶é€šè¿‡ sidecar ä»£ç†å¼•å¯¼å®ƒä»¬ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶è€Œï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„æµé‡éƒ½è¢«æ•è·ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é‡å®šå‘åªå¤„ç†åŸºäº TCP çš„æµé‡ã€‚ä»»ä½• UDP æˆ– ICMP æ•°æ®åŒ…éƒ½ä¸ä¼šè¢«æ•è·æˆ–ä¿®æ”¹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://istio.io/latest/docs/ops/deployment/requirements/#ports-used-by-istio&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Sidecar ä½¿ç”¨çš„è®¸å¤šç«¯å£&lt;/a&gt;ä»¥åŠ 22 å·ç«¯å£çš„å…¥ç«™æ•è·è¢«ç¦ç”¨ã€‚è¿™ä¸ªåˆ—è¡¨å¯ä»¥é€šè¿‡ &lt;code&gt;traffic.sidecar.istio.io/excludeInboundPorts&lt;/code&gt; ç­‰é€‰é¡¹æ¥æ‰©å±•ã€‚&lt;/li&gt;
&lt;li&gt;å‡ºç«™æ•è·åŒæ ·å¯ä»¥é€šè¿‡ &lt;code&gt;traffic.sidecar.istio.io/excludeOutboundPorts&lt;/code&gt; ç­‰è®¾ç½®æˆ–å…¶ä»–æ–¹å¼å‡å°‘ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸€èˆ¬æ¥è¯´ï¼Œåº”ç”¨ç¨‹åºå’Œå…¶ sidecar ä»£ç†ä¹‹é—´çš„å®‰å…¨è¾¹ç•Œæœ€å°ã€‚å¯¹ sidecar çš„é…ç½®æ˜¯ä»¥æ¯ä¸ªæ¨¡å—ä¸ºåŸºç¡€çš„ï¼Œå¹¶ä¸”ä¸¤è€…éƒ½åœ¨åŒä¸€ä¸ªç½‘ç»œ / è¿›ç¨‹å‘½åç©ºé—´ä¸­è¿è¡Œã€‚å› æ­¤ï¼Œåº”ç”¨ç¨‹åºå¯èƒ½æœ‰èƒ½åŠ›åˆ é™¤é‡å®šå‘è§„åˆ™ï¼Œå¹¶åˆ é™¤ã€æ”¹å˜ã€ç»ˆæ­¢æˆ–æ›¿æ¢ sidecar ä»£ç†ã€‚è¿™å…è®¸ä¸€ä¸ª pod æ•…æ„ç»•è¿‡å®ƒçš„ sidecar çš„å‡ºç«™æµé‡æˆ–æ•…æ„è®©å…¥ç«™æµé‡ç»•è¿‡å®ƒçš„ sidecarã€‚&lt;/p&gt;
&lt;p&gt;å› æ­¤ï¼Œä¾é  Istio æ— æ¡ä»¶åœ°æ•è·æ‰€æœ‰æµé‡æ˜¯ä¸å®‰å…¨çš„ã€‚ç›¸åï¼Œå®‰å…¨è¾¹ç•Œæ˜¯å®¢æˆ·ç«¯ä¸èƒ½ç»•è¿‡å¦ä¸€ä¸ª pod çš„ sidecarã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘åœ¨ 9080 ç«¯å£è¿è¡Œ &lt;code&gt;review&lt;/code&gt; åº”ç”¨ç¨‹åºï¼Œæˆ‘å¯ä»¥å‡è®¾æ¥è‡ª &lt;code&gt;productpage&lt;/code&gt; åº”ç”¨ç¨‹åºçš„æ‰€æœ‰æµé‡å°†è¢« sidecar ä»£ç†æ•è·ï¼Œå…¶ä¸­ Istio è®¤è¯å’Œæˆæƒç­–ç•¥å¯èƒ½é€‚ç”¨ã€‚&lt;/p&gt;
&lt;h3 id=&#34;åˆ©ç”¨-networkpolicy-è¿›è¡Œæ·±åº¦é˜²å¾¡&#34;&gt;åˆ©ç”¨ &lt;code&gt;NetworkPolicy&lt;/code&gt; è¿›è¡Œæ·±åº¦é˜²å¾¡&lt;/h3&gt;
&lt;p&gt;ä¸ºäº†è¿›ä¸€æ­¥ç¡®ä¿æµé‡å®‰å…¨ï¼ŒIstio ç­–ç•¥å¯ä»¥ä¸ Kubernetes &lt;a href=&#34;https://kubernetes.io/docs/concepts/services-networking/network-policies/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç½‘ç»œç­–ç•¥&lt;/a&gt;åˆ†å±‚ã€‚è¿™å®ç°äº†ä¸€ä¸ªå¼ºå¤§çš„&lt;a href=&#34;https://en.wikipedia.org/wiki/Defense_in_depth_%28computing%29&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ·±åº¦é˜²å¾¡&lt;/a&gt;ç­–ç•¥ï¼Œå¯ä»¥ç”¨æ¥è¿›ä¸€æ­¥åŠ å¼ºä½ çš„ç½‘æ ¼çš„å®‰å…¨æ€§ã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œä½ å¯ä»¥é€‰æ‹©åªå…è®¸æµé‡åˆ°æˆ‘ä»¬ &lt;code&gt;review&lt;/code&gt; åº”ç”¨ç¨‹åºçš„ &lt;code&gt;9080&lt;/code&gt; ç«¯å£ã€‚å¦‚æœé›†ç¾¤ä¸­çš„ Pod è¢«ç ´åæˆ–å­˜åœ¨å®‰å…¨æ¼æ´ï¼Œè¿™å¯èƒ½ä¼šé™åˆ¶æˆ–é˜»æ­¢æ”»å‡»è€…çš„è¿›å±•ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ç¡®ä¿å‡ºå£æµé‡çš„å®‰å…¨&#34;&gt;ç¡®ä¿å‡ºå£æµé‡çš„å®‰å…¨&lt;/h3&gt;
&lt;p&gt;ä¸€ä¸ªå¸¸è§çš„è¯¯è§£æ˜¯ï¼Œåƒ &lt;a href=&#34;https://istio.io/latest/docs/tasks/traffic-management/egress/egress-control/#envoy-passthrough-to-external-services&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;code&gt;outboundTrafficPolicy: REGISTRY_ONLY&lt;/code&gt;&lt;/a&gt; ä½œä¸ºä¸€ä¸ªå®‰å…¨ç­–ç•¥ï¼Œé˜²æ­¢æ‰€æœ‰å¯¹æœªç”³æŠ¥æœåŠ¡çš„è®¿é—®ã€‚ç„¶è€Œï¼Œå¦‚ä¸Šæ‰€è¿°ï¼Œè¿™å¹¶ä¸æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å®‰å…¨è¾¹ç•Œï¼Œåº”è¯¥è¢«è®¤ä¸ºæ˜¯å°½åŠ›è€Œä¸ºã€‚&lt;/p&gt;
&lt;p&gt;è™½ç„¶è¿™å¯¹é˜²æ­¢æ„å¤–çš„ä¾èµ–æ€§å¾ˆæœ‰ç”¨ï¼Œä½†å¦‚æœä½ æƒ³ä¿è¯å‡ºå£æµé‡çš„å®‰å…¨ï¼Œå¹¶å¼ºåˆ¶è¦æ±‚æ‰€æœ‰å‡ºç«™æµé‡é€šè¿‡ä»£ç†ï¼Œä½ åº”è¯¥ä¾é  &lt;a href=&#34;https://istio.io/latest/docs/tasks/traffic-management/egress/egress-gateway/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Egress Gateway&lt;/a&gt;ã€‚å½“ä¸&lt;a href=&#34;https://istio.io/latest/docs/tasks/traffic-management/egress/egress-gateway/#apply-kubernetes-network-policies&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç½‘ç»œç­–ç•¥&lt;/a&gt;ç›¸ç»“åˆæ—¶ï¼Œä½ å¯ä»¥å¼ºåˆ¶æ‰€æœ‰çš„æµé‡ï¼Œæˆ–ä¸€äº›å­é›†ï¼Œé€šè¿‡å‡ºå£ç½‘å…³ã€‚è¿™ç¡®ä¿äº†å³ä½¿å®¢æˆ·æ„å¤–åœ°æˆ–æ¶æ„åœ°ç»•è¿‡ä»–ä»¬çš„ sidecarï¼Œè¯¥è¯·æ±‚ä¹Ÿä¼šè¢«é˜»æ­¢ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å½“ä½¿ç”¨-tls-å‘èµ·æ—¶åœ¨ç›®çš„åœ°è§„åˆ™ä¸­é…ç½®-tls-éªŒè¯&#34;&gt;å½“ä½¿ç”¨ TLS å‘èµ·æ—¶ï¼Œåœ¨ç›®çš„åœ°è§„åˆ™ä¸­é…ç½® TLS éªŒè¯&lt;/h2&gt;
&lt;p&gt;Istio æä¾›äº†ä»ä¸€ä¸ª sidecar ä»£ç†æˆ–ç½‘å…³&lt;a href=&#34;https://istio.io/latest/docs/tasks/traffic-management/egress/egress-tls-origination/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å‘èµ· TLS&lt;/a&gt; çš„èƒ½åŠ›ã€‚è¿™ä½¿å¾—å‘é€çº¯æ–‡æœ¬ HTTP æµé‡çš„åº”ç”¨ç¨‹åºèƒ½å¤Ÿé€æ˜åœ° â€œå‡çº§ â€œåˆ° HTTPSã€‚&lt;/p&gt;
&lt;p&gt;åœ¨é…ç½® &lt;code&gt;DestinationRule&lt;/code&gt; çš„ &lt;code&gt;tls&lt;/code&gt; è®¾ç½®æ—¶ï¼Œå¿…é¡»æ³¨æ„æŒ‡å®š &lt;code&gt;caCertificates&lt;/code&gt; å­—æ®µã€‚å¦‚æœæ²¡æœ‰è®¾ç½®ï¼ŒæœåŠ¡å™¨çš„è¯ä¹¦å°†ä¸ä¼šè¢«éªŒè¯ã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;networking.istio.io/v1beta1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;DestinationRule&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;google-tls&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;host&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;google.com&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;trafficPolicy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;tls&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;mode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;SIMPLE&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;caCertificates&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;/etc/ssl/certs/ca-certificates.crt&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;ç½‘å…³&#34;&gt;ç½‘å…³&lt;/h2&gt;
&lt;p&gt;åœ¨è¿è¡Œ Istio &lt;a href=&#34;https://istio.io/latest/docs/tasks/traffic-management/ingress/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç½‘å…³&lt;/a&gt;æ—¶ï¼Œæ¶‰åŠä¸€äº›èµ„æºï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Gateways&lt;/code&gt;ï¼Œå®ƒæ§åˆ¶ç½‘å…³çš„ç«¯å£å’Œ TLS è®¾ç½®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;VirtualServices&lt;/code&gt;ï¼Œæ§åˆ¶è·¯ç”±é€»è¾‘ã€‚è¿™äº›éƒ½æ˜¯é€šè¿‡åœ¨ç½‘å…³å­—æ®µä¸­çš„ç›´æ¥å¼•ç”¨å’Œåœ¨ç½‘å…³å’Œ &lt;code&gt;VirtualService&lt;/code&gt; çš„ &lt;code&gt;hosts&lt;/code&gt; å­—æ®µä¸­çš„ç›¸äº’çº¦å®šä¸ &lt;code&gt;Gateway&lt;/code&gt; ç›¸å…³è”çš„ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;é™åˆ¶-gateway-åˆ›å»ºæƒé™&#34;&gt;é™åˆ¶ &lt;code&gt;Gateway&lt;/code&gt; åˆ›å»ºæƒé™&lt;/h3&gt;
&lt;p&gt;å»ºè®®å°† Gateway èµ„æºçš„åˆ›å»ºé™åˆ¶åœ¨å—ä¿¡ä»»çš„é›†ç¾¤ç®¡ç†å‘˜ã€‚è¿™å¯ä»¥é€šè¿‡ &lt;a href=&#34;https://kubernetes.io/docs/reference/access-authn-authz/rbac/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Kubernetes RBAC ç­–ç•¥&lt;/a&gt;æˆ– &lt;a href=&#34;https://www.openpolicyagent.org/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Open Policy Agent&lt;/a&gt; ç­‰å·¥å…·å®ç°ã€‚&lt;/p&gt;
&lt;h3 id=&#34;é¿å…è¿‡äºå®½æ³›çš„-hosts-é…ç½®&#34;&gt;é¿å…è¿‡äºå®½æ³›çš„ &lt;code&gt;hosts&lt;/code&gt; é…ç½®&lt;/h3&gt;
&lt;p&gt;åœ¨å¯èƒ½çš„æƒ…å†µä¸‹ï¼Œé¿å…åœ¨ &lt;code&gt;Gateway&lt;/code&gt; ä¸­è¿›è¡Œè¿‡äºå¹¿æ³›çš„ &lt;code&gt;hosts&lt;/code&gt; è®¾ç½®ã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œè¿™ç§é…ç½®å°†å…è®¸ä»»ä½• VirtualService ç»‘å®šåˆ° &lt;code&gt;Gateway&lt;/code&gt;ï¼Œå¯èƒ½ä¼šæš´éœ²å‡ºæ„å¤–çš„åŸŸï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;servers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;number&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;80&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;http&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;protocol&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;HTTP&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;hosts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;s2&#34;&gt;&amp;#34;*&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™åº”è¯¥è¢«é”å®šï¼Œåªå…è®¸ç‰¹å®šåŸŸæˆ–ç‰¹å®šå‘½åç©ºé—´ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;servers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;number&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;80&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;http&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;protocol&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;HTTP&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;hosts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;s2&#34;&gt;&amp;#34;foo.example.com&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# åªå…è®¸ foo.example.com çš„ VirtualServices&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;s2&#34;&gt;&amp;#34;default/bar.example.com&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# åªå…è®¸ default å‘½åç©ºé—´ bar.example.com çš„ VirtualServices&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;s2&#34;&gt;&amp;#34;route-namespace/*&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;c&#34;&gt;# åªå…è®¸ route-namespace å‘½åç©ºé—´çš„ VirtualServices&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;éš”ç¦»æ•æ„ŸæœåŠ¡&#34;&gt;éš”ç¦»æ•æ„ŸæœåŠ¡&lt;/h3&gt;
&lt;p&gt;å¯èƒ½éœ€è¦å¯¹æ•æ„ŸæœåŠ¡å®æ–½æ›´ä¸¥æ ¼çš„ç‰©ç†éš”ç¦»ã€‚ä¾‹å¦‚ï¼Œä½ å¯èƒ½æƒ³ä¸ºæ•æ„Ÿçš„ &lt;code&gt;payment.example.com&lt;/code&gt; è¿è¡Œä¸€ä¸ª&lt;a href=&#34;https://istio.io/latest/docs/setup/install/istioctl/#configure-gateways&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ä¸“ç”¨çš„ç½‘å…³å®ä¾‹&lt;/a&gt;ï¼Œè€Œä¸ºä¸å¤ªæ•æ„Ÿçš„åŸŸåå¦‚ &lt;code&gt;blog.example.com&lt;/code&gt; å’Œ &lt;code&gt;store.example.com&lt;/code&gt; ä½¿ç”¨ä¸€ä¸ªå•ä¸€çš„å…±äº«ç½‘å…³å®ä¾‹ã€‚è¿™å¯ä»¥æä¾›ä¸€ä¸ªæ›´å¼ºå¤§çš„æ·±åº¦é˜²å¾¡ï¼Œå¹¶æœ‰åŠ©äºæ»¡è¶³æŸäº›ç›‘ç®¡åˆè§„å‡†åˆ™ã€‚&lt;/p&gt;
&lt;h3 id=&#34;åœ¨æ”¾å®½çš„-sni-ä¸»æœºåŒ¹é…ä¸‹æ˜ç¡®åœ°ç¦ç”¨æ‰€æœ‰æ•æ„Ÿçš„-http-ä¸»æœº&#34;&gt;åœ¨æ”¾å®½çš„ SNI ä¸»æœºåŒ¹é…ä¸‹ï¼Œæ˜ç¡®åœ°ç¦ç”¨æ‰€æœ‰æ•æ„Ÿçš„ http ä¸»æœº&lt;/h3&gt;
&lt;p&gt;åœ¨ä¸åŒçš„ä¸»æœºä¸Šä½¿ç”¨å¤šä¸ª &lt;code&gt;Gateways&lt;/code&gt; æ¥å®šä¹‰åŒå‘ TLS å’Œç®€å• TLS æ˜¯åˆç†çš„ã€‚ä¾‹å¦‚ï¼Œå¯¹ SNI ä¸»æœº &lt;code&gt;admin.example.com&lt;/code&gt; ä½¿ç”¨åŒå‘ TLSï¼Œå¯¹ SNI ä¸»æœº &lt;code&gt;*.example.com&lt;/code&gt; ä½¿ç”¨ç®€å• TLSã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Gateway&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;guestgateway&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;selector&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;istio&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;ingressgateway&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;servers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;number&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;443&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;https&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;protocol&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;HTTPS&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;hosts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;s2&#34;&gt;&amp;#34;*.example.com&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;tls&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;mode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;SIMPLE&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nn&#34;&gt;---&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;Gateway&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;admingateway&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;selector&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;istio&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;ingressgateway&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;servers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;number&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;443&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;https&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;protocol&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;HTTPS&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;hosts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;admin.example.com&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;tls&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;mode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;MUTUAL&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¦‚æœæœ‰å¿…è¦è¿›è¡Œä¸Šè¿°æ“ä½œï¼Œå¼ºçƒˆå»ºè®®åœ¨é™„åŠ åˆ° &lt;code&gt;*.example.com&lt;/code&gt; çš„ &lt;code&gt;VirtualService&lt;/code&gt; ä¸­æ˜ç¡®ç¦ç”¨ http ä¸»æœº &lt;code&gt;admin.example.com&lt;/code&gt;ã€‚åŸå› æ˜¯ç›®å‰åº•å±‚çš„ &lt;a href=&#34;https://github.com/envoyproxy/envoy/issues/6767&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;envoy ä»£ç†ä¸éœ€è¦&lt;/a&gt; http 1 å¤´ &lt;code&gt;Host&lt;/code&gt; æˆ– http 2 ä¼ªå¤´&lt;code&gt;:authority&lt;/code&gt; çš„ SNI çº¦æŸåï¼Œæ”»å‡»è€…å¯ä»¥é‡æ–°ä½¿ç”¨ guest-SNI TLS è¿æ¥æ¥è®¿é—® admin &lt;code&gt;VirtualService&lt;/code&gt;ã€‚http å“åº”ä»£ç  421 æ˜¯ä¸ºè¿™ç§ &lt;code&gt;Host&lt;/code&gt; SNI ä¸åŒ¹é…è€Œè®¾è®¡çš„ï¼Œå¯ä»¥ç”¨æ¥å®ç°ç¦ç”¨ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nt&#34;&gt;apiVersion&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;networking.istio.io/v1alpha3&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;kind&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;VirtualService&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;disable-sensitive&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;spec&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;hosts&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;s2&#34;&gt;&amp;#34;admin.example.com&amp;#34;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;gateways&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;l&#34;&gt;guestgateway&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;http&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;match&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;uri&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;prefix&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;fault&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;abort&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;percentage&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;100&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;httpStatus&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;421&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;route&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;- &lt;span class=&#34;nt&#34;&gt;destination&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;port&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;number&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;8000&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;host&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;l&#34;&gt;dest.default.cluster.local&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id=&#34;åè®®æ£€æµ‹&#34;&gt;åè®®æ£€æµ‹&lt;/h2&gt;
&lt;p&gt;Istio ä¼š&lt;a href=&#34;https://istio.io/latest/docs/ops/configuration/traffic-management/protocol-selection/#automatic-protocol-selection&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è‡ªåŠ¨ç¡®å®š&lt;/a&gt;å®ƒæ‰€çœ‹åˆ°çš„æµé‡çš„&lt;a href=&#34;https://istio.io/latest/docs/ops/configuration/traffic-management/protocol-selection/#automatic-protocol-selection&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;åè®®&lt;/a&gt;ã€‚ä¸ºäº†é¿å…æ„å¤–æˆ–æ•…æ„çš„æ¼æ£€ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ„å¤–çš„æµé‡è¡Œä¸ºï¼Œå»ºè®®åœ¨å¯èƒ½çš„æƒ…å†µä¸‹&lt;a href=&#34;https://istio.io/latest/docs/ops/configuration/traffic-management/protocol-selection/#explicit-protocol-selection&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ˜ç¡®å£°æ˜åè®®&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;cni&#34;&gt;CNI&lt;/h2&gt;
&lt;p&gt;ä¸ºäº†é€æ˜åœ°æ•è·æ‰€æœ‰æµé‡ï¼ŒIstio ä¾èµ–äº &lt;code&gt;istio-init&lt;/code&gt; &lt;code&gt;initContainer&lt;/code&gt; æ‰€é…ç½®çš„ &lt;code&gt;iptables&lt;/code&gt; è§„åˆ™ã€‚è¿™å¢åŠ äº†ä¸€ä¸ª&lt;a href=&#34;https://istio.io/latest/docs/ops/deployment/requirements/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;è¦æ±‚&lt;/a&gt;ï¼Œå³ &lt;code&gt;NET_ADMIN&lt;/code&gt; å’Œ &lt;code&gt;NET_RAW&lt;/code&gt;&lt;a href=&#34;https://kubernetes.io/docs/tasks/configure-pod-container/security-context/#set-capabilities-for-a-container&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;çš„èƒ½åŠ›&lt;/a&gt;å¿…é¡»å¯¹ pod å¯ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†å‡å°‘æˆäºˆ pod çš„æƒé™ï¼ŒIstio æä¾›äº†ä¸€ä¸ª &lt;a href=&#34;https://istio.io/latest/docs/setup/additional-setup/cni/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;CNI æ’ä»¶&lt;/a&gt;ï¼Œå®ƒæ¶ˆé™¤äº†è¿™ä¸ªè¦æ±‚ã€‚&lt;/p&gt;
&lt;p&gt;Istio CNI æ’ä»¶ç›®å‰æ˜¯ä¸€ä¸ª alpha åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä½¿ç”¨åŠ å›ºçš„-docker-é•œåƒ&#34;&gt;ä½¿ç”¨åŠ å›ºçš„ docker é•œåƒ&lt;/h2&gt;
&lt;p&gt;Istio çš„é»˜è®¤ docker é•œåƒï¼ŒåŒ…æ‹¬é‚£äº›ç”±æ§åˆ¶å¹³é¢ã€ç½‘å…³å’Œ sidecar ä»£ç†è¿è¡Œçš„é•œåƒï¼Œéƒ½æ˜¯åŸºäº ubuntu çš„ã€‚è¿™æä¾›äº†å„ç§å·¥å…·ï¼Œå¦‚ bash å’Œ curlï¼Œè¿™ä»¥æ–¹ä¾¿ä¸ºä»£ä»·ï¼Œå¢åŠ äº†æ”»å‡»é¢ã€‚&lt;/p&gt;
&lt;p&gt;Istio è¿˜æä¾›äº†ä¸€ä¸ªåŸºäº&lt;a href=&#34;https://istio.io/latest/docs/ops/configuration/security/harden-docker-images/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ— å‘è¡Œç‰ˆé•œåƒçš„&lt;/a&gt;å°å‹é•œåƒï¼Œå‡å°‘äº†é•œåƒä¸­çš„ä¾èµ–æ€§ã€‚&lt;/p&gt;
&lt;p&gt;æ— å‘è¡Œç‰ˆçš„é•œåƒç›®å‰æ˜¯ä¸€ä¸ª alpha åŠŸèƒ½ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å‘å¸ƒå’Œå®‰å…¨ç­–ç•¥&#34;&gt;å‘å¸ƒå’Œå®‰å…¨ç­–ç•¥&lt;/h2&gt;
&lt;p&gt;ä¸ºäº†ç¡®ä¿ä½ çš„é›†ç¾¤æœ‰æœ€æ–°çš„å·²çŸ¥æ¼æ´çš„å®‰å…¨è¡¥ä¸ï¼Œé‡è¦çš„æ˜¯ä¿æŒåœ¨ Istio çš„æœ€æ–°è¡¥ä¸ç‰ˆæœ¬ä¸Šï¼Œå¹¶ç¡®ä¿ä½ åœ¨ä¸€ä¸ª&lt;a href=&#34;https://istio.io/latest/docs/releases/supported-releases&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;æ”¯æŒçš„ç‰ˆæœ¬&lt;/a&gt;ä¸Šï¼Œä»åœ¨æ¥æ”¶å®‰å…¨è¡¥ä¸ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ£€æµ‹æ— æ•ˆé…ç½®&#34;&gt;æ£€æµ‹æ— æ•ˆé…ç½®&lt;/h2&gt;
&lt;p&gt;è™½ç„¶ Istio åœ¨åˆ›å»ºèµ„æºæ—¶æä¾›äº†éªŒè¯ï¼Œä½†è¿™äº›æ£€æŸ¥ä¸èƒ½æŠ“ä½æ‰€æœ‰é˜»æ­¢é…ç½®åœ¨ç½‘æ ¼ä¸­åˆ†å¸ƒçš„é—®é¢˜ã€‚è¿™å¯èƒ½å¯¼è‡´åº”ç”¨çš„ç­–ç•¥è¢«æ„å¤–åœ°å¿½ç•¥ï¼Œä»è€Œå¯¼è‡´æ„å¤–çš„ç»“æœã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åœ¨åº”ç”¨é…ç½®ä¹‹å‰æˆ–ä¹‹åè¿è¡Œ &lt;code&gt;istioctl analyze&lt;/code&gt;ï¼Œä»¥ç¡®ä¿é…ç½®æœ‰æ•ˆã€‚&lt;/li&gt;
&lt;li&gt;ç›‘æ§æ§åˆ¶å¹³é¢çš„æ‹’ç»é…ç½®ã€‚é™¤äº†æ—¥å¿—ä¹‹å¤–ï¼Œè¿™äº›éƒ½æ˜¯é€šè¿‡ &lt;code&gt;pilot_total_xds_rejects&lt;/code&gt; æŒ‡æ ‡æ¥æ˜¾ç¤ºçš„ã€‚&lt;/li&gt;
&lt;li&gt;æµ‹è¯•ä½ çš„é…ç½®ï¼Œä»¥ç¡®ä¿å®ƒç»™å‡ºé¢„æœŸçš„ç»“æœã€‚å¯¹äºå®‰å…¨ç­–ç•¥æ¥è¯´ï¼Œè¿è¡Œæ­£é¢å’Œè´Ÿé¢çš„æµ‹è¯•æ˜¯æœ‰ç”¨çš„ï¼Œä»¥ç¡®ä¿ä½ ä¸ä¼šæ„å¤–åœ°é™åˆ¶è¿‡å¤šæˆ–è¿‡å°‘çš„æµé‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;é¿å…-alpha-å’Œå®éªŒæ€§åŠŸèƒ½&#34;&gt;é¿å… alpha å’Œå®éªŒæ€§åŠŸèƒ½&lt;/h2&gt;
&lt;p&gt;æ‰€æœ‰ Istio åŠŸèƒ½å’Œ API éƒ½è¢«åˆ†é…äº†ä¸€ä¸ª&lt;a href=&#34;https://istio.io/latest/docs/releases/feature-stages/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;åŠŸèƒ½çŠ¶æ€&lt;/a&gt;ï¼Œå®šä¹‰äº†å®ƒçš„ç¨³å®šæ€§ã€åºŸæ­¢æ”¿ç­–å’Œå®‰å…¨æ”¿ç­–ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äº alpha å’Œå®éªŒæ€§åŠŸèƒ½æ²¡æœ‰é‚£ä¹ˆå¼ºçš„å®‰å…¨ä¿è¯ï¼Œå»ºè®®å°½å¯èƒ½é¿å…ä½¿ç”¨å®ƒä»¬ã€‚åœ¨è¿™äº›åŠŸèƒ½ä¸­å‘ç°çš„å®‰å…¨é—®é¢˜å¯èƒ½ä¸ä¼šè¢«ç«‹å³ä¿®å¤ï¼Œæˆ–è€…ä¸éµå¾ªæˆ‘ä»¬çš„æ ‡å‡†&lt;a href=&#34;https://istio.io/latest/docs/releases/security-vulnerabilities/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å®‰å…¨æ¼æ´&lt;/a&gt;ç¨‹åºã€‚&lt;/p&gt;
&lt;p&gt;è¦ç¡®å®šåœ¨ä½ çš„é›†ç¾¤ä¸­ä½¿ç”¨çš„åŠŸèƒ½çŠ¶æ€ï¼Œè¯·æŸ¥é˜… &lt;a href=&#34;https://istio.io/latest/docs/releases/feature-stages/#istio-features&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Istio åŠŸèƒ½&lt;/a&gt;åˆ—è¡¨ã€‚&lt;/p&gt;
&lt;h2 id=&#34;é”å®šç«¯å£&#34;&gt;é”å®šç«¯å£&lt;/h2&gt;
&lt;p&gt;Istio é…ç½®äº†&lt;a href=&#34;https://istio.io/latest/docs/ops/deployment/requirements/#ports-used-by-istio&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å„ç§&lt;/a&gt;å¯èƒ½è¢«é”å®šçš„&lt;a href=&#34;https://istio.io/latest/docs/ops/deployment/requirements/#ports-used-by-istio&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;ç«¯å£&lt;/a&gt;ï¼Œä»¥æé«˜å®‰å…¨æ€§ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ§åˆ¶å¹³é¢&#34;&gt;æ§åˆ¶å¹³é¢&lt;/h3&gt;
&lt;p&gt;Istiod ä¸ºæ–¹ä¾¿èµ·è§ï¼Œé»˜è®¤æš´éœ²äº†å‡ ä¸ªæœªç»è®¤è¯çš„æ˜æ–‡ç«¯å£ã€‚å¦‚æœéœ€è¦ï¼Œè¿™äº›ç«¯å£å¯ä»¥è¢«å…³é—­ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;8080&lt;/code&gt; ç«¯å£æš´éœ²äº†è°ƒè¯•æ¥å£ï¼Œå®ƒæä¾›äº†å¯¹é›†ç¾¤çŠ¶æ€çš„å„ç§ç»†èŠ‚çš„è¯»å–æƒé™ã€‚è¿™å¯ä»¥é€šè¿‡åœ¨ Istiod ä¸Šè®¾ç½®ç¯å¢ƒå˜é‡ &lt;code&gt;ENABLE_DEBUG_ON_HTTP=false&lt;/code&gt; æ¥ç¦ç”¨ã€‚è­¦å‘Šï¼šè®¸å¤š &lt;code&gt;istioctl&lt;/code&gt; å‘½ä»¤éƒ½ä¾èµ–äºè¿™ä¸ªæ¥å£ï¼Œå¦‚æœå®ƒè¢«ç¦ç”¨ï¼Œå°†æ— æ³•è¿è¡Œã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;15010&lt;/code&gt; ç«¯å£é€šè¿‡æ˜æ–‡æš´éœ² XDS æœåŠ¡ã€‚è¿™å¯ä»¥é€šè¿‡åœ¨ Istiod éƒ¨ç½²ä¸­æ·»åŠ  &lt;code&gt;--grpcAddr=&amp;quot;&amp;quot;&lt;/code&gt; æ ‡å¿—æ¥ç¦ç”¨ã€‚æ³¨æ„ï¼šé«˜åº¦æ•æ„Ÿçš„æœåŠ¡ï¼Œå¦‚è¯ä¹¦ç­¾ç½²å’Œåˆ†å‘æœåŠ¡ï¼Œç»ä¸é€šè¿‡æ˜æ–‡æä¾›ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;æ•°æ®å¹³é¢&#34;&gt;æ•°æ®å¹³é¢&lt;/h3&gt;
&lt;p&gt;è¯¥ä»£ç†æš´éœ²äº†å„ç§ç«¯å£ã€‚å¯¹å¤–æš´éœ²çš„æ˜¯ &lt;code&gt;15090&lt;/code&gt; ç«¯å£ï¼ˆé¥æµ‹ï¼‰å’Œ &lt;code&gt;15021&lt;/code&gt; ç«¯å£ï¼ˆå¥åº·æ£€æŸ¥ï¼‰ã€‚ç«¯å£ &lt;code&gt;15020&lt;/code&gt; å’Œ &lt;code&gt;15000&lt;/code&gt; æä¾›è°ƒè¯•ç«¯ç‚¹ã€‚è¿™äº›ç«¯å£åªåœ¨æœ¬åœ°ä¸»æœºä¸Šæš´éœ²ã€‚å› æ­¤ï¼Œè¿è¡Œåœ¨ä¸ä»£ç†ç›¸åŒçš„ pod ä¸­çš„åº”ç”¨ç¨‹åºå¯ä»¥è®¿é—®ï¼›åœ¨ sidecar å’Œåº”ç”¨ç¨‹åºä¹‹é—´æ²¡æœ‰ä¿¡ä»»è¾¹ç•Œã€‚&lt;/p&gt;
&lt;h2 id=&#34;é…ç½®ç¬¬ä¸‰æ–¹æœåŠ¡è´¦æˆ·ä»¤ç‰Œ&#34;&gt;é…ç½®ç¬¬ä¸‰æ–¹æœåŠ¡è´¦æˆ·ä»¤ç‰Œ&lt;/h2&gt;
&lt;p&gt;ä¸ºäº†ä¸ Istio æ§åˆ¶å¹³é¢è¿›è¡Œè®¤è¯ï¼ŒIstio ä»£ç†å°†ä½¿ç”¨æœåŠ¡è´¦æˆ·ä»¤ç‰Œã€‚Kubernetes æ”¯æŒè¿™ç§ä»¤ç‰Œçš„ä¸¤ç§å½¢å¼ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç¬¬ä¸‰æ–¹ä»¤ç‰Œï¼Œæœ‰ä¸€ä¸ªèŒƒå›´å†…çš„å—ä¼—å’Œåˆ°æœŸæ—¶é—´ã€‚&lt;/li&gt;
&lt;li&gt;ç¬¬ä¸€æ–¹ä»¤ç‰Œï¼Œæ²¡æœ‰è¿‡æœŸï¼Œå¹¶è¢«å®‰è£…åˆ°æ‰€æœ‰çš„ Pod ä¸­ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç”±äºç¬¬ä¸€æ–¹ä»¤ç‰Œçš„å±æ€§ä¸å¤ªå®‰å…¨ï¼ŒIstio å°†é»˜è®¤ä½¿ç”¨ç¬¬ä¸‰æ–¹ä»¤ç‰Œã€‚ç„¶è€Œï¼Œè¿™ä¸ªåŠŸèƒ½å¹¶ä¸æ˜¯åœ¨æ‰€æœ‰çš„ Kubernetes å¹³å°ä¸Šéƒ½å¯ç”¨çš„ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ ä½¿ç”¨ &lt;code&gt;istioctl&lt;/code&gt; æ¥å®‰è£…ï¼Œå°†ä¼šè‡ªåŠ¨æ£€æµ‹åˆ°æ”¯æŒã€‚è¿™ä¹Ÿå¯ä»¥æ‰‹åŠ¨å®Œæˆï¼Œé€šè¿‡ä¼ é€’ &lt;code&gt;--set values.global.jwtPolicy=third-party-jwt&lt;/code&gt; æˆ– -&lt;code&gt;-set values.global.jwtPolicy=first-party-jwt&lt;/code&gt; è¿›è¡Œé…ç½®ã€‚&lt;/p&gt;
&lt;p&gt;è¦ç¡®å®šä½ çš„é›†ç¾¤æ˜¯å¦æ”¯æŒç¬¬ä¸‰æ–¹ä»¤ç‰Œï¼Œå¯»æ‰¾ &lt;code&gt;TokenRequest&lt;/code&gt; APIã€‚å¦‚æœè¿™æ²¡æœ‰è¿”å›å“åº”ï¼Œé‚£ä¹ˆè¯¥åŠŸèƒ½å°±ä¸è¢«æ”¯æŒã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ kubectl get --raw /api/v1 &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; jq &lt;span class=&#34;s1&#34;&gt;&amp;#39;.resources[] | select(.name | index(&amp;#34;serviceaccounts/token&amp;#34;))&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;name&amp;#34;&lt;/span&gt;: &lt;span class=&#34;s2&#34;&gt;&amp;#34;serviceaccounts/token&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;singularName&amp;#34;&lt;/span&gt;: &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;namespaced&amp;#34;&lt;/span&gt;: true,
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;group&amp;#34;&lt;/span&gt;: &lt;span class=&#34;s2&#34;&gt;&amp;#34;authentication.k8s.io&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;version&amp;#34;&lt;/span&gt;: &lt;span class=&#34;s2&#34;&gt;&amp;#34;v1&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;kind&amp;#34;&lt;/span&gt;: &lt;span class=&#34;s2&#34;&gt;&amp;#34;TokenRequest&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;verbs&amp;#34;&lt;/span&gt;: &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;s2&#34;&gt;&amp;#34;create&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è™½ç„¶ç°åœ¨å¤§å¤šæ•°äº‘æä¾›å•†éƒ½æ”¯æŒè¿™ä¸€åŠŸèƒ½ï¼Œä½†åœ¨ Kubernetes 1.20 ä¹‹å‰ï¼Œè®¸å¤šæœ¬åœ°å¼€å‘å·¥å…·å’Œè‡ªå®šä¹‰å®‰è£…å¯èƒ½ä¸æ”¯æŒã€‚è¦å¯ç”¨è¯¥åŠŸèƒ½ï¼Œè¯·å‚è€ƒ &lt;a href=&#34;https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/#service-account-token-volume-projection&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Kubernetes æ–‡æ¡£&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;é…ç½®ä¸‹æ¸¸è¿æ¥çš„é™åˆ¶&#34;&gt;é…ç½®ä¸‹æ¸¸è¿æ¥çš„é™åˆ¶&lt;/h2&gt;
&lt;p&gt;é»˜è®¤æƒ…å†µä¸‹ï¼ŒIstioï¼ˆå’Œ Envoyï¼‰å¯¹ä¸‹æ¸¸è¿æ¥çš„æ•°é‡æ²¡æœ‰é™åˆ¶ã€‚è¿™å¯èƒ½è¢«æ¶æ„è¡Œä¸ºè€…åˆ©ç”¨ï¼ˆè§&lt;a href=&#34;https://istio.io/latest/news/security/istio-security-2020-007/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;å®‰å…¨å…¬å‘Š 2020-007&lt;/a&gt;ï¼‰ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½ å¿…é¡»ä¸ºä½ çš„ç¯å¢ƒé…ç½®ä¸€ä¸ªé€‚å½“çš„è¿æ¥é™åˆ¶ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;é€šè¿‡ä¸‹è½½ &lt;a href=&#34;https://istio.io/latest/news/security/istio-security-2020-007/custom-bootstrap-runtime.yaml&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;custom-bootstrap-runtime.yaml &lt;/a&gt;åˆ›å»ºä¸€ä¸ª ConfigMapã€‚æ ¹æ®ä½ çš„éƒ¨ç½²ä¸­å„ä¸ªç½‘å…³å®ä¾‹æ‰€éœ€çš„å¹¶å‘è¿æ¥æ•°ï¼Œæ›´æ–° ConfigMap ä¸­çš„ &lt;code&gt;global_downstream_max_connections&lt;/code&gt;ã€‚ä¸€æ—¦è¾¾åˆ°é™åˆ¶ï¼ŒEnvoy å°†å¼€å§‹æ‹’ç» tcp è¿æ¥ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ kubectl -n istio-system apply -f custom-bootstrap-runtime.yaml
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å…¥å£ç½‘å…³éƒ¨ç½²æ‰“è¡¥ä¸ï¼Œä»¥ä½¿ç”¨ä¸Šè¿°é…ç½®ã€‚ä¸‹è½½ &lt;a href=&#34;https://istio.io/latest/news/security/istio-security-2020-007/gateway-patch.yaml&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;gateway-patch.yaml&lt;/a&gt; å¹¶ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åº”ç”¨å®ƒã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ kubectl --namespace istio-system patch deployment istio-ingressgateway --patch &lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;cat gateway-patch.yaml&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç¡®è®¤æ–°çš„é™åˆ¶å·²ç»åˆ°ä½ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ &lt;span class=&#34;nv&#34;&gt;ISTIO_INGRESS_PODNAME&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;$(&lt;/span&gt;kubectl get pods -l &lt;span class=&#34;nv&#34;&gt;app&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;istio-ingressgateway -n istio-system  -o &lt;span class=&#34;nv&#34;&gt;jsonpath&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;{.items[0].metadata.name}&amp;#34;&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;$ kubectl --namespace istio-system &lt;span class=&#34;nb&#34;&gt;exec&lt;/span&gt; -i -t  &lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;${&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;ISTIO_INGRESS_PODNAME&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;&lt;/span&gt; -c istio-proxy -- curl -sS http://localhost:15000/runtime
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;entries&amp;#34;&lt;/span&gt;: &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;s2&#34;&gt;&amp;#34;overload.global_downstream_max_connections&amp;#34;&lt;/span&gt;: &lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;layer_values&amp;#34;&lt;/span&gt;: &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;s2&#34;&gt;&amp;#34;250000&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;      &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s2&#34;&gt;&amp;#34;final_value&amp;#34;&lt;/span&gt;: &lt;span class=&#34;s2&#34;&gt;&amp;#34;250000&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;layers&amp;#34;&lt;/span&gt;: &lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;s2&#34;&gt;&amp;#34;static_layer_0&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;s2&#34;&gt;&amp;#34;admin&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt; &lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ol&gt;
</description>
    </item>
    
  </channel>
</rss>
